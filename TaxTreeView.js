function $_global_taxtreeview(){typeof Sys!="undefined"&&Sys!=null&&Sys.Application!=null&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs!="undefined"&&NotifyScriptLoadedAndExecuteWaitingJobs("TaxTreeView.js")}function ULSgBe(){var a={};a.ULSTeamName="DLC Server";a.ULSFileName="TaxTreeView.commentedjs";return a}function setRowStyles(a,b){a:;currElem=a.nextSibling;while(true){if(null==currElem)return;if(currElem.tagName.toLowerCase()!="tr"||currElem.depth==null)return;if(currElem.depth<=a.depth)return;currElem.className="Hidden";currElem.style.display=b;cell=currElem.firstChild;goNode=cell.childNodes[2];if(goNode!=null){if(goNode.tagName==null)goNode=goNode.nextSibling;if(goNode!=null&&goNode.tagName!=null&&goNode.tagName.toLowerCase()=="img"){goNode.className="Hidden ms-middleimg";goNode.style.display="none"}}currElem=currElem.nextSibling}}function openRow(b){a:;var c=b.parentNode,a=[];currElem=b.nextSibling;a.push(b);while(currElem!=null&&a.length>0){if(currElem.tagName.toLowerCase()!="tr"||currElem.depth==null)return;if(currElem.depth<=b.depth)return;else if(a[a.length-1].depth==currElem.depth-1&&a[a.length-1].state=="expanded")currElem.style.display="inline";if(currElem.state=="expanded"){a.push(currElem);currElem=getNextRow(currElem)}else{currDepth=currElem.depth;currElem=getNextRow(currElem);while(currElem!=null&&currElem.depth>currDepth)currElem=currElem.nextSibling;if(currElem==null)return;while(a.length>0&&currElem.depth<=a[a.length-1].depth)a.pop()}}}function getNextRow(a){a:;return a!=null&&a.nextSibling!=null&&a.nextSibling.tagName.toLowerCase()=="tr"&&a.nextSibling.depth!=null?a.nextSibling:null}function setsortingfields(a){a:;if(a==null)a=window.event.srcElement;if(a.tagName.toLowerCase()!="td")return;if(selectedElement!=null){goNode=selectedElement.childNodes[2];if(goNode!=null){if(goNode.tagName==null)goNode=goNode.nextSibling;if(goNode!=null&&goNode.tagName!=null&&goNode.tagName.toLowerCase()=="img"){goNode.className="Hidden ms-middleimg";goNode.style.display="none"}}}selectrow();selectedElement=a;goNode=selectedElement.childNodes[2];if(goNode!=null){if(goNode.tagName==null)goNode=goNode.nextSibling;if(goNode!=null&&goNode.tagName!=null&&goNode.tagName.toLowerCase()=="img")goNode.style.display="inline"}}function toggle(){a:;var a=window.event.srcElement;while(a!=null&&a.tagName.toLowerCase()!="tr")a=a.parentNode;if(a==null)return;imgElem=a;while(imgElem!=null&&imgElem.tagName.toLowerCase()!="img")imgElem=imgElem.firstChild;if(imgElem==null)return;if(a.state=="collapsed"){a.state="expanded";openRow(a);imgElem.src="/_layouts/images/MDNExpanded.png"}else if(a.state=="expanded"){a.state="collapsed";setRowStyles(a,"none");imgElem.src="/_layouts/images/MDNCollapsed.png"}checkScroll()}function TermInfo(b,c,d,a){a:;this.termId=b;this.label=c;this.wssId=d;this.hasChildren=a}function getTermInfo(a){a:;termId=a.attributes.getNamedItem("a9").nodeValue;labelAttr=a.getElementsByTagName("LS")[0].getElementsByTagName("TL")[0].attributes.getNamedItem("a32");if(labelAttr!=null)label=labelAttr.nodeValue;else label="";wssIdAttr=a.attributes.getNamedItem("a1000");if(wssIdAttr!=null)wssId=wssIdAttr.nodeValue;else wssId="0";tmNodes=a.getElementsByTagName("TMS")[0].getElementsByTagName("TM");if(tmNodes.length>0)hasChildrenAttr=tmNodes[0].attributes.getNamedItem("a69");if(hasChildrenAttr!=null)hasChildren=hasChildrenAttr.nodeValue=="true";else hasChildren=false;return new TermInfo(termId,label,wssId,hasChildren)}var objXMLHTTPRequest,userContext;function onResponse(){a:;if(objXMLHTTPRequest.readyState!=4)return;objXMLHTTPRequest.onreadystatechange=event_noop;resultElement=objXMLHTTPRequest.responseXML.getElementsByTagName(userContext[2])[0];resultText=resultElement.nodeTypedValue;xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async="false";xmlDoc.loadXML(resultText);termElements=xmlDoc.getElementsByTagName("T");var c=userContext[0],g=userContext[1],j=c.parentElement,f=c.depth-0,h=f+1;for(i=0;i<termElements.length;i++){var d=getTermInfo(termElements[i]),a=j.insertRow(c.rowIndex+i+1);a.fieldName=c.fieldName;a.onmousedown=setsortingfields;a.state="notloaded";a.depth=h;a.sspId=c.sspId;a.lcid=c.lcid;a.termsetId=c.termsetId;a.webId=c.webId;a.listId=c.listId;var e=a.insertCell();e.FILTERFIELDS="FilterField1="+a.fieldName+"&FilterValue1="+d.wssId+"&ForceRecursive=TRUE&DisplayValue="+escapeProperly(d.label)+"&TermId="+d.termId+"&FilterOp1=In&FilterLookupId1=1";e.ondblclick=addAttr;e.className="ms-odcatcell";e.style.cssText="padding-left: "+21*h+" !important";var b="";if(d.hasChildren){b='<img border="0" class="ms-middleimg" src="/_layouts/images/MDNCollapsed.png" onclick="toggleTaxonomy(';b+="&quot;"+a.sspId+"&quot;,";b+="&quot;"+a.lcid+"&quot;,";b+="&quot;"+d.termId+"&quot;,";b+="&quot;"+a.termsetId+"&quot;,";b+="&quot;"+a.webId+"&quot;,";b+="&quot;"+a.listId+"&quot;";b+=')" style="margin-left:4px" />';b+='<img class="ms-middleimg" src="'+GetThemedImageUrl("EMMTerm.png")+'" style="margin-left:2px; margin-right:2px" ondblclick="addAttr();" onmousedown="setsortingfields(this.parentNode);" />'}else b+='<img class="ms-middleimg" onmousedown="setsortingfields(this.parentNode);" src="'+GetThemedImageUrl("EMMTerm.png")+'" style="margin: 2px 2px 2px 21px;" />';b+=STSHtmlEncode(d.label);b+='<img class="Hidden ms-middleimg" SORTINGFIELDS=';b+='"'+e.FILTERFIELDS+'"';b+=' src="/_layouts/images/goviewfiles.png" style="margin-left:30px" />';e.innerHTML=b}c.state="expanded";if(f>1)g.onclick=toggle;else c.onclick=toggle;g.src="/_layouts/images/MDNExpanded.png";checkScroll()}function event_noop(){}function populateTaxRowChildren(c,f,d,e,a,b){a:;objXMLHTTPRequest=null;if("undefined"==typeof XMLHttpRequest)objXMLHTTPRequest=new ActiveXObject("Microsoft.XMLHTTP");else objXMLHTTPRequest=new XMLHttpRequest;url=location.href;url=url.substring(0,url.indexOf("/_vti_bin/"))+"/_vti_bin/taxonomyclientservice.asmx";objXMLHTTPRequest.open("POST",url,true);objXMLHTTPRequest.setRequestHeader("Content-Type","text/xml; charset=utf-8");if(a!=null)objXMLHTTPRequest.setRequestHeader("SOAPAction",'"http://schemas.microsoft.com/sharepoint/taxonomy/soap/GetChildTermsInTerm"');else objXMLHTTPRequest.setRequestHeader("SOAPAction",'"http://schemas.microsoft.com/sharepoint/taxonomy/soap/GetChildTermsInTermSet"');objXMLHTTPRequest.onreadystatechange=onResponse;soapRequest='<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body>';if(a!=null)soapRequest+='<GetChildTermsInTerm xmlns="http://schemas.microsoft.com/sharepoint/taxonomy/soap/">';else soapRequest+='<GetChildTermsInTermSet xmlns="http://schemas.microsoft.com/sharepoint/taxonomy/soap/">';soapRequest+="<sspId>"+d+"</sspId><lcid>"+e+"</lcid>";if(a!=null)soapRequest+="<termId>"+a+"</termId><termSetId>"+b+"</termSetId></GetChildTermsInTerm>";else soapRequest+="<termSetId>"+b+"</termSetId></GetChildTermsInTermSet>";soapRequest+="</soap:Body></soap:Envelope>";userContext=[c,imgElem,a!=null?"GetChildTermsInTermResult":"GetChildTermsInTermSetResult"];objXMLHTTPRequest.send(soapRequest)}function toggleTaxonomy(e,g,d,b,f,c){a:;var a=window.event.srcElement;while(a!=null&&a.tagName.toLowerCase()!="tr")a=a.parentNode;if(a==null)return;imgElem=a;while(imgElem!=null&&imgElem.tagName.toLowerCase()!="img")imgElem=imgElem.firstChild;if(imgElem==null)return;if(a.state=="collapsed"){a.state="expanded";openRow(a);imgElem.src="/_layouts/images/MDNExpanded.png"}else if(a.state=="notloaded")populateTaxRowChildren(a,imgElem,e,g,d,b,f,c);else if(a.state=="expanded"){a.state="collapsed";setRowStyles(a,"none");imgElem.src="/_layouts/images/MDNCollapsed.png"}checkScroll()}function addAttr(){a:;clickedElement=window.event.srcElement;selectedElement=clickedElement;while(selectedElement.tagName!="TD")selectedElement=selectedElement.parentNode;clickedElement.setAttribute("SORTINGFIELDS",selectedElement.getAttribute("FILTERFIELDS"))}$_global_taxtreeview();