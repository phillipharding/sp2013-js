function $_global_contentfollowing(){RegisterSod("userprofile","/_layouts/15/SP.UserProfiles.js");(function(){var e,j=9427,i=9428,g=3,h={Document:"0x01FC00A1B06EC3D1F64BC6A842CF614178A523",Site:"0x01FC00533CDB8F4EAE447D941948EFAE32BFD5"},b={renderFollowButton:function(b){var h=b.Url,c=b.Title,e="ContentFollowing_StopFollowing('"+STSScriptEncode(h)+"', '"+STSScriptEncode(c)+"', this); return false;",f=String.format(Strings.STS.L_StopFollowingTitle,c),g=a.getElementId(b,"contentFollowingButton_"),d=['<a href="#" onclick=',a.encodeAttributeValue(e)," title=",a.encodeAttributeValue(f)," id=",a.encodeAttributeValue(g),' class="ms-contentFollowing-followButton">','<span class="ms-contentFollowing-followingSpan">','<img class="ms-contentFollowing-followingImg" src=',a.encodeAttributeValue(GetThemedImageUrl("socialcommon.png")),">","</span>","</a>"].join("");return d},renderFollowCommand:function(b){var h=b.Url,c=a.getItemTitle(b),e="ContentFollowing_StopFollowing('"+STSScriptEncode(h)+"', '"+STSScriptEncode(c)+"', this); return false;",f=String.format(Strings.STS.L_StopFollowingTitle,c),g=a.getElementId(b,"contentFollowingButton_"),d=['<a href="#" class="ms-secondaryCommandLink" onclick=',a.encodeAttributeValue(e)," title=",a.encodeAttributeValue(f)," id=",a.encodeAttributeValue(g),">","<span>",STSHtmlEncode(Strings.STS.L_StopFollowingCommand),"</span>","</a>"].join("");return d},renderItemTitle:function(b,e){var h=b.Url,i=b.ID,g=b["File_x0020_Type.mapapp"],d=a.getItemName(b,e),f=a.getElementId(b,"contentFollowingLink_"),c=['<span class="ms-contentFollowing-itemTitle">',"<a href=",a.encodeAttributeValue(h),' class="js-contentFollowing-itemLink ms-textLarge ms-recs-titleLink" id=',a.encodeAttributeValue(f)," itemid=",a.encodeAttributeValue(i)," app=",a.encodeAttributeValue(g),">",a.encodeTextValue(d),"</a>","</span>"].join("");return c},renderItemIcon:function(b){var g=b.Url,i=b.ID,c=b.IconUrl;if(c=="")if(a.verifyItemType(b,h.Site))c="/_layouts/15/images/siteIcon.png?rev=23";else return"";var d=a.getItemTitle(b),f=a.getElementId(b,"contentFollowingIcon_"),e=["<a href=",a.encodeAttributeValue(g)," id=",a.encodeAttributeValue(f)," itemid=",a.encodeAttributeValue(i),' class="ms-contentFollowing-itemIcon js-contentFollowing-itemLink">','<img border="0" title=',a.encodeAttributeValue(d)," src=",a.encodeAttributeValue(c),"/>","</a>"].join("");return e},renderItemUrl:function(b){var e=b.Url,d=a.getElementId(b,"contentFollowingUrl_"),c=['<div class="js-contentFollowing-itemUrlDiv" id=',a.encodeAttributeValue(d)," url=",a.encodeAttributeValue(e),">",'<span class="ms-metadata ms-contentFollowing-itemUrl"></span>','<input type="text" readonly="readonly" class="ms-metadata ms-contentFollowing-itemUrl ms-contentFollowing-itemFullUrl" />',"</div>"].join("");return c},renderItemUrls:function(){m$(".js-contentFollowing-itemUrlDiv").forEach(function(d){var e=d.childNodes[0],b=d.childNodes[1];if(e==null||b==null)return;var c=d.getAttribute("url");if(typeof decodeURIComponent!="undefined")c=decodeURIComponent(c);var f=a.getTruncatedUrl(e,c,d.offsetWidth);b.value=f;b.style.visibility="visible";b.style.borderColor="transparent";b.style.backgroundColor="transparent";e.innerHTML="";m$(b).mouseup(function(a){m$.isFunction(a.preventDefault)&&a.preventDefault()});m$(b).focus(function(){b.value=encodeURI(c);b.select()});m$(b).blur(function(){b.value=f})})},renderItemUrlsDefer:function(){e!=null&&clearTimeout(e);e=setTimeout(b.renderItemUrls,150)},renderLinkOnclick:function(b){var c=b.ListData;if(m$.isUndefinedOrNull(c))return;var a=c.Row;if(m$.isUndefinedOrNull(a))return;m$(".js-contentFollowing-itemLink").forEach(function(e){for(var h=e.getAttribute("itemid"),f=0;f<a.length;f++){var c=a[f];if(m$.isUndefinedOrNull(c))continue;if(c.ID==h){var g=c.Url;m$(e).click(function(a){d.navigateToItem(g,a,e,c,b);m$.isFunction(a.preventDefault)&&a.preventDefault()});break}}})},renderSitesAttractMode:function(b){var a=b.ListSchema,c=['<div class="ms-attractMode-Background">','<div class="ms-attractMode-Wrapper">','<div class="ms-attractMode-Cell">','<img src="',"/_layouts/15/images/AttractModeFollowStar.128x128x32.png?rev=23",'" class="ms-attractMode-Icon" />',"</div>",'<div class="ms-attractMode-Spacer ms-attractMode-Cell"></div>','<div class="ms-attractMode-Cell">','<span class="ms-attractMode ms-attractMode-Text">',STSHtmlEncode(a.NoListItem),"</span>","</div></div></div>"];return c.join("")}},a={getItemTitle:function(b){return STSHtmlDecode(b.Title)},getItemName:function(d,c){var a=STSHtmlDecode(d.Title);if(c.BaseViewID==1&&a!=null){var b=a.lastIndexOf(".");a=b>=0?a.substring(0,b):a}return a},getElementId:function(a,b){var c=a.ID;return b+c},getTruncatedUrl:function(c,b,g){var d="...",f=d.length,e=2+f;c.innerHTML=b;while(c.offsetWidth>g){b=a.safeTruncateString(b,b.length-e)+d;c.innerHTML=b}return c.innerHTML},safeTruncateString:function(b,a){var c=b.charCodeAt(a-1);if((c&SURROGATE_6_BIT)===HIGH_SURROGATE_BITS)a=a-1;return b.substr(0,a)},setButtonStateToWaiting:function(b){b.title="";b.onclick=function(){};var c=a.getImgElementFromButton(b);if(Boolean(c)){c.src="/_layouts/15/images/loading.gif?rev=23";c.className=""}},setButtonStateToFollowed:function(g,e,b){b.title=String.format(Strings.STS.L_StopFollowingTitle,e);var c=a.getImgElementFromButton(b);if(Boolean(c)){c.src=GetThemedImageUrl("socialcommon.png");c.className="ms-contentFollowing-followingImg"}else{var f=b.firstChild;if(Boolean(f))f.innerHTML=STSHtmlEncode(Strings.STS.L_StopFollowingCommand)}b.onclick=function(){d.stopFollowing(g,e,b);return false}},setButtonStateToNotFollowed:function(g,e,b){b.title=String.format(Strings.STS.L_StartFollowingTitle,e);var c=a.getImgElementFromButton(b);if(Boolean(c)){c.src=GetThemedImageUrl("socialcommon.png");c.className="ms-contentFollowing-notFollowingImg"}else{var f=b.firstChild;if(Boolean(f))f.innerHTML=STSHtmlEncode(Strings.STS.L_StartFollowingCommand)}b.onclick=function(){d.startFollowing(g,e,b);return false}},getImgElementFromButton:function(b){var a=b.firstChild;if(a!=null)a=a.firstChild;if(a.nodeName.toUpperCase()!="IMG")a=null;return a},displayNavigateFailedDialog:function(e,f){var d=['<div style="padding-bottom: 24px;">',a.encodeTextValue(f),"</div>",'<div style="text-align: right;">','<button id="ms-OkBtnDismissDlg" class="ms-ButtonHeightWidth" onclick="SP.UI.ModalDialog.commonModalDialogClose(SP.UI.DialogResult.OK, null);">',a.encodeTextValue(Strings.STS.L_CloseButtonCaption),"</button>","</div>"].join(""),b=document.createElement("div");b.className="s4-dlg-err";b.innerHTML=d;var g={html:b,title:e,allowMaximize:false},h=new SP.UI.ModalDialog.showModalDialog(g),c=document.getElementById("ms-OkBtnDismissDlg");c!=null&&c.focus()},verifyItemType:function(c,a){var b=c.ContentTypeId;return b.indexOf(a)===0},encodeAttributeValue:function(a){if(m$.isUndefinedOrNull(a))a="";return StAttrQuote(a)},encodeTextValue:function(a){if(m$.isUndefinedOrNull(a))a="";return STSHtmlEncode(a)}},d={startFollowing:function(c,d,b){if(b==null||typeof b=="undefined")return;a.setButtonStateToWaiting(b);SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){SP.SOD.executeFunc("userprofile","SP.UserProfiles.ProfileLoader",function(){var e=SP.ClientContext.get_current(),f=SP.UserProfiles.ProfileLoader.getProfileLoader(e).getUserProfile(),h=f.get_followedContent();e.load(f);h.follow(c,null);e.executeQueryAsync(function(){a.setButtonStateToFollowed(c,d,b);if(typeof GetWSA!="undefined"){var e=GetWSA();typeof e!="undefined"&&e!=null&&e.setDw(j,g)}},function(){a.setButtonStateToNotFollowed(c,d,b)})})})},stopFollowing:function(c,d,b){a.setButtonStateToWaiting(b);if(b==null||typeof b=="undefined")return;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){SP.SOD.executeFunc("userprofile","SP.UserProfiles.ProfileLoader",function(){var e=SP.ClientContext.get_current(),f=SP.UserProfiles.ProfileLoader.getProfileLoader(e).getUserProfile(),h=f.get_followedContent();e.load(f);h.stopFollowing(c);e.executeQueryAsync(function(){a.setButtonStateToNotFollowed(c,d,b);if(typeof GetWSA!="undefined"){var e=GetWSA();typeof e!="undefined"&&e!=null&&e.setDw(i,g)}},function(){a.setButtonStateToFollowed(c,d,b)})})})},navigateToItem:function(c,f,d,b,e){SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){SP.SOD.executeFunc("userprofile","SP.UserProfiles.ProfileLoader",function(){var i=SP.ClientContext.get_current(),j=SP.UserProfiles.ProfileLoader.getProfileLoader(i).getUserProfile(),k=j.get_followedContent(),g=k.findAndUpdateFollowedItem(c);i.executeQueryAsync(function(){if(m$.isDefinedAndNotNull(g))if(a.verifyItemType(b,h.Site))window.location.href=g.get_url();else{d.href=g.get_url();b["File_x0020_Type.url"]="FALSE";b.FSObjType="0";b["File_x0020_Type.progid"]=g.get_fileTypeProgid();b["serverurl.progid"]=encodeURI(g.get_serverUrlProgid());var i=e.ListSchema;smartOpenFileOrFolderFromHref(f,d,b,i)}else STSNavigate(c)},function(){STSNavigate(c)})})});return false}},c={viewTemplate:function(a){var b=[a.RenderHeader(a),a.RenderBody(a),a.RenderFooter(a)];return b.join("")},headerTemplate:function(b){var g=b.ListSchema,d=b.ListData,f=m$.isUndefinedOrNull(d.Row)?"ms-emptyView":"ms-listviewtable ms-contentFollowing-table",e=["<table class=",a.encodeAttributeValue(f),' ms-core-tableNoSpace ms-fillBox" id=',a.encodeAttributeValue(b.listName+"-"+g.View),">"];if(b.BaseViewID==2){var c="ms-webpart-titleText ms-contentFollowing-titleArea";if(d.Row.length>0)c+=" ms-contentFollowing-titleAreaBorder";e.push('<thead><tr><td colspan="6" class="'+c+'">'+a.encodeTextValue(Strings.STS.L_FollowedSites_Title)+"</span></td></tr></thead>")}return e.join("")},footerTemplate:function(a){var c=[];if(a.BaseViewID==2&&a.ListData.Row.length==0)c.push(b.renderSitesAttractMode(a));else RenderEmptyText(c,a);RenderPaging(c,a);return c.join("")},itemTemplate:function(e){for(var d=e.CurrentItem,k=e.ListSchema,i=a.getElementId(d,"contentFollowingRow_"),c=[],f=-1,j=e.ListData.Row.length,g=0;g<j;g++)if(d===e.ListData.Row[g]){f=g;break}var h="ms-contentFollowing-itemCell";if(f%2==0){c.push("<tr>");h+=" ms-contentFollowing-itemFirstCell"}c=c.concat(['<td colspan="3" class="'+h+'" iid=',a.encodeAttributeValue(e.ctxId+","+d.ID+","+d.FSObjType),">",'<div class="ms-contentFollowing-itemDiv">','<table class="ms-core-tableNoSpace ms-fillBox">',"<tr id=",a.encodeAttributeValue(i),">"]);if(e.BaseViewID==1)c=c.concat(['<td class="ms-contentFollowing-itemIconCell">',b.renderItemIcon(d),"</td>"]);c=c.concat(['<td valign="top">',"",b.renderItemTitle(d,e),"<br />",b.renderItemUrl(d),b.renderFollowCommand(d,i),"</td>","</tr>","</table>","</div>","</td>"]);(f%2==1||f+1==j)&&c.push("</tr>");return c.join("")},postRender:function(a){b.renderItemUrls();b.renderLinkOnclick(a);m$(window).resize(b.renderItemUrlsDefer);var d="MSOZoneCell_WebPart"+a.wpq,c=document.getElementById(d);Boolean(c)&&c.setAttribute("onmouseup","")}},f=function(b){var a={};a.Templates={};a.BaseViewID=b;a.ListTemplateType=550;a.Templates.View=c.viewTemplate;a.Templates.Header=c.headerTemplate;a.Templates.Item=c.itemTemplate;a.Templates.Footer=c.footerTemplate;a.Templates.OnPostRender=c.postRender;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(a)};f(1);f(2);window.ContentFollowing_StopFollowing=d.stopFollowing})();typeof NotifyScriptLoadedAndExecuteWaitingJobs=="function"&&NotifyScriptLoadedAndExecuteWaitingJobs("contentfollowing.js")}$_global_contentfollowing();