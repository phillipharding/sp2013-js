function $_global_pivotcontrol(){if(typeof window.ClientPivotControl=="undefined"){window.ClientPivotControl=function(a){this.AllOptions=[];if(a!=null){this.PivotParentId=a.PivotParentId;this.PivotContainerId=a.PivotContainerId;if(typeof a.AllOptions!="undefined")this.AllOptions=a.AllOptions;if(typeof a.SurfacedPivotCount=="number")this.SurfacedPivotCount=Number(a.SurfacedPivotCount);if(typeof a.ShowMenuIcons!="undefined")this.ShowMenuIcons=Boolean(a.ShowMenuIcons);if(typeof a.ShowMenuClose!="undefined")this.ShowMenuClose=a.ShowMenuClose;if(typeof a.ShowMenuCheckboxes!="undefined")this.ShowMenuCheckboxes=a.ShowMenuCheckboxes;if(typeof a.Width!="undefined")this.Width=a.Width}else this.PivotContainerId="clientPivotControl"+ClientPivotControl.PivotControlCount.toString();this.OverflowDotId=this.PivotContainerId+"_overflow";this.OverflowMenuId=this.PivotContainerId+"_menu";ClientPivotControl.PivotControlCount++;ClientPivotControl.PivotControlDict[this.PivotContainerId]=this};ClientPivotControl.PivotControlDict=[];ClientPivotControl.PivotControlCount=0;ClientPivotControl.prototype={PivotParentId:"",PivotContainerId:"",OverflowDotId:"",OverflowMenuId:"",AllOptions:[],SurfacedPivotCount:3,ShowMenuIcons:false,ShowMenuClose:false,ShowMenuCheckboxes:false,OverflowMenuScript:"",Width:"",SurfacedOptions:[],OverflowOptions:[],SelectedOptionIdx:-1,AddMenuOption:function(a){(ClientPivotControl.IsMenuOption(a)||ClientPivotControl.IsMenuCheckOption(a))&&this.AllOptions.push(a)},AddMenuSeparator:function(){if(this.AllOptions.length==0)return;var a=this.AllOptions[this.AllOptions.length-1];if(ClientPivotControl.IsMenuSeparator(a))return;this.AllOptions.push(new ClientPivotControlMenuSeparator)},Render:function(){if(this.PivotParentId==null||this.PivotParentId=="")return;var a=document.getElementById(this.PivotParentId);if(a==null)return;a.innerHTML=this.RenderAsString();if(this.Width!="")a.style.width=this.Width},RenderAsString:function(){this.ProcessAllMenuItems();this.EnsureSelectedOption();var c=this.SurfacedOptions.length;if(c==0)return"";var a=[];a.push('<span class="ms-pivotControl-container" id="');a.push(STSHtmlEncode(this.PivotContainerId));a.push('">');for(var b=0;b<c;b++)a.push(this.RenderSurfacedOption(b));this.ShouldShowOverflowMenuLink()&&a.push(this.RenderOverflowMenuLink());a.push("</span>");return a.join("")},ShouldShowOverflowMenuLink:function(){return this.OverflowOptions.length>0||this.OverflowMenuScript!=null&&this.OverflowMenuScript!=""},ShowOverflowMenu:function(){var f=this.OverflowOptions.length,g=document.getElementById(this.OverflowDotId);if(g==null||f==0)return;MenuHtc_hide();for(var c=CMenu(this.OverflowMenuId),b=0;b<f;b++){var a=this.OverflowOptions[b],d=ClientPivotControl.IsMenuCheckOption(a);if(ClientPivotControl.IsMenuOption(a)||d){var e=CAMOpt(c,a.DisplayText,a.OnClickAction,a.ImageUrl,a.ImageAltText,String(100*b),a.Description);e.id="ID_OverflowOption_"+String(b);d&&e.setAttribute("checked",a.Checked)}else ClientPivotControl.IsMenuSeparator(a)&&CAMSep(c)}!this.ShowMenuIcons&&c.setAttribute("hideicons","true");var h=Boolean(document.body.WZ_ATTRIB_FLIPPED);document.body.WZ_ATTRIB_FLIPPED=false;OMenu(c,g,null,false,-2,this.ShowMenuClose,this.ShowMenuCheckboxes);document.body.WZ_ATTRIB_FLIPPED=h},RenderSurfacedOption:function(c){if(c<0||c>=this.SurfacedOptions.length)return"";var b=this.SurfacedOptions[c],d="ms-pivotControl-surfacedOpt";if(b.SelectedOption)d+="-selected";var a=[];a.push('<a class="');a.push(d);a.push('" href="#" id="');a.push(STSHtmlEncode(this.PivotContainerId+"_surfaceopt"+c.toString()));a.push('" onclick="');a.push(STSHtmlEncode(b.OnClickAction));a.push(' return false;" alt="');a.push(STSHtmlEncode(b.DisplayText));a.push('" >');a.push(STSHtmlEncode(b.DisplayText));a.push("</a>");return a.join("")},RenderOverflowMenuLink:function(){var b=this.OverflowMenuScript;if(b==null||b=="")b="ClientPivotControlExpandOverflowMenu(event);";var a=[];a.push('<span class="ms-pivotControl-overflowSpan" data-containerId="');a.push(STSHtmlEncode(this.PivotContainerId));a.push('" id="');a.push(STSHtmlEncode(this.OverflowDotId));a.push('" title="');a.push(STSHtmlEncode(Strings.STS.L_ClientPivotControlOverflowMenuAlt));a.push('" ><a class="ms-pivotControl-overflowDot" href="#" onclick="');a.push(STSHtmlEncode(b));a.push('" alt="');a.push(STSHtmlEncode(Strings.STS.L_ClientPivotControlOverflowMenuAlt));a.push('" >');a.push('<img class="ms-ellipsis-icon" src="');a.push(GetThemedImageUrl("spcommon.png"));a.push('" alt="');a.push(STSHtmlEncode(Strings.STS.L_OpenMenu));a.push('" /></a></span>');return a.join("")},ProcessAllMenuItems:function(){if(this.SurfacedPivotCount<0)this.SurfacedPivotCount=1;this.SurfacedOptions=[];this.OverflowOptions=[];var b=this.AllOptions.length;if(b==0)return;for(var a=0,c=[];a<b;a++){var d=this.AllOptions[a];if(ClientPivotControl.IsMenuSeparator(d))continue;if(c.length==this.SurfacedPivotCount)break;c.push(d)}this.SurfacedOptions=this.SurfacedOptions.concat(c);if(a!=b){for(;a<b;a++)this.OverflowOptions.push(this.AllOptions[a]);var e=this.OverflowOptions[this.OverflowOptions.length-1];ClientPivotControl.IsMenuSeparator(e)&&this.OverflowOptions.pop()}},EnsureSelectedOption:function(){this.SelectedOptionIdx=-1;var i=this.SurfacedOptions.length,h=this.OverflowOptions.length;if(i==0&&h==0)return;for(var a=0;a<this.SurfacedOptions.length;a++){var g=this.SurfacedOptions[a];if(Boolean(g.SelectedOption)&&this.SelectedOptionIdx==-1)this.SelectedOptionIdx=a;else g.SelectedOption=false}for(var d=0;d<this.OverflowOptions.length;d++){var b=this.OverflowOptions[d];if(Boolean(b.SelectedOption)&&this.SelectedOptionIdx==-1)this.SelectedOptionIdx=this.SurfacedOptions.length;else if(ClientPivotControl.IsMenuOption(b))b.SelectedOption=false}if(this.SelectedOptionIdx==-1){this.SelectedOptionIdx=0;this.SurfacedOptions[0].SelectedOption=true}else if(this.SelectedOptionIdx==this.SurfacedOptions.length){var j=this.SurfacedOptions.pop(),f=this.OverflowOptions;this.OverflowOptions=[];this.OverflowOptions.push(j);for(var e=0;e<f.length;e++){var c=f[e];if(Boolean(c.SelectedOption))this.SurfacedOptions.push(c);else this.OverflowOptions.push(c)}this.SelectedOptionIdx=this.SurfacedOptions.length-1}}};window.ClientPivotControlExpandOverflowMenu=function(b){if(b==null)b=window.event;var a=GetEventSrcElement(b);while(a!=null&&a.getAttribute("data-containerId")==null)a=a.parentNode;if(a==null)return;var c;try{c=typeof CMenu}catch(d){c="undefined"}EnsureScript("core.js",c,function(){var b=ClientPivotControl.PivotControlDict[a.getAttribute("data-containerId")];b!=null&&b.ShowOverflowMenu()});b!=null&&CancelEvent(b)};window.ClientPivotControl_InitStandaloneControlWrapper=function(a){if(a==null)return;var b=new ClientPivotControl(a);b.Render()};ClientPivotControl.MenuOptionType={MenuOption:1,MenuSeparator:2,MenuCheckOption:3};ClientPivotControl.IsMenuOption=function(a){return a!=null&&a.MenuOptionType==ClientPivotControl.MenuOptionType.MenuOption};ClientPivotControl.IsMenuCheckOption=function(a){return a!=null&&a.MenuOptionType==ClientPivotControl.MenuOptionType.MenuCheckOption};ClientPivotControl.IsMenuSeparator=function(a){return a!=null&&a.MenuOptionType==ClientPivotControl.MenuOptionType.MenuSeparator};window.ClientPivotControlMenuItem=function(){};ClientPivotControlMenuItem.prototype={MenuOptionType:0};window.ClientPivotControlMenuOption=function(){this.MenuOptionType=ClientPivotControl.MenuOptionType.MenuOption};ClientPivotControlMenuOption.prototype=new ClientPivotControlMenuItem;ClientPivotControlMenuOption.prototype.DisplayText="";ClientPivotControlMenuOption.prototype.Description="";ClientPivotControlMenuOption.prototype.OnClickAction="";ClientPivotControlMenuOption.prototype.ImageUrl="";ClientPivotControlMenuOption.prototype.ImageAltText="";ClientPivotControlMenuOption.prototype.SelectedOption=false;window.ClientPivotControlMenuSeparator=function(){this.MenuOptionType=ClientPivotControl.MenuOptionType.MenuSeparator};ClientPivotControlMenuSeparator.prototype=new ClientPivotControlMenuItem;window.ClientPivotControlMenuCheckOption=function(){this.MenuOptionType=ClientPivotControl.MenuOptionType.MenuCheckOption};ClientPivotControlMenuCheckOption.prototype=new ClientPivotControlMenuItem;ClientPivotControlMenuCheckOption.prototype.Checked=false}typeof Sys!="undefined"&&Sys!=null&&Sys.Application!=null&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs=="function"&&NotifyScriptLoadedAndExecuteWaitingJobs("pivotcontrol.js")}$_global_pivotcontrol();