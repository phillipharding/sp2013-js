function $_global_roamingapps(){if(typeof MSOJS=="undefined")MSOJS={};MSOJS.ClientUtils=function(){var bb="SharePoint.OpenDocuments.5",ab="SharePoint.OpenDocuments.4",Z="SharePoint.OpenDocuments.3",Y="SharePoint.OpenDocuments.2",M="application/x-sharepoint",s="application/x-sharepoint-webkit",C="application/officelive",x="npSharePointPlugin",Nb="IDBHO.IDBHOCtrl",Lb="OneNote.Notebook",nb="ofv|",lb="ofe|",jb="u|",I="RoamingOfficeActiveX.RoamingOffice",Ab="application/x-vnd.officeondemand",Hb="office:",T="",K="",J="",i,h,u,t,A,Q,U,R,V;function Ob(c,a,b){T=c;K=b;J=a}var e={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4},c={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32},b={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4},d={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},a={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};function gb(){return o()&&(y()||S())}function fb(){return y()}function Jb(){return"ActiveXObject"in window&&!r()}function Cb(){return Mb()&&!Rb()&&(k()||y()||n())}function X(){return window.navigator.userAgent.indexOf("Windows")>=0}function r(){return window.navigator.userAgent.indexOf("Windows Phone")>=0}function xb(){if(Boolean(Q))return;Q=true;U=O("Windows NT")}function pb(){if(Boolean(R))return;R=true;V=O("Windows Phone")}function O(d){var c=new RegExp(d+"\\s+(\\d+(\\.\\d*)?)"),b=c.exec(window.navigator.userAgent),a=-1;if(b!=null&&b.length>=2){a=parseFloat(b[1]);if(isNaN(a))a=-1}return a}function Mb(){xb();return U>=6.1}function P(){pb();return V>=8}function Rb(){return window.navigator.userAgent.indexOf("ARM;")>=0}function j(){return typeof navigator.msLaunchUri=="function"&&!r()}function cb(){return j()||m()}function o(){return window.navigator.userAgent.indexOf("Macintosh")>=0}function Pb(){return window.navigator.userAgent.indexOf("PPC Mac")>=0}function k(){return window.navigator.userAgent.indexOf(" MSIE ")>=0}function L(){return!k()?false:window.document.documentMode==8}function m(){return window.navigator.userAgent.indexOf(" Firefox/")>=0}function Qb(){return window.navigator.userAgent.indexOf(" AppleWebKit/")>=0}function n(){var a=window.navigator.userAgent.toLowerCase();return a.indexOf("chrome")>=0}function y(){return Eb()>=3}function S(){return Gb()>=3}function Eb(){return m()?F("firefox/"):0}function Gb(){return Qb()?F("version/"):0}function F(b){var a=window.navigator.userAgent.toLowerCase(),c=a.indexOf(b);if(c>=0){var d=c+b.length,e=a.length;return parseInt(a.substring(d,e))}return 0}function D(c,b,a){if(j())navigator.msLaunchUri(c,b,a);else H(c,b,a)}function H(e,c,b){var d="OICFrame",a=document.getElementById(d);if(a==null){a=document.createElement("iframe");a.id=d;a.className="ObjectInDialog";a.style.visibility="hidden";a.src="about:blank";document.body.appendChild(a)}try{a.contentWindow.location.href=e}catch(f){b!=null&&b();return}c!=null&&c()}function N(a){return(a.Options&c.SkipProtocolHandler)==c.SkipProtocolHandler||L()}function sb(a){return N(a)?false:j()?true:!ob()||p()>=15}function w(){return gb()||fb()}function z(a){return a===e.ReadOnly||a===e.ReadWrite}function mb(b,d,e,c){try{var a=new ActiveXObject(bb);if(a)return a.ViewDocument3(window.self,b,d,c)}catch(f){}return false}function tb(f,i,j,h){var a,e;try{a=new ActiveXObject(ab);if(a){e=a.ViewDocument3(window.self,f,i,h);if(e){g(d.O14ActiveX);return b.None}else return b.Failed}}catch(k){}if(c.O14Only===(j&c.O14Only))return b.Unattempted;try{a=new ActiveXObject(Z);if(a){e=a.ViewDocument3(window.self,f,i,h);if(e){g(d.O12ActiveX);return b.None}else return b.Failed}}catch(k){}if(c.O12UpOnly===(j&c.O12UpOnly))return b.Unattempted;try{a=new ActiveXObject(Y);if(a){if(z(i))e=a.ViewDocument2(window.self,f,h);else e=a.EditDocument2(window.self,f,h);if(e){g(d.O11ActiveX);return b.None}else return b.Failed}}catch(k){}return b.Unattempted}function vb(e,h,f){var c=W();if(c==null)return b.Unattempted;var a=false;try{a=c.ViewDocument3(window.self,e,h,f)}catch(i){}if(!a)try{if(z(h))a=c.ViewDocument2(window.self,e,f);else a=c.EditDocument2(window.self,e,f)}catch(i){}if(a){g(d.NpapiPlugin);return b.None}else return b.Failed}function B(i,j,g,d){var h=hb(i);if(h==null){f(b.Unattempted);return false}if(i==a.Visio&&g==e.ReadWrite)g=e.WriteOnly;var c=h;d=d||r()&&!P();if(!d){if(z(g))c+=nb;else c+=lb;c+=jb}c+=j;D(c,rb,qb);return true}function rb(){g(d.ProtocolHandler)}function qb(){A.Options|=c.SkipProtocolHandler;G(A,i,h)}function zb(){if(j())return true;else if(n()){typeof navigator.plugins.refresh!="undefined"&&navigator.plugins.refresh(false);return Boolean(navigator.mimeTypes[Ab])}else if(m()){var a=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(a);var b=document.createEvent("Events");b.initEvent("RoamingOfficeInstalled",true,false);a.dispatchEvent(b);return Boolean(a.getAttribute("installed"))}else if(k())try{var c=new ActiveXObject(I);return c.HrExists()}catch(d){}return false}function Fb(d,e,f,c,b,a){MSOJS.ClientUtils.LaunchRoamingApps2(d,e,wb(f),c,"x86",T,b,a)}function Db(q,h,o,p,i,l,e,g){var f="";if(p!=null)f+=" "+p;if(q!=null)f+=' "'+q+'"';if(j()||n()){u=e;t=g;var a=Hb;a+=' "'+l+'"';a+=' "'+o+'"';a+=' "ROAMING"';a+=' "'+h+'"';a+=' "'+i+'"';a+=" "+f;D(a,eb,db)}else if(m()){var c=document.createElement("RoamingExtensionElement");c.setAttribute("cabUrl",l);c.setAttribute("app",o);c.setAttribute("licensingEntitlements",h);c.setAttribute("platform",i);c.setAttribute("args",f);document.documentElement.appendChild(c);var s=document.createEvent("Events");s.initEvent("RoamingOfficeLaunch",true,false);c.dispatchEvent(s);e!=null&&e(d.RoamingFFExtension)}else if(k()){var r=new ActiveXObject(I);if(r!=null)try{r.HrConfigureSingle(l,o,h,i,f);e!=null&&e(d.RoamingActiveX)}catch(v){}}else g!=null&&g(b.Failed)}function eb(){u!=null&&u(d.RoamingProtocolHandler)}function db(){t!=null&&t(b.ControlNeeded)}function ib(a){if(typeof a.RoamingAppsLauncher=="undefined"||a.RoamingAppsLauncher==null){f(b.Unattempted);return}if(typeof a.RoamingBitsUrl=="undefined"||a.RoamingBitsUrl==null)MSOJS.ClientUtils.LaunchRoamingApps(a.DocumentUrl,a.RoamingAppsLauncher,a.Application,a.ApplicationParameters,i,h);else MSOJS.ClientUtils.LaunchRoamingApps2(a.DocumentUrl,a.RoamingAppsLauncher,a.RoamingApplicationExe,a.ApplicationParameters,a.RoamingPlatform,a.RoamingBitsUrl,i,h)}function W(){var c=document.getElementById(x);if(c==null){var b=M;if(o()&&S()&&l(s))b=s;if(!l(b))if(o()&&l(C))b=C;else return null;var a=document.createElement("object");a.id=x;a.type=b;a.style.width="0px";a.style.height="0px";a.style.setProperty("visibility","hidden","");document.body.appendChild(a);c=document.getElementById(x)}return c}function l(c){var a=window.navigator.mimeTypes;if(a==null)return false;var b=a[c];return!b?false:!b.enabledPlugin?false:true}function q(a){try{var b=new ActiveXObject(a);if(b!=null)return true}catch(c){}return false}function Ib(){try{var a=new ActiveXObject(Nb);a!=null&&a.SaveSSOCreds()}catch(b){}}function v(b){switch(b){case a.OneNote:return Lb;default:return""}}function hb(b){if(b!=a.OneNote&&r()&&!P())return"office:";switch(b){case a.Excel:return"ms-excel:";case a.OneNote:return"onenote:";case a.PowerPoint:return"ms-powerpoint:";case a.Visio:return"ms-visio:";case a.Word:return"ms-word:";case a.Project:return"ms-project:";case a.Publisher:return"ms-publisher:";case a.Infopath:return"ms-infopath:";case a.Access:return"ms-access:";default:return""}}function wb(b){switch(b){case a.Excel:return"root\\office15\\excel.exe";case a.PowerPoint:return"root\\office15\\powerpnt.exe";case a.Visio:return"root\\office15\\visio.exe";case a.Word:return"root\\office15\\winword.exe";case a.Project:return"root\\office15\\winproj.exe";case a.Publisher:return"root\\office15\\mspub.exe";case a.Infopath:return"root\\office15\\infopath.exe";case a.Access:return"root\\office15\\msaccess.exe";default:return null}}function kb(){this.DocumentUrl="";this.Mode=0;this.Options=0;this.Application=a.Unknown;this.CouldUseRoamingApps=false;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=false;this.ApplicationParameters="";this.RoamingPlatform="";this.RoamingApplicationExe="";this.RoamingBitsUrl=""}function G(j,o,n){A=j;i=o;h=n;if(!j.DocumentUrl){f(b.Unattempted);return}var m=decodeURIComponent(j.DocumentUrl);if(j.Mode===e.ReadWrite&&c.CheckoutRequired===(j.Options&c.CheckoutRequired))j.Mode=e.ForceCheckout;if(c.HostIsEditOnly===(j.Options&c.HostIsEditOnly))j.Mode=e.WriteOnly;if(sb(j)){B(j.Application,j.DocumentUrl,j.Mode,j.Application==a.OneNote);return}else if(L())if(mb(m,j.Mode,j.Options,v(j.Application))){g(d.O15ActiveX);return}if(j.CouldUseRoamingApps&&Cb()&&j.Application!=a.OneNote){if(!MSOJS.ClientUtils.CanUseRoamingControl()){f(b.ControlNeeded);return}if(j.RoamingAppsLauncher){ib(j);return}if(!j.ContinueIfLauncherIsNull){f(b.LauncherNeeded);return}}var l;if(w())l=vb(m,j.Mode,v(j.Application));else{Ib();l=tb(m,j.Mode,j.Options,v(j.Application))}if(l!=b.None){if(c.NoProtocolHandlerFallback!=(j.Options&c.NoProtocolHandlerFallback)&&!N(j)&&!k()){B(j.Application,j.DocumentUrl,j.Mode,j.Application==a.OneNote);return}f(l)}}function g(a){i!=null&&i(a)}function f(a){h!=null&&h(a)}function ob(){return w()||Jb()||n()}function p(){var a=0;if(w()||n()){var b=W();try{if(b!=null)a=b.GetOfficeVersion()}catch(c){}}else if(q(bb))a=15;else if(q(ab))a=14;else if(q(Z))a=12;else if(q(Y))a=11;return a}function E(){return o()&&(l(M)||l(s))}function Bb(){return X()&&p()<=11}function ub(){return X()&&p()<15}function Kb(){return o()&&!Pb()&&!E()}function yb(){if(m())window.InstallTrigger.install({Office:{URL:K}});else H(J,null,null)}return{OpenDocumentMode:e,OpenDocumentOptions:c,OpenDocumentFailureType:b,OpenDocumentControl:d,OfficeApplication:a,EditDocumentInClient:G,EditDocumentInClientParams:kb,OfficeVersionInstalled:p,IsO14MacPluginInstalled:E,OfferOfficeInDialog:Bb,OfferOfficeNoIntrusive:ub,OfferMacOffice:Kb,InstallRoamingControl:yb,CanUseRoamingControl:zb,InitUrls:Ob,LaunchRoamingApps:Fb,LaunchRoamingApps2:Db,SupportsProtocolHandlerDetection:cb}}();SPRoamingAppLauncher.prototype={EntitlementBitmap:0,HasEntitlements:false,AppLauncherToken:null,RoamingAppsServiceUrl:null,ExtensionInstallPollInterval:500,AppLaunchRetryInterval:1e3,AppTokenExpirationTime:5*60*1e3,LastAppTokenTime:0,LastAppToken:null,LastAppId:0,InstallingExtension:false};SPRoamingAppLauncher.prototype.InitializeRoamingApplicationLaunch=function(){this.ShowCheckingEntitlementText();var b=this,a=new XMLHttpRequest;a.open("POST",this.RoamingAppsServiceUrl+"?cmd=GetEntitlement",true);a.onreadystatechange=function(){if(a.readyState==4){var c=a.responseText;b.ProcessRoamingData(c)}};a.send(null)};SPRoamingAppLauncher.prototype.ProcessRoamingData=function(d){if(this.ParseEntitlementData(d))if(this.HasEntitlements){var c=GetUrlKeyValue("app"),b=Boolean(c)?GetAppIdFromAppQueryName(c):MSOJS.ClientUtils.OfficeApplication.Unknown;if(b!=MSOJS.ClientUtils.OfficeApplication.Unknown){var a=GetUrlKeyValue("doc");a=Boolean(a)?a:"";this.LaunchApplication(b,a)}else this.ShowRoamingAppLaunchLinks()}else this.ShowNoSubscriptionText();else this.ShowNoSubscriptionText()};SPRoamingAppLauncher.prototype.ParseEntitlementData=function(b){var a=null;try{a=JSON.parse(b)}catch(c){}if(a!=null){this.EntitlementBitmap=parseInt(a.EntitlementBitmap);this.HasEntitlements=this.EntitlementBitmap!=0;this.HasEntitlements&&MSOJS.ClientUtils.InitUrls(a.InstallUrl,a.ProtocolHandler,a.FirefoxExtensionUrl);return true}else return false};SPRoamingAppLauncher.prototype.GetRoamingAppLauncherToken=function(b,d){if(this.LastAppId!=0&&this.LastAppTokenTime!=0&&b==this.LastAppId&&+new Date-this.LastAppTokenTime<this.AppTokenExpirationTime)d(this.LastAppToken);else{var c=this,e=GetLicAppBitsFromApplication(b),a=new XMLHttpRequest;a.open("POST",this.RoamingAppsServiceUrl+"?cmd=GetAppToken&appId="+String(e),true);a.onreadystatechange=function(){if(a.readyState==4){var e="";try{e=JSON.parse(a.responseText)}catch(f){}c.LastAppTokenTime=+new Date;c.LastAppToken=e;c.LastAppId=b;d(e)}};a.send(null)}};SPRoamingAppLauncher.prototype.ShowRoamingAppLaunchLinks=function(){this.EmptyStatusArea();var c=document.getElementById("officeAppIcons");for(var f in MSOJS.ClientUtils.OfficeApplication){var a=MSOJS.ClientUtils.OfficeApplication[f];if(this.IsUserLicensedForApp(a)){var e="ms-roamingapps-iconouter-"+String(a),d="ms-roamingapps-iconinner-"+String(a),b=document.createElement("div");b.className="ms-roamingapps-appicon";b.id="appLauncher_"+String(a);b.innerHTML='<a href="#" onclick="g_RoamingAppLauncher.LaunchApplication('+String(a)+')"><span class="'+e+'"><img class="'+d+'" src="/_layouts/15/images/sproaming.png?rev=23"/></span><div class="ms-textLarge">'+GetAppNameFromApplication(a)+"</div></a>";c.appendChild(b)}}};SPRoamingAppLauncher.prototype.LaunchApplication=function(b,a,e,d){if(this.IsUserLicensedForApp(b)){this.ShowAppLaunchingText();var c=this;this.GetRoamingAppLauncherToken(b,function(f){if(f!=null&&f!=""){var l=f.extensionData,h=f.licensing,j=f.offerVersion,k=f.officeApplication,i=f.platform,g=c;c.EnsureRoamingExtensionAndCallback(function(){a=Boolean(a)?a:"";var e={docUrl:a,appId:b},c=function(){MSOJS.ClientUtils.LaunchRoamingApps2(a,h,k,null,i,j,function(){g.SuccessCallback(g)},function(a){g.FailureCallback(e,a)})};if(Boolean(d))setTimeout(c,g.AppLaunchRetryInterval);else c()},Boolean(e))}else c.ShowNoSubscriptionText()})}};SPRoamingAppLauncher.prototype.SuccessCallback=function(a){this.InstallingExtension=false;var b=_dlgWndTop();while(b.g_childDialog!=null)commonModalDialogClose(0,null);a.ShowRoamingAppLaunchLinks()};SPRoamingAppLauncher.prototype.FailureCallback=function(a,b){if(b==MSOJS.ClientUtils.OpenDocumentFailureType.ControlNeeded)a!=null&&this.LaunchApplication(a.appId,a.docUrl,!this.InstallingExtension,true)};SPRoamingAppLauncher.prototype.IsUserLicensedForApp=function(b){var a=GetLicAppBitsFromApplication(b);return(this.EntitlementBitmap&a)!=0};SPRoamingAppLauncher.prototype.EnsureRoamingExtensionAndCallback=function(a,b){var c=this;if(this.IsRoamingExtensionInstalled()&&!b)a();else{this.InstallRoamingExtension();this.InstallingExtension=true;setTimeout(function(){c.WaitUntilExtensionInstalledAndCallback(a)},this.ExtensionInstallPollInterval)}};SPRoamingAppLauncher.prototype.WaitUntilExtensionInstalledAndCallback=function(a){if(this.IsRoamingExtensionInstalled())a();else{var b=this;setTimeout(function(){b.WaitUntilExtensionInstalledAndCallback(a)},this.ExtensionInstallPollInterval)}};SPRoamingAppLauncher.prototype.InstallRoamingExtension=function(){this.ShowInstallExtensionDialog();MSOJS.ClientUtils.InstallRoamingControl()};SPRoamingAppLauncher.prototype.IsRoamingExtensionInstalled=function(){return MSOJS.ClientUtils.CanUseRoamingControl()};SPRoamingAppLauncher.prototype.ShowCheckingEntitlementText=function(){var a=document.getElementById("roamingAppStatusArea");a.innerHTML=Strings.STS.L_RoamingOffice_EntitlementCheck;this.VerticallyCenterAlignText(a)};SPRoamingAppLauncher.prototype.ShowNoSubscriptionText=function(){var a=document.getElementById("roamingAppStatusArea");a.innerHTML=Strings.STS.L_RoamingOffice_NoSubscription;this.VerticallyCenterAlignText(a)};SPRoamingAppLauncher.prototype.ShowAppLaunchingText=function(){this.EmptyAppIconContainer();var a=document.getElementById("roamingAppStatusArea");a.innerHTML=Strings.STS.L_RoamingOffice_LaunchingApp;this.VerticallyCenterAlignText(a)};SPRoamingAppLauncher.prototype.ShowInstallExtensionDialog=function(){var a=document.createElement("DIV");a.innerHTML=Strings.STS.L_RoamingOffice_InstallExtension;var b={html:a,title:Strings.STS.L_RoamingOffice_InstallExtensionDialogTitle};EnsureScriptParams("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",b)};SPRoamingAppLauncher.prototype.EmptyStatusArea=function(){var a=document.getElementById("roamingAppStatusArea");a.innerHTML="";a.style.paddingTop="0px"};SPRoamingAppLauncher.prototype.EmptyAppIconContainer=function(){var a=document.getElementById("officeAppIcons");a.innerHTML=""};SPRoamingAppLauncher.prototype.VerticallyCenterAlignText=function(a){a.style.paddingTop="0px";var b=(a.parentNode.clientHeight-a.clientHeight)/2;a.style.paddingTop=String(b)+"px"};g_RoamingAppLauncher=new SPRoamingAppLauncher;typeof NotifyScriptLoadedAndExecuteWaitingJobs=="function"&&NotifyScriptLoadedAndExecuteWaitingJobs("roamingapps.js")}var MSOJS;function SPRoamingAppLauncher(){this.EntitlementBitmap=0;this.HasEntitlements=false;this.AppLauncherToken=null;this.LastAppTokenTime=0;this.LastAppToken=null;this.LastAppId=0;this.InstallingExtension=false}function GetAppNameFromApplication(a){switch(a){case MSOJS.ClientUtils.OfficeApplication.Excel:return Strings.STS.L_RoamingOffice_AppNameExcel;case MSOJS.ClientUtils.OfficeApplication.OneNote:return Strings.STS.L_RoamingOffice_AppNameOneNote;case MSOJS.ClientUtils.OfficeApplication.PowerPoint:return Strings.STS.L_RoamingOffice_AppNamePowerpoint;case MSOJS.ClientUtils.OfficeApplication.Visio:return Strings.STS.L_RoamingOffice_AppNameVisio;case MSOJS.ClientUtils.OfficeApplication.Word:return Strings.STS.L_RoamingOffice_AppNameWord;case MSOJS.ClientUtils.OfficeApplication.Project:return Strings.STS.L_RoamingOffice_AppNameProject;case MSOJS.ClientUtils.OfficeApplication.Publisher:return Strings.STS.L_RoamingOffice_AppNamePublisher;case MSOJS.ClientUtils.OfficeApplication.Infopath:return Strings.STS.L_RoamingOffice_AppNameInfopath;case MSOJS.ClientUtils.OfficeApplication.Access:return Strings.STS.L_RoamingOffice_AppNameAccess;default:return""}}function GetLicAppBitsFromApplication(a){switch(a){case MSOJS.ClientUtils.OfficeApplication.Excel:return 2;case MSOJS.ClientUtils.OfficeApplication.OneNote:return 8;case MSOJS.ClientUtils.OfficeApplication.PowerPoint:return 32;case MSOJS.ClientUtils.OfficeApplication.Visio:return 1024;case MSOJS.ClientUtils.OfficeApplication.Word:return 256;case MSOJS.ClientUtils.OfficeApplication.Project:return 64;case MSOJS.ClientUtils.OfficeApplication.Publisher:return 128;case MSOJS.ClientUtils.OfficeApplication.Infopath:return 512;case MSOJS.ClientUtils.OfficeApplication.Access:return 1;default:return 0}}function GetAppIdFromAppQueryName(a){a=a.toLowerCase();switch(a){case"excel":return MSOJS.ClientUtils.OfficeApplication.Excel;case"onenote":return MSOJS.ClientUtils.OfficeApplication.OneNote;case"powerpoint":return MSOJS.ClientUtils.OfficeApplication.PowerPoint;case"visio":return MSOJS.ClientUtils.OfficeApplication.Visio;case"word":return MSOJS.ClientUtils.OfficeApplication.Word;case"proj":return MSOJS.ClientUtils.OfficeApplication.Project;case"publisher":return MSOJS.ClientUtils.OfficeApplication.Publisher;case"infopath":return MSOJS.ClientUtils.OfficeApplication.Infopath;case"access":return MSOJS.ClientUtils.OfficeApplication.Access;default:return MSOJS.ClientUtils.OfficeApplication.Unknown}}var g_RoamingAppLauncher;function GoBackToSource(){var a=GetSource();if(a!=null&&a!=""){a=unescapeProperly(a);STSNavigate(a)}}$_global_roamingapps();