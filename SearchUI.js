Type.registerNamespace("Srch");Srch.SU=function(){};Srch.SU.toggleRefCategory=function(c,d){try{var e=c.querySelector(".ms-ref-uparrow, .ms-ref-downarrow"),b=c.querySelector(".ms-ref-allSec"),a=c.querySelector(".ms-ref-unselSec");if(!a||a.style.display===""||a.style.display==="block"){e.className="ms-ref-downarrow";if(b)b.style.display="none";if(a)a.style.display="none";Srch.Refinement.setExpanded(d,"false")}else{e.className="ms-ref-uparrow";if(b)b.style.display="";a.style.display="";Srch.Refinement.setExpanded(d,"true")}}catch(f){}};Srch.SU.toggleRefShortLong=function(a,c){try{var d=a.querySelector(".ms-ref-unsel-toggle > .ms-displayInlineBlock")||a.querySelector(".ms-ref-unsel-toggle"),b=a.querySelector(".ms-ref-unsel-shortList"),e=a.querySelector(".ms-ref-unsel-longList");if(b.style.display===""||b.style.display==="block"){b.style.display="none";e.style.display="";d.innerHTML=SP.Utilities.HttpUtility.htmlEncode(Srch.U.loadResource("rf_RefinementLabel_Less"));try{!Srch.U.n(c)&&Srch.SU.ensurePeoplePickerRefinementInit(c)}catch(f){Srch.U.trace(null,"Srch.SU.ToggleRefShortLong","Failed to initialize people picker: "+f)}}else{b.style.display="";e.style.display="none";d.innerHTML=SP.Utilities.HttpUtility.htmlEncode(Srch.U.loadResource("rf_RefinementLabel_More"))}}catch(g){}};Srch.SU.navItemClicked=function(f,h){var g=Srch.ScriptApplicationManager.get_current(),a=g.queryGroups[f];if(!a)return false;var b=a.dataProvider;if(!b)return false;var c=Srch.SU.$L(a,0);if(Srch.U.e(c))c=b.get_currentQueryState().k;var e=b.get_contextualScopeUrl(),d=String.format("{0}?k={1}",h,SP.Utilities.HttpUtility.urlKeyValueEncode(c));if(!Srch.U.e(e))d=String.format("{0}&u={1}",d,SP.Utilities.HttpUtility.urlKeyValueEncode(e));SP.Utilities.HttpUtility.navigateTo(d);return false};Srch.SU.$L=function(e,d){var b=e.searchBoxes;if(!Srch.U.n(b)&&b.length>d){var a=b[d];if(!Srch.U.n(a)&&!Srch.U.n(a.get_searchBoxInputElement())){var c=a.get_searchBoxInputElement().value;return c===a.get_currentPrompt()?null:c}}return null};Srch.SU.searchResultAlertMe=function(f,e){var g="Search: {0}",h=(new Date).format("s"),d=new SP.Utilities.UrlBuilder(SP.Utilities.VersionUtility.getLayoutsPageUrl("subnew.aspx"));d.addKeyValueQueryString("ATName","OSS.Search");d.addKeyValueQueryString("Title",String.format(g,f));d.addKeyValueQueryString("Source",ajaxNavigate.get_href());var a=document.createElement("form");a.setAttribute("name","SearchAlertRegistration");a.method="POST";a.action=d.get_url();var b=document.createElement("input");b.setAttribute("name","P_Query");b.setAttribute("id","P_Query");b.setAttribute("type","hidden");b.setAttribute("value",e);a.appendChild(b);var c=document.createElement("input");c.setAttribute("name","P_LastNotificationTime");c.setAttribute("id","P_LastNotificationTime");c.setAttribute("type","hidden");c.setAttribute("value",h);a.appendChild(c);document.body.appendChild(a);a.submit()};Srch.SU.ensurePeoplePickerRefinementInit=function(b){var a={};a["PrincipalAccountType"]="User,DL,SecGroup,SPGroup";a["SearchPrincipalSource"]=null;a["ResolvePrincipalSource"]=16;a["AllowMultipleValues"]=false;a["InitialHelpText"]=Srch.U.loadResource("rf_RefinementLabel_EnterName");a["Width"]="133px";a["OnUserResolvedClientScript"]=Srch.RefinementUtil.authorRefinerResolved;EnsureScriptFunc("clienttemplates.js","SPClientTemplates",function(){EnsureScriptFunc("clientforms.js","SPClientPeoplePicker_InitStandaloneControlWrapper",function(){SPClientForms.ClientFormManager.RegisterClientForm("aspnetForm");SPClientPeoplePicker_InitStandaloneControlWrapper(b,null,a)})})};Srch.SU.getSectionsForDisplay=function(b,e,a){if(Srch.U.n(a)||a.length>0)return false;var f=false;if(!Srch.U.n(b)&&b.length>0){for(var i=0,c=0;i<e&&c<b.length;++c){var j=b[c];if(Srch.U.e(j))continue;var g=false;if(j.indexOf(Srch.U.hitHighlightingOpenTag)>=0)g=true;if(a.length===e){if(!g)continue;for(var d=a.length-1;d>=0;d-=1){var k=a[d];if(b[k].indexOf(Srch.U.hitHighlightingOpenTag)<0){a.splice(d,1);break}}}a.push(c);if(g)++i}f=true}if(Srch.U.n(a)||a.length<1){for(var h=0;h<e;++h)a.push(h);f=false}return f};Srch.CU=function(){};Srch.CU.getStringFromValue=function(a){if(Srch.U.n(a)||Srch.U.n(a.value)||Srch.U.w(a.managedPropertyName))return "";var b=a.value.toString(),d=a.managedPropertyName;if(Srch.U.w(b))return "";var e=d.substring(4,7);if(e==="DAT"){var c=new Date(Date.parse(b.replace("-","/").replace("T"," ").replace("Z","UTC")));if(!Srch.U.n(c))return c.toString()}return a.isEntity&&!Srch.U.w(a.entityLabel)?SP.Utilities.HttpUtility.htmlEncode(a.entityLabel.toString()):Srch.U.getTrimmedString(b,Srch.U.titleTruncationLength)};Srch.CU.getManagedPropertiesForCatalogItem=function(a){if(Srch.U.n(a))return null;var b=null;if(Srch.DisplayControl.isInstanceOfType(a)){var i=a;b=i.get_dataProvider().get_refinementInfo()}else if(Srch.DataProvider.isInstanceOfType(a)){var j=a;b=j.get_refinementInfo()}if(Srch.U.n(b))return null;var g=b["ManagedProperties"];if(!Srch.U.n(g)){for(var c="People",f=g,h=f.length,d=0;d<h;++d){var k=f[d],e=k["RefinementValue"];if(!Srch.U.e(e)&&!Srch.U.isInArray(Srch.CU.$E,e)){if(c.length>0)c+=",";c+=e}}return c}return null};Srch.CU.executeCatalogPickerQuery=function(d,h,b,c){var a=Srch.ScriptApplicationManager.get_clientRuntimeContext();if(!Srch.U.n(a)&&!Srch.U.w(b)){var i=$get(h);if(!Srch.U.n(d)){c.innerHTML="Loading...";var e=Microsoft.SharePoint.Client.Search.Query.KeywordQuery.newObject(a),f=b.split(","),j="path:"+d;Srch.CU.$K(e,j,f);var k=Microsoft.SharePoint.Client.Search.Query.SearchExecutor.newObject(a),g=k.executeQuery(e);a.executeQueryAsync(function(){Srch.U.trace(null,"Morecatalog","Success");var a=g.get_value();if(!Srch.U.n(a)){var b=g.get_value();Srch.CU.processCatalogResult(b,i,f,c)}},function(){Srch.U.trace(null,"MoreCatalog","failure")})}}};Srch.CU.processCatalogResult=function(h,l,o,m){if(Srch.U.n(h))return;var a=h["ResultTables"];if(!Srch.U.n(a)&&a.length>0){Srch.U.trace(null,"MoreCatalog","New results came");for(var d=0;d<a.length;d++){var e=a[d];if(!Srch.U.n(e)&&Srch.U.isTableTypeof(e,Microsoft.SharePoint.Client.Search.Query.KnownTableTypes.relevantResults)){var f=e["ResultRows"];if(f.length<=0){Srch.U.trace(null,"MoreCatalog","No info was returned");break}f.length>1&&Srch.U.trace(null,"MoreCatalog","More than 1 result was returned. Only the first one will be used");for(var b="",p=f[0],i=o,n=i.length,c=0;c<n;++c){var g=i[c],j=p[g];if(!Srch.U.n(j)){if(!Srch.U.n(b))b+="<br/>";var k=new Srch.ValueInfo(j,g);k.overrideValueRenderer(Srch.CU.getStringFromValue);b+=g+": <b>"+k.getRenderedValue()+"</b>"}}l.innerHTML=b}else{Srch.U.trace(null,"MoreCatalog","A table was found that was not of type relevantresults");continue}}}m.style.display="none"};Srch.CU.$K=function(a,f,g){if(Srch.U.n(a))return;a.set_queryText(f);a.get_sortList().clear();a.get_refinementFilters().clear();a.set_rowsPerPage(1);a.set_rowLimit(1);a.set_sourceId(new SP.Guid("8413CD39-2156-4E00-B54D-11EFD9ABDB89"));a.set_refiners("");a.get_selectProperties().clear();for(var c=g,e=c.length,b=0;b<e;++b){var d=c[b];Srch.ValueInfo.isAutoCreatedPropertyName(d)&&a.get_selectProperties().add(d)}};Srch.PSU=function(){};Srch.PSU.documentsByQuery=function(f,b,c,g,s){var d=Srch.ScriptApplicationManager.get_clientRuntimeContext();if(!Srch.U.n(f)&&!Srch.U.n(d)&&!Srch.U.n(c)&&!Srch.U.w(b)){c.innerHTML=Srch.PSU.$6;var a=null;if(Srch.DisplayControl.isInstanceOfType(f)){var v=f;a=v.get_dataProvider().get_currentQueryState().k}else if(Srch.DataProvider.isInstanceOfType(f)){var w=f;a=w.get_currentQueryState().k}b=b.toLowerCase().trim();var e=' Author:"'+b+'"',o=false;if(!Srch.U.e(a)){var q=false;a=a.toLowerCase().trim();for(var x=a.split(" "),n=x,t=n.length,i=0;i<t;++i){var r=n[i];if(!Srch.U.e(r)&&b.indexOf(r)!==-1){q=true;break}}if(!q){e=a+e;o=true}else e=b+e+Srch.PSU.$C}var p=Microsoft.SharePoint.Client.Search.Query.KeywordQuery.newObject(d);Srch.PSU.$2(p,e,Srch.PSU.$1,Srch.PSU.$G,Srch.PSU.$F,s);var u=Microsoft.SharePoint.Client.Search.Query.SearchExecutor.newObject(d),h=new SP.ExceptionHandlingScope(d),j=null,k=null,l=null,m=null;try{j=h.startScope();try{k=h.startTry();m=u.executeQuery(p)}finally{!Srch.U.n(k)&&k.dispose()}try{l=h.startCatch()}finally{!Srch.U.n(l)&&l.dispose()}}finally{!Srch.U.n(j)&&j.dispose()}d.executeQueryAsync(function(){if(h.get_hasException()){Srch.U.trace(null,"DocumentsByQuery","failure");Srch.PSU.$9(c,g)}else if(!Srch.U.n(m)){Srch.U.trace(null,"DocumentsByQuery","Success");Srch.PSU.$P(m.get_value(),c,g,o,b,a)}else{Srch.U.trace(null,"DocumentsByQuery","No results returned");Srch.PSU.$9(c,g)}},function(){Srch.U.trace(null,"DocumentsByQuery","failure");Srch.PSU.$9(c,g)})}};Srch.PSU.relatedThroughByQuery=function(k,d,c,i,l){var a=Srch.ScriptApplicationManager.get_clientRuntimeContext(),m=$get(i);if(!Srch.U.n(k)&&!Srch.U.n(a)&&!Srch.U.n(d)&&!Srch.U.n(m)&&!Srch.U.n(c)){var n="FirstLevelColleagues:"+c+" AND USERPROFILE_GUID:"+d,j=Microsoft.SharePoint.Client.Search.Query.KeywordQuery.newObject(a);Srch.PSU.$2(j,n,Srch.PSU.$4,Srch.PSU.$7,Srch.PSU.$5,false);var o=Microsoft.SharePoint.Client.Search.Query.SearchExecutor.newObject(a),b=new SP.ExceptionHandlingScope(a),e=null,f=null,g=null,h=null;try{e=b.startScope();try{f=b.startTry();h=o.executeQuery(j)}finally{!Srch.U.n(f)&&f.dispose()}try{g=b.startCatch()}finally{!Srch.U.n(g)&&g.dispose()}}finally{!Srch.U.n(e)&&e.dispose()}a.executeQueryAsync(function(){if(b.get_hasException())Srch.U.trace(null,"RelatedThroughByQuery","failure");else if(!Srch.U.n(h)){var g=true,j=h.get_value();if(!Srch.U.n(j)){var a=j[Srch.U.PropNames.resultTables];if(!Srch.U.n(a)&&a.length>0)for(var e=0;e<a.length;e++){var f=a[e];if(!Srch.U.n(f)&&Srch.U.isTableTypeof(f,Microsoft.SharePoint.Client.Search.Query.KnownTableTypes.relevantResults)){var m=f[Srch.U.PropNames.resultRows];if(Srch.U.n(m)||m.length<1){Srch.U.trace(null,"FirstLevelColleagues","No results returned");g=false;break}break}}}if(!g)Srch.PSU.$V(k,d,c,i,l);else Srch.U.trace(null,"RelatedThroughByQuery","Firstlevel results returned")}else Srch.U.trace(null,"RelatedThroughByQuery","Firstlevel result object null")},function(){Srch.U.trace(null,"RelatedThroughByQuery","failure")})}};Srch.PSU.$V=function(n,h,i,o,p){var a=Srch.ScriptApplicationManager.get_clientRuntimeContext(),c=$get(o);if(!Srch.U.n(n)&&!Srch.U.n(a)&&!Srch.U.n(c)&&!Srch.U.n(h)&&!Srch.U.n(i)){c.innerHTML=Srch.PSU.$6;var k="FirstLevelColleagues:"+i+" AND FirstLevelMutualFollowings:"+h,l=false,j=Microsoft.SharePoint.Client.Search.Query.KeywordQuery.newObject(a);Srch.PSU.$2(j,k,Srch.PSU.$4,Srch.PSU.$7,Srch.PSU.$5,false);var m=Microsoft.SharePoint.Client.Search.Query.SearchExecutor.newObject(a),b=new SP.ExceptionHandlingScope(a),d=null,e=null,f=null,g=null;try{d=b.startScope();try{e=b.startTry();g=m.executeQuery(j)}finally{!Srch.U.n(e)&&e.dispose()}try{f=b.startCatch()}finally{!Srch.U.n(f)&&f.dispose()}}finally{!Srch.U.n(d)&&d.dispose()}a.executeQueryAsync(function(){if(b.get_hasException())Srch.U.trace(null,"SecondLevelColleagueByQuery","failure");else if(!Srch.U.n(g)){Srch.U.trace(null,"SecondLevelColleagueByQuery","Success");Srch.PSU.$N(g.get_value(),c,p,l,h,i)}else Srch.U.trace(null,"SecondLevelColleagueByQuery","No SecondLevel results returned")},function(){Srch.U.trace(null,"SecondLevelColleagueByQuery","failure")})}};Srch.PSU.$P=function(w,m,F,D,x,E){if(Srch.U.n(m))return;var a=null,p=0,q=0;if(!Srch.U.n(w)){var e=w[Srch.U.PropNames.resultTables];if(!Srch.U.n(e)&&e.length>0)for(var i=0;i<e.length;i++){var b=e[i];if(!Srch.U.n(b)&&Srch.U.isTableTypeof(b,Microsoft.SharePoint.Client.Search.Query.KnownTableTypes.relevantResults)){var j=b[Srch.U.PropNames.resultRows];if(Srch.U.n(j)||j.length<1){Srch.U.trace(null,"DocumentsByQuery","No results returned");break}p=b[Srch.U.PropNames.totalRows];q=b[Srch.U.PropNames.rowCount];for(var n=j,y=n.length,g=0;g<y;++g){var r=n[g];if(Srch.U.n(r))continue;if(Srch.U.n(a))a=[];Srch.U.appendArray(a,r)}break}}}m.innerHTML="";if(!Srch.U.n(a)&&a.length>0){var c='<li id="AuthoredDocumentsField"><div class="ms-srch-hover-subTitle"><h3 class="ms-soften">'+Srch.PSU.$B+"</h3></div>";c+=' <div class="ms-srch-people-hover-AuthoredDocuments">';for(var s=0,o=a,z=o.length,h=0;h<z;++h){var d=o[h];if(s>2)break;var k=SP.Utilities.HttpUtility.htmlEncode(d["Title"].toString()),f=null;if(!Srch.U.n(d["HitHighlightedProperties"])){var B=Srch.U.createXMLDocument("<root>"+d["HitHighlightedProperties"].toString()+"</root>");f=Srch.U.getSingleHHXMLNodeValue(B,"HHTitle");if(Srch.U.e(f))f=k}var t=SP.Utilities.HttpUtility.htmlEncode(Srch.U.ensureAllowedProtocol(d["Path"].toString()));if(Srch.U.e(k)||Srch.U.e(t))continue;var A='<div id="DocumentCard" class="ms-srch-hover-text ms-srch-people-hover-ellipsis"><img id="Icon" src="'+Srch.U.getIconUrlByFileExtension(d,Srch.PSU.$D)+'" /><a id="TitleLink" href="'+t+'" title="'+k+'">'+f+"</a></div>";c+=A}if(p>q){var u="searchCenterUrl" in Srch.ScriptApplicationManager.get_current().states?Srch.ScriptApplicationManager.get_current().states["searchCenterUrl"]:null;if(!Srch.U.e(u)){var l=null;if(D)l=String.format('{0}?k={1} Author:"{2}"',Srch.PSU.$A,SP.Utilities.HttpUtility.urlKeyValueEncode(E),SP.Utilities.HttpUtility.urlKeyValueEncode(x));else l=String.format('{0}?k={1} Author:"{1}"',Srch.PSU.$A,SP.Utilities.HttpUtility.urlKeyValueEncode(x));var v=SP.Utilities.HttpUtility.htmlEncode(Srch.U.ensureAllowedProtocol(Srch.U.concatUrl(u,l)));if(!Srch.U.e(v)){var C='<div id="MoreInfo" class="ms-srch-hover-text ms-secondaryCommandLink"><a id="MoreLink" href="'+v+'" title="'+Srch.PSU.$3+'">'+Srch.PSU.$3+"</a></div>";c+=C}}}c+="</div></li>";m.innerHTML=c;s++}};Srch.PSU.$N=function(u,e,A,D,B,C){if(Srch.U.n(e))return;var a=null,m=0,n=0;if(!Srch.U.n(u)){var d=u[Srch.U.PropNames.resultTables];if(!Srch.U.n(d)&&d.length>0)for(var h=0;h<d.length;h++){var b=d[h];if(!Srch.U.n(b)&&Srch.U.isTableTypeof(b,Microsoft.SharePoint.Client.Search.Query.KnownTableTypes.relevantResults)){var i=b[Srch.U.PropNames.resultRows];if(Srch.U.n(i)||i.length<1){Srch.U.trace(null,"SecondLevelColleagueByQuery","No results returned");break}m=b[Srch.U.PropNames.totalRows];n=b[Srch.U.PropNames.rowCount];for(var k=i,v=k.length,f=0;f<v;++f){var o=k[f];if(Srch.U.n(o))continue;if(Srch.U.n(a))a=[];Srch.U.appendArray(a,o)}break}}}e.innerHTML="";if(Srch.U.n(a)||a.length<1){if(!A)e.innerHTML=Srch.PSU.$8}else{var c='<li id="ColleaguesInfoField"><div class="ms-srch-hover-subTitle"><h3 class="ms-soften">'+Srch.PSU.$I+"</h3></div>";c+=' <div class="ms-srch-people-hover-RelatedThrough">';for(var p=0,l=a,w=l.length,g=0;g<w;++g){var q=l[g];if(p>2)break;var j=SP.Utilities.HttpUtility.htmlEncode(q["PreferredName"].toString()),r=SP.Utilities.HttpUtility.htmlEncode(Srch.U.ensureAllowedProtocol(q["Path"].toString()));if(Srch.U.e(j)||Srch.U.e(r))continue;var x='<div id="RelatedThroughCard" class="ms-srch-hover-text ms-srch-people-hover-ellipsis"><a id="NameLink" href="'+r+'" title="'+j+'">'+j+"</a></div>";c+=x}if(m>n){var s="searchCenterUrl" in Srch.ScriptApplicationManager.get_current().states?Srch.ScriptApplicationManager.get_current().states["searchCenterUrl"]:null;if(!Srch.U.e(s)){var y=String.format("{0}?k=FirstLevelColleagues:{1} AND FirstLevelMutualFollowings:{2}",Srch.PSU.$H,SP.Utilities.HttpUtility.urlKeyValueEncode(C),SP.Utilities.HttpUtility.urlKeyValueEncode(B)),t=SP.Utilities.HttpUtility.htmlEncode(Srch.U.ensureAllowedProtocol(Srch.U.concatUrl(s,y)));if(!Srch.U.e(t)){var z='<div id="MoreInfo" class="ms-srch-hover-text ms-secondaryCommandLink"><a id="MoreLink" href="'+t+'" title="'+Srch.PSU.$3+'">'+Srch.PSU.$3+"</a></div>";c+=z}}}c+="</div></li>";e.innerHTML=c;p++}};Srch.PSU.$9=function(a,b){if(Srch.U.n(a))return;a.innerHTML="";if(!b)a.innerHTML=Srch.PSU.$8};Srch.PSU.$2=function(a,h,i,j,k,l){if(Srch.U.n(a)||Srch.U.n(h))return;a.set_queryText(h);a.get_sortList().clear();a.get_refinementFilters().clear();var d=3,g=false;if(!Srch.U.n(l))g=l;if(g){d=5;a.get_refinementFilters().add('FileType:or(equals("doc"),equals("docx"),equals("docm"),equals("ppt"),equals("pptx"),equals("pptm"),equals("pdf"))')}a.set_rowsPerPage(d);a.set_rowLimit(d);!Srch.U.n(i)&&a.set_sourceId(new SP.Guid(i));a.set_refiners("");a.get_selectProperties().clear();if(!Srch.U.n(j))for(var e=j,m=e.length,b=0;b<m;++b){var o=e[b];a.get_selectProperties().add(o)}a.get_hitHighlightedProperties().clear();if(!Srch.U.n(k))for(var f=k,n=f.length,c=0;c<n;++c){var p=f[c];a.get_hitHighlightedProperties().add(p)}a.set_rankingModelId(Srch.PSU.$J);a.set_enableStemming(true);a.set_enablePhonetic(false);a.set_enableNicknames(false);a.set_enableInterleaving(false);a.set_enableQueryRules(false);a.set_processBestBets(false);a.set_clientType("CSOM");a.set_ignoreSafeQueryPropertiesTemplateUrl(true)};Srch.SiteSearchUtil=function(){};Srch.SiteSearchUtil.populateSiteSearchResults=function(i,h,c,l){if(Srch.U.w(i)||Srch.U.w(h)){Srch.U.trace(null,"Site search","Argument is null or empty");return}if(Srch.U.n(c))c="";var j=String.format('path:"{0}" AND {1}',i,c),a=Srch.ScriptApplicationManager.get_clientRuntimeContext();if(Srch.U.n(a)){Srch.U.trace(null,"Site search","ScriptApplicationManager.ClientRuntimeContext was null.");return}var k=Microsoft.SharePoint.Client.Search.Query.KeywordQuery.newObject(a),m=["Title","FileExtension","Path"],n=["Title"];Srch.PSU.$2(k,j,Srch.SiteSearchUtil.$1,m,n,false);var o=Microsoft.SharePoint.Client.Search.Query.SearchExecutor.newObject(a),b=new SP.ExceptionHandlingScope(a),d=null,e=null,f=null,g=null;try{d=b.startScope();try{e=b.startTry();g=o.executeQuery(k)}finally{!Srch.U.n(e)&&e.dispose()}try{f=b.startCatch()}finally{!Srch.U.n(f)&&f.dispose()}}finally{!Srch.U.n(d)&&d.dispose()}a.executeQueryAsync(function(){if(b.get_hasException())Srch.U.trace(null,"Site search","Failure due to exception.");else{var a=g.get_value();if(!Srch.U.n(a)){var c=g.get_value();Srch.SiteSearchUtil.$Q(c,h,j,l)}}},function(){Srch.U.trace(null,"Site search","Failure in ExecuteQueryAsync.")})};Srch.SiteSearchUtil.$Q=function(p,q,x,r){if(Srch.U.n(p)){Srch.U.trace(null,"Site search","Result table collection was null.");return}var d=p["ResultTables"];if(Srch.U.n(d)||!d.length){Srch.U.trace(null,"Site search","No results were returned.");return}Srch.U.trace(null,"Site search","Received result tables.");for(var j=$get(q),g="",b=0,k=3,h=0;h<d.length&&b<=k;h++){var i=d[h];if(Srch.U.n(i)){Srch.U.trace(null,"Site search","Result table was null.");continue}if(!Srch.U.isTableTypeof(i,Microsoft.SharePoint.Client.Search.Query.KnownTableTypes.relevantResults)){Srch.U.trace(null,"Site search","A table was found that was not of type RelevantResults");continue}var e=i["ResultRows"];if(Srch.U.n(e)||e.length<=0){Srch.U.trace(null,"Site search","RelevantResults table did not contain any rows.");break}for(var c=0;c<e.length&&b<=k;++c){var a=e[c];if(Srch.U.n(a)){Srch.U.traceFormatted(null,"Site search","Result row {0} was null.",c);continue}var l="";if(!Srch.U.n(a["Title"]))l=a["Title"].toString();var f="";if(!Srch.U.n(a["HitHighlightedProperties"]))f=Srch.U.getHighlightedProperty(q+c,a,"Title");var s="";if(!Srch.U.n(a["FileExtension"]))s=a["FileExtension"].toString();var m="";if(!Srch.U.n(a["Path"]))m=a["Path"].toString();if(!b){var w=SP.Utilities.HttpUtility.htmlEncode(Srch.Res.hp_WebPageItem_Results);g+='<div class="ms-srch-hover-subTitle"><h3 class="ms-soften">'+w+"</h3></div>"}var t=SP.Utilities.HttpUtility.htmlEncode(Srch.U.ensureAllowedProtocol(Srch.U.getIconUrlByFileExtension(a,null))),u=SP.Utilities.HttpUtility.htmlEncode(Srch.U.ensureAllowedProtocol(m)),n=SP.Utilities.HttpUtility.htmlEncode(l);if(Srch.U.e(f))f=n;var v='<div class="ms-srch-hover-text ms-srch-ellipsis ms-srch-hover-site-results"><img class=\'ms-srch-hover-site-icon-result\' src="'+t+'" /><a href="'+u+'" title="'+n+'">'+f+"</a></div>";g+=v;b++}}if(!b)Srch.U.hideElement(j);else{if(!Srch.U.w(r)){var o=$get(r);if(!Srch.U.n(o))o.style.display="none"}j.innerHTML+=g}};Srch.SSU=function(){};Srch.SSU.renderPersona=function(c,b){if(Srch.U.w(b)){Srch.U.trace(null,"RenderPersona","personaElementID was null or empty.");return}var a=$get(b);if(Srch.U.n(a)){Srch.U.traceFormatted(null,"RenderPersona","Document.GetElementById returned null for id '{0}'.",b);return}Srch.U.ensureCSSClassNameExist(a,"ms-srch-display-none");EnsureScriptFunc("SP.UI.MySiteCommon.js","SP.UI.People.MySitePeopleUtilities",function(){EnsureScriptFunc("clienttemplates.js","RenderUserFieldWorker",function(){var e=Srch.ScriptApplicationManager.get_clientRuntimeContext(),f=new SP.UserProfiles.PeopleManager(e),d=f.getPropertiesFor(c);if(Srch.U.n(d)){Srch.U.traceFormatted(null,"RenderPersona","PeopleManager returned a null PersonProperties for username '{0}'",c);return}var g=["DisplayName","AccountName","PictureUrl","Email"];e.load(d,g);e.executeQueryAsync(function(){var e="";if(d.isPropertyAvailable("DisplayName"))e=d.get_displayName();var i="";if(d.isPropertyAvailable("Email"))i=d.get_email();var j="";if(d.isPropertyAvailable("PictureUrl"))j=d.get_pictureUrl();var f=new ContextInfo;f.Templates={};f.Templates["Fields"]={};var g={};g["PictureOnly"]="1";g["PictureSize"]="Size_48px";var h={};h["EffectivePresenceEnabled"]="1";h["PresenceAlt"]="No presence information";var c={};c["title"]=SP.Utilities.HttpUtility.ecmaScriptStringLiteralEncode(e);c["email"]=SP.Utilities.HttpUtility.ecmaScriptStringLiteralEncode(i);c["picture"]=SP.Utilities.HttpUtility.htmlEncode(Srch.U.ensureAllowedProtocol(j));var k=$get(b+Srch.SSU.microBlogTitleIdSuffix);if(!Srch.U.n(k))k.innerHTML=SP.Utilities.HttpUtility.htmlEncode(e);a.innerHTML=RenderUserFieldWorker(f,g,c,h);Srch.U.ensureCSSClassNameNotExist(a,"ms-srch-display-none");a.offsetWidth<Srch.U.personaControlRenderedThreshold&&Srch.U.ensureCSSClassNameExist(a,"ms-srch-display-none");ProcessImn()},function(){Srch.U.traceFormatted(null,"RenderPersona","RenderPersona","Failed to retrieve information for user '{0}'",c)})})})};Srch.SSU.populatePostsByQuery=function(t,o,p,d,b,c,n,f){if(Srch.U.n(t)||Srch.U.w(o)||Srch.U.n(b)||Srch.U.n(c)||Srch.U.n(n)||Srch.U.n(f)){Srch.U.trace(null,"PopulatePostsByQuery","Argument null");return}if(b.length!==c.length){Srch.U.traceFormatted(null,"PopulatePostsByQuery","Persona element ID array length was {0}, text container ID array length was {1}. They must be equal.",b.length,c.length);return}if(f<0){Srch.U.trace(null,"PopulatePostsByQuery","Supplied max body length was negative. Must be 0 or greater.");return}var a=Srch.ScriptApplicationManager.get_clientRuntimeContext();if(Srch.U.n(a)){Srch.U.trace(null,"PopulatePostsByQuery","ScriptApplicationManager.ClientRuntimeContext was null.");return}var g=Microsoft.SharePoint.Client.Search.Query.KeywordQuery.newObject(a),q=["Title","Path","AuthorOWSUSER","PostAuthor","DiscussionPost","LastModifiedTime","ReplyCount","LikesCount","Created","FullPostBody"],r=["Title"];Srch.PSU.$2(g,o,Srch.SSU.$1,q,r,false);if(!Srch.U.n(d)&&d.length>0)for(var l=0;l<d.length;l++){var m=d[l];!Srch.U.n(m)&&g.get_sortList().add(m.p,m.d)}var s=Microsoft.SharePoint.Client.Search.Query.SearchExecutor.newObject(a),e=new SP.ExceptionHandlingScope(a),h=null,i=null,j=null,k=null;try{h=e.startScope();try{i=e.startTry();k=s.executeQuery(g)}finally{!Srch.U.n(i)&&i.dispose()}try{j=e.startCatch()}finally{!Srch.U.n(j)&&j.dispose()}}finally{!Srch.U.n(h)&&h.dispose()}a.executeQueryAsync(function(){if(e.get_hasException())Srch.U.trace(null,"PopulatePostsByQuery","Failure due to exception.");else{var a=k.get_value();if(!Srch.U.n(a)){var d=k.get_value();Srch.SSU.$O(d,p,b,c,n,f)}}},function(){Srch.U.trace(null,"PopulatePostsByQuery","Failure in ExecuteQueryAsync.")})};Srch.SSU.getEncodedSocialMetadataString=function(d,c){if(d<0||c<0)return "";var a="<span class='ms-srch-metadataText-emphasis'>"+SP.Utilities.HttpUtility.htmlEncode(d.toString())+"</span>";if(d===1)a=String.format(SP.Utilities.HttpUtility.htmlEncode(Srch.Res.item_Reply),a);else if(d>1)a=String.format(SP.Utilities.HttpUtility.htmlEncode(Srch.Res.item_Replies),a);else a=String.format(SP.Utilities.HttpUtility.htmlEncode(Srch.Res.item_NoReplies),a);var b="<span class='ms-srch-metadataText-emphasis'>"+SP.Utilities.HttpUtility.htmlEncode(c.toString())+"</span>";if(c===1)b=String.format(SP.Utilities.HttpUtility.htmlEncode(Srch.Res.item_Like),b);else if(c>1)b=String.format(SP.Utilities.HttpUtility.htmlEncode(Srch.Res.item_Likes),b);else b=String.format(SP.Utilities.HttpUtility.htmlEncode(Srch.Res.item_NoLikes),b);var e=String.format(SP.Utilities.HttpUtility.htmlEncode(Srch.Res.item_RepliesAndLikes),a,b);return e};Srch.SSU.$O=function(v,w,p,e,y,q){if(Srch.U.n(v)){Srch.U.trace(null,"ProcessDiscussionPostQueryResult","Result table collection was null.");return}if(Srch.U.n(p)||Srch.U.n(e)||p.length!==e.length){Srch.U.trace(null,"ProcessDiscussionPostQueryResult","Element ID arrays were invalid.");return}var g=v["ResultTables"];if(Srch.U.n(g)||!g.length){Srch.U.trace(null,"ProcessDiscussionPostQueryResult","No results were returned.");return}Srch.U.trace(null,"ProcessDiscussionPostQueryResult","Received result tables.");for(var m=0;m<g.length;m++){var n=g[m];if(Srch.U.n(n)){Srch.U.trace(null,"ProcessDiscussionPostQueryResult","Result table was null.");continue}if(!Srch.U.isTableTypeof(n,Microsoft.SharePoint.Client.Search.Query.KnownTableTypes.relevantResults)){Srch.U.trace(null,"ProcessDiscussionPostQueryResult","A table was found that was not of type RelevantResults");continue}var c=n["ResultRows"];if(Srch.U.n(c)||c.length<=0){Srch.U.trace(null,"ProcessDiscussionPostQueryResult","RelevantResults table did not contain any rows.");break}c.length>e.length&&Srch.U.traceFormatted(null,"ProcessDiscussionPostQueryResult","{0} results requested, {1} results received. Only {0} will be used.",e.length,c.length);var r=$get(w);if(Srch.U.n(r)){Srch.U.trace(null,"ProcessDiscussionPostQueryResult",String.format("Header element with supplied id '{0}' was null.",w));return}for(var b=0;b<c.length&&b<e.length;++b){var a=c[b];if(Srch.U.n(a)){Srch.U.traceFormatted(null,"ProcessDiscussionPostQueryResult","Result row {0} was null.",b);continue}var h=p[b];if(Srch.U.w(h)){Srch.U.traceFormatted(null,"ProcessDiscussionPostQueryResult","Persona element ID at index {0} was null or empty.",b);continue}var i=e[b];if(Srch.U.w(i)){Srch.U.traceFormatted(null,"ProcessDiscussionPostQueryResult","Text container ID at index {0} was null or empty.",b);continue}var j="";if(!Srch.U.n(a["AuthorOWSUSER"]))j=a["AuthorOWSUSER"].toString();var x=Srch.U.getDisplayNameFromAuthorField(j),f=Srch.U.getUsernameFromAuthorField(j),d="";if(!Srch.U.n(a["DiscussionPost"]))d=a["DiscussionPost"].toString();var k="";if(!Srch.U.n(a["Created"]))k=a["Created"].toString();var s=true;switch(y){case 1:var t="";if(!Srch.U.n(a["Title"]))t=a["Title"].toString();var u="";if(!Srch.U.n(a["Path"]))u=a["Path"].toString();Srch.SSU.$S(i,t,x,d,q,k,u);Srch.SSU.renderPersona(f,h);break;case 2:var l=-1,o=-1;if(!Srch.U.n(a["ReplyCount"])){l=parseInt(a["ReplyCount"].toString());o=0}if(!Srch.U.n(a["LikesCount"])){o=parseInt(a["LikesCount"].toString());if(l<0)l=0}Srch.SSU.$T(i,Srch.U.getDisplayNameFromAuthorField(j),d,q,k,l,o);Srch.SSU.renderPersona(f,h);break;case 3:d="";if(!Srch.U.n(a["FullPostBody"]))d=a["FullPostBody"].toString();f="";if(!Srch.U.n(a["PostAuthor"]))f=a["PostAuthor"].toString();Srch.SSU.$U(i,d,q,k);Srch.SSU.renderPersona(f,h);break;default:Srch.U.trace(null,"ProcessDiscussionPostQueryResult","Unknown TextElementType.");s=false}s&&Srch.U.ensureCSSClassNameNotExist(r,"ms-srch-display-none")}}};Srch.SSU.$T=function(a,e,f,g,b,c,d){EnsureScriptFunc("sp.datetimeutil.js","SP.DateTimeUtil.SPRelativeDateTime",function(){var i=$get(a);if(Srch.U.n(i)){Srch.U.traceFormatted(null,"GetDiscussionPostMarkup","Text container with supplied id '{0}' was null.",a);return}var h="";h+="<h3>"+SP.Utilities.HttpUtility.htmlEncode(e)+"</h3>";h+='<div class="ms-srch-hover-text ms-srch-hover-postText">';h+=SP.Utilities.HttpUtility.htmlEncode(Srch.U.truncateEnd(f,g));h+="</div>";h+='<div class="ms-metadata">';if(!Srch.U.w(b)){var j=new Date(b),k=Srch.U.getFriendlyTimeInterval(j,Srch.U.getCalendarType());h+='<span class="ms-srch-hover-dateMetadata">';h+=SP.Utilities.HttpUtility.htmlEncode(k);h+="</span>"}if(c>=0&&d>=0){h+='<span class="ms-srch-hover-popularityMetadata">';h+=Srch.SSU.getEncodedSocialMetadataString(c,d);h+="</span>"}h+="</div>";i.innerHTML=h})};Srch.SSU.$S=function(a,d,b,e,f,c,g){EnsureScriptFunc("sp.datetimeutil.js","SP.DateTimeUtil.SPRelativeDateTime",function(){var k=$get(a);if(Srch.U.n(k)){Srch.U.traceFormatted(null,"RenderDiscussionMarkup","Text container with supplied id '{0}' was null.",a);return}var h="";h+='<div class="ms-srch-item-title">';h+='<h4 class="ms-srch-ellipsis">';h+='<a href="'+SP.Utilities.HttpUtility.htmlEncode(Srch.U.ensureAllowedProtocol(g))+'">';h+=SP.Utilities.HttpUtility.htmlEncode(Srch.U.trimTitle(d,Srch.U.titleTruncationLength,2));h+="</a>";h+="</h4>";h+="</div>";var i="";if(!Srch.U.w(c)){var m=new Date(c);i=Srch.U.getFriendlyTimeInterval(m,Srch.U.getCalendarType())}var j="";if(!Srch.U.w(b)){var l="<span class='ms-srch-metadataText-emphasis'>"+SP.Utilities.HttpUtility.htmlEncode(b)+"</span>";if(!Srch.U.w(i))j=String.format(SP.Utilities.HttpUtility.htmlEncode(Srch.Res.item_postAuthorDate),l,SP.Utilities.HttpUtility.htmlEncode(i));else j=String.format(SP.Utilities.HttpUtility.htmlEncode(Srch.Res.item_postAuthor),l)}else if(!Srch.U.w(i))j=String.format(SP.Utilities.HttpUtility.htmlEncode(Srch.Res.item_postDate),SP.Utilities.HttpUtility.htmlEncode(i));h+='<div class="ms-metadata ms-srch-hover-postAuthorMetadata">'+j+"</div>";h+='<div class="ms-srch-hover-text ms-srch-hover-discussionText">';h+=SP.Utilities.HttpUtility.htmlEncode(Srch.U.truncateEnd(e,f));h+="</div>";h+="</div>";k.innerHTML=h})};Srch.SSU.$U=function(a,c,d,b){EnsureScriptFunc("sp.datetimeutil.js","SP.DateTimeUtil.SPRelativeDateTime",function(){var f=$get(a);if(Srch.U.n(f)){Srch.U.traceFormatted(null,"GetDiscussionPostMarkup","Text container with supplied id '{0}' was null.",a);return}var e="";e+='<div class="ms-srch-hover-text ms-srch-hover-postText">';e+=SP.Utilities.HttpUtility.htmlEncode(Srch.U.truncateEnd(c,d));e+="</div>";e+='<div class="ms-metadata">';if(!Srch.U.w(b)){var g=new Date(b),h=Srch.U.getFriendlyTimeInterval(g,Srch.U.getCalendarType());e+='<span class="ms-srch-hover-dateMetadata">';e+=SP.Utilities.HttpUtility.htmlEncode(h);e+="</span>"}e+="</div>";f.innerHTML+=e})};Srch.SSU.TextElementType=function(){};Srch.SSU.TextElementType.prototype={discussionElement:1,postElement:2,microblogElement:3};Srch.SSU.TextElementType.registerEnum("Srch.SSU.TextElementType",false);Srch.SU.registerClass("Srch.SU");Srch.CU.registerClass("Srch.CU");Srch.PSU.registerClass("Srch.PSU");Srch.SiteSearchUtil.registerClass("Srch.SiteSearchUtil");Srch.SSU.registerClass("Srch.SSU");function searchui_scriptSharp_initialize(){Srch.SU.closeImage="closex.png";Srch.SU.followedImage="ratingsnew.png";Srch.SU.notFollowedImage="ratingsempty.png";Srch.SU.maxLinesForMultiValuedProperty=5;Srch.CU.$E=["owsqUSRUserAuthor","owsqUSRUserEditor","owsPeople","owstaxidmetadataalltagsinfo","owstaxIdSPLocationInfo","owstaxIdSPLocationList","owstaxIdSPLocationSite","owsmetadatafacetinfo","owsqBOLBooleanRobotsNoIndex","owsqCHOChoiceSitemapChangeFrequency"];Srch.PSU.$G=["FileExtension","Title","Path","HitHighlightedProperties"];Srch.PSU.$7=["PreferredName","Path"];Srch.PSU.$F=["Title"];Srch.PSU.$5=["PreferredName"];Srch.PSU.$J="8f6fd0bc-06f9-43cf-bbab-08c377e083f4";Srch.PSU.$6='<div class="ms-srch-people-hover-progress"><img src="'+SP.Utilities.VersionUtility.getImageUrl("loadingcirclests16.gif")+'" alt="" title=""/></div>';Srch.PSU.$3=SP.Utilities.HttpUtility.htmlEncode(Srch.Res.hp_PeopleItem_MoreItems);Srch.PSU.$B=SP.Utilities.HttpUtility.htmlEncode(Srch.Res.hp_PeopleItem_Authorship);Srch.PSU.$I=SP.Utilities.HttpUtility.htmlEncode(Srch.Res.hp_PeopleItem_RelatedThrough);Srch.PSU.$A=SP.Utilities.HttpUtility.urlPathEncode("results.aspx");Srch.PSU.$H=SP.Utilities.HttpUtility.urlPathEncode("peopleresults.aspx");Srch.PSU.$8='<li id="NoInfoField"><div class="ms-srch-hover-subTitle ms-textSmall">'+SP.Utilities.HttpUtility.htmlEncode(Srch.Res.hp_PeopleItem_NoInformationAvailable)+"</div></li>";Srch.PSU.$1="8413CD39-2156-4E00-B54D-11EFD9ABDB89";Srch.PSU.$4="B09A7990-05EA-4AF9-81EF-EDFAB16C4E31";Srch.PSU.$D=SP.Utilities.VersionUtility.getImageUrl("generaldocument.png");Srch.PSU.$C=" XRANK(cb=5000.00) IsDocument=1";Srch.SiteSearchUtil.$1="8413CD39-2156-4E00-B54D-11EFD9ABDB89";Srch.SSU.$M='<img src="'+SP.Utilities.VersionUtility.getImageUrl("loadingcirclests16.gif")+'" alt="" title=""/>';Srch.SSU.$1="8413CD39-2156-4E00-B54D-11EFD9ABDB89";Srch.SSU.$4="B09A7990-05EA-4AF9-81EF-EDFAB16C4E31";Srch.SSU.$R="8f6fd0bc-06f9-43cf-bbab-08c377e083f4";Srch.SSU.microBlogTitleIdSuffix="_microBlogTitle"}searchui_scriptSharp_initialize();function HP_initialize(){HP=new function(){var Bb=1e3,b=null,d="px",ub="ms-srch-hover-content",C="ms-srch-itemSelected",Q="_hoverContent",hb="ms-srch-hover-arrow-rtl",gb="ms-srch-hover-arrowBorder-rtl",j="s4-workspace",eb=".ms-srchnav-more-glyph",ib="ms-srch-hover-siteViewer-rtl",A="data-displaytemplate",fb="ITEM_VIDEOVERTICAL",ab=240,Jb=392,pb=335,ob=389,l=10,V=22,k=25,o=4/3,N=10,h=40,P=22,tb=1182,qb=768,vb=887,nb=352+h,n=536+h,t=255+k,s=402+k,L=198+h,K=349+h,mb=1e3*60*60*24,yb="_hoverArrow",kb="_hoverArrowBorder",w=1200,v=900,I=120,H=198+h,E=148+I,L_time_Today=$resource("hp_NowDateTime_Today"),L_time_Yesterday=$resource("hp_NowDateTime_Yesterday"),L_time_DaysAgo=$resource("hp_NowDateTime_DaysAgo"),L_time_MonthAgo=$resource("hp_NowDateTime_MonthAgo"),L_time_MonthsAgo=$resource("hp_NowDateTime_MonthsAgo"),L_time_YearAgo=$resource("hp_NowDateTime_YearAgo"),L_time_YearsAgo=$resource("hp_NowDateTime_YearsAgo"),g=b,f=0,z=0,db=0,r=0,c=b,p=false,e=b,a=b,i=b;this.ids={close:"_hoverClose",follow:"_hoverFollow",title:"_hoverTitle",fileType:"_hoverFileType",size:"_hoverSize",header:"_hoverCommonHeader",body:"_hoverCommonBody",actions:"_hoverCommonActions",viewsLifeTime:"_hoverViewsLifeTime",viewsRecent:"_hoverViewsRecent",inner:"_innerHover",content:"_hoverContent",arrowBorder:"_hoverArrowBorder",arrow:"_hoverArrow",modifiedDate:"_hoverLastModified",author:"_author",viewDuplicates:"_hoverViewDuplicates",parentLink:"_hoverParentLink",send:"_hoverSend",openClient:"_hoverOpenClient",open:"_hoverOpen",preview:"_hoverPreview",dimensions:"_hoverPictureDimensions",dateCreated:"_hoverDateCreated",viewer:"_hoverViewer",sectionName:"_hoverSectionName",siteLogo:"_hoverSiteLogo",siteDescription:"_hoverSiteDescription",noData:"_hoverNoData",summary:"_hoverSummary",peopleSkills:"_hoverPeopleSkills",peoplePastProjects:"_hoverPeoplePastProjects",peopleInterests:"_hoverPeopleInterests",peopleSchools:"_hoverPeopleSchools",peopleSummary:"_hoverPeopleSummary",peopleMemberships:"_hoverPeopleMemberships"};this.CommonHeader="~sitecollection/_catalogs/masterpage/Display Templates/Search/Item_CommonHoverPanel_Header.js";this.CommonBody="~sitecollection/_catalogs/masterpage/Display Templates/Search/Item_CommonHoverPanel_Body.js";this.CommonActions="~sitecollection/_catalogs/masterpage/Display Templates/Search/Item_CommonHoverPanel_Actions.js";this.GetBodySectionHeading=function(b,a){return "<div class='ms-srch-hover-subTitle'><h3>"+$htmlEncode(a)+"</h3></div>"};this.GetBodySectionContent=function(b,c,a){return "<span class='ms-srch-hover-text ms-srch-ellipsis' id='"+$htmlEncode(b)+"'>"+$htmlEncode(a)+"</span>"};this.GetEmailLink=function(c,f,d,e){var b="%0D%0A";if($isNull(c))c="";var a="";if(d)a+=$urlKeyValueEncode(String.format(Srch.Res.hp_Send_OpenInClient,d))+b;else a+=$urlKeyValueEncode(Srch.Res.hp_Send_Open)+b;a+=$urlKeyValueEncode("<"+f+">")+b;if(e){a+=$urlKeyValueEncode(Srch.Res.hp_Send_OpenInWeb)+b;a+=$urlKeyValueEncode("<"+e+">")+b}return "mailto:?subject="+$urlKeyValueEncode(c)+"&body="+a};function Z(a,b){a.style.display=a.d=b}function Lb(a){return a&&a.style&&a.style.display&&"block"===a.style.display}function S(a){a=a-P;var c=p?pb:ab,b=p?ob:Jb;if(a){if(a>b)return b;if(a>c)return a}return c}function wb(){var b=-1,a=document.getElementById(j);if(a&&a.clientWidth)b=a.clientWidth;else if(document.documentElement&&document.documentElement.clientWidth)b=document.documentElement.clientWidth;return b}function M(){var a=-1,b=document.getElementById(j);if(b&&b.clientHeight)a=b.clientHeight;else if(typeof window.innerHeight=="number")a=window.innerHeight;else if(document.documentElement&&document.documentElement.clientHeight)a=document.documentElement.clientHeight;return a}function Y(){var b=0,a=document.getElementById(j);if(a)b=a.scrollLeft;return b}function lb(a){var b=0;while(a){if(a.scrollTop)b+=a.scrollTop;a=a.parentNode}return b}function Eb(i,r,l,n,e){var b={},q=M(),f=lb(a),p=jb(a),d=0,c=i;if(!p){var k=document.getElementById(j);if(k)d=m(k,"Top");c=i-d}if(c<f+d)b.popup=f+N;else{var g=c-f+l-q;if(g>0)b.popup=c-g-N;else b.popup=c}var h=Math.floor(a.clientHeight/2);if(!$isNull(e)&&!isNaN(e))h=e;var o=Math.floor(n.offsetHeight/2);b.arrow=r-b.popup+(h-o)-d;if(b.arrow+n.offsetHeight>l||b.arrow<0)return null;return b}function Gb(f,h,g){c=f;p=g;e=c?X(c):b;var d=W(f,h);a&&a!=d&&bb(a,false);d&&bb(d,true)}function Cb(){c=b;p=false;e=b;a=b}function Kb(d){var a=W(d),c=b;if(a)c=a.pop;return c}function X(a){if(a&&a.className!=ub)a=Kb(a);var c=b;if(a&&a.parentNode)c=a.parentNode.parentNode;return c}function W(b,c){var a=b;while(a&&a.parentNode&&a.parentNode.id!==c)a=a.parentNode;return a}function T(){window.cpHideTimer=setTimeout(function(){c&&q()},Bb)}this.Hide=function(){if(window&&window.event&&window.event.type=="mouseout"){var c=event.relatedTarget?event.relatedTarget:event.toElement,b=a;if(!c||!b)return;!Srch.U.isDescendant(c,b)&&T()}else T()};function rb(){window.cpHideTimer&&clearTimeout(window.cpHideTimer)}function Hb(a){return !isNaN(parseFloat(a))}this.IsNumeric=Hb;this.Show=function(d,a,b,c){HP.Init(null,d,a,b,c)};this.Init=function(i,c,h,d,e){c!=g&&B();g=c;var f=document.getElementById(c);if(f){var j=f.pop,a=[];Srch.U.appendScriptsToLoad(a,d);Srch.U.appendScriptsToLoad(a,HP.CommonHeader);Srch.U.appendScriptsToLoad(a,HP.CommonBody);Srch.U.appendScriptsToLoad(a,HP.CommonActions);Srch.U.trace(b,"HP.Init","Trying to load hover panel template scripts...");if(!Srch.U.loadScripts(a,function(){Srch.U.trace(b,"HP.Init","All hover panel template scripts loaded");Srch.U.registerLoadedScripts(a);HP.InitPostLoad(c,h,d,e)},function(){Srch.U.trace(b,"HP.Init","Failed to load hover panel: "+d)})){Srch.U.trace(b,"HP.Init","Did not discover new hover panel template script to load.");HP.InitPostLoad(c,h,d,e)}}};this.InitPostLoad=function(e,j,f,i){Srch.U.trace(b,"HP.InitPostLoad","");try{g=e;var d=document.getElementById(e);if(!d)return;var a=d.pop;if(a==b){xb(e,j,f);a=d.pop;if(!a)return}rb();y()&&window&&window.event&&window.event.type=="click"&&!G()&&Srch.U.ensureCSSClassNameExist(d,C);if(c&&!c.sticky||!c)c!=a&&Ab(a,e,i)}catch(h){Srch.U.trace(b,"HP.InitPostLoad",String.format("An error occurred while rendering {0}: {1}",f,h))}};function q(){if(Lb(e)&&!c.sticky){var b=e,d=a;b.style.visibility="hidden";b.style.opacity=0;y()&&Srch.U.ensureCSSClassNameNotExist(d,C);f=0;B();Cb()}}function Ib(b,d,h){var g=X(b);if(g&&g.style.visibility!="visible"){var f=false;if(c&&c!=b){f=true;if(c.sticky)Db();else q()}Gb(b,d,h);a=document.getElementById(d);var i=e;if(e){e.style.opacity=0;if(R(d)){Z(e,"block");e.style.visibility="visible";if(!f)Srch.U.animate(i,0,null);else e.style.opacity=1}else e.style.visibility="hidden"}}}function R(o){if(!Srch.U.n(a)&&!Srch.U.n(e)&&(!Srch.U.n(c)||!f)){var n=0;if(a.offsetWidth)n=a.offsetWidth-V;n+=l;Z(e,"block");e.style.visibility="visible";var s=Y();f=m(a,"Left")+l;$windowWidth=wb();z=m(a,"Top");var k=e.style,b=document.getElementById(o+yb),i=document.getElementById(o+kb);if(document.dir&&document.dir=="rtl"||document.documentElement&&document.documentElement.dir&&document.documentElement.dir=="rtl"){r=S(f);f=f-r-l;if(b&&i){b.className=hb;i.className=gb}}else{f=f+n;r=S($windowWidth-f)}var p=(e.offsetHeight-a.offsetHeight)/2,q=z-p,h=null;if(G()){var j=a.querySelector(eb);if(!$isNull(j)){h=a.clientHeight-j.clientHeight;h-=Mb()?0:j.clientHeight/2}}var g=Eb(q,z,e.offsetHeight,b,h);if(g){db=g.popup;k.top=db+d;k.left=f+d;k.width=r+d;b.style.top=g.arrow+d;i.style.top=g.arrow+d;return true}return false}}function Db(){c.sticky=0;a=b;q()}this.Close=function(){c&&q()};function Ab(a,c,b){a&&Fb(a,c,b)}function cb(){c&&c.sticky&&R(c)}this.Resize=cb;function bb(c,d){a=d?c:b}function xb(c,f,e){var b=$getResultItem(c);if(!b.id)b.id=c;try{var i=Srch.ScriptApplicationManager.get_current();if(b){var m=$get(f),a=null,g=Srch.U.getRenderTemplateByName(e);if(!Srch.U.n(g)){var p={},l=Srch.U.getRenderTemplateByName(HP.CommonHeader),o=Srch.U.getRenderTemplateByName(HP.CommonBody),k=Srch.U.getRenderTemplateByName(HP.CommonActions);function j(c,b,a){if(a)if(a=="View")return g;else if(a=="Header")return l;else if(a=="Body")return o;else if(a="Footer")return k;return null}a={ResolveTemplate:j,CurrentItem:b,ScriptApplicationManager:i}}a.fHidden=true;var d=document.getElementById(c);if(d){a.ClientControl=$getClientControl(d);SPClientRenderer.Render(m,a);var n=b.id+Q;d.pop=document.getElementById(n);if(d.pop)d.pop.sticky=0;else{Srch.U.trace(null,"HP.renderTemplate","Failed to render hover panel template: "+e);!$isEmptyArray(a.Errors)&&U(f,c,a.Errors)}}Nb(window,"resize",cb)}}catch(h){Srch.U.trace(null,"HP.renderTemplate","Failed to render hover panel template: "+e);b.id&&U(f,c,h)}}function U(d,a,e){if(d&&e){var b=$get(d),f="<div class='ms-srch-hover-innerContainer' id='"+$htmlEncode(a+"_innerHover")+"'><div class='ms-srch-hover-arrowBorder' id='"+$htmlEncode(a+"_hoverArrowBorder")+"'></div><div class='ms-srch-hover-arrow' id='"+$htmlEncode(a+"_hoverArrow")+"'></div><div class='ms-srch-hover-content' id='"+$htmlEncode(a+"_hoverContent")+"'><div class='ms-srch-hover-body'><div class='ms-srch-hover-text'>"+$htmlEncode(Srch.Res.hp_NoData)+"</div><div class='ms-trcnoti-base ms-srch-msg'><div class='ms-srch-msg-section'>"+e+"</div></div></div></div></div>";if(b){b.innerHTML=f;var c=$get(a);if(c){var g=c.id+Q;c.pop=document.getElementById(g)}b.style.display="none"}}}this.GetNowDateTimeDifference=function(c){var b=c;try{var g=new Date(c),e=new Date,h=e.getTime()-g.getTime(),a=Math.floor(h/mb);if(a<2)b=e.getDate()==g.getDate()?L_time_Today:L_time_Yesterday;else if(a<30)b=String.format(L_time_DaysAgo,a);else if(a<365){var d=Math.floor(a/30);b=d==1?L_time_MonthAgo:String.format(L_time_MonthsAgo,d)}else{var f=Math.floor(a/365);b=f==1?L_time_YearAgo:String.format(L_time_YearsAgo,f)}}catch(i){}return b};this.ViewDuplicates=function(b,c){if(b){var d=document.getElementById(b),a=$getClientControl(d);a&&a.viewDuplicates&&a.viewDuplicates(c)}};this.GetFriendlyNameForFileType=function(a){var b="";if(a)if(!Srch.U.e(a.FileExtension)){if(a.FileExtension=="aspx"&&a.SecondaryFileExtension)b=Srch.Res[Srch.U.getFriendlyNameForFileExtension(a.SecondaryFileExtension)];else b=Srch.Res[Srch.U.getFriendlyNameForFileExtension(a.FileExtension)];if(Srch.U.e(b)&&Srch.U.getFriendlyNameForFileExtension(a.FileExtension)=="file_PDF")b=Srch.Res.rf_ResultTypeRefinerValue_AdobePDF}else if(!Srch.U.e(a.contentclass))b=Srch.Res["cc_"+a.contentclass.toLowerCase()];else if(!Srch.U.e(a.ContentType))b=Srch.Res["ct_"+a.ContentType.toLowerCase()];return b};this.GetAuthorsHtml=function(g,b){var d="";if(b){var c=b.length,a=new Array(b.length);if(b.length>Srch.SU.maxLinesForMultiValuedProperty)c=Srch.SU.maxLinesForMultiValuedProperty-1;for(var e=0;e<b.length;e++)a[e]="<span id='"+$htmlEncode(g+HP.ids.author+e)+"' title='"+$htmlEncode(b[e])+"'>"+$htmlEncode(b[e])+"</span>";if(c==1)d=a[0];else if(c==2)d=String.format($htmlEncode(Srch.Res.hp_Authors2),a[0],a[1]);else if(c==3)d=String.format($htmlEncode(Srch.Res.hp_Authors3),a[0],a[1],a[2]);else if(c==4)d=String.format($htmlEncode(Srch.Res.hp_Authors4),a[0],a[1],a[2],a[3]);else if(c==5)d=String.format($htmlEncode(Srch.Res.hp_Authors5Singular),a[0],a[1],a[2],a[3]);else{var f=b.length-c;d=String.format($htmlEncode(Srch.Res.hp_Authors5Plural),a[0],a[1],a[2],a[3],f)}}return d};this.Follow=function(c,a,b){RegisterSod("hpfollowing","followingcommon.js");EnsureScriptFunc("followingcommon.js","SetFollowStatus",function(){SetFollowStatus(c,a,b)})};this.GetPeopleFollowingControl=function(b,e,c){var a=Srch.ScriptApplicationManager.get_clientRuntimeContext();EnsureScriptFunc("SP.UI.MySiteCommon.js","SP.UI.People.MySitePeopleUtilities",function(){var e=SP.UserProfiles.PeopleManager.newObject(a),d=e.getPropertiesFor(b);a.load(d,SP.UI.People.MySitePeopleUtilities.getPersonPropertiesToInclude());a.get_hasPendingRequest()&&a.executeQueryAsync(function(){if(!d.get_serverObjectIsNull()){SP.UI.People.PersonManager.addPerson(d);var a=SP.UI.People.FollowLinkManager.getLink(b).htmlForLink(SP.UI.People.FollowLink.searchIdPrefixAndSource,false,true);followDiv=document.getElementById(c);if(!$isNull(followDiv)){followDiv.innerHTML="";if(!$isNull(a)){a.className="ms-calloutLink";followDiv.appendChild(a)}}}},function(){})})};this.getStringFromDate=function(d){var g=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],c="";if(d){var e=d.toLocaleTimeString(),f=x(d.getMonth()+1).toString()+"/"+d.getDate()+"/"+d.getFullYear(),a=new Date(f),b=new Date;if(b.getFullYear()===a.getFullYear()&&b.getMonth()===a.getMonth()&&b.getDate()===a.getDate())c=e+" Today";else if(b.getFullYear()===a.getFullYear()&&b.getMonth()===a.getMonth()&&b.getDate()===a.getDate()+1)c=e+" Yesterday";else if(b.getFullYear()===a.getFullYear()&&b.getMonth()===a.getMonth()&&b.getDate()<=a.getDate()+6)c=e+" "+g[a.getDay()];else c=e+" "+f}return c};this.getDateString=function(d,h,f,g,c){var j=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],b="",i=x((parseInt(f)+1).toString())+"/"+g+"/"+h,e=new Date(i),a=new Date;if(a.getFullYear()===e.getFullYear()&&a.getMonth()===e.getMonth()&&a.getDate()===e.getDate())b=d+" today";else if(a.getFullYear().toString()===h&&a.getMonth()===parseInt(f)&&a.getDate()===g-0+1)b=d+" yesterday";else if(a.getFullYear().toString()===h&&a.getMonth()===parseInt(f)&&a.getDate()<=g-0+6)b=d+" "+(c!==""&&c!==undefined&&c!==null?c:j[e.getDay()]);else b=d+" "+i;return b};function x(b){var a=b;if(b.length===1)a="0"+b;else hour=a;return a}function Fb(a,b,c){if(!a.cpLoad)if(b===g){Ib(a,b,c);a.firstLoad=false}}function y(){var a=navigator.appName;if(a=="Microsoft Internet Explorer")return true;else return false}function Mb(){var a=navigator.userAgent.toLowerCase();if(a.indexOf("firefox")!=-1)return true;else return false}function F(a){var b=Boolean(window.getComputedStyle)?window.getComputedStyle(a,null):a.currentStyle;return (b.position=="absolute"||b.position=="relative")&&!(browseris.firefox&&a.tagName.toUpperCase()=="TD")}function jb(a){while(a!=null){if(F(a))return true;a=a.offsetParent}return false}function m(a,d){var c=0,b=0;while(a!=null){if(F(a))break;c+=a.offsetTop;b+=a.offsetLeft;a=a.offsetParent}return d==="Left"?b:c}function Nb(a,c,b){if(a.addEventListener){a.addEventListener(c,b,false);a.addEventListener(c,b,false)}else if(a.attachEvent){a.attachEvent(c,b);a.attachEvent(c,b)}}function O(){if(window&&window.screen&&window.screen.width)return window.screen.width}function sb(){if(window&&window.screen&&window.screen.height)return window.screen.height}function u(a){var c=0;if(a){var d=0;if(a.offsetWidth)d=a.offsetWidth-V;var f=Y();d+=l;var b=m(a,"Left")-f+l,e=O();if(document.dir&&document.dir=="rtl"||document.documentElement&&document.documentElement.dir&&document.documentElement.dir=="rtl")c=b;else{b=b+d;c=e-b}}return c-P}function D(a){var c=M(),b=a.clientHeight;if(b==0){var d=a.style.visibility,e=a.style.display;a.style.visibility="hidden";a.style.display="block";b=a.clientHeight;a.style.visibility=d;a.style.display=e}return c-b}this.loadViewer=function(o,q,m,p,l,n){var i=$get(o),a=$get(m),j=$get(p),c=$get(q);if(i&&a&&j&&c){a.style.display="none";a.parentNode.style.display="none";var k=O(),g=sb(),b=u(i),e=D(c.parentNode);if(k>=tb&&g>=qb&&e>=t){if(g<vb)e=t;a.style.display="block";a.parentNode.style.display="block";a.src=l;var h=J(b,e);a.parentNode.style.height=h.height+d;c.style.width=h.width+d}else{j.src=n;var f=L;if(b>L)if(b>K)f=K;else f=b;c.style.width=f+d}}};this.loadSiteViewer=function(s,x,q,p,n){var l=$get(s),a=$get(q),e=$get(n),g=$get(x);if(l&&a&&g&&e){a.style.display="none";a.parentNode.style.display="none";var j=u(l),i=D(g.parentNode),b=H,c=E;if(j>=H&&i>=E){var k=J(j,i-I);b=k.width;c=k.height}g.style.width=b+d;b-=h;a.parentNode.style.height=c+d;a.parentNode.style.width=b+d;a.style.display="block";a.parentNode.style.display="block";a.src=$urlHtmlEncode(p);e.style.height=c+d;e.style.width=b+d;a.style.width=w+d;a.style.height=v+d;Srch.U.isRTL()&&Srch.U.ensureCSSClassNameExist(a,ib);var f=b/w,m=c/v,t=zb(a,f,m);if(!t&&y()){a.style.zoom=""+f+"";var r=w/f,o=v/m;a.style.width=r+d;a.style.height=o+d}}};function J(e,d){var c={};c.width=0;c.height=0;var b=nb,a=t;if(e>n){b=n;if(d>s)a=s-k;else{a=d-k;b=o*a}}else{b=e;if(d>s)a=(b-h)/o;else{a=d-k;var f=o*a;if(f>b)a=(b-h)/o;else b=f}}c.width=Math.floor(b);c.height=Math.floor(a);return c}this.SetWidth=function(c,f,a){if(!$isNull(c)&&!$isNull(f)&&!$isNull(a)&&!isNaN(a)&&a>=ab){var e=$get(c),g=$get(f);if($isNull(e)||$isNull(g))return;var b=u(e);if(a>b)a=b;if(a>=n)a=n;g.style.width=a+d}};this.SetPreviewOnHideCallback=function(a){if($isNull(i))i={};if(!$isNull(g))i[g]=a};function B(){!$isNull(g)&&!$isNull(i)&&!$isNull(i[g])&&i[g]()}function G(){var b=a,d=$isNull(b)&&window&&window.event&&!$isNull(window.event.srcElement),c=!d;if(d){b=window.event.srcElement;do{b=b.parentNode;c=b.hasAttribute(A)}while(!$isNull(b)&&!c)}if(c&&!$isNull(b)){var e=b.getAttribute(A);return !$isEmptyString(e)&&e.toUpperCase()==fb}return false}function zb(c,e,f){var d=["transform","WebkitTransform","msTransform","MozTransform","OTransform"],b,a=false;while((b=d.shift())&&!a)if(typeof c.style[b]!="undefined"){a=true;c.style[b]="scale("+e+","+f+")"}return a}}}HP_initialize();function searchui_initialize(){HP_initialize();searchui_scriptSharp_initialize()}RegisterModuleInit("searchui.js",searchui_initialize);typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();NotifyScriptLoadedAndExecuteWaitingJobs("SearchUI.js")