Type.registerNamespace("SP.UI.MicroFeed");SP.UI.MicroFeed.HandlingMode=function(){};SP.UI.MicroFeed.HandlingMode.prototype={notHandling:0,handlingMention:1,handlingTag:2,handlingLink:3};SP.UI.MicroFeed.HandlingMode.registerEnum("SP.UI.MicroFeed.HandlingMode",false);SP.UI.MicroFeed.TextBoxElementType=function(){};SP.UI.MicroFeed.TextBoxElementType.prototype={mention:0,tag:1,link:2};SP.UI.MicroFeed.TextBoxElementType.registerEnum("SP.UI.MicroFeed.TextBoxElementType",false);SP.UI.MicroFeed.WebPartFeedType=function(){};SP.UI.MicroFeed.WebPartFeedType.prototype={publishedFeed:0,whatsNew:1,siteFeed:2};SP.UI.MicroFeed.WebPartFeedType.registerEnum("SP.UI.MicroFeed.WebPartFeedType",false);SP.UI.MicroFeed.keyCode=function(){};SP.UI.MicroFeed.keyCode.prototype={none:0,backspace:8,enter:13,escape:27,space:32,leftArrow:37,upArrow:38,rightArrow:39,downArrow:40,zero:48,nine:57,a:65,z:90,numPadZero:96,numPadNine:105,deleteKey:127};SP.UI.MicroFeed.keyCode.registerEnum("SP.UI.MicroFeed.keyCode",false);SP.UI.MicroFeed.PostType=function(){};SP.UI.MicroFeed.PostType.prototype={unknown:0,rootRepliable:1,reply:2,rootPreview:3,replyPreview:4,newRoot:6,newReply:7,replyForRef:8,refPost:9,refMention:10,minimalRoot:11,errorPost:12};SP.UI.MicroFeed.PostType.registerEnum("SP.UI.MicroFeed.PostType",false);SP.UI.MicroFeed.FeedType=function(){};SP.UI.MicroFeed.FeedType.prototype={published:0,consolidated:1,categorical:2,custom:3,company:4,mentions:5,likes:6};SP.UI.MicroFeed.FeedType.registerEnum("SP.UI.MicroFeed.FeedType",false);SP.UI.MicroFeed.NewReplyDivType=function(){};SP.UI.MicroFeed.NewReplyDivType.prototype={empty:0,newReply:1,maxRepliesReached:2};SP.UI.MicroFeed.NewReplyDivType.registerEnum("SP.UI.MicroFeed.NewReplyDivType",false);SP.UI.MicroFeed.UpdateType=function(){};SP.UI.MicroFeed.UpdateType.prototype={noUpdate:0,older:1,newer:2};SP.UI.MicroFeed.UpdateType.registerEnum("SP.UI.MicroFeed.UpdateType",false);SP.UI.MicroFeed.PictureSize=function(){};SP.UI.MicroFeed.PictureSize.prototype={normal:0,small:1,icon:2};SP.UI.MicroFeed.PictureSize.registerEnum("SP.UI.MicroFeed.PictureSize",false);SP.UI.MicroFeed.AtMention=function(a,c,d){this.$$d_$9A_1=Function.createDelegate(this,this.$9A_1);this.$$d_$9E_1=Function.createDelegate(this,this.$9E_1);this.$3D_1={};this.$2K_1=[];this.$2L_1={};this.$U_1=[];this.$17_1={};this.$c_1=[];SP.UI.MicroFeed.AtMention.initializeBase(this,[c]);this.$2_1=a;this.$4l_1=d;$addHandler(a,"keyup",this.$$d_typeAheadKeyUpHandler);var b=this;$addHandler(a,"click",function(){b.correctDropdownState()});$addHandler(a,"paste",this.$$d_$9E_1)};SP.UI.MicroFeed.AtMention.$95=function(b){var e=b.lastIndexOf("http://"),f=b.lastIndexOf("https://"),d=b.lastIndexOf("www."),a=Math.max(e,f,d);while(a>-1){if(!a)return 0;var c=b.charCodeAt(a-1);if(c>=65&&c<=90||c>=97&&c<=122||a===d&&c===47||c===60){b=b.substr(0,a);if(a===e)e=b.lastIndexOf("http://");if(a===f)f=b.lastIndexOf("https://");if(a===d)d=b.lastIndexOf("www.");a=Math.max(e,f,d)}else return a}return a};SP.UI.MicroFeed.AtMention.$4I=function(a){var b=a;if(window.browseris.ie8standard&&!SP.ScriptUtility.isNullOrEmptyString(a))b=a.replace(SP.UI.MicroFeed.AtMention.$76,"\n");return b};SP.UI.MicroFeed.AtMention.$3w=function(d){var a="";if(d)for(var b=0;b<d.length;b++){var c=d.charAt(b);if(c==="{")a+="{{";else if(c==="}")a+="}}";else a+=c}return a};SP.UI.MicroFeed.AtMention.prototype={$2_1:null,$4o_1:null,$4l_1:null,get_ownerControlId:function(){return this.$2_1.id},get_isHandlingLinkEntry:function(){return this.m_handlingMode===3},get_$4j_1:function(){var a=this.$2_1.value.substring(0,SP.UI.MySiteCommon.CommonUIElements.getCursorPosition(this.$2_1)),b=-1,c=a.substr(Math.max(a.lastIndexOf(" "),a.lastIndexOf("\n"),a.lastIndexOf("\t"),a.lastIndexOf("\r"))+1),d=SP.UI.MicroFeed.AtMention.$95(c);if(d>-1){b=a.lastIndexOf(c)+d;this.m_handlingMode=3}else{var e=a.lastIndexOf("@"),f=a.lastIndexOf("#");b=Math.max(e,f);if(b>-1)if(b===e)this.m_handlingMode=1;else if(b===f)this.m_handlingMode=2;else this.m_handlingMode=3;else this.m_handlingMode=0}return b},get_shouldDisplayTooManyWarning:function(){for(var a=0,b=0,c=this.get_$2c_1(),b=0;b<c.length;b++)if(this.$2_1.value.indexOf(c[b])>=0)a++;return this.m_handlingMode===2?a>=this.m_MaxTagsToResolve:a>=this.m_MaxToResolve},get_$9N_1:function(){for(var b=0,a=0,a=0;a<this.$U_1.length;a++)if(this.$2_1.value.indexOf(this.$U_1[a])>=0)b++;return b<=this.m_MaxTagsToResolve},get_shouldProvideSuggestions:function(){var b=this.get_$4j_1(),d=this.get_$2c_1(),a=0;if(b===-1)return false;var c=-1;for(a=0;a<d.length;a++){var e=d[a];if(this.$2_1.value.substr(b).startsWith(e)){if(this.m_handlingMode===2){if(c===-1)c=SP.UI.MySiteCommon.CommonUIElements.getCursorPosition(this.$2_1);if(c===b+e.length)return true}return false}}return true},get_$2c_1:function(){return this.m_handlingMode===1?this.$2K_1:this.m_handlingMode===2?this.$U_1:this.m_handlingMode===3?this.$c_1:[]},get_linkToEdit:function(){for(var d=SP.UI.MySiteCommon.CommonUIElements.getCursorPosition(this.$2_1),a=0;a<this.$c_1.length;a++){var b=this.$c_1[a],c=this.$2_1.value.indexOf(b);if(c>=0&&c<d&&c+b.length>=d)return b}return null},typeAheadKeyDownHandler:function(a){if(this.m_handlingMode===3){this.$9V_1(a);return}SP.UI.MicroFeed.BaseAtMention.prototype.typeAheadKeyDownHandler.call(this,a)},$9E_1:function(){var b=SP.UI.MySiteCommon.CommonUIElements.getCursorPosition(this.$2_1),a=this;window.setTimeout(function(){var d=SP.UI.MySiteCommon.CommonUIElements.getCursorPosition(a.$2_1),e=a.$5b_1(b,d),c=e.toLowerCase();if(c.startsWith("www.")||c.startsWith("http://")||c.startsWith("https://")){a.m_handlingMode=3;a.$7h_1(e,b,d)}},10)},$9V_1:function(a){if(this.m_handlingMode!==3)return;var b=this.get_$4j_1(),c=SP.UI.MySiteCommon.CommonUIElements.getCursorPosition(this.$2_1);if(a.keyCode===32||a.keyCode===13){this.$7h_1(this.$5b_1(b,c),b,c);a.keyCode===13&&!a.shiftKey&&a.preventDefault()}},$7h_1:function(a,c,d){this.$4e_1(a.length,c,false,a,a,true,d-c-a.length);var b=SP.UI.MicroFeed.SPMicroFeed.getPostIDFromDOMElementID(this.$2_1.id);if(b===this.$2_1.id)b=null;SP.UI.MicroFeed.SPMicroFeed.$81(a,b)},linkUrlFromDisplayText:function(b){if(!b)return null;var a=this.$17_1["<"+b+">"];return!a?null:a.$3_0},$9A_1:function(c,d){var b=this.$2_1.value.indexOf(c),a=this.$2_1.value.indexOf(d);return b<0?a<0?0:1:b<a||a<0?-1:b>a?1:0},setPostContentAndDataLinks:function(a){this.$60_1(a,null)},setElementHighlights:function(a){this.$60_1(null,a)},$60_1:function(a,c){var b="",d=-1,e=-1,g=0,h=0,i=false,p={},q={},r={},f=[];this.$2K_1.sort(this.$$d_$9A_1);a&&a.set_contentText("");if(c)c.innerHTML="";for(g=0;g<this.$U_1.length;g++){Array.remove(this.$U_1,this.$U_1[g]);g--}while((e=this.$8q_1(d+1))>=0){b=this.$2_1.value.substring(d+1,e);c&&b!==""&&c.appendChild(document.createTextNode(SP.UI.MicroFeed.AtMention.$4I(b)));a&&a.set_contentText(a.get_contentText()+SP.UI.MicroFeed.AtMention.$3w(b));d=e;if(this.$2_1.value.charAt(e)==="@"){var j,k;i=(k=this.$4f_1(0,j={val:d},c,a,q,true,f),d=j.val,k)}else if(this.$2_1.value.charAt(e)==="#"){var l,m;i=(m=this.$4f_1(1,l={val:d},c,a,p,true,f),d=l.val,m)}else if(this.$2_1.value.charAt(e)==="<"){var n,o;i=(o=this.$4f_1(2,n={val:d},c,a,r,false,f),d=n.val,o)}if(!i){b=this.$2_1.value.charAt(e);c&&c.appendChild(document.createTextNode(SP.UI.MicroFeed.AtMention.$4I(b)));a&&a.set_contentText(a.get_contentText()+SP.UI.MicroFeed.AtMention.$3w(b))}}b=this.$2_1.value.substr(d+1);c&&b!==""&&c.appendChild(document.createTextNode(SP.UI.MicroFeed.AtMention.$4I(b)));if(a){a.set_contentText(a.get_contentText()+SP.UI.MicroFeed.AtMention.$3w(b));a.set_contentItems(new Array(f.length));for(h=0;h<f.length;h++)a.get_contentItems()[h]=f[h]}},$4f_1:function(d,b,m,e,f,s,q){var j=0,n="",o="",a="",g=[],h={};this.$4o_1=m;var k="";switch(d){case 0:g=this.$2K_1;h=this.$3D_1;break;case 1:g=this.$U_1;h=this.$2L_1;break;case 2:g=this.$c_1;h=this.$17_1}var i=g.length;if(d===1)i=Math.min(i,this.m_MaxTagsToResolve);else if(d!==2)i=Math.min(i,this.m_MaxToResolve);for(j=0;j<i;j++){a=g[j];if(this.$2_1.value.substr(b.val).startsWith(a)&&(s||!f[a])){if(d===1){var p=this.$2_1.value.substr(b.val+a.length,1);if(!SP.ScriptHelpers.isNullOrEmptyString(p)&&p.search(SP.UI.MicroFeed.BaseAtMention.disallowedHashTagCharsRegex)===-1)continue}n=h[a].$a_0;o=h[a].$3_0;if(e){switch(d){case 0:e.set_contentText(e.get_contentText()+"@")}if(f&&f[a])k=f[a];else k=this.$5o_1(d,n,o,q);e.set_contentText(e.get_contentText()+k)}this.$6z_1(m,a,b.val);b.val+=a.length-1;if(f)f[a]=k;return true}}if(d===1){var r=this.$2_1.value.substr(b.val+1),l=SP.UI.MicroFeed.BaseAtMention.getTagEndIndex(r,!!e);if(l>0)l+=b.val+1;if(l>b.val){var c=this.$2_1.value.substr(b.val,l-b.val);if(c!==""){if(!Array.contains(this.$U_1,c)){Array.add(this.$U_1,c);this.$2L_1[c]=new SP.UI.MicroFeed.TextBoxElement(c,"00000000-0000-0000-0000-000000000000",1)}if(!this.get_$9N_1()){SP.UI.MicroFeed.BaseAtMention.removeSuggestionSelector();return false}this.$8w_1(c,e,f,q);this.$6z_1(m,c,b.val);b.val+=c.length-1;return true}}}return false},$5o_1:function(d,e,b,c){var a=new SP.Social.SocialDataItem;switch(d){case 0:a.set_itemType(0);a.set_accountName(b);break;case 1:a.set_itemType(3);!SP.ScriptHelpers.isNullOrEmptyString(b)&&a.set_tagGuid(new SP.Guid(b));break;case 2:if(b.toLowerCase().startsWith("www."))b="http://"+b;a.set_uri(b);a.set_itemType(4)}a.set_text(e);Array.add(c,a);return"{"+(c.length-1).toString()+"}"},$6z_1:function(b,c,d){if(b){var a=null;a=document.createElement("span");a.className="ms-microfeed-highlightedTextBoxElement";a.iStart=d;a.iEnd=d+c.length;SP.UI.MySiteCommon.CommonUIElements.setElementText(a,c);b.appendChild(a)}},shouldCreateSuggestionDropdown:function(a){return this.m_handlingMode===2&&this.$93_1(a)?false:true},$93_1:function(c){if(this.m_handlingMode===2&&this.$4o_1){var a=this.$4o_1.firstChild;while(a){if(a.nodeType===1){var b=a.iStart,d=a.iEnd,e=c.prefix.length;if(c.triggerPosition===b&&b+e<d)return true}a=a.nextSibling}}return false},$8w_1:function(c,a,d,e){if(a){var b=this.$5o_1(1,c,"",e);a.set_contentText(a.get_contentText()+b);if(d)d[c]=b}},$8q_1:function(e){var a=-1,c=-1,d=-1,b=-1;d=this.$2_1.value.indexOf("#",e);c=this.$2_1.value.indexOf("@",e);b=this.$2_1.value.indexOf("<",e);if(d<0)a=c;else if(c<0)a=d;else a=Math.min(c,d);if(b>=0&&a<0)a=b;else if(b>=0)a=Math.min(b,a);return a},reset:function(){SP.UI.MicroFeed.BaseAtMention.prototype.reset.call(this);this.$3D_1={};this.$2K_1=[];this.$2L_1={};this.$U_1=[];this.$17_1={};this.$c_1=[]},onElementSelected:function(a,b,c){this.$4e_1(a.prefix.length,a.triggerPosition,c,b.displayName,b.alias,true,0)},sendFocusBackToOwnerControl:function(a){SP.UI.MySiteCommon.CommonUIElements.setCursorPosition(this.$2_1,a.triggerPosition+a.prefix.length+1)},addTextAreaElement:function(a,b,c,d){this.m_handlingMode=a;this.$4e_1(0,this.$2_1.value.length,false,b,c,d,0)},$4e_1:function(d,e,f,b,c,g,h){var a="";if(this.m_handlingMode===1)a="@["+b+"]";else if(this.m_handlingMode===2)a=b;else if(this.m_handlingMode===3&&!this.hasLinkWithDisplayText(b))a="<"+b+">";else return;if(!Array.contains(this.get_$2c_1(),a)){Array.add(this.get_$2c_1(),a);if(this.m_handlingMode===1)this.$3D_1[a]=new SP.UI.MicroFeed.TextBoxElement(b,c,0);else if(this.m_handlingMode===2)this.$2L_1[a]=new SP.UI.MicroFeed.TextBoxElement(b,c,1);else if(this.m_handlingMode===3)this.$17_1[a]=new SP.UI.MicroFeed.TextBoxElement(b,c,2)}if(f)a+=" ";this.$7s_1(a,e,d,g,h);SP.UI.MicroFeed.BaseAtMention.removeSuggestionSelector()},hasLinkWithDisplayText:function(a){return!!this.getLinkWithDisplayText(a)},getLinkWithDisplayText:function(c){var a="<"+c+">";if(this.$2_1.value.indexOf(a)>=0&&Array.contains(this.$c_1,a)){var b=this.$17_1[a];if(b)return b.$3_0}return null},updateLinkSelection:function(d,c,e){var b="<"+d+">",a="<"+c+">";if(!Array.contains(this.$c_1,b))return;this.$17_1[a]=new SP.UI.MicroFeed.TextBoxElement(c,e,2);if(b!==a){Array.remove(this.$c_1,b);Array.add(this.$c_1,a);this.$17_1[b]=null;this.$2_1.value=this.$2_1.value.replace(b,a);this.$4l_1()}SP.UI.MySiteCommon.CommonUIElements.setCursorPosition(this.$2_1,this.$2_1.value.indexOf(a)+a.length)},updateOwnerControlWithNewText:function(b,a){this.$7s_1(b,a.triggerPosition,a.prefix.length,true,0)},$7s_1:function(b,a,c,d,e){this.$2_1.value=this.$2_1.value.substring(0,a)+b+this.$2_1.value.substr(a+c+(this.m_handlingMode===3?0:1));this.$4l_1();d&&SP.UI.MySiteCommon.CommonUIElements.setCursorPosition(this.$2_1,Math.min(a+b.length+e,this.$2_1.value.length))},$8F_1:function(a,b){return this.m_handlingMode===2?this.$2_1.value.substring(a,b):this.$2_1.value.substring(a+1,b)},$5b_1:function(d,e){for(var c=this.$2_1.value.substring(d,e),b=c.length;b>=0;b--){var a=c.charAt(b-1);if(a!=="."&&a!=="!"&&a!=="?"&&a!==","&&a!==";"&&a!==":"&&a!=='"'&&a!=="'"&&a!=="<"&&a!==">"&&a!=="("&&a!==")"&&a!=="["&&a!=="]"&&a!=="{"&&a!=="}"&&a!==" "&&a!=="\n"&&a!=="\r"&&a!=="\t")break}return c.substr(0,b>=0?b:0)},get_dropDownBeforeSibling:function(){return this.$2_1},addAdditionalWarningMessages:function(c,b){if(this.m_handlingMode===1){var a=STSHtmlDecode(this.$2_1.getAttribute("targetDisplayName"));!SP.ScriptHelpers.isNullOrEmptyString(a)&&this.addMentionsWarningTextWhenTargetting(b,a)}return true},calculateCurrentState:function(){var b=this.get_$4j_1(),c=SP.UI.MySiteCommon.CommonUIElements.getCursorPosition(this.$2_1),a=new SP.UI.MicroFeed.OwnerControlState;a.triggerPosition=b;a.prefix=this.$8F_1(b,c);return a}};SP.UI.MicroFeed.TextBoxElement=function(a,b,c){this.$a_0=a;this.$3_0=b;this.$1N_0=c;this.$2H_0=""};SP.UI.MicroFeed.TextBoxElement.$8G=function(f,g){var c=f,d=g,a=c.$a_0.toLowerCase(),b=d.$a_0.toLowerCase(),e=a.localeCompare(b);if(e)return e;a=c.$3_0.toLowerCase();b=d.$3_0.toLowerCase();return a.localeCompare(b)};SP.UI.MicroFeed.TextBoxElement.prototype={$a_0:null,$3_0:null,$1N_0:0,$2H_0:null,get_displayName:function(){return this.$a_0},get_identifier:function(){return this.$3_0},get_elementType:function(){return this.$1N_0},get_description:function(){return this.$2H_0},set_description:function(a){this.$2H_0=a;return a},insertIntoSortedArray:function(a){var b=0;if(!a)a=[];else if(a.length>0)b=this.$2Y_0(a,0,a.length);Array.insert(a,b,this);return a},removeFromSortedArray:function(a){var b=0;if(!a)a=[];else if(a.length>0)b=this.$2Y_0(a,0,a.length);if(b>-1&&b<a.length){var c=a[b];c.$1N_0===this.$1N_0&&c.$3_0===this.$3_0&&Array.removeAt(a,b)}return a},$2Y_0:function(c,b,d){if(b===d)return b;var a=Math.floor((b+d)/2),e=SP.UI.MicroFeed.TextBoxElement.$8G(c[a],this);return e<0?this.$2Y_0(c,a+1,d):e>0?this.$2Y_0(c,b,a):a}};SP.UI.MicroFeed.BaseAtMention=function(a){this.$$d_$9C_0=Function.createDelegate(this,this.$9C_0);this.$$d_$7T_0=Function.createDelegate(this,this.$7T_0);this.$$d_$9B_0=Function.createDelegate(this,this.$9B_0);this.$$d_$9D_0=Function.createDelegate(this,this.$9D_0);this.$$d_$9T_0=Function.createDelegate(this,this.$9T_0);this.$$d_typeAheadKeyUpHandler=Function.createDelegate(this,this.typeAheadKeyUpHandler);this.m_handlingMode=0;this.m_MaxToResolve=a};SP.UI.MicroFeed.BaseAtMention.get_$1V=function(){if(!SP.UI.MicroFeed.BaseAtMention.$3X)SP.UI.MicroFeed.BaseAtMention.$3X=new SP.UI.MicroFeed.AllUsersSuggestionManager(SP.UI.MicroFeed.BaseAtMention.$2M);return SP.UI.MicroFeed.BaseAtMention.$3X};SP.UI.MicroFeed.BaseAtMention.removeSuggestionSelector=function(){SP.UI.MicroFeed.BaseAtMention.$7d();SP.UI.MicroFeed.BaseAtMention.$7e()};SP.UI.MicroFeed.BaseAtMention.$7d=function(){var a=$get(SP.UI.MicroFeed.BaseAtMention.$1c);a&&a.parentNode&&a.parentNode.removeChild(a)};SP.UI.MicroFeed.BaseAtMention.$7e=function(){SP.UI.MicroFeed.BaseAtMention.tagSuggestions&&SP.UI.MicroFeed.BaseAtMention.tagSuggestions.hidePanel()};SP.UI.MicroFeed.BaseAtMention.$90=function(e){var c=$get(SP.UI.MicroFeed.BaseAtMention.$1c),a=null;if(c)a=c.getAttribute(SP.UI.MicroFeed.BaseAtMention.$1U);else if(SP.UI.MicroFeed.BaseAtMention.tagSuggestions)a=SP.UI.MicroFeed.BaseAtMention.tagSuggestions[SP.UI.MicroFeed.BaseAtMention.$1U];if(a)if(!SP.ScriptHelpers.isNullOrEmptyString(a)){var d=$get(a);if(d){var b=e;while(b){if(b===d)return true;b=b.parentNode}}}return false};SP.UI.MicroFeed.BaseAtMention.$73=function(){return!!$get(SP.UI.MicroFeed.BaseAtMention.$4k)||!!$get(SP.UI.MicroFeed.BaseAtMention.get_$1V().m_loadingAnimationIDForRequest)};SP.UI.MicroFeed.BaseAtMention.setFollowedPeople=function(b){if(b.get_areItemsAvailable()){SP.UI.MicroFeed.BaseAtMention.$1E=[];var c=b.getEnumerator();while(c.moveNext()){var a=c.get_current();SP.UI.People.PersonManager.addPerson(a);SP.UI.MicroFeed.BaseAtMention.addFollowedPerson(a.get_accountName(),a.get_displayName())}}};SP.UI.MicroFeed.BaseAtMention.addFollowedPerson=function(a,b){new SP.UI.MicroFeed.TextBoxElement(b,a,0).insertIntoSortedArray(SP.UI.MicroFeed.BaseAtMention.$1E)};SP.UI.MicroFeed.BaseAtMention.removeFollowedPerson=function(a,b){new SP.UI.MicroFeed.TextBoxElement(b,a,0).removeFromSortedArray(SP.UI.MicroFeed.BaseAtMention.$1E)};SP.UI.MicroFeed.BaseAtMention.$7v=function(a){if(a.indexOf(";")!==-1||a.indexOf("<")!==-1||a.indexOf(">")!==-1||a.indexOf("|")!==-1||a.indexOf("\t")!==-1||a.indexOf("\n")!==-1||a.indexOf("\r")!==-1||a.startsWith(" "))return false;var b=a.split(" ");return b.length>3?false:true};SP.UI.MicroFeed.BaseAtMention.$9e=function(a){return a.indexOf("\n")!==-1||a.indexOf("\r")!==-1||a.startsWith("\t")||a.startsWith(" ")?false:true};SP.UI.MicroFeed.BaseAtMention.$8t=function(){var b=window._spPageContextInfo;if(b){var a=b.webServerRelativeUrl;if(!a.endsWith("/"))a+="/";return a+"_vti_bin/taxonomyinternalservice.json"}else return""};SP.UI.MicroFeed.BaseAtMention.$8l=function(){var a=1033,b=window._spPageContextInfo;if(b)a=b.currentLanguage;return a};SP.UI.MicroFeed.BaseAtMention.getTagEndIndex=function(b,c){var a=b.search(SP.UI.MicroFeed.BaseAtMention.disallowedHashTagCharsRegex);if(a===-1&&c)a=b.length;return a};SP.UI.MicroFeed.BaseAtMention.prototype={$q_0:0,m_MaxToResolve:0,m_MaxTagsToResolve:6,m_LastGetTaxonomyFailed:false,get_isSuggestionMenuOpen:function(){var a=$get(SP.UI.MicroFeed.BaseAtMention.$1c);return!!a&&a.getAttribute(SP.UI.MicroFeed.BaseAtMention.$1U)===this.get_ownerControlId()||!!SP.UI.MicroFeed.BaseAtMention.tagSuggestions&&SP.UI.MicroFeed.BaseAtMention.tagSuggestions.get_isShowing()},reset:function(){this.$q_0=0},get_currentSelection:function(){if($get(this.get_ownerControlId()+SP.UI.MicroFeed.BaseAtMention.$R+1))if(this.$q_0>0)return this.getElementAt(this.$q_0);return null},getElementAt:function(c){var a=null;a=$get(this.get_ownerControlId()+SP.UI.MicroFeed.BaseAtMention.$R+c);if(a){var b=new SP.UI.MicroFeed.AtMentionMenuOption;b.displayName=a.getAttribute(SP.UI.MicroFeed.BaseAtMention.$21);b.alias=a.getAttribute(SP.UI.MicroFeed.BaseAtMention.$3l);return b}return null},highlightElementFromDropDown:function(c){var a=$get(this.get_ownerControlId()+SP.UI.MicroFeed.BaseAtMention.$R+this.$q_0),b=$get(this.get_ownerControlId()+SP.UI.MicroFeed.BaseAtMention.$R+c);if(a&&b){a.className=a.className.replace(SP.UI.MicroFeed.BaseAtMention.$3f,SP.UI.MicroFeed.BaseAtMention.$23);a.removeAttribute("role");b.className=b.className.replace(SP.UI.MicroFeed.BaseAtMention.$23,SP.UI.MicroFeed.BaseAtMention.$3f);b.setAttribute("role","alert");this.$q_0=c}},shouldCreateSuggestionDropdown:function(){return true},moveSuggestionDropDownToCurrentOwner:function(){var a=$get(SP.UI.MicroFeed.BaseAtMention.$1c),b=null;if(a&&a.parentNode)if(a.getAttribute(SP.UI.MicroFeed.BaseAtMention.$1U)===this.get_ownerControlId())b=$get(this.get_ownerControlId()+SP.UI.MicroFeed.BaseAtMention.$5G);else{a.parentNode.removeChild(a);a=null}if(!a){a=document.createElement("div");a.id=SP.UI.MicroFeed.BaseAtMention.$1c;a.className="ms-microfeed-mentionContainer";a.setAttribute(SP.UI.MicroFeed.BaseAtMention.$1U,this.get_ownerControlId());this.$72_0(a)}if(!b){b=document.createElement("div");b.id=this.get_ownerControlId()+SP.UI.MicroFeed.BaseAtMention.$5G;b.className="ms-microfeed-typeAheadSelectorsDiv";b.setAttribute("aria-live","polite");b.setAttribute("aria-relevant","all");a.appendChild(b)}this.fullContainerChanged(a);return b},$72_0:function(a){this.get_dropDownBeforeSibling()&&this.get_dropDownBeforeSibling().parentNode&&this.get_dropDownBeforeSibling().parentNode.insertBefore(a,this.get_dropDownBeforeSibling().nextSibling)},fullContainerChanged:function(){},buildSuggestionDropDown:function(a){var e=this.get_shouldDisplayTooManyWarning();if(this.m_handlingMode===2&&SP.UI.MicroFeed.BaseAtMention.$7v(a.prefix)&&!e){SP.UI.MicroFeed.BaseAtMention.$7d();if(this.addAdditionalWarningMessages(a,null)){this.$8h_0();this.$72_0(SP.UI.MicroFeed.BaseAtMention.tagSuggestionDiv);this.$9R_0(a.prefix);SP.UI.MicroFeed.BaseAtMention.tagSuggestionDiv.elementPrefix=a.prefix;SP.UI.MicroFeed.BaseAtMention.tagSuggestionDiv.triggerPosition=a.triggerPosition}return}SP.UI.MicroFeed.BaseAtMention.$7e();var b=this.moveSuggestionDropDownToCurrentOwner(),c=null;if(!b){SP.UI.MicroFeed.BaseAtMention.removeSuggestionSelector();return}this.m_handlingMode===1&&!SP.UI.MicroFeed.SPMicroFeed.$1Q&&SP.UI.MicroFeed.SPMicroFeed.initializeCSOMData(true);b.innerHTML="";if(e){var d=null;if(this.m_handlingMode===1)d=SpsClient.ScriptResources.mentionsWarningText;else if(this.m_handlingMode===2)d=String.format(SpsClient.ScriptResources.tooManyTagsWarning,this.m_MaxTagsToResolve);d&&this.appendDropdownWarning(b,d,"_toomanymentionwarning","ms-microfeed-tooManyElementsWarning");if(this.m_handlingMode===2)return}if(this.m_handlingMode===1&&SP.UI.MicroFeed.BaseAtMention.$9e(a.prefix))this.addAdditionalWarningMessages(a,b)&&this.$8A_0(a,b);c=$get(this.get_ownerControlId()+SP.UI.MicroFeed.BaseAtMention.$R+"1");if(c){c.className=c.className.replace(SP.UI.MicroFeed.BaseAtMention.$23,SP.UI.MicroFeed.BaseAtMention.$3f);this.$q_0=1;var f=this;$addHandler(b,"click",function(a){a.stopPropagation()})}else!$get(this.get_ownerControlId()+"_taxonomynotavailablewarning")&&!SP.UI.MicroFeed.BaseAtMention.$73()&&SP.UI.MicroFeed.BaseAtMention.removeSuggestionSelector()},$8A_0:function(i,c){var a=0,b=false,e=i.prefix;if(SP.UI.MicroFeed.BaseAtMention.$1E&&SP.UI.MicroFeed.BaseAtMention.$1E.length)for(var j=SP.UI.MicroFeed.BaseAtMention.$1E,l=j.length,g=0;g<l;++g){var h=j[g];if(!h.$a_0.toLowerCase().startsWith(e.toLowerCase()))continue;a++;if(!b){c.appendChild(this.$2b_0(SpsClient.ScriptResources.peopleFollowingLabel,"_FollowingHeadingDiv",null,null));b=true}c.appendChild(this.$3o_0(i,a,h.$a_0,h.$3_0,""));if(a>=SP.UI.MicroFeed.BaseAtMention.$2M)break}else!SP.UI.MicroFeed.BaseAtMention.$1E&&c.appendChild(this.$2b_0(SpsClient.ScriptResources.peopleFollowingLabel,"_FollowingHeadingDiv",SP.UI.MicroFeed.BaseAtMention.$4k,SpsClient.ScriptResources.loadingPeopleTitle));b=false;if(a<SP.UI.MicroFeed.BaseAtMention.$2M){var f=0,d=null;if(SP.UI.MicroFeed.BaseAtMention.get_$1V().$1n_0){c.appendChild(this.$2b_0(SpsClient.ScriptResources.allPeopleLabel,"_CompanyHeadingDiv",SP.UI.MicroFeed.BaseAtMention.get_$1V().m_loadingAnimationIDForRequest,SpsClient.ScriptResources.loadingPeopleTitle));b=true}if(!SP.UI.MicroFeed.BaseAtMention.get_$1V().$92_1(e)){var k=SP.UI.MicroFeed.BaseAtMention.get_$1V().$8s_0(e.substr(0,1));for(f=0;f<k.length;f++){d=k[f];if(!d.$a_0.toLowerCase().startsWith(e.toLowerCase()))continue;a++;if(!b){c.appendChild(this.$2b_0(SpsClient.ScriptResources.allPeopleLabel,"_CompanyHeadingDiv",null,null));b=true}c.appendChild(this.$3o_0(i,a,d.$a_0,d.$3_0,d.$2H_0));if(a>=SP.UI.MicroFeed.BaseAtMention.$2M)break}}}},createLinkElement:function(g,f,c,e,d){var b=this.$3o_0(g,f,"","","");b.setAttribute(SP.UI.MicroFeed.BaseAtMention.$21,c);b.className+=" ms-linkOptionDiv";var a=document.createElement("a");a.id=e;a.href="#";a.className="ms-commandLink";a.setAttribute("onclick","return false;");a.innerHTML=STSHtmlEncode(d);b.appendChild(a);return b},appendDropdownWarning:function(d,e,g,f){var a=document.createElement("div");a.id=this.get_ownerControlId()+g;a.className=f;a.style.height="auto";var c=document.createElement("span");c.className="ms-microfeed-warningImage";c.id="ms-DropdownWarningImage";var b=document.createElement("div");b.id="ms-microfeed-warningText";b.className="ms-microfeed-warningText";b.appendChild(document.createTextNode(e));a.appendChild(c);a.appendChild(b);d.appendChild(a)},$2b_0:function(e,f,d,b){var a=document.createElement("div");a.id=this.get_ownerControlId()+f;SP.UI.MySiteCommon.CommonUIElements.setElementText(a,e);a.className="ms-microfeed-followingHeadingDiv ms-soften";if(d){var c=SP.UI.MySiteCommon.CommonUIElements.createProcessingIcon(d,"ms-microfeed-loadingSuggestionImage");b=b||"";c.alt=b;c.title=b;a.appendChild(c)}return a},$4h_0:function(b,a,c){if(a)this.onElementSelected(b,a,c)},$3o_0:function(g,e,b,h,f){var a=document.createElement("div");a.id=this.get_ownerControlId()+SP.UI.MicroFeed.BaseAtMention.$R+e;a.className="ms-microfeed-mentionUserDiv "+SP.UI.MicroFeed.BaseAtMention.$23;var c=this;$addHandler(a,"click",function(){c.$4h_0(g,c.getElementAt(e),false)});a.setAttribute(SP.UI.MicroFeed.BaseAtMention.$3l,h);a.setAttribute(SP.UI.MicroFeed.BaseAtMention.$21,b);var d=b;if(!SP.ScriptHelpers.isNullOrEmptyString(f))d=String.format(SpsClient.ScriptResources.nameAndDescriptionFormatString,b,f);SP.UI.MySiteCommon.CommonUIElements.setElementText(a,d);$addHandler(a,"mouseover",this.$$d_$9T_0);return a},$9T_0:function(b){var a=b.target.id;this.highlightElementFromDropDown(parseInt(a.substr(a.lastIndexOf("_")+1)))},correctDropdownState:function(){if(this.get_shouldProvideSuggestions()){var a=this.calculateCurrentState();this.shouldCreateSuggestionDropdown(a)&&this.buildSuggestionDropDown(a)}else SP.UI.MicroFeed.BaseAtMention.removeSuggestionSelector()},$7b_0:function(b,c){var a=this;b.$99_0(c.prefix,function(){if(a.get_shouldProvideSuggestions()){var c=a.calculateCurrentState();a.$7b_0(b,c)}a.correctDropdownState()})},typeAheadKeyDownHandler:function(a){if(!this.get_isSuggestionMenuOpen())return;if(!this.get_shouldProvideSuggestions()){SP.UI.MicroFeed.BaseAtMention.removeSuggestionSelector();return}if(a.keyCode===27){a.preventDefault();SP.UI.MicroFeed.BaseAtMention.removeSuggestionSelector();return}if(a.keyCode===38||a.keyCode===40){this.$8D_0(a.keyCode===38);a.preventDefault();return}if(a.keyCode===13&&!a.shiftKey){SP.UI.MicroFeed.BaseAtMention.tagSuggestions&&SP.UI.MicroFeed.BaseAtMention.tagSuggestions.get_isShowing()&&this.$8i_0();$get(this.get_ownerControlId()+SP.UI.MicroFeed.BaseAtMention.$R+1)&&this.$4h_0(this.calculateCurrentState(),this.get_currentSelection(),false);a.preventDefault();a.stopPropagation()}},typeAheadKeyUpHandler:function(a){if(!this.get_shouldProvideSuggestions()||a.keyCode===27||a.keyCode===13){SP.UI.MicroFeed.BaseAtMention.removeSuggestionSelector();return}if(a.keyCode===38||a.keyCode===40){if(this.get_isSuggestionMenuOpen()){var c=1;if(a.keyCode===38)c=this.$q_0-1;else c=this.$q_0+1;this.highlightElementFromDropDown(c);a.preventDefault();a.stopPropagation()}return}var b=this.calculateCurrentState();this.m_handlingMode===1&&this.$7b_0(SP.UI.MicroFeed.BaseAtMention.get_$1V(),b);if(this.m_handlingMode===2)if(!SP.UI.MicroFeed.BaseAtMention.$7v(b.prefix)){SP.UI.MicroFeed.BaseAtMention.removeSuggestionSelector();return}if(a.keyCode===32&&this.m_handlingMode!==2){var d=$get(this.get_ownerControlId()+SP.UI.MicroFeed.BaseAtMention.$R+"2");if(this.m_handlingMode===1&&!d)if(this.$8X_0(b.prefix)){this.$4h_0(b,this.get_currentSelection(),true);return}else if(!$get(this.get_ownerControlId()+SP.UI.MicroFeed.BaseAtMention.$R+"1")&&!SP.UI.MicroFeed.BaseAtMention.$73()){SP.UI.MicroFeed.BaseAtMention.removeSuggestionSelector();return}}this.shouldCreateSuggestionDropdown(b)&&this.buildSuggestionDropDown(b)},$8X_0:function(b){var a=$get(this.get_ownerControlId()+SP.UI.MicroFeed.BaseAtMention.$R+this.$q_0);return!a?false:b.toLowerCase()===a.getAttribute(SP.UI.MicroFeed.BaseAtMention.$21).toLowerCase()+" "},$9Q_0:function(b){var a=new SP.UI.MySiteCommon.MySiteDialog(SpsClient.ScriptResources.unknownErrorTitle,b);a.set_hideCancelButton(true);a.show()},addMentionsWarningTextWhenTargetting:function(a,b){this.addStandardDropdownWarning(a,String.format(SpsClient.ScriptResources.mentionsWarningTextWhenTargetting,b),"_targetmentionwarning")},addStandardDropdownWarning:function(a,c,b){this.appendDropdownWarning(a,c,b,"ms-microfeed-tooManyElementsWarning")},$9R_0:function(b){if(SP.ScriptHelpers.isNullOrEmptyString(b)||b==="#")return;var a={};a.start=b;a.lcid=SP.UI.MicroFeed.BaseAtMention.$8l();a.sspList="00000000-0000-0000-0000-000000000000";a.termSetList="3CEB0050-69A1-40E7-A427-83E2FAC80C27";a.anchorId="00000000-0000-0000-0000-000000000000";a.isSpanTermStores=false;a.isSpanTermSets=false;a.isIncludeUnavailable=false;a.isIncludeDeprecated=false;a.isAddTerms=false;a.isIncludePathData=false;a.excludeKeyword=true;a.excludedTermset="00000000-0000-0000-0000-000000000000";var c=SP.UI.MicroFeed.BaseAtMention.$8t();!SP.ScriptHelpers.isNullOrEmptyString(c)&&Sys.Net.WebServiceProxy.invoke(c,"GetSuggestions",false,a,this.$$d_$9D_0,this.$$d_$9B_0,b,Sys.Net.WebRequestManager.get_defaultTimeout(),false,null)},$9D_0:function(b,c){this.m_LastGetTaxonomyFailed=false;if(!SP.UI.MicroFeed.BaseAtMention.tagSuggestions)return;var a=c;if(!SP.ScriptHelpers.isNullOrEmptyString(a))SP.UI.MicroFeed.BaseAtMention.tagSuggestions.updateSuggestionsWithTaxonomyResult(b,a,a,{},true);else SP.UI.MicroFeed.BaseAtMention.tagSuggestions.hidePanel()},$9B_0:function(){if(!this.m_LastGetTaxonomyFailed){this.$9Q_0(SpsClient.ScriptResources.taxonomyNotAvailableWarning);this.m_LastGetTaxonomyFailed=true}},$8h_0:function(){if(!SP.UI.MicroFeed.BaseAtMention.tagSuggestionDiv||!SP.UI.MicroFeed.BaseAtMention.tagSuggestionDiv.parentNode){SP.UI.MicroFeed.BaseAtMention.tagSuggestionDiv=document.createElement("DIV");SP.UI.MicroFeed.BaseAtMention.tagSuggestionDiv.id="HashTagSuggestionsContainer";SP.UI.MicroFeed.BaseAtMention.tagSuggestions=new Microsoft.SharePoint.Taxonomy.SuggestionContainer(SP.UI.MicroFeed.BaseAtMention.tagSuggestionDiv);SP.UI.MicroFeed.BaseAtMention.tagSuggestions.hidePanel();SP.UI.MicroFeed.BaseAtMention.tagSuggestions[SP.UI.MicroFeed.BaseAtMention.$1U]=this.get_ownerControlId();SP.UI.MicroFeed.BaseAtMention.tagSuggestions.set_isSpanTermSets(true);SP.UI.MicroFeed.BaseAtMention.tagSuggestions.add_selectionMade(this.$$d_$7T_0);Sys.Net.WebRequestManager.add_invokingRequest(this.$$d_$9C_0)}},$7T_0:function(h,d){if(d){var e=this.calculateCurrentState(),a=new SP.UI.MicroFeed.AtMentionMenuOption,b=d.results;if(b){var f=SP.UI.MicroFeed.BaseAtMention.tagSuggestionDiv.triggerPosition,g=SP.UI.MicroFeed.BaseAtMention.tagSuggestionDiv.elementPrefix,c=new Microsoft.SharePoint.Taxonomy.Term(b);a.alias=c.get_guid();a.displayName=c.get_text()}this.onElementSelected(e,a,false)}},$9C_0:function(e,d){if(!SP.ScriptHelpers.isUndefined(window._spPageContextInfo)&&!SP.ScriptHelpers.isUndefined(window._spFormDigestRefreshInterval)&&!SP.ScriptHelpers.isUndefined(window.UpdateFormDigest)){var b=_spPageContextInfo.webServerRelativeUrl,c=window._spFormDigestRefreshInterval;UpdateFormDigest(b,c)}var a=$get("__REQUESTDIGEST");if(a)d.get_webRequest().get_headers()["X-RequestDigest"]=a.value},$8D_0:function(a){SP.UI.MicroFeed.BaseAtMention.tagSuggestions&&SP.UI.MicroFeed.BaseAtMention.tagSuggestions.get_isShowing()&&SP.UI.MicroFeed.BaseAtMention.tagSuggestions.toggleHighlight(a)},$8i_0:function(){if(SP.UI.MicroFeed.BaseAtMention.tagSuggestions&&SP.UI.MicroFeed.BaseAtMention.tagSuggestions.get_isShowing()){var a=SP.UI.MicroFeed.BaseAtMention.tagSuggestions.getHighlightedSuggestion();if(a){var b=new Microsoft.SharePoint.Taxonomy.SelectionMadeEventArgs(a.get_suggestValue());this.$7T_0(null,b)}}}};SP.UI.MicroFeed.AtMentionMenuOption=function(){};SP.UI.MicroFeed.AtMentionMenuOption.prototype={displayName:null,alias:null};SP.UI.MicroFeed.OwnerControlState=function(){};SP.UI.MicroFeed.OwnerControlState.prototype={prefix:null,triggerPosition:0};SP.UI.MicroFeed.SocialActorCache=function(){this.$3i_0={}};SP.UI.MicroFeed.SocialActorCache.get_actorCache=function(){if(!SP.UI.MicroFeed.SocialActorCache.$11)SP.UI.MicroFeed.SocialActorCache.$11=new SP.UI.MicroFeed.SocialActorCache;return SP.UI.MicroFeed.SocialActorCache.$11};SP.UI.MicroFeed.SocialActorCache.isFollowedByMe=function(a){return!a?false:SP.UI.MicroFeed.SocialActorCache.get_actorCache().$3i_0[a]};SP.UI.MicroFeed.SocialActorCache.setIsFollowedByMeValue=function(a,b){if(!a)return;SP.UI.MicroFeed.SocialActorCache.get_actorCache().$3i_0[a.get_id()]=b};SP.UI.MicroFeed.SocialActorCache.prototype={$3i_0:null};SP.UI.MicroFeed.MicrofeedThreadCache=function(){this.$C_0={}};SP.UI.MicroFeed.MicrofeedThreadCache.get_threadCache=function(){if(!SP.UI.MicroFeed.MicrofeedThreadCache.$11)SP.UI.MicroFeed.MicrofeedThreadCache.$11=new SP.UI.MicroFeed.MicrofeedThreadCache;return SP.UI.MicroFeed.MicrofeedThreadCache.$11};SP.UI.MicroFeed.MicrofeedThreadCache.getThreadById=function(a){return!a?null:SP.UI.MicroFeed.MicrofeedThreadCache.get_threadCache().$C_0[a]};SP.UI.MicroFeed.MicrofeedThreadCache.addOrUpdate=function(a,c){if(!a)return;SP.UI.MicroFeed.MicrofeedThreadCache.$5Q(a.get_actors());a.get_postReference()&&a.get_postReference().get_digest()&&SP.UI.MicroFeed.MicrofeedThreadCache.$5Q(a.get_postReference().get_digest().get_actors());if(!a.get_threadType()&&a.get_replies()&&a.get_replies().length<2&&a.get_replies().length!==a.get_totalReplyCount())return;if(!a.get_actors().length)return;if(c){var b=SP.UI.MicroFeed.MicrofeedThreadCache.getThreadById(a.get_id());(!b||a.get_totalReplyCount()!==b.get_totalReplyCount()||a.get_rootPost().get_modifiedTime().toString()!==b.get_rootPost().get_modifiedTime().toString())&&SP.UI.MicroFeed.SPMicroFeed.microfeed.incrementNewPostCount()}SP.UI.MicroFeed.MicrofeedThreadCache.get_threadCache().$C_0[a.get_id()]=a};SP.UI.MicroFeed.MicrofeedThreadCache.$5Q=function(e){for(var c=e,d=c.length,b=0;b<d;++b){var a=c[b];if(!a.get_actorType())SP.UI.People.PersonManager.addSocialActor(a);else SP.UI.MicroFeed.SocialActorCache.setIsFollowedByMeValue(a,a.get_isFollowed())}};SP.UI.MicroFeed.MicrofeedThreadCache.removeById=function(a){if(!a)return;SP.UI.MicroFeed.MicrofeedThreadCache.get_threadCache().$C_0[a]=null};SP.UI.MicroFeed.MicrofeedThreadCache.prototype={$C_0:null};SP.UI.MicroFeed.MicrofeedThreadList=function(){this.$C_0=[];this.$37_0={}};SP.UI.MicroFeed.MicrofeedThreadList.prototype={$C_0:null,$7B_0:false,$37_0:null,setThreadCollection:function(a,d,c){if(a&&a.get_threads()){var b=0;this.$7B_0=c;Array.clear(this.$C_0);this.$37_0={};for(b=0;b<a.get_threads().length;b++){var e=a.get_threads()[b];this.add(e,d,true)}}},appendThreadList:function(a){this.$5c_0();if(!a||!a.sizeAfterRemovingRecentDeletions())return;for(var b=null,c=0;c<a.size();c++){b=a.get(c);!this.containsByID(b.get_id())&&this.add(b,false,false)}},"get":function(a){return a<0||a>=this.$C_0.length?null:SP.UI.MicroFeed.MicrofeedThreadCache.getThreadById(this.$C_0[a])},containsByID:function(a){return this.$4g_0(a)>-1},$5c_0:function(){for(var a=0;a<this.$C_0.length;a++)while(a<this.$C_0.length&&!SP.UI.MicroFeed.MicrofeedThreadCache.getThreadById(this.$C_0[a]))Array.removeAt(this.$C_0,a)},add:function(a,c,d){d&&SP.UI.MicroFeed.MicrofeedThreadCache.addOrUpdate(a,c);if(this.$7B_0){var b="";if(!a.get_threadType())b=a.get_rootPost().get_id();else if(a.get_postReference())b=a.get_postReference().get_threadId();else return;if(this.$37_0[b])return;this.$37_0[b]=true}Array.add(this.$C_0,a.get_id())},addToFront:function(a,b){SP.UI.MicroFeed.MicrofeedThreadCache.addOrUpdate(a,b);Array.insert(this.$C_0,0,a.get_id())},moveToFront:function(a,c){SP.UI.MicroFeed.MicrofeedThreadCache.addOrUpdate(a,c);var b=this.$4g_0(a.get_id());if(b>-1){Array.removeAt(this.$C_0,b);Array.insert(this.$C_0,0,a.get_id())}},remove:function(b){var a=this.$4g_0(b.get_id());a>-1&&Array.removeAt(this.$C_0,a)},$4g_0:function(b){if(!b)return-1;for(var a=0;a<this.$C_0.length;a++)if(this.$C_0[a]===b)return a;return-1},size:function(){return this.$C_0.length},sizeAfterRemovingRecentDeletions:function(){this.$5c_0();return this.$C_0.length}};SP.UI.MicroFeed.MicroFeedView=function(){};SP.UI.MicroFeed.MicroFeedView.createView=function(d,e,f,c,b){var a=new SP.UI.MicroFeed.MicroFeedView;a.$5P_0=d;a.$f_0=e;a.$u_0=f;a.$3u_0=c;a.$2l_0=b;return a};SP.UI.MicroFeed.MicroFeedView.prototype={get_numVisiblePosts:function(){return this.$5P_0.length},visiblePostAttribute:function(a){return this.$5P_0[a]},get_feedName:function(){return this.$u_0},get_emptyFeedMessage:function(){return this.$3u_0},get_feedToUse:function(){return this.$f_0},get_feedDescription:function(){return this.$2l_0},$5P_0:null,$f_0:0,$u_0:null,$3u_0:null,$2l_0:null};SP.UI.MicroFeed.AttributePair=function(){};SP.UI.MicroFeed.AttributePair.createAttributePairWithType=function(b,a){return SP.UI.MicroFeed.AttributePair.createAttributePair(SP.Social.SocialThreadType.toString(b),a)};SP.UI.MicroFeed.AttributePair.createAttributePair=function(c,b){var a=new SP.UI.MicroFeed.AttributePair;a.$39_0=c;a.$3h_0=b;return a};SP.UI.MicroFeed.AttributePair.prototype={get_key:function(){return this.$39_0},get_value:function(){return this.$3h_0},$39_0:null,$3h_0:null};SP.UI.MicroFeed.SPMicroFeed=function(k,j,i){this.$$d_$9X_0=Function.createDelegate(this,this.$9X_0);this.$$d_$9Y_0=Function.createDelegate(this,this.$9Y_0);this.$$d_$9W_0=Function.createDelegate(this,this.$9W_0);this.$$d_$7X_0=Function.createDelegate(this,this.$7X_0);this.$$d_$8E_0=Function.createDelegate(this,this.$8E_0);this.$P_0=SpsClient.ScriptResources.replyTextBoxString;var e=$get(SP.UI.MicroFeed.SPMicroFeed.$1s);e.className=SP.UI.MicroFeed.SPMicroFeed.$7O;var a="",b="";this.$3B_0="";this.$7_0=k;e.innerHTML="";this.$M_0="";this.$K_0=true;SP.UI.MicroFeed.SPMicroFeed.$N={};this.$E_0=[];this.$5_0=[];this.$1A_0=new Date;this.$1l_0=0;this.$18_0=-1;this.$1O_0=this.$7_0===1;this.$4t_0=false;this.$1i_0=-1;this.$2I_0=false;this.$3C_0=0;this.$1k_0=null;this.$4q_0=new Date;this.$14_0=false;SP.UI.MicroFeed.SPMicroFeed.$W=false;SP.UI.MicroFeed.SPMicroFeed.$1T=null;this.$4v_0=false;this.$3F_0="";this.$3E_0="";this.$3J_0="";this.$3I_0="";this.$1h_0=j;this.$3A_0=i;SP.UI.MicroFeed.SPMicroFeed.$H={};var f="",g="",l=SP.ScriptHelpers.getDocumentQueryPairs(),c=l;for(var d in c){var h={key:d,value:c[d]};a=h.key.toLowerCase();b=decodeURIComponent(h.value||"");if(a==="threadid"&&!SP.ScriptHelpers.isNullOrEmptyString(b))SP.UI.MicroFeed.SPMicroFeed.$W=true;if(a==="mentionperson")this.$3F_0=b;else if(a==="mentionpersonname")this.$3E_0=b;else if(a==="tagtext")this.$3J_0=b;else if(a==="tagid")this.$3I_0=b;else if(a==="unsubscribe")this.$4v_0=true;else if(a==="rootpostauthorid")f=b;else if(a==="rootpostid")g=b}if(!SP.ScriptHelpers.isNullOrEmptyString(g)&&!SP.ScriptHelpers.isNullOrEmptyString(f))SP.UI.MicroFeed.SPMicroFeed.$W=true};SP.UI.MicroFeed.SPMicroFeed.get_companyFeedViewIndex=function(){return SP.UI.MicroFeed.SPMicroFeed.$1t};SP.UI.MicroFeed.SPMicroFeed.set_companyFeedViewIndex=function(a){SP.UI.MicroFeed.SPMicroFeed.$1t=a;return a};SP.UI.MicroFeed.SPMicroFeed.get_$D=function(){!SP.UI.MicroFeed.SPMicroFeed.$Q&&!SP.UI.MicroFeed.SPMicroFeed.$r&&SP.UI.MicroFeed.SPMicroFeed.initializeCSOMData(false);return SP.UI.MicroFeed.SPMicroFeed.$Q};SP.UI.MicroFeed.SPMicroFeed.get_$X=function(){!SP.UI.MicroFeed.SPMicroFeed.$Q&&!SP.UI.MicroFeed.SPMicroFeed.$r&&SP.UI.MicroFeed.SPMicroFeed.initializeCSOMData(false);return SP.UI.MicroFeed.SPMicroFeed.$3Z};SP.UI.MicroFeed.SPMicroFeed.get_$5F=function(){!SP.UI.MicroFeed.SPMicroFeed.$1u&&SP.UI.MicroFeed.SPMicroFeed.initializeCSOMData(false);return SP.UI.MicroFeed.SPMicroFeed.$1u};SP.UI.MicroFeed.SPMicroFeed.get_followedPeopleCallback=function(){return SP.UI.MicroFeed.SPMicroFeed.$2S};SP.UI.MicroFeed.SPMicroFeed.set_followedPeopleCallback=function(a){SP.UI.MicroFeed.SPMicroFeed.$2S=a;return a};SP.UI.MicroFeed.SPMicroFeed.get_$1H=function(){return GetThemedImageUrl("spcommon.png")};SP.UI.MicroFeed.SPMicroFeed.get_$5K=function(){return GetThemedImageUrl("socialcommon.png")};SP.UI.MicroFeed.SPMicroFeed.setFocusOnRootPostInputBox=function(){var a=$get(SP.UI.MicroFeed.SPMicroFeed.$1D);a&&a.focus()};SP.UI.MicroFeed.SPMicroFeed.initializeForExternalUse=function(){if(!SP.UI.MicroFeed.SPMicroFeed.$1S){SP.UI.MicroFeed.SPMicroFeed.$r=true;SP.UI.MicroFeed.SPMicroFeed.$1S=true}};SP.UI.MicroFeed.SPMicroFeed.initializeCSOMData=function(a){if(SP.UI.MicroFeed.SPMicroFeed.$1S&&!SP.UI.MicroFeed.SPMicroFeed.$Q&&!SP.UI.MicroFeed.SPMicroFeed.$r){SP.UI.MicroFeed.SPMicroFeed.$3b=false;SP.UI.MicroFeed.SPMicroFeed.$2V=false;SP.UI.MicroFeed.SPMicroFeed.$1Q=false}if(!SP.UI.MicroFeed.SPMicroFeed.$Q&&SP.UI.MicroFeed.SPMicroFeed.$1S&&!SP.UI.MicroFeed.SPMicroFeed.$3b){SP.UI.MicroFeed.SPMicroFeed.$3b=true;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){SP.UI.MicroFeed.SPMicroFeed.$L=SP.ClientContext.get_current();if(!SP.UI.MicroFeed.SPMicroFeed.$r)SP.UI.MicroFeed.SPMicroFeed.$Q=SP.Social.SocialFeedManager.newObject(SP.UI.MicroFeed.SPMicroFeed.$L);if(!SP.UI.MicroFeed.SPMicroFeed.$1u)SP.UI.MicroFeed.SPMicroFeed.$1u=SP.UserProfiles.PeopleManager.newObject(SP.UI.MicroFeed.SPMicroFeed.$L)})}a&&SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){},function(){})};SP.UI.MicroFeed.SPMicroFeed.setCSOMDataInited=function(){if(!SP.UI.MicroFeed.SPMicroFeed.$1Q&&(SP.UI.MicroFeed.SPMicroFeed.$r||SP.UI.MicroFeed.SPMicroFeed.$Q.isPropertyAvailable(SP.Social.SocialFeedManagerPropertyNames.owner))){if(SP.UI.MicroFeed.SPMicroFeed.$Q)SP.UI.MicroFeed.SPMicroFeed.$3Z=SP.UI.MicroFeed.SPMicroFeed.$Q.get_owner();SP.UI.MicroFeed.SPMicroFeed.$1Q=true}};SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded=function(c,d){var a=null,b=false;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){if(!SP.UI.MicroFeed.SPMicroFeed.$1Q&&!SP.UI.MicroFeed.SPMicroFeed.$2V){SP.UI.MicroFeed.SPMicroFeed.initializeCSOMData(false);SP.UI.MicroFeed.SPMicroFeed.$2V=true;b=true;a=SP.UI.MicroFeed.SPMicroFeed.$9Z();SP.UI.MicroFeed.SPMicroFeed.$Q&&SP.UI.MicroFeed.SPMicroFeed.$L.load(SP.UI.MicroFeed.SPMicroFeed.$Q)}SP.UI.MicroFeed.SPMicroFeed.$L.get_hasPendingRequest()&&SP.UI.MicroFeed.SPMicroFeed.$L.executeQueryAsync(function(d,e){if(b){SP.UI.MicroFeed.SPMicroFeed.setCSOMDataInited();a&&SP.UI.MicroFeed.SPMicroFeed.$9a(a)}c(d,e)},function(a,c){if(b)SP.UI.MicroFeed.SPMicroFeed.$2V=false;d(a,c)})})};SP.UI.MicroFeed.SPMicroFeed.$8z=function(){var a=null,b=OpenSuiteLinksJson();if(b)try{a=JSON.parse(b)}catch(c){}if(a)if(typeof a.AdminLink!=="undefined"&&a.AdminLink)return true;return false};SP.UI.MicroFeed.SPMicroFeed.$8o=function(){var a=new SP.ClientRuntimeContext(_spPageContextInfo.webServerRelativeUrl),b=$get("ms-microfeedthreadviewthread");if(b){SP.UI.MicroFeed.SPMicroFeed.$1T=a.parseObjectFromJsonString(SP.UI.UIUtility.getInnerText(b));SP.UI.MicroFeed.MicrofeedThreadCache.addOrUpdate(SP.UI.MicroFeed.SPMicroFeed.$1T,false);b.parentNode.removeChild(b)}var c=$get("ms-microfeedinitialdata"),h=null;if(c){h=a.parseObjectFromJsonString(SP.UI.UIUtility.getInnerText(c));c.parentNode.removeChild(c)}var d=$get("ms-microfeedsitesfolloweddata");if(d){SP.UI.MicroFeed.SPMicroFeed.$1v=a.parseObjectFromJsonString(SP.UI.UIUtility.getInnerText(d));d.parentNode.removeChild(d)}var e=$get("ms-microfeedcurrentuser");if(e){SP.UI.MicroFeed.SPMicroFeed.$3Z=a.parseObjectFromJsonString(SP.UI.UIUtility.getInnerText(e));e.parentNode.removeChild(e)}var f=$get("ms-microfeedisfeedactivitypublic");if(f){SP.UI.MicroFeed.SPMicroFeed.$5E=a.parseObjectFromJsonString(SP.UI.UIUtility.getInnerText(f));f.parentNode.removeChild(f)}var g=$get("ms-microfeedcanfollowtagsandusers");if(g){SP.UI.MicroFeed.SPMicroFeed.$3Y=a.parseObjectFromJsonString(SP.UI.UIUtility.getInnerText(g));g.parentNode.removeChild(g)}return h};SP.UI.MicroFeed.SPMicroFeed.switchToCompanyFeedView=function(){SP.UI.MicroFeed.SPMicroFeed.microfeed.changeView(SP.UI.MicroFeed.SPMicroFeed.$1t)};SP.UI.MicroFeed.SPMicroFeed.getPostIDFromDOMElementID=function(a){return a.substr(a.lastIndexOf("_")+1)};SP.UI.MicroFeed.SPMicroFeed.initializeWhatsNew=function(g,f,h){var b="",c="",d="",e="",a=$get(SP.UI.MicroFeed.SPMicroFeed.$1s);if(a){b=a.getAttribute("unreadMentionCount");c=a.getAttribute("errorString");d=a.getAttribute("statusCode");e=a.getAttribute("isPubFeedOnly")}else return;if(e==="false"){SP.UI.MicroFeed.SPMicroFeed.microfeed=new SP.UI.MicroFeed.SPMicroFeed(1,g,f);!SP.ScriptHelpers.isNullOrEmptyString(b)&&SP.UI.MicroFeed.SPMicroFeed.microfeed.$1x_0(Number.parseInvariant(b));SP.UI.MicroFeed.SPMicroFeed.microfeed.$M_0="";SP.UI.MicroFeed.SPMicroFeed.microfeed.initialize(h,true,"","",c?c:"",d?d:"")}};SP.UI.MicroFeed.SPMicroFeed.initializePublishedFeed=function(h,i,k,j,l,m,c,g){var d="",e="",a=$get(SP.UI.MicroFeed.SPMicroFeed.$1s);if(a){d=a.getAttribute("errorString");e=a.getAttribute("statusCode")}else return;var b=false;if(m)b=true;SP.UI.MicroFeed.SPMicroFeed.microfeed=new SP.UI.MicroFeed.SPMicroFeed(b?2:0,k,j);if(b&&c)SP.UI.MicroFeed.SPMicroFeed.microfeed.$M_0=c;if(!g)SP.UI.MicroFeed.SPMicroFeed.microfeed.$K_0=false;var f=false;if(l&&SP.UI.MicroFeed.SPMicroFeed.microfeed.$K_0)f=true;SP.UI.MicroFeed.SPMicroFeed.microfeed.initialize(f,true,h,i,d||"",e||"")};SP.UI.MicroFeed.SPMicroFeed.$2X=function(b){var c=SP.UI.MicroFeed.SPMicroFeed.getPostIDFromDOMElementID(b.id),d=SP.UI.MicroFeed.SPMicroFeed.$N[c],a=$get(b.id===SP.UI.MicroFeed.SPMicroFeed.$1D?SP.UI.MicroFeed.SPMicroFeed.$3R:SP.UI.MicroFeed.SPMicroFeed.$2z+c);if(a){d.setElementHighlights(a);a.style.height=b.clientHeight+"px"}};SP.UI.MicroFeed.SPMicroFeed.$3m=function(b,c,d){var a=document.createElement("button");a.id=c;a.setAttribute("type","button");a.className=d;SP.UI.MySiteCommon.CommonUIElements.setElementText(a,b);return a};SP.UI.MicroFeed.SPMicroFeed.$2a=function(e,f,g,d,h,i,j){var a=document.createElement("img");a.id=d+"_Image";a.src=e;a.alt=f;a.className=j;var b=document.createElement("span");b.id=d+"_Span";b.className=i;b.appendChild(a);var c=SP.UI.MicroFeed.SPMicroFeed.$3m("",d,h);c.title=g;c.appendChild(b);return c};SP.UI.MicroFeed.SPMicroFeed.$5g=function(j,a){var b=document.createElement("div");b.id=!a?SP.UI.MicroFeed.SPMicroFeed.$1p:SP.UI.MicroFeed.SPMicroFeed.$1Y+a;b.className=SP.UI.MicroFeed.SPMicroFeed.$7H;var g=document.createElement("div");g.id=!a?SP.UI.MicroFeed.SPMicroFeed.$7I:SP.UI.MicroFeed.SPMicroFeed.$6b+a;g.className=SP.UI.MicroFeed.SPMicroFeed.$51;var h=document.createElement("div");h.id=!a?SP.UI.MicroFeed.SPMicroFeed.$7E:SP.UI.MicroFeed.SPMicroFeed.$6a+a;h.className=SP.UI.MicroFeed.SPMicroFeed.$51;var c=SP.UI.MicroFeed.SPMicroFeed.$3n(!a?SP.UI.MicroFeed.SPMicroFeed.$1r:SP.UI.MicroFeed.SPMicroFeed.$1a+a,SP.UI.MicroFeed.SPMicroFeed.$52),d=SP.UI.MicroFeed.SPMicroFeed.$3n(!a?SP.UI.MicroFeed.SPMicroFeed.$3P:SP.UI.MicroFeed.SPMicroFeed.$2w+a,SP.UI.MicroFeed.SPMicroFeed.$52),i=SP.UI.MicroFeed.SPMicroFeed.$2a(SP.UI.MicroFeed.SPMicroFeed.get_$1H(),SpsClient.ScriptResources.cancelButtonText,SpsClient.ScriptResources.cancelButtonText,SP.UI.MicroFeed.SPMicroFeed.$3S+(!a?"":"_"+a),SP.UI.MicroFeed.SPMicroFeed.$d+" "+SP.UI.MicroFeed.SPMicroFeed.$5B,SP.UI.MicroFeed.SPMicroFeed.$3V,SP.UI.MicroFeed.SPMicroFeed.$3U),e=document.createElement("div");e.id=!a?SP.UI.MicroFeed.SPMicroFeed.$1q:SP.UI.MicroFeed.SPMicroFeed.$1Z+a;e.className="ms-error ms-microfeed-linkErrorMessageDiv";var f=SP.UI.MicroFeed.SPMicroFeed.$2a(SP.UI.MicroFeed.SPMicroFeed.get_$5K(),SpsClient.ScriptResources.saveLinkButtonText,SpsClient.ScriptResources.saveLinkButtonText,!a?SP.UI.MicroFeed.SPMicroFeed.$3O:SP.UI.MicroFeed.SPMicroFeed.$2v+a,SP.UI.MicroFeed.SPMicroFeed.$d+" "+SP.UI.MicroFeed.SPMicroFeed.$5B,"ms-microfeed-editLinkButtonImageParent","ms-microfeed-editLinkButtonImage");$addHandler(i,"click",function(){SP.UI.MicroFeed.SPMicroFeed.$9J(j,a)});$addHandler(f,"click",function(){SP.UI.MicroFeed.SPMicroFeed.$9d(j,c,d,a)});$addHandler(c,"focus",function(){SP.UI.MicroFeed.SPMicroFeed.$77(c,f,i)});$addHandler(d,"focus",function(){SP.UI.MicroFeed.SPMicroFeed.$77(d,f,i)});$addHandler(c,"blur",function(){SP.UI.MicroFeed.SPMicroFeed.$98(c,e,!a?j.id:a)});$addHandler(d,"blur",function(){SP.UI.MicroFeed.SPMicroFeed.$97(d,c,e)});$addHandler(c,"keydown",function(a){SP.UI.MicroFeed.SPMicroFeed.$78(a,f)});$addHandler(d,"keydown",function(a){SP.UI.MicroFeed.SPMicroFeed.$78(a,f)});SP.UI.MySiteCommon.CommonUIElements.setElementText(g,SpsClient.ScriptResources.linkUrlLabel);SP.UI.MySiteCommon.CommonUIElements.setElementText(h,SpsClient.ScriptResources.displayLinkAsLabel);b.appendChild(g);b.appendChild(c);b.appendChild(h);b.appendChild(d);b.appendChild(f);b.appendChild(i);b.appendChild(e);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,b);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,e);return b};SP.UI.MicroFeed.SPMicroFeed.$77=function(a,b,c){a&&a.select();SP.UI.MySiteCommon.CommonUIElements.display(b);SP.UI.MySiteCommon.CommonUIElements.display(c)};SP.UI.MicroFeed.SPMicroFeed.$98=function(a,e,f){var b=SP.UI.MicroFeed.SPMicroFeed.$N[f];if(!b||!a)return;var c=a.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$v);if(!c)return;var d=b.linkUrlFromDisplayText(c);if(SP.ScriptHelpers.isNullOrEmptyString(a.value)&&d){a.value=d;SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,e)}};SP.UI.MicroFeed.SPMicroFeed.$97=function(a,c,d){if(!c||!a)return;var b=c.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$v);if(SP.ScriptHelpers.isNullOrEmptyString(a.value)&&b){a.value=b;SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,d)}};SP.UI.MicroFeed.SPMicroFeed.$78=function(a,b){if(a.keyCode===13){b.click();a.preventDefault();a.stopPropagation()}};SP.UI.MicroFeed.SPMicroFeed.handleChangesToElementsDiv=function(a){var b=a.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$Y);if(!SP.UI.MicroFeed.SPMicroFeed.$H[b]&&a.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$1K)!=="true")SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,a);else SP.UI.MySiteCommon.CommonUIElements.display(a)};SP.UI.MicroFeed.SPMicroFeed.$6m=function(a){var b;b=SP.UI.MicroFeed.SPMicroFeed.$H[a?a:""];if(b){var c=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$2R:SP.UI.MicroFeed.SPMicroFeed.$2B+a),d;if(!b.get_attachmentKind())d=!a?SP.UI.MicroFeed.SPMicroFeed.$3N:SP.UI.MicroFeed.SPMicroFeed.$2u+a;else d=!a?SP.UI.MicroFeed.SPMicroFeed.$2N:SP.UI.MicroFeed.SPMicroFeed.$2C+a;if(c){SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,c);var e=$get(d);e&&c.removeChild(e)}}return b};SP.UI.MicroFeed.SPMicroFeed.$8L=function(c,d){var b=document.createElement("div");b.id=!d?SP.UI.MicroFeed.SPMicroFeed.$3N:SP.UI.MicroFeed.SPMicroFeed.$2u+d;var a=document.createElement("img");a.className="ms-microfeed-imageAttachmentPreview";a.src=c.get_previewUri();a.alt=c.get_name();b.appendChild(a);return b};SP.UI.MicroFeed.SPMicroFeed.$1w=function(d,b){var e=SP.UI.MicroFeed.SPMicroFeed.$N[!b?d.id:b],c=$get(!b?SP.UI.MicroFeed.SPMicroFeed.$1r:SP.UI.MicroFeed.SPMicroFeed.$1a+b);if(!e||!c)return;var a=e.get_linkToEdit();if(a&&a.startsWith("<")&&a.endsWith(">")&&c.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$v)!==a)SP.UI.MicroFeed.SPMicroFeed.$8W(d,b,a.substring(1,a.length-1));else!a&&c.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$v)&&SP.UI.MicroFeed.SPMicroFeed.$6x(d,b,-1)};SP.UI.MicroFeed.SPMicroFeed.$8W=function(k,a,c){var b=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$1p:SP.UI.MicroFeed.SPMicroFeed.$1Y+a),d=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$1r:SP.UI.MicroFeed.SPMicroFeed.$1a+a),f=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$3P:SP.UI.MicroFeed.SPMicroFeed.$2w+a),g=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$3O:SP.UI.MicroFeed.SPMicroFeed.$2v+a),e=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$1q:SP.UI.MicroFeed.SPMicroFeed.$1Z+a),i=$get(SP.UI.MicroFeed.SPMicroFeed.$3S+(!a?"":"_"+a)),h=SP.UI.MicroFeed.SPMicroFeed.$N[SP.UI.MicroFeed.SPMicroFeed.getPostIDFromDOMElementID(k.id)];if(!b||!b.parentNode||!d||!f||!g||!c)return;if(e){e.innerHTML="";SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,e)}SP.UI.MySiteCommon.CommonUIElements.display(b);b.parentNode.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$1K,"true");SP.UI.MicroFeed.SPMicroFeed.handleChangesToElementsDiv(b.parentNode);if(!h)return;var j=h.linkUrlFromDisplayText(c);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(true,g);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(true,i);d.value=j;f.value=c;d.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$v,c)};SP.UI.MicroFeed.SPMicroFeed.$9J=function(i,a){var e=SP.UI.MicroFeed.SPMicroFeed.$N[!a?i.id:a],b=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$1r:SP.UI.MicroFeed.SPMicroFeed.$1a+a),f=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$3P:SP.UI.MicroFeed.SPMicroFeed.$2w+a),c=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$1q:SP.UI.MicroFeed.SPMicroFeed.$1Z+a),g=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$3O:SP.UI.MicroFeed.SPMicroFeed.$2v+a),h=$get(SP.UI.MicroFeed.SPMicroFeed.$3S+(!a?"":"_"+a));if(!e||!b||!f)return;var d=b.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$v);if(!d)return;b.value=e.linkUrlFromDisplayText(d);f.value=d;if(c){c.innerHTML="";SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,c)}SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(true,g);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(true,h)};SP.UI.MicroFeed.SPMicroFeed.$6x=function(c,a,e){var b=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$1p:SP.UI.MicroFeed.SPMicroFeed.$1Y+a),f=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$1r:SP.UI.MicroFeed.SPMicroFeed.$1a+a),d=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$1q:SP.UI.MicroFeed.SPMicroFeed.$1Z+a);if(!b||!b.parentNode)return;if(d){d.innerHTML="";SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,d)}SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,b);f&&f.removeAttribute(SP.UI.MicroFeed.SPMicroFeed.$v);b.parentNode.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$1K,"false");SP.UI.MicroFeed.SPMicroFeed.handleChangesToElementsDiv(b.parentNode);if(e>=0&&e<=c.value.length){c.blur();SP.UI.MySiteCommon.CommonUIElements.setCursorPosition(c,e)}c.focus()};SP.UI.MicroFeed.SPMicroFeed.$9d=function(h,i,j,f){var d=SP.UI.MicroFeed.SPMicroFeed.$N[!f?h.id:f],b=$get(!f?SP.UI.MicroFeed.SPMicroFeed.$1q:SP.UI.MicroFeed.SPMicroFeed.$1Z+f);if(!i||!j||!d||!b)return;var c=i.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$v);if(!c)return;var k=d.linkUrlFromDisplayText(c);b.innerHTML="";var a=j.value,e=i.value||"",g=e.toLowerCase()||"";if(SP.ScriptHelpers.isNullOrEmptyString(a)){if(c)j.value=e;a=e}if(a!==c&&d.hasLinkWithDisplayText(a)){if(b){SP.UI.MySiteCommon.CommonUIElements.setElementText(b,SpsClient.ScriptResources.duplicateLinkErrorMessage);SP.UI.MySiteCommon.CommonUIElements.display(b)}return}if(!g.startsWith("www.")&&!g.startsWith("http://")&&!g.startsWith("https://")){if(b){SP.UI.MySiteCommon.CommonUIElements.setElementText(b,SpsClient.ScriptResources.invalidLinkErrorMessage);SP.UI.MySiteCommon.CommonUIElements.display(b)}return}if(c===a&&c===d.getLinkWithDisplayText(c))a=e;d.updateLinkSelection(c,a,e);SP.UI.MicroFeed.SPMicroFeed.$6x(h,f,h.value.indexOf("<"+a+">")+a.length+2)};SP.UI.MicroFeed.SPMicroFeed.$81=function(b,a){if(SP.UI.MicroFeed.SPMicroFeed.$1R)return;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){var c=SP.UI.MicroFeed.SPMicroFeed.get_$D().getPreview(b);SP.UI.MicroFeed.SPMicroFeed.$1R=true;SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){if(SP.UI.MicroFeed.SPMicroFeed.$1R){SP.UI.MicroFeed.SPMicroFeed.$1R=false;if(c&&c.get_uri()){var f=!a;if(SP.UI.MicroFeed.SPMicroFeed.$H[a||""])return;var b=$get(f?SP.UI.MicroFeed.SPMicroFeed.$2R:SP.UI.MicroFeed.SPMicroFeed.$2B+a),g=$get(f?SP.UI.MicroFeed.SPMicroFeed.$V:SP.UI.MicroFeed.SPMicroFeed.$y+a),d=null;switch(c.get_attachmentKind()){case 1:d=SP.UI.MicroFeed.MicroFeedVideo.$5n(c,a);break;case 2:d=SP.UI.MicroFeed.MicroFeedDoc.$5j(c,a)}if(d){SP.UI.MicroFeed.SPMicroFeed.$1z(d,b,null,true);SP.UI.MySiteCommon.CommonUIElements.display(b)}var e=a?a:"";SP.UI.MicroFeed.SPMicroFeed.$H[e]=c;g.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$Y,e);b.parentNode.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$Y,e);SP.UI.MicroFeed.SPMicroFeed.handleChangesToElementsDiv(b.parentNode)}}},function(){SP.UI.MicroFeed.SPMicroFeed.$1R=false})})};SP.UI.MicroFeed.SPMicroFeed.$7q=function(b,d,e){var c=e?$get(SP.UI.MicroFeed.SPMicroFeed.$V):$get(SP.UI.MicroFeed.SPMicroFeed.$y+d),a=SP.UI.MicroFeed.SPMicroFeed.$N[d];if(b.keyCode===13&&!b.shiftKey&&c&&!c.disabled&&(!a||!a.get_isSuggestionMenuOpen()&&!a.get_isHandlingLinkEntry())){c.focus();c.click();b.preventDefault();b.stopPropagation()}a&&a.typeAheadKeyDownHandler(b)};SP.UI.MicroFeed.SPMicroFeed.createProgressDiv=function(){var a=document.createElement("div");a.id=SP.UI.MicroFeed.SPMicroFeed.$2s;a.className=SP.UI.MicroFeed.SPMicroFeed.$6U;a.appendChild(SP.UI.MySiteCommon.CommonUIElements.createProcessingIcon(SP.UI.MicroFeed.SPMicroFeed.$6W,SP.UI.MicroFeed.SPMicroFeed.$6V));return a};SP.UI.MicroFeed.SPMicroFeed.$4d=function(a,b){return b>0?String.format(SpsClient.ScriptResources.pivotControlViewTitleText,a,b):a};SP.UI.MicroFeed.SPMicroFeed.showProgressSpinner=function(){var a=$get(SP.UI.MicroFeed.SPMicroFeed.$2s);a&&SP.UI.MySiteCommon.CommonUIElements.display(a)};SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner=function(){var a=$get(SP.UI.MicroFeed.SPMicroFeed.$2s);a&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(true,a)};SP.UI.MicroFeed.SPMicroFeed.drawEmptyFeedThreadWithGivenMessage=function(b,c){var a=document.createElement("div");a.id=SP.UI.MicroFeed.SPMicroFeed.$27;a.className=SP.UI.MicroFeed.SPMicroFeed.$6A;if(!SP.ScriptHelpers.isNullOrEmptyString(c)){a.innerHTML=b+"<br/><br/>";SP.UI.MySiteCommon.CommonUIElements.addTechnicalDetailsDiv(a,c,"_emptyfeed",null)}else a.innerHTML=b;return a};SP.UI.MicroFeed.SPMicroFeed.drawMinimalThread=function(c){SP.SOD.executeFunc("SP.DateTimeUtil.js","SP.DateTimeUtil.SPRelativeDateTime.getRelativeDateTimeString",null);var a=SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost(c,c.get_rootPost()),d=a.$3_0,b=SP.UI.MicroFeed.SPMicroFeed.createThreadDivWithoutHiding(null,d);b.appendChild(SP.UI.MicroFeed.SPMicroFeed.$8c(a,d,a.$3_0));b.appendChild(SP.UI.MicroFeed.SPMicroFeed.createClearFloatsDiv());return b};SP.UI.MicroFeed.SPMicroFeed.$8U=function(b){var a=0;if(b.get_attributes()&8)a=0;else if(b.get_attributes()&2)a=1;else if(b.get_attributes()&16)a=2;return a};SP.UI.MicroFeed.SPMicroFeed.$1e=function(a){return!a||!a.$b_0&&!a.$I_0};SP.UI.MicroFeed.SPMicroFeed.$1d=function(a){return a.get_actorType()===1||a.get_actorType()===2};SP.UI.MicroFeed.SPMicroFeed.$7r=function(b){var a=$get(SP.UI.MicroFeed.SPMicroFeed.$z+b),e=$get(SP.UI.MicroFeed.SPMicroFeed.$4Y+b),c=null,d=null;if(!a||!e)return;if(a.getAttribute("expanded")){if(a){SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,a);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,$get(SP.UI.MicroFeed.SPMicroFeed.$1I+b));a.removeAttribute("expanded")}c=$get(SP.UI.MicroFeed.SPMicroFeed.$33+b);if(c)c.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.expandRepliesText);d=$get(SP.UI.MicroFeed.SPMicroFeed.$32+b);if(d)d.className=SP.UI.MicroFeed.SPMicroFeed.$2p}else{if(a){SP.UI.MySiteCommon.CommonUIElements.display(a);SP.UI.MySiteCommon.CommonUIElements.display($get(SP.UI.MicroFeed.SPMicroFeed.$1I+b));a.setAttribute("expanded","true")}c=$get(SP.UI.MicroFeed.SPMicroFeed.$33+b);if(c)c.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.collapseRepliesText);d=$get(SP.UI.MicroFeed.SPMicroFeed.$32+b);if(d)d.className=SP.UI.MicroFeed.SPMicroFeed.$4A}};SP.UI.MicroFeed.SPMicroFeed.$8j=function(a){var b=$get(SP.UI.MicroFeed.SPMicroFeed.$z+a),c=$get(SP.UI.MicroFeed.SPMicroFeed.$2D+a);b&&!b.getAttribute("expanded")&&c&&!SP.UI.MySiteCommon.CommonUIElements.isEntirelyHidden(c)&&SP.UI.MicroFeed.SPMicroFeed.$7r(a)};SP.UI.MicroFeed.SPMicroFeed.$7w=function(b){var c=document.createElement("div");c.id=SP.UI.MicroFeed.SPMicroFeed.$2D+b;var a=document.createElement("button");a.id=SP.UI.MicroFeed.SPMicroFeed.$4Y+b;var d=document.createElement("span");d.id=SP.UI.MicroFeed.SPMicroFeed.$33+b;var e=document.createElement("span");e.id=SP.UI.MicroFeed.SPMicroFeed.$6k+b;var f=document.createElement("img");f.id=SP.UI.MicroFeed.SPMicroFeed.$32+b;c.className=SP.UI.MicroFeed.SPMicroFeed.$2A+" "+SP.UI.MicroFeed.SPMicroFeed.$4E;a.setAttribute("type","button");a.className=SP.UI.MicroFeed.SPMicroFeed.$d+" "+SP.UI.MicroFeed.SPMicroFeed.$4D;e.className=SP.UI.MicroFeed.SPMicroFeed.$4F;a.appendChild(e);f.setAttribute("src",SP.UI.MicroFeed.SPMicroFeed.get_$1H());f.className=SP.UI.MicroFeed.SPMicroFeed.$4A;e.appendChild(f);d.className="ms-microfeed-toggleRepliesText";d.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.collapseRepliesText);$addHandler(a,"click",function(){SP.UI.MicroFeed.SPMicroFeed.$7r(b)});a.appendChild(d);c.appendChild(a);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,c);return c};SP.UI.MicroFeed.SPMicroFeed.$5O=function(a,b,c){b=Math.max(b,0);a.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$t,b);if(!b){a.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$2e,"false");a.setAttribute(SP.Microfeed.MicroBlogType.toString(8),"false")}else c&&a.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$2e,"true")};SP.UI.MicroFeed.SPMicroFeed.$4i=function(a){return!!a.get_likerInfo()&&a.get_likerInfo().get_includesCurrentUser()};SP.UI.MicroFeed.SPMicroFeed.createThreadDivWithoutHiding=function(b,c){var a=document.createElement("div");a.id=SP.UI.MicroFeed.SPMicroFeed.$10+c;a.className=SP.UI.MicroFeed.SPMicroFeed.$6f;a.setAttribute("LastModificationTime",b?""+b.get_rootPost().get_modifiedTime():"");if(SP.UI.MicroFeed.SPMicroFeed.$H&&(c||"")in SP.UI.MicroFeed.SPMicroFeed.$H)delete SP.UI.MicroFeed.SPMicroFeed.$H[c||""];b&&a.setAttribute(SP.Social.SocialThreadType.toString(b.get_threadType()),"true");return a};SP.UI.MicroFeed.SPMicroFeed.$5v=function(d){SP.UI.MicroFeed.SPMicroFeed.$5L(d);var b=null,e=null,c=0,f=0,a=null,g=null,h="";b=$get(SP.UI.MicroFeed.SPMicroFeed.$z+d);if(!b)return;e=b.childNodes;f=e.length;c=f-1;while(c>=0){a=e[c];if(a.getAttribute("deleted")!=="true"){if(SP.UI.MySiteCommon.CommonUIElements.isEntirelyHidden(a)){b.removeChild(a);SP.UI.MySiteCommon.CommonUIElements.display(a);SP.UI.MicroFeed.SPMicroFeed.$1z(a,b,null,false);c+=2}h=a.id.substr(a.id.indexOf("_")+1);g=$get(SP.UI.MicroFeed.SPMicroFeed.$3x+h);g&&SP.UI.MySiteCommon.CommonUIElements.display(g)}c--}b.setAttribute("expanded","true");SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,$get(SP.UI.MicroFeed.SPMicroFeed.$4B+d));f>2&&SP.UI.MySiteCommon.CommonUIElements.display($get(SP.UI.MicroFeed.SPMicroFeed.$2D+d));SP.UI.MicroFeed.SPMicroFeed.$5M(d)};SP.UI.MicroFeed.SPMicroFeed.$5e=function(f,c,a,p){var b="",e="ms-microfeed-userThumbnailArea",g="";if(!p)e+=" ms-hide";if(a){var l=36,m=48,h=l;if(c&&!c.$n_0)h=m;if(c&&!c.$p_0&&!SP.ScriptHelpers.isNullOrEmptyString(c.$1B_0)){e+=" ms-microfeed-contentThumbnailArea";b=c.$1B_0}else{var d=a.get_imageUri();if(!c||c.$p_0)if(!SP.ScriptHelpers.isNullOrEmptyString(d))if(!_spPageContextInfo.crossDomainPhotosEnabled||d.startsWith("/")||SP.UI.MicroFeed.SPMicroFeed.$94(d))b=d;else{b="/_layouts/15/userphoto.aspx?size=S&url="+encodeURIComponent(d);if(!SP.ScriptHelpers.isNullOrEmptyString(a.get_accountName()))b+="&accountname="+encodeURIComponent(a.get_accountName());try{var n=SP.ScriptHelpers.getUrlQueryPairs(d),j=n.t;if(!SP.ScriptHelpers.isNullOrEmptyString(j))b+="&t="+j}catch(q){}}else b=SP.UI.MicroFeed.SPMicroFeed.$7a;else if(SP.UI.MicroFeed.SPMicroFeed.$1d(a))b=d;else b=SP.UI.MicroFeed.SPMicroFeed.$70}if(c&&c.$n_0===2)g=SP.UI.MySiteCommon.CommonUIElements.createSafeImageHTML(SP.UI.MicroFeed.SPMicroFeed.$40+f,"ms-microfeed-iconImage",b,"");else if(SP.UI.MySiteCommon.PresenceManager.isPresenceJSLoaded()&&!a.get_actorType())return SP.UI.MicroFeed.SPMicroFeed.$8p("div",SP.UI.MicroFeed.SPMicroFeed.$25+f,e,a.get_accountName(),a.get_name(),b,a.get_uri(),a.get_emailAddress(),h);else{var k=h.toString()+"px",o=SP.UI.MicroFeed.SPMicroFeed.$40+f,i='style="height:'+k+";width:"+k+'"';if(!a.get_actorType()){i+=' name="authorElement" profileUri="'+a.get_uri()+'" accountName="'+STSHtmlEncode(a.get_accountName())+'" displayName="'+STSHtmlEncode(a.get_name())+'"';if(a.get_emailAddress())i+=' email="'+STSHtmlEncode(a.get_emailAddress())+'"';b=b.replace("_MThumb","_SThumb")}g=SP.UI.MySiteCommon.CommonUIElements.createSafeImageHTML(o,"",b,i)}}return SP.UI.MySiteCommon.CommonUIElements.createOpenHTMLTag("div",SP.UI.MicroFeed.SPMicroFeed.$25+f,e)+g+"</div>"};SP.UI.MicroFeed.SPMicroFeed.$94=function(a){if(!SP.UI.MicroFeed.SPMicroFeed.$e){SP.UI.MicroFeed.SPMicroFeed.$e=window.location.href;if(SP.UI.MicroFeed.SPMicroFeed.$e.lastIndexOf("/")>SP.UI.MicroFeed.SPMicroFeed.$e.indexOf("//")+1)SP.UI.MicroFeed.SPMicroFeed.$e=SP.UI.MicroFeed.SPMicroFeed.$e.substring(0,SP.UI.MicroFeed.SPMicroFeed.$e.indexOf("/",SP.UI.MicroFeed.SPMicroFeed.$e.indexOf("//")+2))}return a.toLowerCase().startsWith(SP.UI.MicroFeed.SPMicroFeed.$e.toLowerCase())};SP.UI.MicroFeed.SPMicroFeed.$8a=function(a,c,d,e,f,g,b){SP.UI.MySiteCommon.PresenceManager.drawLyncUserImage(a,c,d,e,f,g,null,b!==48,true);a.className+=" "+(b===48?SP.UI.MicroFeed.SPMicroFeed.$4V:SP.UI.MicroFeed.SPMicroFeed.$4P)};SP.UI.MicroFeed.SPMicroFeed.$8p=function(a,c,d,e,f,g,h,i,b){return SP.UI.MySiteCommon.CommonUIElements.createOpenHTMLTag(a,c,d+" "+(b===48?SP.UI.MicroFeed.SPMicroFeed.$4V:SP.UI.MicroFeed.SPMicroFeed.$4P))+SP.UI.MySiteCommon.PresenceManager.getUserImageInnerHTML(e,f,g,h,i,null,b!==48,true)+"</"+a+">"};SP.UI.MicroFeed.SPMicroFeed.$9b=function(a){window.setTimeout(function(){SP.UI.MySiteCommon.PresenceManager.ensurePresenceJSLoaded(function(){var b=document.getElementsByName("authorElement");while(b.length>0){var a=b[0];if(a&&a.parentNode){var c=STSHtmlDecode(a.getAttribute("accountName")),d=STSHtmlDecode(a.getAttribute("displayName")),e=a.getAttribute("src"),f=a.getAttribute("profileUri"),g=STSHtmlDecode(a.getAttribute("email")),h=a.clientHeight;SP.UI.MicroFeed.SPMicroFeed.$8a(a.parentNode,c,d,e,f,g,h)}}ProcessImn()})},a)};SP.UI.MicroFeed.SPMicroFeed.$8c=function(a,d,e){var b=document.createElement("div"),c=null;a.$2J_0=false;a.$F_0=true;a.$9_0=d;a.$4_0=e;c=SP.UI.MicroFeed.SPMicroFeed.$71(a);b.id=SP.UI.MicroFeed.SPMicroFeed.$1b+d;b.className=SP.UI.MicroFeed.SPMicroFeed.$30;!SP.UI.MicroFeed.SPMicroFeed.$1e(a)&&c.appendChild(SP.UI.MicroFeed.SPMicroFeed.$8M(a,e,true));b.appendChild(c);return b};SP.UI.MicroFeed.SPMicroFeed.$71=function(a){var b=document.createElement("div");b.id=SP.UI.MicroFeed.SPMicroFeed.$29+a.$4_0;b.setAttribute("threadDivID",a.$9_0);var c=document.createElement("input");c.name=a.$3_0;c.type="hidden";b.appendChild(c);a.$F_0&&b.setAttribute("isRoot","true");b.className=SP.UI.MicroFeed.SPMicroFeed.$4J+(a.$1_0===4||a.$1_0===2||a.$1_0===7||a.$1_0===8?" ms-microfeed-replyMessage":"");a.$2J_0&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,b);return b};SP.UI.MicroFeed.SPMicroFeed.$1L=function(a){return!SP.UI.MicroFeed.SPMicroFeed.get_$X()||SP.UI.MicroFeed.SPMicroFeed.$2f(a.$A_0,SP.UI.MicroFeed.SPMicroFeed.get_$X())};SP.UI.MicroFeed.SPMicroFeed.$2f=function(a,b){return!a||!b||a.get_actorType()!==b.get_actorType()?false:!a.get_actorType()?a.get_accountName().toLowerCase()===b.get_accountName().toLowerCase():a.get_id()===b.get_id()};SP.UI.MicroFeed.SPMicroFeed.$8I=function(a){var b=document.createElement("div");b.id=SP.UI.MicroFeed.SPMicroFeed.$6Y+a.$4_0;b.className=SP.UI.MicroFeed.SPMicroFeed.$6X;var c=document.createElement("div");c.id=SP.UI.MicroFeed.SPMicroFeed.$64+a.$4_0;c.className="ms-microfeed-activityImageDiv";c.innerHTML=SP.UI.MySiteCommon.CommonUIElements.createSafeImageHTML("ms-microfeed-activityImage_"+a.$4_0,"ms-microfeed-activityImage",a.$6_0.$1B_0,"");if(a&&SP.UI.MicroFeed.SPMicroFeed.$1e(a)||SP.UI.MicroFeed.SPMicroFeed.$1e(a.$6_0)||a.$6_0.$b_0==="")b.className="ms-metadata";b.appendChild(c);b.innerHTML=b.innerHTML+a.$6_0.$b_0;return b};SP.UI.MicroFeed.SPMicroFeed.$5k=function(b,c,d){var a=document.createElement("div");a.id=SP.UI.MicroFeed.SPMicroFeed.$3M+c;a.className=SP.UI.MicroFeed.SPMicroFeed.$3L;a.innerHTML=SP.UI.MySiteCommon.CommonUIElements.createSafeImageHTML(SP.UI.MicroFeed.SPMicroFeed.$1o+c,d,b.get_previewUri()||b.get_uri(),'alt="'+b.get_name()+'"');return a};SP.UI.MicroFeed.SPMicroFeed.$8M=function(a,b,j){var i=11,h=document.createElement("div"),c=document.createElement("div"),d=null,e=null,f=document.createElement("a");h.id=SP.UI.MicroFeed.SPMicroFeed.$4K+b;c.id=SP.UI.MicroFeed.SPMicroFeed.$2n+b;c.className=SP.UI.MicroFeed.SPMicroFeed.$6H;f.id="ms-viewthreadlink_"+b;c.appendChild(SP.UI.MicroFeed.SPMicroFeed.$5p(a,b,"",j,i,false));if(a.$I_0){var g=null;switch(a.$I_0.get_attachmentKind()){case 0:g=SP.UI.MicroFeed.SPMicroFeed.$5k(a.$I_0,b,"ms-microfeed-smallAttachmentImage");break;case 1:g=SP.UI.MicroFeed.MicroFeedVideo.$5l(a.$I_0,b);break;case 2:g=SP.UI.MicroFeed.MicroFeedDoc.$5h(a.$I_0,b)}g&&c.appendChild(g)}d=SP.UI.MicroFeed.SPMicroFeed.$5V(a,i,b,false);if(a.$19_0>0){SP.UI.MicroFeed.SPMicroFeed.$g(d);e=document.createElement("span");e.id="ms-replycount_"+b;e.className="ms-microfeed-replyCountText ms-textSmall";SP.UI.MySiteCommon.CommonUIElements.setElementText(e,String.format(SP.Utilities.LocUtility.getLocalizedCountValue(SpsClient.ScriptResources.numRepliesText,SpsClient.ScriptResources.numRepliesTextIntervals,a.$19_0),a.$19_0));d.appendChild(e)}SP.UI.MicroFeed.SPMicroFeed.$g(d);if(!SP.ScriptHelpers.isNullOrEmptyString(a.$O_0)){f.className="ms-microfeed-viewThreadLink "+SP.UI.MicroFeed.SPMicroFeed.$5A;f.href=a.$O_0;SP.UI.MySiteCommon.CommonUIElements.setElementText(f,SpsClient.ScriptResources.viewFullThreadLinkText);d.appendChild(f)}c.appendChild(d);h.appendChild(c);return h};SP.UI.MicroFeed.SPMicroFeed.$8P=function(a,c,d){var b="";if(!a.$p_0)return b;b=SP.UI.MicroFeed.SPMicroFeed.$5r("ms-authorlabel_"+c,a.$A_0.get_uri(),a.$A_0.get_name(),!a.$o_0);if(a.$B_0&&(!a.$o_0||a.$6_0&&a.$6_0.$1_0===10)&&!d&&SP.UI.MicroFeed.SPMicroFeed.$1d(a.$B_0)&&!SP.ScriptHelpers.isNullOrEmptyString(a.$B_0.get_name()))b=String.format(SpsClient.ScriptResources.postTitleFormatString,b,SP.UI.MicroFeed.SPMicroFeed.$5r("ms-targetlabel_"+c,a.$B_0.get_uri(),a.$B_0.get_name(),!a.$o_0));return b};SP.UI.MicroFeed.SPMicroFeed.$5r=function(a,b,c,d){return SP.UI.MySiteCommon.CommonUIElements.createSafeAnchorHTML(a,c,d?"ms-microfeed-userName ms-textLarge ms-subtleLink":"ms-microfeed-userName ms-textSmall ms-bold ms-subtleLink",b,"",true)};SP.UI.MicroFeed.SPMicroFeed.$5p=function(e,c,f,g,h,i){var b=document.createElement("div");b.id=SP.UI.MicroFeed.SPMicroFeed.$69+c;var d=e.$b_0,a="";b.className=SP.UI.MicroFeed.SPMicroFeed.$68+(!SP.ScriptHelpers.isNullOrEmptyString(f)?" "+f:"");if(h!==11){a=SP.UI.MicroFeed.SPMicroFeed.$8P(e,c,i);if(a!=="")if(g)a+="<br/>";else a+="&nbsp; "}if(!SP.ScriptHelpers.isNullOrEmptyString(d))a+=SP.UI.MySiteCommon.CommonUIElements.createOpenHTMLTag("span",SP.UI.MicroFeed.SPMicroFeed.$6R+c,SP.UI.MicroFeed.SPMicroFeed.$6Q)+d.replace(new RegExp("\x0d?\x0a","g"),"<br/>")+"</span>";b.innerHTML=a;return b};SP.UI.MicroFeed.SPMicroFeed.$5T=function(b,a){if(a.$1f_0){b.addRootPostDropDownItem(SpsClient.ScriptResources.followUpDropDownText,function(){var c=document.createElement("span");c.innerHTML=a.$b_0;var b=SP.UI.UIUtility.getInnerText(c),d=255-String.format(SpsClient.ScriptResources.moreContentEllipsesNoSpace,"").length,e=b.length>255?String.format(SpsClient.ScriptResources.moreContentEllipsesNoSpace,b.substr(0,d)):b,f=String.format(SpsClient.ScriptResources.followUpTaskDescription,a.$A_0.get_name(),b);SP.UI.MicroFeed.SPMicroFeed.$8S(a,e,f)});return true}return false};SP.UI.MicroFeed.SPMicroFeed.$8S=function(a,b,c){SP.SOD.executeFunc("SP.WorkManagement.js","SP.WorkManagement.OM.TaskWriteResult",function(){SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){!SP.UI.MicroFeed.SPMicroFeed.$1Q&&SP.UI.MicroFeed.SPMicroFeed.initializeCSOMData(false);var e=new SP.WorkManagement.OM.SortableSessionManager(SP.UI.MicroFeed.SPMicroFeed.$L),f=e.createSession(),g=!a.$O_0?"":a.$O_0,d=f.createTask(b,c,"","",false,true,-1,g);SP.UI.MicroFeed.SPMicroFeed.$L.load(d);SP.UI.MicroFeed.SPMicroFeed.$L.load(d.get_result());SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){var a={txt:"",dt:"",img:null};if(d.get_error()||!d.get_result()){var b=new SP.UI.Notify.Notification(1,SpsClient.ScriptResources.followUpTaskCreatingFailed,false,"",null,a);b.Show(false)}else{a.txt=SpsClient.ScriptResources.followUpTaskCreatedNotificationSubText;var c=new SP.UI.Notify.Notification(1,SpsClient.ScriptResources.followUpTaskCreatedNotification,false,"",function(){window.location.href=SP.Utilities.Utility.getLayoutsPageUrl("MySite.aspx?MySiteRedirect=AllTasks")},a);c.Show(false)}},function(){var a={txt:"",dt:"",img:null},b=new SP.UI.Notify.Notification(1,SpsClient.ScriptResources.followUpTaskCreatingFailed,false,"",null,a);b.Show(false)})})})};SP.UI.MicroFeed.SPMicroFeed.$8T=function(a){switch(a.get_actorType()){case 2:return SpsClient.ScriptResources.hideSiteRootDropDownText;case 1:return SpsClient.ScriptResources.hideDocumentRootDropDownText;case 0:return SpsClient.ScriptResources.stopFollowingRootDropDownText;default:return String.format(SpsClient.ScriptResources.stopFollowingObjectDropDownText,a.get_name())}};SP.UI.MicroFeed.SPMicroFeed.$5S=function(g,d,i){var e=0,c=[];if(d&&d.length>0)for(var h={},f=0;f<d.length;f++){var a=d[f];if(a.get_canFollow()){var b=a.get_id();if((!b||!b.length)&&a.get_accountName())b=a.get_accountName();if(b&&!(b in h)&&SP.UI.MicroFeed.SPMicroFeed.$3Y){if(SP.UI.MicroFeed.SPMicroFeed.$7z(g,a,i)){e++;c[c.length]=a}h[b]=true}}}e>0&&g.setOpenedCallback(function(){for(var a=0;a<c.length;a++)SP.UI.MicroFeed.SPMicroFeed.$8H(g,c[a])});return e};SP.UI.MicroFeed.SPMicroFeed.$8H=function(e,a){var b=!a.get_actorType()?SP.UI.People.PersonManager.getFollowState(a.get_accountName()):SP.UI.MicroFeed.SocialActorCache.isFollowedByMe(a.get_id()),c=String.format(SP.UI.MicroFeed.SPMicroFeed.$2E(a.get_actorType(),b),a.get_name()),d=String.format(SP.UI.MicroFeed.SPMicroFeed.$2E(a.get_actorType(),!b),a.get_name());e.updateMySiteMenuItemByName(c,d,function(){SP.UI.MicroFeed.SPMicroFeed.$2q(a,!b)})};SP.UI.MicroFeed.SPMicroFeed.$2E=function(b,a){return!b?a?SpsClient.ScriptResources.followLinkTextWithName:SpsClient.ScriptResources.stopFollowingLinkTextWithName:a?SpsClient.ScriptResources.followObjectDropDownText:SpsClient.ScriptResources.stopFollowingObjectDropDownText};SP.UI.MicroFeed.SPMicroFeed.$7z=function(d,a,e){if(!a||SP.UI.MicroFeed.SPMicroFeed.$2f(a,SP.UI.MicroFeed.SPMicroFeed.get_$X())||SP.UI.MicroFeed.SPMicroFeed.$2f(a,e))return false;var b=!a.get_actorType()?SP.UI.People.PersonManager.getFollowState(a.get_accountName()):SP.UI.MicroFeed.SocialActorCache.isFollowedByMe(a.get_id());if(b)return false;var c=String.format(SP.UI.MicroFeed.SPMicroFeed.$2E(a.get_actorType(),true),a.get_name());d.addRootPostDropDownItem(c,function(){SP.UI.MicroFeed.SPMicroFeed.$2q(a,true)});return true};SP.UI.MicroFeed.SPMicroFeed.$8Q=function(b){var a=document.createElement("a");a.id="ms-postLink_"+b;a.setAttribute("name","fullyOrphaned");a.className="ms-microfeed-activityPostLink "+SP.UI.MicroFeed.SPMicroFeed.$28;SP.UI.MySiteCommon.CommonUIElements.setElementText(a,SpsClient.ScriptResources.viewFullThreadText);a.setAttribute("href","#");a.setAttribute("onclick","return false;");return a};SP.UI.MicroFeed.SPMicroFeed.$3n=function(b,c){var a=document.createElement("input");a.id=b;a.className=c;a.type="text";return a};SP.UI.MicroFeed.SPMicroFeed.$9U=function(e,c,d){var a=$get("ms-threadLink_"+c),b=null;if(a){SP.UI.MySiteCommon.CommonUIElements.display(a);b=$get("ms-threadLinkInput_"+c);if(b){b.focus();b.select()}}else{a=document.createElement("div");a.id="ms-threadLink_"+c;a.className="ms-microfeed-threadLinkDiv ms-textSmall";a.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.threadLinkDescriptorText);b=SP.UI.MicroFeed.SPMicroFeed.$3n("ms-threadLinkInput_"+c,"ms-microfeed-threadLinkInputBox");b.setAttribute("readonly","readonly");$addHandler(b,"blur",function(){SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,a)});a.appendChild(b);d.insertBefore(a,d.firstChild);SP.UI.MicroFeed.SPMicroFeed.$9M(b,e)}};SP.UI.MicroFeed.SPMicroFeed.$9M=function(a,b){a.focus();a.value=b&&b.$O_0?b.$O_0:"";a.select()};SP.UI.MicroFeed.SPMicroFeed.$2g=function(e,o,s,p,q,t,r,u){var f=$get(SP.UI.MicroFeed.SPMicroFeed.$29+e),j=$get(SP.UI.MicroFeed.SPMicroFeed.$3y+e),b=document.createElement("div"),c=document.createElement("div"),k=document.createElement("div"),d=document.createElement("button"),g=document.createElement("button"),a=null,h=0,n=6,m=0,l=0,i=null;j&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(true,j);f&&$clearHandlers(f);d.id="ms-confConfirmButton_"+e;g.id="ms-confCancelButton_"+e;b.id="ms-confDiv_"+e;c.id="ms-confMessageDiv_"+e;b.className="ms-microfeed-confirmationDiv ms-shadow";c.className="ms-microfeed-confMessageDiv";d.className="ms-microfeed-confirmationDivButton ms-button-emphasize";g.className="ms-microfeed-confirmationDivButton ms-microfeed-cancelButton";k.className="ms-microfeed-confirmationButtonDiv";if(!SP.ScriptHelpers.isNullOrEmptyString(q)){c.innerHTML=STSHtmlEncode(p)+"<br/><br/>";SP.UI.MySiteCommon.CommonUIElements.addTechnicalDetailsDiv(c,q,"_"+e,null)}else SP.UI.MySiteCommon.CommonUIElements.setElementText(c,p);SP.UI.MySiteCommon.CommonUIElements.setElementText(d,t);if(!SP.ScriptHelpers.isNullOrEmptyString(r))d.title=r;SP.UI.MySiteCommon.CommonUIElements.setElementText(g,SpsClient.ScriptResources.cancelConfirmationDialogButtonText);k.appendChild(d);k.appendChild(g);c.appendChild(k);if(s){if(!SP.UI.MicroFeed.SPMicroFeed.$6o($get(SP.UI.MicroFeed.SPMicroFeed.$z+o)))h=6;else h=31;b.className=b.className+" ms-microfeed-rootConfDiv";a=$get(SP.UI.MicroFeed.SPMicroFeed.$10+o);if(a.previousSibling)a.previousSibling.className+=" ms-microfeed-noBottomBorder"}else{h=6;b.className=b.className+" ms-microfeed-replyConfDiv";a=f;i=$get(SP.UI.MicroFeed.SPMicroFeed.$1b+a.getAttribute("threadDivID"))}b.style.marginTop=h+"px";b.style.marginBottom=n+"px";a.className+=" "+SP.UI.MicroFeed.SPMicroFeed.$5D;b.appendChild(c);a.parentNode.insertBefore(b,a);d.focus();m=a.style.pixelHeight;if(a.offsetHeight>0)m=a.offsetHeight;l=b.style.pixelHeight;if(b.offsetHeight>0)l=b.offsetHeight;l+=h+n;a.style.height=Math.max(l,m)+"px";$addHandler(d,"click",function(){SP.UI.MicroFeed.SPMicroFeed.$7c(f,j,b,a,i);u();a.style.height=""});$addHandler(g,"click",function(){SP.UI.MicroFeed.SPMicroFeed.$7c(f,j,b,a,i)});SP.UI.MicroFeed.SPMicroFeed.$8V(a);i&&SP.UI.MicroFeed.SPMicroFeed.$3q(i)};SP.UI.MicroFeed.SPMicroFeed.$7c=function(b,c,d,a,e){d.parentNode.removeChild(d);if(a){a.className=a.className.replace(SP.UI.MicroFeed.SPMicroFeed.$5D,"");a.style.height="";if(a.previousSibling)a.previousSibling.className=a.previousSibling.className.replace("ms-microfeed-noBottomBorder","")}if(b&&c){$addHandler(b,"mouseover",function(){SP.UI.MySiteCommon.CommonUIElements.display(c)});$addHandler(b,"mouseout",function(){SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(true,c)})}SP.UI.MicroFeed.SPMicroFeed.$8g(a);e&&SP.UI.MicroFeed.SPMicroFeed.$61(e)};SP.UI.MicroFeed.SPMicroFeed.$3q=function(a){SP.UI.MicroFeed.SPMicroFeed.$2j(a,"button",true)};SP.UI.MicroFeed.SPMicroFeed.$61=function(a){SP.UI.MicroFeed.SPMicroFeed.$2j(a,"button",false)};SP.UI.MicroFeed.SPMicroFeed.$8V=function(a){SP.UI.MicroFeed.SPMicroFeed.$3q(a);SP.UI.MicroFeed.SPMicroFeed.$2j(a,"a",true)};SP.UI.MicroFeed.SPMicroFeed.$8g=function(a){SP.UI.MicroFeed.SPMicroFeed.$61(a);SP.UI.MicroFeed.SPMicroFeed.$2j(a,"a",false)};SP.UI.MicroFeed.SPMicroFeed.$2j=function(c,d,e){var a=null;a=c.getElementsByTagName(d);for(var b=0;b<a.length;b++)a[b].disabled=e};SP.UI.MicroFeed.SPMicroFeed.$5u=function(a){SP.SOD.executeFunc("core.js","SPAnimationUtility",function(){SPAnimationUtility.BasicAnimator.FadeOut(a,function(){a.style.height=a.clientHeight+"px";a.style.width=a.clientWidth+"px";SPAnimationUtility.BasicAnimator.Resize(a,0,0,function(){if($get(a.id)){if(a.getAttribute("deleted")!=="true")SP.UI.MicroFeed.SPMicroFeed.$2d(a);else SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,a);a.style.height="";a.style.width=""}},null)},null)})};SP.UI.MicroFeed.SPMicroFeed.$2d=function(a){a.removeAttribute("deleted");SP.UI.MySiteCommon.CommonUIElements.display(a);SetOpacity(a,1)};SP.UI.MicroFeed.SPMicroFeed.$6o=function(c){var d=0,a=null;if(!c)return 0;a=c.childNodes;if(c.hasChildNodes())for(var b=0;b<a.length;b++){var e=a[b];if(!SP.UI.MySiteCommon.CommonUIElements.isEntirelyHidden(e))d++}return d};SP.UI.MicroFeed.SPMicroFeed.$6y=function(b,e,d){var c=b.id.substr(b.id.indexOf("_")+1);if(SP.UI.MicroFeed.SPMicroFeed.$6o(b)===e){SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,$get(SP.UI.MicroFeed.SPMicroFeed.$2D+c));var a=$get(SP.UI.MicroFeed.SPMicroFeed.$1I+c);if(a){SP.SOD.executeFunc("core.js","SPAnimationUtility",function(){SPAnimationUtility.BasicAnimator.FadeOut(a,function(){a.style.height=a.clientHeight+"px";a.style.width=a.clientWidth+"px";SPAnimationUtility.BasicAnimator.Resize(a,0,a.clientWidth,function(){SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,a);a.style.height="";a.style.width="";SetOpacity(a,1);d&&d()},null)},null)});return true}}return false};SP.UI.MicroFeed.SPMicroFeed.$6s=function(){var a=new SP.UI.MySiteCommon.MySiteDialog(SpsClient.ScriptResources.unknownErrorTitle,SpsClient.ScriptResources.lockThreadErrorMessage);a.set_okButtonText(SpsClient.ScriptResources.closeButtonText);a.set_hideCancelButton(true);a.show();SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()};SP.UI.MicroFeed.SPMicroFeed.$6n=function(i,d,f,j,a,g){var b=document.createElement("span");b.id=SP.UI.MicroFeed.SPMicroFeed.$48+a;var c="";if(d>0)c=SP.UI.MySiteCommon.CommonUIElements.createOpenHTMLTag("span",SP.UI.MicroFeed.SPMicroFeed.$47+a,SP.UI.MicroFeed.SPMicroFeed.$46)+SP.UI.MySiteCommon.CommonUIElements.createSafeImageHTML(SP.UI.MicroFeed.SPMicroFeed.$44+a,f?SP.UI.MicroFeed.SPMicroFeed.$45:SP.UI.MicroFeed.SPMicroFeed.$43,SP.UI.MicroFeed.SPMicroFeed.get_$5K(),"")+"</span>";c+=SP.UI.MySiteCommon.CommonUIElements.createOpenHTMLTag("span",SP.UI.MicroFeed.SPMicroFeed.$6F+a,"")+SP.UI.MicroFeed.SPMicroFeed.$8r(d,f,j,a,g)+"</span>";b.innerHTML=c;var h=SP.UI.MicroFeed.SPMicroFeed.$4W+a,e=SP.UI.MySiteCommon.CommonUIElements.findElementByID(b,h);d>0&&e&&g&&SP.UI.MicroFeed.AllLikerDisplayManager.createAllLikerCallout(i,e);return b};SP.UI.MicroFeed.SPMicroFeed.$8r=function(c,f,a,i,g){var b="",h=SP.UI.MicroFeed.SPMicroFeed.$4W+i,d=g?SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag(h,SP.UI.MicroFeed.SPMicroFeed.$41,"#",'title="'+STSHtmlEncode(SpsClient.ScriptResources.seeAllLikerTitle)+'"'):"",e=g?"</a>":"";if(!a){if(c>0)if(f)b+=c===1?STSHtmlEncode(SpsClient.ScriptResources.likeIndicatorYou):String.format(STSHtmlEncode(SP.Utilities.LocUtility.getLocalizedCountValue(SpsClient.ScriptResources.likeIndicatorNoNamesYouAndOthers_withAnchor,SpsClient.ScriptResources.likeIndicatorNoNamesYouAndOthers_withAnchorIntervals,c-1)),d,c-1,e);else b+=String.format(STSHtmlEncode(SP.Utilities.LocUtility.getLocalizedCountValue(SpsClient.ScriptResources.likeIndicatorNoNames_withAnchor,SpsClient.ScriptResources.likeIndicatorNoNames_withAnchorIntervals,c)),d,c,e)}else switch(c){case 0:break;case 1:if(f)b+=STSHtmlEncode(SpsClient.ScriptResources.likeIndicatorYou);else b+=String.format(STSHtmlEncode(SpsClient.ScriptResources.likeIndicator1Other),a[0]);break;case 2:if(f)b+=String.format(STSHtmlEncode(SpsClient.ScriptResources.likeIndicatorYouAnd1Other),a[0]);else b+=String.format(STSHtmlEncode(SpsClient.ScriptResources.likeIndicator2Others),a[0],a[1]);break;case 3:if(f)b+=String.format(STSHtmlEncode(SpsClient.ScriptResources.likeIndicatorYouAnd2Others),a[0],a[1]);else b+=String.format(STSHtmlEncode(SpsClient.ScriptResources.likeIndicator3Others_withAnchor),a[0],d,e);break;default:if(f)if(c===4)b+=String.format(STSHtmlEncode(SpsClient.ScriptResources.likeIndicatorYouAnd3Others_withAnchor),a[0],d,e);else b+=String.format(STSHtmlEncode(SpsClient.ScriptResources.likeIndicatorYouAndManyOthers_withAnchor),a[0],a[1],d,c-3,e);else b+=String.format(STSHtmlEncode(SpsClient.ScriptResources.likeIndicatorManyOthers_withAnchor),a[0],a[1],d,c-2,e)}return b};SP.UI.MicroFeed.SPMicroFeed.$g=function(b){var c=SP.UI.UIUtility.getInnerText(b);if(!SP.ScriptHelpers.isNullOrEmptyString(c)){var a=document.createElement("span");a.className=SP.UI.MicroFeed.SPMicroFeed.$7Q;SP.UI.MySiteCommon.CommonUIElements.setElementText(a,"");b.appendChild(a)}};SP.UI.MicroFeed.SPMicroFeed.$7x=function(b,f,h){if(!b||!f)return null;var a=null,c=null;b.$S_0&&b.$S_0.sort(SP.UI.MicroFeed.MicrofeedEntry.actorComparison);if(!b.$k_0&&SP.UI.MicroFeed.SPMicroFeed.get_$X()&&!SP.UI.MicroFeed.SPMicroFeed.$1L(b)&&!b.$A_0.get_actorType()&&b.$1_0!==10)a=b.$A_0;else if(b.$S_0)for(var e=0;e<b.$S_0.length;e++){var d=b.$S_0[e];if(!d.get_actorType()){if(!SP.UI.People.PersonManager.getFollowState(d.get_accountName())&&!SP.UI.MicroFeed.SPMicroFeed.$2f(d,SP.UI.MicroFeed.SPMicroFeed.get_$X())){a=d;break}}else if(!SP.UI.MicroFeed.SocialActorCache.isFollowedByMe(d.get_id())){a=d;break}}if(a&&a.get_canFollow()&&SP.UI.MicroFeed.SPMicroFeed.$3Y)if(!a.get_actorType()){var g=SP.UI.People.FollowLinkManager.getLink(a.get_accountName());if(g)c=g.htmlForCustomLink(SP.UI.People.FollowLink.microfeedIdPrefixAndSource+"_"+h+"_",SP.UI.People.FollowLink.microfeedIdPrefixAndSource,false,true,true)}else{c=document.createElement("a");c.id=SP.UI.MicroFeed.SPMicroFeed.$6B+b.$4_0;c.setAttribute("href","#");c.setAttribute("onclick","return false;");c.setAttribute("name",SP.UI.MicroFeed.SPMicroFeed.$4H+a.get_id());c.innerHTML=STSHtmlEncode(String.format(SP.UI.MicroFeed.SPMicroFeed.$2E(a.get_actorType(),true),a.get_name()));$addHandler(c,"click",function(){SP.UI.MicroFeed.SPMicroFeed.$2q(a,true)})}if(c){SP.UI.MicroFeed.SPMicroFeed.$g(f);c.className=SP.UI.MicroFeed.SPMicroFeed.$28;f.appendChild(c);return a}return null};SP.UI.MicroFeed.SPMicroFeed.$5V=function(a,h,d,k){var f=document.createElement("div");f.id=SP.UI.MicroFeed.SPMicroFeed.$6J+d;f.className=SP.UI.MicroFeed.SPMicroFeed.$6I;if((h===1||h===6||h===11)&&!a.$J_0){var c=document.createElement("div");c.id=SP.UI.MicroFeed.SPMicroFeed.$49+d;c.className=SP.UI.MicroFeed.SPMicroFeed.$6E;var j=null;if(h!==11)j=SP.UI.MicroFeed.SPMicroFeed.$5X(a.$16_0,c,true);c.setAttribute("numLikers",a.$m_0);c.appendChild(SP.UI.MicroFeed.SPMicroFeed.$6n(a,a.$m_0,a.$15_0,j,d,k));a.$m_0<=0&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,c);f.appendChild(c)}var e=document.createElement("span");e.id="ms-timesource_"+d;e.className="ms-metadata";var b=(a.$J_0&&a.$6_0?a.$6_0:a).$13_0,i=false;if(b){i=true;b=SP.UI.MySiteCommon.CommonUIElements.createOpenHTMLTag("span","ms-relativetime_"+d,"ms-microfeed-postedTime")+b+"</span>"}if(!SP.ScriptHelpers.isNullOrEmptyString(a.$1P_0)){i=true;var g=SP.UI.MySiteCommon.CommonUIElements.createOpenHTMLTag("span","ms-source_"+d,"");if(!SP.ScriptHelpers.isNullOrEmptyString(a.$1m_0))g+=SP.UI.MySiteCommon.CommonUIElements.createSafeAnchorHTML("ms-sourcelink_"+d,a.$1P_0,"ms-subtleLink",a.$1m_0,'target="_blank"',true)+"</span>";else g+=STSHtmlEncode(a.$1P_0)+"</span>";if(b)e.innerHTML=String.format(STSHtmlEncode(SpsClient.ScriptResources.postFooter),b,g);else e.innerHTML=String.format(STSHtmlEncode(SpsClient.ScriptResources.postFooterOnlySource),g)}else if(b)e.innerHTML=b;i&&f.appendChild(e);return f};SP.UI.MicroFeed.SPMicroFeed.$5X=function(e,f,g){var d=["",""],c=0,b=0,a=null;if(e)for(c=0;c<e.length&&b<d.length;c++){a=e[c];if(!a||a.get_actorType())continue;d[b]=SP.UI.MicroFeed.SPMicroFeed.$4c(a.get_name(),g?a.get_uri():null);f.setAttribute("liker_"+b,a.get_name());g&&f.setAttribute("likerUri_"+b,a.get_uri());b++}return d};SP.UI.MicroFeed.SPMicroFeed.$4c=function(a,b){return SP.ScriptHelpers.isNullOrEmptyString(b)?STSHtmlEncode(a):SP.UI.MySiteCommon.CommonUIElements.createSafeAnchorHTML("ms-linkToLikers",a,"ms-subtleLink",b,"",true)};SP.UI.MicroFeed.SPMicroFeed.$8n=function(a,d,e){var b=$get(SP.UI.MicroFeed.SPMicroFeed.$4U+a);if(!b){b=document.createElement("span");b.id=SP.UI.MicroFeed.SPMicroFeed.$4U+a;b.className=SP.UI.MicroFeed.SPMicroFeed.$6e}var c=SP.UI.MySiteCommon.CommonUIElements.createOpenHTMLTag("span",SP.UI.MicroFeed.SPMicroFeed.$6d+a,"")+SP.UI.MySiteCommon.CommonUIElements.createOpenHTMLTag("span",SP.UI.MicroFeed.SPMicroFeed.$47+a,SP.UI.MicroFeed.SPMicroFeed.$46)+SP.UI.MySiteCommon.CommonUIElements.createSafeImageHTML(SP.UI.MicroFeed.SPMicroFeed.$44+a,e?SP.UI.MicroFeed.SPMicroFeed.$45:SP.UI.MicroFeed.SPMicroFeed.$43,SP.UI.MicroFeed.SPMicroFeed.get_$5K(),"")+"</span>"+SP.UI.MySiteCommon.CommonUIElements.createOpenHTMLTag("span",SP.UI.MicroFeed.SPMicroFeed.$4S+a,"")+d+"</span></span>";b.innerHTML=SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag(SP.UI.MicroFeed.SPMicroFeed.$4T+a,SP.UI.MicroFeed.SPMicroFeed.$41,"#",'onclick="return false;" title="'+SpsClient.ScriptResources.seeAllLikerTitle+'"')+c+"</a>";return b};SP.UI.MicroFeed.SPMicroFeed.$5W=function(c,d,e,h,i){if(!c)return;var b=null,a=SP.UI.MicroFeed.SPMicroFeed.$8n(e,d,i);if(!a)return;if(!$get(a.id)){SP.UI.MicroFeed.SPMicroFeed.$g(c);c.appendChild(a)}b=a.previousSibling;if(d<=0){SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,a);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,b)}else{SP.UI.MySiteCommon.CommonUIElements.display(a);SP.UI.MySiteCommon.CommonUIElements.display(b);var f=SP.UI.MicroFeed.SPMicroFeed.$4T+e,g=SP.UI.MySiteCommon.CommonUIElements.findElementByID(a,f);SP.UI.MicroFeed.AllLikerDisplayManager.createAllLikerCallout(h,g)}};SP.UI.MicroFeed.SPMicroFeed.$96=function(a,c,d){var b=a.target.getAttribute("liked")==="true";SP.UI.MySiteCommon.CommonUIElements.setElementText(a.target,b?SpsClient.ScriptResources.likeCommandText:SpsClient.ScriptResources.unlikeCommandText);a.target.disabled=true;SP.UI.MicroFeed.SPMicroFeed.showProgressSpinner();SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){var e=b?SP.UI.MicroFeed.SPMicroFeed.get_$D().unlikePost(c):SP.UI.MicroFeed.SPMicroFeed.get_$D().likePost(c);SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){var f=e.get_status();if(f&&f!==5&&f!==8)SP.UI.MicroFeed.SPMicroFeed.$74(a,b,null);else SP.UI.MicroFeed.SPMicroFeed.$75(a,c,b,e,d)},function(f,e){if(e.get_errorCode()===5)SP.UI.MicroFeed.SPMicroFeed.$75(a,c,b,null,d);else SP.UI.MicroFeed.SPMicroFeed.$74(a,b,e)})})};SP.UI.MicroFeed.SPMicroFeed.$75=function(l,o,c,m,n){var f=0,g=null,h=null,i=null,d=null,k="",b="",a=null,e=0;m&&SP.UI.MicroFeed.MicrofeedThreadCache.addOrUpdate(m,false);i=document.getElementsByName(o);for(var j=0;j<i.length;j++){f=c?-1:1;d=i[j].parentNode;k=d.getAttribute("threadDivID");b=d.id.substr(d.id.indexOf("_")+1);a=$get(SP.UI.MicroFeed.SPMicroFeed.$42+b);h=$get(SP.UI.MicroFeed.SPMicroFeed.$10+k);e=parseInt(h.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$t));if(!a)continue;if(c&&a.getAttribute("liked")==="true"){a.removeAttribute("liked");e=Math.max(e-1,0)}else if(!c&&a.getAttribute("liked")!=="true"){a.setAttribute("liked","true");e++}else continue;SP.UI.MySiteCommon.CommonUIElements.setElementText(a,c?SpsClient.ScriptResources.likeCommandText:SpsClient.ScriptResources.unlikeCommandText);SP.UI.MicroFeed.SPMicroFeed.$5O(h,e,a===l.target);if(d.getAttribute("isRoot")==="true")SP.UI.MicroFeed.SPMicroFeed.$9c(c,f,b,n);else{g=$get(SP.UI.MicroFeed.SPMicroFeed.$4S+b);f+=!g?0:parseInt(SP.UI.UIUtility.getInnerText(g));SP.UI.MicroFeed.SPMicroFeed.$5W($get("ms-footer_"+b),f,b,n,!c)}}SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner();l.target.disabled=false};SP.UI.MicroFeed.SPMicroFeed.$9c=function(f,b,e,h){var a=$get(SP.UI.MicroFeed.SPMicroFeed.$49+e),c=$get(SP.UI.MicroFeed.SPMicroFeed.$48+e),d=["",""];b+=parseInt(a.getAttribute("numLikers"));a.setAttribute("numLikers",b);d[0]=SP.UI.MicroFeed.SPMicroFeed.$4c(a.getAttribute("liker_"+0),a.getAttribute("likerUri_"+0));d[1]=SP.UI.MicroFeed.SPMicroFeed.$4c(a.getAttribute("liker_"+1),a.getAttribute("likerUri_"+1));if(b>0){SP.UI.MySiteCommon.CommonUIElements.display(a);a.innerHTML="";c=SP.UI.MicroFeed.SPMicroFeed.$6n(h,b,!f,d,e,true);var g=!f&&b===1;if(g)SP.UI.MicroFeed.SPMicroFeed.$1z(c,a,null,false);else a.appendChild(c)}else SP.SOD.executeFunc("core.js","SPAnimationUtility",function(){SPAnimationUtility.BasicAnimator.FadeOut(a,function(){a.style.paddingBottom="0";a.style.height=a.clientHeight+"px";a.style.width=a.clientWidth+"px";a.innerHTML="";SPAnimationUtility.BasicAnimator.Resize(a,0,0,function(){SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,a);a.style.height="";a.style.width="";a.style.paddingBottom="";SetOpacity(a,1)},null)},null)})};SP.UI.MicroFeed.SPMicroFeed.$74=function(c,b,d){if(d&&d.get_errorCode()===2)SP.UI.MicroFeed.SPMicroFeed.$2h(function(){SP.UI.MicroFeed.SPMicroFeed.$5Z(c,b)});else{var a=new SP.UI.MySiteCommon.MySiteDialog(SpsClient.ScriptResources.unknownErrorTitle,b?SpsClient.ScriptResources.unLikeErrorMessage:SpsClient.ScriptResources.likeErrorMessage);a.set_okButtonCallback(function(){SP.UI.MicroFeed.SPMicroFeed.$5Z(c,b)});a.set_hideCancelButton(true);a.show()}};SP.UI.MicroFeed.SPMicroFeed.$5Z=function(a,b){SP.UI.MySiteCommon.CommonUIElements.setElementText(a.target,b?SpsClient.ScriptResources.unlikeCommandText:SpsClient.ScriptResources.likeCommandText);SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()};SP.UI.MicroFeed.SPMicroFeed.$91=function(a){return!a?true:a.innerHTML===""||a.innerHTML===STSHtmlEncode(SpsClient.ScriptResources.replyLimitErrorText)};SP.UI.MicroFeed.SPMicroFeed.getTextBoxFocusDiv=function(a,b){if(b)return $get(SP.UI.MicroFeed.SPMicroFeed.$57);else{var c=SP.UI.MicroFeed.SPMicroFeed.getPostIDFromDOMElementID(a.id);return $get(SP.UI.MicroFeed.SPMicroFeed.$4R+c)}};SP.UI.MicroFeed.SPMicroFeed.$63=function(c,d){var b=$get(c),a=SP.UI.MicroFeed.SPMicroFeed.getTextBoxFocusDiv(b,d);if(a)a.className=a.className.replace(SP.UI.MicroFeed.SPMicroFeed.$56,SP.UI.MicroFeed.SPMicroFeed.$2Q);SP.UI.MicroFeed.SPMicroFeed.$s&&window.clearInterval(SP.UI.MicroFeed.SPMicroFeed.$3a)};SP.UI.MicroFeed.SPMicroFeed.$9Z=function(){if(!SP.UI.MicroFeed.SPMicroFeed.$L)SP.UI.MicroFeed.SPMicroFeed.$L=SP.ClientContext.get_current();var a=SP.UI.MicroFeed.SPMicroFeed.$1u.getPeopleFollowedByMe();SP.UI.MicroFeed.SPMicroFeed.$L.load(a,SP.UI.People.MySitePeopleUtilities.personPropertiesToIncludeInCollection);return a};SP.UI.MicroFeed.SPMicroFeed.$9a=function(b){if(!b)return;SP.UI.MicroFeed.BaseAtMention.setFollowedPeople(b);if(document.activeElement&&document.activeElement.className.indexOf(SP.UI.MicroFeed.SPMicroFeed.$3T)>-1){var a=SP.UI.MicroFeed.SPMicroFeed.$N[SP.UI.MicroFeed.SPMicroFeed.getPostIDFromDOMElementID(document.activeElement.id)];a&&a.correctDropdownState()}SP.UI.MicroFeed.SPMicroFeed.$2S&&SP.UI.MicroFeed.SPMicroFeed.$2S()};SP.UI.MicroFeed.SPMicroFeed.$24=function(a,b){SP.SOD.executeFunc("core.js","SPAnimationUtility",function(){var c=$get(SP.UI.MicroFeed.SPMicroFeed.$26);if(c)if(b)SPAnimationUtility.BasicAnimator.FadeIn(c,function(){a&&a()},null);else SPAnimationUtility.BasicAnimator.FadeOut(c,function(){a&&a()},null)})};SP.UI.MicroFeed.SPMicroFeed.$1z=function(a,b,j,k){if(!a||!b)return;var c=document.createElement("div"),d=0,e=0,f=a.style.zIndex,g=a.style.position,h=a.style.left,i=a.style.top;a.style.zIndex=1;a.style.position="absolute";a.style.left="0px";a.style.top="0px";SetOpacity(a,0);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(true,a);if(!k)b.insertBefore(a,b.firstChild);else b.appendChild(a);d=a.clientHeight;e=a.clientWidth;c.style.height="0px";c.style.width="0px";b.insertBefore(c,a);SP.SOD.executeFunc("core.js","SPAnimationUtility",function(){SPAnimationUtility.BasicAnimator.Resize(c,d,e,function(){b.removeChild(c);a.style.left=h;a.style.top=i;a.style.zIndex=f;a.style.position=g;SP.UI.MicroFeed.SPMicroFeed.$7k(a,2);SP.UI.MySiteCommon.CommonUIElements.display(a);SPAnimationUtility.BasicAnimator.FadeIn(a,j,null)},null)})};SP.UI.MicroFeed.SPMicroFeed.$7k=function(c,d){if(!c)return;if(d>0){var a=c.childNodes;if(a)for(var e=a.length,b=0;b<e;b++)if(a[b].nodeType!==3){SetOpacity(a[b],1);SP.UI.MicroFeed.SPMicroFeed.$7k(a[b],d-1)}}};SP.UI.MicroFeed.SPMicroFeed.$7f=function(b,c){if(b){var a=$get(c);if(a&&a.parentNode){b.id=c;a.parentNode.replaceChild(b,a)}}};SP.UI.MicroFeed.SPMicroFeed.$2h=function(b){var a=new SP.UI.MySiteCommon.MySiteDialog(SpsClient.ScriptResources.unknownErrorTitle,SpsClient.ScriptResources.lossOfPermissionsDialogText);a.set_okButtonCallback(b);a.set_hideCancelButton(true);a.show()};SP.UI.MicroFeed.SPMicroFeed.$5L=function(b){var a=$get(SP.UI.MicroFeed.SPMicroFeed.$2o+b);if(a){a.innerHTML="";a.appendChild(SP.UI.MySiteCommon.CommonUIElements.createProcessingIcon("",""));return true}return false};SP.UI.MicroFeed.SPMicroFeed.$5M=function(b){var a=$get(SP.UI.MicroFeed.SPMicroFeed.$2o+b);if(a)a.innerHTML=SP.UI.MySiteCommon.CommonUIElements.createSafeImageHTML(SP.UI.MicroFeed.SPMicroFeed.$4C+b,SP.UI.MicroFeed.SPMicroFeed.$2p,SP.UI.MicroFeed.SPMicroFeed.get_$1H(),"")};SP.UI.MicroFeed.SPMicroFeed.$2q=function(a,b){SP.UI.MicroFeed.SPMicroFeed.showProgressSpinner();SP.UI.MicroFeed.SPMicroFeed.$3k(a,!b,false);var d=function(){SP.UI.MicroFeed.SPMicroFeed.$6t(a,b)},e=function(){SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner();SP.UI.MicroFeed.SPMicroFeed.$3k(a,b,true)};if(!a.get_actorType()){var c=SP.UI.People.FollowLinkManager.getLink(a.get_accountName());if(c&&c.get_followingState()!==b)c.onClick(SP.UI.People.FollowLink.microfeedIdPrefixAndSource);else SP.UI.MicroFeed.SPMicroFeed.$6t(a,b)}else if(a.get_actorType()===3)SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){if(b)SP.UI.MicroFeed.SPMicroFeed.get_$5F().followTag(a.get_tagGuid());else SP.UI.MicroFeed.SPMicroFeed.get_$5F().stopFollowingTag(a.get_tagGuid());SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(d,e)});else SP.SOD.executeFunc("followingcommon.js","SetFollowStatus",function(){SetFollowStatus(a.get_uri(),b,a.get_actorType()===1,d,e)})};SP.UI.MicroFeed.SPMicroFeed.$6t=function(a,b){if(!a.get_actorType()){var c=SP.UI.People.FollowLinkManager.getLink(a.get_accountName());c&&c.updateFromExternalSource(b,SP.UI.People.FollowLink.microfeedIdPrefixAndSource)}else{SP.UI.MicroFeed.SPMicroFeed.$3k(a,!b,true);SP.UI.MicroFeed.SocialActorCache.setIsFollowedByMeValue(a,b)}SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()};SP.UI.MicroFeed.SPMicroFeed.$3k=function(a,e,f){if(a&&a.get_actorType())for(var d=document.getElementsByName(SP.UI.MicroFeed.SPMicroFeed.$4H+a.get_id()),c=0;c<d.length;c++){var b=d[c];if(b){SP.UI.MySiteCommon.CommonUIElements.setElementText(b,String.format(SP.UI.MicroFeed.SPMicroFeed.$2E(a.get_actorType(),e),a.get_name()));b.disabled=!f;$clearHandlers(b);$addHandler(b,"click",function(){SP.UI.MicroFeed.SPMicroFeed.$2q(a,e)})}}};SP.UI.MicroFeed.SPMicroFeed.createClearFloatsDiv=function(){var a=document.createElement("div");a.className="ms-clear";return a};SP.UI.MicroFeed.SPMicroFeed.prototype={$3B_0:null,$7_0:0,get_webPartFeedType:function(){return this.$7_0},$M_0:null,get_targetID:function(){return this.$M_0},set_targetID:function(a){this.$M_0=a;return a},$K_0:false,get_hasWritePermission:function(){return this.$K_0},set_hasWritePermission:function(a){this.$K_0=a;return a},$14_0:false,$5_0:null,$3C_0:0,$E_0:null,$4q_0:null,$1k_0:null,$1O_0:false,$4t_0:false,$2I_0:false,$4r_0:0,$8_0:0,$1i_0:0,$18_0:0,$1j_0:false,$1A_0:null,$1l_0:0,$4u_0:null,$3G_0:null,$1h_0:null,$3A_0:null,$3H_0:false,$4v_0:false,$3F_0:"",$3E_0:"",$3J_0:"",$3I_0:"",$T_0:null,$12_0:null,$7A_0:false,$4s_0:1,$G_0:"",initializeViewsAndThreadAttributes:function(){var b=null,a=[],c="</a>";if(this.$7_0===1){a[a.length]=SP.UI.MicroFeed.AttributePair.createAttributePairWithType(0,"true");a[a.length]=SP.UI.MicroFeed.AttributePair.createAttributePairWithType(1,"true");a[a.length]=SP.UI.MicroFeed.AttributePair.createAttributePairWithType(2,"true");a[a.length]=SP.UI.MicroFeed.AttributePair.createAttributePairWithType(4,"true");var g="SP.UI.MicroFeed.SPMicroFeed.switchToCompanyFeedView();";if(SP._yam)b=String.format(STSHtmlEncode(SpsClient.ScriptResources.yammerEmptyFeedDueToNoActivity),SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag("","",SP.UI.MySiteCommon.CommonUIElements.ensureTrailingSlash(_spPageContextInfo.webAbsoluteUrl)+SP.UI.MicroFeed.SPMicroFeed.$7m,""),c);else b=String.format(STSHtmlEncode(SpsClient.ScriptResources.emptyFeedDueToNoActivity),SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag("","",SP.UI.MySiteCommon.CommonUIElements.ensureTrailingSlash(_spPageContextInfo.webAbsoluteUrl)+SP.UI.MicroFeed.SPMicroFeed.$6O,""),c,SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag("","ms-link","#",'onclick="'+g+'return false;"'),c);this.$1i_0=this.$5_0.length;this.$5_0[this.$5_0.length]=SP.UI.MicroFeed.MicroFeedView.createView(a,1,SpsClient.ScriptResources.followingViewName,b,"");a=[];a[a.length]=SP.UI.MicroFeed.AttributePair.createAttributePairWithType(0,"true");b=STSHtmlEncode(SpsClient.ScriptResources.emptyFeedDueToCacheIssues);SP.UI.MicroFeed.SPMicroFeed.$1t=this.$5_0.length;this.$5_0[this.$5_0.length]=SP.UI.MicroFeed.MicroFeedView.createView(a,4,SpsClient.ScriptResources.companyFeedViewName,b,"");a=[];a[a.length]=SP.UI.MicroFeed.AttributePair.createAttributePairWithType(3,"true");a[a.length]=SP.UI.MicroFeed.AttributePair.createAttributePairWithType(0,"true");this.$18_0=this.$5_0.length;b=STSHtmlEncode(SpsClient.ScriptResources.emptyMentionView);this.$5_0[this.$5_0.length]=SP.UI.MicroFeed.MicroFeedView.createView(a,5,SpsClient.ScriptResources.mentionsViewName,b,STSHtmlEncode(SpsClient.ScriptResources.mentionsViewDescription))}a=[];a[a.length]=SP.UI.MicroFeed.AttributePair.createAttributePairWithType(1,"true");a[a.length]=SP.UI.MicroFeed.AttributePair.createAttributePairWithType(2,"true");a[a.length]=SP.UI.MicroFeed.AttributePair.createAttributePairWithType(0,"true");var f="SP.UI.MicroFeed.SPMicroFeed.setFocusOnRootPostInputBox();";if(this.$7_0===1){b=SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag("","ms-link","#",'onclick="'+f+'return false;"')+STSHtmlEncode(SpsClient.ScriptResources.emptyPublishedFeedViewLinkText)+c;b=String.format(STSHtmlEncode(SpsClient.ScriptResources.emptyPublishedFeedView),b)}else if(!this.$7_0)b=STSHtmlEncode(String.format(SpsClient.ScriptResources.emptyOtherUserFeed,this.$3G_0));else{var d="",e="";if(!SP.ScriptHelpers.isNullOrEmptyString(this.$M_0)){var h="SP.SOD.executeFunc('sharing.js', 'DisplaySharingDialog', function() { DisplaySharingDialog('"+SP.Utilities.HttpUtility.ecmaScriptStringLiteralEncode(this.$M_0)+"'); });";d=SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag("","ms-link","#",'onclick="'+h+'return false;"');e=c}if(this.$K_0)b=String.format(SpsClient.ScriptResources.emptySiteFeed,d,e,SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag("","ms-link","#",'onclick="'+f+'return false;"'),c);else b=String.format(SpsClient.ScriptResources.emptySiteFeedWithNoPermissions,d,e)}this.$5_0[this.$5_0.length]=SP.UI.MicroFeed.MicroFeedView.createView(a,0,SpsClient.ScriptResources.publishedFeedViewName,b,"");if(this.$7_0===1){a=[];a[a.length]=SP.UI.MicroFeed.AttributePair.createAttributePairWithType(1,"true");a[a.length]=SP.UI.MicroFeed.AttributePair.createAttributePair(SP.UI.MicroFeed.SPMicroFeed.$2e,"true");b=STSHtmlEncode(SpsClient.ScriptResources.emptyMyLikesView);this.$5_0[this.$5_0.length]=SP.UI.MicroFeed.MicroFeedView.createView(a,0,SpsClient.ScriptResources.likesViewName,b,"")}},$1y_0:function(){return this.$1O_0||this.$4t_0||this.$7_0===2},initialize:function(a,d,g,h,e,b){this.$4u_0=g;this.$3G_0=h;if(this.$7_0===2)this.$G_0=SpsClient.ScriptResources.siteFeedRootTextBoxString;else this.$G_0=SpsClient.ScriptResources.postTextBoxString;var i=$get(SP.UI.MicroFeed.SPMicroFeed.$1s),j=this;$addHandler(document.body,"click",function(a){!SP.UI.MicroFeed.BaseAtMention.$90(a.target)&&SP.UI.MicroFeed.BaseAtMention.removeSuggestionSelector()});var k=this;SP.UI.People.FollowLinkManager.set_followCallback(function(b,c,e,d){if(d){var a=SP.UI.People.PersonManager.getPerson(b);if(a)if(c)SP.UI.MicroFeed.BaseAtMention.addFollowedPerson(a.get_accountName(),a.get_displayName());else SP.UI.MicroFeed.BaseAtMention.removeFollowedPerson(a.get_accountName(),a.get_displayName())}SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()});var c=SP.UI.MicroFeed.SPMicroFeed.$8o();a=!!(a&((this.$7_0===1||this.$7_0===2)&&!SP.UI.MicroFeed.SPMicroFeed.$W));if(d){this.initializeViewsAndThreadAttributes();this.$7i_0(0);if(!SP.UI.MicroFeed.SPMicroFeed.$W){if(!c)c=new SP.Social.SocialFeed;this.$9K_0(c)}}this.$7A_0=SP.UI.MicroFeed.SPMicroFeed.$8z();if(!SP.ScriptHelpers.isNullOrEmptyString(e)||!SP.ScriptHelpers.isNullOrEmptyString(b)){var f=0;if(!SP.ScriptHelpers.isNullOrEmptyString(b))f=Number.parseInvariant(b);this.$6r_0(e,f)}else{this.drawTheWebPart(a,d,i);SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()}},$6r_0:function(c,d){var a=document.createElement("div");a.id="ms-ErrorMessage";var b=$get(SP.UI.MicroFeed.SPMicroFeed.$1s);if(!b)return;if(SP.UI.MicroFeed.SPMicroFeed.$W){a.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.individualThreadViewErrorText);b.appendChild(a);return}switch(d){case 16:a.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.featureDisabledErrorMessage);!SP.ScriptHelpers.isNullOrEmptyString(c)&&SP.UI.MySiteCommon.CommonUIElements.addTechnicalDetailsDiv(a,String.format(SpsClient.ScriptResources.genericErrorMessage,c),"_featuredisabled",null);b.appendChild(a);break;case 9:if(this.$7_0!==2){a.innerHTML=this.$8k_0();b.appendChild(a);SP.UI.MicroFeed.SPMicroFeed.$1S=true;SP.UI.MicroFeed.SPMicroFeed.$r=false;SP.UI.MicroFeed.SPMicroFeed.initializeCSOMData(true)}break;case 10:if(this.$7_0!==2){a.innerHTML=SpsClient.ScriptResources.currentUserTriedAndFailedToCreateMySite;b.appendChild(a)}break;case 11:if(this.$7_0!==2){a.innerHTML=SpsClient.ScriptResources.currentUserCannotHaveMySite;b.appendChild(a)}break;case 12:break;case 7:a.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.emptyFeedDueToCacheIssues);b.appendChild(a);break;default:a.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.unknownErrorTitle);!SP.ScriptHelpers.isNullOrEmptyString(c)&&SP.UI.MySiteCommon.CommonUIElements.addTechnicalDetailsDiv(a,String.format(SpsClient.ScriptResources.genericErrorMessage,c),"_initialerror",null);b.appendChild(a)}},$8k_0:function(){var e="",f="";if(!SP.ScriptHelpers.isNullOrEmptyString(this.$3A_0)&&SP.UI.MySiteCommon.CommonUIElements.isSafeURL(this.$3A_0)){e=SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag(SP.UI.MicroFeed.SPMicroFeed.$7U,"",this.$3A_0,"");f="</a>"}var g="",h="",d="";if(!SP.ScriptHelpers.isNullOrEmptyString(this.$1h_0)&&SP.UI.MySiteCommon.CommonUIElements.isSafeURL(this.$1h_0)){g=SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag(SP.UI.MicroFeed.SPMicroFeed.$7W,"",this.$1h_0,"");var i=SP.ScriptHelpers.replaceOrAddQueryString(this.$1h_0,"Section","Preferences");h=SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag(SP.UI.MicroFeed.SPMicroFeed.$7V,"",i,"");d="</a>"}var b='<span class="ms-bold">',c="</span>",a='<h1 class="ms-core-pageTitle">'+STSHtmlEncode(SpsClient.ScriptResources.currentUserDoesNotHaveMySite_Title)+"</h1><br/>";a+='<div class="ms-textLarge">'+String.format(STSHtmlEncode(SpsClient.ScriptResources.currentUserDoesNotHaveMySite_EditProfileLinks),e,f,h,d,g,d)+"</div><br/>";a+='<div class="ms-microfeed-welcomeText">';a+="<div>"+STSHtmlEncode(SpsClient.ScriptResources.currentUserDoesNotHaveMySite_MySiteHubs)+"</div>";a+="<div>"+String.format(STSHtmlEncode(SP._yam?SpsClient.ScriptResources.yammerCurrentUserDoesNotHaveMySite_NewsfeedHub:SpsClient.ScriptResources.currentUserDoesNotHaveMySite_NewsfeedHub),b,c)+"</div>";if(!SP.ScriptHelpers.isUndefined(SpsClient.ScriptResources.currentUserDoesNotHaveMySite_SkyDriveHub2))a+="<div>"+String.format(STSHtmlEncode(SpsClient.ScriptResources.currentUserDoesNotHaveMySite_SkyDriveHub2),b,"OneDrive",c)+"</div>";else a+="<div>"+String.format(STSHtmlEncode(SpsClient.ScriptResources.currentUserDoesNotHaveMySite_SkyDriveHub),b,c)+"</div>";a+="<div>"+String.format(STSHtmlEncode(SpsClient.ScriptResources.currentUserDoesNotHaveMySite_SitesHub),b,c)+"</div>";a+="</div>";return a},$9K_0:function(b){var a=new SP.UI.MicroFeed.MicrofeedThreadList;a.setThreadCollection(b,false,this.$1O_0);this.$E_0[this.$5_0[this.$8_0].$f_0]=a;this.$1y_0()&&this.$5H_0(b)},drawTheWebPart:function(e,d,c){if(SP._yam&&this.$7_0===1){var b=document.createElement("div");b.setAttribute("class","ms-status-blue ms-status-msg");b.setAttribute("aria-live","polite");b.setAttribute("aria-relevant","all");b.innerHTML="<span class='ms-status-status' role='alert'><span class='ms-status-body'>"+SpsClient.ScriptResources.yammerMicroFeedReadOnly+" <a href='http://o15.officeredir.microsoft.com/r/rlidSPOnewsfeedO15' target='_blank'>"+SpsClient.ScriptResources.yammerMicroFeedReadOnlyMoreInfo+"</a></span></span>";c.appendChild(b)}d&&this.$7_0===2&&c.appendChild(this.$5z_0());if(e){c.appendChild(this.$8b_0());var a=$get(SP.UI.MicroFeed.SPMicroFeed.$1D);if(a&&!SP.ScriptHelpers.isNullOrEmptyString(a.value)&&a.value!==this.$G_0){a.focus();SP.UI.MySiteCommon.CommonUIElements.setCursorPosition(a,a.value.length);SP.UI.MicroFeed.SPMicroFeed.$2X(a)}}if(d){c.appendChild(this.$8Y_0());this.$14_0=true;SP.SOD.executeFunc("SP.DateTimeUtil.js","SP.DateTimeUtil.SPRelativeDateTime.getRelativeDateTimeString",null);SP.UI.MicroFeed.SPMicroFeed.$9b(this.$7_0===2?800:0)}SP.UI.MicroFeed.SPMicroFeed.$1S=true;SP.UI.MicroFeed.SPMicroFeed.$r=false},changeView:function(a){if(a<0)return;var c=null,e=this.$5_0[this.$8_0],b=this.$5_0[a],d=$get(SP.UI.MicroFeed.SPMicroFeed.$V),f=false;if(!b)return;if(e.$u_0===b.$u_0){this.refreshTheFeed();return}if(this.$T_0){if(this.$8_0>=0)this.$T_0.AllOptions[this.$8_0].SelectedOption=false;this.$T_0.AllOptions[a].SelectedOption=true;this.$T_0.Render()}this.$1k_0=null;this.resetNewPostNotifications();this.$1O_0=a===this.$1i_0;this.$4t_0=a===SP.UI.MicroFeed.SPMicroFeed.$1t;if(e.$u_0===SpsClient.ScriptResources.mentionsViewName||b.$u_0===SpsClient.ScriptResources.mentionsViewName)f=true;SP.UI.MicroFeed.SPMicroFeed.showProgressSpinner();this.$7i_0(a);if(b.$u_0===SpsClient.ScriptResources.mentionsViewName){c=$get(SP.UI.MicroFeed.SPMicroFeed.$1X);if(d)d.disabled=true;this.$1A_0=new Date;this.$4b_0(true,c,true)}else if(b.$f_0===e.$f_0&&this.$1j_0)this.refreshCurrentFeedDataForNewView(f);else{c=$get(SP.UI.MicroFeed.SPMicroFeed.$1X);if(d)d.disabled=true;this.$1A_0=new Date;this.$4b_0(this.$1y_0(),c,false)}},refreshCurrentFeedDataForNewView:function(h){var a=0,g=0,c=$get(SP.UI.MicroFeed.SPMicroFeed.$1J),d=null,e=c.children,i=this.$5_0[this.$8_0],f=$get(SP.UI.MicroFeed.SPMicroFeed.$4a);SP.UI.MicroFeed.SPMicroFeed.$24(null,false);f.innerHTML=i.$2l_0;if(SP.ScriptHelpers.isNullOrEmptyString(f.innerHTML))SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,f);else SP.UI.MySiteCommon.CommonUIElements.display(f);d=$get(SP.UI.MicroFeed.SPMicroFeed.$27);null!==d&&d.parentNode.removeChild(d);for(var b=0;b<e.length;b++)if(this.$3g_0(e[b])&&a<SP.UI.MicroFeed.SPMicroFeed.$1F){a++;SP.UI.MySiteCommon.CommonUIElements.display(e[b])}else{g++;SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,e[b])}if(!a){c.appendChild(this.$22_0(false));SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,$get(SP.UI.MicroFeed.SPMicroFeed.$1W))}c.setAttribute("numHiddenThreads",g);SP.UI.MySiteCommon.CommonUIElements.display($get(SP.UI.MicroFeed.SPMicroFeed.$1W));a<SP.UI.MicroFeed.SPMicroFeed.$1F&&this.$3e_0(c,SP.UI.MicroFeed.SPMicroFeed.$1F-a,0);h&&this.$7t_0();SP.UI.MicroFeed.SPMicroFeed.$24(null,true);SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner();this.$1j_0=true},$7t_0:function(){var b=0,d=0,c=$get(SP.UI.MicroFeed.SPMicroFeed.$1J),a=null;if(c&&c.childNodes)for(b=0;b<c.childNodes.length;b++){a=c.childNodes[b];if(a.getAttribute(SP.Social.SocialThreadType.toString(3))==="true")if(this.$8_0===this.$18_0&&d<this.$1l_0){a.className+=" "+SP.UI.MicroFeed.SPMicroFeed.$3z;d++}else a.className=a.className.replace(SP.UI.MicroFeed.SPMicroFeed.$3z,"")}this.$8_0===this.$18_0&&this.$1x_0(0)},$8E_0:function(a){if(a.keyCode===37||a.keyCode===38||a.keyCode===39||a.keyCode===40)return;this.$20_0(a.target)},$20_0:function(a){if(!SP.ScriptHelpers.isNullOrEmptyString(a.style.height)&&a.style.height.toLowerCase()!=="auto")return;!SP.UI.MicroFeed.SPMicroFeed.$s&&$removeHandler(a,"propertychange",this.$$d_$8E_0);while(a.scrollHeight<=a.clientHeight&&a.rows>2)a.rows=a.rows-1;while(a.scrollHeight>a.clientHeight)a.rows=a.rows+1;!SP.UI.MicroFeed.SPMicroFeed.$s&&$addHandler(a,"propertychange",this.$$d_$8E_0);SP.UI.MicroFeed.SPMicroFeed.$2X(a)},$8b_0:function(){var c=document.createElement("div");c.id=SP.UI.MicroFeed.SPMicroFeed.$7G;c.className=SP.UI.MicroFeed.SPMicroFeed.$7F+(this.$7_0===2?" ms-microfeed-siteFeedMicroBlogPart":"");var g=document.createElement("div");g.id=SP.UI.MicroFeed.SPMicroFeed.$57;g.className=SP.UI.MicroFeed.SPMicroFeed.$55+" "+SP.UI.MicroFeed.SPMicroFeed.$2Q;g.style.position="relative";var l=document.createElement("div");l.id=SP.UI.MicroFeed.SPMicroFeed.$3R;l.className=SP.UI.MicroFeed.SPMicroFeed.$53+" "+SP.UI.MicroFeed.SPMicroFeed.$7J;var a=document.createElement("textarea");a.id=SP.UI.MicroFeed.SPMicroFeed.$1D;a.style.position="relative";if(this.$7_0!==2){var k=document.createElement("div");k.id="ms-shareWithDiv";var f=new SP.UI.MicroFeed.MicrofeedMenu("ms-shareWithTarget","span","","",true,"ms-microfeed-mysitemenu-control ms-microfeed-mysitemenu-subtleEmphasis","ms-microfeed-mysitemenu-titleImage","ms-mysitemenu-link ms-microfeed-shareWithTarget",""),u=this;f.add(SpsClient.ScriptResources.shareWithEveryoneString,"","","",function(){u.$M_0="";a.setAttribute("targetDisplayName","");a.focus();return});f.addSeparator();if(!this.$7y_0(a,f)){var m=new SP.UI.MySiteCommon.MySiteMenuItem(null);m.set_enabled(false);m.set_text(SpsClient.ScriptResources.notFollowingAnySitesHelperText);f.appendMenuItem(m);f.addSeparator();var x=this;f.add(SpsClient.ScriptResources.createAGroupTargetString,"","","",function(){window.location.href=SP.Utilities.Utility.getLayoutsPageUrl("MySite.aspx?MySiteRedirect=AllSites");f.setSelection(0)})}var h=document.createElement("label");h.id="ms-shareWithLabel";k.className="ms-microfeed-shareWith";h.className="ms-microfeed-shareWithLabel ms-soften ms-textLarge";h.setAttribute("for","ms-mysitemenu-control_Link_ms-shareWithTarget");h.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.shareWithString)+"&nbsp;";k.appendChild(h);h.appendChild(f.render());c.appendChild(k)}var i=document.createElement("span");i.id=SP.UI.MicroFeed.SPMicroFeed.$59;var b=SP.UI.MicroFeed.SPMicroFeed.$3m(SpsClient.ScriptResources.postCommandText,SP.UI.MicroFeed.SPMicroFeed.$V,SP.UI.MicroFeed.SPMicroFeed.$58);b.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$Y,"");var d=document.createElement("div");d.id=SP.UI.MicroFeed.SPMicroFeed.$3Q;var e=document.createElement("label");e.id=SP.UI.MicroFeed.SPMicroFeed.$1C;e.className=SP.UI.MicroFeed.SPMicroFeed.$4z+" "+SP.UI.MicroFeed.SPMicroFeed.$2O;a.rows=2;a.className=SP.UI.MicroFeed.SPMicroFeed.$53+" "+SP.UI.MicroFeed.SPMicroFeed.$2P+" "+SP.UI.MicroFeed.SPMicroFeed.$3T;a.title=SpsClient.ScriptResources.postBoxTitleText;if(!SP.ScriptHelpers.isNullOrEmptyString(this.$M_0))a.setAttribute("targetDisplayName",this.$3G_0);else a.setAttribute("targetDisplayName","");if(!SP.UI.MicroFeed.SPMicroFeed.$s){$addHandler(a,"keydown",this.$$d_$8E_0);$addHandler(a,"keyup",this.$$d_$8E_0);$addHandler(a,"propertychange",this.$$d_$8E_0);$addHandler(a,"input",this.$$d_$8E_0)}var v=this;$addHandler(a,"focus",function(){v.$62_0(a.id,true,null)});var y=this;$addHandler(a,"blur",function(){SP.UI.MicroFeed.SPMicroFeed.$63(a.id,true)});SP.UI.MySiteCommon.CommonUIElements.setElementText(a,this.$G_0);c.appendChild(SP.UI.MicroFeed.SPMicroFeed.createClearFloatsDiv());g.appendChild(l);g.appendChild(a);d.className="ms-microfeed-elementsNoFocus";d.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$Y,"");d.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$1K,"false");SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,d);d.appendChild(SP.UI.MicroFeed.SPMicroFeed.$5g(a,null));d.appendChild(this.$5d_0(a,b,null));g.appendChild(d);c.appendChild(g);i.className=SP.UI.MicroFeed.SPMicroFeed.$3W+" "+SP.UI.MicroFeed.SPMicroFeed.$7L;b.disabled=true;var w=this;$addHandler(b,"click",function(){w.$7Z_0(null,"",SP.UI.MicroFeed.SPMicroFeed.$6m(null))});SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,e);i.appendChild(e);i.appendChild(b);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,b);var j=SP.UI.MicroFeed.SPMicroFeed.$2a(SP.UI.MicroFeed.SPMicroFeed.get_$1H(),SpsClient.ScriptResources.attachPictureButtonText,SpsClient.ScriptResources.attachPictureButtonText,SP.UI.MicroFeed.SPMicroFeed.$3K,SP.UI.MicroFeed.SPMicroFeed.$4y+" "+SP.UI.MicroFeed.SPMicroFeed.$d,SP.UI.MicroFeed.SPMicroFeed.$4x,SP.UI.MicroFeed.SPMicroFeed.$4w);j.setAttribute("name",SP.UI.MicroFeed.SPMicroFeed.$38);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,j);var n=this;$addHandler(j,"click",function(){n.$5a_0(b,a,null);n.clearDefaultTextInPostBoxIfNeeded(a)});c.appendChild(j);c.appendChild(i);c.appendChild(SP.UI.MicroFeed.SPMicroFeed.createClearFloatsDiv());if(!SP.UI.MicroFeed.SPMicroFeed.$s){var o=this,p=this;$addHandlers(a,{keyup:function(){o.$w_0(a,e,b,o.$G_0)},change:function(){p.$w_0(a,e,b,p.$G_0)}})}var q=this,r=this,z=this,A=this,B=this;$addHandlers(a,{cut:function(){q.$2Z_0(a,e,b,q.$G_0)},paste:function(){r.$2Z_0(a,e,b,r.$G_0)},keyup:function(){SP.UI.MicroFeed.SPMicroFeed.$1w(a,null)},click:function(){SP.UI.MicroFeed.SPMicroFeed.$1w(a,null)},focus:function(){SP.UI.MicroFeed.SPMicroFeed.$1w(a,null)}});var s=this,t=new SP.UI.MicroFeed.AtMention(a,3,function(){s.$7p_0(a,b,d,e,s.$G_0)});SP.UI.MicroFeed.SPMicroFeed.$N[a.id]=t;var C=this;$addHandler(a,"keydown",function(b){SP.UI.MicroFeed.SPMicroFeed.$7q(b,a.id,true)});this.$8x_0(a,t);return c},$8x_0:function(a,b){if(this.$3F_0!==""&&this.$3E_0!==""){a.value="";b.addTextAreaElement(1,this.$3E_0,this.$3F_0,false);a.value=a.value+" "}if(this.$3J_0!==""&&this.$3I_0!==""){if(a.value===this.$G_0)a.value="";b.addTextAreaElement(2,this.$3J_0,this.$3I_0,false);a.value=a.value+" "}},$7y_0:function(d,c){if(SP.UI.MicroFeed.SPMicroFeed.$1v&&SP.UI.MicroFeed.SPMicroFeed.$1v.length>0){var a=new SP.UI.MySiteCommon.MySiteMenuItem(null);a.set_enabled(false);a.set_text(SpsClient.ScriptResources.teamSiteDropDownDescriptionText);c.appendMenuItem(a);for(var b=0;b<SP.UI.MicroFeed.SPMicroFeed.$1v.length;b++)this.$87_0(SP.UI.MicroFeed.SPMicroFeed.$1v[b],d,c);return true}return false},$87_0:function(b,d,g){if(!b)return;var c=b.get_name(),f=b.get_id(),e=this,a=new SP.UI.MySiteCommon.MySiteMenuItem(function(){e.$M_0=f;d.setAttribute("targetDisplayName",c);d.focus()});a.set_enabled(true);a.set_text(c);g.appendMenuItem(a)},clearDefaultTextInPostBoxIfNeeded:function(a){if(a&&a.value===this.$G_0)a.value=""},incrementNewPostCount:function(){this.$4r_0++},$2W_0:function(a,c,e){if(!a||!c)return;var b=a.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$Y),d=(b===""||!!b)&&SP.UI.MicroFeed.SPMicroFeed.$H[b];if((c.value.trim().length>0&&c.value!==e||d)&&SP.UI.MicroFeed.SPMicroFeed.get_$D()&&this.$1j_0)a.disabled=false;else a.disabled=true},$3v_0:function(c){var a=0;this.$3H_0=!c;var b=document.getElementsByName(SP.UI.MicroFeed.SPMicroFeed.$38);for(a=0;a<b.length;a++)b[a].disabled=!c},$5d_0:function(g,h,a){var b=document.createElement("div");b.id=!a?SP.UI.MicroFeed.SPMicroFeed.$2R:SP.UI.MicroFeed.SPMicroFeed.$2B+a;b.className=!a?"ms-microfeed-attachmentPreviewDiv":"ms-microfeed-attachmentReplyPreviewDiv";var f=document.createElement("div");f.className=SP.UI.MicroFeed.SPMicroFeed.$3W;var c=document.createElement("a");c.id="ms-microfeed-cancelImageAttachmentLink"+(!a?"":"_"+a);c.className=SP.UI.MicroFeed.SPMicroFeed.$3W+" "+SP.UI.MicroFeed.SPMicroFeed.$3V;c.href="#";c.setAttribute("onclick","return false;");var e=document.createElement("img");e.id="ms-microfeed-cancelImageAttachmentLinkImage"+(!a?"":"_"+a);e.src=SP.UI.MicroFeed.SPMicroFeed.get_$1H();e.className=SP.UI.MicroFeed.SPMicroFeed.$3U;c.appendChild(e);var d=this;$addHandler(c,"click",function(){SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,b);var e=SP.UI.MicroFeed.SPMicroFeed.$H[a?a:""];if(e){var c;switch(e.get_attachmentKind()){case 0:c=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$3N:SP.UI.MicroFeed.SPMicroFeed.$2u+a);break;default:c=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$2N:SP.UI.MicroFeed.SPMicroFeed.$2C+a)}c&&b.removeChild(c)}d.$3v_0(true);delete SP.UI.MicroFeed.SPMicroFeed.$H[a?a:""];SP.UI.MicroFeed.SPMicroFeed.handleChangesToElementsDiv(b.parentNode);d.$2W_0(h,g,!a?d.$G_0:d.$P_0);g.focus()});f.appendChild(c);b.appendChild(f);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,b);return b},$5a_0:function(b,c,d){var a=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){var e="SelectPicture2.aspx?Type=User&FeedAttachment=true";a.$9P_0(SP.Utilities.Utility.getLayoutsPageUrl(e),b,c,d)})},$9P_0:function(d,e,f,b){if(!SP.UI.MicroFeed.SPMicroFeed.$H[b?b:""]){var a=new SP.UI.DialogOptions;a.autoSizeStartWidth=410;a.autoSize=true;a.url=d;var c=this;a.dialogReturnValueCallback=function(g,h){if(g===1){var a=h.split("|");if(!a||a.length!==3)return;var i=a[0],j=a[1],k=a[2],d=new SP.Social.SocialAttachment;d.set_attachmentKind(0);d.set_uri(i);d.set_previewUri(j);d.set_name(k);c.displayAttachmentPreview(e,f,d,b)}};SP.UI.ModalDialog.showModalDialog(a)}},displayAttachmentPreview:function(d,f,c,a){var e=$get(!a?SP.UI.MicroFeed.SPMicroFeed.$2R:SP.UI.MicroFeed.SPMicroFeed.$2B+a),b=null;switch(c.get_attachmentKind()){case 0:b=SP.UI.MicroFeed.SPMicroFeed.$8L(c,a);break;case 1:b=SP.UI.MicroFeed.MicroFeedVideo.$5n(c,a);break;case 2:b=SP.UI.MicroFeed.MicroFeedDoc.$5j(c,a)}this.$3v_0(false);if(e&&b){SP.UI.MySiteCommon.CommonUIElements.display(e);SP.UI.MicroFeed.SPMicroFeed.$1z(b,e,null,true)}if(d){SP.UI.MySiteCommon.CommonUIElements.display(d);SP.UI.MySiteCommon.CommonUIElements.display(d);this.$2W_0(d,f,!a?this.$G_0:this.$P_0)}SP.UI.MicroFeed.SPMicroFeed.$H[a?a:""]=c;if(f){SP.UI.MicroFeed.SPMicroFeed.handleChangesToElementsDiv(e.parentNode);f.focus()}},$7p_0:function(a,b,c,d,e){this.$20_0(a);this.$w_0(a,d,b,e);SP.UI.MicroFeed.SPMicroFeed.handleChangesToElementsDiv(c)},$9S_0:function(){this.$2I_0=true;this.$7X_0()},$7X_0:function(){window.clearInterval(this.$3C_0);var b=Math.max(new Date-this.$4q_0,0),a=this.$4s_0*6e4-b;if(a<=0){$get(SP.UI.MicroFeed.SPMicroFeed.$1X)&&this.$1y_0()&&this.$9H_0();this.$7n_0()}else this.$3C_0=window.setInterval(this.$$d_$7X_0,a)},$7n_0:function(){this.$2I_0=false;window.clearInterval(this.$3C_0)},$9H_0:function(){var e=this.$5_0[this.$8_0].$f_0,f=this.$E_0[e],c=new SP.UI.MicroFeed.MicrofeedThreadList,b=null,d=false,a=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){var g,h;b=(h=a.$35_0(2,false,g={val:d}),d=g.val,h);SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){if(b){c.setThreadCollection(b,true,a.$1O_0);a.$4s_0=1;a.$5H_0(b);c.appendThreadList(f);a.$E_0[e]=c;a.updateNewPostNotifications()}d&&a.$1x_0(b.get_unreadMentionCount())},function(){a.$4s_0++})})},$5H_0:function(a){if(a.get_threads()&&a.get_threads().length>0&&a.get_threads()[0]&&a.get_threads()[0].get_rootPost())this.$1k_0=a.get_threads()[0].get_rootPost().get_modifiedTime()},$2Z_0:function(a,f,g,h){var d=a.value,e=0,b=0,c=this;b=window.setInterval(function(){if(a.value!==d){window.clearInterval(b);c.$w_0(a,f,g,h);c.$20_0(a)}e++>100&&window.clearInterval(b)},50)},$w_0:function(b,a,d,e){if(!b)return;if(a&&b.value.length>.9*512){var c=512-b.value.length;SP.UI.MySiteCommon.CommonUIElements.display(a);a.innerHTML=STSHtmlEncode(c.localeFormat("n0"));if(c<0)a.className=a.className.replace(SP.UI.MicroFeed.SPMicroFeed.$2O,SP.UI.MicroFeed.SPMicroFeed.$50);else a.className=a.className.replace(SP.UI.MicroFeed.SPMicroFeed.$50,SP.UI.MicroFeed.SPMicroFeed.$2O)}else SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,a);d&&this.$2W_0(d,b,e)},$8Y_0:function(){var a=document.createElement("div");a.id=SP.UI.MicroFeed.SPMicroFeed.$1X;a.className=SP.UI.MicroFeed.SPMicroFeed.$6P;if(this.$7_0===1||this.$7_0===2){var b=this;$addHandler(a,"mouseover",function(){b.$7j_0()})}this.$7_0!==2&&a.appendChild(this.$5z_0());if(SP.UI.MicroFeed.SPMicroFeed.$W)this.$8Z_0(a);else{this.$3r_0(a);SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()}return a},$7Z_0:function(a,k,d){var b=!a,c=$get(b?SP.UI.MicroFeed.SPMicroFeed.$1D:SP.UI.MicroFeed.SPMicroFeed.$2x+a);if(!c)return;var e=c.value,f=SP.UI.MicroFeed.SPMicroFeed.$N[SP.UI.MicroFeed.SPMicroFeed.getPostIDFromDOMElementID(c.id)],g=$get(b?SP.UI.MicroFeed.SPMicroFeed.$V:SP.UI.MicroFeed.SPMicroFeed.$y+a),l=b?null:$get(SP.UI.MicroFeed.SPMicroFeed.$25+SP.UI.MicroFeed.SPMicroFeed.$2k+a),h=$get(SP.UI.MicroFeed.SPMicroFeed.$3Q+(b?"":a)),m=$get(b?SP.UI.MicroFeed.SPMicroFeed.$1p:SP.UI.MicroFeed.SPMicroFeed.$1Y+a);if(e.length>512){var j=new SP.UI.MySiteCommon.MySiteDialog(SpsClient.ScriptResources.postTooLongErrorTitle,String.format(SpsClient.ScriptResources.postTooLong,e.length,512));j.set_hideCancelButton(true);j.show();d&&this.displayAttachmentPreview(g,c,d,b?null:a);return}SP.UI.MicroFeed.SPMicroFeed.$1R=false;var i=new SP.Social.SocialPostCreationData;if(f){f.setPostContentAndDataLinks(i);f.reset()}i.set_attachment(d);c.value="";SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,$get(SP.UI.MicroFeed.SPMicroFeed.$1C+(b?"":a)));d&&this.$3v_0(true);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,m);if(g)g.disabled=true;delete SP.UI.MicroFeed.SPMicroFeed.$H[a?a:""];if(h){h.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$1K,"false");SP.UI.MicroFeed.SPMicroFeed.handleChangesToElementsDiv(h)}if(b){c.rows=2;c.focus();SP.UI.MicroFeed.SPMicroFeed.$2X(c)}else this.$9I_0(a,b,l,c);this.$7Y_0(i,e,a,SP.ScriptHelpers.isNullOrEmptyString(k)?SP.UI.MicroFeed.SPMicroFeed.microfeed.$M_0:k)},$8d_0:function(){for(var a=0;a<this.$5_0.length;++a){var d=this.$5_0[a],e=this.$12_0?this.$12_0:d.$u_0,f=a===this.$18_0?this.$1l_0:0,b=new ClientPivotControlMenuOption;b.DisplayText=SP.UI.MicroFeed.SPMicroFeed.$4d(e,f);b.OnClickAction="SP.UI.MicroFeed.SPMicroFeed.microfeed.changeView("+a.toString()+");";this.$T_0.AddMenuOption(b)}var c=this;window.setTimeout(function(){c.$T_0.Render()},0)},$5z_0:function(){var c=document.createElement("div");c.id="ms-titlebararea";if(SP.UI.MicroFeed.SPMicroFeed.$W)return c;c.className="ms-microfeed-titleArea";var b=null,g=SP.UI.MicroFeed.SPMicroFeed.$6g,k=SP.UI.MicroFeed.SPMicroFeed.createProgressDiv(),a=null,d=null,h=null,i=null;if(!this.$7_0){b=document.createElement("div");a=document.createElement("h2");a.id=SP.UI.MicroFeed.SPMicroFeed.$31;a.className="ms-microfeed-feedTitleLabel ms-webpart-titleText";this.$12_0=String.format(SpsClient.ScriptResources.wallViewName,this.$3G_0);a.innerHTML=STSHtmlEncode(this.$12_0);b.appendChild(a);if(SP.UI.MicroFeed.SPMicroFeed.get_$X()&&this.$4u_0===SP.UI.MicroFeed.SPMicroFeed.get_$X().get_accountName()&&!SP.UI.MicroFeed.SPMicroFeed.$5E){d=document.createElement("span");d.id=SP.UI.MicroFeed.SPMicroFeed.$4O;d.className=SP.UI.MicroFeed.SPMicroFeed.$5C+" ms-microfeed-privacyIcon";h=new SP.UI.MySiteCommon.MySitePrivacyIcon(SP.UI.MicroFeed.SPMicroFeed.$4O,SpsClient.ScriptResources.feedPrivacyIcon_Tooltip,this.$1h_0);i=h.render();d.innerHTML=i;b.appendChild(d)}}else if(this.$7_0===1){b=document.createElement("div");var f=document.createElement("div");f.id=SP.UI.MicroFeed.SPMicroFeed.$4X;f.className=SP.UI.MicroFeed.SPMicroFeed.$6j;b.appendChild(f);var e=this;SP.SOD.executeFunc("clienttemplates.js","ClientPivotControl",function(){var a={};a.PivotParentId=SP.UI.MicroFeed.SPMicroFeed.$4X;a.PivotContainerId=SP.UI.MicroFeed.SPMicroFeed.$6i;e.$T_0=new ClientPivotControl(a);e.$T_0.SurfacedPivotCount=3;e.$8d_0()})}else{b=document.createElement("h2");a=document.createElement("a");a.id=SP.UI.MicroFeed.SPMicroFeed.$31;a.className="ms-microfeed-feedTitleLabel ms-headerFont ms-microfeed-siteFeedTitleLabel";this.$12_0=String.format(SpsClient.ScriptResources.siteFeedTitleName);a.innerHTML=STSHtmlEncode(this.$12_0);var l=a;a.setAttribute("href","#");a.setAttribute("onclick","return false;");var j=this;$addHandler(a,"click",function(){j.refreshTheFeed()});b.appendChild(a);g+=" ms-webpart-titleText";c.className="ms-microfeed-siteFeedTitleArea"}b.id=SP.UI.MicroFeed.SPMicroFeed.$6h;b.className=g;b.appendChild(k);b.appendChild(SP.UI.MicroFeed.SPMicroFeed.createClearFloatsDiv());this.$7_0===1&&this.$1x_0(this.$1l_0);c.appendChild(b);return c},resetNewPostNotifications:function(){this.$4r_0=0;this.updateNewPostNotifications()},updateNewPostNotifications:function(){this.$7u_0(this.$8_0,this.$4r_0)},refreshTheFeed:function(){var a=$get(SP.UI.MicroFeed.SPMicroFeed.$1X);if(a){this.$4b_0(true,a,this.$8_0===this.$18_0);this.resetNewPostNotifications()}},$1x_0:function(a){this.$1l_0=a;this.$7u_0(this.$18_0,this.$1l_0)},$7u_0:function(a,d){if(a<0)return;var e=this.$5_0[a],b=this.$12_0?this.$12_0:e.$u_0;if(this.$T_0){this.$T_0.AllOptions[a].DisplayText=SP.UI.MicroFeed.SPMicroFeed.$4d(b,d);this.$T_0.Render()}else{var c=$get(SP.UI.MicroFeed.SPMicroFeed.$31);if(c)c.innerHTML=STSHtmlEncode(SP.UI.MicroFeed.SPMicroFeed.$4d(b,d))}},$3r_0:function(j){if(!j)return;var c=this.$7g_0(),m=this.$5_0[this.$8_0],n=m.$f_0,g=this.$E_0[n],a=document.createElement("div");a.id=SP.UI.MicroFeed.SPMicroFeed.$1J;var o=$get(SP.UI.MicroFeed.SPMicroFeed.$1D),e=document.createElement("div");e.id=SP.UI.MicroFeed.SPMicroFeed.$1W;var f=document.createElement("div");f.id=SP.UI.MicroFeed.SPMicroFeed.$4G;var d=document.createElement("button");d.id="ms-MoreThreadsButtonLabel";var h=document.createElement("span");h.id="ms-MoreThreadsButtonText";var l=null,b,i=0;a.className="ms-microfeed-threadsDiv";b=document.createElement("div");b.id=SP.UI.MicroFeed.SPMicroFeed.$4a;b.className=SP.UI.MicroFeed.SPMicroFeed.$6l;b.innerHTML=this.$5_0[this.$8_0].$2l_0;c.appendChild(b);if(SP.ScriptHelpers.isNullOrEmptyString(b.innerHTML))SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,b);else SP.UI.MySiteCommon.CommonUIElements.display(b);if(!g){a.appendChild(this.$22_0(true));c.appendChild(a);j.appendChild(c);SP.UI.MicroFeed.SPMicroFeed.$24(null,true);this.$14_0=true;return}else if(!g.sizeAfterRemovingRecentDeletions())a.appendChild(this.$22_0(false));else{i=this.$5y_0(a,g,0,SP.UI.MicroFeed.SPMicroFeed.$1F);!i&&a.appendChild(this.$22_0(false))}c.appendChild(a);this.$1j_0=true;e.className=SP.UI.MicroFeed.SPMicroFeed.$6M;f.className=SP.UI.MicroFeed.SPMicroFeed.$6N;d.className=SP.UI.MicroFeed.SPMicroFeed.$d+" "+SP.UI.MicroFeed.SPMicroFeed.$5C+" ms-commandLink";d.setAttribute("type","button");h.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.seeMorePostsText);d.appendChild(h);e.appendChild(d);f.appendChild(e);var k=this;$addHandler(d,"click",function(){var f=a.children,b=null,c=0,d=0,e=parseInt(a.getAttribute("numHiddenThreads"));if(e>0)for(d=0;d<f.length&&c<SP.UI.MicroFeed.SPMicroFeed.$1F;d++){b=f[d];if(b&&SP.UI.MySiteCommon.CommonUIElements.isEntirelyHidden(b)&&b.getAttribute("deleted")!=="true")if(k.$3g_0(b)){c++;SP.UI.MySiteCommon.CommonUIElements.display(b)}}e=e-c;a.setAttribute("numHiddenThreads",""+e);c<SP.UI.MicroFeed.SPMicroFeed.$1F&&k.$3e_0(a,SP.UI.MicroFeed.SPMicroFeed.$1F-c,0)});!i&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,e);c.appendChild(f);c.appendChild(SP.UI.MicroFeed.SPMicroFeed.createClearFloatsDiv());j.appendChild(c);this.$8_0===this.$18_0&&this.$7t_0();SP.UI.MicroFeed.SPMicroFeed.$24(null,true);l=$get(SP.UI.MicroFeed.SPMicroFeed.$V);this.$2W_0(l,o,this.$G_0);ProcessImn();this.$7j_0()},$7j_0:function(){var a=this.$1y_0();if(a&&!this.$2I_0)this.$9S_0();else!a&&this.$2I_0&&this.$7n_0()},$7g_0:function(){var a=$get(SP.UI.MicroFeed.SPMicroFeed.$26),b=$get(SP.UI.MicroFeed.SPMicroFeed.$V);if(a)a.innerHTML="";else{a=document.createElement("div");a.id=SP.UI.MicroFeed.SPMicroFeed.$26;a.style.left="0px";a.style.right="0px"}if(b){var c=b.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$Y);this.$3H_0=!!SP.UI.MicroFeed.SPMicroFeed.$H[c]}else this.$3H_0=false;return a},$8Z_0:function(c){var d=this.$7g_0(),b=document.createElement("div");b.id=SP.UI.MicroFeed.SPMicroFeed.$1J;if(this.$4v_0){var a=document.createElement("div");a.id=SP.UI.MicroFeed.SPMicroFeed.$34;a.className="ms-microfeed-unsubscribe ms-textXLarge";a.innerHTML=String.format(STSHtmlEncode(SpsClient.ScriptResources.unsubscribeConfirmationText),SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag(SP.UI.MicroFeed.SPMicroFeed.$4Z,"","#",'onclick="return false;"'),"</a>");var e=a.getElementsByTagName("a")[0];$addHandler(e,"click",this.$$d_$9W_0);c.insertBefore(a,c.firstChild)}b.appendChild(this.$2i_0(SP.UI.MicroFeed.SPMicroFeed.$1T,false,false,true));ProcessImn();d.appendChild(b);c.appendChild(d);this.$14_0=true;this.$1j_0=true},$9W_0:function(){if(!SP.UI.MicroFeed.SPMicroFeed.$1T)return;var a=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){SP.UI.MicroFeed.SPMicroFeed.get_$D().suppressThreadNotifications(SP.UI.MicroFeed.SPMicroFeed.$1T.get_id());SP.UI.MicroFeed.SPMicroFeed.showProgressSpinner();SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(a.$$d_$9Y_0,a.$$d_$9X_0)})},$9Y_0:function(){SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner();var a=$get(SP.UI.MicroFeed.SPMicroFeed.$34);a.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.unsubscribeSuccess)},$9X_0:function(){SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner();var a=$get(SP.UI.MicroFeed.SPMicroFeed.$34);a.innerHTML=String.format(STSHtmlEncode(SpsClient.ScriptResources.unsubscribeFailure),SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag(SP.UI.MicroFeed.SPMicroFeed.$4Z,"","#",'onclick="return false;"'),"</a>");var b=a.getElementsByTagName("a")[0];$addHandler(b,"click",this.$$d_$9W_0)},$5y_0:function(d,g,k,j){if(!d||!g||!g.sizeAfterRemovingRecentDeletions())return 0;for(var a=null,e=0,b=null,f=0,c=false,i=null,h=k;h<g.size();h++){a=g.get(h);if(!a.get_rootPost()||!a.get_actors())continue;b=$get(SP.UI.MicroFeed.SPMicroFeed.$10+a.get_id());if(b){c=true;i=new Date(Date.parse(b.getAttribute("LastModificationTime")));if(i>a.get_rootPost().get_modifiedTime())b=this.$3t_0(a,e>=j,b,false,null,false)}else b=this.$2i_0(a,e>=j,false,false);!c&&d.appendChild(b);if(!SP.UI.MySiteCommon.CommonUIElements.isEntirelyHidden(b)){if(!c)e++}else if(!c)f++;c=false;if(this.$1A_0>a.get_rootPost().get_modifiedTime())this.$1A_0=a.get_rootPost().get_modifiedTime()}if(d.getAttribute("numHiddenThreads"))f=parseInt(d.getAttribute("numHiddenThreads"))+f;d.setAttribute("numHiddenThreads",f);return e},$22_0:function(b){if(b){var a=!SP.ScriptHelpers.isNullOrEmptyString(this.$3B_0)?String.format(SpsClient.ScriptResources.genericErrorMessage,this.$3B_0):"";return SP.UI.MicroFeed.SPMicroFeed.drawEmptyFeedThreadWithGivenMessage(STSHtmlEncode(SpsClient.ScriptResources.emptyFeedDueToError),a)}else return SP.UI.MicroFeed.SPMicroFeed.drawEmptyFeedThreadWithGivenMessage(this.$5_0[this.$8_0].$3u_0,"")},$8f_0:function(c,e){var a=c.$3_0,b=this.createThreadDiv(null,a,e,true),d=document.createElement("div");d.id=SP.UI.MicroFeed.SPMicroFeed.$1b+a;d.className=SP.UI.MicroFeed.SPMicroFeed.$30;c.$1_0=3;c.$9_0=a;d.appendChild(this.$x_0(c));b.appendChild(d);b.appendChild(this.$3s_0(null,a,false,true,false,false));b.appendChild(this.$5w_0(0,false,a,a,c.$B_0?c.$B_0.get_name():""));b.appendChild(SP.UI.MicroFeed.SPMicroFeed.createClearFloatsDiv());b.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$t,0);return b},$9O_0:function(e){for(var c=this.$5_0[this.$8_0],d=SP.Social.SocialThreadType.toString(e.get_threadType()),a,b=0;b<c.get_numVisiblePosts();b++){a=c.visiblePostAttribute(b);if(a.$39_0===d)if(a.$3h_0==="true")return true}return false},$3g_0:function(e){for(var c=this.$5_0[this.$8_0],d="",a,b=0;b<c.get_numVisiblePosts();b++){a=c.visiblePostAttribute(b);d=e.getAttribute(a.$39_0);if(d===a.$3h_0)return true}return false},$2i_0:function(a,i,j,k){var d=a.get_id(),b=this.createThreadDiv(a,d,i,j),e=a.get_replies().length,g=a.get_totalReplyCount(),f=0,c=null,h=null;b.appendChild(this.$8e_0(a,j,d));if(SP.UI.MicroFeed.SPMicroFeed.$4i(a.get_rootPost()))f++;if(a.get_postReference()&&a.get_postReference().get_digest()){g=a.get_postReference().get_digest().get_totalReplyCount();e=a.get_postReference().get_digest().get_replies().length}var l=a.get_actors()[a.get_rootPost().get_authorIndex()];if(!SP.UI.MicroFeed.SPMicroFeed.$1d(l)){h=this.$84_0(a,i,d,b,e,g,k);c=this.$3s_0(a,d,false,e>=g&&e<=2||k,a.get_threadType()===1||a.get_threadType()===2?true:false,false);(!e||!(c.hasChildNodes()||h&&h.hasChildNodes()))&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,c);f+=parseInt(c.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$t));c.removeAttribute(SP.UI.MicroFeed.SPMicroFeed.$t);b.appendChild(c);if(a.get_threadType()===1)f++;SP.UI.MicroFeed.SPMicroFeed.$5O(b,f,true);this.$3g_0(b)&&!i&&SP.UI.MySiteCommon.CommonUIElements.display(b);b.appendChild(this.$5x_0(a,d))}b.appendChild(SP.UI.MicroFeed.SPMicroFeed.createClearFloatsDiv());return b},$5x_0:function(a,f){var b=a;if((a.get_threadType()===1||a.get_threadType()===2||a.get_threadType()===4)&&a.get_postReference()&&a.get_postReference().get_digest())b=a.get_postReference().get_digest();var e=SP.UI.MicroFeed.SPMicroFeed.$8U(b),c=b.get_actors()[b.get_ownerIndex()],d="";if(c&&c.get_actorType())d=c.get_name();return this.$5w_0(e,b.get_replies().length>0,f,b.get_id(),d)},$84_0:function(b,g,e,c,h,f,i){var a=null,d=false;if(!i)if(b.get_threadType()&&b.get_postReference()&&!b.get_postReference().get_digest()){a=this.$5Y_0(b,e,c,g,h,f,true);d=true}else if(f>2){a=this.$5Y_0(b,e,c,g,h,f,false);d=true}a&&c.appendChild(a);d&&c.appendChild(SP.UI.MicroFeed.SPMicroFeed.$7w(e));return a},$8e_0:function(c,d,e){var a=document.createElement("div");a.id=SP.UI.MicroFeed.SPMicroFeed.$1b+e;a.className=SP.UI.MicroFeed.SPMicroFeed.$30;var b=SP.UI.MicroFeed.MicrofeedEntry.createRootPostFromThread(c);if(!b)return a;if(d)b.$1_0=6;a.appendChild(this.$x_0(b));return a},$5Y_0:function(a,j,e,k,l,m,g){var f=false;if(g)for(var d=e.getElementsByTagName("a"),i=SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost(a,a.get_rootPost()),b=null,c=0;c<d.length;c++)if(d[c].getAttribute("name")==="fullyOrphaned"){b=d[c];var h=this;$addHandler(b,"click",function(){if(a.get_postReference()&&a.get_postReference().get_threadId()){b.innerHTML="";b.appendChild(SP.UI.MySiteCommon.CommonUIElements.createProcessingIcon(SP.UI.MicroFeed.SPMicroFeed.$2m+a.get_postReference().get_threadId(),SP.UI.MicroFeed.SPMicroFeed.$2r));h.$36_0(a.get_postReference().get_threadId(),false,true,e,i)}});f=true;return null}return!f?this.$8R_0(g,j,a,e,m,l,k):null},$8R_0:function(o,c,d,h,i,l,m){var b=document.createElement("div");b.id=SP.UI.MicroFeed.SPMicroFeed.$4B+c;var a=document.createElement("button"),e=document.createElement("span");e.id="ms-moreRepliesText_"+c;var f=document.createElement("span");f.id=SP.UI.MicroFeed.SPMicroFeed.$2o+c;var g=document.createElement("img");g.id=SP.UI.MicroFeed.SPMicroFeed.$4C+c;var k=SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost(d,d.get_rootPost());b.className=SP.UI.MicroFeed.SPMicroFeed.$2A;a.setAttribute("type","button");a.className=SP.UI.MicroFeed.SPMicroFeed.$d;f.className=SP.UI.MicroFeed.SPMicroFeed.$4F;a.appendChild(f);g.className=SP.UI.MicroFeed.SPMicroFeed.$2p;g.setAttribute("src",SP.UI.MicroFeed.SPMicroFeed.get_$1H());f.appendChild(g);e.className="ms-microfeed-moreRepliesText";if(o){b.className=b.className+" "+SP.UI.MicroFeed.SPMicroFeed.$6L;a.id="ms-OrphanContent_"+c;e.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.viewFullThreadText);var n=this;$addHandler(a,"click",function(){a.innerHTML="";a.appendChild(SP.UI.MySiteCommon.CommonUIElements.createProcessingIcon(SP.UI.MicroFeed.SPMicroFeed.$2m+d.get_postReference().get_threadId(),SP.UI.MicroFeed.SPMicroFeed.$2r));n.$36_0(d.get_postReference().get_threadId(),false,true,h,k)})}else{b.className=b.className+" "+SP.UI.MicroFeed.SPMicroFeed.$4E;a.className=a.className+" "+SP.UI.MicroFeed.SPMicroFeed.$4D;a.id=SP.UI.MicroFeed.SPMicroFeed.$6K+c;e.innerHTML=STSHtmlEncode(String.format(SpsClient.ScriptResources.viewRepliesText,i));var j=this;$addHandler(a,"click",function(){SP.UI.MicroFeed.SPMicroFeed.$5L(c);if(d.get_threadType())j.$7R_0(d.get_postReference().get_threadId(),l,i,m,h,k);else j.$7R_0(c,l,i,m,h,null)})}a.appendChild(e);b.appendChild(a);return b},$3t_0:function(a,i,b,j,h,k){var c="",e=null,f=null,d=null,g=0;if(b){c=b.id.substr(b.id.lastIndexOf("_")+1);e=$get(SP.UI.MicroFeed.SPMicroFeed.$1b+c);b.setAttribute("LastModificationTime",a.get_rootPost().get_modifiedTime());e.innerHTML="";d=SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost(a,a.get_rootPost());d.$1_0=1;d.$6_0=h;d.$9_0=c;e.appendChild(this.$x_0(d));if(SP.UI.MicroFeed.SPMicroFeed.$4i(a.get_rootPost()))g++;f=this.$3s_0(a,c,!j,false,h?true:false,k);g+=parseInt(f.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$t));f.removeAttribute(SP.UI.MicroFeed.SPMicroFeed.$t);SP.UI.MicroFeed.SPMicroFeed.$5O(b,g,true);this.$5x_0(a,c)}else b=this.$2i_0(a,i,false,false);ProcessImn();return b},$3s_0:function(f,i,l,m,n,o){var a=$get(SP.UI.MicroFeed.SPMicroFeed.$z+i),b=null,c=null,j=0,k=0,g=0,e=null,h=null,d=f;if(!a){a=document.createElement("div");a.id=SP.UI.MicroFeed.SPMicroFeed.$z+i}if(!l)a.innerHTML="";a.className=SP.UI.MicroFeed.SPMicroFeed.$2A+" ms-microfeed-repliesDiv";m&&a.setAttribute("expanded","true");if(f&&f.get_postReference()&&f.get_postReference().get_digest())d=f.get_postReference().get_digest();if(d&&d.get_replies())for(g=0;g<d.get_replies().length;g++){h=d.get_replies()[g];b=$get(SP.UI.MicroFeed.SPMicroFeed.$29+h.get_id());c=SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost(d,h);c.$9_0=i;if(b&&d.get_id()===i){if(o){c.$1_0=2;e=this.$x_0(c);b.parentNode.insertBefore(e,b);SP.UI.MySiteCommon.CommonUIElements.isEntirelyHidden(b)&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,e);b.parentNode.removeChild(b)}continue}if(n)c.$1_0=8;else c.$1_0=2;e=this.$x_0(c);(k>=2||l)&&!m&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,e);if(SP.UI.MicroFeed.SPMicroFeed.$4i(h))j++;a.insertBefore(e,a.firstChild);k++}a.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$t,j);return a},createThreadDiv:function(a,c,e,d){var b=SP.UI.MicroFeed.SPMicroFeed.createThreadDivWithoutHiding(a,c);!d&&(e||a&&!this.$9O_0(a))&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,b);return b},$7R_0:function(a,b,c,d,e,f){if(c!==b)this.$36_0(a,d,true,e,f);else SP.UI.MicroFeed.SPMicroFeed.$5v(a)},$x_0:function(a){if(!a)return document.createElement("div");if(!a.$F_0)a.$F_0=a.$1_0===3||a.$1_0===1||a.$1_0===6||a.$1_0===11||a.$1_0===10;if(a.$1_0===8||a.$F_0&&a.$6_0)a.$4_0=a.$9_0+"_"+a.$3_0;var b=SP.UI.MicroFeed.SPMicroFeed.$71(a);a.$J_0&&b.appendChild(this.$5q_0(a,b));a.$6_0&&b.appendChild(SP.UI.MicroFeed.SPMicroFeed.$8I(a));if(!SP.UI.MicroFeed.SPMicroFeed.$1e(a))b.appendChild(this.$8J_0(a,b));else if(a.$1_0!==12){var c=document.createElement("div");c.id=SP.UI.MicroFeed.SPMicroFeed.$2n+a.$4_0;c.className="ms-microfeed-oneLiner";c.appendChild(this.$5U_0(a,b));b.appendChild(c)}return b},$5q_0:function(a,c){var b=document.createElement("div");b.id="ms-rightAlignedDiv_"+a.$4_0;b.className=SP.UI.MicroFeed.SPMicroFeed.$7P;if(a.$1_0===3||a.$1_0===4)b.appendChild(SP.UI.MySiteCommon.CommonUIElements.createProcessingIcon("ms-PendingUploadImage_"+a.$4_0,SP.UI.MicroFeed.SPMicroFeed.$2r));else a.$1_0!==12&&a.$1_0!==11&&this.$K_0&&this.$8B_0(b,a,c);return b},$8B_0:function(c,a,d){var b=null,e=false;if(a.$6_0)this.$8C_0(c,a,d);else if(a.$1_0===9&&a.$Z_0)c.appendChild(this.$3j_0(true,a.$4_0,a.$3_0,a.$F_0,d,a.$A_0,a.$1_0,a.$9_0,false));else if(!a.$J_0&&!SP.UI.MicroFeed.SPMicroFeed.$1e(a)){if(a.$Z_0&&SP.UI.MicroFeed.SPMicroFeed.$1L(a)&&!(a.$1_0===9)){e=true;b=a.$A_0}else if(a.$F_0&&a.$1_0!==3&&this.$8_0===this.$1i_0)if(a.$B_0&&a.$B_0.get_isFollowed())b=a.$B_0;else if((a.$k_0||SP.UI.MicroFeed.SPMicroFeed.$1d(a.$A_0))&&!SP.UI.MicroFeed.SPMicroFeed.$1L(a))b=a.$A_0;else return;else return;c.appendChild(this.$3j_0(e,a.$4_0,a.$3_0,a.$F_0,d,b,a.$1_0,a.$9_0,a.get_isActivityPost()))}},$8C_0:function(c,a,d){var b=false;if(!a.$6_0)return;if(a.$6_0.$Z_0&&SP.UI.MicroFeed.SPMicroFeed.$1L(a.$6_0))if(a.$6_0.$1_0===10||a.$J_0&&a.$6_0.$1_0===9)b=true;else return;else if(!a.$J_0||!a.$6_0.$k_0||SP.UI.MicroFeed.SPMicroFeed.$1L(a.$6_0)||this.$8_0!==this.$1i_0)return;c.appendChild(this.$3j_0(b,a.$4_0,a.$6_0.$3_0,a.$F_0,d,a.$6_0.$A_0,a.$6_0.$1_0,a.$9_0,false))},$8J_0:function(a,e){var c=document.createElement("div");c.id=SP.UI.MicroFeed.SPMicroFeed.$4K+a.$4_0;var b=document.createElement("div");b.id=SP.UI.MicroFeed.SPMicroFeed.$2n+a.$4_0;if(a.$1g_0)c.className=SP.UI.MicroFeed.SPMicroFeed.$6S;else if(a.$6_0)c.className="ms-microfeed-indentRootRef";c.innerHTML=SP.UI.MicroFeed.SPMicroFeed.$5e(a.$4_0,a,a.$A_0,true);if(a.$n_0===2)b.className="ms-microfeed-oneLiner";else if(a.$F_0&&!a.$1g_0)b.className="ms-microfeed-rootBody";else b.className="ms-microfeed-replyBody";!a.$J_0&&b.appendChild(this.$5q_0(a,e));b.appendChild(SP.UI.MicroFeed.SPMicroFeed.$5p(a,a.$4_0,a.$F_0?"ms-microfeed-rootText":"ms-microfeed-replyText",a.$F_0,a.$1_0,this.$7_0===2?true:false));if(a.$I_0){var d=null;switch(a.$I_0.get_attachmentKind()){case 0:d=SP.UI.MicroFeed.SPMicroFeed.$5k(a.$I_0,a.$4_0,"ms-microfeed-attachmentImage");break;case 1:d=SP.UI.MicroFeed.MicroFeedVideo.$5l(a.$I_0,a.$4_0);break;case 2:d=SP.UI.MicroFeed.MicroFeedDoc.$5h(a.$I_0,a.$4_0)}d&&b.appendChild(d)}a.$1_0!==12&&b.appendChild(this.$5U_0(a,e));b.appendChild(SP.UI.MicroFeed.SPMicroFeed.createClearFloatsDiv());c.appendChild(b);return c},$3j_0:function(i,d,p,j,k,e,c,l,m){if(!i&&!e.get_canFollow())return document.createElement("div");var f=document.createElement("div");f.id=SP.UI.MicroFeed.SPMicroFeed.$6D+d;var a=document.createElement("div");a.id=SP.UI.MicroFeed.SPMicroFeed.$3y+d;a.style.width="24px";a.style.height="24px";var g=document.createElement("img"),b=document.createElement("button");b.id=SP.UI.MicroFeed.SPMicroFeed.$3x+d;var h=document.createElement("span");if(i)if(m||c===9||c===10)b.title=SpsClient.ScriptResources.hideActivityTitleText;else b.title=j?SpsClient.ScriptResources.deleteRootTitleText:SpsClient.ScriptResources.deleteReplyTitleText;else if(e)b.title=String.format(!e.get_actorType()?SpsClient.ScriptResources.stopFollowingAuthorTitleText:SpsClient.ScriptResources.stopFollowingObjectTitleText,e.get_name());a.className=SP.UI.MicroFeed.SPMicroFeed.$6C;b.className=SP.UI.MicroFeed.SPMicroFeed.$d+" "+SP.UI.MicroFeed.SPMicroFeed.$7N;h.className=SP.UI.MicroFeed.SPMicroFeed.$3V;g.setAttribute("src",SP.UI.MicroFeed.SPMicroFeed.get_$1H());g.className=SP.UI.MicroFeed.SPMicroFeed.$3U;b.setAttribute("type","button");if(i){var n=this;$addHandler(b,"click",function(){n.$5t_0(d,p,j,c,l,m)})}else{var o=this;$addHandler(b,"click",function(){o.$6w_0(d,j,e,l)})}h.appendChild(g);b.appendChild(h);a.appendChild(b);f.appendChild(a);if(!(c===6||c===7||c===10)){SP.UI.MySiteCommon.CommonUIElements.setDisplayNoneAndTabbable(true,a);a.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$2G,"false");a.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$2F,"false");var q=this;$addHandler(k,"mouseover",function(){a.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$2G,"true");SP.UI.MySiteCommon.CommonUIElements.displayForTabbable(a)});var r=this;$addHandler(k,"mouseout",function(){a.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$2G,"false");a.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$2F)!=="true"&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNoneAndTabbable(true,a)});var s=this;$addHandler(b,"focus",function(){a.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$2F,"true");SP.UI.MySiteCommon.CommonUIElements.displayForTabbable(a)});var t=this;$addHandler(b,"blur",function(){a.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$2F,"false");a.getAttribute(SP.UI.MicroFeed.SPMicroFeed.$2G)!=="true"&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNoneAndTabbable(true,a)})}return f},$86_0:function(a,h,d,i,e,j){var b=new SP.UI.MicroFeed.MicrofeedMenu("microfeed-moreDropDownMenu_"+d,"span","socialcommon.png",SpsClient.ScriptResources.titleTextForMoreDropDown,false,SP.UI.MicroFeed.SPMicroFeed.$4L,"ms-microfeed-mysitemenu-ellipsisImage","ms-core-menu-root","ms-microfeed-mysitemenu-ellipsisImageParent"),c=0;if(SP.UI.MicroFeed.SPMicroFeed.$1e(a))return null;if(a.$O_0&&a.$O_0.length&&(a.$j_0||a.$i_0||a.$l_0)&&!SP.UI.MicroFeed.SPMicroFeed.$W){var k=this;b.addRootPostDropDownItem(SpsClient.ScriptResources.copyThreadLinkRootDropDownText,function(){SP.UI.MicroFeed.SPMicroFeed.$9U(a,d,i)});c++}if(SP.UI.MicroFeed.SPMicroFeed.$5T(b,a))c++;if(a.$1M_0&&this.$K_0)if(!a.$l_0){var f=this;b.addRootPostDropDownItem(SpsClient.ScriptResources.lockThreadDropDownText,function(){f.$79_0(e,a.$3_0,true,a.$6_0)});c++}else{var g=this;b.addRootPostDropDownItem(SpsClient.ScriptResources.unlockThreadDropDownText,function(){g.$79_0(e,a.$3_0,false,a.$6_0)});c++}if(this.$K_0)if(this.$5R_0(b,a,h,d,e))c++;c>0&&b.addSeparator();c+=SP.UI.MicroFeed.SPMicroFeed.$5S(b,a.$S_0,j);if(this.$80_0(b,a,d,e))c++;return c>0?b.render():null},$5R_0:function(c,a,d,e,f){if((a.$Z_0||this.$7A_0)&&!(a.$1_0===9||a.$1_0===10)&&!SP.UI.MicroFeed.SPMicroFeed.$1L(a)){var b=this;c.addRootPostDropDownItem(SpsClient.ScriptResources.deleteRootDropDownText,function(){b.$5t_0(e,a.$3_0,a.$F_0,d,f,false)});return true}return false},$80_0:function(c,a,d,e){if(this.$8_0===this.$1i_0)if(a.$B_0&&a.$B_0.get_isFollowed()&&a.$B_0.get_id()!==a.$A_0.get_id()&&SP.UI.MicroFeed.SPMicroFeed.$1L(a)){var b=this;c.addRootPostDropDownItem(SP.UI.MicroFeed.SPMicroFeed.$8T(a.$B_0),function(){b.$6w_0(d,true,a.$B_0,e)});return true}return false},$85_0:function(c,d,e){var a=new SP.UI.MicroFeed.MicrofeedMenu("microfeed-moreDropDownMenu_"+d,"span","socialcommon.png",SpsClient.ScriptResources.titleTextForMoreDropDown,false,SP.UI.MicroFeed.SPMicroFeed.$4L,"ms-microfeed-mysitemenu-ellipsisImage","ms-core-menu-root","ms-microfeed-mysitemenu-ellipsisImageParent"),b=0;if(this.$K_0)if(this.$5R_0(a,c,c.$1_0,d,c.$9_0))b++;if(SP.UI.MicroFeed.SPMicroFeed.$5T(a,c))b++;b>0&&a.addSeparator();b+=SP.UI.MicroFeed.SPMicroFeed.$5S(a,c.$S_0,e);return b>0?a.render():null},$5t_0:function(e,j,f,g,h,k){var a="",b=SpsClient.ScriptResources.deleteConfirmationDialogButtonText,d=g===9,c=f||d;if(k||d){a=SpsClient.ScriptResources.deleteRefConfirmationText;b=SpsClient.ScriptResources.hideConfirmationDialogButtonText}else if(f)if(g===10){a=SpsClient.ScriptResources.deleteRefMentionConfirmationText;b=SpsClient.ScriptResources.removeConfirmationDialogButtonText}else a=SpsClient.ScriptResources.deleteRootConfirmationText;else a=SpsClient.ScriptResources.deleteReplyConfirmationText;var i=this;SP.UI.MicroFeed.SPMicroFeed.$2g(e,h,c,a,"",b,"",function(){i.$3p_0(c?h:e,j,c)})},$6w_0:function(f,g,b,h){if(!b)return;var c="",d="",a=b.get_name(),e=a;if(a.length>=15)e=String.format(SpsClient.ScriptResources.moreContentEllipsesNoSpace,a.substr(0,15));if(!b.get_actorType()){c=String.format(SpsClient.ScriptResources.hideConfirmationText,a);d=String.format(SpsClient.ScriptResources.stopFollowingPersonConfirmationDialogButtonText,e)}else{c=String.format(SpsClient.ScriptResources.hideDocumentConfirmationText,a);d=String.format(SpsClient.ScriptResources.stopFollowingObjectConfirmationDialogButtonText,e)}var i=this;SP.UI.MicroFeed.SPMicroFeed.$2g(f,h,g,c,"",d,a,function(){i.$6v_0(g?h:f,b,a)})},$3p_0:function(e,c,b){var a=null,f=null;if(b)a=$get(SP.UI.MicroFeed.SPMicroFeed.$10+e);else a=$get(SP.UI.MicroFeed.SPMicroFeed.$29+e);if(a){a.setAttribute("deleted","true");SP.UI.MicroFeed.SPMicroFeed.showProgressSpinner();!b&&SP.UI.MicroFeed.SPMicroFeed.$6y(a.parentNode,1,null);!SP.UI.MySiteCommon.CommonUIElements.isEntirelyHidden(a)&&SP.UI.MicroFeed.SPMicroFeed.$5u(a);var d=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){f=SP.UI.MicroFeed.SPMicroFeed.get_$D().deletePost(c);SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){if(f.get_status())d.$5s_0(e,c,b,a,"");else{if(b)SP.UI.MicroFeed.MicrofeedThreadCache.removeById(c);else SP.UI.MicroFeed.MicrofeedThreadCache.addOrUpdate(f,false);d.$7o_0(c,b,a.id)}SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()},function(g,f){if(f.get_errorCode()===3)d.$7o_0(c,b,a.id);else if(f.get_errorCode()===2)SP.UI.MicroFeed.SPMicroFeed.$2h(function(){SP.UI.MicroFeed.SPMicroFeed.$2d(a)});else d.$5s_0(e,c,b,a,f.get_message());SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()})})}},$7o_0:function(c,d,e){var a=null,b=$get(e);b&&b.parentNode.removeChild(b);if(d)this.$82_0();else{a=document.getElementsByName(c);while(a.length>0){SP.UI.MicroFeed.SPMicroFeed.$6y(a[0].parentNode.parentNode,1,null);a[0].parentNode.parentNode.removeChild(a[0].parentNode)}}},$5s_0:function(h,i,e,c,f){var a=document.createElement("div");a.id="ms-errorPostDiv";a.className=SP.UI.MicroFeed.SPMicroFeed.$4J+" "+SP.UI.MicroFeed.SPMicroFeed.$4M;a.innerHTML=c.innerHTML;if(e)a.innerHTML=c.firstChild.firstChild.innerHTML;SP.UI.MicroFeed.SPMicroFeed.$3q(a);var d="";if(!SP.ScriptHelpers.isNullOrEmptyString(f))d=String.format(SpsClient.ScriptResources.genericErrorMessage,f);var b=new SP.UI.MySiteCommon.MySiteDialog(SpsClient.ScriptResources.unknownErrorTitle,SpsClient.ScriptResources.deleteErrorMessage);b.set_okButtonText(SpsClient.ScriptResources.retryButtonText);var g=this;b.set_okButtonCallback(function(){g.$3p_0(h,i,e)});var j=this;b.set_cancelButtonCallback(function(){SP.UI.MicroFeed.SPMicroFeed.$2d(c)});b.set_extraMessage(a);b.set_errorMessage(d);b.show()},$82_0:function(){var a=null,c=false,g=false,h=false,b=0,d=null,e=0,f=0,i="";a=$get(SP.UI.MicroFeed.SPMicroFeed.$1J);if(!a)return;if(SP.UI.MicroFeed.SPMicroFeed.$W){this.$6r_0("",0);return}i=a.getAttribute("numHiddenThreads");if(!SP.ScriptHelpers.isNullOrEmptyString(i))f=parseInt(a.getAttribute("numHiddenThreads"));for(b=0;b<a.children.length;b++){d=a.children[b];g=a.children[b].getAttribute("deleted")==="true";h=SP.UI.MySiteCommon.CommonUIElements.isEntirelyHidden(d);if(h&&!e&&!g)if(this.$3g_0(d)){e=1;SP.UI.MySiteCommon.CommonUIElements.display(d);c=true;break}if(!c)c=!(g||h)}f=f-e;a.setAttribute("numHiddenThreads",""+f);e<1&&this.$3e_0(a,1,0);if(!c){a.appendChild(this.$22_0(false));SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,$get(SP.UI.MicroFeed.SPMicroFeed.$1W))}},$79_0:function(d,a,e,f){var c=$get(SP.UI.MicroFeed.SPMicroFeed.$10+d);SP.UI.MicroFeed.SPMicroFeed.showProgressSpinner();var b=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){var d=e?SP.UI.MicroFeed.SPMicroFeed.get_$D().lockThread(a):SP.UI.MicroFeed.SPMicroFeed.get_$D().unlockThread(a);SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){if(!d.get_status()||d.get_status()===5||d.get_status()===8){SP.UI.MicroFeed.MicrofeedThreadCache.addOrUpdate(d,false);b.$3t_0(d,false,c,false,f,true);SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()}else SP.UI.MicroFeed.SPMicroFeed.$6s()},function(b,a){if(a.get_errorCode()===2)SP.UI.MicroFeed.SPMicroFeed.$2h(function(){SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()});else SP.UI.MicroFeed.SPMicroFeed.$6s()})})},$5U_0:function(a,i){var h=a.$3_0,b=SP.UI.MicroFeed.SPMicroFeed.$5V(a,a.$1_0,a.$4_0,true),c=document.createElement("a");c.id=SP.UI.MicroFeed.SPMicroFeed.$42+a.$4_0;var d=document.createElement("a");d.id=SP.UI.MicroFeed.SPMicroFeed.$6Z+a.$4_0;var e=document.createElement("span");e.id=SP.UI.MicroFeed.SPMicroFeed.$6G+a.$4_0;e.className="ms-textSmall";var f=null;if(!a.$J_0){if(a.$1_0===2||a.$1_0===8||a.$1_0===7){SP.UI.MicroFeed.SPMicroFeed.$5X(a.$16_0,c,false);SP.UI.MicroFeed.SPMicroFeed.$5W(b,a.$m_0,a.$4_0,a,a.$15_0)}if(a.$i_0&&this.$K_0){SP.UI.MicroFeed.SPMicroFeed.$g(b);c.className=SP.UI.MicroFeed.SPMicroFeed.$28;c.setAttribute("href","#");c.setAttribute("onclick","return false;");if(a.$15_0){c.setAttribute("liked","true");c.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.unlikeCommandText)}else c.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.likeCommandText);var j=this;$addHandler(c,"click",function(b){SP.UI.MicroFeed.SPMicroFeed.$96(b,h,a)});b.appendChild(c)}if(a.$j_0&&(a.$1_0===6||a.$1_0===1)&&this.$K_0){SP.UI.MicroFeed.SPMicroFeed.$g(b);d.className=SP.UI.MicroFeed.SPMicroFeed.$28;d.setAttribute("href","#");d.setAttribute("onclick","return false;");SP.UI.MySiteCommon.CommonUIElements.setElementText(d,SpsClient.ScriptResources.replyCommandText);b.appendChild(d);var k=this;$addHandler(d,"click",function(){var b=$get(SP.UI.MicroFeed.SPMicroFeed.$2x+a.$9_0),c=$get(SP.UI.MicroFeed.SPMicroFeed.$1I+a.$9_0);SP.UI.MicroFeed.SPMicroFeed.$8j(a.$9_0);SP.UI.MySiteCommon.CommonUIElements.display(c);b.focus()})}if(a.$l_0&&(a.$1_0===6||a.$1_0===1)){SP.UI.MicroFeed.SPMicroFeed.$g(b);e.title=SpsClient.ScriptResources.lockedToolTip;SP.UI.MySiteCommon.CommonUIElements.setElementText(e,SpsClient.ScriptResources.lockedPostText);b.appendChild(e)}var g=SP.UI.MicroFeed.SPMicroFeed.$7x(a,b,a.$4_0);if(a.$1_0===1||a.$1_0===6)f=this.$86_0(a,a.$1_0,a.$4_0,i,a.$9_0,g);else f=this.$85_0(a,a.$4_0,g);if(f){SP.UI.MicroFeed.SPMicroFeed.$g(b);b.appendChild(f)}}else{SP.UI.MicroFeed.SPMicroFeed.$g(b);b.appendChild(SP.UI.MicroFeed.SPMicroFeed.$8Q(a.$4_0))}return b},$5w_0:function(l,v,b,w,x){var c=$get(SP.UI.MicroFeed.SPMicroFeed.$1I+b);if(!c){c=document.createElement("div");c.id=SP.UI.MicroFeed.SPMicroFeed.$1I+b}c.className=SP.UI.MicroFeed.SPMicroFeed.$2A+" ms-microfeed-newReplyDiv";(!v||!this.$K_0)&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,c);if(!this.$K_0)return c;if(1===l&&SP.UI.MicroFeed.SPMicroFeed.$91(c)){var g=null,a=null,d=null,i=null,e=null,r=null,h=null,f=null,j=null;h=document.createElement("div");h.id=SP.UI.MicroFeed.SPMicroFeed.$4R+b;h.style.position="relative";h.className=SP.UI.MicroFeed.SPMicroFeed.$55+" "+SP.UI.MicroFeed.SPMicroFeed.$2Q;f=document.createElement("div");f.id=SP.UI.MicroFeed.SPMicroFeed.$3Q+b;g=document.createElement("div");g.id="ms-newReplyDivContent_"+b;g.className="ms-microfeedReplyContent";g.style.position="relative";c.innerHTML=SP.UI.MicroFeed.SPMicroFeed.$5e(SP.UI.MicroFeed.SPMicroFeed.$2k+b,null,SP.UI.MicroFeed.SPMicroFeed.get_$X(),false);var k=document.createElement("div");k.id=SP.UI.MicroFeed.SPMicroFeed.$2z+b;k.className=SP.UI.MicroFeed.SPMicroFeed.$4Q+" "+SP.UI.MicroFeed.SPMicroFeed.$6c;a=document.createElement("textarea");a.id=SP.UI.MicroFeed.SPMicroFeed.$2x+b;a.className=SP.UI.MicroFeed.SPMicroFeed.$4Q+" "+SP.UI.MicroFeed.SPMicroFeed.$2P+" "+SP.UI.MicroFeed.SPMicroFeed.$3T;a.title=SpsClient.ScriptResources.replyTitleText;SP.UI.MySiteCommon.CommonUIElements.setElementText(a,this.$P_0);a.rows=1;a.style.position="relative";a.setAttribute("targetDisplayName",STSHtmlEncode(x));i=document.createElement("span");i.id=SP.UI.MicroFeed.SPMicroFeed.$59;i.className=SP.UI.MicroFeed.SPMicroFeed.$7M;e=document.createElement("label");e.id=SP.UI.MicroFeed.SPMicroFeed.$1C+b;e.className=SP.UI.MicroFeed.SPMicroFeed.$4z+" "+SP.UI.MicroFeed.SPMicroFeed.$2O;SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,e);if(!SP.UI.MicroFeed.SPMicroFeed.$s){$addHandler(a,"keydown",this.$$d_$8E_0);$addHandler(a,"keyup",this.$$d_$8E_0);$addHandler(a,"propertychange",this.$$d_$8E_0);$addHandler(a,"input",this.$$d_$8E_0)}var s=this;$addHandler(a,"focus",function(){SP.UI.MySiteCommon.CommonUIElements.display(c);s.$62_0(a.id,false,$get(SP.UI.MicroFeed.SPMicroFeed.$25+SP.UI.MicroFeed.SPMicroFeed.$2k+b))});var y=this;$addHandler(a,"blur",function(){SP.UI.MicroFeed.SPMicroFeed.$63(a.id,false)});if(!SP.UI.MicroFeed.SPMicroFeed.$s){var m=this,n=this;$addHandlers(a,{keyup:function(){m.$w_0(a,e,d,m.$P_0)},change:function(){n.$w_0(a,e,d,n.$P_0)}})}var o=this,p=this,z=this,A=this,B=this;$addHandlers(a,{cut:function(){o.$2Z_0(a,e,d,o.$P_0)},paste:function(){p.$2Z_0(a,e,d,p.$P_0)},keyup:function(){SP.UI.MicroFeed.SPMicroFeed.$1w(a,b)},click:function(){SP.UI.MicroFeed.SPMicroFeed.$1w(a,b)},focus:function(){SP.UI.MicroFeed.SPMicroFeed.$1w(a,b)}});d=SP.UI.MicroFeed.SPMicroFeed.$3m(SpsClient.ScriptResources.postCommandText,SP.UI.MicroFeed.SPMicroFeed.$y+b,SP.UI.MicroFeed.SPMicroFeed.$58);d.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$Y,b);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,d);j=SP.UI.MicroFeed.SPMicroFeed.$2a(SP.UI.MicroFeed.SPMicroFeed.get_$1H(),SpsClient.ScriptResources.attachPictureButtonText,SpsClient.ScriptResources.attachPictureButtonText,SP.UI.MicroFeed.SPMicroFeed.$2t+b,SP.UI.MicroFeed.SPMicroFeed.$4y+" "+SP.UI.MicroFeed.SPMicroFeed.$d,SP.UI.MicroFeed.SPMicroFeed.$4x,SP.UI.MicroFeed.SPMicroFeed.$4w);j.setAttribute("name",SP.UI.MicroFeed.SPMicroFeed.$38);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,j);var t=this;$addHandler(j,"click",function(){t.$5a_0(d,a,b)});h.appendChild(k);h.appendChild(a);f.className="ms-microfeed-elementsNoFocus";f.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$Y,b);f.setAttribute(SP.UI.MicroFeed.SPMicroFeed.$1K,"false");SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,f);f.appendChild(SP.UI.MicroFeed.SPMicroFeed.$5g(a,b));f.appendChild(this.$5d_0(a,d,b));h.appendChild(f);g.appendChild(h);var u=this;$addHandler(d,"click",function(){u.$7Z_0(b,w,SP.UI.MicroFeed.SPMicroFeed.$6m(b))});i.appendChild(e);i.appendChild(d);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,i);g.appendChild(j);g.appendChild(i);g.appendChild(SP.UI.MicroFeed.SPMicroFeed.createClearFloatsDiv());c.appendChild(g);var q=this;r=new SP.UI.MicroFeed.AtMention(a,3,function(){q.$7p_0(a,d,f,e,q.$P_0)});SP.UI.MicroFeed.SPMicroFeed.$N[b]=r;var C=this;$addHandler(a,"keydown",function(a){SP.UI.MicroFeed.SPMicroFeed.$7q(a,b,false)})}else if(2===l)c.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.replyLimitErrorText);else if(0===l)c.innerHTML="";return c},$62_0:function(h,m,n){var a=$get(h),b=document.createElement("textarea"),d,f,k,g="",i=h.substr(h.indexOf("_")+1),l=0,j=0,c=SP.UI.MicroFeed.SPMicroFeed.getTextBoxFocusDiv(a,m);if(c)c.className=c.className.replace(SP.UI.MicroFeed.SPMicroFeed.$2Q,SP.UI.MicroFeed.SPMicroFeed.$56);n&&SP.UI.MySiteCommon.CommonUIElements.display(n);if(m){if(a.rows<2)a.rows=2;d=$get(SP.UI.MicroFeed.SPMicroFeed.$V);f=$get(SP.UI.MicroFeed.SPMicroFeed.$3K);k=$get(SP.UI.MicroFeed.SPMicroFeed.$1p);g=this.$G_0}else{d=$get(SP.UI.MicroFeed.SPMicroFeed.$y+i);f=$get(SP.UI.MicroFeed.SPMicroFeed.$2t+i);k=$get(SP.UI.MicroFeed.SPMicroFeed.$1Y+i);g=this.$P_0;if(c&&c.parentNode)if(c.parentNode.className.indexOf(SP.UI.MicroFeed.SPMicroFeed.$2y)===-1)c.parentNode.className+=" "+SP.UI.MicroFeed.SPMicroFeed.$2y;if(a.rows<2){b.rows=2;b.style.zIndex=1;b.style.position="absolute";SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(true,b);a.parentNode.appendChild(b);l=b.clientHeight;j=b.clientWidth;a.parentNode.removeChild(b);a.style.height=a.clientHeight+"px";a.style.width=j+"px";var o=this;SP.SOD.executeFunc("core.js","SPAnimationUtility",function(){SPAnimationUtility.BasicAnimator.Resize(a,l-8,j-10,function(){a.rows=2;a.style.height="auto";a.style.width="";o.$20_0(a)},null)})}}if(SP.UI.MicroFeed.SPMicroFeed.$s){window.clearInterval(SP.UI.MicroFeed.SPMicroFeed.$3a);var e=this;SP.UI.MicroFeed.SPMicroFeed.$3a=window.setInterval(function(){e.$20_0(a);var b=SP.UI.MicroFeed.SPMicroFeed.getPostIDFromDOMElementID(a.id),c=h===SP.UI.MicroFeed.SPMicroFeed.$1D;if(c)e.$w_0(a,$get(SP.UI.MicroFeed.SPMicroFeed.$1C),$get(SP.UI.MicroFeed.SPMicroFeed.$V),e.$G_0);else e.$w_0(a,$get(SP.UI.MicroFeed.SPMicroFeed.$1C+b),$get(SP.UI.MicroFeed.SPMicroFeed.$y+b),e.$P_0)},100)}if(d){SP.UI.MySiteCommon.CommonUIElements.display(d);SP.UI.MySiteCommon.CommonUIElements.display(d.parentNode);this.$2W_0(d,a,g)}if(f){SP.UI.MySiteCommon.CommonUIElements.display(f);f.disabled=this.$3H_0}if(a.value===g)a.value="";a.className=a.className.replace(SP.UI.MicroFeed.SPMicroFeed.$2P,SP.UI.MicroFeed.SPMicroFeed.$54)},$9I_0:function(c,d,h,a){var b=null,f=null;if(d){SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,$get(SP.UI.MicroFeed.SPMicroFeed.$1C));b=$get(SP.UI.MicroFeed.SPMicroFeed.$V);f=$get(SP.UI.MicroFeed.SPMicroFeed.$3K);a.value=this.$G_0}else{SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,$get(SP.UI.MicroFeed.SPMicroFeed.$1C+c));b=$get(SP.UI.MicroFeed.SPMicroFeed.$y+c);f=$get(SP.UI.MicroFeed.SPMicroFeed.$2t+c);a.value=this.$P_0;var e=SP.UI.MicroFeed.SPMicroFeed.getTextBoxFocusDiv(a,d);if(e&&e.parentNode)e.parentNode.className=e.parentNode.className.replace(SP.UI.MicroFeed.SPMicroFeed.$2y,"");a.style.height="";a.style.width=""}SP.UI.MicroFeed.SPMicroFeed.$2X(a);var g=$get(d?SP.UI.MicroFeed.SPMicroFeed.$3R:SP.UI.MicroFeed.SPMicroFeed.$2z+SP.UI.MicroFeed.SPMicroFeed.getPostIDFromDOMElementID(a.id));if(g)g.innerHTML="";if(!SP.UI.MicroFeed.SPMicroFeed.$H[c?c:""]){b.disabled=true;if(d)SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(true,b);else{SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,b);SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,b.parentNode)}SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,f)}if(!d)a.rows=1;else a.rows=2;h&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,h);a.className=a.className.replace(SP.UI.MicroFeed.SPMicroFeed.$54,SP.UI.MicroFeed.SPMicroFeed.$2P)},$7i_0:function(a){this.$8_0=a;this.$1j_0=false},$35_0:function(d,g,c){var e=this.$5_0[this.$8_0],f=e.$f_0,b=null,a=new SP.Social.SocialFeedOptions;a.set_maxThreadCount(SP.UI.MicroFeed.SPMicroFeed.$7S);a.set_sortOrder(0);if(d)if(d===1)a.set_olderThan(this.$1A_0);else if(d===2)if(this.$1k_0)a.set_newerThan(this.$1k_0);else this.$1A_0=new Date;if(this.$1y_0())this.$4q_0=new Date;c.val=true;switch(f){case 0:if(this.$7_0===1)b=SP.UI.MicroFeed.SPMicroFeed.get_$D().getFeed(0,a);else if(this.$7_0===2){b=SP.UI.MicroFeed.SPMicroFeed.get_$D().getFeedFor(SP.UI.MicroFeed.SPMicroFeed.microfeed.$M_0,a);c.val=false}else{b=SP.UI.MicroFeed.SPMicroFeed.get_$D().getFeedFor(this.$4u_0,a);c.val=false}break;case 1:b=SP.UI.MicroFeed.SPMicroFeed.get_$D().getFeed(1,a);break;case 4:b=SP.UI.MicroFeed.SPMicroFeed.get_$D().getFeed(4,a);c.val=false;break;case 2:b=SP.UI.MicroFeed.SPMicroFeed.get_$D().getFeed(2,a);break;case 6:b=SP.UI.MicroFeed.SPMicroFeed.get_$D().getFeed(3,a);break;case 5:b=SP.UI.MicroFeed.SPMicroFeed.get_$D().getMentions(g,a)}return b},$4b_0:function(j,g,i){var d=this.$5_0[this.$8_0].$f_0,e=this.$E_0[d],f=new SP.UI.MicroFeed.MicrofeedThreadList,b=null,c=false,h=false;if(!j&&this.$E_0[d]){this.$5J_0(g);SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner();return}SP.UI.MicroFeed.SPMicroFeed.showProgressSpinner();var a=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){if(a.$1y_0()&&a.$1k_0&&e&&e.size()>0){var j,k;b=(k=a.$35_0(2,i,j={val:c}),c=j.val,k);h=true}else{a.$1A_0=new Date;var l,m;b=(m=a.$35_0(0,i,l={val:c}),c=l.val,m)}SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){f.setThreadCollection(b,false,a.$1O_0);if(h){a.$5H_0(b);f.appendThreadList(e)}a.$E_0[d]=f;a.resetNewPostNotifications();c&&a.$1x_0(b.get_unreadMentionCount());a.$5J_0(g);SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()},function(c,b){a.$3B_0=b.get_message();if(b.get_errorCode()===9)a.$E_0[d]=new SP.UI.MicroFeed.MicrofeedThreadList;a.$5J_0(g);SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()})})},$5J_0:function(a){var c=$get(SP.UI.MicroFeed.SPMicroFeed.$26);if(c){var b=this;SP.UI.MicroFeed.SPMicroFeed.$24(function(){b.$3r_0(a)},false)}else this.$3r_0(a)},$3e_0:function(e,d,f){SP.UI.MicroFeed.SPMicroFeed.showProgressSpinner();var b=new SP.UI.MicroFeed.MicrofeedThreadList,c=false,a=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){var g,h,i=(h=a.$35_0(1,false,g={val:c}),c=g.val,h);SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){c&&a.$1x_0(i.get_unreadMentionCount());var j=0,g=0,l=0;b.setThreadCollection(i,false,a.$1O_0);var k=a.$5_0[a.$8_0].$f_0,h=a.$E_0[k];if(!h){a.$E_0[k]=b;g=b.size()}else{l=h.sizeAfterRemovingRecentDeletions();h.appendThreadList(b);a.$E_0[k]=h;g=h.size()-l}if(g)j=a.$5y_0(e,a.$E_0[k],l,d);if(j<d&&g&&f!==3)a.$3e_0(e,d-j,++f);else SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner();!g&&SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,$get(SP.UI.MicroFeed.SPMicroFeed.$4G));if(j>0){var m=$get(SP.UI.MicroFeed.SPMicroFeed.$27);null!==m&&m.parentNode.removeChild(m)}ProcessImn()},function(){SP.UI.MySiteCommon.CommonUIElements.setDisplayNone(false,$get(SP.UI.MicroFeed.SPMicroFeed.$1W));SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()})})},$7Y_0:function(a,b,d,e){var c=this;SP.SOD.executeFunc("initstrings.js","Strings.STS.L_RelativeDateTime_AFewSeconds",function(){var g=SP.ScriptHelpers.isNullOrEmptyString(d),h=SP.UI.MicroFeed.MicrofeedEntry.createEntryFromData(SP.UI.MicroFeed.SPMicroFeed.get_$X(),g?0:1,b,"pending",false,false,false,a.get_attachment()),f=$get(SP.UI.MicroFeed.SPMicroFeed.$27);null!==f&&f.parentNode.removeChild(f);if(!g)c.$8N_0(a,b,d,e,h);else c.$8O_0(a,b,h,e)})},$8N_0:function(j,k,c,h,e){var b=null,g=null,a=null,i="",f=null;if(this.$14_0){g=$get(SP.UI.MicroFeed.SPMicroFeed.$z+c);e.$1_0=4;e.$9_0=c;a=this.$x_0(e);a.id=SP.UI.MicroFeed.SPMicroFeed.$4N+c;SP.UI.MySiteCommon.CommonUIElements.display(g);g.appendChild(a);ProcessImn();SP.UI.MicroFeed.SPMicroFeed.showProgressSpinner()}if(!SP.ScriptHelpers.isNullOrEmptyString(h))i=h;else i=c;var d=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){b=SP.UI.MicroFeed.SPMicroFeed.get_$D().createPost(i,j);SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){if(b.get_status()&&b.get_status()!==8)d.$3d_0(j,k,c,h,e,a,null);else if(!b.get_status()&&d.$14_0){var i=d.$E_0[1];i&&i.moveToFront(b,false);i=d.$E_0[0];i&&i.moveToFront(b,false);var l=$get(SP.UI.MicroFeed.SPMicroFeed.$1o+e.$3_0);a&&a.parentNode&&a.parentNode.removeChild(a);f=SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost(b,b.get_replies()[0]);f.$1_0=7;f.$9_0=c;g.appendChild(d.$x_0(f));SP.UI.MicroFeed.SPMicroFeed.$7f(l,SP.UI.MicroFeed.SPMicroFeed.$1o+f.$3_0);ProcessImn();SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()}},function(f,b){d.$3d_0(j,k,c,h,e,a,b)})})},$8O_0:function(d,h,e,i){var b=null,a=null,f=null,g=null;if(this.$14_0){g=$get(SP.UI.MicroFeed.SPMicroFeed.$1J);a=document.createElement("div");a.id=SP.UI.MicroFeed.SPMicroFeed.$6T+"0";f=this.$8f_0(e,false);f.id=SP.UI.MicroFeed.SPMicroFeed.$4N+"0";a.appendChild(f);SP.UI.MicroFeed.SPMicroFeed.$1z(a,g,null,false);ProcessImn()}if(SP.ScriptHelpers.isNullOrEmptyString(this.$M_0))d.set_updateStatusText(true);else d.set_updateStatusText(false);var c=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){b=SP.UI.MicroFeed.SPMicroFeed.get_$D().createPost(i,d);SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){b.get_status()&&b.get_status()!==8&&c.$3d_0(d,h,null,null,e,a,null);if(!b.get_status()&&c.$14_0){var f=c.$E_0[1];f&&f.addToFront(b,false);f=c.$E_0[0];f&&f.addToFront(b,false);var g=$get(SP.UI.MicroFeed.SPMicroFeed.$1o+e.$3_0);a&&a.parentNode&&a.parentNode.replaceChild(c.$2i_0(b,false,true,false),a);SP.UI.MicroFeed.SPMicroFeed.$7f(g,SP.UI.MicroFeed.SPMicroFeed.$1o+b.get_id());ProcessImn()}},function(f,b){c.$3d_0(d,h,null,i,e,a,b)})})},$3d_0:function(m,w,t,u,n,a,b){var g=false,d=document.createElement("div");d.id="ms-errorPostDiv";d.className=SP.UI.MicroFeed.SPMicroFeed.$4M;n.$1_0=12;n.$9_0="";d.appendChild(this.$x_0(n));if(b)if(b.get_errorCode()===3){var e=new SP.UI.MySiteCommon.MySiteDialog(SpsClient.ScriptResources.knownErrorButNoUserFixTitle,SpsClient.ScriptResources.postToDeletedThreadErrorMessage),x=this;e.set_okButtonCallback(function(){a.parentNode.removeChild(a)});e.set_hideCancelButton(true);e.set_extraMessage(d);e.set_errorMessage(String.format(SpsClient.ScriptResources.genericErrorMessage,b.get_message()));e.show();g=true}else if(b.get_errorCode()===2){var y=this;SP.UI.MicroFeed.SPMicroFeed.$2h(function(){a.parentNode.removeChild(a)});g=true}if(!g){var o=SpsClient.ScriptResources.unknownErrorTitle,h=SpsClient.ScriptResources.retryErrorMessage,f="",p="",i=SpsClient.ScriptResources.retryButtonText,v=this,q=function(){a.parentNode.removeChild(a);v.$7Y_0(m,w,t,u)},r=SpsClient.ScriptResources.cancelButtonText,z=this,s=function(){a.parentNode.removeChild(a)},j=d;if(b&&b.get_errorCode()===14&&m.get_contentText().trim().length>0){f=SpsClient.ScriptResources.pictureUploadErrorMessage;h=SpsClient.ScriptResources.retryWithoutPictureErrorMessage;i=SpsClient.ScriptResources.retryWithoutPictureButtonText;m.set_attachment(null)}else if(!SP.ScriptHelpers.isNullOrEmptyString(u)&&SP.ScriptHelpers.isNullOrEmptyString(t)){o=SpsClient.ScriptResources.knownErrorButNoUserFixTitle;f=SpsClient.ScriptResources.postingToSiteFeedFailure;h="";i=SpsClient.ScriptResources.okButtonText;var A=this;q=function(){a.parentNode.removeChild(a)};r=null;s=null;j=null}else if(!b)f=SpsClient.ScriptResources.postErrorMessage;else{f=SpsClient.ScriptResources.postErrorMessage;p=String.format(SpsClient.ScriptResources.genericErrorMessage,b.get_message())}var k=document.createElement("div");j&&k.appendChild(j);var l=document.createElement("div");l.setAttribute("style","margin-top:15px;");SP.UI.MySiteCommon.CommonUIElements.setElementText(l,h);k.appendChild(l);var c=new SP.UI.MySiteCommon.MySiteDialog(o,f);c.set_okButtonText(i);c.set_okButtonCallback(q);c.set_cancelButtonText(r);c.set_cancelButtonCallback(s);c.set_extraMessage(k);c.set_errorMessage(p);c.show()}ProcessImn();SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()},$36_0:function(b,f,g,a,h){var d=false;if(!a||a.getAttribute("updating")==="true")return;a.setAttribute("updating","true");d=SP.UI.MicroFeed.SPMicroFeed.$5L(b);var e=a.id.substr(a.id.lastIndexOf("_")+1);SP.UI.MicroFeed.SPMicroFeed.showProgressSpinner();var c=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){var i=SP.UI.MicroFeed.SPMicroFeed.get_$D().getFullThread(b);SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){if(i.get_status())c.$6q_0(b,f,g,a,h,e,"",0);else{SP.UI.MicroFeed.MicrofeedThreadCache.addOrUpdate(i,false);c.$3t_0(i,f,a,true,h,false);g&&SP.UI.MicroFeed.SPMicroFeed.$5v(e)}SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner();a.removeAttribute("updating");d&&SP.UI.MicroFeed.SPMicroFeed.$5M(b)},function(j,i){c.$6q_0(b,f,g,a,h,e,i.get_message(),i.get_errorCode());a.removeAttribute("updating");d&&SP.UI.MicroFeed.SPMicroFeed.$5M(b)})})},$6q_0:function(i,m,n,o,a,b,j,p){var d=!SP.ScriptHelpers.isNullOrEmptyString(j)?String.format(SpsClient.ScriptResources.genericErrorMessage,j):"";if(p===2){var g=SpsClient.ScriptResources.siteFeedInsufficientPermissionsUnknownSiteErrorMessage,h=SP.UI.MicroFeed.MicrofeedThreadCache.getThreadById(a.$3_0);if(h){var c=SP.UI.MicroFeed.MicrofeedEntry.getTargetForRef(h);if(c&&c.get_uri()&&SP.UI.MySiteCommon.CommonUIElements.isSafeURL(c.get_uri()))g=String.format(SpsClient.ScriptResources.siteFeedInsufficientPermissionsErrorMessage,SP.UI.MySiteCommon.CommonUIElements.createAnchorOpenHTMLTag("","",c.get_uri(),""),"</a>")}var e=new SP.UI.MySiteCommon.MySiteDialog(SpsClient.ScriptResources.unknownErrorTitle,g);e.set_hideCancelButton(true);e.set_errorMessage(d);e.show()}else if(a&&a.$Z_0){var k=this;SP.UI.MicroFeed.SPMicroFeed.$2g(b,b,true,SpsClient.ScriptResources.getOrphanedThreadErrorMessage,d,SpsClient.ScriptResources.deleteConfirmationDialogButtonText,"",function(){k.$3p_0(b,a.$3_0,true)})}else{var l=this;SP.UI.MicroFeed.SPMicroFeed.$2g(b,b,true,SpsClient.ScriptResources.getThreadErrorMessage,d,SpsClient.ScriptResources.retryButtonText,"",function(){l.$36_0(i,m,n,o,a)})}SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner();var f=$get(SP.UI.MicroFeed.SPMicroFeed.$2m+i);f&&SP.UI.MySiteCommon.CommonUIElements.setElementText(f.parentNode,SpsClient.ScriptResources.viewFullThreadText)},$6v_0:function(d,a,e){var b=null;if(a.get_actorType()&&!SP.UI.MicroFeed.SPMicroFeed.$1d(a))return;b=$get(SP.UI.MicroFeed.SPMicroFeed.$10+d);b.setAttribute("deleted","true");!SP.UI.MySiteCommon.CommonUIElements.isEntirelyHidden(b)&&SP.UI.MicroFeed.SPMicroFeed.$5u(b);SP.UI.MicroFeed.SPMicroFeed.showProgressSpinner();var c=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){if(SP.UI.MicroFeed.SPMicroFeed.$1d(a)){SP.UI.MicroFeed.SPMicroFeed.initializeCSOMData(false);var f=new SP.UserProfiles.FollowedContent(SP.UI.MicroFeed.SPMicroFeed.$L);f.stopFollowing(a.get_contentUri()?a.get_contentUri():a.get_uri())}else!a.get_actorType()&&SP.UI.MicroFeed.SPMicroFeed.get_$5F().stopFollowing(a.get_accountName());SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){c.$6u_0(a,b)},function(g,f){if(f.get_errorTypeName()==="Microsoft.Office.Server.UserProfiles.PrivacyItemNotFoundException")c.$6u_0(a,b);else c.$8y_0(d,a,b,f.get_message(),e)})})},$6u_0:function(b,c){c.parentNode.removeChild(c);this.$E_0[1]=null;this.refreshTheFeed();if(!b.get_actorType()){var a=SP.UI.People.FollowLinkManager.getLink(b.get_accountName());a&&a.updateFromExternalSource(false,SP.UI.People.FollowLink.microfeedIdPrefixAndSource)}SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()},$8y_0:function(f,g,h,c,d){var b="";if(!SP.ScriptHelpers.isNullOrEmptyString(c))b=String.format(SpsClient.ScriptResources.genericErrorMessage,c);var a=new SP.UI.MySiteCommon.MySiteDialog(SpsClient.ScriptResources.unknownErrorTitle,String.format(SpsClient.ScriptResources.hideErrorMessage,d));a.set_okButtonText(SpsClient.ScriptResources.retryButtonText);var e=this;a.set_okButtonCallback(function(){e.$6v_0(f,g,d)});var i=this;a.set_cancelButtonCallback(function(){SP.UI.MicroFeed.SPMicroFeed.$2d(h)});a.set_errorMessage(b);a.show();SP.UI.MicroFeed.SPMicroFeed.hideProgressSpinner()}};SP.UI.MicroFeed.AllLikerDisplayManager=function(){};SP.UI.MicroFeed.AllLikerDisplayManager.socialActorCompare=function(e,f){var a=e,b=f,c=SP.UI.MicroFeed.SPMicroFeed.get_$X();if(c){var d=c.get_accountName().toLowerCase();if(a.get_accountName().toLowerCase()===d)return-1;else if(b.get_accountName().toLowerCase()===d)return 1}return a.get_name().toLowerCase().localeCompare(b.get_name().toLowerCase())};SP.UI.MicroFeed.AllLikerDisplayManager.createAllLikerCallout=function(a,b){if(!b||!a)return;SP.UI.MySiteCommon.PresenceManager.ensurePresenceJSLoaded(function(){SP.SOD.executeFunc("callout.js","Callout",function(){var c=new CalloutOptions,e=true;c.launchPoint=b;c.ID=SP.UI.MicroFeed.AllLikerDisplayManager.$66+b.id;var f=$get("contentBox");c.boundingBox=!f?document.body:f;var d=document.createElement("div");d.id=SP.UI.MicroFeed.AllLikerDisplayManager.$65+b.id;d.setAttribute("style","min-height: 50px");var g=SP.UI.MicroFeed.AllLikerDisplayManager.$67+b.id;c.onOpenedCallback=function(){var b=$get(g);if(e){e=false;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){var c=SP.UI.MicroFeed.SPMicroFeed.get_$D().getAllLikers(a.$3_0);SP.UI.MicroFeed.SPMicroFeed.executeQueryIfNeeded(function(){if(c){c.sort(SP.UI.MicroFeed.AllLikerDisplayManager.socialActorCompare);a.$h_0=c}var g=a.$h_0.length,h=String.format(SP.Utilities.LocUtility.getLocalizedCountValue(SpsClient.ScriptResources.seeAllLikerCalloutTitle,SpsClient.ScriptResources.seeAllLikerCalloutTitleIntervals,g),g);SP.UI.MySiteCommon.CommonUIElements.setElementText(b,h);SP.UI.MicroFeed.AllLikerDisplayManager.$5N[a.$3_0]=h;for(var i="<div>",e=null,f=0;f<a.$h_0.length;f++){e=a.$h_0[f];i+="<div>"+SP.UI.MySiteCommon.PresenceManager.getUserImageInnerHTML(e.get_accountName(),e.get_name(),e.get_imageUri(),e.get_uri(),e.get_emailAddress(),e.get_title(),false,false)+"</div>"}d.className=SP.UI.MicroFeed.AllLikerDisplayManager.$7K;d.innerHTML=i+"</div>";ProcessImn()},function(){SP.UI.MySiteCommon.CommonUIElements.setElementText(b,SpsClient.ScriptResources.unknownErrorTitle);d.innerHTML=STSHtmlEncode(SpsClient.ScriptResources.getLikerErrorMsg);e=true})})}else{SP.UI.MySiteCommon.CommonUIElements.setElementText(b,SP.UI.MicroFeed.AllLikerDisplayManager.$5N[a.$3_0]||"");ProcessImn()}};c.title=SP.UI.MySiteCommon.CommonUIElements.createOpenHTMLTag("div",g,"")+SP.UI.MySiteCommon.CommonUIElements.createProcessingIconAsHTML("ms-progressAllLikerSpinner","ms-microfeed-processingImage")+"</div>";c.beakOrientation="leftRight";c.contentElement=d;c.contentWidth=300;var h=CalloutManager.createNew(c)})})};SP.UI.MicroFeed.MicrofeedEntry=function(){this.$A_0=null;this.$B_0=null;this.$Z_0=false;this.$i_0=false;this.$1f_0=false;this.$1M_0=false;this.$j_0=false;this.$13_0="";this.$3_0="";this.$k_0=false;this.$2J_0=false;this.$l_0=false;this.$J_0=false;this.$1g_0=false;this.$F_0=false;this.$15_0=false;this.$16_0=null;this.$h_0=null;this.$I_0=null;this.$m_0=0;this.$19_0=0;this.$n_0=0;this.$S_0=[];this.$O_0="";this.$4_0="";this.$1B_0="";this.$1P_0=null;this.$1m_0=null;this.$o_0=0;this.$6_0=null;this.$p_0=true;this.$b_0="";this.$9_0="";this.$1_0=0};SP.UI.MicroFeed.MicrofeedEntry.createEntryFromData=function(h,f,i,c,g,d,e,b){var a=new SP.UI.MicroFeed.MicrofeedEntry;a.$A_0=h;a.$B_0=null;a.$o_0=f;a.$b_0=STSHtmlEncode(i);a.$3_0=c;a.$4_0=c;a.$j_0=false;a.$19_0=0;a.$Z_0=d;a.$15_0=g;a.$m_0=0;a.$16_0=null;a.$h_0=null;a.$i_0=e;a.$1f_0=false;a.$k_0=true;a.$l_0=false;a.$1M_0=false;a.$13_0=STSHtmlEncode(Strings.STS.L_RelativeDateTime_AFewSeconds);if(b)a.$I_0=b;SP.UI.MicroFeed.MicrofeedEntry.$7l(a);return a};SP.UI.MicroFeed.MicrofeedEntry.getTargetForRef=function(a){if(a&&a.get_postReference()&&a.get_postReference().get_threadOwnerIndex()>0&&a.get_postReference().get_threadOwnerIndex()<a.get_actors().length){var b=a.get_actors()[a.get_postReference().get_threadOwnerIndex()];if(b&&b.get_actorType())return b}return null};SP.UI.MicroFeed.MicrofeedEntry.createRootPostFromThread=function(a){var b=new SP.UI.MicroFeed.MicrofeedEntry;if(a)if(!a.get_threadType()){b=SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost(a,a.get_rootPost());b.$J_0=false}else if(!a.get_postReference())return null;else if(a.get_postReference().get_digest()){b=SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost(a.get_postReference().get_digest(),a.get_postReference().get_digest().get_rootPost());b.$6_0=SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost(a,a.get_rootPost());b.$J_0=false;b.$9_0=a.get_id()}else if(a.get_postReference().get_post()){b=SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost(a,a.get_postReference().get_post());b.$6_0=SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost(a,a.get_rootPost());var c=SP.UI.MicroFeed.MicrofeedEntry.getTargetForRef(a);if(c)b.$B_0=c;if(a.get_postReference().get_post().get_postType()===1){b.$1g_0=true;b.$4_0=a.get_postReference().get_threadId()}else b.$F_0=true;b.$J_0=true}else{b=SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost(a,a.get_rootPost());b.$J_0=true;b.$4_0=a.get_postReference().get_threadId()}return b};SP.UI.MicroFeed.MicrofeedEntry.createMicrofeedEntryFromPost=function(c,b){var a=new SP.UI.MicroFeed.MicrofeedEntry;if(b){a.$A_0=c.get_actors()[b.get_authorIndex()];var g=c.get_actors()[c.get_ownerIndex()];if(g.get_actorType())a.$B_0=g;a.$o_0=b.get_postType();if(!b.get_postType())switch(c.get_threadType()){case 3:a.$1_0=10;break;case 1:case 2:case 4:a.$1_0=9;break;case 0:a.$1_0=1}else a.$1_0=2;a.$3_0=b.get_id();a.$h_0=null;a.$4_0=b.get_id();a.$j_0=!!(c.get_attributes()&2);a.$19_0=c.get_totalReplyCount();a.$Z_0=!!(b.get_attributes()&2);if(b.get_likerInfo()){var e=b.get_likerInfo();a.$15_0=e.get_includesCurrentUser();a.$m_0=e.get_totalCount();a.$16_0=[];for(var f=e.get_indexes(),j=f.length,d=0;d<j;++d){var k=f[d];Array.add(a.$16_0,c.get_actors()[k])}}a.$i_0=!!(b.get_attributes()&1);if(!a.$A_0.get_actorType())a.$k_0=SP.UI.People.PersonManager.getFollowState(a.$A_0.get_accountName());else a.$k_0=a.$A_0.get_isFollowed();a.$1f_0=!!(b.get_attributes()&16);a.$l_0=!!(c.get_attributes()&8);a.$1M_0=!!(c.get_attributes()&4);if(!SP.ScriptHelpers.isNullOrEmptyString(b.get_preferredImageUri())){a.$p_0=false;var h="/_layouts/"+SP.OfficeVersion.majorVersion+"/images/",i=b.get_preferredImageUri().toLowerCase().lastIndexOf(h);a.$1B_0=i>=0?GetThemedImageUrl(b.get_preferredImageUri().substr(i+h.length)):b.get_preferredImageUri();if(!c.get_threadType())a.$13_0="";else a.$13_0=SP.UI.MicroFeed.MicrofeedEntry.$5f(b.get_createdTime())}else a.$p_0=true;if(a.$p_0||a.$i_0||a.$j_0)a.$13_0=SP.UI.MicroFeed.MicrofeedEntry.$5f(b.get_createdTime());a.$I_0=b.get_attachment();a.$9_0=c.get_id();SP.UI.MicroFeed.MicrofeedEntry.$7l(a);a.$b_0=SP.UI.MicroFeed.MicrofeedEntry.$9G(c,a,b);a.$O_0=c.get_permalink();if(b.get_source()){a.$1P_0=b.get_source().get_text();a.$1m_0=b.get_source().get_uri()}}return a};SP.UI.MicroFeed.MicrofeedEntry.$7l=function(a){a.$n_0=0;if(a.$o_0===1)a.$n_0=1;else if(!SP.ScriptHelpers.isNullOrEmptyString(a.$1B_0))a.$n_0=2};SP.UI.MicroFeed.MicrofeedEntry.$9G=function(i,j,b){if(!b||SP.ScriptHelpers.isNullOrEmptyString(b.get_text()))return"";for(var f=b.get_text(),c="",d=0,e=0,g=0,a=null,g=0;g<b.get_overlays().length;g++){a=b.get_overlays()[g];e=a.get_index();c+=STSHtmlEncode(f.substr(d,e-d));var h=f.substr(e,a.get_length());c+=SP.UI.MicroFeed.MicrofeedEntry.$8K(h,a,i,j);d=e+a.get_length()}c+=STSHtmlEncode(f.substr(d));return c};SP.UI.MicroFeed.MicrofeedEntry.$8K=function(d,c,e,f){var a="";switch(c.get_overlayType()){case 1:var b=e.get_actors()[c.get_actorIndexes()[0]];a=SP.UI.MySiteCommon.CommonUIElements.createSafeAnchorHTML("ms-actorElement",b.get_name(),"ms-bold ms-subtleLink",b.get_uri(),"",true);Array.add(f.$S_0,b);break;case 0:a=SP.UI.MySiteCommon.CommonUIElements.createSafeAnchorHTML("ms-externalLink",d,"",c.get_linkUri(),'target="_blank"',true);break;default:return d}return a};SP.UI.MicroFeed.MicrofeedEntry.$5f=function(a){var c=false,d=SP.Guid.newGuid().toString(),b='<span id="'+d+'" class="ms-hide">'+a+"</span>";SP.SOD.executeOrDelayUntilScriptLoaded(function(){var e=new Date;if(a>e)a=e;var g=new Date(e.getFullYear(),e.getMonth(),e.getDate()),h=new Date(a.getFullYear(),a.getMonth(),a.getDate()),i=Math.round((g-h)/1e3/60/60/24);if(a.getFullYear()===g.getFullYear()||i<=6)b=SP.DateTimeUtil.SPRelativeDateTime.getRelativeDateTimeString(a,true,0,false);else{var j=SP.DateTimeUtil.IntlDate.createFromJsLocalDate(a,0);b=j.format("D",Sys.CultureInfo.CurrentCulture.name)}if(c){var f=$get(d);f&&f.parentNode&&f.parentNode.replaceChild(document.createTextNode(b),f)}},"SP.DateTimeUtil.js");c=true;return b};SP.UI.MicroFeed.MicrofeedEntry.actorComparison=function(d,c){if(!d)return!c?0:1;if(!c)return-1;var a=d,b=c;return a.get_actorType()===b.get_actorType()?a.get_name().toLowerCase().localeCompare(b.get_name().toLowerCase()):!a.get_actorType()?-1:!b.get_actorType()?1:a.get_actorType()===1?-1:b.get_actorType()===1?1:a.get_actorType()===2?-1:b.get_actorType()===2?1:0};SP.UI.MicroFeed.MicrofeedEntry.prototype={get_author:function(){return this.$A_0},set_author:function(a){this.$A_0=a;return a},get_target:function(){return this.$B_0},set_target:function(a){this.$B_0=a;return a},get_postType:function(){return this.$o_0},set_postType:function(a){this.$o_0=a;return a},get_text:function(){return this.$b_0},set_text:function(a){this.$b_0=a;return a},get_id:function(){return this.$3_0},set_id:function(a){this.$3_0=a;return a},get_canReply:function(){return this.$j_0},set_canReply:function(a){this.$j_0=a;return a},get_numReplies:function(){return this.$19_0},set_numReplies:function(a){this.$19_0=a;return a},get_canDelete:function(){return this.$Z_0},set_canDelete:function(a){this.$Z_0=a;return a},get_likedByMe:function(){return this.$15_0},set_likedByMe:function(a){this.$15_0=a;return a},get_numLikers:function(){return this.$m_0},set_numLikers:function(a){this.$m_0=a;return a},get_likers:function(){return this.$16_0},set_likers:function(a){this.$16_0=a;return a},get_allLikerList:function(){return this.$h_0},set_allLikerList:function(a){this.$h_0=a;return a},get_canLike:function(){return this.$i_0},set_canLike:function(a){this.$i_0=a;return a},get_canFollowUp:function(){return this.$1f_0},set_canFollowUp:function(a){this.$1f_0=a;return a},get_isFollowedByMe:function(){return this.$k_0},set_isFollowedByMe:function(a){this.$k_0=a;return a},get_isLocked:function(){return this.$l_0},set_isLocked:function(a){this.$l_0=a;return a},get_canLock:function(){return this.$1M_0},set_canLock:function(a){this.$1M_0=a;return a},get_isActivityPost:function(){return!this.$J_0&&!this.$i_0&&!this.$j_0&&!this.$1M_0&&!this.$l_0&&(this.$1_0===6||this.$1_0===1)},get_renderPostAuthorImage:function(){return this.$p_0},set_renderPostAuthorImage:function(a){this.$p_0=a;return a},get_postImagePath:function(){return this.$1B_0},set_postImagePath:function(a){this.$1B_0=a;return a},get_postSource:function(){return this.$1P_0},set_postSource:function(a){this.$1P_0=a;return a},get_postSourceUri:function(){return this.$1m_0},set_postSourceUri:function(a){this.$1m_0=a;return a},get_footer:function(){return this.$13_0},set_footer:function(a){this.$13_0=a;return a},get_attachment:function(){return this.$I_0},set_attachment:function(a){this.$I_0=a;return a},get_pictureSize:function(){return this.$n_0},set_pictureSize:function(a){this.$n_0=a;return a},get_actors:function(){return this.$S_0},set_actors:function(a){this.$S_0=a;return a},get_permalink:function(){return this.$O_0},set_permalink:function(a){this.$O_0=a;return a},$A_0:null,$B_0:null,$o_0:0,$b_0:null,$3_0:null,$j_0:false,$19_0:0,$Z_0:false,$15_0:false,$m_0:0,$16_0:null,$h_0:null,$i_0:false,$1f_0:false,$k_0:false,$l_0:false,$1M_0:false,$p_0:false,$1B_0:null,$1P_0:null,$1m_0:null,$13_0:null,$I_0:null,$n_0:0,$S_0:null,$O_0:null,$2J_0:false,get_isHidden:function(){return this.$2J_0},set_isHidden:function(a){this.$2J_0=a;return a},$1_0:0,get_drawPostType:function(){return this.$1_0},set_drawPostType:function(a){this.$1_0=a;return a},$6_0:null,get_refRootPost:function(){return this.$6_0},set_refRootPost:function(a){this.$6_0=a;return a},$9_0:null,get_threadDivID:function(){return this.$9_0},set_threadDivID:function(a){this.$9_0=a;return a},$4_0:null,get_postIDForDrawPost:function(){return this.$4_0},set_postIDForDrawPost:function(a){this.$4_0=a;return a},$J_0:false,get_isOrphan:function(){return this.$J_0},set_isOrphan:function(a){this.$J_0=a;return a},$1g_0:false,get_drawAsIndentedOrphan:function(){return this.$1g_0},set_drawAsIndentedOrphan:function(a){this.$1g_0=a;return a},$F_0:false,get_isRoot:function(){return this.$F_0},set_isRoot:function(a){this.$F_0=a;return a}};SP.UI.MicroFeed.MicrofeedMenu=function(i,e,b,d,h,c,g,f,a){SP.UI.MicroFeed.MicrofeedMenu.initializeBase(this,[i]);if(!SP.ScriptHelpers.isNullOrEmptyString(b)){this.set_imageSourceOverride(GetThemedImageUrl(b));this.set_imageTitleText(d);!SP.ScriptHelpers.isNullOrEmptyString(a)&&this.set_imageParentClassOverride(a)}!h&&this.set_textOverride(SP.UI.MySiteCommon.MySiteMenu.emptyStringPromptConst);this.$1N_1=e;this.$4m_1=c;this.$4p_1=g;this.$4n_1=f;this.set_hideIcons(true)};SP.UI.MicroFeed.MicrofeedMenu.prototype={$1N_1:"",$4m_1:"",$4p_1:"",$4n_1:"",setStyles:function(){this.set_menuStyle("ms-textLarge ms-headerFont");this.set_controlImageStyle("ms-microfeed-mysitemenu-image");this.set_controlStyle("");this.set_controlElementType("");this.set_controlHeaderStyle("");!SP.ScriptHelpers.isNullOrEmptyString(this.$4m_1)&&this.set_controlStyle(this.$4m_1);!SP.ScriptHelpers.isNullOrEmptyString(this.$1N_1)&&this.set_controlElementType(this.$1N_1);!SP.ScriptHelpers.isNullOrEmptyString(this.$4p_1)&&this.set_controlImageStyle(this.$4p_1);!SP.ScriptHelpers.isNullOrEmptyString(this.$4n_1)&&this.set_controlHeaderStyle(this.$4n_1)},setOpenedCallback:function(a){this.set_openedCallback(a)},addRootPostDropDownItem:function(b,a){var c=this;this.add(b,null,null,null,function(){a()})},addSeparator:function(){var a=new SP.UI.MySiteCommon.SeparatorMenuItem;this.appendMenuItem(a)}};SP.UI.MicroFeed.MicroFeedDoc=function(){};SP.UI.MicroFeed.MicroFeedDoc.$5h=function(a,b){return SP.UI.MicroFeed.MicroFeedDoc.$5i(a,SP.UI.MicroFeed.SPMicroFeed.$3M+b,true)};SP.UI.MicroFeed.MicroFeedDoc.$5j=function(b,a){return SP.UI.MicroFeed.MicroFeedDoc.$5i(b,!a?SP.UI.MicroFeed.SPMicroFeed.$2N:SP.UI.MicroFeed.SPMicroFeed.$2C+a,false)};SP.UI.MicroFeed.MicroFeedDoc.$5i=function(e,c,d){var a=document.createElement("div"),b;a.id=c;if(d)a.className=SP.UI.MicroFeed.SPMicroFeed.$3L;b=SP.UI.MicroFeed.MicroFeedDoc.$8m(e,c,d);a.appendChild(b);return a};SP.UI.MicroFeed.MicroFeedDoc.$8m=function(d,h,g){var b,c,f;b=document.createElement("div");b.className="ms-microfeed-attachment";c=document.createElement("div");c.innerHTML='<span class="ms-microfeed-attachment-title">'+SP.UI.MySiteCommon.CommonUIElements.createSafeAnchorHTML("",d.get_name(),"ms-textSmall ms-subtleLink",d.get_uri(),'target="_blank"',true)+'</span><span class="ms-microfeed-attachment-url ms-metadata">'+STSHtmlEncode(d.get_contentUri())+"</span>";var a;if(g){var e=document.createElement("span");a=document.createElement("a");e.className="ms-microfeed-attachment-action";a.className="ms-secondaryCommandLink";a.style.textDecoration="none";SP.UI.MySiteCommon.CommonUIElements.setElementText(a,SpsClient.ScriptResources.docPreview);e.appendChild(a);c.appendChild(e)}else a=null;f=SP.UI.MicroFeed.MicroFeedDoc.$6p(d,h,a,g);b.appendChild(f);b.appendChild(c);return b};SP.UI.MicroFeed.MicroFeedDoc.$6p=function(b,d,c,i){var a=document.createElement("div"),g='alt="'+b.get_name()+'" style="vertical-align:top; margin-bottom:10px;"',e=SP.UI.MySiteCommon.CommonUIElements.createSafeImageHTML(SP.UI.MicroFeed.MicroFeedDoc.$7C+d,"",b.get_previewUri(),g);a.id="ms-microfeed-previewAreaDiv_"+d;a.className="ms-microfeed-previewArea";if(i&&null!==b.get_clickAction()){var f=null;switch(b.get_clickAction().get_actionKind()){case 1:c.href="#";c.setAttribute("onclick","return false;");f=function(){var e=document.createElement("iframe");e.id="ms-microfeed-attachment-inlineDocIframe_"+d;e.src=b.get_clickAction().get_actionUri();e.className="ms-microfeed-attachment-inlineDoc";a.parentNode.appendChild(e);a.parentNode.removeChild(a);c.parentNode.removeChild(c)};$addHandler(c,"click",f);break;case 0:c.href=b.get_clickAction().get_actionUri();c.target="_blank"}var h='target="_blank" style="vertical-align:top;"';a.innerHTML=SP.UI.MySiteCommon.CommonUIElements.createSafeAnchorHTML("ms-microfeed-attachmentDocLink_"+d,e,"",b.get_uri(),h,false)}else a.innerHTML=e;return a};SP.UI.MicroFeed.MicroFeedVideo=function(){};SP.UI.MicroFeed.MicroFeedVideo.$5l=function(a,b){return SP.UI.MicroFeed.MicroFeedVideo.$5m(a,SP.UI.MicroFeed.SPMicroFeed.$3M+b,true)};SP.UI.MicroFeed.MicroFeedVideo.$5n=function(b,a){return SP.UI.MicroFeed.MicroFeedVideo.$5m(b,!a?SP.UI.MicroFeed.SPMicroFeed.$2N:SP.UI.MicroFeed.SPMicroFeed.$2C+a,false)};SP.UI.MicroFeed.MicroFeedVideo.$5m=function(e,c,d){var a=document.createElement("div"),b;a.id=c;if(d)a.className=SP.UI.MicroFeed.SPMicroFeed.$3L;b=SP.UI.MicroFeed.MicroFeedVideo.$8v(e,c,d);a.appendChild(b);return a};SP.UI.MicroFeed.MicroFeedVideo.$8v=function(a,j,k){var b,c,i;b=document.createElement("div");b.className="ms-microfeed-attachment";c=document.createElement("div");var e=document.createElement("span");e.className="ms-microfeed-attachment-title";e.innerHTML=SP.UI.MySiteCommon.CommonUIElements.createSafeAnchorHTML("videoTitle_"+j,a.get_name(),"ms-textSmall ms-subtleLink",a.get_uri(),'target="_blank"',true);c.appendChild(e);var f=a.get_uri().split("/"),g="";if(f.length>=3)g=String.format("{0}//{1}",f[0],f[2]);else g=a.get_uri();var h=document.createElement("span");SP.UI.MySiteCommon.CommonUIElements.setElementText(h,g);h.className="ms-metadata";c.appendChild(h);var d=document.createElement("span");d.className="ms-metadata ms-microfeed-attachment-description";SP.UI.MySiteCommon.CommonUIElements.setElementText(d,null!==a.get_description()?a.get_description():"");c.appendChild(d);i=SP.UI.MicroFeed.MicroFeedVideo.$6p(a,j,k,d);b.appendChild(i);b.appendChild(c);return b};SP.UI.MicroFeed.MicroFeedVideo.$6p=function(a,h,n,i){var b=document.createElement("div"),e='alt="'+a.get_name()+'"',j=120,d=0;if(a.get_width()&&a.get_height()){var m=a.get_height()/a.get_width();d=120*m}else d=67;e+=' width="'+j+'" height="'+d+'"';var k=(d-67)/2,l=String.format("{0}px",k);e+=' style="bottom:'+l+'"';var g=SP.UI.MySiteCommon.CommonUIElements.createSafeImageHTML(SP.UI.MicroFeed.MicroFeedVideo.$7D+h,"ms-microfeed-videoThumbnail",a.get_previewUri(),e);b.className="ms-microfeed-previewArea ms-microfeed-videoPreviewArea";if(n&&null!==a.get_clickAction()){var f=null,c=document.createElement("a");c.id="ms-microfeed-attachmentVideoLink_"+h;c.style.verticalAlign="top";switch(a.get_clickAction().get_actionKind()){case 1:c.href="javascript:return false;";f=function(){var c;c=document.createElement("iframe");c.src=a.get_clickAction().get_actionUri();var d=b.parentNode;d.appendChild(c);c.className="ms-microfeed-embeddedVideo";c.style.width=d.clientWidth.toString()+"px";c.style.height=(9*d.clientWidth/16).toString()+"px";d.removeChild(b);i.parentNode.removeChild(i)};$addHandler(c,"click",f);break;case 0:c.href=SP.UI.MySiteCommon.CommonUIElements.encodeSafeURL(a.get_clickAction().get_actionUri());c.target="_blank"}c.innerHTML=g;b.appendChild(c);SP.UI.MicroFeed.MicroFeedVideo.$83(b,f)}else b.innerHTML=g;SP.UI.MicroFeed.MicroFeedVideo.$89(b,a.get_length());return b};SP.UI.MicroFeed.MicroFeedVideo.$83=function(e,c){var a=document.createElement("div");a.className="ms-microfeed-videoPlay";var b=document.createElement("a");b.href="javascript:return false;";b.title=SpsClient.ScriptResources.videoPlayButtonTitle;var d=document.createElement("span");b.appendChild(d);a.appendChild(b);c&&$addHandler(a,"click",c);e.appendChild(a)};SP.UI.MicroFeed.MicroFeedVideo.$8u=function(g){var b,c,d,e,f,h,a=new Sys.StringBuilder;b=3600;c=60;d=g/b|0;e=g%b/c|0;f=g%c|0;if(h=d>0){a.append(d.toString());a.append(":")}h&&e<10&&a.append("0");a.append(e.toString());a.append(":");f<10&&a.append("0");a.append(f.toString());return a.toString()};SP.UI.MicroFeed.MicroFeedVideo.$89=function(c,d){var a=document.createElement("div");a.className="ms-microfeed-videoTime";var b=document.createElement("span");SP.UI.MySiteCommon.CommonUIElements.setElementText(b,SP.UI.MicroFeed.MicroFeedVideo.$8u(d));a.appendChild(b);c.appendChild(a)};SP.UI.MicroFeed.SuggestionQueryManager=function(){this.$2U_0={};this.$1G_0={};this.$3c_0={}};SP.UI.MicroFeed.SuggestionQueryManager.prototype={$2U_0:null,$1G_0:null,get_possibleSuggestions:function(){return this.$1G_0},lastKnownEmptySuggestion:"",m_loadingAnimationIDForRequest:"",get_loadingAnimationIDForRequest:function(){return this.m_loadingAnimationIDForRequest},m_maxSuggestionsToDisplay:0,$3c_0:null,get_uniqueIDs:function(){return this.$3c_0},$1n_0:false,get_processingRequest:function(){return this.$1n_0},set_processingRequest:function(a){this.$1n_0=a;return a},$2T_0:null,get_lastRequest:function(){return this.$2T_0},set_lastRequest:function(a){this.$2T_0=a;return a},$99_0:function(a,b){this.getPossibleSuggestions(a,b)},$88_0:function(a){if(!this.suggestionsContains(a)){var b=a.$a_0.substr(0,1).toLowerCase(),c=b in this.$1G_0?this.$1G_0[b]:[];this.$1G_0[b]=a.insertIntoSortedArray(c);this.$3c_0[a.$3_0]=true}},$8s_0:function(c){var b=null,a=c.toLowerCase();if(!(a in this.$1G_0))this.$1G_0[a]=[];b=this.$1G_0[a];return b},suggestionsContains:function(a){return this.suggestionsContainsByID(a.$3_0)},suggestionsContainsByID:function(a){return a in this.$3c_0},isThisPrefixInQueriedForPrefixDictionary:function(a){return a.toLowerCase()in this.$2U_0},isThisPrefixAlreadyCoveredInTheCollection:function(b,d){if(this.isThisPrefixInQueriedForPrefixDictionary(b))return true;for(var a=null,c=b.length-1;c>0;c--){a=this.getValueForQueriedPrefix(b.substr(0,c));if(SP.ScriptHelpers.isNullOrEmptyString(a))continue;if(a==="empty"){this.setValueForQueriedPrefix(b,0);return true}if(a==="processing")return true;if(Number.parseInvariant(a)>=this.m_maxSuggestionsToDisplay)return false;if(d)return true}return false},prepareForRequestIfReady:function(c){if(this.$1n_0)return false;if(this.$2T_0){var a=new Date,b=a-this.$2T_0;if(b<500)return false}this.$1n_0=true;this.$2T_0=new Date;this.markPrefixProcessing(c);return true},handleCompletedRequest:function(b,d,e,c){this.$1n_0=false;if(e)this.setValueForQueriedPrefix(b,d);else this.clearPrefixProcessingOnError(b);var a=$get(this.m_loadingAnimationIDForRequest);a&&a.parentNode&&a.parentNode.removeChild(a);c&&c()},getValueForQueriedPrefix:function(a){return this.isThisPrefixInQueriedForPrefixDictionary(a)?this.$2U_0[a.toLowerCase()]:""},setValueForQueriedPrefix:function(a,b){if(!b)this.$5I_0(a,"empty");else this.$5I_0(a,b.toString())},markPrefixProcessing:function(a){this.$5I_0(a,"processing")},clearPrefixProcessingOnError:function(a){if(this.getValueForQueriedPrefix(a)==="processing")delete this.$2U_0[a.toLowerCase()]},$5I_0:function(a,b){this.$2U_0[a.toLowerCase()]=b}};SP.UI.MicroFeed.AllUsersSuggestionManager=function(a){SP.UI.MicroFeed.AllUsersSuggestionManager.initializeBase(this);this.m_maxSuggestionsToDisplay=a;this.m_loadingAnimationIDForRequest="ms-microfeed-LoadingCompanyUsersImage"};SP.UI.MicroFeed.AllUsersSuggestionManager.prototype={getPossibleSuggestions:function(b,c){var a=b.toLowerCase();if(b.length<2)return;!this.isThisPrefixAlreadyCoveredInTheCollection(a,false)&&this.$9F_1(a,c)},$9L_1:function(b){var a=b.toLowerCase();if(this.lastKnownEmptySuggestion===""||!a.startsWith(this.lastKnownEmptySuggestion))this.lastKnownEmptySuggestion=a},$92_1:function(a){return SP.ScriptHelpers.isNullOrEmptyString(this.lastKnownEmptySuggestion)?false:a.toLowerCase().startsWith(this.lastKnownEmptySuggestion)},$9F_1:function(a,c){if(!this.prepareForRequestIfReady(a))return;var b=this;SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){var e=SP.ClientContext.get_current(),d=new SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters;d.set_allowMultipleEntities(false);d.set_maximumEntitySuggestions(50);d.set_principalType(1);d.set_principalSource(15);d.set_queryString(a);var f=SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.clientPeoplePickerSearchUser(e,d);e.executeQueryAsync(function(){var d=e.parseObjectFromJsonString(f.get_value()),h=0,j="",k="",i="",g=null;if(d){!d.length&&b.$9L_1(a);for(h=0;h<d.length;h++){g=d[h];j=g.Key;k=g.DisplayText;i="";if(g.EntityData)i=g.EntityData.Title;var l=new SP.UI.MicroFeed.TextBoxElement(k,j,0);l.$2H_0=i;b.$88_0(l)}}b.handleCompletedRequest(a,!d?0:d.length,true,c)},function(){b.handleCompletedRequest(a,0,false,null)})})}};SP.UI.MicroFeed.BaseAtMention.registerClass("SP.UI.MicroFeed.BaseAtMention");SP.UI.MicroFeed.AtMention.registerClass("SP.UI.MicroFeed.AtMention",SP.UI.MicroFeed.BaseAtMention);SP.UI.MicroFeed.TextBoxElement.registerClass("SP.UI.MicroFeed.TextBoxElement");SP.UI.MicroFeed.AtMentionMenuOption.registerClass("SP.UI.MicroFeed.AtMentionMenuOption");SP.UI.MicroFeed.OwnerControlState.registerClass("SP.UI.MicroFeed.OwnerControlState");SP.UI.MicroFeed.SocialActorCache.registerClass("SP.UI.MicroFeed.SocialActorCache");SP.UI.MicroFeed.MicrofeedThreadCache.registerClass("SP.UI.MicroFeed.MicrofeedThreadCache");SP.UI.MicroFeed.MicrofeedThreadList.registerClass("SP.UI.MicroFeed.MicrofeedThreadList");SP.UI.MicroFeed.MicroFeedView.registerClass("SP.UI.MicroFeed.MicroFeedView");SP.UI.MicroFeed.AttributePair.registerClass("SP.UI.MicroFeed.AttributePair");SP.UI.MicroFeed.SPMicroFeed.registerClass("SP.UI.MicroFeed.SPMicroFeed");SP.UI.MicroFeed.AllLikerDisplayManager.registerClass("SP.UI.MicroFeed.AllLikerDisplayManager");SP.UI.MicroFeed.MicrofeedEntry.registerClass("SP.UI.MicroFeed.MicrofeedEntry");SP.UI.MicroFeed.MicrofeedMenu.registerClass("SP.UI.MicroFeed.MicrofeedMenu",SP.UI.MySiteCommon.MySiteMenu);SP.UI.MicroFeed.MicroFeedDoc.registerClass("SP.UI.MicroFeed.MicroFeedDoc");SP.UI.MicroFeed.MicroFeedVideo.registerClass("SP.UI.MicroFeed.MicroFeedVideo");SP.UI.MicroFeed.SuggestionQueryManager.registerClass("SP.UI.MicroFeed.SuggestionQueryManager");SP.UI.MicroFeed.AllUsersSuggestionManager.registerClass("SP.UI.MicroFeed.AllUsersSuggestionManager",SP.UI.MicroFeed.SuggestionQueryManager);function sp_ui_microfeed_initialize(){SP.UI.MicroFeed.AtMention.$76=new RegExp("\x0d\x0a","g");SP.UI.MicroFeed.BaseAtMention.$2M=10;SP.UI.MicroFeed.BaseAtMention.$1E=null;SP.UI.MicroFeed.BaseAtMention.$3X=null;SP.UI.MicroFeed.BaseAtMention.$5G="_mentionselectordiv";SP.UI.MicroFeed.BaseAtMention.$1c="ms-mentioncontainerdiv";SP.UI.MicroFeed.BaseAtMention.$R="_atmentiondiv_";SP.UI.MicroFeed.BaseAtMention.$4k="ms-microfeed-LoadingFollowedUsersImage";SP.UI.MicroFeed.BaseAtMention.$3f="ms-microfeed-typeAheadElementSelected";SP.UI.MicroFeed.BaseAtMention.$23="ms-microfeed-typeAheadElementName";SP.UI.MicroFeed.BaseAtMention.$21="DisplayName";SP.UI.MicroFeed.BaseAtMention.$3l="alias";SP.UI.MicroFeed.BaseAtMention.$1U="TextBoxID";SP.UI.MicroFeed.BaseAtMention.emptyGuid="00000000-0000-0000-0000-000000000000";SP.UI.MicroFeed.BaseAtMention.hashTagsTermSetId="3CEB0050-69A1-40E7-A427-83E2FAC80C27";SP.UI.MicroFeed.BaseAtMention.tagSuggestions=null;SP.UI.MicroFeed.BaseAtMention.tagSuggestionDiv=null;SP.UI.MicroFeed.BaseAtMention.disallowedHashTagCharsRegex=new RegExp("[\\u0000-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007F\\u3000\\u00A0\\u1680\\u180E\\u2000-\\u200A\\u202F\\u205F]");SP.UI.MicroFeed.SocialActorCache.$11=null;SP.UI.MicroFeed.MicrofeedThreadCache.$11=null;SP.UI.MicroFeed.SPMicroFeed.microfeed=null;SP.UI.MicroFeed.SPMicroFeed.maxResolvedMentions=3;SP.UI.MicroFeed.SPMicroFeed.characterLimit=512;SP.UI.MicroFeed.SPMicroFeed.$N=null;SP.UI.MicroFeed.SPMicroFeed.$1t=0;SP.UI.MicroFeed.SPMicroFeed.$L=null;SP.UI.MicroFeed.SPMicroFeed.$Q=null;SP.UI.MicroFeed.SPMicroFeed.$r=false;SP.UI.MicroFeed.SPMicroFeed.$1S=false;SP.UI.MicroFeed.SPMicroFeed.$3b=false;SP.UI.MicroFeed.SPMicroFeed.$2V=false;SP.UI.MicroFeed.SPMicroFeed.$1R=false;SP.UI.MicroFeed.SPMicroFeed.$1Q=false;SP.UI.MicroFeed.SPMicroFeed.$3Z=null;SP.UI.MicroFeed.SPMicroFeed.$5E=false;SP.UI.MicroFeed.SPMicroFeed.$3Y=true;SP.UI.MicroFeed.SPMicroFeed.$1v=null;SP.UI.MicroFeed.SPMicroFeed.$1F=20;SP.UI.MicroFeed.SPMicroFeed.$7S=20;SP.UI.MicroFeed.SPMicroFeed.$W=false;SP.UI.MicroFeed.SPMicroFeed.$1T=null;SP.UI.MicroFeed.SPMicroFeed.$H=null;SP.UI.MicroFeed.SPMicroFeed.$e=null;SP.UI.MicroFeed.SPMicroFeed.$3a=0;SP.UI.MicroFeed.SPMicroFeed.$s=browseris.ie8down||browseris.ie8standard;SP.UI.MicroFeed.SPMicroFeed.$1u=null;SP.UI.MicroFeed.SPMicroFeed.$2S=null;SP.UI.MicroFeed.SPMicroFeed.$t="MyThreadLikeCount";SP.UI.MicroFeed.SPMicroFeed.$Y="attachId";SP.UI.MicroFeed.SPMicroFeed.$1K="hasLinks";SP.UI.MicroFeed.SPMicroFeed.$2G="hasHover";SP.UI.MicroFeed.SPMicroFeed.$2F="hasFocus";SP.UI.MicroFeed.SPMicroFeed.$v="updatingLinkId";SP.UI.MicroFeed.SPMicroFeed.$38="AttachmentImageButton";SP.UI.MicroFeed.SPMicroFeed.$4H="FollowButtonFor";SP.UI.MicroFeed.SPMicroFeed.$2e="displayInMyLikesView";SP.UI.MicroFeed.SPMicroFeed.targetAttribute="targetDisplayName";SP.UI.MicroFeed.SPMicroFeed.$1s="ms-microfeeddiv";SP.UI.MicroFeed.SPMicroFeed.$7O="ms-microfeed-fullMicrofeedDiv";SP.UI.MicroFeed.SPMicroFeed.$d="ms-microfeed-button";SP.UI.MicroFeed.SPMicroFeed.$7N="ms-microfeed-deleteButton";SP.UI.MicroFeed.SPMicroFeed.$3V="ms-microfeed-deleteButtonImageParent";SP.UI.MicroFeed.SPMicroFeed.$3U="ms-microfeed-deleteButtonImage";SP.UI.MicroFeed.SPMicroFeed.$5B="ms-microfeed-editLinkButton";SP.UI.MicroFeed.SPMicroFeed.$5A="ms-textSmall ms-secondaryCommandLink";SP.UI.MicroFeed.SPMicroFeed.$7Q="ms-microfeed-linkSeparator ms-textSmall";SP.UI.MicroFeed.SPMicroFeed.$7P="ms-microfeed-rightAlignedDiv";SP.UI.MicroFeed.SPMicroFeed.$3W="ms-floatRight";SP.UI.MicroFeed.SPMicroFeed.$5C="ms-microfeed-floatLeft";SP.UI.MicroFeed.SPMicroFeed.$5D="ms-microfeed-greyout";SP.UI.MicroFeed.SPMicroFeed.$7G="ms-microblogdiv";SP.UI.MicroFeed.SPMicroFeed.$7F="ms-microfeed-microblogpart";SP.UI.MicroFeed.SPMicroFeed.$1D="ms-microbloginputbox";SP.UI.MicroFeed.SPMicroFeed.$53="ms-microfeed-postBox ms-textSmall";SP.UI.MicroFeed.SPMicroFeed.$3R="ms-microbloginputboxmentionhighlightdiv";SP.UI.MicroFeed.SPMicroFeed.$7J="ms-microfeed-mentionHighlightDiv";SP.UI.MicroFeed.SPMicroFeed.$2P="ms-helperText";SP.UI.MicroFeed.SPMicroFeed.$54="ms-microfeed-defaultTextColor";SP.UI.MicroFeed.SPMicroFeed.$3T="ms-microfeed-rootOrReplyPostBox";SP.UI.MicroFeed.SPMicroFeed.$57="ms-microblogInputFocus";SP.UI.MicroFeed.SPMicroFeed.$55="ms-microfeed-focusBox";SP.UI.MicroFeed.SPMicroFeed.$2Q="ms-microfeed-focusBoxNoFocus";SP.UI.MicroFeed.SPMicroFeed.$56="ms-microfeed-focusBoxInFocus";SP.UI.MicroFeed.SPMicroFeed.$1p="ms-microfeed-editLinkDiv";SP.UI.MicroFeed.SPMicroFeed.$2R="ms-microfeed-newAttachment";SP.UI.MicroFeed.SPMicroFeed.$3N="ms-microfeed-attachmentPreviewImage";SP.UI.MicroFeed.SPMicroFeed.$2N="ms-microfeed-attachmentPreviewRich";SP.UI.MicroFeed.SPMicroFeed.$1o="ms-microfeed-attachmentImage_";SP.UI.MicroFeed.SPMicroFeed.$1r="ms-microfeed-editLinkTextBox";SP.UI.MicroFeed.SPMicroFeed.$3P="ms-microfeed-editLinkDisplayTextTextBox";SP.UI.MicroFeed.SPMicroFeed.$7H="ms-microfeed-editLinkDiv ms-textSmall";SP.UI.MicroFeed.SPMicroFeed.$52="ms-microfeed-editLinkTextBox";SP.UI.MicroFeed.SPMicroFeed.$3O="ms-microfeed-editLinkButton";SP.UI.MicroFeed.SPMicroFeed.$7I="ms-microfeed-editUrlSpan";SP.UI.MicroFeed.SPMicroFeed.$7E="ms-microfeed-displayLinkAsSpan";SP.UI.MicroFeed.SPMicroFeed.$51="ms-microfeed-displayLinkAsSpan";SP.UI.MicroFeed.SPMicroFeed.$1q="ms-microfeed-editLinkErrorMessage";SP.UI.MicroFeed.SPMicroFeed.$3S="ms-microfeed-revertEditLinkDivLink";SP.UI.MicroFeed.SPMicroFeed.$3Q="ms-microfeed-textBoxElements";SP.UI.MicroFeed.SPMicroFeed.$59="ms-mbRightSpan";SP.UI.MicroFeed.SPMicroFeed.$7L="ms-microfeed-postButtonSpan";SP.UI.MicroFeed.SPMicroFeed.$7M="ms-microfeed-postReplyButtonSpan ms-floatRight";SP.UI.MicroFeed.SPMicroFeed.$V="ms-postbutton";SP.UI.MicroFeed.SPMicroFeed.$58="ms-microfeed-postButton ms-button-emphasize ms-floatRight";SP.UI.MicroFeed.SPMicroFeed.$1C="ms-microblogcharacterlimitlabel";SP.UI.MicroFeed.SPMicroFeed.$4z="ms-microfeed-characterLimit";SP.UI.MicroFeed.SPMicroFeed.$50="ms-microfeed-tooManyCharactersLabel";SP.UI.MicroFeed.SPMicroFeed.$2O="ms-microfeed-closeToLimitCharLabel";SP.UI.MicroFeed.SPMicroFeed.$3K="ms-addImageButton";SP.UI.MicroFeed.SPMicroFeed.$4y="ms-microfeed-attachmentButton";SP.UI.MicroFeed.SPMicroFeed.$4w="ms-microfeed-addImageButtonImage";SP.UI.MicroFeed.SPMicroFeed.$4x="ms-microfeed-addImageButtonImageParent";SP.UI.MicroFeed.SPMicroFeed.$3M="ms-microfeed-attachment_";SP.UI.MicroFeed.SPMicroFeed.$3L="ms-microfeed-attachmentDiv";SP.UI.MicroFeed.SPMicroFeed.$1X="ms-newsfeedpartdiv";SP.UI.MicroFeed.SPMicroFeed.$6P="ms-microfeed-feedPart";SP.UI.MicroFeed.SPMicroFeed.$6h="ms-titlebardiv";SP.UI.MicroFeed.SPMicroFeed.$6g="ms-microfeed-title";SP.UI.MicroFeed.SPMicroFeed.$31="ms-currentFeedLabel";SP.UI.MicroFeed.SPMicroFeed.$4X="ms-microfeed-titleViewSelectorPivotParent";SP.UI.MicroFeed.SPMicroFeed.$6i="ms-microfeed-titleViewSelectorPivotContainer";SP.UI.MicroFeed.SPMicroFeed.$6j="ms-microfeed-titlePivotControl ms-textXLarge";SP.UI.MicroFeed.SPMicroFeed.$4O="ms-microfeed-privacyIcon";SP.UI.MicroFeed.SPMicroFeed.$2s="ms-progressSpan";SP.UI.MicroFeed.SPMicroFeed.$6U="ms-microfeed-processingDiv";SP.UI.MicroFeed.SPMicroFeed.$6W="ms-progressSpinner";SP.UI.MicroFeed.SPMicroFeed.$6V="ms-microfeed-processingImage";SP.UI.MicroFeed.SPMicroFeed.$3z="ms-microfeed-highlightedRefMention";SP.UI.MicroFeed.SPMicroFeed.$4a="ms-viewDescription";SP.UI.MicroFeed.SPMicroFeed.$6l="ms-microfeed-viewDescription";SP.UI.MicroFeed.SPMicroFeed.$26="ms-feeddiv";SP.UI.MicroFeed.SPMicroFeed.$1J="ms-feedthreadsdiv";SP.UI.MicroFeed.SPMicroFeed.$1W="ms-showMoreThreadsButton";SP.UI.MicroFeed.SPMicroFeed.$4G="ms-showMoreThreadsButtonContainer";SP.UI.MicroFeed.SPMicroFeed.$6M="ms-microfeed-seeMoreThreadsDiv";SP.UI.MicroFeed.SPMicroFeed.$6N="ms-microfeed-seeMoreThreadsDivContainer";SP.UI.MicroFeed.SPMicroFeed.$27="ms-blankfeeddiv";SP.UI.MicroFeed.SPMicroFeed.$6A="ms-microfeed-emptyThreadDiv";SP.UI.MicroFeed.SPMicroFeed.$10="ms-threaddiv_";SP.UI.MicroFeed.SPMicroFeed.$6f="ms-microfeed-thread";SP.UI.MicroFeed.SPMicroFeed.$1b="ms-rootpostcontainerdiv_";SP.UI.MicroFeed.SPMicroFeed.$30="ms-microfeed-rootDiv";SP.UI.MicroFeed.SPMicroFeed.$z="ms-threadrepliesdiv_";SP.UI.MicroFeed.SPMicroFeed.$29="ms-post_";SP.UI.MicroFeed.SPMicroFeed.$4J="ms-microfeed-message";SP.UI.MicroFeed.SPMicroFeed.$4M="ms-microfeed-messageError";SP.UI.MicroFeed.SPMicroFeed.$6Y="ms-userActivityText_";SP.UI.MicroFeed.SPMicroFeed.$6X="ms-microfeed-activityText ms-metadata";SP.UI.MicroFeed.SPMicroFeed.$4K="ms-content_";SP.UI.MicroFeed.SPMicroFeed.$6S="ms-microfeed-indentedPost";SP.UI.MicroFeed.SPMicroFeed.$3x="ms-deletebutton_";SP.UI.MicroFeed.SPMicroFeed.$4R="ms-replyInputFocus_";SP.UI.MicroFeed.SPMicroFeed.$1Y="ms-microfeed-editLinkDiv_";SP.UI.MicroFeed.SPMicroFeed.$2B="ms-microfeed-newAttachment_";SP.UI.MicroFeed.SPMicroFeed.$2u="ms-microfeed-attachmentPreviewImage_";SP.UI.MicroFeed.SPMicroFeed.$2C="ms-microfeed-attachmentPreviewRich_";SP.UI.MicroFeed.SPMicroFeed.$1a="ms-microfeed-editLinkTextBox_";SP.UI.MicroFeed.SPMicroFeed.$2w="ms-microfeed-editLinkDisplayTextTextBox_";SP.UI.MicroFeed.SPMicroFeed.$2v="ms-microfeed-editLinkButton_";SP.UI.MicroFeed.SPMicroFeed.$6b="ms-microfeed-editUrlSpan_";SP.UI.MicroFeed.SPMicroFeed.$6a="ms-microfeed-displayLinkAsSpan_";SP.UI.MicroFeed.SPMicroFeed.$1Z="ms-microfeed-editLinkErrorMessage_";SP.UI.MicroFeed.SPMicroFeed.$2t="ms-addImageButton_";SP.UI.MicroFeed.SPMicroFeed.$1I="ms-createreplydiv_";SP.UI.MicroFeed.SPMicroFeed.$2x="ms-replyinput_";SP.UI.MicroFeed.SPMicroFeed.$4Q="ms-microfeed-postBox ms-textSmall";SP.UI.MicroFeed.SPMicroFeed.$2z="ms-replyinputmentionhighlightdiv_";SP.UI.MicroFeed.SPMicroFeed.$6c="ms-microfeed-replyMentionHighlightDiv";SP.UI.MicroFeed.SPMicroFeed.$2y="ms-microfeed-replyBoxIndentDiv";SP.UI.MicroFeed.SPMicroFeed.$6J="ms-footer_";SP.UI.MicroFeed.SPMicroFeed.$6I="ms-microfeed-messageFooter";SP.UI.MicroFeed.SPMicroFeed.$28=SP.UI.MicroFeed.SPMicroFeed.$d+" "+SP.UI.MicroFeed.SPMicroFeed.$5A+" ms-microfeed-footerButton";SP.UI.MicroFeed.SPMicroFeed.$4L="ms-microfeed-mysitemenu-control ms-textSmall";SP.UI.MicroFeed.SPMicroFeed.$25="ms-userthumbnailarea_";SP.UI.MicroFeed.SPMicroFeed.$2k="newreply_";SP.UI.MicroFeed.SPMicroFeed.$42="ms-likebutton_";SP.UI.MicroFeed.SPMicroFeed.$6G="ms-lockedspan_";SP.UI.MicroFeed.SPMicroFeed.$6Z="ms-replybutton_";SP.UI.MicroFeed.SPMicroFeed.$6B="ms-followbutton_";SP.UI.MicroFeed.SPMicroFeed.$y="ms-postreplybutton_";SP.UI.MicroFeed.SPMicroFeed.$6D="ms-hidedeleteinfodiv_";SP.UI.MicroFeed.SPMicroFeed.$3y="ms-hiddenelementsdiv_";SP.UI.MicroFeed.SPMicroFeed.$6C="ms-microfeed-deleteDiv";SP.UI.MicroFeed.SPMicroFeed.$4N="ms-PostPreview_";SP.UI.MicroFeed.SPMicroFeed.$6T="ms-PostPreviewContainer_";SP.UI.MicroFeed.SPMicroFeed.$2A="ms-microfeed-replyArea";SP.UI.MicroFeed.SPMicroFeed.$4B="ms-seeMoreReplies_";SP.UI.MicroFeed.SPMicroFeed.$4E="ms-microfeed-seeMoreRepliesDiv";SP.UI.MicroFeed.SPMicroFeed.$6L="ms-microfeed-seeFullThread ms-textSmall";SP.UI.MicroFeed.SPMicroFeed.$4D="ms-floatLeft ms-secondaryCommandLink ms-microfeed-seeMoreReplies";SP.UI.MicroFeed.SPMicroFeed.$4F="ms-microfeed-moreRepliesImageParent";SP.UI.MicroFeed.SPMicroFeed.$2p="ms-floatLeft ms-microfeed-moreRepliesImageDown";SP.UI.MicroFeed.SPMicroFeed.$4A="ms-floatLeft ms-microfeed-moreRepliesImageUp";SP.UI.MicroFeed.SPMicroFeed.$6K="ms-moreRepliesButton_";SP.UI.MicroFeed.SPMicroFeed.$2o="ms-moreRepliesImageParent_";SP.UI.MicroFeed.SPMicroFeed.$4C="ms-moreRepliesImage_";SP.UI.MicroFeed.SPMicroFeed.$2D="ms-toggleReplies_";SP.UI.MicroFeed.SPMicroFeed.$4Y="ms-toggleRepliesButton_";SP.UI.MicroFeed.SPMicroFeed.$32="ms-toggleRepliesImage_";SP.UI.MicroFeed.SPMicroFeed.$6k="ms-toggleRepliesImageParent_";SP.UI.MicroFeed.SPMicroFeed.$33="ms-toggleRepliesText_";SP.UI.MicroFeed.SPMicroFeed.$64="ms-activityImage_";SP.UI.MicroFeed.SPMicroFeed.$69="ms-text_";SP.UI.MicroFeed.SPMicroFeed.$68="ms-microfeed-text";SP.UI.MicroFeed.SPMicroFeed.$4S="ms-likecount_";SP.UI.MicroFeed.SPMicroFeed.$44="ms-likeimage_";SP.UI.MicroFeed.SPMicroFeed.$47="ms-likeimageparent_";SP.UI.MicroFeed.SPMicroFeed.$46="ms-microfeed-likeImageParent";SP.UI.MicroFeed.SPMicroFeed.$43="ms-microfeed-likeImage";SP.UI.MicroFeed.SPMicroFeed.$45="ms-microfeed-likeImageLikedByMe";SP.UI.MicroFeed.SPMicroFeed.$48="ms-likeIndicatorSpanID_";SP.UI.MicroFeed.SPMicroFeed.$41="ms-microfeed-LikerAnchor ms-bold ms-subtleLink";SP.UI.MicroFeed.SPMicroFeed.$4U="ms-replyLikeIndicatorOuterSpanID_";SP.UI.MicroFeed.SPMicroFeed.$6e="ms-textSmall";SP.UI.MicroFeed.SPMicroFeed.$49="ms-likesindicator_";SP.UI.MicroFeed.SPMicroFeed.$6E="ms-microfeed-likesIndicatorText ms-metadata ms-link";SP.UI.MicroFeed.SPMicroFeed.$6F="likersListSpan_";SP.UI.MicroFeed.SPMicroFeed.$6d="ms-replyLikeCountImageSpanID_";SP.UI.MicroFeed.SPMicroFeed.$4T="ms-ReplyLikeCountImageLinkID_";SP.UI.MicroFeed.SPMicroFeed.$4W="ms-seeAllLikersAnchor_";SP.UI.MicroFeed.SPMicroFeed.$6R="ms-postBody_";SP.UI.MicroFeed.SPMicroFeed.$6Q="ms-microfeed-postBody ms-textSmall";SP.UI.MicroFeed.SPMicroFeed.$40="ms-iconimage_";SP.UI.MicroFeed.SPMicroFeed.$4V="ms-microfeed-userThumbnailAreaRootPadding";SP.UI.MicroFeed.SPMicroFeed.$4P="ms-microfeed-userThumbnailAreaReplyPadding";SP.UI.MicroFeed.SPMicroFeed.$2n="ms-body_";SP.UI.MicroFeed.SPMicroFeed.$6H="ms-microfeed-messageBody";SP.UI.MicroFeed.SPMicroFeed.$4Z="ms-microfeed-unsubscribelink";SP.UI.MicroFeed.SPMicroFeed.$34="ms-microfeed-unsubscribediv";SP.UI.MicroFeed.SPMicroFeed.$2m="ms-getThreadImage_";SP.UI.MicroFeed.SPMicroFeed.$2r="ms-microfeed-pendingImage";SP.UI.MicroFeed.SPMicroFeed.$7U="ms-PersonalSiteChangePhotoLink";SP.UI.MicroFeed.SPMicroFeed.$7V="ms-PersonalSiteConfigureSettingsLink";SP.UI.MicroFeed.SPMicroFeed.$7W="ms-PersonalSiteEditProfileLink";SP.UI.MicroFeed.SPMicroFeed.$7a=SP.UI.MySiteCommon.CommonUIElements.get_profileImagePlaceholder42();SP.UI.MicroFeed.SPMicroFeed.$70=GetThemedImageUrl("placeholder32x32.png");SP.UI.MicroFeed.SPMicroFeed.$6O="mypeople.aspx";SP.UI.MicroFeed.SPMicroFeed.$7m="_layouts/15/MySite.aspx?MySiteRedirect=AllSites";SP.UI.MicroFeed.AllLikerDisplayManager.$7K="ms-microfeed-LikerCalloutDiv";SP.UI.MicroFeed.AllLikerDisplayManager.$65="ms-allLiker-CalloutContentID_";SP.UI.MicroFeed.AllLikerDisplayManager.$66="ms-allLiker-CalloutControlID_";SP.UI.MicroFeed.AllLikerDisplayManager.$67="ms-allLiker-CalloutTitleID_";SP.UI.MicroFeed.AllLikerDisplayManager.$5N={};SP.UI.MicroFeed.MicroFeedDoc.$7C="ms-microfeed-attachmentDoc_";SP.UI.MicroFeed.MicroFeedVideo.$7D="ms-microfeed-attachmentVideo_"}sp_ui_microfeed_initialize();RegisterModuleInit("sp.ui,microfeed.js",sp_ui_microfeed_initialize);typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();NotifyScriptLoadedAndExecuteWaitingJobs("SP.UI.MicroFeed.js");_spApplicationPagesScriptLoaded=true;