function $_global_bform(){g_strRTEToolbarClassName="ms-rtetoolbarmenu";g_strRTEUnselectedClassName="ms-rtetoolbarunsel";g_strRTESelectedClassName="ms-rtetoolbarsel";g_strRTEDisabledClassName="ms-rtetoolbardis";g_strRTEHoverClassName="ms-rtetoolbarhov";g_strRTETextEditorPullDownMenuID="RTETextEditorPullDownMenu";g_strRTEDialogHelperID="RTEDialogHelper";g_strRTECutMnemonic="Cut";g_strRTECopyMnemonic="Copy";g_strRTEPasteMnemonic="Paste";g_strRTERemoveFormatMnemonic="RemoveFormat";g_strRTEFontNameMnemonic="FontName";g_strRTEFontSizeMnemonic="FontSize";g_strRTEBoldMnemonic="Bold";g_strRTEItalicMnemonic="Italic";g_strRTEUnderlineMnemonic="Underline";g_strRTEJustifyLeftMnemonic="JustifyLeft";g_strRTEJustifyCenterMnemonic="JustifyCenter";g_strRTEJustifyRightMnemonic="JustifyRight";g_strRTEOrderedListMnemonic="InsertOrderedList";g_strRTEUnorderedListMnemonic="InsertUnorderedList";g_strRTEOutdentMnemonic="Outdent";g_strRTEIndentMnemonic="Indent";g_strRTEForeColorMnemonic="ForeColor";g_strRTEBackColorMnemonic="BackColor";g_strRTELTRMnemonic="LTR";g_strRTERTLMnemonic="RTL";g_strRTECreateLinkMnemonic="CreateLink";g_strRTEInsertImageMnemonic="InsertImage";g_strRTEHtmlSourceMnemonic="HtmlSource";g_strRTEInsertTableMnemonic="insert_table";g_strRTEInsertTableElementMnemonic="InsertTableElement";g_strRTEDeleteTableElementMnemonic="DeleteTableElement";g_strRTEInsertRowMnemonic="insert_row";g_strRTEInsertRowAbove="InsertRowAbove";g_strRTEInsertRowBelow="InsertRowBelow";g_strRTEInsertColumnMnemonic="insert_column";g_strRTEInsertColumnLeft="InsertColumnLeft";g_strRTEInsertColumnRight="InsertColumnRight";g_strRTEInsertCellMnemonic="insert_cell";g_strRTEInsertCellLeft="InsertCellLeft";g_strRTEInsertCellRight="InsertCellRight";g_strRTEDeleteRow="delete_row";g_strRTEDeleteColumn="delete_column";g_strRTEMergeCellMnemonic="merge_cell";g_strRTESplitCellMnemonic="split_cell";g_strRTEFormatBlockMnemonic="FormatBlock";g_strRTEStylesMnemonic="styles";g_strRTEUndoMnemonic="Undo";g_strRTERedoMnemonic="Redo";g_strRTERestrictedModeAttributeName="RestrictedMode";g_strRTESimpleTextOnlyAttributeName="SimpleTextOnly";g_strRTEUseDynamicHeightSizing="UseDynamicHeightSizing";g_strRTEUseDynamicWidthSizing="UseDynamicWidthSizing";g_strRTEMaxHeightSizeAttributeName="MaxHeightSize";g_strRTEMinHeightSizeAttributeName="MinHeightSize";g_strRTEMaxWidthSizeAttributeName="MaxWidthSize";g_strRTEMinWidthSizeAttributeName="MinWidthSize";g_strRTEAllowHyperlinkAttributeName="AllowHyperlink";g_strRTEBaseElementIDAttributeName="BaseElementID";g_strRTEWebLocaleAttributeName="WebLocale";g_strRTEButtonMnemonicAttributeName="ButtonMnemonic";g_strRTECommandToExecuteAttributeName="CommandToExecute";g_strRTECommandValueAttributeName="CommandValue";g_strRTEFunctionToExecuteAttributeName="FunctionToExecute";g_strRTEFunctionParameterToExecuteAttributeName="FunctionParameterToExecute";g_strRTEMenuItemBaseName="MenuItem";g_strRTEMenuItemAttributeName="MenuItem";g_strRTEMenuOpeningAttributeName="MenuOpening";g_strRTEMenuTableElementName="MenuTable";g_strRTEBegBoldItalicToken="%BEGBI%";g_strRTEEndBoldItalicToken="%ENDBI%";g_strRTEFontNameToken="%FONTNAME%";g_strRTEFontSizeToken="%FONTSIZE%";g_ntRTEElement=1;g_ntRTEText=3;g_iLineHeight=14;g_iCharWidth=7;g_iDefaultMaxHeightSize=10;g_iDefaultMaxWidthSize=10;g_iDefaultMinWidthSize=0;g_iDefaultMinHeightSize=0;C_RTE_TB_SetEnabledAlways.prototype=new C_RTE_TB_Enabler;C_RTE_TB_SetEnabledFromCommandEnabled.prototype=new C_RTE_TB_Enabler;C_RTE_TB_SetEnabledIfInElement.prototype=new C_RTE_TB_Enabler;C_RTE_TB_SetEnabledWhenRemoveFormatEnabled.prototype=new C_RTE_TB_Enabler;C_RTE_TB_SetEnabledFromCommandValue.prototype=new C_RTE_TB_Enabler;C_RTE_TB_SetEnabledFromCommandValueIfNotInTable.prototype=new C_RTE_TB_Enabler;g_rgstRTETextEditorSelectionType=[];g_rgrngRTETextEditorSelection=[];g_RTE_Dialog_Width=400;g_RTE_Dialog_Height=152;g_fRestoreSelection=false;ExtendedRichTextSupport_InitializePrototype();ExtendedRichTextSupportEditors.prototype={aSettings:undefined,overrides:undefined,renderFontNamesAsText:undefined,hoverButton:undefined,functions:undefined};ExtendedRichTextSupportOverrides_InitializePrototype();g_elemRTELastTextAreaConverted=null;g_strRTETextEditorWithTheFocus=null;g_strRTEPrevTextEditor=null;g_strRTEEditorFirstFocus=null;g_rgstrRTEAllEditorsInThePage=[];g_fRTEDialogIsOpen=false;g_fRTEFirstTimeGenerateCalled=true;ToolBarSettings_InitializePrototype();g_strRTEToolBarButtonWithTheFocus=null;g_aToolBarButtons=null;g_strRTEDDBaseElementID=null;g_strRTEDDButtonMnemonic=null;g_fRTEFirstCallToGetMenu=true;g_elemRTEHighlightedMenuItem=null;g_iRTEHighlightedMenuItem=-1;g_iRTEMenuItemMax=-1;g_fRTEMenuMoved=false;g_rgstrRTEMenuHtml=[];g_strRTEColorMatrixMenuItemPrefixHtml='<div unselectable="on" style="width: 10px; height: 10px; background-color: ';g_strRTEColorMatrixMenuItemSufffixHtml=';"><img unselectable="on" width="10" height="10" border="0" src="'+RTE_GetServerRelativeUnlocalizedImageUrl("blank.gif")+'" alt="%TOOLTIP%"></div>';g_cRTEColorMatrixColumns=8;g_iRTELeft=0;g_iRTETop=1;g_iRTEWidth=2;g_iRTEHeight=3;g_iRTERight=4;g_iRTEBottom=5;if(g_aTableCellTagNames==null)g_aTableCellTagNames=["TD","TH"];RTE_SpanGrid_InitializePrototype();g_reservedTablePrefix=".ms-rteTable";msTableStylePrefix="ms-rteTable";msTableClass="-";msTableClassHeadingRow="HeaderRow-";msTableClassHeadingFirstCol="HeaderFirstCol-";msTableClassHeadingOddCol="HeaderOddCol-";msTableClassHeadingEvenCol="HeaderEvenCol-";msTableClassHeadingLastCol="HeaderLastCol-";msTableClassOddRow="OddRow-";msTableClassEvenRow="EvenRow-";msTableClassFirstCol="FirstCol-";msTableClassOddCol="OddCol-";msTableClassEvenCol="EvenCol-";msTableClassLastCol="LastCol-";msTableClassFootingRow="FooterRow-";msTableClassFootingFirstCol="FooterFirstCol-";msTableClassFootingOddCol="FooterOddCol-";msTableClassFootingEvenCol="FooterEvenCol-";msTableClassFootingLastCol="FooterLastCol-";C_RTE_TB_Enabler.prototype={button:undefined,strElement:undefined,SetEnabled:undefined};C_RTE_TB_ExecCmdButton_InitializePrototype();C_RTE_TB_ExecCmdButtonClustered_InitializePrototype();C_RTE_TB_JScriptButton_InitializePrototype();C_RTE_TB_JScriptButtonClustered_InitializePrototype();C_RTE_TB_SpecialButton_InitializePrototype();FileuploadString="fileupload";FileUploadIndex=0;FileUploadLocalFileCount=0;Calendar_InitializePrototype();CalEvent_InitializePrototype();Span_InitializePrototype();DiscussionBoard_InitializePrototype();Post_InitializePrototype();DateDecode_InitializePrototype();OWSForm_InitializePrototype();DateField_InitializePrototype();Field_InitializePrototype();DateOptions_InitializePrototype();URLField_InitializePrototype();NumberField_InitializePrototype();BooleanField_InitializePrototype();NoteField_InitializePrototype();RichTextField_InitializePrototype();TextField_InitializePrototype();FilenameField_InitializePrototype();GridChoiceField_InitializePrototype();GridChoice_InitializePrototype();ChoiceItem_InitializePrototype();ChoiceField_InitializePrototype();RecurrencePattern_InitializePrototype();RecurrencePatternEventHooks_InitializePrototype();IntlDate.prototype.valueOf=toIntlValue;IntlDate.prototype.setUTCHours=setIntlHours;IntlDate.prototype.setSeconds=setIntlSeconds;IntlDate.prototype.setTime=setIntlTime;IntlDate.prototype.getUTCFullYear=getIntlFullYear;IntlDate.prototype.getUTCMonth=getIntlMonth;IntlDate.prototype.getUTCDate=getIntlDate;IntlDate.prototype.getUTCHours=getIntlHours;IntlDate.prototype.getUTCMinutes=getIntlMinutes;IntlDate.prototype.getUTCSeconds=getIntlSeconds;IntlDate.prototype.getTime=getIntlTime;DateOptions.prototype.SetTimeFormat=DOSetTimeFormat;DateOptions.prototype.SetDateOrder=DOSetDateOrder;DateOptions.prototype.SetDOW=DOSetDOW;DateOptions.prototype.ParseLocaleDate=DOParseLocaleDate;DateOptions.prototype.DateYMD=DODateYMD;DateOptions.prototype.DateIntlYMD=DODateIntlYMD;DateOptions.prototype.YrWindow=DOYrWindow;DateOptions.prototype.StDate=DOStDate;DateOptions.prototype.StDateString=DOStDateString;DateOptions.prototype.StTime=DOStTime;DateOptions.prototype.StBareTime=DOStBareTime;DateOptions.FHasTime=DOFHasTime;DateOptions.prototype.StTimeControls=DOStTimeControls;DateOptions.prototype.SetTimeControls=DOSetTimeControls;DateOptions.prototype.Today=DOToday;DateOptions.prototype.Now=DONow;DateOptions.ClientToday=DOClientToday;DateOptions.ClientNow=DOClientNow;DateOptions.ParseISODate=DOParseISODate;DateOptions.prototype.RoundDate=DateRoundDate;DateOptions.StISODate=DOStISODate;DateOptions.msSecond=1e3;DateOptions.msMinute=DateOptions.msSecond*60;DateOptions.msHour=DateOptions.msMinute*60;DateOptions.msDay=DateOptions.msHour*24;DateOptions.msWeek=DateOptions.msDay*7;DateOptions.cdyYr=365;DateOptions.cdyQYr=4*DateOptions.cdyYr+1;DateOptions.cdyC=25*DateOptions.cdyQYr-1;DateOptions.cdyQC=4*DateOptions.cdyC+1;DateOptions.mpMonIdy=[31,61,92,122,153,184,214,245,275,306,337];DateOptions.idyJan1=306;DateOptions.ddayOrigin=135080;DateDecode.prototype.MsEncode=DDMsEncode;DateOptions.fOldDate=typeof Date.prototype.getUTCHours=="undefined";if(DateOptions.fOldDate){Date.prototype.getUTCDay=DateGetUTCDay;Date.prototype.getUTCDate=DateGetUTCDate;Date.prototype.getUTCFullYear=DateGetUTCFullYear;Date.prototype.getUTCMonth=DateGetUTCMonth;Date.prototype.getUTCHours=DateGetUTCHours;Date.prototype.getUTCMinutes=DateGetUTCMinutes;Date.prototype.getUTCSeconds=DateGetUTCSeconds;Date.prototype.setUTCDate=DateSetUTCDate;Date.prototype.setUTCHours=DateSetUTCHours;Date.prototype.EnsureDecode=DateEnsureDecode;Date.prototype.ResetMs=DateResetMs}DateDecode.prototype.toString=StDateDecode;DatePicker_InitializePrototype();DatePicker.prototype.StButton=DPStButton;DatePicker.prototype.Popup=DPPopup;DatePicker.prototype.AdjustFrameSize=DPAdjustFrameSize;DatePicker.prototype.StBuild=DPStBuild;DatePicker.prototype.SetHTML=DPSetHTML;DatePicker.prototype.ClickDay=DPClickDay;DatePicker.prototype.MoveMonth=DPMoveMonth;DatePicker.prototype.Cancel=DPCancel;DatePicker.prototype.SetDate=DPSetDate;OWSForm.prototype.MapCtName=FrmMapCtName;OWSForm.prototype.AddField=FrmAddField;OWSForm.prototype.DataBind=FrmDataBind;OWSForm.prototype.FindField=FrmFindField;OWSForm.prototype.ValidateAndSubmit=FrmValidateAndSubmit;OWSForm.prototype.FValidate=FValidateForm;OWSForm.prototype.FPostProcess=FPostProcessForm;OWSForm.prototype.SetFirstFocus=FrmSetFirstFocus;OWSForm.prototype.InitFormFields=FrmInitFields;OWSForm.prototype.BuildFieldUI=FrmBuildFieldUI;OWSForm.prototype.StFieldPost=FrmStFieldPost;OWSForm.prototype.FieldPost=FrmFieldPost;OWSForm.prototype.FilenameFieldPost=FilenameFrmFieldPost;OWSForm.prototype.StFieldSubPart=FrmStFieldSubPart;OWSForm.prototype.FieldSubPart=FrmFieldSubPart;OWSForm.prototype.StFieldName=FrmStFieldName;OWSForm.prototype.StFieldNameFactory=FrmStFieldNameFactory;OWSForm.prototype.GetSelValue=FrmGetSelValue;OWSForm.prototype.TestURL=FormTestURL;OWSForm.prototype.SetRadioValue=FormSetRadioValue;OWSForm.prototype.RevertSelect=FormRevertSelect;OWSForm.prototype.SetFillInButton=FormSetFillInButton;OWSForm.prototype.UnsetFillInButton=FormUnsetFillInButton;NumberOptions.prototype.SetGrouping=NoptSetGrouping;NumberOptions.prototype.NumParse=NoptNumParse;NumberOptions.prototype.StNumber=NoptStNumber;DateField.prototype.BuildUI=DateBuildUI;DateField.prototype.stBuildUI=stDateBuildUI;DateField.prototype.PopDatePicker=DatePopDatePicker;DateField.prototype.DataBind=DateDataBind;DateField.prototype.FieldFocus=DateFieldFocus;DateField.prototype.FValidate=DateFValidate;URLField.prototype.BuildUI=URLBuildUI;URLField.prototype.DataBind=URLDataBind;URLField.prototype.FieldFocus=URLFieldFocus;URLField.prototype.FValidate=URLValidate;NumberField.prototype.BuildUI=NumberBuildUI;NumberField.prototype.stBuildUI=stNumberBuildUI;NumberField.prototype.DataBind=NumberDataBind;NumberField.prototype.FieldFocus=NumberFieldFocus;NumberField.prototype.FValidate=NumberFValidate;BooleanField.prototype.BuildUI=BooleanBuildUI;BooleanField.prototype.DataBind=BooleanDataBind;BooleanField.prototype.FieldFocus=BooleanFieldFocus;BooleanField.prototype.FValidate=BooleanFValidate;BooleanField.prototype.SetValue=BooleanFieldSetValue;Field.prototype.FieldFocus=FieldFieldFocus;Field.prototype.DataBind=FieldDataBind;Field.prototype.FValidate=FieldFValidate;Field.prototype.BuildUI=FieldBuildUI;NoteField.prototype.FieldFocus=NoteFieldFieldFocus;NoteField.prototype.BuildUI=NoteFieldBuildUI;NoteField.prototype.DataBind=FieldDataBind;NoteField.prototype.FValidate=NoteFieldFValidate;RichTextField.prototype.FieldFocus=RichTextFieldFieldFocus;RichTextField.prototype.BuildUI=RichTextFieldBuildUI;RichTextField.prototype.DataBind=FieldDataBind;RichTextField.prototype.FValidate=RichTextFieldFValidate;TextField.prototype.BuildUI=TextFieldBuildUI;TextField.prototype.stBuildUI=stTextFieldBuildUI;TextField.prototype.FieldFocus=TextFieldFieldFocus;TextField.prototype.DataBind=FieldDataBind;TextField.prototype.FValidate=TextFieldFValidate;FilenameField.prototype.BuildUI=FilenameFieldBuildUI;FilenameField.prototype.FieldFocus=FilenameFieldFieldFocus;FilenameField.prototype.DataBind=FieldDataBind;FilenameField.prototype.FValidate=FilenameFieldFValidate;GridChoiceField.prototype.FieldFocus=GridChoiceFieldFocus;GridChoiceField.prototype.BuildUI=GridChoiceBuildUI;GridChoiceField.prototype.FValidate=GridChoiceFValidate;GridChoiceField.prototype.AddChoice=GridChoiceAddChoice;ChoiceField.prototype.BuildUI=ChoiceBuildUI;ChoiceField.prototype.stBuildUI=stChoiceBuildUI;ChoiceField.prototype.Init=ChoiceInit;ChoiceField.prototype.AddChoice=ChoiceAddChoice;ChoiceField.prototype.AddChoiceWithLayoutProc=ChoiceAddChoiceWithLayoutProc;ChoiceField.prototype.DataBind=ChoiceDataBind;ChoiceField.prototype.SetValue=ChoiceSetValue;ChoiceField.prototype.GetControl=ChoiceGetControl;ChoiceField.prototype.GetFillInButtonControl=ChoiceGetFillInButtonControl;ChoiceField.prototype.GetFillInControl=ChoiceGetFillInControl;ChoiceField.prototype.FieldFocus=ChoiceFieldFocus;ChoiceField.prototype.FValidate=ChoiceFValidate;ChoiceField.prototype.RevertSelect=ChoiceRevertSelect;ChoiceField.prototype.SetFillInButton=ChoiceFieldSetFillInButton;ChoiceField.prototype.UnsetFillInButton=ChoiceFieldUnsetFillInButton;ChoiceField.prototype.SetFillInValue=ChoiceSetFillInValue;_RecurDateRangeDiv="recurDateRangeDiv";_RecurPatternTextDiv="recurPatternTextDiv";_RecurDailyDiv="recurDailyDiv";_RecurWeeklyDiv="recurWeeklyDiv";_RecurMonthlyDiv="recurMonthlyDiv";RecurrencePattern.prototype.BuildUI=RecurrencePatternBuildUI;RecurrencePattern.prototype.Init=RecurrencePatternInit;RecurrencePatternEventHooks.prototype.Init=RecurrencePatternEventHooksInit;RecurrencePatternEventHooks.prototype.InitHooks=DoInitRecurrencePatternEventHooks;RecurrencePatternEventHooks.prototype.FValidate=RecurrencePatternValidate;RecurrencePatternEventHooks.prototype.SetValue=RecurrencePatternEventHooksSetValue;RecurrencePatternEventHooks.prototype.DateRangeToDate=FnDateRangeToDate;RecurrencePatternEventHooks.prototype.DateToDateRange=FnDateToDateRange;RecurrencePatternEventHooks.prototype.ToggleDisplay=RecurrencePatternEventHooksToggleDisplay;RecurrencePatternEventHooks.prototype.PostProcess=DateFieldPostProcess;RecurrencePatternEventHooks.prototype.CopyDateFld=FnCopyDateFld;Position.prototype={x:undefined,y:undefined};(function(){a:;typeof Sys!="undefined"&&typeof Sys.Application!="undefined"&&typeof Sys.Application.notifyScriptLoaded!="undefined"&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs=="function"&&NotifyScriptLoadedAndExecuteWaitingJobs("bform.js")})()}function ULSglM(){var a={};a.ULSTeamName="Microsoft SharePoint Foundation";a.ULSFileName="bform.commentedjs";return a}var g_strRTEToolbarClassName,g_strRTEUnselectedClassName,g_strRTESelectedClassName,g_strRTEDisabledClassName,g_strRTEHoverClassName,g_strRTETextEditorPullDownMenuID,g_strRTEDialogHelperID,g_strRTECutMnemonic,g_strRTECopyMnemonic,g_strRTEPasteMnemonic,g_strRTERemoveFormatMnemonic,g_strRTEFontNameMnemonic,g_strRTEFontSizeMnemonic,g_strRTEBoldMnemonic,g_strRTEItalicMnemonic,g_strRTEUnderlineMnemonic,g_strRTEJustifyLeftMnemonic,g_strRTEJustifyCenterMnemonic,g_strRTEJustifyRightMnemonic,g_strRTEOrderedListMnemonic,g_strRTEUnorderedListMnemonic,g_strRTEOutdentMnemonic,g_strRTEIndentMnemonic,g_strRTEForeColorMnemonic,g_strRTEBackColorMnemonic,g_strRTELTRMnemonic,g_strRTERTLMnemonic,g_strRTECreateLinkMnemonic,g_strRTEInsertImageMnemonic,g_strRTEHtmlSourceMnemonic,g_strRTEInsertTableMnemonic,g_strRTEInsertTableElementMnemonic,g_strRTEDeleteTableElementMnemonic,g_strRTEInsertRowMnemonic,g_strRTEInsertRowAbove,g_strRTEInsertRowBelow,g_strRTEInsertColumnMnemonic,g_strRTEInsertColumnLeft,g_strRTEInsertColumnRight,g_strRTEInsertCellMnemonic,g_strRTEInsertCellLeft,g_strRTEInsertCellRight,g_strRTEDeleteRow,g_strRTEDeleteColumn,g_strRTEMergeCellMnemonic,g_strRTESplitCellMnemonic,g_strRTEFormatBlockMnemonic,g_strRTEStylesMnemonic,g_strRTEUndoMnemonic,g_strRTERedoMnemonic,g_strRTERestrictedModeAttributeName,g_strRTESimpleTextOnlyAttributeName,g_strRTEUseDynamicHeightSizing,g_strRTEUseDynamicWidthSizing,g_strRTEMaxHeightSizeAttributeName,g_strRTEMinHeightSizeAttributeName,g_strRTEMaxWidthSizeAttributeName,g_strRTEMinWidthSizeAttributeName,g_strRTEAllowHyperlinkAttributeName,g_strRTEBaseElementIDAttributeName,g_strRTEWebLocaleAttributeName,g_strRTEButtonMnemonicAttributeName,g_strRTECommandToExecuteAttributeName,g_strRTECommandValueAttributeName,g_strRTEFunctionToExecuteAttributeName,g_strRTEFunctionParameterToExecuteAttributeName,g_strRTEMenuItemBaseName,g_strRTEMenuItemAttributeName,g_strRTEMenuOpeningAttributeName,g_strRTEMenuTableElementName,g_strRTEBegBoldItalicToken,g_strRTEEndBoldItalicToken,g_strRTEFontNameToken,g_strRTEFontSizeToken,g_ntRTEElement,g_ntRTEText,g_iLineHeight,g_iCharWidth,g_iDefaultMaxHeightSize,g_iDefaultMaxWidthSize,g_iDefaultMinWidthSize,g_iDefaultMinHeightSize;function LessThan(a,b){return a<b}function GreaterThan(a,b){return a>b}function GetParentWindow2(a){if(a==null)a=document;return typeof a.parentWindow!="undefined"&&null!=a.parentWindow?a.parentWindow:typeof a.defaultView!="undefined"&&null!=a.defaultView?a.defaultView:null}var g_rgstRTETextEditorSelectionType,g_rgrngRTETextEditorSelection,g_RTE_Dialog_Width,g_RTE_Dialog_Height;function RTE_DialogResize(){a:;var a=window.document.body;if(a.scrollWidth>g_RTE_Dialog_Width)window.dialogWidth=String(a.scrollWidth)+"px";if(a.scrollHeight>g_RTE_Dialog_Height)window.dialogHeight=String(a.scrollHeight)+"px"}function RTE_SaveSelection(a){var c=RTE_GetEditorInstanceVariables(a);if(c!=null){var b=c.overrides;if(typeof b.SaveSelection!="undefined"&&b.SaveSelection!=null)return b.SaveSelection(a)}var d=RTE_GetEditorDocument(a);g_rgrngRTETextEditorSelection[a]=d.selection.createRange();g_rgstRTETextEditorSelectionType[a]=d.selection.type;return undefined}var g_fRestoreSelection;function RTE_RestoreSelection(a){var d=RTE_GetEditorInstanceVariables(a);if(d!=null){var c=d.overrides;if(typeof c.RestoreSelection!="undefined"&&c.RestoreSelection!=null)return c.RestoreSelection(a)}var b=g_rgrngRTETextEditorSelection[a];if(null==b)try{b=parent.g_rgrngRTETextEditorSelection[a]}catch(e){}if(null!=b){g_fRestoreSelection=true;b.select();g_fRestoreSelection=false}return undefined}function RTE_GetSelection(a){return g_rgrngRTETextEditorSelection[a]}function ExtendedRichTextSupport_InitializePrototype(){a:;ExtendedRichTextSupport.prototype.editors=undefined}function ExtendedRichTextSupport(a){a:;this.editors=a}function ExtendedRichTextSupportEditors(a){a:;this.overrides=a;this.overrides.DisableToolBar=null;this.overrides.ResetAllToolBarStates=null;this.overrides.GetEditorDocument=null;this.overrides.OnKeyDown=null;this.overrides.RestoreSelection=null;this.overrides.GiveEditorFocus=null;this.overrides.GetToolBarDefinition=null;this.RenderFontNamesAsText=false;this.hoverButton=null;this.functions=[]}function ExtendedRichTextSupportOverrides_InitializePrototype(){a:;ExtendedRichTextSupportOverrides.prototype.DisableToolBar=undefined;ExtendedRichTextSupportOverrides.prototype.GetEditorDocument=undefined;ExtendedRichTextSupportOverrides.prototype.GiveEditorFocus=null;ExtendedRichTextSupportOverrides.prototype.OnKeyDown=undefined;ExtendedRichTextSupportOverrides.prototype.ResetAllToolBarStates=undefined;ExtendedRichTextSupportOverrides.prototype.RestoreSelection=undefined;ExtendedRichTextSupportOverrides.prototype.SaveSelection=undefined}function ExtendedRichTextSupportOverrides(){}var g_oExtendedRichTextSupport;function RTE_GetEditorInstanceVariables(a){if(parent.g_oExtendedRichTextSupport!=null)g_oExtendedRichTextSupport=parent.g_oExtendedRichTextSupport;if(g_oExtendedRichTextSupport!=null)if(g_oExtendedRichTextSupport.editors[a]!=null)return g_oExtendedRichTextSupport.editors[a];return null}function RTE_InitializeExtendedRichTextSupport(a){if(g_oExtendedRichTextSupport==null)g_oExtendedRichTextSupport=new ExtendedRichTextSupport([]);var b=new ExtendedRichTextSupportOverrides,c=new ExtendedRichTextSupportEditors(b);g_oExtendedRichTextSupport.editors[a]=c}var g_elemRTELastTextAreaConverted,g_strRTETextEditorWithTheFocus,g_strRTEPrevTextEditor,g_strRTEEditorFirstFocus,g_rgstrRTEAllEditorsInThePage,g_fRTEDialogIsOpen;function RTE_GetEditorIFrameID(a){a:;return a+"_iframe"}function RTE_GetEditorTextArea(a){a:;var b=document.getElementById(a);return b}function RTE_GetEditorIFrame(e){var b=null,a=window;if(a.frames.length==0)a=a.parent;if(a.frames.length>0){var f=a.document,d=RTE_GetEditorIFrameID(e),c=f.getElementById(d);if(c!=null){b=a.frames[d];if(b==null)b=c.contentWindow}}return b}function RTE_GetEditorElement(d){var a=document,b=window;try{if(b.frames.length==0){b=GetParentWindow2(a).parent;if(null!=b)a=b.document}}catch(e){a=document}var c=a.getElementById(RTE_GetEditorIFrameID(d));return c}function RTE_GetEditorToolBar(b){var a=b+"_toolbar",c=document.getElementById(a);return c}function RTE_GetEditorDocument(a){a:;var c=RTE_GetEditorInstanceVariables(a);if(c!=null){var b=c.overrides;if(typeof b.GetEditorDocument!="undefined"&&b.GetEditorDocument!=null)return b.GetEditorDocument(a)}var d=RTE_GetEditorIFrame(a);if(null==d)return null;var e=d.document;return e}function RTE_GetWebLocale(a){return RTE_GetEditorDocument(a).body.getAttribute(g_strRTEWebLocaleAttributeName)}function RTE_IsInRestrictedMode(a){var b=RTE_GetEditorDocument(a);return null!=b.body.getAttribute(g_strRTERestrictedModeAttributeName)?true:false}function RTE_IsSimpleTextOnly(a){var b=RTE_GetEditorDocument(a);return null!=b.body.getAttribute(g_strRTESimpleTextOnlyAttributeName)?true:false}function RTE_UseDynamicHeightSizing(a){var b=RTE_GetEditorDocument(a);return null!=b.body.getAttribute(g_strRTEUseDynamicHeightSizing)?true:false}function RTE_MaxHeightSize(b){var c=RTE_GetEditorDocument(b),a=c.body.getAttribute(g_strRTEMaxHeightSizeAttributeName);return null!=a?Number(a):g_iDefaultMaxHeightSize}function RTE_MaxWidthSize(b){var c=RTE_GetEditorDocument(b),a=c.body.getAttribute(g_strRTEMaxWidthSizeAttributeName);return null!=a?Number(a):g_iDefaultMaxWidthSize}function RTE_MinHeightSize(b){var c=RTE_GetEditorDocument(b),a=c.body.getAttribute(g_strRTEMinHeightSizeAttributeName);return null!=a?Number(a):g_iDefaultMinHeightSize}function RTE_MinWidthSize(b){var c=RTE_GetEditorDocument(b),a=c.body.getAttribute(g_strRTEMinWidthSizeAttributeName);return null!=a?Number(a):g_iDefaultMinWidthSize}function RTE_IsHyperlinkAllowed(a){var b=RTE_GetEditorDocument(a);return null!=b.body.getAttribute(g_strRTEAllowHyperlinkAttributeName)?true:false}function RTE_ShouldShowDirection(){a:;return true}function RTE_EditorWithTheFocus(){a:;return g_strRTETextEditorWithTheFocus}function RTE_PrevEditor(){a:;return g_strRTEPrevTextEditor}function RTE_GetRichEditTextOnly(a){return RTE_GetEditorDocument(a).body.innerText}function RTE_DocEditor_AdjustHeight(d){var i=RTE_MaxHeightSize(d),j=RTE_MinHeightSize(d),h=RTE_GetEditorElement(d);if(h!=null){var f=RTE_GetEditorIFrame(d),a=f.document.body.scrollHeight,e=f.document.body.clientHeight,k=f.document.body.offsetHeight,b=i*g_iLineHeight,c=j*g_iLineHeight;a=a<g_iLineHeight?g_iLineHeight:a;if(e!=a&&(a<=b||e<b)&&(a>=c||e>c)){var g=k+(a>b?b:a)-e;if(g<c)g=c;h.style.height=g.toString()}}}function RTE_DocEditor_AdjustWidth(d){var i=RTE_MaxWidthSize(d),j=RTE_MinWidthSize(d),h=RTE_GetEditorElement(d);if(h!=null){var l=RTE_GetEditorIFrame(d),g=l.document.getElementsByTagName("body")[0],a=g.scrollWidth,e=g.clientWidth,k=g.offsetWidth,b=i*g_iCharWidth,c=j*g_iCharWidth;a=a<g_iCharWidth?g_iCharWidth:a;if(e!=a&&(a<=b||e<b)&&(a>=c||e>c)){var f=k+(a>b?b:a)-e;if(f<c)f=c;h.style.width=f.toString()}}}function RTE_SetVisibiltyStyle(a,d){var c=RTE_GetEditorElement(a),b=RTE_GetEditorToolBar(a);if(null!=c&&null!=b){b.style.visibility=d;c.style.visibility=d}}function RTE_SetWidthHeight(d,c,f){var b=RTE_GetEditorElement(d),e=RTE_GetEditorToolBar(d);if(null!=e&&null!=b){if(c<0)c=0;b.style.width=c.toString();var a=f-e.offsetHeight;if(a<0)a=0;b.style.height=a.toString()}}function RTE_GetMinimumHeight(c){var a=0,b=RTE_GetEditorToolBar(c);if(null!=b)a=b.offsetHeight;return a}function RTE_GetMinimumWidth(c){var b=0,a=RTE_GetEditorToolBar(c);if(null!=a)b=a.offsetWidth;return b}function RTE_GetIFrameContents(c){var b,d,a=RTE_GetEditorDocument(c);if(null==a)return null;b=a.body.innerHTML;return b}function RTE_GiveEditorFocus(a){var c=RTE_GetEditorInstanceVariables(a);if(c!=null){var b=c.overrides;if(typeof b.GiveEditorFocus!="undefined"&&b.GiveEditorFocus!=null)return b.GiveEditorFocus(a)}RTE_GetEditorIFrame(a).focus();return undefined}function RTE_GiveEditorFirstFocus(a){RTE_GiveEditorFocus(a);g_strRTEEditorFirstFocus=a}function RTE_ConvertTextAreaToRichEdit(b,k,t,z,A,l,s,i,f,g,C,B,F,w,v,G,j,p,q,n,D,m,o){if(!(browseris.ie5up&&(browseris.win32||browseris.winnt||browseris.win64bit)))return;n=n==null||n;if(IsAccessibilityFeatureEnabled()&&n)return;l=l!=null&&l;k=l?true:k;s=null==s?true:s;i=i!=null&&i;f=null==f||f<=0?g_iDefaultMaxHeightSize:f;g=null==g||g<=0||g>f?g_iDefaultMinHeightSize:g;j=j!=null&&j;p=null==p||p<=0?g_iDefaultMaxWidthSize:p;q=null==q||q<=0||q>p?g_iDefaultMinWidthSize:q;m=null==m||m;o=null==o||o;if(C!="FullHtml")C="Compatible";if(null==w)w="ms-formbody";var d=new ToolBarSettings;RTE_InitializeExtendedRichTextSupport(b);var u=RTE_GetEditorInstanceVariables(b),H=false;if(C=="FullHtml"){H=true;t=false;u.overrides.GetToolBarDefinition=RTE_FullHtmlToolBarDefinitionFactory(n);d.fRestrictedMode=true;d.fAllowHyperlink=false;d.fIsVisible=true}else{d.fRestrictedMode=k;d.fAllowHyperlink=t;d.fIsVisible=!l}d.urlWebRoot=B==null||B=="/"?"":B;d.fAllowRelativeLinks=v==null?false:v;d.fPreserveScript=D==null?false:D;u.aSettings=d;var e=RTE_GetEditorTextArea(b),y=e.innerText;if(null==y||0==y.length)y="<div></div>";g_elemRTELastTextAreaConverted=e;AttachEvent("load",new Function("RTE_TextAreaWindow_OnLoad('"+b+"');"),window);var x=[];o&&x.push(RTE_GenerateToolBarHtmlFromSettings(b,A,e,d));x.push(RTE_GenerateIFrameEditorHtml(b,e,k,t));var J=x.join("");insertAdjacentHTML(e,"afterEnd",J);var I=function(){a:;RTE_TransferIFrameContentsToTextArea(b);DetachEvent("submit",I,event.srcElement);RTE_DeleteEditor(b)};if(m){e.onfocus=new Function("RTE_TextArea_OnFocus('"+b+"')");e.style.display="none";u.onBeforeUnloadFunc=new Function("RTE_TransferIFrameContentsToTextArea('"+b+"');");AttachEvent("beforeunload",u.onBeforeUnloadFunc,window);var h=e;while(h!=null&&h.tagName!="FORM"&&h.tagName!="WINDOW")h=h.parentNode;h!=null&&AttachEvent("submit",I,h)}var c=[];c.push("<html><head>");if(null!=G&&true==v){c.push('<base href="');c.push(G);c.push('"/>')}c.push('<link rel="stylesheet" type="text/css" href="');c.push(RTE_GetServerRelativeStylesheetUrl("forms.css",A));c.push('">');if(null!=F){c.push('<link rel="stylesheet" type="text/css" href="');c.push(F);c.push('">')}c.push('</head><body class="');c.push(w);c.push('" style="background-color: white;border:none; margin:0px"></body></html>');var E=c.join(""),a=RTE_GetEditorDocument(b);a.open("text/html","replace");a.write(E);a.close();a.body.scroll="yes";a.body.wordWrap=false;a.body.contentEditable=s;a.body.innerHTML=E;m&&s&&RTE_EventHookUp(b);if(k){a.body.ondragenter=new Function("RTE_OnDragEnter(this);");a.body.ondragover=new Function("RTE_OnDragOver(this);");a.body.ondragdrop=new Function("RTE_OnDrop(this);")}if(z!=""&&z!="None")a.dir=z;else a.dir=document.dir;if(k&&!H){a.body.setAttribute(g_strRTERestrictedModeAttributeName,"true");a.body.onpaste=new Function("RTE_OnPaste_Restricted('"+b+"', this);")}l&&a.body.setAttribute(g_strRTESimpleTextOnlyAttributeName,"true");if(i||j){var r="";if(i){a.body.style.wordWrap="break-word";a.body.setAttribute(g_strRTEUseDynamicHeightSizing,"true");a.body.setAttribute(g_strRTEMinHeightSizeAttributeName,String(g));a.body.setAttribute(g_strRTEMaxHeightSizeAttributeName,String(f));r="RTE_DocEditor_AdjustHeight('"+b+"');"}if(j){a.body.style.wordWrap="normal";a.body.setAttribute(g_strRTEUseDynamicWidthSizing,"true");a.body.setAttribute(g_strRTEMaxWidthSizeAttributeName,String(f));a.body.setAttribute(g_strRTEMinWidthSizeAttributeName,String(g));r+="RTE_DocEditor_AdjustWidth('"+b+"');"}var L=RTE_GetEditorIFrame(b);AttachEvent("keydown",new Function(r),a);AttachEvent("scroll",new Function(r),L);AttachEvent("load",new Function(r),window);if(m){i&&RTE_DocEditor_AdjustHeight(b);j&&RTE_DocEditor_AdjustWidth(b)}}t&&a.body.setAttribute(g_strRTEAllowHyperlinkAttributeName,"true");a.body.setAttribute(g_strRTEBaseElementIDAttributeName,b);a.body.setAttribute(g_strRTEWebLocaleAttributeName,A);g_rgstrRTEAllEditorsInThePage[g_rgstrRTEAllEditorsInThePage.length]=b;if(o){RTE_DisableToolBar(b);var K=RTE_GetEditorElement(b);K.tabIndex=e.tabIndex;RTE_ToolBarMnemonicInitialization(b)}}function RTE_ToolBarMnemonicInitialization(b){var c=RTE_GetToolBarDefinition(b);if(c!=null)for(var a=0;a<c.length;a++){var d=c[a];if(d.strMnemonic!=null){var e=RTE_TB_GetToolBarButton(b,d.strMnemonic);e.toolbarButtonIndex=a;e.strBaseElementID=b}}}function RTE_DeleteEditor(b){var a=RTE_GetEditorInstanceVariables(b);a!=null&&typeof a.onBeforeUnloadFunc!="undefined"&&a.onBeforeUnloadFunc!=null&&DetachEvent("beforeunload",a.onBeforeUnloadFunc,window)}function RTE_DisableToolBar(a){var e=RTE_GetEditorInstanceVariables(a);if(e!=null){var b=e.overrides;if(typeof b.DisableToolBar!="undefined"&&b.DisableToolBar!=null)return b.DisableToolBar(a)}var c=RTE_GetToolBarDefinition(a);if(c!=null)for(var d=0;d<c.length;d++){var f=c[d];f.strMnemonic!=null&&RTE_TB_SetButtonDisabled(RTE_TB_GetToolBarButton(a,f.strMnemonic))}return undefined}function RTE_ResetAllToolBarStates(a){var e=RTE_GetEditorInstanceVariables(a);if(e!=null){var b=e.overrides;if(typeof b.ResetAllToolBarStates!="undefined"&&b.ResetAllToolBarStates!=null)return b.ResetAllToolBarStates(a)}var g=RTE_DD_GetMenuFrame();if(g!=null&&g.document==document)return;if(browseris.ie55up&&RTE_EditorWithTheFocus()!=a&&RTE_ToolBarButtonWithTheFocus()==null&&!RTE_DD_MenuIsOpen()&&!g_fRTEDialogIsOpen){RTE_DisableToolBar(a);return}var i=RTE_GetCurrentSelectionChain(a),f=RTE_GetEditorDocument(a),j=RTE_HasActiveSelection(f),c=RTE_GetToolBarDefinition(a);if(c!=null)for(var d=0;d<c.length;d++){var h=c[d];h.enabler!=null&&h.enabler.SetEnabled(a,f,i)}}function RTE_EventHookUp(a){var b=RTE_GetEditorDocument(a);b.body.onkeydown=new Function("RTE_OnKeyDown('"+a+"', this)");b.body.onkeyup=new Function("RTE_OnKeyUp('"+a+"', this)");b.body.onmouseup=new Function("RTE_OnMouseUp('"+a+"')");b.body.onselectstart=new Function("RTE_OnSelectStart('"+a+"', this)");b.body.oncontextmenu=new Function("return false");RTE_GetEditorElement(a).onblur=new Function("RTE_OnBlur('"+a+"');");RTE_GetEditorElement(a).onfocus=new Function("RTE_OnFocus('"+a+"');")}function RTE_TransferTextAreaContentsToIFrame(b){var h=RTE_GetEditorTextArea(b),a=h.innerText,e=document.getElementById(b+"_spSave");if(e!=null&&e.value!="")a=e.value;var c=RTE_GetEditorDocument(b);if(null==c)return;if(null==a||0==a.length)a="<div></div>";var f=false,d=RTE_GetEditorInstanceVariables(b);if(d!=null&&d.aSettings!=null)f=d.aSettings.fPreserveScript;if(f)a="<body>"+a;c.body.innerHTML=a;if(b==g_strRTEEditorFirstFocus){var g=c.body.createTextRange();g.collapse(true);g.select();g_strRTEEditorFirstFocus=null}}function RTE_TransferIFrameContentsToTextArea(a){var b,f,c=RTE_GetEditorTextArea(a),d=RTE_GetEditorDocument(a);if(null==d)return;b=d.body.innerHTML;var e=document.getElementById(a+"_spSave");if(e!=null){e.value=b;c.innerText="<div></div>"}else c.innerText=b}function RTE_TextAreaWindow_OnLoad(a){RTE_TransferTextAreaContentsToIFrame(a);RTE_SaveSelection(a)}function RTE_TextArea_OnFocus(a){RTE_GiveEditorFocus(a)}function RTE_OnFocus(a){g_strRTETextEditorWithTheFocus=a;RTE_GetEditorDocument(a).body.contentEditable=true;g_strRTEPrevTextEditor!=null&&g_strRTEPrevTextEditor.length>0&&g_strRTEPrevTextEditor!=a&&RTE_DisableToolBar(g_strRTEPrevTextEditor);RTE_StartResetToolBarTimer(a)}function RTE_OnBlur(a){if(typeof document.activeElement!="undefined"&&document.activeElement==RTE_DD_GetMenuElement())return;try{RTE_SaveSelection(a)}catch(b){}g_strRTEPrevTextEditor=g_strRTETextEditorWithTheFocus;g_strRTETextEditorWithTheFocus=null;RTE_StartResetToolBarTimer(a);RTE_DD_CloseMenu();if(RTE_ToolBarButtonWithTheFocus()==null&&!g_fRTEDialogIsOpen){RTE_DisableToolBar(a);RTE_DD_CloseMenu()}}function RTE_OnDragEnter(b){var a=GetParentWindow2(b.ownerDocument).event;if(null!=a){a.dataTransfer.dropEffect="none";a.returnValue=false}}function RTE_OnDragOver(b){var a=GetParentWindow2(b.ownerDocument).event;if(null!=a){a.dataTransfer.dropEffect="none";a.returnValue=false}}function RTE_OnDrop(b){var a=GetParentWindow2(b.ownerDocument).event;if(null!=a){a.dataTransfer.dropEffect="none";a.returnValue=false}}function RTE_FInterpretTextAsBoolean(a){return a.toLowerCase()=="true"?true:false}function RTE_OnKeyDown(b,n){if(RTE_DD_MenuIsOpen()){RTE_DD_OnKeyDown(n);return}var h=RTE_GetEditorInstanceVariables(b);if(h!=null){var l=h.overrides;if(typeof l.OnKeyDown!="undefined"&&l.OnKeyDown!=null)return l.OnKeyDown(b)}RTE_SaveSelection(b);var m=RTE_IsInRestrictedMode(b),g=RTE_IsSimpleTextOnly(b),q=RTE_IsHyperlinkAllowed(b),k=n.ownerDocument,c=GetParentWindow2(k).event,d=c.keyCode,f=c.altKey,i=c.ctrlKey,e=c.shiftKey,j=false,a=null;if(browseris.ie5up&&!browseris.ie55up&&!i&&!f&&!e)switch(d){case 9:var o=RTE_GetEditorDocument(b).body.createTextRange();o.collapse(true);o.select()}if(!i&&!f&&e)switch(d){case 9:RTE_GetEditorDocument(b).body.contentEditable=false;var p=RTE_GetEditorDocument(b).body.createTextRange();p.collapse(true);p.select()}else if(!i&&!f&&!e)switch(d){case 13:if(h.hoverButton!=null){c.returnValue=false;a=h.hoverButton.childNodes[0];a.click()}}else if(i){switch(d){case 192:j=true;c.returnValue=RTE_MoveFocusBackwards(b,k.activeElement);break;case 49:j=true;c.returnValue=RTE_MoveFocusForwards(b,k.activeElement)}if(Strings.STS.L_BoldKey_TEXT.charCodeAt(0)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_BoldShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_BoldAltKey_TEXT)==f){c.returnValue=false;if(!g){a=RTE_TB_GetToolBarButton(b,g_strRTEBoldMnemonic).childNodes[0];a.click()}}else if(Strings.STS.L_SelectAllKey_TEXT.charCodeAt(0)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_BoldShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_BoldAltKey_TEXT)==f){c.returnValue=false;var s=RTE_GetEditorDocument(b),r=s.body.createTextRange();r.select()}else if(Strings.STS.L_ItalicKey_TEXT.charCodeAt(0)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_ItalicShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_ItalicAltKey_TEXT)==f){c.returnValue=false;if(!g){a=RTE_TB_GetToolBarButton(b,g_strRTEItalicMnemonic).childNodes[0];a.click()}}else if(Strings.STS.L_UnderlineKey_TEXT.charCodeAt(0)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_UnderlineShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_UnderlineAltKey_TEXT)==f){c.returnValue=false;if(!g){a=RTE_TB_GetToolBarButton(b,g_strRTEUnderlineMnemonic).childNodes[0];a.click()}}else if(Strings.STS.L_JustifyLeftKey_TEXT.charCodeAt(0)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_JustifyLeftShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_JustifyLeftAltKey_TEXT)==f){c.returnValue=false;if(!g){a=RTE_TB_GetToolBarButton(b,g_strRTEJustifyLeftMnemonic).childNodes[0];a.click()}}else if(Strings.STS.L_JustifyCenterKey_TEXT.charCodeAt(0)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_JustifyCenterShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_JustifyCenterAltKey_TEXT)==f){c.returnValue=false;if(!g){a=RTE_TB_GetToolBarButton(b,g_strRTEJustifyCenterMnemonic).childNodes[0];a.click()}}else if(Strings.STS.L_JustifyRightKey_TEXT.charCodeAt(0)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_JustifyRightShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_JustifyRightAltKey_TEXT)==f){c.returnValue=false;if(!g){a=RTE_TB_GetToolBarButton(b,g_strRTEJustifyRightMnemonic).childNodes[0];a.click()}}else if(Strings.STS.L_IndentKey_TEXT.charCodeAt(0)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_IndentShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_IndentAltKey_TEXT)==f){c.returnValue=false;if(!g){a=RTE_TB_GetToolBarButton(b,g_strRTEIndentMnemonic).childNodes[0];a.click()}}else if(Strings.STS.L_CreateLinkKey_TEXT.charCodeAt(0)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_CreateLinkShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_CreateLinkAltKey_TEXT)==f){c.returnValue=false;if(!g&&(!m||q)){a=RTE_TB_GetToolBarButton(b,g_strRTECreateLinkMnemonic).childNodes[0];a.click()}}else if(Strings.STS.L_SelectFontNameKey_TEXT.charCodeAt(0)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_SelectFontNameShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_SelectFontNameAltKey_TEXT)==f){c.returnValue=false;if(!g){a=RTE_TB_GetToolBarButton(b,g_strRTEFontNameMnemonic).childNodes[0];a.click()}}else if(Strings.STS.L_SelectFontSizeKey_TEXT.charCodeAt(0)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_SelectFontSizeShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_SelectFontSizeAltKey_TEXT)==f){c.returnValue=false;if(!g){a=RTE_TB_GetToolBarButton(b,g_strRTEFontSizeMnemonic).childNodes[0];a.click()}}else if(Strings.STS.L_InsertTableKey_TEXT.charCodeAt(0)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_InsertTableShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_InsertTableAltKey_TEXT)==f){c.returnValue=false;if(!g){a=RTE_TB_GetToolBarButton(b,g_strRTEInsertTableMnemonic).childNodes[0];a.click()}}else if(Strings.STS.L_SplitCellKey_TEXT.charCodeAt(0)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_SplitCellShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_SplitCellAltKey_TEXT)==f){c.returnValue=false;if(!g){a=RTE_TB_GetToolBarButton(b,g_strRTESplitCellMnemonic).childNodes[0];a.click()}}else if(Strings.STS.L_MergeCellKey_TEXT.charCodeAt(0)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_MergeCellShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_MergeCellAltKey_TEXT)==f){c.returnValue=false;if(!g){a=RTE_TB_GetToolBarButton(b,g_strRTEMergeCellMnemonic).childNodes[0];a.click()}}else if(parseInt(Strings.STS.L_DeleteColumnKeyCode_TEXT)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_DeleteColumnShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_DeleteColumnAltKey_TEXT)==f){c.returnValue=false;!g&&RTE_DeleteColumn(b)}else if(parseInt(Strings.STS.L_DeleteRowKeyCode_TEXT)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_DeleteRowShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_DeleteRowAltKey_TEXT)==f){c.returnValue=false;!g&&RTE_DeleteRow(b)}else if(Strings.STS.L_InsertCellLeftKey_TEXT.charCodeAt(0)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_InsertCellLeftShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_InsertCellLeftAltKey_TEXT)==f){c.returnValue=false;!g&&RTE_InsertCellLeft(b)}else if(Strings.STS.L_InsertCellRightKey_TEXT.charCodeAt(0)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_InsertCellRightShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_InsertCellRightAltKey_TEXT)==f){c.returnValue=false;!g&&RTE_InsertCellRight(b)}else if(parseInt(Strings.STS.L_InsertColumnLeftKeyCode_TEXT)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_InsertColumnLeftShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_InsertColumnLeftAltKey_TEXT)==f){c.returnValue=false;!g&&RTE_InsertColumnLeft(b)}else if(parseInt(Strings.STS.L_InsertColumnRightKeyCode_TEXT)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_InsertColumnRightShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_InsertColumnRightAltKey_TEXT)==f){c.returnValue=false;!g&&RTE_InsertColumnRight(b)}else if(parseInt(Strings.STS.L_InsertRowAboveKeyCode_TEXT)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_InsertRowAboveShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_InsertRowAboveAltKey_TEXT)==f){c.returnValue=false;!g&&RTE_InsertRowAbove(b)}else if(parseInt(Strings.STS.L_InsertRowBelowKeyCode_TEXT)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_InsertRowBelowShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_InsertRowBelowAltKey_TEXT)==f){c.returnValue=false;!g&&RTE_InsertRowBelow(b)}else if(Strings.STS.L_SelectForeColorKey_TEXT.charCodeAt(0)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_SelectForeColorShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_SelectForeColorAltKey_TEXT)==f){c.returnValue=false;if(!g){a=RTE_TB_GetToolBarButton(b,g_strRTEForeColorMnemonic).childNodes[0];a.click()}}else if(Strings.STS.L_SelectBackColorKey_TEXT.charCodeAt(0)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_SelectBackColorShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_SelectBackColorAltKey_TEXT)==f){c.returnValue=false;if(!g){a=RTE_TB_GetToolBarButton(b,g_strRTEBackColorMnemonic).childNodes[0];a.click()}}else if(Strings.STS.L_UnorderedListKey_TEXT.charCodeAt(0)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_UnorderedListShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_UnorderedListAltKey_TEXT)==f){c.returnValue=false;if(!g){a=RTE_TB_GetToolBarButton(b,g_strRTEUnorderedListMnemonic).childNodes[0];a.click()}}else if(Strings.STS.L_OrderedListKey_TEXT.charCodeAt(0)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_OrderedListShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_OrderedListAltKey_TEXT)==f){c.returnValue=false;if(!g){a=RTE_TB_GetToolBarButton(b,g_strRTEOrderedListMnemonic).childNodes[0];a.click()}}else if(Strings.STS.L_OutdentKey_TEXT.charCodeAt(0)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_OutdentShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_OutdentAltKey_TEXT)==f){c.returnValue=false;if(!g){a=RTE_TB_GetToolBarButton(b,g_strRTEOutdentMnemonic).childNodes[0];a.click()}}else if(Strings.STS.L_InsertImageKey_TEXT.charCodeAt(0)==d&&RTE_FInterpretTextAsBoolean(Strings.STS.L_InsertImageShiftKey_TEXT)==e&&RTE_FInterpretTextAsBoolean(Strings.STS.L_InsertImageAltKey_TEXT)==f){c.returnValue=false;if(!m){a=RTE_TB_GetToolBarButton(b,g_strRTEInsertImageMnemonic).childNodes[0];a.click()}}else if(Number(Strings.STS.L_LTRKey_VALUE)==d&&e){c.returnValue=false;a=RTE_TB_GetToolBarButton(b,g_strRTELTRMnemonic).childNodes[0];a.click()}else if(Number(Strings.STS.L_RTLKey_VALUE)==d&&e){c.returnValue=false;a=RTE_TB_GetToolBarButton(b,g_strRTERTLMnemonic).childNodes[0];a.click()}else browseris.ie55up&&document.fireEvent("onkeydown",document.createEventObject(c))}!j&&RTE_TB_RemoveLastToolBarHover(b)}function RTE_OnKeyUp(b,d){RTE_StartResetToolBarTimer(b);var c=GetParentWindow2(d.ownerDocument).event,a=c.keyCode;(a==16||a==17||a==9)&&RTE_SaveSelection(b)}function RTE_OnSelectStart(a,d){var c=RTE_GetCurrentSelectionChain(a),b=GetParentWindow2(d.ownerDocument).event;b.ctrlKey&&!b.shiftKey&&RTE_IsElementInChain(c,"A")&&RTE_ClickLink(a)}function RTE_OnMouseUp(a){RTE_SaveSelection(a);RTE_DD_CloseMenu();RTE_TB_RemoveLastToolBarHover(a);RTE_StartResetToolBarTimer(a)}function RTE_OnPaste_Restricted(a,d){RTE_SaveSelection(a);GetParentWindow2(d.ownerDocument).event.returnValue=false;RTE_RestoreSelection(a);var c=RTE_GetSelection(a),b=window.clipboardData.getData("Text");if(null!=c&&null!=b)c.text=b}var g_cRTEResetToolBarTimerQueue;function RTE_StartResetToolBarTimer(a){if(g_cRTEResetToolBarTimerQueue==null)g_cRTEResetToolBarTimerQueue=[];if(g_cRTEResetToolBarTimerQueue[a]==null)g_cRTEResetToolBarTimerQueue[a]=0;++g_cRTEResetToolBarTimerQueue[a];window.setTimeout('RTE_OnResetToolBarTimer("'+a+'")',200)}function RTE_OnResetToolBarTimer(a){--g_cRTEResetToolBarTimerQueue[a];0==g_cRTEResetToolBarTimerQueue[a]&&RTE_ResetAllToolBarStates(a)}var g_fRTEFirstTimeGenerateCalled;function RTE_GenerateIFrameEditorHtml(g,e,i,h){var a=[];if(g_fRTEFirstTimeGenerateCalled){g_fRTEFirstTimeGenerateCalled=false;a.push('<iframe id="');a.push(g_strRTETextEditorPullDownMenuID);a.push('"  src="');a.push(RTE_GetServerRelativeUnlocalizedImageUrl("blank.gif"));a.push('" class="');a.push(g_strRTEToolbarClassName);a.push('" tabindex="-1" style="display:none; position:absolute;" ');a.push(g_strRTEBaseElementIDAttributeName);a.push('="x" ');a.push(g_strRTEWebLocaleAttributeName);a.push('="x" ');a.push(g_strRTEButtonMnemonicAttributeName);a.push('="x"></iframe>');insertAdjacentHTML(document.body,"afterBegin",'<div style="position:absolute;width:0px;height:0px;"><object id="RTEDialogHelper" name="RTEDialogHelper" classid="clsid:3050f819-98b5-11cf-bb82-00aa00bdce0b" style="width:0px; height:0px;" tabindex="-1"></object></div>')}var d="",c="",b="",f=Number(e.getAttribute("rows"));if(i&&Number.NaN!=f&&f>0){d="";c=' height="'+String(f*g_iLineHeight)+'"';if(h)b=' class="ms-rtelonger"';else b=' class="ms-rtelong"'}else{var j=e.cols,k=e.rows;d=' width="'+String(g_iCharWidth*j)+'"';c=' height="'+String(g_iLineHeight*k)+'"';b=""}a.push("<div><iframe ");a.push(d);a.push(c);a.push(b);a.push(' id="');a.push(RTE_GetEditorIFrameID(g));a.push('" title="');a.push(Strings.STS.L_EditorIFrameTitle_TEXT);a.push('" src="');a.push(RTE_GetServerRelativeUnlocalizedImageUrl("blank.gif"));a.push('"></iframe></div>');return a.join("")}function RTE_TB_GenerateToolbarButtonOnclickScript(b,e,d,c){var a="if (!(RTE_TB_GetToolBarButton('"+b+"', '"+e+"').disabled)) { ";a+=d+"('"+b+"'";if(c!=null)a+=", "+c;a+="); }";return a}function RTE_TB_GenerateSimpleToolBarButtonHtmlCluster(b,a,c,f,d,e,g){a:;return RTE_TB_GenerateToolBarButtonHtmlCluster(b,a,RTE_TB_GenerateToolbarButtonOnclickScript(b,a,c,f),d,e,g)}function RTE_TB_GenerateSimpleToolBarButtonHtml(b,a,c,d,e,g,f){return RTE_TB_GenerateToolBarButtonHtml(b,a,RTE_TB_GenerateToolbarButtonOnclickScript(b,a,c,d),e,g,f)}function RTE_GenerateFontNameToolBarButtonHtml(b,e,d,c){var a="";a+=RTE_TB_GenerateOpenCellButtonHtml(b,g_strRTEFontNameMnemonic,"RTE_SaveSelection('"+b+"'); RTE_DD_OpenFontNameOrSizeSelector('"+b+"' ,'"+e+"', true)");if(d||c){a+="<div class='clip16x16'><img class='ms-rtefnt' src=\""+RTE_GetServerRelativeImageUrl("rtecluster.png")+'" alt="'+Strings.STS.L_FontNameToolTip_TEXT+'" border="0" unselectable="on"></div>';if(c)a+='<img alt="'+Strings.STS.L_FontSizeToolTip_TEXT+'" src="'+RTE_GetServerRelativeUnlocalizedImageUrl("menudark.gif")+'" border="0" width="13" height="13" unselectable="on">'}else a+='<label style="margin-left: 2px; margin-right: 2px;">'+Strings.STS.L_FontNameLabel_TEXT+"</label>&nbsp;<div class='clip13x13'><img class='ms-rtednar' alt=\""+Strings.STS.L_FontNameToolTip_TEXT+'" src="'+RTE_GetServerRelativeImageUrl("rtecluster.png")+'" border="0" unselectable="on"></div>';a+=RTE_TB_GenerateCloseCellButtonHtml();return a}function RTE_GenerateFontSizeToolBarButtonHtml(b,e,d,c){var a="";a+=RTE_TB_GenerateOpenCellButtonHtml(b,g_strRTEFontSizeMnemonic,"RTE_SaveSelection('"+b+"'); RTE_DD_OpenFontNameOrSizeSelector('"+b+"', '"+e+"', false)");if(d||c){a+="<div class='clip16x16'><img class='ms-rtefntsz' src=\""+RTE_GetServerRelativeImageUrl("rtecluster.png")+'" alt="'+Strings.STS.L_FontSizeToolTip_TEXT+'" border="0" unselectable="on"></div>';if(c)a+='<img alt="'+Strings.STS.L_FontSizeToolTip_TEXT+'" src="'+RTE_GetServerRelativeUnlocalizedImageUrl("menudark.gif")+'" border="0" width="13" height="13" unselectable="on">'}else a+='<label style="margin-left: 2px; margin-right: 2px;">'+Strings.STS.L_FontSizeLabel_TEXT+"</label>&nbsp;<div class='clip13x13'><img class='ms-rtednar' alt=\""+Strings.STS.L_FontSizeToolTip_TEXT+'" src="'+RTE_GetServerRelativeImageUrl("rtecluster.png")+'" border="0" unselectable="on"></div>';a+=RTE_TB_GenerateCloseCellButtonHtml();return a}function RTE_GenerateForeColorToolBarButtonHtml(a,c){var b="";b+=RTE_TB_GenerateOpenCellButtonHtml(a,g_strRTEForeColorMnemonic);b+='<a tabindex="-1" href="#" onfocus="RTE_TB_OnFocus(\''+a+"', this);\" onblur=\"RTE_TB_OnBlur('"+a+"', this);\" onclick=\"RTE_DD_OpenForeColorSelector('"+a+"', '"+c+"'); return false;\" unselectable=\"on\"><div class='clip16x16'><img class='ms-rtetxclr' src=\""+RTE_GetServerRelativeImageUrl("rtecluster.png")+'" alt="'+Strings.STS.L_ForeColorToolTip_TEXT+'" border="0" unselectable="on"></div></a>';b+=RTE_TB_GenerateCloseCellButtonHtml();return b}function ToolBarSettings_InitializePrototype(){a:;ToolBarSettings.prototype.fRestrictedMode=undefined;ToolBarSettings.prototype.fAllowHyperlink=undefined;ToolBarSettings.prototype.fIsVisible=undefined;ToolBarSettings.prototype.urlWebRoot=undefined;ToolBarSettings.prototype.fAllowRelativeLinks=undefined;ToolBarSettings.prototype.fPreserveScript=undefined}function ToolBarSettings(){}function RTE_GenerateToolBarHtml(b,e,f,d,c,g){var a=new ToolBarSettings;a.fRestrictedMode=d;a.fAllowHyperlink=c;a.fIsVisible=g;RTE_GenerateToolBarHtmlFromSettings(b,e,f,a)}function RTE_GenerateToolBarHtmlFromSettings(c,h,j,d){var b=' class="'+g_strRTEToolbarClassName+'" ',g=' width="'+j.currentStyle.width+'" ',i=d.fIsVisible?' style="border:solid 1px #c4c4c4;"':' style="display:none;" ';if(d.fRestrictedMode){if(d.fAllowHyperlink)b=' class="'+g_strRTEToolbarClassName+' ms-longer" ';else b=' class="'+g_strRTEToolbarClassName+' ms-long" ';g=""}var a=[];a.push("<table cellpadding='0' cellspacing='0' id='");a.push(c);a.push("_toolbar' ");a.push(b);a.push(g);a.push(i);a.push("><tr><td><table cellspacing='0' cellpadding='0' border='0'><tr>");var e=RTE_GetToolBarDefinition(c,h);if(e!=null)for(var f=0;f<e.length;f++){var k=e[f];a.push(k.Generate(c,h))}a.push("</tr></table></td></tr></table>");return a.join("")}function RTE_GenerateBackColorToolBarButtonHtml(a,c){var b="";b+=RTE_TB_GenerateOpenCellButtonHtml(a,g_strRTEBackColorMnemonic);b+='<a tabindex="-1" href="#" onfocus="RTE_TB_OnFocus(\''+a+"', this);\" onblur=\"RTE_TB_OnBlur('"+a+"', this);\" onclick=\"RTE_DD_OpenBackColorSelector('"+a+"', '"+c+"'); return false;\" unselectable=\"on\"><div class='clip16x16'><img class='ms-rtebkclr' src=\""+RTE_GetServerRelativeImageUrl("rtecluster.png")+'" alt="'+Strings.STS.L_BackColorToolTip_TEXT+'" border="0" unselectable="on"></div></a>';b+=RTE_TB_GenerateCloseCellButtonHtml();return b}function RTE_InsertTable(b){var c=RTE_ModalDialog(b,"InsertTable",g_RTE_Dialog_Width,g_RTE_Dialog_Height,null);if(c!=null){for(var f=c[0],g=c[1],a='<table style="display: inline; font-size: 1em; border-collapse: collapse" border="1">',d=0;d<g;++d){a+="<tr>";for(var e=0;e<f;++e)a+='<td style="vertical-align:TOP;" class="ms-rtetablecells"><div></div></td>';a+="</tr>"}a+="</table>";RTE_GetSelection(b).pasteHTML(a);RTE_UseDynamicHeightSizing(b)&&RTE_DocEditor_AdjustHeight(b)}}function RTE_CreateLink(a){RTE_SaveSelection(a);var b=false,d=RTE_GetEditorInstanceVariables(a);if(d!=null&&d.aSettings!=null)b=d.aSettings.fAllowRelativeLinks;var c=[];c.text=RTE_GetCurrentSelectionRange(a).text;c.allowRelativeLinks=b;var e=RTE_ModalDialog(a,"CreateLink",g_RTE_Dialog_Width,g_RTE_Dialog_Height,c);if(e!=null){var f=STSHtmlEncode(e[1]),g=STSHtmlEncode(e[0]);IsSafeHrefAlert(f,b)&&RTE_GetSelection(a).pasteHTML('<a href="'+f+'">'+g+"</a>")}}function RTE_ClickLink(c){if(g_fRestoreSelection)return;RTE_SaveSelection(c);for(var d=RTE_GetCurrentSelectionChain(c),b=null,a=0;a<d.length;a++){b=d[a];if(b.tagName=="A"){open(b.href);break}}}function RTE_InsertImage(a){RTE_SaveSelection(a);var c=RTE_ModalDialog(a,"InsertImage",g_RTE_Dialog_Width,g_RTE_Dialog_Height,null);if(c!=null){var e=STSHtmlEncode(c[0]),f=STSHtmlEncode(c[1]),d=false,b=RTE_GetEditorInstanceVariables(a);if(b!=null&&b.aSettings!=null)d=b.aSettings.fAllowRelativeLinks;if(IsSafeHrefAlert(e,d)){var g='<img src="'+e+'" alt="'+f+'">';RTE_GetSelection(a).pasteHTML(g)}RTE_UseDynamicHeightSizing(a)&&RTE_DocEditor_AdjustHeight(a)}}function RTE_HtmlSource(a){var b=RTE_GetEditorDocument(a),c=[];c.value=b.body.innerHTML;c.dir=b.dir;var e=RTE_GetEditorInstanceVariables(a);b.body.innerHTML=window.showModalDialog(e.aSettings.urlWebRoot+"/_layouts/15/zoombldr.aspx",c,"dialogHeight: 550px; dialogWidth:500px; help: no; status:no; resizable: yes");var d=b.body.createTextRange();d.select();d.scrollIntoView(false);RTE_UseDynamicHeightSizing(a)&&RTE_DocEditor_AdjustHeight(a)}function RTE_GenerateInsertTableElementToolBarButtonHtml(b,c){var a=RTE_GetEditorInstanceVariables(b);a.functions[g_strRTEInsertRowAbove]=RTE_InsertRowAbove;a.functions[g_strRTEInsertRowBelow]=RTE_InsertRowBelow;a.functions[g_strRTEInsertColumnLeft]=RTE_InsertColumnLeft;a.functions[g_strRTEInsertColumnRight]=RTE_InsertColumnRight;a.functions[g_strRTEInsertCellLeft]=RTE_InsertCellLeft;a.functions[g_strRTEInsertCellRight]=RTE_InsertCellRight;return RTE_GenerateTableToolBarButtonHtml(b,c,g_strRTEInsertTableElementMnemonic,Strings.STS.L_InsertTableElementToolTip_TEXT,"rteirow")}function RTE_GenerateDeleteTableElementToolBarButtonHtml(a,c){var b=RTE_GetEditorInstanceVariables(a);b.functions[g_strRTEDeleteRow]=RTE_DeleteRow;b.functions[g_strRTEDeleteColumn]=RTE_DeleteColumn;return RTE_GenerateTableToolBarButtonHtml(a,c,g_strRTEDeleteTableElementMnemonic,Strings.STS.L_DeleteTableElementToolTip_TEXT,"rtedrow")}function RTE_GenerateTableToolBarButtonHtml(a,e,c,b,d){return RTE_TB_GenerateOpenCellButtonHtml(a,c)+'<a tabindex="-1" href="#" onfocus="RTE_TB_OnFocus(\''+a+"', this);\" onblur=\"RTE_TB_OnBlur('"+a+"', this);\" onclick=\"RTE_DD_OpenTableOperationSelector('"+a+"' ,'"+e+"', '"+c+'\'); return false;" title="'+b+'" style="margin-left: 2px; margin-right: 2px;" unselectable="on"><div class=\'clip16x16\'><img class=\'ms-'+d+"'src=\""+RTE_GetServerRelativeImageUrl("rtecluster.png")+'" alt="'+b+'" border="0" unselectable="on"></div><img alt="'+b+'" src="'+RTE_GetServerRelativeUnlocalizedImageUrl("menudark.gif")+'" border="0" width="13" height="13" unselectable="on"></a>'+RTE_TB_GenerateCloseCellButtonHtml()}function RTE_DD_OpenTableOperationSelector(a,d,c){var b=RTE_DD_GetTableOperationSelectorUnformattedHtml(a,d,c),e=b[0],f=b[1];RTE_DD_OpenMenu(a,c,e,f)}function RTE_DD_InsertItemAndGenerateScript(c,a,e,f,b,d){b[a]=f;return RTE_DD_GenerateMenuItemScriptHtml(1,a,"RTE_DD_StartAction('"+e+"', '"+c+"')",b[a],b[a],null,null,d)}function RTE_DD_GetTableOperationSelectorUnformattedHtml(c,d,e){var a=RTE_DD_GenerateMenuOpenHtml(),b=[];switch(e){case g_strRTEInsertTableElementMnemonic:a+=RTE_DD_InsertItemAndGenerateScript(c,0,g_strRTEInsertRowAbove,Strings.STS.L_InsertRowAboveLabel_TEXT,b,d);a+=RTE_DD_InsertItemAndGenerateScript(c,1,g_strRTEInsertRowBelow,Strings.STS.L_InsertRowBelowLabel_TEXT,b,d);a+=RTE_DD_InsertItemAndGenerateScript(c,2,g_strRTEInsertColumnLeft,Strings.STS.L_InsertColumnLeftLabel_TEXT,b,d);a+=RTE_DD_InsertItemAndGenerateScript(c,3,g_strRTEInsertColumnRight,Strings.STS.L_InsertColumnRightLabel_TEXT,b,d);a+=RTE_DD_InsertItemAndGenerateScript(c,4,g_strRTEInsertCellLeft,Strings.STS.L_InsertCellLeftLabel_TEXT,b,d);a+=RTE_DD_InsertItemAndGenerateScript(c,5,g_strRTEInsertCellRight,Strings.STS.L_InsertCellRightLabel_TEXT,b,d);break;case g_strRTEDeleteTableElementMnemonic:a+=RTE_DD_InsertItemAndGenerateScript(c,0,g_strRTEDeleteRow,Strings.STS.L_DeleteRowToolTip_TEXT,b,d);a+=RTE_DD_InsertItemAndGenerateScript(c,1,g_strRTEDeleteColumn,Strings.STS.L_DeleteColumnToolTip_TEXT,b,d)}var f=b.length;a+=RTE_DD_GenerateMenuCloseHtml();return new([a,f])}function RTE_MoveFocus(b,l,e){var j=RTE_GetEditorDocument(b),f=RTE_GetEditorInstanceVariables(b);if(RTE_HasActiveSelection(j)){var k=RTE_GetCurrentSelection(b);if(k.type=="Control")return true}var d=RTE_GetToolBarDefinition(b),a=0;if(f.hoverButton==null)if(e==-1&&d!=null)a=d.length-1;else a=0;else a=f.hoverButton.toolbarButtonIndex+e;while(true){if(a<0||a==d.length){RTE_TB_RemoveLastToolBarHover(b);var i=RTE_GetCurrentSelection(b),g=i.createRange();g.collapse();g.select();return true}var h=d[a];if(h.strMnemonic!=null){var c=RTE_TB_GetToolBarButton(b,h.strMnemonic);if(c!=null&&!c.disabled&&RTE_IsVisible(c)){RTE_TB_OnMouseOver(c);return false}}if(e<0)a--;else a++}return false}function RTE_IsVisible(a){return a==null?true:a.currentStyle.visibility=="inherit"?RTE_IsVisible(a.parentNode):a.currentStyle.visibility=="hidden"?false:true}function RTE_TB_RemoveLastToolBarHover(b){var a=RTE_GetEditorInstanceVariables(b);a.hoverButton!=null&&RTE_TB_OnMouseOut(a.hoverButton)}function RTE_TB_SetLastToolBarHover(b,c){var a=RTE_GetEditorInstanceVariables(b);a.hoverButton=c}function RTE_MoveFocusBackwards(a,b){return RTE_MoveFocus(a,b,-1)}function RTE_MoveFocusForwards(a,b){return RTE_MoveFocus(a,b,1)}function RTE_ExecuteCommandOnSelection(a,b,d,f){var e=RTE_GetEditorDocument(a);RTE_RestoreSelection(a);if(b==g_strRTECreateLinkMnemonic||b==g_strRTEInsertImageMnemonic)g_fRTEDialogIsOpen=true;e.execCommand(b,d,f);if(g_fRTEDialogIsOpen){g_fRTEDialogIsOpen=false;RTE_OnFocus(a)}RTE_StartResetToolBarTimer(a);var c=RTE_UseDynamicHeightSizing(a);c&&RTE_DocEditor_AdjustHeight(a)}function RTE_ExecuteFunctionOnSelection(a,d,e){a:;var f=RTE_GetEditorDocument(a);RTE_RestoreSelection(a);var c=RTE_GetEditorInstanceVariables(a),b=c.functions[d];if(b!=null){b(e);if(g_fRTEDialogIsOpen){g_fRTEDialogIsOpen=false;RTE_OnFocus(a)}}RTE_StartResetToolBarTimer(a)}function RTE_SetDirectionOfSelection(b,d){var i=RTE_GetEditorInstanceVariables(b);if(i!=null){var g=i.overrides;if(typeof g.SetDirectionOfSelection!="undefined"&&g.SetDirectionOfSelection){g.SetDirectionOfSelection(b,d);return}}RTE_SaveSelection(b);var c=RTE_GetSelection(b);RTE_RestoreSelection(b);var f;f="|H1|H2|H3|H4|H5|H6|P|PRE|TD|DIV|BLOCKQUOTE|DT|DD|TABLE|HR|IMG|BODY|TR|UL|OL|";if(null!=c.parentElement()){var a=c.parentElement();while(a!=null&&f.indexOf("|"+a.tagName+"|")==-1)a=a.parentNode;null!=a&&RTE_SetDirectionOnElement(a,d)}else for(var j=c.length,h=0;h<j;++h){var e=c.item(h);e!=null&&f.indexOf("|"+e.tagName+"|")!=-1&&RTE_SetDirectionOnElement(e,d)}}function RTE_SetDirectionOnElement(a,b){if("ltr"==b){a.dir="ltr";a.align="left"}else if("rtl"==b){a.dir="rtl";a.align="right"}}function RTE_GetDirectionOfSelection(b){var a=RTE_GetSelection(b);return!(null!=a)?"":RTE_GetDirectionOfSelectionParent(a.parentElement())}function RTE_GetDirectionOfSelectionParent(a){var b="",c="|H1|H2|H3|H4|H5|H6|P|PRE|LI|TD|DIV|BLOCKQUOTE|DT|DD|TABLE|HR|IMG|TR|UL|OL|BODY|HTML|";while(a!=null&&(c.indexOf("|"+a.tagName+"|")==-1||a.dir!="ltr"&&a.dir!="rtl"))a=a.parentNode;if(null!=a)if(a.dir=="ltr")b="ltr";else if(a.dir=="rtl")b="rtl";return b}var g_strRTEToolBarButtonWithTheFocus;function RTE_ToolBarButtonWithTheFocus(){a:;return g_strRTEToolBarButtonWithTheFocus}var g_aToolBarButtons;function RTE_TB_GetToolBarButton(c,b){if(g_aToolBarButtons==null)g_aToolBarButtons=[];var a=g_aToolBarButtons[c+"_"+b];if(a==null){a=document.getElementById(c+"_"+b);g_aToolBarButtons[c+"_"+b]=a}return a}function RTE_TB_GenerateOpenCellButtonHtml(e,d,b,c){var a=[];a.push('<td class="');a.push(g_strRTEToolbarClassName);a.push('" unselectable="on"><table cellpadding="1" cellspacing="0" border="0" unselectable="on"><tr unselectable="on"><td class="');a.push(g_strRTEToolbarClassName);a.push(" ");a.push(g_strRTEUnselectedClassName);a.push('" nowrap id="');a.push(e);a.push("_");a.push(d);a.push('" onmouseover="RTE_TB_OnMouseOver(this);" onmouseout="RTE_TB_OnMouseOut(this);"');if(b!=null){a.push(' onclick="RTE_DD_CloseMenu();');a.push(b);a.push('"')}if(c!=null){a.push(' title="');a.push(c);a.push('"')}a.push('unselectable="on">');return a.join("")}function RTE_TB_GenerateCloseCellButtonHtml(){a:;return"</td></tr></table></td>"}function RTE_TB_GenerateToolBarSeparatorHtml(){a:;return'<td class="ms-separator" unselectable="on">|</td>'}function RTE_TB_GenerateToolBarLineBreakHtml(){a:;return'</tr></table></td></tr><tr unselectable="on"><td unselectable="on"><table cellspacing="0" cellpadding="0" border="0" unselectable="on"><tr unselectable="on">'}function RTE_TB_GenerateToolBarButtonHtmlCluster(f,d,e,b,g,c){var a=[];a.push(RTE_TB_GenerateOpenCellButtonHtml(f,d,e,c));if(0<b.length){a.push("<div class='clip16x16'><img border='0' class=\"");a.push(g);a.push('" src="');a.push(b);a.push('" alt="');a.push(c);a.push('" unselectable="on"></div>')}a.push(RTE_TB_GenerateCloseCellButtonHtml());return a.join("")}function RTE_TB_GenerateToolBarButtonHtml(g,e,f,b,d,c){var a=[];a.push(RTE_TB_GenerateOpenCellButtonHtml(g,e,f,c));if(0<b.length){a.push('<img border="0" width="16" height="16" src="');a.push(b);a.push('" alt="');a.push(c);a.push('" unselectable="on">')}if(0<d.length){a.push(" ");a.push(d)}a.push(RTE_TB_GenerateCloseCellButtonHtml());return a.join("")}function RTE_TB_GenerateExecCommandToolBarButtonScript(c,h,g,d,b,e,f){var a=[];a.push("RTE_DD_CloseMenu();");if(d){a.push("var sel = RTE_GetEditorDocument('");a.push(c);a.push("').selection; if ((null != sel) && ('None' != sel.type)) { ")}a.push("RTE_SaveSelection('"+c+"');");a.push("var argValue = ");a.push(b);a.push(";");b!="null"&&a.push("if (argValue != null) { ");null!=e&&a.push(e);a.push("RTE_ExecuteCommandOnSelection('");a.push(c);a.push("', '");a.push(h);a.push("', ");a.push(g);a.push(", argValue);");null!=f&&a.push(f);b!="null"&&a.push("}");d&&a.push("}");return a.join("")}function RTE_TB_GenerateExecCommandToolBarButtonHtml(a,b,h,i,k,j,c,f,d,e){var g=RTE_TB_GenerateExecCommandToolBarButtonScript(a,b,h,c,f,d,e);return RTE_TB_GenerateToolBarButtonHtml(a,b,g,i,k,j)}function RTE_TB_GenerateExecCommandToolBarButtonHtmlCluster(a,b,f,g,h,i,c,d){var e=RTE_TB_GenerateExecCommandToolBarButtonScript(a,b,f,c,d);return RTE_TB_GenerateToolBarButtonHtmlCluster(a,b,e,g,h,i)}function RTE_TB_SetButtonCheck(a){a.className=RTE_RemoveClassFromClassList(a.className,g_strRTEUnselectedClassName);a.className=RTE_AddClassToClassList(a.className,g_strRTESelectedClassName)}function RTE_TB_ClearButtonCheck(a){a.className=RTE_RemoveClassFromClassList(a.className,g_strRTESelectedClassName);a.className=RTE_AddClassToClassList(a.className,g_strRTEUnselectedClassName)}function RTE_TB_SetButtonDisabled(a){a.className=RTE_AddClassToClassList(a.className,g_strRTEDisabledClassName);a.disabled=true;var b=a.childNodes[0];if(b!=null&&b.tagName=="A")b.disabled=true}function RTE_TB_ClearButtonDisabled(a){a.disabled=false;var b=a.childNodes[0];if(b!=null&&b.tagName=="A")b.disabled=false;a.className=RTE_RemoveClassFromClassList(a.className,g_strRTEDisabledClassName)}function RTE_TB_SetButtonHover(a){RTE_TB_RemoveLastToolBarHover(a.strBaseElementID);RTE_TB_SetLastToolBarHover(a.strBaseElementID,a);a.className=RTE_AddClassToClassList(a.className,g_strRTEHoverClassName)}function RTE_TB_ClearButtonHover(a){RTE_TB_SetLastToolBarHover(a.strBaseElementID,null);a.className=RTE_RemoveClassFromClassList(a.className,g_strRTEHoverClassName)}function RTE_TB_SetCheckFromCommandValue(d,a,b){var c=RTE_TB_GetToolBarButton(d,b);if(typeof a.queryCommandSupported!="undefined"&&typeof a.queryCommandValue!="undefined"&&a.queryCommandSupported(b)&&a.queryCommandValue(b))RTE_TB_SetButtonCheck(c);else RTE_TB_ClearButtonCheck(c)}function RTE_TB_SetCheckForDirectionButton(a,b){var c=RTE_TB_GetToolBarButton(a,b);if(RTE_GetDirectionOfSelection(a)=="ltr"&&b==g_strRTELTRMnemonic||RTE_GetDirectionOfSelection(a)=="rtl"&&b==g_strRTERTLMnemonic)RTE_TB_SetButtonCheck(c);else RTE_TB_ClearButtonCheck(c)}function RTE_HasActiveSelection(e){var b=true,a=null;a=e.selection;if(null==a||"none"==a.type)b=false;else{var d=a.createRange();if(d!=null){var c=d.text;if(c!=null&&0>=c.length)b=false}}return b}function RTE_TB_SetEnabledFromCommandEnabled(e,a,c,d){var b=RTE_TB_GetToolBarButton(e,c);if(typeof a.queryCommandEnabled!="undefined"&&a.queryCommandEnabled(d))RTE_TB_ClearButtonDisabled(b);else RTE_TB_SetButtonDisabled(b)}function RTE_TB_SetEnabledIfInElement(a,c,b,d){RTE_TB_SetEnabledFromCondition(a,RTE_IsElementInChain(c,d),b)}function RTE_TB_SetEnabledFromCondition(b,c,d){var a=RTE_TB_GetToolBarButton(b,d);if(c)RTE_TB_ClearButtonDisabled(a);else RTE_TB_SetButtonDisabled(a)}function RTE_TB_OnMouseOver(a){if(0>a.className.indexOf(g_strRTEDisabledClassName)){a.style.cursor="pointer";RTE_TB_SetButtonHover(a)}}function RTE_TB_OnMouseOut(a){RTE_TB_ClearButtonHover(a)}function RTE_TB_OnFocus(b,a){g_strRTEToolBarButtonWithTheFocus=a.parentNode.id}function RTE_TB_OnBlur(){g_strRTEToolBarButtonWithTheFocus=null}var g_strRTEDDBaseElementID,g_strRTEDDButtonMnemonic,g_fRTEFirstCallToGetMenu,g_elemRTEHighlightedMenuItem,g_iRTEHighlightedMenuItem,g_iRTEMenuItemMax,g_fRTEMenuMoved;function RTE_DD_GetMenuElement(){a:;var a=document.getElementById(g_strRTETextEditorPullDownMenuID);if(null==a){var b=window.parent.document;a=b.getElementById(g_strRTETextEditorPullDownMenuID)}return a}function RTE_DD_GetMenuFrame(){a:;var a=null,d=RTE_DD_GetMenuElement();if(null!=d)if(window.frames.length>0)a=window.frames[g_strRTETextEditorPullDownMenuID];else{var b=window.parent;if(b!=null&&b.frames!=null)a=b.frames[g_strRTETextEditorPullDownMenuID]}if(null==a){var c=document.getElementById(g_strRTETextEditorPullDownMenuID);if(c!=null)a=c.contentWindow}if(null==a)if(g_fRTEFirstCallToGetMenu){g_fRTEFirstCallToGetMenu=false;return null}return a}function RTE_DD_GetMenuBaseElementID(){a:;return RTE_DD_GetMenuElement().getAttribute(g_strRTEBaseElementIDAttributeName)}function RTE_DD_GetMenuButtonMnemonic(){a:;return RTE_DD_GetMenuElement().getAttribute(g_strRTEButtonMnemonicAttributeName)}function RTE_DD_MenuIsOpen(){a:;var a=RTE_DD_GetMenuElement();return a!=null&&""==a.style.display?true:false}function RTE_DD_OpenMenu(c,e,i,f,j){var a=RTE_DD_GetMenuElement(),b=RTE_DD_GetMenuFrame();if(!g_fRTEMenuMoved){insertAdjacentElement(g_elemRTELastTextAreaConverted,"afterEnd",a);a=RTE_DD_GetMenuElement();b=RTE_DD_GetMenuFrame()}if(g_strRTEDDBaseElementID==c&&g_strRTEDDButtonMnemonic==e){RTE_DD_CloseMenu();RTE_RestoreSelection(c);return}null!=g_strRTEDDBaseElementID&&null!=g_strRTEDDButtonMnemonic&&RTE_DD_CloseMenu();g_strRTEDDBaseElementID=c;g_strRTEDDButtonMnemonic=e;g_iRTEMenuItemMax=j-1;RTE_SaveSelection(c);var d=RTE_TB_GetToolBarButton(c,e);a.setAttribute(g_strRTEBaseElementIDAttributeName,c);a.setAttribute(g_strRTEButtonMnemonicAttributeName,e);a.setAttribute(g_strRTEMenuOpeningAttributeName,"1");a.style.top="0px";a.style.left="0px";a.style.height="";a.style.width="";var k="form.js",h="strings.js",g=RTE_GetWebLocale(c);b.document.open("text/html","replace");b.document.write('<html><head><link rel="stylesheet" type="text/css" href="'+RTE_GetServerRelativeStylesheetUrl("forms.css",g)+'"><script language="javascript" src="'+RTE_GetServerRelativeScriptUrl(h,g)+'"><\/script><script language="javascript" src="'+RTE_GetServerRelativeScriptUrl(k,null)+'"><\/script></head><body class="'+g_strRTEToolbarClassName+'"'+g_strRTECommandToExecuteAttributeName+'="x" '+g_strRTECommandValueAttributeName+'="x" '+g_strRTEFunctionToExecuteAttributeName+'="x" '+g_strRTEFunctionParameterToExecuteAttributeName+'="x" unselectable=\'on\'><div class="'+g_strRTEToolbarClassName+'" id="divAroundMenu" unselectable=\'on\'>'+i+"</div></body></html>");b.document.close();a=RTE_DD_GetMenuElement();b=RTE_DD_GetMenuFrame();window.setTimeout(function(){a:;b.document.body.onkeydown=new Function("RTE_DD_OnKeyDown(this);");a.style.border="0px";b.document.body.style.border="1px solid black";a.style.display="";var t=b.document.getElementById("divAroundMenu"),r=b.document.getElementById(g_strRTEMenuTableElementName),q=300,m=RTE_GetElementWindowCoordinates(a),i=RTE_GetElementWindowCoordinates(d),w=i[g_iRTELeft],x=i[g_iRTETop],u=d.offsetWidth,v=d.offsetHeight,j=r.scrollWidth+4,h=r.scrollHeight+4,s=document.body.clientWidth,p=document.body.clientHeight,k=i[g_iRTETop]+d.offsetHeight-m[g_iRTETop],o=RTE_GetEditorDocument(c),e;if(f=="1037"||f=="1025"||o.dir=="rtl")e=i[g_iRTERight]-j-m[g_iRTELeft];else e=i[g_iRTELeft]-m[g_iRTELeft];var n=false;if(h>q){n=true;h=q}if(h>p){n=true;h=p-30}var l=document.body.scrollTop;l+=document.body.parentNode.scrollTop;if(k+h>p+l){k=i[g_iRTETop]-h;if(l>k)k=l}o=RTE_GetEditorDocument(c);if(f=="1037"||f=="1025"||o.dir=="rtl")b.document.body.dir="rtl";if(n){b.document.body.scroll="yes";j+=22;if(b.document.body.dir=="rtl"){e-=22;if(g>e)e=g}}else b.document.body.scroll="";var g=document.body.scrollLeft;g+=document.body.parentNode.scrollLeft;if(e+j>s+g){if(b.document.body.dir!="rtl")e=s+g-j;if(g>e)e=g}a.style.zIndex=String(500);a.style.left=String(e)+"px";a.style.top=String(k)+"px";a.style.width=String(j)+"px";a.style.height=String(h)+"px";RTE_DD_SetHighlightOnMenuItem(RTE_DD_GetMenuItem(0))},0);event.cancelBubble=true}function RTE_DD_CloseMenu(){a:;var b=RTE_DD_GetMenuElement();if(null==b)return;b.style.display="none";g_strRTEDDBaseElementID!=null&&g_strRTEDDButtonMnemonic!=null&&RTE_TB_ClearButtonHover(RTE_TB_GetToolBarButton(g_strRTEDDBaseElementID,g_strRTEDDButtonMnemonic));g_strRTEDDBaseElementID=null;g_strRTEDDButtonMnemonic=null;g_elemRTEHighlightedMenuItem=null;g_iRTEHighlightedMenuItem=-1;g_iRTEMenuItemMax=-1;var a=window.parent;if(null!=a)try{a.g_strRTEDDBaseElementID=null;a.g_strRTEDDButtonMnemonic=null;a.g_elemRTEHighlightedMenuItem=null;a.g_iRTEHighlightedMenuItem=-1;a.g_iRTEMenuItemMax=-1}catch(c){}}function RTE_DD_GenerateMenuOpenHtml(){a:;return'<table class="ms-rtedropdown" id="'+g_strRTEMenuTableElementName+'" cellspacing="0" border="0" unselectable="on"><tr unselectable="on">'}function RTE_DD_GenerateMenuCloseHtml(){a:;return"</tr></table>"}function RTE_DD_GenerateMenuItemHtml(i,h,a,d,f,b,c,e,g){return RTE_DD_GenerateMenuItemScriptHtml(i,h,"return RTE_DD_ExecuteCommand('"+a+"', '"+STSScriptEncode(d)+"')",f,b,c,e,g)}function RTE_DD_GenerateMenuItemScriptHtml(d,b,j,i,h,e,f,g){var a="";if((1>=d||1<d&&0==b%d)&&0!=b)a='</tr><tr unselectable="on">';var c;if(g=="1037"||g=="1025")c="rtl";else c="ltr";a+='<td dir="'+c+'" class="'+g_strRTEToolbarClassName+" "+g_strRTEUnselectedClassName+'" nowrap id="'+g_strRTEMenuItemBaseName+String(b)+'" '+g_strRTEMenuItemAttributeName+'="'+String(b)+'" onfocus="if (document.readyState == \'complete\') {RTE_DD_Item_OnFocus(this)}" onclick="'+j+'" unselectable="on" onmouseover="if (document.readyState == \'complete\') {RTE_DDItem_OnMouseOver(this);';if(null!=e)a+=e;a+="}\" onmouseout=\"if (document.readyState == 'complete') {RTE_DDItem_OnMouseOut(this);";if(null!=f)a+=f;a+='}"><a tabindex="-1" href="#" class="'+g_strRTEUnselectedClassName+'" style="text-decoration: none; color: black; cursor: pointer;" title="'+h+'" unselectable="on" onblur="if (document.readyState == \'complete\') {RTE_DD_Item_OnBlur()}" onfocus="if (document.readyState == \'complete\') {RTE_DD_Item_OnFocus(this.parentNode)}">'+i+"</a></td>";return a}function RTE_DD_GetMenuItem(b){a:;var a=RTE_DD_GetMenuFrame().document.getElementById(g_strRTEMenuItemBaseName+String(b));return a}function RTE_DD_GetHighlightedMenuItem(){a:;return RTE_DD_GetMenuFrame().g_elemRTEHighlightedMenuItem}function RTE_DD_SetHighlightedMenuItem(b){a:;var a=RTE_DD_GetMenuFrame();if(a!=null)a.g_elemRTEHighlightedMenuItem=b;else g_elemRTEHighlightedMenuItem=b}function RTE_DD_ClearHighlightOnMenuItem(a){a:;a.className=RTE_RemoveClassFromClassList(a.className,g_strRTEHoverClassName)}function RTE_DD_HighlightOnMenuItem(a){a:;a.className=RTE_AddClassToClassList(a.className,g_strRTEHoverClassName)}function RTE_DD_ClearHighlightedMenuItem(){a:;RTE_DD_ClearHighlightOnMenuItem(RTE_DD_GetHighlightedMenuItem())}function RTE_DD_SetHighlightOnMenuItem(a){a:;if(!RTE_DD_MenuIsOpen())return;var c=a.getAttribute(g_strRTEMenuItemAttributeName),b=RTE_DD_GetHighlightedMenuItem();if(null!=b){RTE_DD_ClearHighlightOnMenuItem(b);g_iRTEHighlightedMenuItem=-1}RTE_DD_HighlightOnMenuItem(a);RTE_DD_SetHighlightedMenuItem(a);g_iRTEHighlightedMenuItem=parseInt(c)}function RTE_DD_SetHighlightOnPrevMenuItem(e){a:;var a=RTE_DD_GetHighlightedMenuItem();if(a==null)a=RTE_DD_GetMenuItem(0);var d=a.getAttribute(g_strRTEMenuItemAttributeName),c=parseInt(d);if(c>0){var f=Math.max(c-e,0),b=RTE_DD_GetMenuItem(f);typeof a.onmouseout!="undefined"&&a.onmouseout();RTE_DD_SetHighlightOnMenuItem(b);typeof b.onmouseover!="undefined"&&b.onmouseover()}}function RTE_DD_SetHighlightOnNextMenuItem(e){a:;var a=RTE_DD_GetHighlightedMenuItem();if(a==null)a=RTE_DD_GetMenuItem(0);var d=a.getAttribute(g_strRTEMenuItemAttributeName),c=parseInt(d);if(c<g_iRTEMenuItemMax){var f=Math.min(c+e,g_iRTEMenuItemMax),b=RTE_DD_GetMenuItem(f);typeof a.onmouseout!="undefined"&&a.onmouseout();RTE_DD_SetHighlightOnMenuItem(b);typeof b.onmouseover!="undefined"&&b.onmouseover()}}function RTE_DD_ExecuteCommand(b,c){a:;var a=RTE_DD_GetMenuBaseElementID();RTE_DD_CloseMenu();RTE_GiveEditorFocus(a);RTE_RestoreSelection(a);RTE_ExecuteCommandOnSelection(RTE_DD_GetMenuBaseElementID(),b,false,c)}function RTE_DD_StartAction(b,c){a:;var a=RTE_DD_GetMenuBaseElementID();RTE_DD_CloseMenu();RTE_GiveEditorFocus(a);RTE_RestoreSelection(a);RTE_ExecuteFunctionOnSelection(RTE_DD_GetMenuBaseElementID(),b,c)}function RTE_DD_Item_OnFocus(a){a:;var b=RTE_DD_GetMenuElement();b.setAttribute(g_strRTEMenuOpeningAttributeName,"0");RTE_DD_SetHighlightOnMenuItem(a)}function RTE_DD_Item_OnBlur(){a:;g_iRTEHighlightedMenuItem=-1;window.setTimeout("RTE_OnItemBlurTestCloseMenu()",30)}function RTE_OnItemBlurTestCloseMenu(){a:;null==RTE_DD_GetHighlightedMenuItem()&&RTE_DD_CloseMenu()}function RTE_DD_OnKeyDown(i){var a=GetParentWindow2(i.ownerDocument).event,g=a.keyCode,h=a.altKey,f=a.ctrlKey,e=a.shiftKey,b=false;if(!f&&!h&&!e)switch(g){case 27:var d=g_strRTEDDBaseElementID;RTE_DD_CloseMenu();RTE_GiveEditorFocus(d);RTE_StartResetToolBarTimer(d);break;case 38:a.returnValue=false;RTE_DD_SetHighlightOnPrevMenuItem(1);break;case 9:a.returnValue=false;break;case 13:var c=RTE_DD_GetHighlightedMenuItem();if(c!=null)typeof c.onclick!="undefined"&&c.onclick();a.returnValue=false;break;case 40:a.returnValue=false;RTE_DD_SetHighlightOnNextMenuItem(1);break;case 33:a.returnValue=false;RTE_DD_SetHighlightOnPrevMenuItem(12);break;case 34:a.returnValue=false;RTE_DD_SetHighlightOnNextMenuItem(12);break;case 36:a.returnValue=false;break;case 35:a.returnValue=false;break;default:b=true}else if(!f&&!h&&e)switch(g){case 9:a.returnValue=false;break;default:b=true}else b=true;if(b)browseris.ie55up&&document.fireEvent("onkeydown",document.createEventObject(a))}function RTE_DDItem_OnMouseOver(a){a:;null!=a&&RTE_DD_SetHighlightOnMenuItem(a)}function RTE_DDItem_OnMouseOut(a){a:;null!=a&&RTE_DD_ClearHighlightOnMenuItem(a)}var g_rgstrRTEMenuHtml,g_strRTEColorMatrixMenuItemPrefixHtml,g_strRTEColorMatrixMenuItemSufffixHtml;function RTE_DD_OpenFontNameOrSizeSelector(c,i,h){a:;RTE_RestoreSelection(c);var b=RTE_GetSelection(c);if(b==null)return;var f=b.queryCommandValue(g_strRTEFontNameMnemonic);if(null==f)f="";var n=b.queryCommandValue(g_strRTEFontSizeMnemonic),m=b.queryCommandValue(g_strRTEBoldMnemonic),l=b.queryCommandValue(g_strRTEItalicMnemonic),a="",k=-1,g="",j=RTE_DD_GetFontNameOrSizeSelectorUnformattedHtml(c,h,i);a=j[0];k=j[1];if(h){a=a.replace(new RegExp(g_strRTEFontSizeToken,"g"),String(2));g=g_strRTEFontNameMnemonic}else{a=a.replace(new RegExp(g_strRTEFontNameToken,"g"),STSHtmlEncode(f));g=g_strRTEFontSizeMnemonic}var d="",e="";if(m){d="<b unselectable='on'>";e="</b>"}if(l){d+="<i unselectable='on'>";e+="</i>"}a=a.replace(new RegExp(g_strRTEBegBoldItalicToken,"g"),d);a=a.replace(new RegExp(g_strRTEEndBoldItalicToken,"g"),e);RTE_DD_OpenMenu(c,g,a,i,k)}function RTE_DD_GetFontNameOrSizeSelectorUnformattedHtml(j,i,h){a:;var a;if(i)a=g_strRTEFontNameMnemonic;else a=g_strRTEFontSizeMnemonic;var b=null,d=RTE_GetEditorInstanceVariables(j);if(d!=null&&d.renderFontNamesAsText!=null&&d.renderFontNamesAsText)b=g_rgstrRTEMenuHtml[a+"_text"];else b=g_rgstrRTEMenuHtml[a];if(null!=b)return b;b=RTE_DD_GenerateMenuOpenHtml();var g=-1;if(i){var e=RTE_GetSortedFontNames();g=e.length;for(var c=0;c<g;c++)if(d!=null&&d.renderFontNamesAsText!=null&&d.renderFontNamesAsText)b+=RTE_DD_GenerateMenuItemScriptHtml(1,c,"return RTE_ApplyFontFace('"+a+"', '"+e[c]+"')",g_strRTEBegBoldItalicToken+"<font face='' style='height:18px' unselectable='on'>"+STSHtmlEncode(e[c])+"</font>"+g_strRTEEndBoldItalicToken,e[c],"RTE_DD_FontNameOnMouseOver(this);","RTE_DD_FontNameOnMouseOut(this);",h);else b+=RTE_DD_GenerateMenuItemScriptHtml(1,c,"return RTE_ApplyFontFace('"+a+"', '"+e[c]+"')",g_strRTEBegBoldItalicToken+'<font size="'+g_strRTEFontSizeToken+'" face="'+e[c]+"\" unselectable='on'>"+e[c]+"</font>"+g_strRTEEndBoldItalicToken,e[c],null,null,h)}else{g=7;for(var f=1;f<=g;f++)b+=RTE_DD_GenerateMenuItemScriptHtml(1,f-1,"return RTE_ApplyFontSize('"+a+"', '"+String(f)+"')",g_strRTEBegBoldItalicToken+'<font size="'+String(f)+'" face="'+g_strRTEFontNameToken+"\" unselectable='on'>"+String(f)+" - "+Strings.STS.L_ExampleText_TEXT+"</font>"+g_strRTEEndBoldItalicToken,String(f),null,null,h)}b+=RTE_DD_GenerateMenuCloseHtml();if(d!=null&&d.renderFontNamesAsText!=null&&d.renderFontNamesAsText){g_rgstrRTEMenuHtml[a+"_text"]=[b,g];return g_rgstrRTEMenuHtml[a+"_text"]}else{g_rgstrRTEMenuHtml[a]=[b,g];return g_rgstrRTEMenuHtml[a]}}function RTE_ApplyFontFace(f,g){a:;var a=RTE_DD_GetMenuBaseElementID(),d=RTE_GetEditorInstanceVariables(a);if(d!=null){var b=d.overrides;if(typeof b.ApplyFontFace!="undefined"&&b.ApplyFontFace!=null)return b.ApplyFontFace(a)}for(var e=RTE_GetContainedElements(a),c=0;c<e.length;c++)RTE_RemoveFontFamilyStyle(e[c]);return RTE_DD_ExecuteCommand(f,g)}function RTE_RemoveFontFamilyStyle(a){if(a!=null){a.style!=null&&null!=a.style.fontFamily&&typeof a.style.removeAttribute!="undefined"&&a.style.removeAttribute("fontFamily");for(var b=0;b<a.childNodes.length;b++)RTE_RemoveFontFamilyStyle(a.childNodes(b))}}function RTE_ApplyFontSize(f,g){var a=RTE_DD_GetMenuBaseElementID(),d=RTE_GetEditorInstanceVariables(a);if(d!=null){var b=d.overrides;if(typeof b.ApplyFontSize!="undefined"&&b.ApplyFontSize!=null)return b.ApplyFontSize(a)}for(var e=RTE_GetContainedElements(a),c=0;c<e.length;c++)RTE_RemoveFontSizeStyle(e[c]);return RTE_DD_ExecuteCommand(f,g)}function RTE_RemoveFontSizeStyle(a){if(a!=null){a.style!=null&&null!=a.style.fontSize&&a.style.removeAttribute("fontSize");for(var b=0;b<a.childNodes.length;b++)RTE_RemoveFontSizeStyle(a.childNodes[b])}}function RTE_DD_FontNameOnMouseOver(c){for(var b=0;b<c.childNodes.length;b++){var a=c.childNodes[b];if(a.tagName.toUpperCase()=="FONT")a.face=a.innerText}}function RTE_DD_FontNameOnMouseOut(c){for(var a=0;a<c.childNodes.length;a++){var b=c.childNodes[a];if(b.tagName.toUpperCase()=="FONT")b.face=null}}function RTE_DD_OpenForeColorSelector(c,a){var b=RTE_GetRTEColorMatrix();RTE_DD_OpenMenu(c,g_strRTEForeColorMnemonic,RTE_DD_GetColorSelectorHtml(g_strRTEForeColorMnemonic,a),a,b.length)}function RTE_DD_OpenBackColorSelector(c,a){a:;var b=RTE_GetRTEColorMatrix();RTE_DD_OpenMenu(c,g_strRTEBackColorMnemonic,RTE_DD_GetColorSelectorHtml(g_strRTEBackColorMnemonic,a),a,b.length)}function RTE_DD_GetColorSelectorHtml(d,e){var a=g_rgstrRTEMenuHtml[d];if(null==a){a=RTE_DD_GenerateMenuOpenHtml();for(var c=RTE_GetRTEColorMatrix(),b=0;b<c.length;b++)a+=RTE_DD_GenerateMenuItemHtml(g_cRTEColorMatrixColumns,b,d,c[b][1],g_strRTEColorMatrixMenuItemPrefixHtml+c[b][1]+g_strRTEColorMatrixMenuItemSufffixHtml.replace("%TOOLTIP%",c[b][0]),"",null,null,e);a+=RTE_DD_GenerateMenuCloseHtml();g_rgstrRTEMenuHtml[d]=a}return a}var g_cRTEColorMatrixColumns;function RTE_GetRTEColorMatrix(){a:;var a=[[Strings.STS.L_Black_TEXT,"#000000"],[Strings.STS.L_Brown_TEXT,"#993300"],[Strings.STS.L_OliveGreen_TEXT,"#333300"],[Strings.STS.L_DarkGreenLong_TEXT,"#003300"],[Strings.STS.L_DarkTeal_TEXT,"#003366"],[Strings.STS.L_DarkBlueLong_TEXT,"#000080"],[Strings.STS.L_Indigo_TEXT,"#333399"],[Strings.STS.L_Gray80_TEXT,"#333333"],[Strings.STS.L_DarkRedLong_TEXT,"#800000"],[Strings.STS.L_Orange_TEXT,"#ff6600"],[Strings.STS.L_DarkYellow_TEXT,"#808000"],[Strings.STS.L_Green_TEXT,"#008000"],[Strings.STS.L_Teal_TEXT,"#008080"],[Strings.STS.L_Blue_TEXT,"#0000FF"],[Strings.STS.L_BlueGray_TEXT,"#666699"],[Strings.STS.L_Gray50_TEXT,"#808080"],[Strings.STS.L_Red_TEXT,"#FF0000"],[Strings.STS.L_LightOrange_TEXT,"#ff9900"],[Strings.STS.L_Lime_TEXT,"#99cc00"],[Strings.STS.L_SeaGreenLong_TEXT,"#339966"],[Strings.STS.L_Aqua_TEXT,"#33cccc"],[Strings.STS.L_LightBlueLong_TEXT,"#3366ff"],[Strings.STS.L_Violet_TEXT,"#800080"],[Strings.STS.L_Gray40_TEXT,"#969696"],[Strings.STS.L_Pink_TEXT,"#FF00FF"],[Strings.STS.L_Gold_TEXT,"#ffcc00"],[Strings.STS.L_Yellow_TEXT,"#FFFF00"],[Strings.STS.L_BrightGreen_TEXT,"#00FF00"],[Strings.STS.L_Turquoise_TEXT,"#00FFFF"],[Strings.STS.L_SkyBlueLong_TEXT,"#00ccff"],[Strings.STS.L_Plum_TEXT,"#993366"],[Strings.STS.L_Gray25_TEXT,"#C0C0C0"],[Strings.STS.L_Rose_TEXT,"#ff99cc"],[Strings.STS.L_Tan_TEXT,"#ffcc99"],[Strings.STS.L_LightYellowLong_TEXT,"#ffff99"],[Strings.STS.L_LightGreenLong_TEXT,"#ccffcc"],[Strings.STS.L_LightTurquoise_TEXT,"#ccffff"],[Strings.STS.L_PaleBlue_TEXT,"#99ccff"],[Strings.STS.L_Lavender_TEXT,"#cc99ff"],[Strings.STS.L_White_TEXT,"#FFFFFF"]];return a}function RTE_CaseInsensitiveCompare(c,d){var a=c.toUpperCase(),b=d.toUpperCase();return GreaterThan(a,b)?1:LessThan(a,b)?-1:0}function RTE_GetDialogHelper(){a:;return document.getElementById(g_strRTEDialogHelperID)}function RTE_GetSortedFontNames(){a:;var a=[],f=RTE_GetDialogHelper(),e=false;if(null!=f){var b=f.fonts;if(null!=b&&typeof b.count!="undefined"){var d=b.count;if(d>0){for(var c=1;c<d;c++)!RTE_StringIsNullOrEmpty(b(c))&&a.push(b(c));a.sort(RTE_CaseInsensitiveCompare);e=true}}}if(!e){RTE_InsertIntoSortedArrayIfValid(Strings.STS.L_Font1_TEXT,a);RTE_InsertIntoSortedArrayIfValid(Strings.STS.L_Font2_TEXT,a);RTE_InsertIntoSortedArrayIfValid(Strings.STS.L_Font3_TEXT,a);RTE_InsertIntoSortedArrayIfValid(Strings.STS.L_Font4_TEXT,a);RTE_InsertIntoSortedArrayIfValid(Strings.STS.L_Font5_TEXT,a);RTE_InsertIntoSortedArrayIfValid(Strings.STS.L_Font6_TEXT,a);RTE_InsertIntoSortedArrayIfValid(Strings.STS.L_Font7_TEXT,a);RTE_InsertIntoSortedArrayIfValid(Strings.STS.L_Font8_TEXT,a)}return a}function RTE_IsChildOfElement(c,e){var a=e.childNodes;if(null==a||0>=a.length)return false;for(var b=0,b=0;b<a.length;b++){var d=a[b];if(d==c)return true;if(RTE_IsChildOfElement(c,d))return true}return false}function RTE_FindParentElementWithTag(a,b){return null==a.parentNode?null:RTE_FindParentElementOrSelfWithTag(a.parentNode,b)}function RTE_FindParentElementOrSelfWithTag(a,b){return a.tagName==b?a:null==a.parentNode?null:RTE_FindParentElementOrSelfWithTag(a.parentNode,b)}var g_iRTELeft,g_iRTETop,g_iRTEWidth,g_iRTEHeight,g_iRTERight,g_iRTEBottom;function RTE_GetElementWindowCoordinates(a){a:;var c=0,d=0,f=a.offsetWidth,e=a.offsetHeight;do{if(a.currentStyle.position!="relative"){c+=a.offsetLeft;d+=a.offsetTop}if(null==a.offsetParent){var g=parseInt(a.currentStyle.marginLeft),h=parseInt(a.currentStyle.marginTop);if(!isNaN(g))c+=g;if(!isNaN(h))d+=h}a=a.offsetParent}while(a!=null);var b=[];b[g_iRTELeft]=c;b[g_iRTETop]=d;b[g_iRTEWidth]=f;b[g_iRTEHeight]=e;b[g_iRTERight]=c+f-1;b[g_iRTEBottom]=d+e-1;return b}function RTE_GetServerRelativeUnlocalizedImageUrl(a){return"/_layouts/15/images/"+a}function RTE_GetServerRelativeImageUrl(a){return"/_layouts/"+Strings.STS.L_Language_Text+"/images/"+a}function RTE_GetServerRelativeStylesheetUrl(a,b){return"/_layouts/15/"+b+"/styles/"+a}function RTE_GetServerRelativeScriptUrl(a,b){return RTE_StringIsNullOrEmpty(b)?"/_layouts/15/"+a:"/_layouts/15/"+b+"/"+a}function RTE_StripDoubleSpaces(a){while(a.indexOf("  ")!=-1)a=a.replace(/  /g," ");return a}function RTE_AddClassToClassList(a,b){return 0<=a.indexOf(b)?a:RTE_StripDoubleSpaces(a+" "+b)}function RTE_ReplaceClassInClassList(a,d,c){var b=a.indexOf(d),e="";return 0<b?RTE_StripDoubleSpaces(a.substr(0,b)+" "+c+" "+a.substr(b+d.length)):RTE_AddClassToClassList(a,c)}function RTE_RemoveClassFromClassList(a,b){return RTE_ReplaceClassInClassList(a,b,"")}function RTE_AddOrRemoveClassFromClassList(c,a,b){return c?RTE_AddClassToClassList(a,b):RTE_RemoveClassFromClassList(a,b)}function RTE_StringIsNullOrEmpty(a){return a==null||a.length==0}function RTE_InsertIntoSortedArrayIfValid(c,b){if(RTE_StringIsNullOrEmpty(c))return;for(var a=0,a=b.length;a>=0;a--){var d=b[a-1];if(0==a||LessThan(d,c)){b[a]=c;return}else b[a]=d}}function RTE_GenerateStylesToolBarButtonHtml(b,c){var a="";a+=RTE_TB_GenerateOpenCellButtonHtml(b,g_strRTEStylesMnemonic);a+='<a tabindex="-1" href="#" onfocus="RTE_TB_OnFocus(\''+b+"', this);\" onblur=\"RTE_TB_OnBlur('"+b+"', this);\" onclick=\"RTE_DD_OpenStylesSelector('"+b+"' ,'"+c+'\', true); return false;" title="'+Strings.STS.L_StylesToolTip_TEXT+'"';a+=' style="margin-left: 2px; margin-right: 2px;" unselectable="on">'+Strings.STS.L_StylesLabel_TEXT+'&nbsp;<img alt="'+Strings.STS.L_StylesToolTip_TEXT+'" src="'+RTE_GetServerRelativeUnlocalizedImageUrl("menudark.gif")+'" border="0" width="13" height="13" unselectable="on">';a+="</a>";a+=RTE_TB_GenerateCloseCellButtonHtml();return a}function RTE_DD_OpenStylesSelector(b,c){var e=g_strRTEStylesMnemonic,a=RTE_DD_GetStylesSelectorUnformattedHtml(c),d=a[0],f=a[1];RTE_DD_OpenMenu(b,e,d,f)}function RTE_DD_GetStylesSelectorUnformattedHtml(f){var a=g_rgstrRTEMenuHtml[g_strRTEStylesMnemonic];if(null!=a)return a;var e=g_strRTEFormatBlockMnemonic;a=RTE_DD_GenerateMenuOpenHtml();for(var c=RTE_GetBlockFormatNames(),d=c.length,b=0;b<d;b++)a+=RTE_DD_GenerateMenuItemHtml(1,b,e,c[b],c[b],"",null,null,f);a+=RTE_DD_GenerateMenuCloseHtml();g_rgstrRTEMenuHtml[g_strRTEStylesMnemonic]=[a,d];return g_rgstrRTEMenuHtml[g_strRTEStylesMnemonic]}function RTE_GetBlockFormatNames(){a:;var c=[],e=RTE_GetDialogHelper();if(null!=e){var a=e.blockFormats;if(null!=a&&typeof a.count!="undefined"){var d=a.count;if(0!=d)for(var b=1;b<d;b++)RTE_InsertIntoSortedArrayIfValid(a(b),c)}}return c}function RTE_GenerateInsertRowToolBarButtonHtml(b,d){a:;var c=RTE_GetEditorInstanceVariables(b);c.functions[g_strRTEInsertRowAbove]=RTE_InsertRowAbove;c.functions[g_strRTEInsertRowBelow]=RTE_InsertRowBelow;var a="";a+=RTE_TB_GenerateOpenCellButtonHtml(b,g_strRTEInsertRowMnemonic,"RTE_DD_OpenInsertRowSelector('"+b+"' ,'"+d+"')");a+=Strings.STS.L_InsertRowLabel_TEXT;a+="<div class='clip16x16'><img class='ms-rteirow' src=\""+RTE_GetServerRelativeImageUrl("rtecluster.png")+'" alt="'+Strings.STS.L_InsertRowToolTip_TEXT+'" border="0" unselectable="on"></div>';a+='<img alt="'+Strings.STS.L_InsertRowToolTip_TEXT+'" src="'+RTE_GetServerRelativeUnlocalizedImageUrl("menudark.gif")+'" border="0" width="13" height="13" unselectable="on">';a+=RTE_TB_GenerateCloseCellButtonHtml();return a}function RTE_DD_OpenInsertRowSelector(a,c){a:;var e=g_strRTEInsertRowMnemonic,b=RTE_DD_GetInsertRowSelectorUnformattedHtml(a,c),d=b[0],f=b[1];RTE_DD_OpenMenu(a,e,d,f)}function RTE_DD_GetInsertRowSelectorUnformattedHtml(e,f){a:;var d=g_strRTEInsertRowMnemonic,b=g_rgstrRTEMenuHtml[d];if(null!=b)return b;b=RTE_DD_GenerateMenuOpenHtml();var a=[];a.push(Strings.STS.L_InsertRowAboveLabel_TEXT);a.push(Strings.STS.L_InsertRowBelowLabel_TEXT);var g=a.length,c=0;b+=RTE_DD_GenerateMenuItemScriptHtml(1,c,"RTE_DD_StartAction('"+g_strRTEInsertRowAbove+"', '"+e+"')",a[c],a[c],null,null,f);c=1;b+=RTE_DD_GenerateMenuItemScriptHtml(1,c,"RTE_DD_StartAction('"+g_strRTEInsertRowBelow+"', '"+e+"')",a[c],a[c],null,null,f);b+=RTE_DD_GenerateMenuCloseHtml();g_rgstrRTEMenuHtml[d]=[b,g];return g_rgstrRTEMenuHtml[d]}function RTE_GenerateInsertColumnToolBarButtonHtml(b,d){a:;var c=RTE_GetEditorInstanceVariables(b);c.functions[g_strRTEInsertColumnLeft]=RTE_InsertColumnLeft;c.functions[g_strRTEInsertColumnRight]=RTE_InsertColumnRight;var a="";a+=RTE_TB_GenerateOpenCellButtonHtml(b,g_strRTEInsertColumnMnemonic,"RTE_DD_OpenInsertColumnSelector('"+b+"' ,'"+d+"')");a+=Strings.STS.L_InsertColumnLabel_TEXT;a+="<div class='clip16x16'><img class='ms-rteicol' src=\""+RTE_GetServerRelativeImageUrl("rtecluster.png")+'" alt="'+Strings.STS.L_InsertColumnToolTip_TEXT+'" border="0" unselectable="on"></div>';a+='<img alt="'+Strings.STS.L_InsertColumnToolTip_TEXT+'" src="'+RTE_GetServerRelativeUnlocalizedImageUrl("menudark.gif")+'" border="0" width="13" height="13" unselectable="on">';a+=RTE_TB_GenerateCloseCellButtonHtml();return a}function RTE_DD_OpenInsertColumnSelector(a,c){a:;var e=g_strRTEInsertColumnMnemonic,b=RTE_DD_GetInsertColumnSelectorUnformattedHtml(a,c),d=b[0],f=b[1];RTE_DD_OpenMenu(a,e,d,f)}function RTE_DD_GetInsertColumnSelectorUnformattedHtml(f,g){a:;var c=g_strRTEInsertColumnMnemonic,b=g_rgstrRTEMenuHtml[c];if(null!=b)return b;b=RTE_DD_GenerateMenuOpenHtml();var a=[];a.push(Strings.STS.L_InsertColumnLeftLabel_TEXT);a.push(Strings.STS.L_InsertColumnRightLabel_TEXT);var h=a.length,d=0;b+=RTE_DD_GenerateMenuItemScriptHtml(1,d,"RTE_DD_StartAction('"+g_strRTEInsertColumnLeft+"', '"+f+"')",a[d],a[d],null,null,g);var e=1;b+=RTE_DD_GenerateMenuItemScriptHtml(1,e,"RTE_DD_StartAction('"+g_strRTEInsertColumnRight+"', '"+f+"')",a[e],a[e],null,null,g);b+=RTE_DD_GenerateMenuCloseHtml();g_rgstrRTEMenuHtml[c]=[b,h];return g_rgstrRTEMenuHtml[c]}function RTE_GenerateInsertCellToolBarButtonHtml(b,d){a:;var c=RTE_GetEditorInstanceVariables(b);c.functions[g_strRTEInsertCellLeft]=RTE_InsertCellLeft;c.functions[g_strRTEInsertCellRight]=RTE_InsertCellRight;var a="";a+=RTE_TB_GenerateOpenCellButtonHtml(b,g_strRTEInsertCellMnemonic,"RTE_DD_OpenInsertCellSelector('"+b+"' ,'"+d+"')");a+=Strings.STS.L_InsertCellLabel_TEXT;a+="<div class='clip16x16'><img class='ms-rteicell' src=\""+RTE_GetServerRelativeImageUrl("rtecluster.png")+'" alt="'+Strings.STS.L_InsertCellToolTip_TEXT+'" border="0" unselectable="on"></div>';a+='<img alt="'+Strings.STS.L_InsertCellToolTip_TEXT+'" src="'+RTE_GetServerRelativeUnlocalizedImageUrl("menudark.gif")+'" border="0" width="13" height="13" unselectable="on">';a+=RTE_TB_GenerateCloseCellButtonHtml();return a}function RTE_DD_OpenInsertCellSelector(a,c){a:;var e=g_strRTEInsertCellMnemonic,b=RTE_DD_GetInsertCellSelectorUnformattedHtml(a,c),d=b[0],f=b[1];RTE_DD_OpenMenu(a,e,d,f)}function RTE_DD_GetInsertCellSelectorUnformattedHtml(f,g){a:;var c=g_strRTEInsertCellMnemonic,b=g_rgstrRTEMenuHtml[c];if(null!=b)return b;b=RTE_DD_GenerateMenuOpenHtml();var a=[];a.push(Strings.STS.L_InsertCellLeftLabel_TEXT);a.push(Strings.STS.L_InsertCellRightLabel_TEXT);var h=a.length,d=0;b+=RTE_DD_GenerateMenuItemScriptHtml(1,d,"RTE_DD_StartAction('"+g_strRTEInsertCellLeft+"', '"+f+"')",a[d],a[d],null,null,g);var e=1;b+=RTE_DD_GenerateMenuItemScriptHtml(1,e,"RTE_DD_StartAction('"+g_strRTEInsertCellRight+"', '"+f+"')",a[e],a[e],null,null,g);b+=RTE_DD_GenerateMenuCloseHtml();g_rgstrRTEMenuHtml[c]=[b,h];return g_rgstrRTEMenuHtml[c]}function RTE_GetCurrentSelectionChain(c){var b=[],a=RTE_GetCurrentElement(c);while(a!=null){b[b.length]=a;if(a.id==c||a.tagName=="BODY")break;a=a.parentNode}return b}function RTE_IsElementInChain(a,b){if(a==null||a.length==0)return false;var d=a.length;if(b==null||b.length==0)return false;for(var c=0;c<d;c++)if(a[c].tagName==b)return true;return false}var g_aTableCellTagNames;function RTE_IsAnyElementInChain(b,a){if(b==null||b.length==0)return false;var g=b.length;if(a==null||a.length==0)return false;for(var e=a.length,c=0;c<g;c++)for(var f=b[c].tagName,d=0;d<e;d++)if(f==a[d])return true;return false}function RTE_GetCurrentSelection(b){var a=RTE_GetEditorDocument(b);return a!=null?a.selection:null}function RTE_GetCurrentSelectionType(b){var a=RTE_GetCurrentSelection(b);return a!=null?a.type:null}function RTE_GetCurrentSelectionRange(b){var a=RTE_GetCurrentSelection(b);return a!=null?a.createRange():null}function RTE_GetCurrentElement(d){var c=RTE_GetCurrentSelection(d);if(c==null)return null;var a=c.createRange();if(a==null)return null;var f=c.type;if(f.toLowerCase()=="control")return a.length!=1?null:a.item(0);else{var b=a.parentElement();if(b!=null){var e=RTE_GetEditorDocument(d).body;if(e.contains(b))return b}}return null}function RTE_IsElementSelected(b,c){a:;var a=RTE_GetCurrentElement(b);if(a!=null)if(a.tagName==c)return true;return false}function RTE_GetNearestContainingParentElementOfType(a,c,b){return RTE_GetNearestContainingParentElementOfTypes(a,c,[b])}function RTE_GetNearestContainingParentElementOfTypes(g,b,c){var f=c.length;if(b==null)return null;for(var d=0;d<f;d++)if(b.tagName==c[d])return b;var a=b.parentNode;while(a!=null){if(a.id==g)return null;for(var e=0;e<f;e++)if(a.tagName==c[e])return a;a=a.parentNode}return null}function RTE_GetNearestContainingElementOfType(a,b){a:;var c=RTE_GetCurrentElement(a);return RTE_GetNearestContainingParentElementOfType(a,c,b)}function RTE_GetNearestContainingElementOfTypes(a,b){a:;var c=RTE_GetCurrentElement(a);return RTE_GetNearestContainingParentElementOfTypes(a,c,b)}function RTE_GetContainedElements(c){a:;var a=[],l=RTE_GetCurrentSelection(c);if(l!=null&&l.type.toLowerCase()=="control"){for(var k=RTE_GetCurrentElement(c),j=k.all,h=0;h<j.length;h++)a[a.length]=j(h);a[a.length]=k}else{var d=RTE_GetCurrentSelectionRange(c);if(d!=null){var e=RTE_GetOutermostSelectionElement(c);if(e!=null){var b=e.all;if(d.text==e.outerText){for(var g=0;g<b.length;g++)a[a.length]=b(g);a[a.length]=e}else for(var i=d.duplicate(),f=0;f<b.length;f++){i.moveToElementText(b(f));if(d.inRange(i))a[a.length]=b(f)}}}}return a}function RTE_GetOutermostSelectionElement(c){a:;var a=null,f=RTE_GetCurrentSelection(c);if(f!=null&&f.type.toLowerCase()=="control"){a=RTE_GetCurrentElement(c);var e=a.all;e[e.length]=a}else{var d=RTE_GetCurrentSelectionRange(c);if(d!=null){a=RTE_GetInnerMostContainingElement(d);if(a!=null){var b=null;while(a!=null&&a.tagName!="BODY"&&d.text==a.outerText){b=a;a=a.parentNode}if(b!=null)a=b}}}return a}function RTE_GetInnerMostContainingElement(d){a:;var c=RTE_GetContainingParent(d);if(c!=null){var g=d.duplicate(),f=false;while(!f){for(var e=false,b=c.childNodes,a=0;a<b.length;a++)if(b[a].nodeType!=3){g.moveToElementText(b[a]);if(g.inRange(d)){e=true;c=b[a];break}}if(!e)f=true}}return c}function RTE_GetContainingParent(c){a:;var a=c.parentElement();if(a!=null){var b=c.duplicate();b.moveToElementText(a);while(a!=null&&a.tagName!="BODY"&&!b.inRange(c)){a=a.parentNode;b.moveToElementText(a)}}return a}function RTE_GetSelectedCells(f){a:;var a=[];if(RTE_IsElementSelected(f,"TR")){var c=RTE_GetCurrentElement(f);if(c!=null)for(var d=RTE_GetCurrentSelectionRange(f),b=d.duplicate(),e=0;e<c.cells.length;e++){b.moveToElementText(c.cells(e));if(d.inRange(b))a[a.length]=c.cells(e);else if(d.compareEndPoints("StartToStart",b)==1&&d.compareEndPoints("StartToEnd",b)==-1)a[a.length]=c.cells(e);else if(d.compareEndPoints("EndToStart",b)==1&&d.compareEndPoints("EndToEnd",b)==-1)a[a.length]=c.cells(e)}}return a}function RTE_InsertCellLeft(a){a:;var c=RTE_GetEditorInstanceVariables(a);if(c!=null){var b=c.overrides;if(typeof b.InsertCellLeft!="undefined"&&b.InsertCellLeft!=null){b.InsertCellLeft(a);return}}if(RTE_GetDirectionOfSelection(a)=="rtl")RTE_InsertCellBase(a,"afterEnd");else RTE_InsertCellBase(a,"beforeBegin")}function RTE_InsertCellRight(a){a:;var c=RTE_GetEditorInstanceVariables(a);if(c!=null){var b=c.overrides;if(typeof b.InsertCellRight!="undefined"&&b.InsertCellRight!=null){b.InsertCellRight(a);return}}if(RTE_GetDirectionOfSelection(a)=="rtl")RTE_InsertCellBase(a,"beforeBegin");else RTE_InsertCellBase(a,"afterEnd")}function RTE_InsertCellBase(c,g){a:;var a=RTE_GetNearestContainingElementOfTypes(c,g_aTableCellTagNames);if(a==null)return;var d=RTE_GetEditorDocument(c);if(d==null)return;var b=d.createElement(a.tagName);if(b==null)return;b.mergeAttributes(a,true);b.runtimeStyle.cssText=a.runtimeStyle.cssText;insertAdjacentElement(a,g,b);var f=d.body.createTextRange();f.moveToElementText(b);f.select();var e=RTE_GetNearestContainingParentElementOfType(c,a,"TABLE");null!=e&&RTE_ReapplyTableStyles(e)}function RTE_InsertRowAbove(a){a:;var c=RTE_GetEditorInstanceVariables(a);if(c!=null){var b=c.overrides;if(typeof b.InsertRowAbove!="undefined"&&b.InsertRowAbove!=null){b.InsertRowAbove(a);return}}RTE_InsertRowBase(a,"beforeBegin")}function RTE_InsertRowBelow(a){a:;var c=RTE_GetEditorInstanceVariables(a);if(c!=null){var b=c.overrides;if(typeof b.InsertRowBelow!="undefined"&&b.InsertRowBelow!=null){b.InsertRowBelow(a);return}}RTE_InsertRowBase(a,"afterEnd")}function RTE_InsertRowBase(c,j){a:;var b=RTE_GetNearestContainingElementOfType(c,"TR");if(b==null)return;var e=RTE_GetEditorDocument(c);if(e==null)return;var a=e.createElement("TR");if(a==null)return;a.mergeAttributes(b,true);a.runtimeStyle.cssText=b.runtimeStyle.cssText;insertAdjacentElement(b,j,a);for(var g=b.cells,d=0;d<g.length;d++){var i=a.insertCell(-1);i.mergeAttributes(g(d),true);i.runtimeStyle.cssText=g(d).runtimeStyle.cssText}var f=e.body.createTextRange(),k=RTE_GetDirectionOfSelection(c);if(k=="ltr")f.moveToElementText(a.cells(0));else f.moveToElementText(a.cells(a.cells.length-1));f.select();var h=RTE_GetNearestContainingParentElementOfType(c,b,"TABLE");null!=h&&RTE_ReapplyTableStyles(h)}function RTE_InsertColumnLeft(a){a:;var c=RTE_GetEditorInstanceVariables(a);if(c!=null){var b=c.overrides;if(typeof b.InsertColumnLeft!="undefined"&&b.InsertColumnLeft!=null)return b.InsertColumnLeft(a)}return RTE_GetDirectionOfSelection(a)=="rtl"?RTE_InsertColumnBase(a,"afterEnd"):RTE_InsertColumnBase(a,"beforeBegin")}function RTE_InsertColumnRight(a){a:;var c=RTE_GetEditorInstanceVariables(a);if(c!=null){var b=c.overrides;if(typeof b.InsertColumnRight!="undefined"&&b.InsertColumnRight!=null)return b.InsertColumnRight(a)}return RTE_GetDirectionOfSelection(a)=="rtl"?RTE_InsertColumnBase(a,"beforeBegin"):RTE_InsertColumnBase(a,"afterEnd")}function RTE_InsertColumnBase(k,m){a:;var j=RTE_GetNearestContainingElementOfTypes(k,g_aTableCellTagNames);if(j==null)return;var o=RTE_GetNearestContainingParentElementOfType(k,j,"TABLE");if(o==null)return;var g=RTE_GetEditorDocument(k);if(g==null)return;var f=0,l=0,y=-1,t=RTE_GetNearestContainingParentElementOfType(k,j,"TR");if(t!=null)for(var n=t.cells,x=n.length,h=0;h<x;h++){l=n[h].colSpan;if(n[h]==j){y=h;break}f+=l}for(var s=o.rows,w=s.length,i=0;i<w;i++){var v=s[i];if(v!=null)for(var e=0,d=0,u=v.cells,z=u.length,r=0;r<z;r++){var a=u[r];d=a.colSpan;if(m=="beforeBegin"){if(e==f){var b=g.createElement(a.tagName);if(b!=null){b.mergeAttributes(a,true);b.runtimeStyle.cssText=a.runtimeStyle.cssText;b.colSpan=1;insertAdjacentElement(a,m,b);if(i==0){var p=g.body.createTextRange();if(p!=null){p.moveToElementText(b);p.select()}}}break}else if(e+d>f){a.colSpan++;break}}else if(m=="afterEnd")if(e+d==f+l){var c=g.createElement(a.tagName);if(c!=null){c.mergeAttributes(a,true);c.runtimeStyle.cssText=a.runtimeStyle.cssText;c.colSpan=1;insertAdjacentElement(a,m,c);if(i==0){var q=g.body.createTextRange();if(q!=null){q.moveToElementText(c);q.select()}}}break}else if(e+d>f+l){a.colSpan++;break}e+=d}}RTE_ReapplyTableStyles(o)}function RTE_DeleteColumn(h){var g=RTE_GetNearestContainingElementOfTypes(h,g_aTableCellTagNames);if(g==null)return;var e=RTE_GetNearestContainingParentElementOfType(h,g,"TABLE");if(e==null)return;var N=g.cellIndex,b=0,d=0,H=-1,z=RTE_GetNearestContainingParentElementOfType(h,g,"TR");if(z!=null)for(var n=z.cells,F=n.length,j=0;j<F;j++){d=n[j].colSpan;if(n[j]==g){H=j;break}b+=d}for(var x=e.rows,E=x.length,t=0;t<E;t++){var D=x[t];if(D!=null)for(var a=0,c=0,i=[],A=D.cells,I=A.length,u=0;u<=I;u++){if(a>=b+d){for(var m=0;m<i.length;m++){var k=i[m][0],B=i[m][1];if(B==k.colSpan)k.parentNode().removeChild(k);else k.colSpan-=B}break}var C=A[u];c=C.colSpan;if(a+c<=b){a+=c;continue}else{var f=0;if(a>=b&&a+c<=b+d)f=c;else if(a<=b&&a+c>=b+d)f=d;else if(a<=b&&a+c<b+d)f=a+c-b;else if(a>b&&a+c>b+d)f=b+d-a;i[i.length]=[C,f]}a+=c}}for(var q=e.rows,L=q.length,s=L;s>0;s--){var r=q[s-1];r.cells.length==0&&r.parentNode().removeChild(r)}if(e.rows.length==0)e.parentNode.removeChild(e);else{for(var v=0,w=0,M=q[0],o=M.cells,l=0;l<o.length;l++){v=l;var G=o[l],y=G.colSpan;if(w+y>b)break;w+=y}var J=RTE_GetEditorDocument(h),p=J.body.createTextRange(),K=o[v];p.moveToElementText(K);p.select();p.collapse(true);RTE_ReapplyTableStyles(e)}RTE_StartResetToolBarTimer(h)}function RTE_DeleteRow(c){a:;var b=RTE_GetNearestContainingElementOfType(c,"TR");if(b!=null){var a=RTE_GetNearestContainingParentElementOfType(c,b,"TABLE"),d=b.rowIndex;b.parentNode.removeChild(b);if(null!=a)if(a.rows.length>0){if(d>=a.rows.length)d=a.rows.length-1;var i=a.rows[d],f=i.cells,g=RTE_GetEditorDocument(c),e=g.body.createTextRange();if(f.length>0){var h=f[0];e.moveToElementText(h);e.select();e.collapse(true)}RTE_ReapplyTableStyles(a)}else a.parentNode.removeChild(a)}RTE_StartResetToolBarTimer(c)}function RTE_SplitCell(d){a:;var a=RTE_GetNearestContainingElementOfTypes(d,g_aTableCellTagNames);if(a==null)return;var n=-1,l=0,c=RTE_GetNearestContainingParentElementOfType(d,a,"TR");if(c!=null)for(var e=0;e<c.cells.length;e++){l+=c.cells[e].colSpan;if(c.cells[e]==a){n=e;break}}var b=document.createElement(a.tagName);if(b!=null){b.mergeAttributes(a,true);b.runtimeStyle.cssText=a.runtimeStyle.cssText;if(a.colSpan>1){b.colSpan=a.colSpan/2;a.colSpan-=b.colSpan}else{b.colSpan=1;for(var k=RTE_GetNearestContainingParentElementOfType(d,c,"TABLE"),g=0;g<k.rows.length;g++){var i=0,f=k.rows[g];if(f!=null&&f!=c)for(var h=0;h<f.cells.length;h++){var m=f.cells[h];i+=m.colSpan;if(i>=l){m.colSpan++;break}}}}insertAdjacentElement(a,"afterEnd",b);var j=RTE_GetNearestContainingElementOfType(d,"TABLE");null!=j&&RTE_ReapplyTableStyles(j);RTE_StartResetToolBarTimer(d)}}function RTE_MergeCells(a){a:;if(RTE_IsElementSelected(a,"TR"))RTE_MergeSelected(a);else RTE_MergeWithDirection(a,"none");RTE_StartResetToolBarTimer(a)}function RTE_MergeSelected(c){a:;var d=RTE_GetCurrentElement(c);if(d.tagName!="TR")return;if(d!=null){var a=RTE_GetSelectedCells(c);if(a.length>1){for(var b=1;b<a.length;b++){if(a[b].innerText.length>0)a[0].innerHTML+=" ";a[0].innerHTML+=a[b].innerHTML;a[0].colSpan+=a[b].colSpan;d.removeChild(a[b])}var e=RTE_GetNearestContainingParentElementOfType(c,d,"TABLE");null!=e&&RTE_ReapplyTableStyles(e);if(RTE_GetCurrentElement(c)!=a[0]){var g=RTE_GetEditorDocument(c),f=g.body.createTextRange();f.moveToElementText(a[0]);f.select()}}}}function RTE_MergeWithRight(a){a:;RTE_MergeWithDirection(a,"right")}function RTE_MergeWithLeft(a){a:;RTE_MergeWithDirection(a,"left")}function RTE_MergeWithAbove(a){a:;RTE_MergeWithDirection(a,"above")}function RTE_MergeWithBelow(a){a:;RTE_MergeWithDirection(a,"below")}function RTE_MergeWithDirection(b,f){a:;RTE_MergeSelected(b);var q=RTE_GetCurrentElement(b);if(q==null)return;var c=RTE_GetNearestContainingParentElementOfTypes(b,q,g_aTableCellTagNames);if(c==null)return;var a=RTE_GetNearestContainingParentElementOfType(b,c,"TR");if(a==null)return;var d=RTE_GetNearestContainingParentElementOfType(b,a,"TABLE");if(RTE_GetDirectionOfSelection(b)=="rtl")if(f=="right")f="left";else if(f=="left")f="right";switch(f){case"right":var g=c.cellIndex,m=a.cells;if(g+1>=m.length)return;if(m[g+1].rowSpan==m[g].rowSpan)RTE_MergeHorizontal(b,a,g);else alert(Strings.STS.L_InvalidMerge_TEXT);break;case"left":var e=c.cellIndex-1,t=a.cells;if(e<0)return;if(t[e+1].rowSpan==t[e].rowSpan){RTE_MergeHorizontal(b,a,e);RTE_PutSelectionInCell(b,a.cells[e])}else alert(Strings.STS.L_InvalidMerge_TEXT);break;case"above":if(d==null)return;if(a.rowIndex==0)return;var v=a,y=v.cells,r=c,w=RTE_GenerateSpanGridUpToTarget(d,c),o=w.targetCellColSpanIndex,p=w.columns[o].cells[a.rowIndex-1],l=p.cell;if(r.colSpan==l.colSpan&&p.colSpanIndex==o){RTE_MergeVertical(b,v,r,l);RTE_PutSelectionInCell(b,l)}else alert(Strings.STS.L_InvalidMerge_TEXT);break;case"below":if(d==null)return;var h=c,u=RTE_GenerateSpanGridUpToTarget(d,h),n=u.targetCellColSpanIndex,i=u.columns[n].cells[a.rowIndex+h.rowSpan];if(i==null)return;var k=i.cell,s=RTE_GetNearestContainingParentElementOfType(b,k,"TR");if(s==null)return;if(k.colSpan==h.colSpan&&i.colSpanIndex==n)RTE_MergeVertical(b,s,k,h);else alert(Strings.STS.L_InvalidMerge_TEXT);break;case"none":if(a.cells[c.cellIndex]!=null&&a.cells[c.cellIndex+1]!=null){var x=RTE_GetDirectionOfSelectionParent(c);if(x!="rtl"&&c.cellIndex==a.cells.length-1||x=="rtl"&&c.cellIndex!=0){var j=c.cellIndex-1;if(j<0)return;RTE_MergeHorizontal(b,a,j);RTE_PutSelectionInCell(b,a.cells[j])}else{if(c.cellIndex+1>=a.length)return;RTE_MergeHorizontal(b,a,c.cellIndex)}}}null!=d&&RTE_ReapplyTableStyles(d);RTE_StartResetToolBarTimer(b)}function RTE_MergeHorizontal(d,c,a){var b=c.cells;if(b[a].innerText.length>0)b[a].innerHTML+=" ";b[a].innerHTML+=b[a+1].innerHTML;b[a].colSpan+=b[a+1].colSpan;c.removeChild(b[a+1])}function RTE_MergeVertical(d,c,b,a){if(a.innerText.length>0)a.innerHTML+=" ";a.innerHTML+=b.innerHTML;a.rowSpan+=b.rowSpan;c.removeChild(b)}function RTE_PutSelectionInCell(a,c){if(RTE_GetCurrentElement(a)!=c){var d=RTE_GetEditorDocument(a),b=d.body.createTextRange();b.moveToElementText(c);b.select()}}function RTE_SpanGrid_InitializePrototype(){a:;RTE_SpanGrid.prototype={targetCellColSpanIndex:undefined,columns:undefined}}function RTE_SpanGrid(){}function RTE_GenerateSpanGridUpToTarget(i,g){var b=new RTE_SpanGrid;b.columns=[];b.targetCellColSpanIndex=-1;for(var c=0;c<i.rows.length;c++)for(var a=0,h=0;h<i.rows[c].cells.length;h++){while(b.columns[a]!=null&&b.columns[a].cells[c]!=null)a++;if(b.columns[a]==null){b.columns[a]={};b.columns[a].cells=[]}var e=i.rows[c].cells[h];if(e==g)b.targetCellColSpanIndex=a;b.columns[a].cells[c]={};b.columns[a].cells[c].cell=e;b.columns[a].cells[c].colSpanIndex=a;for(var d=0;d<e.colSpan;d++){if(b.columns[a+d]==null){b.columns[a+d]=[];b.columns[a+d].cells=[]}for(var f=0;f<e.rowSpan;f++){b.columns[a+d].cells[c+f]={};b.columns[a+d].cells[c+f].cell=e;b.columns[a+d].cells[c+f].colSpanIndex=a}}a+=e.colSpan;if(b.targetCellColSpanIndex!=-1&&a>b.targetCellColSpanIndex+g.colSpan&&c!=g.parentNode.rowIndex+g.rowSpan-1)break}return b}function RTE_UrlFileName(c){var a=c;a=a.split("#")[0];a=a.split("?")[0];var b=a.lastIndexOf("/");return a.substring(b+1)}var g_reservedTablePrefix;function RTE_GetReservedTableStyleRules(a){return RTE_GetReservedStyleRules(a,g_reservedTablePrefix,"-")}function RTE_GetReservedStyleRules(e,f,g){for(var a=[],d=[],c=0;c<e.styleSheets.length;c++){var b=e.styleSheets[c];if(RTE_UrlFileName(b.href)!=g)RTE_GetReservedStyleRulesFromStyleSheet(b,f,a);else RTE_GetReservedStyleRulesFromStyleSheet(b,f,d)}return a.length>0?a:d}function RTE_GetReservedStyleRulesFromStyleSheet(d,e,c){a:;try{for(var b=d.rules,a=0;a<b.length;a++)b[a].selectorText.indexOf(e)>=0&&c.push(b[a])}catch(f){}}var msTableStylePrefix,msTableClass,msTableClassHeadingRow,msTableClassHeadingFirstCol,msTableClassHeadingOddCol,msTableClassHeadingEvenCol,msTableClassHeadingLastCol,msTableClassOddRow,msTableClassEvenRow,msTableClassFirstCol,msTableClassOddCol,msTableClassEvenCol,msTableClassLastCol,msTableClassFootingRow,msTableClassFootingFirstCol,msTableClassFootingOddCol,msTableClassFootingEvenCol,msTableClassFootingLastCol;function RTE_ApplyTableStyle(b,p,u,w,m,n,a){a:;if(a==null)a=msTableStylePrefix;if(p!=null){RTE_AppendClassName(p,a+msTableClass+b);var i=p.rows,o=0,k=i.length-1,j=false,v=false;if(i.length==1){if(u){j=true;o++}k=0}else{if(u){j=true;o++}if(w){v=true;k--}}if(j){var g=i(0);RTE_AppendClassName(g,a+msTableClassHeadingRow+b);for(var s=0,d=0;d<g.cells.length;d++)if(d==0&&m){RTE_AppendClassName(g.cells(d),a+msTableClassHeadingFirstCol+b);s=1}else if(d==g.cells.length-1&&n)RTE_AppendClassName(g.cells(d),a+msTableClassHeadingLastCol+b);else if(d%2==s)RTE_AppendClassName(g.cells(d),a+msTableClassHeadingOddCol+b);else RTE_AppendClassName(g.cells(d),a+msTableClassHeadingEvenCol+b)}if(v){var h=i(k+1);RTE_AppendClassName(h,a+msTableClassFootingRow+b);for(var q=0,c=0;c<h.cells.length;c++)if(c==0&&m){RTE_AppendClassName(h.cells(c),a+msTableClassFootingFirstCol+b);q=1}else if(c==h.cells.length-1&&n)RTE_AppendClassName(h.cells(c),a+msTableClassFootingLastCol+b);else if(c%2==q)RTE_AppendClassName(h.cells(c),a+msTableClassFootingOddCol+b);else RTE_AppendClassName(h.cells(c),a+msTableClassFootingEvenCol+b)}var t=0;if(j)t=1;for(var l=o;l<=k;l++){var f=i(l);if(l%2==t)RTE_AppendClassName(f,a+msTableClassOddRow+b);else RTE_AppendClassName(f,a+msTableClassEvenRow+b);for(var r=0,e=0;e<f.cells.length;e++)if(e==0&&m){RTE_AppendClassName(f.cells(e),a+msTableClassFirstCol+b);r=1}else if(e==f.cells.length-1&&n)RTE_AppendClassName(f.cells(e),a+msTableClassLastCol+b);else if(e%2==r)RTE_AppendClassName(f.cells(e),a+msTableClassOddCol+b);else RTE_AppendClassName(f.cells(e),a+msTableClassEvenCol+b)}}}function RTE_ClearReservedTableStyles(b,a){a:;if(a==null)a=msTableStylePrefix;if(b!=null&&b.tagName=="TABLE"){RTE_ClearReservedTableStylesFromElement(b,a);for(var d=0;d<b.rows.length;d++){var c=b.rows[d];RTE_ClearReservedTableStylesFromElement(c,a);for(var e=0;e<c.cells.length;e++){var f=c.cells[e];RTE_ClearReservedTableStylesFromElement(f,a)}}}}function RTE_ClearReservedTableStylesFromElement(a,c){a:;if(c==null)c=msTableStylePrefix;if(a.className!=null&&a.className.length>0){for(var f=a.className.split(" "),b=[],e=0;e<f.length;e++){var g=f[e];if(g.indexOf(c)!=0)b[b.length]=g}a.className="";for(var d=0;d<b.length;d++)RTE_AppendClassName(a,b[d])}}function RTE_AppendClassName(b,c){a:;if(b!=null){var a=b.className;if(a!=null&&a.length>0)a+=" ";a+=c;b.className=a}}function RTE_GetReservedTableStyleNumbers(c,a){a:;if(a==null)a=msTableStylePrefix;var b=[];if(c!=null&&c.tagName=="TABLE")for(var g=c.className.split(" "),d=0;d<g.length;d++){var f=g[d],e=f.indexOf(a+msTableClass);if(e>=0){var h=f.substr(e+a.length+msTableClass.length);b[b.length]=h}}return b}function RTE_ReapplyTableStyles(a,b){if(b==null){var j=a.className.indexOf("Table");if(j>=0)b=a.className.substring(0,j+5);else b=msTableStylePrefix}if(a!=null&&a.rows.length>0){var g=RTE_GetReservedTableStyleNumbers(a,b);if(g.length>0){for(var f=[],i=0;i<g.length;i++){var c=[],d=g[i];c.tableStyleNumber=d;c.formatHeadingRow=RTE_ShouldFormatHeadingRow(d,a,b);c.formatLastRow=RTE_ShouldFormatLastRow(d,a,b);c.formatFirstColumn=RTE_ShouldFormatFirstColumn(d,a,b);c.formatLastColumn=RTE_ShouldFormatLastColumn(d,a,b);f[f.length]=c}RTE_ClearReservedTableStyles(a,b);for(var h=0;h<f.length;h++){var e=f[h];RTE_ApplyTableStyle(e.tableStyleNumber,a,e.formatHeadingRow,e.formatLastRow,e.formatFirstColumn,e.formatLastColumn,b)}}}}function RTE_ShouldFormatHeadingRow(g,c,b){a:;if(b==null)b=msTableStylePrefix;var e=false;if(g!=null&&c!=null&&c.rows.length>0){var a=c.rows[0];if(a.className!=null&&a.className.length>0)for(var f=a.className.split(" "),d=0;d<f.length;d++){var i=f[d],h=b+msTableClassHeadingRow+g;if(i==h){e=true;break}}}return e}function RTE_ShouldFormatLastRow(c,a,b){if(b==null)b=msTableStylePrefix;var f=false;if(c!=null&&a!=null&&a.rows.length>0)if(!(a.rows.length==1&&RTE_ShouldFormatHeadingRow(c,a,b))){var d=a.rows[a.rows.length-1];if(d.className!=null&&d.className.length>0)for(var g=d.className.split(" "),e=0;e<g.length;e++){var i=g[e],h=b+msTableClassFootingRow+c;if(i==h){f=true;break}}}return f}function RTE_ShouldFormatFirstColumn(d,b,a){a:;if(a==null)a=msTableStylePrefix;var g=false;if(d!=null&&b!=null&&b.rows.length>0){var c=a+msTableClassFirstCol,i=b.rows[0];if(RTE_ShouldFormatHeadingRow(d,b,a))c=a+msTableClassHeadingFirstCol;else if(b.rows.length==1&&RTE_ShouldFormatLastRow(d,b,a))c=a+msTableClassFootingFirstCol;if(i.cells.length>0){c+=d;var e=i.cells[0];if(e.className!=null&&e.className.length>0)for(var h=e.className.split(" "),f=0;f<h.length;f++){var j=h[f];if(j==c){g=true;break}}}}return g}function RTE_ShouldFormatLastColumn(c,b,a){a:;if(a==null)a=msTableStylePrefix;var h=false;if(c!=null&&b!=null&&b.rows.length>0){var d=a+msTableClassLastCol,e=b.rows[0];if(RTE_ShouldFormatHeadingRow(c,b,a))d=a+msTableClassHeadingLastCol;else if(b.rows.length==1&&RTE_ShouldFormatLastRow(c,b,a))d=a+msTableClassFootingLastCol;if(e.cells.length>0){d+=c;if(!(e.cells.length==1&&RTE_ShouldFormatFirstColumn(c,b,a))){var f=e.cells[e.cells.length-1];if(f.className!=null&&f.className.length>0)for(var i=f.className.split(" "),g=0;g<i.length;g++)if(i[g]==d){h=true;break}}}}return h}function C_RTE_TB_Enabler(){}function C_RTE_TB_ExecCmdButton_InitializePrototype(){a:;C_RTE_TB_ExecCmdButton.prototype.strMnemonic=undefined;C_RTE_TB_ExecCmdButton.prototype.strToolTip=undefined;C_RTE_TB_ExecCmdButton.prototype.fUi=undefined;C_RTE_TB_ExecCmdButton.prototype.strImage=undefined;C_RTE_TB_ExecCmdButton.prototype.fImageLoc=undefined;C_RTE_TB_ExecCmdButton.prototype.fOnlyIf=undefined;C_RTE_TB_ExecCmdButton.prototype.enabler=undefined;C_RTE_TB_ExecCmdButton.prototype.strValueExpr=undefined;C_RTE_TB_ExecCmdButton.prototype.Generate=function(b){var a;if(this.fImageLoc)a=RTE_GetServerRelativeImageUrl(this.strImage);else a=RTE_GetServerRelativeUnlocalizedImageUrl(this.strImage);return RTE_TB_GenerateExecCommandToolBarButtonHtml(b,this.strMnemonic,this.fUi,a,"",this.strToolTip,this.fOnlyIf,this.strValueExpr)}}function C_RTE_TB_ExecCmdButton(c,d,h,g,b,f,a,e){this.strMnemonic=c;this.strToolTip=d;this.fUi=h;this.strImage=g;this.fImageLoc=b;this.fOnlyIf=f;this.enabler=e;this.enabler.button=this;this.strValueExpr=a}function C_RTE_TB_ExecCmdButtonClustered_InitializePrototype(){a:;C_RTE_TB_ExecCmdButtonClustered.prototype.strMnemonic=undefined;C_RTE_TB_ExecCmdButtonClustered.prototype.strToolTip=undefined;C_RTE_TB_ExecCmdButtonClustered.prototype.fUi=undefined;C_RTE_TB_ExecCmdButtonClustered.prototype.strImage=undefined;C_RTE_TB_ExecCmdButtonClustered.prototype.fOnlyIf=undefined;C_RTE_TB_ExecCmdButtonClustered.prototype.enabler=undefined;C_RTE_TB_ExecCmdButtonClustered.prototype.strValueExpr=undefined;C_RTE_TB_ExecCmdButtonClustered.prototype.Generate=function(a){var b=RTE_GetServerRelativeImageUrl("rtecluster.png");return RTE_TB_GenerateExecCommandToolBarButtonHtmlCluster(a,this.strMnemonic,this.fUi,b,"ms-"+this.strImage,this.strToolTip,this.fOnlyIf,this.strValueExpr)}}function C_RTE_TB_ExecCmdButtonClustered(b,c,g,f,e,a,d){this.strMnemonic=b;this.strToolTip=c;this.fUi=g;this.strImage=f;this.fOnlyIf=e;this.enabler=d;this.enabler.button=this;this.strValueExpr=a}function C_RTE_TB_JScriptButton_InitializePrototype(){a:;C_RTE_TB_JScriptButton.prototype.strMnemonic=undefined;C_RTE_TB_JScriptButton.prototype.strToolTip=undefined;C_RTE_TB_JScriptButton.prototype.strFunction=undefined;C_RTE_TB_JScriptButton.prototype.strArgument=undefined;C_RTE_TB_JScriptButton.prototype.strImage=undefined;C_RTE_TB_JScriptButton.prototype.enabler=undefined;C_RTE_TB_JScriptButton.prototype.Generate=function(a){return RTE_TB_GenerateSimpleToolBarButtonHtml(a,this.strMnemonic,this.strFunction,this.strArgument,RTE_GetServerRelativeImageUrl(this.strImage),"",this.strToolTip)}}function C_RTE_TB_JScriptButton(a,b,e,f,d,c){this.strMnemonic=a;this.strToolTip=b;this.strFunction=e;this.strArgument=f;this.strImage=d;this.enabler=c;this.enabler.button=this}function C_RTE_TB_JScriptButtonClustered_InitializePrototype(){a:;C_RTE_TB_JScriptButtonClustered.prototype.strMnemonic=undefined;C_RTE_TB_JScriptButtonClustered.prototype.strToolTip=undefined;C_RTE_TB_JScriptButtonClustered.prototype.strFunction=undefined;C_RTE_TB_JScriptButtonClustered.prototype.strArgument=undefined;C_RTE_TB_JScriptButtonClustered.prototype.strImage=undefined;C_RTE_TB_JScriptButtonClustered.prototype.enabler=undefined;C_RTE_TB_JScriptButtonClustered.prototype.Generate=function(a){return RTE_TB_GenerateSimpleToolBarButtonHtmlCluster(a,this.strMnemonic,this.strFunction,this.strArgument,RTE_GetServerRelativeImageUrl("rtecluster.png"),"ms-"+this.strImage,this.strToolTip)}}function C_RTE_TB_JScriptButtonClustered(a,b,e,f,d,c){this.strMnemonic=a;this.strToolTip=b;this.strFunction=e;this.strArgument=f;this.strImage=d;this.enabler=c;this.enabler.button=this}function C_RTE_TB_SpecialButton_InitializePrototype(){a:;C_RTE_TB_SpecialButton.prototype.specialFunction=undefined;C_RTE_TB_SpecialButton.prototype.strMnemonic=undefined;C_RTE_TB_SpecialButton.prototype.fRestricted=undefined;C_RTE_TB_SpecialButton.prototype.enabler=undefined;C_RTE_TB_SpecialButton.prototype.Generate=function(a,b){return this.specialFunction(a,b,this.fRestricted)}}function C_RTE_TB_SpecialButton(b,d,a,c){this.specialFunction=d;this.strMnemonic=b;this.fRestricted=a;this.enabler=c;this.enabler.button=this}function C_RTE_TB_Separator(){a:;function a(){a:;return RTE_TB_GenerateToolBarSeparatorHtml()}this.Generate=a}function C_RTE_TB_LineBreak(){a:;function a(){a:;return RTE_TB_GenerateToolBarLineBreakHtml()}this.Generate=a}function C_RTE_TB_SetEnabledAlways(){a:;function a(a){a:;RTE_TB_ClearButtonDisabled(RTE_TB_GetToolBarButton(a,this.button.strMnemonic))}this.SetEnabled=a}function C_RTE_TB_SetEnabledWhenRemoveFormatEnabled(){a:;function a(c,a){a:;var b=RTE_TB_GetToolBarButton(c,this.button.strMnemonic);if(typeof a.queryCommandEnabled!="undefined"&&a.queryCommandEnabled("Delete")&&a.queryCommandEnabled(g_strRTERemoveFormatMnemonic))RTE_TB_ClearButtonDisabled(b);else RTE_TB_SetButtonDisabled(b)}this.SetEnabled=a}function C_RTE_TB_SetEnabledFromCommandEnabled(){a:;function a(a,b){a:;RTE_TB_SetEnabledFromCommandEnabled(a,b,this.button.strMnemonic,this.button.strMnemonic)}this.SetEnabled=a}function C_RTE_TB_SetEnabledFromCommandValue(){a:;function a(a,b){a:;RTE_TB_ClearButtonDisabled(RTE_TB_GetToolBarButton(a,this.button.strMnemonic));RTE_TB_SetCheckFromCommandValue(a,b,this.button.strMnemonic)}this.SetEnabled=a}function C_RTE_TB_SetEnabledFromCommandValueIfNotInTable(){a:;function a(a,c,b){a:;if(b[0]!="TABLE"&&b[0]!="TR"){RTE_TB_ClearButtonDisabled(RTE_TB_GetToolBarButton(a,this.button.strMnemonic));RTE_TB_SetCheckFromCommandValue(a,c,this.button.strMnemonic)}}this.SetEnabled=a}function C_RTE_TB_SetEnabledIfInElement(b){a:;function a(a,c,b){a:;RTE_TB_SetEnabledIfInElement(a,b,this.button.strMnemonic,this.strElement)}this.strElement=b;this.SetEnabled=a}function RTE_GetToolBarDefinition(b,c){var a=RTE_GetEditorInstanceVariables(b);return a!=null&&a.overrides.GetToolBarDefinition!=null?a.overrides.GetToolBarDefinition(b,c):a!=null?RTE_GetCompatibleToolBarDefinition(c,a.aSettings.fRestrictedMode,a.aSettings.fAllowHyperlink,a.aSettings.fIsVisible):null}var g_rgCompatibleToolBarDefinition;function RTE_GetCompatibleToolBarDefinition(c,b,d){a:;if(g_rgCompatibleToolBarDefinition==null){var a=[];if(!b){a.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTECutMnemonic,Strings.STS.L_CutToolTip_TEXT,false,"rtecut",true,"null",new C_RTE_TB_SetEnabledFromCommandEnabled));a.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTECopyMnemonic,Strings.STS.L_CopyToolTip_TEXT,false,"rtecopy",true,"null",new C_RTE_TB_SetEnabledFromCommandEnabled));a.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEPasteMnemonic,Strings.STS.L_PasteToolTip_TEXT,false,"rtepaste",false,"null",new C_RTE_TB_SetEnabledFromCommandEnabled));a.push(new C_RTE_TB_Separator)}a.push(new C_RTE_TB_SpecialButton(g_strRTEFontNameMnemonic,RTE_GenerateFontNameToolBarButtonHtml,b,new C_RTE_TB_SetEnabledAlways));a.push(new C_RTE_TB_SpecialButton(g_strRTEFontSizeMnemonic,RTE_GenerateFontSizeToolBarButtonHtml,b,new C_RTE_TB_SetEnabledAlways));a.push(new C_RTE_TB_Separator);a.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEBoldMnemonic,Strings.STS.L_BoldToolTip_TEXT,false,"rtebold",false,"null",new C_RTE_TB_SetEnabledFromCommandValue));a.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEItalicMnemonic,Strings.STS.L_ItalicToolTip_TEXT,false,"rteital",false,"null",new C_RTE_TB_SetEnabledFromCommandValue));a.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEUnderlineMnemonic,Strings.STS.L_UnderlineToolTip_TEXT,false,"rteundl",false,"null",new C_RTE_TB_SetEnabledFromCommandValue));a.push(new C_RTE_TB_Separator);if(c=="1025"||c=="1037"){a.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEJustifyRightMnemonic,Strings.STS.L_JustifyRightToolTip_TEXT,false,"rtertal",false,"null",new C_RTE_TB_SetEnabledFromCommandValue));a.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEJustifyCenterMnemonic,Strings.STS.L_JustifyCenterToolTip_TEXT,false,"rtectral",false,"null",new C_RTE_TB_SetEnabledFromCommandValue));a.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEJustifyLeftMnemonic,Strings.STS.L_JustifyLeftToolTip_TEXT,false,"rteltal",false,"null",new C_RTE_TB_SetEnabledFromCommandValue))}else{a.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEJustifyLeftMnemonic,Strings.STS.L_JustifyLeftToolTip_TEXT,false,"rteltal",false,"null",new C_RTE_TB_SetEnabledFromCommandValue));a.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEJustifyCenterMnemonic,Strings.STS.L_JustifyCenterToolTip_TEXT,false,"rtectral",false,"null",new C_RTE_TB_SetEnabledFromCommandValue));a.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEJustifyRightMnemonic,Strings.STS.L_JustifyRightToolTip_TEXT,false,"rtertal",false,"null",new C_RTE_TB_SetEnabledFromCommandValue))}a.push(new C_RTE_TB_Separator);a.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEOrderedListMnemonic,Strings.STS.L_OrderedListToolTip_TEXT,false,"rtenlst",false,"null",new C_RTE_TB_SetEnabledFromCommandValueIfNotInTable));a.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEUnorderedListMnemonic,Strings.STS.L_UnorderedListToolTip_TEXT,false,"rteblst",false,"null",new C_RTE_TB_SetEnabledFromCommandValueIfNotInTable));!b&&a.push(new C_RTE_TB_Separator);a.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEOutdentMnemonic,Strings.STS.L_OutdentToolTip_TEXT,false,"rteuidt",false,"null",new C_RTE_TB_SetEnabledAlways));a.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEIndentMnemonic,Strings.STS.L_IndentToolTip_TEXT,false,"rteidt",false,"null",new C_RTE_TB_SetEnabledAlways));!b&&a.push(new C_RTE_TB_Separator);(!b||d)&&a.push(new C_RTE_TB_JScriptButtonClustered(g_strRTECreateLinkMnemonic,Strings.STS.L_CreateLinkToolTip_TEXT,"RTE_CreateLink",null,"rtelnk",new C_RTE_TB_SetEnabledWhenRemoveFormatEnabled));!b&&a.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEInsertImageMnemonic,Strings.STS.L_InsertImageToolTip_TEXT,true,"rteimg",false,"null",new C_RTE_TB_SetEnabledWhenRemoveFormatEnabled));a.push(new C_RTE_TB_Separator);a.push(new C_RTE_TB_SpecialButton(g_strRTEForeColorMnemonic,RTE_GenerateForeColorToolBarButtonHtml,b,new C_RTE_TB_SetEnabledAlways));a.push(new C_RTE_TB_SpecialButton(g_strRTEBackColorMnemonic,RTE_GenerateBackColorToolBarButtonHtml,b,new C_RTE_TB_SetEnabledAlways));if(RTE_ShouldShowDirection()){!b&&a.push(new C_RTE_TB_Separator);if(c=="1025"||c=="1037"){a.push(new C_RTE_TB_JScriptButtonClustered(g_strRTERTLMnemonic,Strings.STS.L_RTLToolTip_TEXT,"RTE_SetDirectionOfSelection","'rtl'","rtertl",new C_RTE_TB_SetEnabledAlways));a.push(new C_RTE_TB_JScriptButtonClustered(g_strRTELTRMnemonic,Strings.STS.L_LTRToolTip_TEXT,"RTE_SetDirectionOfSelection","'ltr'","rteltr",new C_RTE_TB_SetEnabledAlways))}else{a.push(new C_RTE_TB_JScriptButtonClustered(g_strRTELTRMnemonic,Strings.STS.L_LTRToolTip_TEXT,"RTE_SetDirectionOfSelection","'ltr'","rteltr",new C_RTE_TB_SetEnabledAlways));a.push(new C_RTE_TB_JScriptButtonClustered(g_strRTERTLMnemonic,Strings.STS.L_RTLToolTip_TEXT,"RTE_SetDirectionOfSelection","'rtl'","rtertl",new C_RTE_TB_SetEnabledAlways))}}g_rgCompatibleToolBarDefinition=a}return g_rgCompatibleToolBarDefinition}function RTE_ModalDialog(a,b,f,e,c){a:;var d=RTE_GetEditorInstanceVariables(a);return window.showModalDialog(d.aSettings.urlWebRoot+"/_layouts/15/RteDialog.aspx?Dialog="+b+"&LCID="+RTE_GetWebLocale(a)+"&IsDlg=1",c,"resizable: yes; status: no; help: no; center: yes; dialogWidth:"+String(f)+"px; dialogHeight:"+String(e)+"px;")}function RTE_FullHtmlToolBarDefinitionFactory(b){var a;return function(d){if(a==null){var c=[];c.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTECutMnemonic,Strings.STS.L_CutToolTip_TEXT,false,"rtecut",true,"null",new C_RTE_TB_SetEnabledFromCommandEnabled));c.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTECopyMnemonic,Strings.STS.L_CopyToolTip_TEXT,false,"rtecopy",true,"null",new C_RTE_TB_SetEnabledFromCommandEnabled));c.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEPasteMnemonic,Strings.STS.L_PasteToolTip_TEXT,false,"rtepaste",false,"null",new C_RTE_TB_SetEnabledFromCommandEnabled));c.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTERemoveFormatMnemonic,Strings.STS.L_RemoveFormatToolTip_TEXT,false,"rteclear",false,"null",new C_RTE_TB_SetEnabledFromCommandEnabled));c.push(new C_RTE_TB_Separator);if(d=="1025"||d=="1037"){c.push(new C_RTE_TB_ExecCmdButton(g_strRTERedoMnemonic,Strings.STS.L_RedoToolTip_TEXT,false,"redo.gif",false,false,"null",new C_RTE_TB_SetEnabledFromCommandEnabled));c.push(new C_RTE_TB_ExecCmdButton(g_strRTEUndoMnemonic,Strings.STS.L_UndoToolTip_TEXT,false,"undo.gif",false,false,"null",new C_RTE_TB_SetEnabledFromCommandEnabled))}else{c.push(new C_RTE_TB_ExecCmdButton(g_strRTEUndoMnemonic,Strings.STS.L_UndoToolTip_TEXT,false,"undo.gif",false,false,"null",new C_RTE_TB_SetEnabledFromCommandEnabled));c.push(new C_RTE_TB_ExecCmdButton(g_strRTERedoMnemonic,Strings.STS.L_RedoToolTip_TEXT,false,"redo.gif",false,false,"null",new C_RTE_TB_SetEnabledFromCommandEnabled))}c.push(new C_RTE_TB_Separator);c.push(new C_RTE_TB_JScriptButtonClustered(g_strRTEInsertTableMnemonic,Strings.STS.L_InsertTableToolTip_TEXT,"RTE_InsertTable",null,"rteitbl",new C_RTE_TB_SetEnabledWhenRemoveFormatEnabled));c.push(new C_RTE_TB_SpecialButton(g_strRTEInsertTableElementMnemonic,RTE_GenerateInsertTableElementToolBarButtonHtml,true,new C_RTE_TB_SetEnabledIfInElement("TR")));c.push(new C_RTE_TB_SpecialButton(g_strRTEDeleteTableElementMnemonic,RTE_GenerateDeleteTableElementToolBarButtonHtml,true,new C_RTE_TB_SetEnabledIfInElement("TR")));c.push(new C_RTE_TB_JScriptButtonClustered(g_strRTESplitCellMnemonic,Strings.STS.L_SplitCellToolTip_TEXT,"RTE_SplitCell",null,"rtescell",new C_RTE_TB_SetEnabledIfInElement("TR")));c.push(new C_RTE_TB_JScriptButtonClustered(g_strRTEMergeCellMnemonic,Strings.STS.L_MergeCellToolTip_TEXT,"RTE_MergeCells",null,"rtemcell",new C_RTE_TB_SetEnabledIfInElement("TR")));c.push(new C_RTE_TB_Separator);c.push(new C_RTE_TB_JScriptButtonClustered(g_strRTECreateLinkMnemonic,Strings.STS.L_CreateLinkToolTip_TEXT,"RTE_CreateLink",null,"rtelnk",new C_RTE_TB_SetEnabledWhenRemoveFormatEnabled));c.push(new C_RTE_TB_JScriptButtonClustered(g_strRTEInsertImageMnemonic,Strings.STS.L_InsertImageToolTip_TEXT,"RTE_InsertImage",null,"rteimg",new C_RTE_TB_SetEnabledWhenRemoveFormatEnabled));b&&c.push(new C_RTE_TB_JScriptButtonClustered(g_strRTEHtmlSourceMnemonic,Strings.STS.L_HtmlSourceToolTip_TEXT,"RTE_HtmlSource",null,"rtesrced",new C_RTE_TB_SetEnabledAlways));c.push(new C_RTE_TB_LineBreak);c.push(new C_RTE_TB_SpecialButton(g_strRTEFontNameMnemonic,RTE_GenerateFontNameToolBarButtonHtml,true,new C_RTE_TB_SetEnabledAlways));c.push(new C_RTE_TB_SpecialButton(g_strRTEFontSizeMnemonic,RTE_GenerateFontSizeToolBarButtonHtml,true,new C_RTE_TB_SetEnabledAlways));c.push(new C_RTE_TB_Separator);c.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEBoldMnemonic,Strings.STS.L_BoldToolTip_TEXT,false,"rtebold",false,"null",new C_RTE_TB_SetEnabledFromCommandValue));c.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEItalicMnemonic,Strings.STS.L_ItalicToolTip_TEXT,false,"rteital",false,"null",new C_RTE_TB_SetEnabledFromCommandValue));c.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEUnderlineMnemonic,Strings.STS.L_UnderlineToolTip_TEXT,false,"rteundl",false,"null",new C_RTE_TB_SetEnabledFromCommandValue));c.push(new C_RTE_TB_Separator);if(d=="1025"||d=="1037"){c.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEJustifyRightMnemonic,Strings.STS.L_JustifyRightToolTip_TEXT,false,"rtertal",false,"null",new C_RTE_TB_SetEnabledFromCommandValue));c.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEJustifyCenterMnemonic,Strings.STS.L_JustifyCenterToolTip_TEXT,false,"rtectral",false,"null",new C_RTE_TB_SetEnabledFromCommandValue));c.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEJustifyLeftMnemonic,Strings.STS.L_JustifyLeftToolTip_TEXT,false,"rteltal",false,"null",new C_RTE_TB_SetEnabledFromCommandValue))}else{c.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEJustifyLeftMnemonic,Strings.STS.L_JustifyLeftToolTip_TEXT,false,"rteltal",false,"null",new C_RTE_TB_SetEnabledFromCommandValue));c.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEJustifyCenterMnemonic,Strings.STS.L_JustifyCenterToolTip_TEXT,false,"rtectral",false,"null",new C_RTE_TB_SetEnabledFromCommandValue));c.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEJustifyRightMnemonic,Strings.STS.L_JustifyRightToolTip_TEXT,false,"rtertal",false,"null",new C_RTE_TB_SetEnabledFromCommandValue))}c.push(new C_RTE_TB_Separator);c.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEOrderedListMnemonic,Strings.STS.L_OrderedListToolTip_TEXT,false,"rtenlst",false,"null",new C_RTE_TB_SetEnabledFromCommandValueIfNotInTable));c.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEUnorderedListMnemonic,Strings.STS.L_UnorderedListToolTip_TEXT,false,"rteblst",false,"null",new C_RTE_TB_SetEnabledFromCommandValueIfNotInTable));c.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEOutdentMnemonic,Strings.STS.L_OutdentToolTip_TEXT,false,"rteuidt",false,"null",new C_RTE_TB_SetEnabledAlways));c.push(new C_RTE_TB_ExecCmdButtonClustered(g_strRTEIndentMnemonic,Strings.STS.L_IndentToolTip_TEXT,false,"rteidt",false,"null",new C_RTE_TB_SetEnabledAlways));c.push(new C_RTE_TB_Separator);c.push(new C_RTE_TB_SpecialButton(g_strRTEForeColorMnemonic,RTE_GenerateForeColorToolBarButtonHtml,true,new C_RTE_TB_SetEnabledAlways));c.push(new C_RTE_TB_SpecialButton(g_strRTEBackColorMnemonic,RTE_GenerateBackColorToolBarButtonHtml,true,new C_RTE_TB_SetEnabledAlways));if(RTE_ShouldShowDirection())if(d=="1025"||d=="1037"){c.push(new C_RTE_TB_JScriptButtonClustered("rtl",Strings.STS.L_RTLToolTip_TEXT,"RTE_SetDirectionOfSelection","'rtl'","rtertl",new C_RTE_TB_SetEnabledAlways));c.push(new C_RTE_TB_JScriptButtonClustered("ltr",Strings.STS.L_LTRToolTip_TEXT,"RTE_SetDirectionOfSelection","'ltr'","rteltr",new C_RTE_TB_SetEnabledAlways))}else{c.push(new C_RTE_TB_JScriptButtonClustered("ltr",Strings.STS.L_LTRToolTip_TEXT,"RTE_SetDirectionOfSelection","'ltr'","rteltr",new C_RTE_TB_SetEnabledAlways));c.push(new C_RTE_TB_JScriptButtonClustered("rtl",Strings.STS.L_RTLToolTip_TEXT,"RTE_SetDirectionOfSelection","'rtl'","rtertl",new C_RTE_TB_SetEnabledAlways))}a=c}return a}}var FileuploadString,FileUploadIndex,FileUploadLocalFileCount,attachmentsOnClientToBeRemoved,attachmentsOnClientToBeRemovedIndex,attachmentsOnServerToBeRemoved,attachmentsOnServerToBeRemovedIndex;function UploadAttachment(){a:;ShowPartAttachment()}function ShowPart1(){a:;document.getElementById("partAttachment").style.display="none";document.getElementById("part1").style.display="block";window.frameElement!=null&&typeof window.frameElement.autoSize=="function"&&window.frameElement.autoSize();window.frameElement!=null&&typeof window.frameElement.SetFirstFocus=="function"&&window.frameElement.SetFirstFocus(true)}function ShowPartAttachment(){a:;if(document.getElementById("part1")==null||typeof document.getElementById("part1")=="undefined"){alert(Strings.STS.L_FormMissingPart1_Text);return}document.getElementById("part1").style.display="none";document.getElementById("partAttachment").style.display="block";window.frameElement!=null&&typeof window.frameElement.autoSize=="function"&&TypeofFullName("window.frameElement.autoSize")=="function"&&window.frameElement.autoSize();GetAttachElement(FileuploadString+String(FileUploadIndex)).focus()}function CancelAttach(){a:;var b=FileuploadString+String(FileUploadIndex),a=GetAttachElement(b),c=a.value;if(Boolean(c))a.outerHTML="<input type=file class='ms-longfileinput' name="+b+">";ShowPart1()}function OkAttach(){a:;var g=FileuploadString+String(FileUploadIndex),b=GetAttachElement(g),f=TrimWhiteSpaces(b.value);if(!Boolean(f)){alert(Strings.STS.L_FileNameRequired_TXT);b.focus()}else{var c=document.getElementById("idAttachmentsTable").insertRow(-1),h="attachRow"+String(FileUploadIndex);c.id=h;var d=c.insertCell(-1);d.className="ms-vb";d.innerHTML='<span dir="ltr">'+f+"</span>&nbsp;&nbsp;&nbsp;&nbsp;";var e=c.insertCell(-1);e.className="ms-propertysheet";var k=document.getElementsByName("RectGifUrl")[0];e.innerHTML='<span class="ms-delAttachments"><IMG SRC=\''+k.value+"'>&nbsp;<a href='javascript:RemoveLocal(\""+h+'","'+g+"\")'>"+Strings.STS.L_Delete_Text+"</a></span>";b.style.display="none";++FileUploadIndex;++FileUploadLocalFileCount;var i=document.getElementById("attachmentsOnClient"),a=document.createElement("input");a.tabIndex=1;a.type="File";a.className="ms-longfileinput";a.title=Strings.STS.L_FileUploadToolTip_text;a.name=FileuploadString+String(FileUploadIndex);a.id=FileuploadString+String(FileUploadIndex);a.size=56;i.appendChild(a);var j=b.form;j.encoding="multipart/form-data";document.getElementById("idAttachmentsRow").style.display="";ShowPart1()}}function GetAttachElement(b){a:;var a=document.getElementById(b);if(a==null)a=document.getElementsByName(b)[0];return a}function RemoveLocal(e,d){a:;var c=document.getElementById("idAttachmentsRow"),a=document.getElementById("idAttachmentsTable");a.deleteRow(document.getElementById(e).rowIndex);var b=GetAttachElement(d);b.parentNode.removeChild(b);if(typeof a!="undefined"&&typeof a.rows.length!="undefined"&&a.rows.length==0)c.style.display="none";if(FileUploadLocalFileCount>0)--FileUploadLocalFileCount}function RemoveFromServer(a){a:;RemoveAttachmentFromServer(a,0)}function RemoveAttachmentFromServer(b,c){a:;var a;if(Boolean(c))a=Strings.STS.L_ConfirmRecycle_TXT;else a=Strings.STS.L_ConfirmDelete_TXT;if(confirm(a)){document.getElementById("idAttachmentsTable").deleteRow(document.getElementById(b).rowIndex);var d=document.getElementsByName("attachmentsToBeRemovedFromServer")[0];d.value+=b+";";if(document.getElementById("idAttachmentsTable").rows.length==0)document.getElementById("idAttachmentsRow").style.display="none"}}function Calendar_InitializePrototype(){a:;Calendar.prototype={actualDateEnd:undefined,actualDateStart:undefined,dateDP:undefined,dateEnd:undefined,dateStart:undefined,day:undefined,dow:undefined,iperiod:undefined,maxQuarterEnd:undefined,month:undefined,mon:undefined,mpEvents:undefined,mpIchan:undefined,mpSpan:undefined,msDay:undefined,msHour:undefined,msWeek:undefined,multiDay:undefined,stViewID:undefined,yr:undefined};Calendar.prototype.AddEvent=CalAddEvent;Calendar.prototype.AddFullEvent=CalAddFullEvent;Calendar.prototype.AssignChannels=CalAssignChannels;Calendar.prototype.BuildUI=CalBuildUI;Calendar.prototype.DPDayStyle=CalDPDayStyle;Calendar.prototype.DayStyle=CalDayStyle;Calendar.prototype.IchanNext=CalIchanNext;Calendar.prototype.IrwFromDate=CalIrwFromDate;Calendar.prototype.MoveDate=CalMoveDate;Calendar.prototype.MoveDay=CalMoveDay;Calendar.prototype.MoveMonth=CalMoveMonth;Calendar.prototype.MoveToDay=CalMoveToDay;Calendar.prototype.MoveToToday=CalMoveToToday;Calendar.prototype.MoveVDay=CalMoveDay;Calendar.prototype.MoveWeek=CalMoveWeek;Calendar.prototype.PlaceEventInRow=CalPlaceEventInRow;Calendar.prototype.Post=CalDoPost;Calendar.prototype.SetDate=CalSetDate;Calendar.prototype.SetDateFromGrid=CalSetDateFromGrid;Calendar.prototype.SpanCheck=CalSpanCheck;Calendar.prototype.StBuild=CalStBuild;Calendar.prototype.StBuildDHTML=CalStBuildDHTML;Calendar.prototype.StBuildPicker=CalStBuildPicker;Calendar.prototype.StDayMonthYear=CalStDayMonthYear;Calendar.prototype.StDaySpanMonthYear=CalDaySpanMonthYear;Calendar.prototype.StDownlevelBuild=CalStDownlevelBuild;Calendar.prototype.StMonthYear=CalStMonthYear;Calendar.prototype.rgDOW=CalGetDOW;Calendar.prototype.rgDOWLong=CalGetDOWLong;Calendar.prototype.rgDOWDP=CalGetDOWDP;Calendar.prototype.rgMonths=CalGetMonths;Calendar.msMinute=1e3*60;Calendar.msHour=Calendar.msMinute*60;Calendar.msDay=Calendar.msHour*24;Calendar.msWeek=Calendar.msDay*7}function CalEvent_InitializePrototype(){a:;CalEvent.prototype.actualDateEnd=undefined;CalEvent.prototype.actualDateStart=undefined;CalEvent.prototype.dateEnd=undefined;CalEvent.prototype.dateStart=undefined;CalEvent.prototype.ichan=undefined;CalEvent.prototype.ihour=undefined;CalEvent.prototype.multiDay=undefined;CalEvent.prototype.multiQuarter=undefined;CalEvent.prototype.rowspan=undefined;CalEvent.prototype.rgIcons=undefined;CalEvent.prototype.stDesc=undefined;CalEvent.prototype.stLocation=undefined;CalEvent.prototype.stTitle=undefined;CalEvent.prototype.stURL=undefined;CalEvent.prototype.FOverlap=EvtFOverlap;CalEvent.prototype.StTip=EvtStTip}function Span_InitializePrototype(){a:;Span.prototype.evt=undefined;Span.prototype.cbucket=undefined}function MsFloorTime(d,b,c){var a=d.getTime();if(c)a=a-1;a=b*Math.floor(a/b);return a}function Calendar(d,b,c,g){a:;if(!Boolean(c))c=new DateOptions;this.dopt=c;var i=1;if(d==null||b==null){var a=StURLGetVar("CalendarDate");if(a!=""){d=Number(a.substr(0,4));var h=a.indexOf("-",5);if(h==-1)b=Number(a.substr(5))-1;else{b=Number(a.substr(5,h-5))-1;i=Number(a.substr(h+1))}}if(a==""||isNaN(Number(c.DateYMD(d,b,1)))){var f=this.dopt.Today();d=f.getUTCFullYear();b=f.getUTCMonth();i=f.getUTCDate()}}var e=StURLGetVar("CalendarPeriod");if(e=="week"){this.period="week";this.iperiod=1}else if(e=="day"){this.period="vday";this.iperiod=2}else if(e=="vday"){this.period="vday";this.iperiod=2}else if(e=="month"){this.period="month";this.iperiod=0}else{this.period=c.CalendarPeriod;if(this.period=="week")this.iperiod=1;else if(this.period=="day")this.iperiod=2;else if(this.period=="vday")this.iperiod=2;else this.iperiod=0}this.SetDate(d,b,i);if(this.iperiod==0){this.cchanMin=4;this.cchanMax=4}else if(this.iperiod==1){this.cchanMin=20;this.cchanMax=20}else{this.cchanMin=3;this.cchanMax=100}this.ievtMax=0;this.rgEvt=[];this.fUseDHTML=browseris.ie&&browseris.verIEFull>4&&browseris.win32||browseris.nav6up;this.fDatePicker=false;this.dateDP=null;if(!Boolean(g))g="cal";this.stObject=g}function CalGetDOW(a){a:;var b=[Strings.STS.L_rgDOW0_Text,Strings.STS.L_rgDOW1_Text,Strings.STS.L_rgDOW2_Text,Strings.STS.L_rgDOW3_Text,Strings.STS.L_rgDOW4_Text,Strings.STS.L_rgDOW5_Text,Strings.STS.L_rgDOW6_Text];return b[a]}function CalGetDOWLong(b){a:;var a=[Strings.STS.L_rgDOWLong0_Text,Strings.STS.L_rgDOWLong1_Text,Strings.STS.L_rgDOWLong2_Text,Strings.STS.L_rgDOWLong3_Text,Strings.STS.L_rgDOWLong4_Text,Strings.STS.L_rgDOWLong5_Text,Strings.STS.L_rgDOWLong6_Text];return a[b]}function CalGetDOWDP(b){a:;var a=[Strings.STS.L_rgDOWDP0_Text,Strings.STS.L_rgDOWDP1_Text,Strings.STS.L_rgDOWDP2_Text,Strings.STS.L_rgDOWDP3_Text,Strings.STS.L_rgDOWDP4_Text,Strings.STS.L_rgDOWDP5_Text,Strings.STS.L_rgDOWDP6_Text];return a[b]}function CalGetMonths(b){a:;var a=[Strings.STS.L_rgMonths0_Text,Strings.STS.L_rgMonths1_Text,Strings.STS.L_rgMonths2_Text,Strings.STS.L_rgMonths3_Text,Strings.STS.L_rgMonths4_Text,Strings.STS.L_rgMonths5_Text,Strings.STS.L_rgMonths6_Text,Strings.STS.L_rgMonths7_Text,Strings.STS.L_rgMonths8_Text,Strings.STS.L_rgMonths9_Text,Strings.STS.L_rgMonths10_Text,Strings.STS.L_rgMonths11_Text];return a[b]}function CalStMonthYear(){a:;var a="";if(this.iperiod!=0)a+='<span style="cursor:pointer;" onmouseover="HighlightText(this, \'red\');" onmouseout="HighlightText(this, \'\');"'+StClickEvent(this.stObject+".MoveMonth(0)")+">";var b="",c="",d="";switch(this.dopt.stDateOrder){case"MDY":case"DMY":c=this.rgMonths(this.mon);d=String(this.yr);b=Strings.STS.L_MYDATE_Text;break;case"YMD":c=String(this.yr);d=this.rgMonths(this.mon);b=Strings.STS.L_YMDATE_Text}a+=StBuildParam(b,[c,d]);if(this.iperiod!=0)a+="</span>";return a}function CalDaySpanMonthYear(){a:;var i="",k="",l="",a="",b="",c="",d="",e="",f="",g="",h="";if(this.iperiod!=0)i+='<span style="cursor:pointer;" onmouseover="HighlightText(this, \'red\');" onmouseout="HighlightText(this, \'\');"'+StClickEvent(this.stObject+".MoveMonth(0)")+">";var j=this.dateStart.getUTCFullYear()!=this.dateEnd.getUTCFullYear();switch(this.dopt.stDateOrder){case"MDY":c=this.rgMonths(this.dateStart.getUTCMonth());d=String(this.dateStart.getUTCDate());e=String(this.dateStart.getUTCFullYear());if(j)a=Strings.STS.L_MDYDATE_Text;else a=Strings.STS.L_MDYDATESameYear_Text;f=this.rgMonths(this.dateEnd.getUTCMonth());g=String(this.dateEnd.getUTCDate());h=String(this.dateEnd.getUTCFullYear());b=Strings.STS.L_MDYDATE_Text;break;case"DMY":c=String(this.dateStart.getUTCDate());d=this.rgMonths(this.dateStart.getUTCMonth());e=String(this.dateStart.getUTCFullYear());if(j)a=Strings.STS.L_DMYDATE_Text;else a=Strings.STS.L_DMYDATESameYear_Text;f=String(this.dateEnd.getUTCDate());g=this.rgMonths(this.dateEnd.getUTCMonth());h=String(this.dateEnd.getUTCFullYear());b=Strings.STS.L_DMYDATE_Text;break;case"YMD":c=String(this.dateStart.getUTCFullYear());d=this.rgMonths(this.dateStart.getUTCMonth());e=String(this.dateStart.getUTCDate());if(j)a=Strings.STS.L_YMDDATE_Text;else a=Strings.STS.L_YMDDATESameYear_Text;f=String(this.dateEnd.getUTCFullYear());g=this.rgMonths(this.dateEnd.getUTCMonth());h=String(this.dateEnd.getUTCDate());b=Strings.STS.L_YMDDATE_Text}k=StBuildParam(a,[c,d,e]);l=StBuildParam(b,[f,g,h]);i+=StBuildParam(Strings.STS.L_DATE1DATE2_Text,[k,l]);if(this.iperiod!=0)i+="</span>";return i}function CalStDayMonthYear(){a:;var e="";e+='<span style="cursor:pointer;" onmouseover="HighlightText(this, \'red\');" onmouseout="HighlightText(this, \'\');"'+StClickEvent(this.stObject+".MoveMonth(0)")+">";var a="",b="",c="",d="",f=this.rgDOWLong(this.dow);switch(this.dopt.stDateOrder){case"MDY":b=this.rgMonths(this.mon);c=String(this.day);d=String(this.yr);a=Strings.STS.L_MDY_DOW_DATE_Text;break;case"DMY":b=String(this.day);c=this.rgMonths(this.mon);d=String(this.yr);a=Strings.STS.L_DMY_DOW_DATE_Text;break;case"YMD":b=String(this.yr);c=this.rgMonths[this.mon];d=String(this.day);a=Strings.STS.L_YMD_DOW_DATE_Text}e+=StBuildParam(a,[b,c,d,f]);e+="</span>";return e}function CalSetDate(d,c,e){a:;var a=new Date(Date.UTC(d,c,e));this.dateStart=new Date(a.getTime());this.dateEnd=new Date(a.getTime());this.givenDate=new Date(a.getTime());if(this.iperiod==0){this.dateStart.setUTCDate(1);this.dateEnd.setTime(Date.UTC(d,c+1,0))}var b=0;if(this.iperiod!=2){this.dateStart.setUTCDate(this.dateStart.getUTCDate()-(this.dateStart.getUTCDay()-this.dopt.dow+7)%7);b=this.IrwFromDate(this.dateEnd);this.dateEnd.setUTCDate(this.dateEnd.getUTCDate()+b*7-1)}this.irwMax=b+1;if(this.iperiod==1){this.dateEnd.setTime(this.dateStart.getTime()+6*Calendar.msDay);a=new Date(this.dateStart.getTime()+3*Calendar.msDay)}else if(this.iperiod==2)this.dateTodayEnd=new Date(this.dateStart.getTime()+Calendar.msDay-1);this.day=a.getUTCDate();this.mon=a.getUTCMonth();this.yr=a.getUTCFullYear();this.dow=a.getUTCDay()}function CalDayStyle(b,d,f,e){var a,c=this.dopt.Today();if(b.getTime()==c.getTime())if(d)a=" style=\"border-color:'#FFD275'; border-bottom-style:solid; border-left-style:solid; border-right-style:solid; border-bottom-width:2pt; border-left-width:2pt; border-right-width:2pt\" ";else if(f)a=" style=\"border-color:'#FFD275'; border-top-style:solid; border-left-style:solid; border-right-style:solid; border-top-width:2pt; border-left-width:2pt; border-right-width:2pt\" ";else a=" style=\"border-color:'#FFD275'; border-left-style:solid; border-right-style:solid; border-left-width:2pt; border-right-width:2pt\" ";else if(!e&&b.getUTCMonth()!=this.mon)a=' BGCOLOR="#e6e6e6"';else a="";return a}function CalAddFullEvent(e,g,i,l,k,h,j){var a,b;if(e=="")return;a=DateOptions.ParseISODate(e,undefined);if(g=="")b=new Date(a.getTime());else b=DateOptions.ParseISODate(g,undefined);if(Number(b)<Number(a))b=new Date(a.getTime());var c=new Date(a.getTime()),d=new Date(b.getTime());if(this.iperiod==2){if(Number(a)>Number(this.dateTodayEnd)||Number(b)<Number(this.dateStart))return;if(Number(c)<Number(this.dateStart))c=this.dateStart;var f=Calendar.msHour/3;if(b.getTime()<a.getTime()+f)d=new Date(a.getTime()+f)}h+="&Source="+escapeProperly(window.location.href);var m=new CalEvent(c,d,a,b,i,l,k,h,j);this.AddEvent(m)}function CalAddEvent(a){a:;this.rgEvt[String(this.ievtMax++)]=a}function CalAssignChannels(){a:;var d;this.mpSpan={};this.mpIchan={};this.mpEvents={};var n=false,g,h,a;if(this.iperiod==2){n=true;g=this.dateStart;h=this.dateTodayEnd;this.mpNoTimeEvents=[];this.mpAllDayEvents=[];var k=this.dopt.WorkDayStartHour-this.dopt.DailyStartHourDelta,l=this.dopt.WorkDayEndHour+this.dopt.DailyEndHourDelta;if(k<0)k=0;if(l>24)l=24;this.minQuarterStart=4*k;this.maxQuarterEnd=4*l-1;for(d=0;d<this.rgEvt.length;d++){a=this.rgEvt[String(d)];if(Number(a.actualDateStart)>Number(h)||Number(a.actualDateEnd)-1<Number(g)||Number(a.actualDateStart)<=Number(g)&&Number(a.actualDateEnd)>=Number(h))continue;var c=this.IrwFromDate(a.dateStart);if(c<0)c=0;var b=this.IrwFromDate(a.dateEnd);if(b>this.irwMax)b=this.irwMax;if(c<this.irwMax&&b>=0)for(var e=c;e<=b;e++){var j=new Date;this.SetDateFromGrid(j,e,0);if(Number(j)<Number(g)||Number(j)>=Number(h))continue;var p=j.getTime()/(Calendar.msHour/4),f=MsFloorTime(a.dateStart,Calendar.msHour/4,Boolean(0))/(Calendar.msHour/4)-p,i=MsFloorTime(a.dateEnd,Calendar.msHour/4,Boolean(1))/(Calendar.msHour/4)-p+1;if(i<f)i=f;if(f<this.minQuarterStart)this.minQuarterStart=f;if(i>this.maxQuarterEnd)this.maxQuarterEnd=i;if(f>0&&95-f<2)this.FVdayOverflow=true}}this.minQuarterStart=Math.floor(this.minQuarterStart/4)*4;if(this.minQuarterStart<0)this.minQuarterStart=0;if(this.maxQuarterEnd>95)this.maxQuarterEnd=95;else this.maxQuarterEnd=4*(Math.floor(this.maxQuarterEnd/4)+1)-1}this.iperiod<=1&&this.rgEvt.sort(CalEvtSort);var m=this.dateStart;m.setUTCHours(0,0,0,0);var o=m.getTime();for(d=0;d<this.rgEvt.length;d++){a=this.rgEvt[String(d)];if(n){if(a.actualDateStart.getTime()==o&&a.actualDateEnd.getTime()==o){this.mpNoTimeEvents[this.mpNoTimeEvents.length]=a;continue}if(Number(a.actualDateStart)<=Number(g)&&Number(a.actualDateEnd)>=Number(h)){this.mpAllDayEvents[this.mpAllDayEvents.length]=a;continue}}c=this.IrwFromDate(a.dateStart);if(c<0)c=0;b=this.IrwFromDate(a.dateEnd);if(b>this.irwMax)b=this.irwMax;if(c<this.irwMax&&b>=0)for(e=c;e<=b;e++)this.PlaceEventInRow(a,e)}}function CalEvtSort(a,b){if(a.multiDay!=b.multiDay)return a.multiDay?-1:1;else if(a.multiDay){var c=Number(a.dateEnd)-Number(a.dateStart),d=Number(b.dateEnd)-Number(b.dateStart);return d<c?-1:d>c?1:0}else return Number(a.dateStart)<Number(b.dateStart)?-1:Number(a.dateStart)>Number(b.dateStart)?1:0}function CalPlaceEventInRow(c,f){var m,k=new Date;this.SetDateFromGrid(k,f,0);if(this.iperiod==2){if(f!=0)return;var l=k.getTime()/(Calendar.msHour/4),d=MsFloorTime(c.dateStart,Calendar.msHour/4,Boolean(0))/(Calendar.msHour/4)-l,e=MsFloorTime(c.dateEnd,Calendar.msHour/4,Boolean(1))/(Calendar.msHour/4)-l;if(e<d)e=d;var h,g;if(this.iperiod==2){h=this.minQuarterStart;g=this.maxQuarterEnd}else{h=4*this.dopt.WorkDayStartHour;g=4*this.dopt.WorkDayEndHour-1}if(e>=h&&d<=g){if(this.FVdayOverflow)g=99;d=Math.max(d,h);e=Math.min(e,g);var j=this.IchanNext(f,d,e);new Span(this,f,d,e,j,c)}}else{var i,a,b;i=k.getTime()/Calendar.msDay;a=MsFloorTime(c.dateStart,Calendar.msDay,Boolean(0))/Calendar.msDay-i;b=MsFloorTime(c.dateEnd,Calendar.msDay,Boolean(1))/Calendar.msDay-i;if(b<a||c.actualDateEnd.getTime()-c.actualDateStart.getTime()<Calendar.msDay)b=a;if(b>=0&&a<=6){a=Math.max(a,0);b=Math.min(b,6);j=this.IchanNext(f,a,b);new Span(this,f,a,b,j,c)}}}function Span(a,f,b,i,h,e){this.evt=e;this.cbucket=i-b+1;if(a.iperiod==2){e.ichan=h;e.ihour=b;var g=a.maxQuarterEnd;if(g==95)g=99;e.rowspan=Math.min(this.cbucket,1+g-b)}a.mpSpan[String(f)+"."+String(b)+"."+String(h)]=this;for(var c=b;c<=i;c++){a.mpIchan[String(f)+"."+String(c)]=h+1;var d=a.mpEvents[String(f)+"."+String(c)];if(d==null){d=[];a.mpEvents[String(f)+"."+String(c)]=d}d[d.length]=e}}function CalIchanNext(c,d,e){a:;for(var b=0,a=d;a<=e;a++)if(this.mpIchan[String(c)+"."+String(a)]!=null)b=Math.max(b,this.mpIchan[String(c)+"."+String(a)]);return b}function CalIrwFromDate(b){var a;a=Math.floor((b.getTime()-this.dateStart.getTime())/Calendar.msWeek);return a}function CalBuildUI(){a:;var a=this.StBuild();document.write(a)}function CalStBuild(){a:;this.AssignChannels();return this.fDatePicker?this.StBuildPicker():!this.fUseDHTML?this.StDownlevelBuild():this.StBuildDHTML()}function CalStBuildDHTML(){a:;var a,e,h=new Date,m,d,c,f,b,u,o,F,G,j;u=F=4*this.dopt.WorkDayStartHour;o=4*this.dopt.WorkDayEndHour;G=o-1;if(this.iperiod==2){u=this.minQuarterStart;o=this.maxQuarterEnd+1;if(o==96&&this.FVdayOverflow)o=100}var A='<th style="cursor:pointer;" onmouseover="HighlightText(this, \'red\');" onmouseout="HighlightText(this, \'\');" ';if(this.iperiod==2){f=this.IchanNext(0,u,o);var y=this.mpNoTimeEvents.length,x=this.mpAllDayEvents.length;f=Math.max(f,this.cchanMin);if(this.cchanMax>0)f=Math.min(f,this.cchanMax);a="<table width='100%' class='ms-cal' cellpadding='0' cellspacing='0'>";a+="<tr>"+A+StClickEvent(this.stObject+".MoveDate(-1)")+' class="ms-calhead" style="cursor:pointer;" width="8%">&lt;</th><th width="84%" class="ms-calhead" nowrap>'+this.StDayMonthYear()+"</th>"+A+StClickEvent(this.stObject+".MoveDate(1)")+' class="ms-calhead" style="cursor:pointer;" width="8%">&gt;</th></tr>';if(y>0){a+="</table><table width='100%' class='ms-cal' cellpadding='0' cellspacing='0'>\r";a+="<tr height='0'><td width='"+String(Number(this.dopt.AllDayWidth)+8)+"pt' /><td/></tr>\r";a+="<tr><td class='ms-CalAllDay' rowspan='"+String(y+1)+"'></td><td width='1%' /></tr>";for(i=0;i<y;i++){j=this.mpNoTimeEvents[i];a+="<tr><td class='ms-Vapptsingle' style='border-top:1px solid black; border-left:1px solid black; border-bottom:1px solid black; border-right:1px solid black;' ";a+=" title="+StAttrQuote(j.StTip(this.dopt))+"><nobr>"+StRenderVDayEvt(j,this.dopt,2)+"</nobr></td></tr>\r"}}if(x>0){a+="</table><table width='100%' class='ms-cal' cellpadding='0' cellspacing='0'>\r";a+="<tr height='0'><td width='"+String(Number(this.dopt.AllDayWidth)+8)+"pt' /><td/></tr>\r";a+="<tr><td class='ms-CalAllDay' rowspan='"+String(x+1)+"'>"+this.dopt.L_AllDay_Text+"</td><td width='1%'/></tr>";for(var i=0;i<x;i++){j=this.mpAllDayEvents[i];a+="<tr><td class='ms-Vapptsingle' style='border-top:1px solid black; border-left:1px solid black; border-bottom:1px solid black; border-right:1px solid black;' ";a+=" title="+StAttrQuote(j.StTip(this.dopt))+"><nobr>"+StRenderVDayEvt(j,this.dopt,2)+"</nobr></td></tr>\r"}}a+="</table><table width='100%' style='table-layout:fixed' class='ms-vcal' cellpadding='0' cellspacing='0'>\r";a+="<tr height='0'><td width='"+String(this.dopt.AllDayWidth)+"pt' /><td width='8pt' />\r";for(c=1;c<f;c++)a+="<td/>\r";a+="</tr>\r";var w={},n=new Array(o);for(b=u;b<o;b++){n[b]=0;for(c=0;c<f;c++)w[String(b)+"."+String(c)]=0}for(i=0;i<this.rgEvt.length;i++){j=this.rgEvt[i];b=j.ihour;c=j.ichan;var q=j.rowspan,l=c+1;for(g=0;g<q;g++)if(n[b+g]>l)l=n[b+g];for(g=0;g<q;g++){n[b+g]=l;w[String(b+g)+"."+String(c)]=1}}for(i=0;i<this.rgEvt.length;i++){var M=0,g=0;j=this.rgEvt[i];b=j.ihour;l=n[b];q=j.rowspan;var t=0,E=false;for(g=1;g<q;g++){t=n[b+g];E=E||t!=l;if(t>l)l=t}if(!E)continue;for(g=0;g<q;g++)n[b+g]=l}for(i=this.rgEvt.length-1;i>=0;i--){var L=0,s=0;j=this.rgEvt[i];b=j.ihour;l=n[b];q=j.rowspan;var N=0,D=false;for(s=1;s<q;s++){t=n[b+s];D=D||t!=l;if(t>l)l=t}if(!D)continue;for(s=0;s<q;s++)n[b+s]=l}for(b=u;b<o;b++){a+="<tr>\r";if(b%4==0){var r=String(b/4);if(r=="24")r="&nbsp;";else if(this.dopt.f12Hour){r=String((b/4+11)%12+1);if(this.dopt.TimeMarkPosn==0)r+=" "+(b/4<12?this.dopt.stAM:this.dopt.stPM);else r=(b/4<12?this.dopt.stAM:this.dopt.stPM)+" "+r}var k="";if(b<F||b>G)k=' BGCOLOR="#e6e6e6" ';if(b!=u||x>0||y>0){a+="<td class='ms-CalHour' rowspan='2'"+k+"><nobr>"+r+"</nobr></td>";a+="<td class='ms-calHour'"+k+">&nbsp;</td>\r"}else{a+="<td class='ms-firstCalHour' rowspan='2'"+k+"><nobr>"+r+"</nobr></td>";a+="<td class='ms-firstCalHour'"+k+">&nbsp;</td>\r"}}else if(b%2==0){a+="<td class='ms-CalHalfHour'"+k+">&nbsp;</td>\r";a+="<td class='ms-calHalfHour'"+k+">&nbsp;</td>\r"}else if(b%4==1)a+="<td class='ms-CalQuarterHour'"+k+">&nbsp;</td>\r";else if(b%4==3){a+="<td class='ms-CalQuarterHour'"+k+">&nbsp;</td>\r";a+="<td class='ms-calQuarterHour'"+k+">&nbsp;</td>\r"}for(c=0;c<f;c++){e=this.mpSpan["0."+String(b)+"."+String(c)];if(e!=null){var K="ms-Vappt",I=e.evt.rowspan,v=Math.floor(f/n[b]);if(v>f/this.cchanMin)v=Math.floor(f/this.cchanMin);var z=v-1;if(z>0)for(g=0;g<I;g++){z=v-1;for(var B=f-1;B>c&&z>0;B--)if(w[String(b+g)+"."+String(B)]==0){w[String(b+g)+"."+String(B)]=1;z--}}a+="<td class="+K+" style='border-top:1px solid black; border-left:1px solid black; border-bottom:2px solid black; border-right:2px solid black;' rowspan="+String(e.evt.rowspan);if(v>1)a+=" colspan="+String(v);a+=" title="+StAttrQuote(e.evt.StTip(this.dopt))+"><nobr>"+StRenderVDayEvt(e.evt,this.dopt,e.evt.rowspan)+"</nobr></td>\r"}else if(w[String(b)+"."+String(c)]==0)if(b%4==0)if(b!=u||x>0||y>0)a+="<td class='ms-calHour'"+k+">&nbsp;</td>\r";else a+="<td class='ms-firstCalHour'"+k+">&nbsp;</td>\r";else if(b%2==0)a+="<td class='ms-calHalfHour'"+k+">&nbsp;</td>\r";else a+="<td class='ms-calQuarterHour'"+k+">&nbsp;</td>\r"}a+="</tr>\r"}a+="<tr>\r";for(c=-2;c<f;c++)a+="<td class='ms-CalHour'>&nbsp;</td>\r";a+="</tr>\r"}else{var p=this.iperiod==1;a="<table width='100%' class='ms-cal' cellpadding='0' cellspacing='0'>";a+="<tr>"+A+StClickEvent(this.stObject+".MoveDate(-1)")+' class="ms-calhead" style="cursor:pointer;">&lt;</td><td class="ms-calhead" colspan="5">';if(this.iperiod==0)a+=this.StMonthYear();else a+=this.StDaySpanMonthYear();a+="</td>"+A+StClickEvent(this.stObject+".MoveDate(1)")+' class="ms-calhead" style="cursor:pointer;">&gt;</td></tr>';a+="<tr>\r";for(d=0;d<7;d++)a+="<td class='ms-calDOW'>"+this.rgDOW((d+this.dopt.dow)%7)+"</td>\r";a+="</tr>";for(m=0;m<this.irwMax;m++){f=Math.max(this.IchanNext(m,0,6),this.cchanMin);if(this.cchanMax>0)f=Math.min(f,this.cchanMax);a+="<tr>\r";for(d=0;d<7;d++){this.SetDateFromGrid(h,m,d);a+='<td class="ms-calTop"'+this.DayStyle(h,false,true,p)+'>&nbsp;<span style="cursor:pointer;" onmouseover="HighlightText(this, \'red\');" onmouseout="HighlightText(this, \'\');"'+StClickEvent(this.stObject+".MoveToDay("+String(h.getUTCFullYear())+","+String(h.getUTCMonth()+1)+","+String(h.getUTCDate())+")")+">"+String(h.getUTCDate())+"</span>&nbsp;</td>\r"}a+="</tr>\r";for(c=0;c<f;c++){if(this.iperiod==1){a+="<tr>\r";for(d=0;d<7;d++){this.SetDateFromGrid(h,m,d);if(c==f-1&&this.SpanCheck(m,d,c,f))a+="<td class='ms-apptsingle' "+this.DayStyle(h,false,false,p)+">&nbsp;</td>";else{e=this.mpSpan[String(m)+"."+String(d)+"."+String(c)];if(e!=null&&!e.evt.multiDay&&0!=e.evt.actualDateStart.getTime()%Calendar.msDay&&0!=e.evt.actualDateEnd.getTime()%Calendar.msDay){var J="ms-apptsingle"+this.DayStyle(h,false,false,p);a+="<td class="+J+" colspan="+String(e.cbucket)+" title="+StAttrQuote(e.evt.StTip(this.dopt))+"><nobr>";a+=StEvtTime(e.evt,this.dopt,true);a+="&nbsp;</nobr></td>\r";d+=e.cbucket-1}else a+="<td class='ms-calMid'"+this.DayStyle(h,false,false,p)+">&nbsp;</td>\r"}}a+="</tr>\r"}a+="<tr>\r";for(d=0;d<7;d++){this.SetDateFromGrid(h,m,d);if(c==f-1&&this.SpanCheck(m,d,c,f))a+="<td class='ms-apptsingle' "+this.DayStyle(h,false,false,p)+'><span style="cursor:pointer;" onmouseover="HighlightText(this, \'red\');" onmouseout="HighlightText(this, \'\');"'+StClickEvent(this.stObject+".MoveToDay("+String(h.getUTCFullYear())+","+String(h.getUTCMonth()+1)+","+String(h.getUTCDate())+")")+">"+this.dopt.L_More_Text+"</span></td>\r";else{e=this.mpSpan[String(m)+"."+String(d)+"."+String(c)];if(e!=null){var H="ms-appt";if(!e.evt.multiDay)H="ms-apptsingle"+this.DayStyle(h,false,false,p);a+="<td class="+H+" colspan="+String(e.cbucket)+" title="+StAttrQuote(e.evt.StTip(this.dopt))+"><nobr>"+StURL(e.evt.stURL,e.evt.stTitle)+"</nobr></td>\r";d+=e.cbucket-1}else a+="<td class='ms-calMid'"+this.DayStyle(h,false,false,p)+">&nbsp;</td>\r"}}a+="</tr>\r";a+="<tr>\r";var C;if(c==f-1)C="ms-CalBot";else C="ms-CalSpacer";for(d=0;d<7;d++){this.SetDateFromGrid(h,m,d);a+="<td class="+C+this.DayStyle(h,c==f-1,false,p)+">&nbsp;</td>\r"}a+="</tr>\r"}}}a+="</table>";return a}function CalSpanCheck(e,a,g,f){a:;var d,b,c;if(this.IchanNext(e,a,a)>f)return true;d=this.mpSpan[String(e)+"."+String(a)+"."+String(g)];if(d!=null){c=d.cbucket+a;if(c>7)c=7;for(b=a+1;b<c;b++)if(this.IchanNext(e,b,b)>f)return true}return false}function StRenderVDayEvt(a,g,f){var b="";b+="<table height='12px' border='0' cellpadding='0' cellspacing='0' style='border-collapse: collapse; padding-right:6px' ><tr>";if(Boolean(a.rgIcons)&&Boolean(a.rgIcons.length)){var d,c,e=true;for(d in a.rgIcons){c=a.rgIcons[d];if(Boolean(c)&&c.indexOf("blank.gif")<0){e=false;break}}if(!e){b+="<td valign='top' nowrap>";for(d in a.rgIcons){c=a.rgIcons[d];if(Boolean(c)&&Boolean(c.length))b+=a.rgIcons[d]}b+="</td>"}}b+="<td nowrap>"+StURL(a.stURL,a.stTitle)+"</td></tr></table>";if(f>2)b+="<nobr>"+StEvtTime(a,g,false)+"</nobr>";if(f>3&&a.stLocation!=null)b+="<br><nobr>"+STSHtmlEncode(a.stLocation)+"</nobr>";return b}function StEvtTime(a,c,d){var b="";if(d)b+=c.StTime(a.actualDateStart);else b+=c.StBareTime(a.actualDateStart);if(a.actualDateStart.getTime()!=a.actualDateEnd.getTime()&&(MsFloorTime(a.actualDateStart,Calendar.msDay,Boolean(0))==MsFloorTime(a.actualDateEnd,Calendar.msDay,Boolean(0))||a.actualDateEnd.getTime()-a.actualDateStart.getTime()<Calendar.msDay)){b+=" - ";if(d)b+=c.StTime(a.actualDateEnd);else b+=c.StBareTime(a.actualDateEnd)}return b}function StClickEvent(a){a:;return'onclick="'+a+'" ondblclick="'+a+'"'}function CalStBuildPicker(){a:;var a,c=new Date,d=this.dopt.Today(),f,b,p,e;a='<table ONSELECTSTART="return false;" class="ms-datepicker" cellpadding="2" cellspacing="0" border="1">\r';var i="<td style=\"cursor:pointer;\" onmouseover=\"Highlight(this, 'yellow', 'black');\" onmouseout=\"Highlight(this, '', '');\" ";a+="<tr>"+i+StClickEvent(this.stObject+".MoveMonth(-1)")+' class="ms-dpnextprev">&lt;</td><td class="ms-dphead" colspan="5">'+this.StMonthYear()+"</td>"+i+StClickEvent(this.stObject+".MoveMonth(1)")+' class="ms-dpnextprev">&gt;</td></tr>';a+="<tr>\r";for(b=0;b<7;b++)a+='<td class="ms-dpdow" height="20" width="14%">&nbsp;'+this.rgDOWDP((b+this.dopt.dow)%7)+"&nbsp;</td>\r";a+="</tr>\r";for(f=0;f<this.irwMax;f++){a+="<tr>\r";for(b=0;b<7;b++){this.SetDateFromGrid(c,f,b);var h=this.mpEvents[String(f)+"."+String(b)],g=h!=null,o=c.getUTCFullYear(),n=c.getUTCMonth(),m=c.getUTCDate();a+=i+StClickEvent(this.stObject+".ClickDay("+String(o)+","+String(n)+","+String(m)+")");if(g){var j="";for(e=0;e<h.length;e++){var l=h[String(e)];j+=l.StTip(this.dopt);if(e<h.length-1)j+="\r"}a+=" title="+StAttrQuote(j)}a+=' width="14%"'+this.DPDayStyle(c,g)+">&nbsp;"+(g?"<b>":"")+String(c.getUTCDate())+(g?"</b>":"")+(c.getTime()==d.getTime()?"<font color='red'>"+Strings.STS.L_LittleRedDiamond_TXT+"</font>":"&nbsp;");a+="</td>\r"}a+="</tr>\r"}var k="<a href='javascript:"+this.stObject+".SetDate("+String(d.getUTCFullYear())+","+String(d.getUTCMonth())+","+String(d.getUTCDate())+");'>"+this.dopt.StDate(d)+"</a>";a+="<tr><td class='ms-DPFoot' colspan='7'><font color='red'>"+Strings.STS.L_LittleRedDiamond_TXT+"</font>"+StBuildParam(Strings.STS.L_TodaysDate_Text,[k])+"</td></tr>";a+="</table>";return a}function CalMoveDate(a){a:;if(this.iperiod==2)this.MoveVDay(a);else if(this.iperiod==1)this.MoveWeek(a);else this.MoveMonth(a)}function CalMoveMonth(c){var a,b=this.givenDate.getUTCFullYear()*12+this.givenDate.getUTCMonth()+c,d=Math.floor(b/12);b=b%12;if(c!=0)a=StURLSetVar("CalendarDate",String(d)+"-"+St2Digits(b+1)+"-1");else a=StURLSetVar("CalendarDate",String(d)+"-"+St2Digits(b+1)+"-"+String(this.givenDate.getUTCDate()));a=StURLSetVar2(a,"CalendarPeriod","month");this.Post(a)}function CalMoveWeek(c){var a,b=this.givenDate;b.setUTCDate(this.givenDate.getUTCDate()+7*c);a=StURLSetVar("CalendarDate",String(b.getUTCFullYear())+"-"+St2Digits(b.getUTCMonth()+1)+"-"+String(b.getUTCDate()));a=StURLSetVar2(a,"CalendarPeriod","week");this.Post(a)}function CalMoveDay(c){a:;var a,b=this.givenDate;b.setUTCDate(this.givenDate.getUTCDate()+c);a=StURLSetVar("CalendarDate",String(b.getUTCFullYear())+"-"+St2Digits(b.getUTCMonth()+1)+"-"+String(b.getUTCDate()));a=StURLSetVar2(a,"CalendarPeriod","day");this.Post(a)}function CalMoveToDay(d,c,b){a:;var a;a=StURLSetVar("CalendarDate",d+"-"+St2Digits(c)+"-"+b);a=StURLSetVar2(a,"CalendarPeriod","day");this.Post(a)}function CalMoveToToday(){a:;var a=this.dopt.Today(),b=StURLSetVar("CalendarDate",String(a.getUTCFullYear())+"-"+St2Digits(a.getUTCMonth()+1)+"-"+String(a.getUTCDate()));this.Post(b)}function CalDoPost(a){a:;if(Boolean(this.stViewID)&&Boolean(this.stViewID.length))a=StURLSetVar2(a,"View",this.stViewID);SubmitFormPost(a,undefined,undefined)}function EditSeries(c){a:;var b="";if(Boolean(c))b=StSearchVar(c,"ID");else b=StURLGetVar("ID");if(Boolean(b.length)){var d=b.indexOf(".0.");if(d>0){var a="";if(Boolean(c)){a=window.location.href;var e=a.indexOf("?");if(e>0)c+=a.substring(e,a.length);a=StURLSetVar2(c,"ID",b.substr(0,d))}else a=StURLSetVar("ID",b.substr(0,d));window.location.href=a}}}function EditSeriesID(b,c){if(Boolean(b.length)){var a="";if(Boolean(c)){a=window.location.href;var d=a.indexOf("?");if(d>0)c+=a.substring(d,a.length);a=StURLSetVar2(c,"ID",b)}else a=StURLSetVar("ID",b);window.location.href=a}}function StURLSetVar(b,a){a:;return StURLSetVar2(window.location.href,b,a)}function StViewURLSetVar(c,e,d){a:;var a=window.location.href,b=a.lastIndexOf("/");if(b>0)a=a.substring(0,b+1)+c;return StURLSetVar2(a,e,d)}function StURLGetVar(b){a:;var a=location.href;return StSearchVar(a,b)}function StSearchVar(b,d){var f=new RegExp("[?&]"+d+"=","g"),a=b.search(f);if(a==-1)return"";a+=d.length+2;var c=b.indexOf("&",a+1);if(c==-1)c=b.length;var e=b.substring(a,c);return e}function HighlightText(a,b){if(b!=""){a.colorTextSav=a.style.color;a.style.color=b}else a.style.color=a.colorTextSav}function Highlight(a,b,c){if(b!=""){a.colorBackSav=a.style.backgroundColor;a.colorTextSav=a.style.color;a.style.backgroundColor=b;a.style.color=c}else{a.style.backgroundColor=a.colorBackSav;a.style.color=a.colorTextSav}}function CalDPDayStyle(b,c){var a="";if(b.getTime()==this.dateDP.getTime())a+=" class=ms-dpselectedday";else if(b.getUTCMonth()!=this.mon)a+=" class=ms-dpnonmonth";else a+=" class=ms-dpday";if(c)a+=' style:"font-weight: bold;"';return a}function CalStDownlevelBuild(){a:;var a,e=new Date,c,b,h,d;a='<table cellpadding="2" cellspacing="0" width="100%" border="1">\r';a+='<tr><td class="ms-calhead"><a class="ms-calhead" target="_self" href="javascript:'+this.stObject+'.MoveDate(-1);"><b>&lt;</b></a></td><td class="ms-calhead" colspan="5">'+this.StMonthYear()+'</td><td class="ms-calhead"><a class="ms-calhead" target="_self" href="javascript:'+this.stObject+'.MoveDate(1);"><b>&gt;</b></a></td></tr>';a+="<tr>\r";for(b=0;b<7;b++)a+='<td class="ms-calDOWDown" height="20" width="14%">&nbsp;'+this.rgDOW((b+this.dopt.dow)%7)+"&nbsp;</td>\r";a+="</tr>\r";for(c=0;c<this.irwMax;c++){a+="<tr>\r";for(b=0;b<7;b++){this.SetDateFromGrid(e,c,b);a+='<td class="ms-calDown" height="80" width="14%"'+this.DayStyle(e)+">&nbsp;"+String(e.getUTCDate())+"&nbsp;<br>\r";var f=this.mpEvents[String(c)+"."+String(b)];if(f!=null)for(d=0;d<f.length;d++){var g=f[String(d)];a+=StURL(g.stURL,g.stTitle)+"<br>\r"}a+="</td>"}a+="</tr>\r"}a+="</table>";return a}function CalSetDateFromGrid(a,c,b){a.setTime(this.dateStart.getTime()+c*Calendar.msWeek+b*Calendar.msDay)}function CalEvent(a,b,c,d,h,l,e,m,j){this.dateStart=a;this.dateEnd=b;this.actualDateStart=c;this.actualDateEnd=d;this.stLocation=h;this.stDesc=l;this.stTitle=e;if(e.length==0)this.stTitle=Strings.STS.L_NoTitle_Text;this.stURL=m;this.rgIcons=j;var i=MsFloorTime(a,Calendar.msDay,Boolean(0)),k=MsFloorTime(b,Calendar.msDay,Boolean(1));if(Number(i)<Number(k)&&d.getTime()-c.getTime()>=Calendar.msDay)this.multiDay=true;else this.multiDay=false;var f=MsFloorTime(a,Calendar.msHour/4,Boolean(0)),g=MsFloorTime(b,Calendar.msHour/4,Boolean(1));if(f<g)this.multiQuarter=true}function EvtFOverlap(a){return Number(a.dateStart)<=Number(this.dateEnd)&&Number(a.dateEnd)>=Number(this.dateStart)}function EvtStTip(c){a:;var a,b=StEvtTime(this,c,true);if(DateOptions.FHasTime(this.actualDateStart)||DateOptions.FHasTime(this.actualDateEnd))a=StBuildParam(Strings.STS.L_Tip_Text,[b,this.stTitle]);else a=this.stTitle;if(!FBlankString(this.stLocation))a+="\r"+this.stLocation;if(!FBlankString(this.stDesc))a+="\r"+this.stDesc;return a}function DiscussionBoard(b,a){a:;this.id=a;this.name="board"+a;this.rootPosts=[];this.allPosts=[];this.lastInsert=0;this.lastNode=null;this.expanded=false;this.threaded=b;this.initialized=false;this.widgetBaseSrc=null;this.init=function(){a:;this.mainTable=document.getElementById(this.id);var a=this.mainTable.getElementsByTagName("A");if(this.threaded){for(var c=0;c<a.length;c++)a[c].name=="post"&&this.insert(new Post(a[c],this));this.setReplyCountAndIndent()}else for(var b=0;b<a.length;b++)a[b].name=="post"&&this.allPosts.push(new Post(a[b],this));this.initialized=true};this.setReplyCountAndIndent=function(){a:;for(var b,a=0;a<this.rootPosts.length;a++){b=this.rootPosts[a];b.setReplyCountAndIndent(true)}};this.insert=function(a){for(var b,c=this.lastInsert;c<this.rootPosts.length;c++){b=this.rootPosts[c];if(a.id.indexOf(b.id)==0&&a.id!=b.id){a.hide();return b.insert(a)}else this.lastInsert++}this.rootPosts.push(a);return undefined};this.retrieve=function(e,f){if(this.threaded)for(var c,g,d=0;d<this.rootPosts.length;d++){c=this.rootPosts[d];if(e.indexOf(c.id)==0)if((g=c.retrieve(e,f))!=-1)return g}else for(var a,b=0;b<this.allPosts.length;b++){a=this.allPosts[b];if(e==a.id&&f==a.guid)return a}return-1};this.expandCollapse=function(){a:;if(!this.initialized)return false;if(this.expanded){for(var d,b=0;b<this.rootPosts.length;b++){d=this.rootPosts[b];d.hideTextAndChildren()}this.expanded=false}else{for(var c,a=0;a<this.rootPosts.length;a++){c=this.rootPosts[a];c.showTextAndChildren(true)}this.expanded=true}return};this.handleClicks=function(a){if(!this.initialized)return true;a=a?a:window.event?window.event:Event("");if(Boolean(a)){var b;if(Boolean(a.target))b=a.target;else b=a.srcElement;if(a.type=="keydown")if(String.fromCharCode(a.keyCode)=="\r")b=b.firstChild;else return true;if(Boolean(b))if(Boolean(b.name)&&"widget"==b.name.valueOf()){var e=b.getAttribute("src");if(Boolean(e)){var g=e.lastIndexOf("/"),d=e.slice(g+1);if(d.valueOf()=="discbul.gif"||d.valueOf()!="plus.gif"&&d.valueOf()!="minus.gif")return true;var c,f;if(a.type=="click"||a.type=="keydown"){c=this.retrieve(b.id,b.parentNode.parentNode.parentNode.parentNode.parentNode.getAttribute("PostID"));this.lastNode=c;f=d.valueOf()=="plus.gif"?"expand":"collapse"}else if(a.type=="dblclick"){c=this.lastNode;f=d.valueOf()=="plus.gif"?"collapse":"expandRecursively"}switch(f){case"expand":if(this.threaded)c.showTextAndChildren(false);else c.showText();break;case"expandRecursively":if(this.threaded)c.showTextAndChildren(true);else c.showText();break;case"collapse":if(this.threaded){c.hideTextAndChildren();this.expanded=false}else c.hideText()}}}}return true}}function Post(a,d){this.board=d;this.depth=0;this.replyCount=0;this.lastInsert=0;this.childNodes=[];this.anchor=a;this.widget=a.firstChild;this.widgetPadding=this.widget.parentNode.parentNode;if(!Boolean(this.board.widgetBaseSrc)){var c=this.widget.getAttribute("src"),e=c.lastIndexOf("/");this.board.widgetBaseSrc=c.slice(0,e+1)}this.id=this.widget.id;this.guid=this.widgetPadding.parentNode.parentNode.parentNode.getAttribute("PostID");if(this.board.threaded){this.indent=a.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.firstChild;var b;if(browseris.ie&&!browseris.mac)b=this.indent.parentNode.childNodes[1].childNodes[1];else b=this.indent.parentNode.childNodes[1].childNodes[2];this.body=b;this.row=this.indent.parentNode.parentNode.parentNode.parentNode.parentNode;this.reply=this.row.childNodes[1];this.bodyPadding=this.body.firstChild.firstChild.firstChild;this.bodyPadding.setAttribute("width","8")}else this.body=a.parentNode.parentNode.parentNode.parentNode.parentNode.childNodes[1];this.insert=function(a){this.replyCount++;a.depth++;for(var b,c=this.lastInsert;c<this.childNodes.length;c++){b=this.childNodes[c];if(a.id.indexOf(b.id)==0&&a.id!=b.id)return b.insert(a);else this.lastInsert++}this.childNodes.push(a);return undefined};this.retrieve=function(e,c){for(var a,d,b=0;b<this.childNodes.length;b++){a=this.childNodes[b];if(e.indexOf(a.id)==0)if(Number(d=a.retrieve(e,c))!=-1)return d}return this.guid==c?this:-1};this.show=function(){a:;this.row.style.display=""};this.hide=function(){a:;this.row.style.display="none"};this.showTextThreaded=function(){a:;this.show();this.widget.src=this.board.widgetBaseSrc+"minus.gif";this.widget.alt=Strings.STS.L_strCollapse_Text;this.body.style.display=""};this.showText=function(){a:;this.widget.src=this.board.widgetBaseSrc+"minus.gif";this.widget.alt=Strings.STS.L_strCollapse_Text;this.body.style.display=""};this.hideText=function(){a:;this.widget.src=this.board.widgetBaseSrc+"plus.gif";this.widget.alt=Strings.STS.L_strExpand_Text;if(browseris.nav6)this.body.setAttribute("style","display: none");else this.body.style.display="none"};this.showTextAndChildren=function(e){a:;this.showTextThreaded();if(e)for(var d,b=0;b<this.childNodes.length;b++){d=this.childNodes[b];d.showTextAndChildren(e)}else for(var c,a=0;a<this.childNodes.length;a++){c=this.childNodes[a];c.show()}};this.hideTextAndChildren=function(){this.hideText();for(var a,b=0;b<this.childNodes.length;b++){a=this.childNodes[b];a.hide();a.hideTextAndChildren()}};this.setReplyCountAndIndent=function(c){a:;this.reply.innerHTML=this.replyCount;this.indent.setAttribute("width",String(this.depth*16));if(c)for(var b,a=0;a<this.childNodes.length;a++){b=this.childNodes[a];b.setReplyCountAndIndent(c)}};this.hideText();this.widget.parentNode.style.cursor="hand";this.widgetPadding.style.paddingTop="2px"}function St2Digits(b){a:;var a="";if(b<0)return a;if(b<10)a+="0";a+=String(b);return a}var g_fld;function BFormDocumentWrite(a){!("function"==typeof SPDocumentWrite&&SPDocumentWrite(a))&&document.write(a)}function DiscussionBoard_InitializePrototype(){a:;DiscussionBoard.prototype.threaded=undefined;DiscussionBoard.prototype.widgetBaseSrc=undefined;DiscussionBoard.prototype.insert=function(){};DiscussionBoard.prototype.setReplyCountAndIndent=function(){}}function Post_InitializePrototype(){a:;Post.prototype.body=undefined;Post.prototype.depth=undefined;Post.prototype.guid=undefined;Post.prototype.id=undefined;Post.prototype.hide=function(){};Post.prototype.hideText=function(){};Post.prototype.hideTextAndChildren=function(){};Post.prototype.insert=function(){};Post.prototype.retrieve=function(){};Post.prototype.setReplyCountAndIndent=function(){};Post.prototype.show=function(){};Post.prototype.showText=function(){};Post.prototype.showTextAndChildren=function(){}}function DateDecode_InitializePrototype(){a:;DateDecode.prototype.day=undefined;DateDecode.prototype.dow=undefined;DateDecode.prototype.yr=undefined;DateDecode.prototype.mon=undefined;DateDecode.prototype.hr=undefined;DateDecode.prototype.min=undefined;DateDecode.prototype.sec=undefined}function OWSForm_InitializePrototype(){a:;OWSForm.prototype={stName:undefined,stFieldPrefix:undefined,dopt:undefined,nopt:undefined,fUseDHTML:undefined,ifldMax:undefined,rgfld:undefined,stError:undefined,stImagesPath:undefined,stPagePath:undefined,dp:undefined,stInputStyle:undefined,stLongStyle:undefined,fPreviewMode:undefined,form:undefined,themeCSSurl:undefined,rgcts:undefined,rgctNames:undefined,wBaseType:undefined,ctIdToName:undefined,ctNameToId:undefined}}function DateField_InitializePrototype(){a:;DateField.prototype={fDateOnly:undefined,stAttributes:undefined,caltype:undefined,direction:undefined,stPopUpOnClick2:undefined,date:undefined,origDate:undefined,showDatePicker:undefined,stDisplay:undefined,stName:undefined,stValue:undefined,stPrefix:undefined,frm:undefined,fHideDateSpan:undefined,fHideDescription:undefined,fSkipValidation:undefined,fRequired:undefined,fFillInChoice:undefined,errFld:undefined,stError:undefined,disabled:undefined}}function Field_InitializePrototype(){a:;Field.prototype={frm:undefined,stName:undefined,stDisplay:undefined,stValue:undefined,fRequired:undefined,stError:undefined,stAttributes:undefined}}function DateOptions_InitializePrototype(){a:;DateOptions.prototype.stDateOrder=undefined;DateOptions.prototype.f12Hour=undefined;DateOptions.prototype.stAM=undefined;DateOptions.prototype.stPM=undefined;DateOptions.prototype.TimeMarkPosn=undefined;DateOptions.prototype.dminControl=undefined;DateOptions.prototype.chDateSep=undefined;DateOptions.prototype.chTimeSep=undefined;DateOptions.prototype.dyrWindow=undefined;DateOptions.prototype.dow=undefined;DateOptions.prototype.webTZOffsetMin=undefined;DateOptions.prototype.WorkDayStartHour=undefined;DateOptions.prototype.WorkDayEndHour=undefined;DateOptions.prototype.DailyStartHourDelta=undefined;DateOptions.prototype.DailyEndHourDelta=undefined;DateOptions.prototype.CalendarPeriod=undefined;DateOptions.prototype.L_AllDay_Text=undefined;DateOptions.prototype.AllDayWidth=undefined;DateOptions.prototype.L_More_Text=undefined}function URLField_InitializePrototype(){a:;URLField.prototype={frm:undefined,stName:undefined,stDisplay:undefined,stValue:undefined,fRequired:undefined,stError:undefined,stAttributes:undefined}}function NumberField_InitializePrototype(){a:;NumberField.prototype={frm:undefined,stName:undefined,stDisplay:undefined,stValue:undefined,fCalcCheck:undefined,fInteger:undefined,fRequired:undefined,stError:undefined,stAttributes:undefined,wMin:undefined,wMax:undefined}}function BooleanField_InitializePrototype(){a:;BooleanField.prototype={frm:undefined,stName:undefined,stDisplay:undefined,stValue:undefined,fRequired:undefined,stError:undefined,stAttributes:undefined}}function NoteField_InitializePrototype(){a:;NoteField.prototype={frm:undefined,stName:undefined,stDisplay:undefined,stValue:undefined,fRequired:undefined,stError:undefined,stAttributes:undefined,stNumLines:undefined,IMEMode:undefined}}function RichTextField_InitializePrototype(){a:;RichTextField.prototype={frm:undefined,stName:undefined,stDisplay:undefined,stValue:undefined,fRequired:undefined,stError:undefined,stAttributes:undefined,stNumLines:undefined,IMEMode:undefined,stDirection:undefined,fAllowHyperlink:undefined}}function TextField_InitializePrototype(){a:;TextField.prototype={frm:undefined,stName:undefined,stDisplay:undefined,stValue:undefined,fRequired:undefined,stError:undefined,stAttributes:undefined,stNumLines:undefined,IMEMode:undefined,cchMaxLength:undefined,cchDisplaySize:undefined}}function FilenameField_InitializePrototype(){a:;FilenameField.prototype={frm:undefined,stName:undefined,stDisplay:undefined,stValue:undefined,fRequired:undefined,stError:undefined,stAttributes:undefined,cchMaxLength:undefined,cchDisplaySize:undefined,isFileName:undefined,IMEMode:undefined}}function GridChoiceField_InitializePrototype(){a:;GridChoiceField.prototype={frm:undefined,stName:undefined,stDisplay:undefined,stValue:undefined,fRequired:undefined,stError:undefined,stAttributes:undefined,rgGridChoices:undefined,GridStartNum:undefined,GridEndNum:undefined,GridNATxt:undefined,GridTxtRng1:undefined,GridTxtRng2:undefined,GridTxtRng3:undefined,nochange:undefined}}function GridChoice(){}function GridChoice_InitializePrototype(){a:;GridChoice.prototype={stDisplay:undefined,stValue:undefined}}function ChoiceItem(){}function ChoiceItem_InitializePrototype(){a:;ChoiceItem.prototype={stDisplay:undefined,stValue:undefined,hasLayoutProc:undefined,stLayoutProc:undefined}}function ChoiceField_InitializePrototype(){a:;ChoiceField.prototype={frm:undefined,stName:undefined,stDisplay:undefined,stValue:undefined,fRequired:undefined,stError:undefined,stAttributes:undefined,rgChoices:undefined,format:undefined,fFillInChoice:undefined,fIncludeMouseDown:undefined,nobr:undefined,horizontal:undefined,horizontalBreakEvery:undefined,IMEMode:undefined,radioClass:undefined,tableClass:undefined,fldCtId:undefined}}function RecurrencePattern_InitializePrototype(){a:;RecurrencePattern.prototype={frm:undefined,stName:undefined,stDisplay:undefined,stValue:undefined,fRequired:undefined,stError:undefined,stAttributes:undefined,fSkipValidation:undefined,isModifyException:undefined,isNewModifyException:undefined,stStartDate:undefined,stEndDate:undefined,caltype:undefined,todayiso:undefined,stPrefix:undefined,iCustom:undefined,fDoCustom:undefined,rgStRecurType:undefined,ccRecurType:undefined,rgStRangeType:undefined,recurrencePatternChoice:undefined,monthlyChoiceValue:undefined,dateRangeEndChoice:undefined,dayFrequency:undefined,weekFrequency:undefined,monthFrequency1:undefined,monthFrequency2:undefined,weeklyDayMultiValue:undefined,monthly1DayValue:undefined,monthly2DayValue:undefined,monthly2WeekValue:undefined,dateRangeStart:undefined,dateRangeEnd:undefined,dateRangeEndOccurrences:undefined,stRecurrenceID:undefined,stUID:undefined,stRecurrenceDescription:undefined,dateRangeFldStart:undefined,dateRangeFldEnd:undefined,endRangeOptionFld:undefined,dateRangeFldEndOccurrances:undefined,dayFrequencyFld:undefined,weeklyFrequencyFld:undefined,weeklyMultiDayFld:undefined,monthlyChoiceFld:undefined,monthlyChoice1DayFld:undefined,monthlyChoice1MonthFreqFld:undefined,monthlyChoice2MonthFreqFld:undefined}}function RecurrencePatternEventHooks_InitializePrototype(){a:;RecurrencePatternEventHooks.prototype={frm:undefined,stName:undefined,stDisplay:undefined,stValue:undefined,fRequired:undefined,stError:undefined,stAttributes:undefined,recurFld:undefined,typeFld:undefined,stStartDate:undefined,stEndDate:undefined,rgStPatternTypes:undefined,value:undefined,dateFldStart:undefined,dateFldEnd:undefined,dateRangeFldStart:undefined,dateRangeFldEnd:undefined,errFld:undefined}}function FormTabIndex(){a:;return typeof window.formTabIndex!="undefined"&&Boolean(window.formTabIndex)?window.formTabIndex==-1?"":"tabindex="+String(window.formTabIndex):"tabindex=1"}function GetValueAttribute(a){if(typeof a.value=="undefined"&&a.tagName!=null&&a.tagName.toLowerCase()=="option"&&browseris.ie&&browseris.iever==7&&document.documentMode==5&&a.attributes!=null&&a.attributes.value!=null){var b=a.attributes.value;return b.value}return a.value}function IntlDate(g,d,b,f,c,e,a){a:;this.yr=g;this.mon=d;this.day=b;this.hr=f;this.min=c;this.sec=e;this.caltype=a}function toIntlValue(){a:;var a=0,c=11;if((this.caltype==6||this.caltype==8)&&(this.day<1||this.day>30))a=Number.NaN;if(this.caltype==8)if((this.yr*7+1)%19<7)c=12;if(this.mon<0||this.mon>c)a=Number.NaN;if(this.caltype==7){var b=new Date(Date.UTC(this.yr-543,this.mon,this.day));if(this.yr-543!=b.getUTCFullYear()||this.mon!=b.getUTCMonth()||this.day!=b.getUTCDate())a=Number.NaN}return a}function setIntlHours(c,a,b){a:;if(!Boolean(a))a=0;if(!Boolean(b))b=0;this.hr=c;this.min=a;this.sec=b}function setIntlSeconds(a){a:;this.sec=a}function setIntlTime(b){a:;var a=new Date(b);this.yr=a.getFullYear();this.mon=a.getMonth();this.day=a.getDate();this.hr=a.getHours();this.min=a.getMinutes();this.sec=a.getSeconds()}function getIntlFullYear(){a:;return this.yr}function getIntlMonth(){a:;return this.mon}function getIntlDate(){a:;return this.day}function getIntlHours(){a:;return this.hr}function getIntlMinutes(){a:;return this.min}function getIntlSeconds(){a:;return this.sec}function getIntlTime(){a:;var a=new Date(this.yr,this.mon,this.day,this.hr,this.min,this.sec);return a.getTime()}function DateOptions(){a:;var b=Strings.STS.L_strMore_Text,a=Strings.STS.L_strAllDay_Text;this.stDateOrder="MDY";this.f12Hour=true;this.stAM=Strings.STS.L_StrAM_Text;this.stPM=Strings.STS.L_StrPM_Text;this.TimeMarkPosn=0;this.dminControl=5;this.chDateSep="/";this.chTimeSep=":";this.dyrWindow=30;this.dow=0;this.webTZOffsetMin=0;this.WorkDayStartHour=8;this.WorkDayEndHour=17;this.DailyStartHourDelta=1;this.DailyEndHourDelta=4;this.CalendarPeriod="month";this.L_AllDay_Text=Strings.STS.L_strAllDay_Text;this.AllDayWidth=a;this.L_More_Text=b}function DOSetTimeFormat(a){a:;this.f12Hour=a==0}function DOSetDateOrder(a){a:;switch(a){case 0:this.stDateOrder="MDY";break;case 1:this.stDateOrder="DMY";break;case 2:this.stDateOrder="YMD"}}function DOSetDOW(a){a:;this.dow=(a+1)%7}function DOParseLocaleDate(c,g){var h=this.chDateSep,o=this.stDateOrder,b=c.indexOf(h),l,n,e,d,k,a;if(b<0){h="/";b=c.indexOf(h);if(b<0){h="-";b=c.indexOf(h)}}if(b<0)return Number.NaN;var f=c.indexOf(h,b+1);l=Number(c.substr(0,b))-0;if(f<0){if(g!=1)return Number.NaN;f=c.length;var q=this.Today();e=q.getUTCFullYear();if(o=="YMD")o="MDY"}else e=Number(c.substr(f+1))-0;n=Number(c.substr(b+1,f-b-1))-0;if(isNaN(l)||isNaN(e)||isNaN(e))return Number.NaN;var m;switch(o){case"DMY":k=l;d=n;a=e;m=c.length-f-1;break;case"YMD":a=l;m=b;d=n;k=e;break;case"MDY":d=l;k=n;a=e;m=c.length-f-1}if(a<0)return Number.NaN;if(m<3)a=this.YrWindow(a,g);d=d-1;var j=1900,i=8900;switch(g){case 6:j=1319;i=3481;break;case 7:j=2444;i=5043;break;case 8:j=5662;i=5998;break;case 16:j=1823;i=3920;break;case 23:j=1318;i=1450}var p=g==1&&a==1899&&d==11&&k==31;if((a<j||a>i)&&!p)return Number.NaN;switch(g){case 6:case 7:case 8:case 23:return this.DateIntlYMD(a,d,k,g);default:return this.DateYMD(a,d,k)}return Number.NaN}function DODateYMD(d,c,b){a:;if(isNaN(d)||isNaN(c)||isNaN(b))return Number.NaN;var a=new Date(Date.UTC(d,c,b));return d!=a.getUTCFullYear()||c!=a.getUTCMonth()||b!=a.getUTCDate()?Number.NaN:a}function DODateIntlYMD(c,b,a,d){a:;if(isNaN(c)||isNaN(b)||isNaN(a))return Number.NaN;var e=new IntlDate(c,b,a,0,0,0,d);return e}function DOYrWindow(b,d){a:;var a=b-0;if(isNaN(a))return b;if(b<100){switch(d){case 1:var e=this.Today(),c=e.getUTCFullYear();a+=WMultiple(c,100);if(a>c+this.dyrWindow)a-=100;else if(a<c+this.dyrWindow-100)a+=100;break;case 6:case 23:if(a<52)a+=1400;else a+=1300;break;case 7:if(a<73)a+=2500;else a+=2400;break;case 8:if(a<91)a+=5700;else a+=5600;break;case 16:if(a<52)a+=1900;else a+=1800}return a}return b}function DOStDate(a){return this.StDateString(a.getUTCFullYear(),a.getUTCMonth()+1,a.getUTCDate())}function DOStDateString(g,f,e){var a,c=String(f),b=String(e),d=String(g);switch(this.stDateOrder){case"MDY":a=c+this.chDateSep+b+this.chDateSep+d;break;case"DMY":a=b+this.chDateSep+c+this.chDateSep+d;break;case"YMD":a=d+this.chDateSep+c+this.chDateSep+b}return a}function DOStTime(c){var b="",a=c.getUTCHours(),d=c.getUTCMinutes();if(this.f12Hour)if(a>=12){b=this.stPM;if(a>12)a-=12}else{if(a==0)a=12;b=this.stAM}return this.TimeMarkPosn==0?String(a)+this.chTimeSep+St2Digits(d)+" "+b:b+" "+String(a)+this.chTimeSep+St2Digits(d)}function DOStBareTime(b){var d="",a=b.getUTCHours(),c=b.getUTCMinutes();if(this.f12Hour)if(a>=12){if(a>12)a-=12}else if(a==0)a=12;return String(a)+this.chTimeSep+St2Digits(c)}function DOFHasTime(a){var c=a.getUTCHours(),b=a.getUTCMinutes();return c!=0||b!=0}function DOStTimeControls(b,j){var a,e,k=j.getUTCHours(),h=j.getUTCMinutes(),c,d,g="",l,m,i="ltr";if(b!=null&&typeof b.direction!="undefined"&&b.direction!=null&&b.direction=="rtl")i="rtl";if(typeof b.frm!="undefined"&&typeof b.frm.StFieldName!="undefined")a="<span dir='"+i+"'><select title='"+Strings.STS.L_Hours_Text+"' "+FormTabIndex()+" class='ms-input' name="+StAttrQuote(b.frm.StFieldName(b,"Hours"))+">\r";for(c=0;c<24;c++){if(c==k)e=" SELECTED";else e="";a+="<option value="+String(c)+e+">";d=c;if(this.f12Hour){if(c<12)g=this.stAM;else{g=this.stPM;d-=12}if(d==0)d=12;if(this.TimeMarkPosn==0)a+=String(d)+" "+g+"\r";else a+=g+" "+String(d)+"\r"}else{if(c<10)a+=Strings.STS.L_SmallHour_Text;a+=String(d)+Strings.STS.L_Time_Text+"\r"}}a+="</select>\r";a+="&nbsp;<select title='"+Strings.STS.L_Minutes_Text+"' "+FormTabIndex()+" name="+StAttrQuote(b.frm.StFieldName(b,"Minutes"))+">\r";h=WMultiple(h,this.dminControl);for(var f=0;f<60;f+=this.dminControl){if(f==h)e=" Selected=True";else e="";a+="<option value="+String(f)+e+">";a+=St2Digits(f)+"\r"}a+="</select></span>\r";return a}function DOSetTimeControls(a,e){var d,c;if(typeof a.frm!="undefined"&&typeof a.frm.FieldSubPart!="undefined"){d=a.frm.FieldSubPart(a,"Hours");c=a.frm.FieldSubPart(a,"Minutes")}var f=e.getUTCHours(),b=e.getUTCMinutes(),g;b=WMultiple(b,this.dminControl);d.selectedIndex=f;c.selectedIndex=b/this.dminControl}function DOToday(){a:;var a=this.Now();a.setUTCHours(0,0,0,0);return a}function DONow(){a:;var a=new Date;a.setTime(a.getTime()-this.webTZOffsetMin*DateOptions.msMinute);return a}function DOClientToday(){a:;var a=DateOptions.ClientNow();a.setUTCHours(0,0,0,0);return a}function DOClientNow(){a:;var a=new Date;a.setTime(a.getTime()-a.getTimezoneOffset()*DateOptions.msMinute);return a}function DOParseISODate(a,c){var b="#INVALID";if(a.length<19)return b;var i=Number(a.substr(0,4)),f=Number(a.substr(5,2)),d=Number(a.substr(8,2)),h=Number(a.substr(11,2)),e=Number(a.substr(14,2)),g=Number(a.substr(17,2));if(isNaN(i)||isNaN(f)||isNaN(d)||isNaN(h)||isNaN(e)||isNaN(g))return b;if(typeof c=="undefined")c=0;switch(c){case 6:case 7:case 8:case 23:b=new IntlDate(i,f-1,d,h,e,g,c);break;default:b=new Date(Date.UTC(i,f-1,d,h,e,g))}return b}function DateRoundDate(a){a.setSeconds(0);return a}function DOStISODate(a){var g=a.getUTCFullYear(),d=a.getUTCMonth()+1,b=a.getUTCDate(),f=a.getUTCHours(),c=a.getUTCMinutes(),e=a.getUTCSeconds();return String(g)+"-"+St2Digits(d)+"-"+St2Digits(b)+"T"+St2Digits(f)+":"+St2Digits(c)+":"+St2Digits(e)+"Z"}function DateDecode(h){this.ms=h.getTime();this.msDay=this.ms%DateOptions.msDay;if(typeof this.sec!="undefined"&&this.sec<0)this.sec+=DateOptions.msDay;this.idy=Math.floor(this.ms/DateOptions.msDay)+DateOptions.ddayOrigin;var g=this.idy%DateOptions.cdyQC,j=Math.floor(this.idy/DateOptions.cdyQC),c=g%DateOptions.cdyC,e=Math.floor(g/DateOptions.cdyC);if(e==4){e=3;c=DateOptions.cdyC}var f=c%DateOptions.cdyQYr,i=Math.floor(c/DateOptions.cdyQYr),b=f%DateOptions.cdyYr,d=Math.floor(f/DateOptions.cdyYr);if(d==4){d=3;b=DateOptions.cdyYr}this.yr=1600+j*400+e*100+i*4+d;if(b>=DateOptions.idyJan1)this.yr++;for(var a=0;a<11;a++)if(b<DateOptions.mpMonIdy[a])break;this.mon=(a+2)%12;this.day=b-(a>0?DateOptions.mpMonIdy[a-1]:0)+1;this.hr=Math.floor(this.msDay/DateOptions.msHour);this.min=Math.floor(this.msDay%DateOptions.msHour/DateOptions.msMinute);this.sec=Math.floor(this.msDay%DateOptions.msMinute/DateOptions.msSecond);this.dow=(this.idy+3)%7}function DDMsEncode(){a:;this.ms=Date.UTC(this.yr,this.mon,this.day,this.hr,this.min,this.sec);return this.ms}function DateEnsureDecode(){a:;if(typeof this.dd=="undefined"||typeof this.dd.ms!="undefined"&&this.dd.ms!=this.getTime())this.dd=new DateDecode(this)}function DateResetMs(){a:;this.setTime(this.dd.MsEncode())}function DateGetUTCDate(){a:;this.EnsureDecode();return this.dd.day}function DateGetUTCDay(){a:;this.EnsureDecode();return this.dd.dow}function DateGetUTCFullYear(){a:;this.EnsureDecode();return this.dd.yr}function DateGetUTCMonth(){a:;this.EnsureDecode();return this.dd.mon}function DateGetUTCHours(){a:;this.EnsureDecode();return this.dd.hr}function DateGetUTCMinutes(){a:;this.EnsureDecode();return this.dd.min}function DateGetUTCSeconds(){a:;this.EnsureDecode();return this.dd.sec}function DateSetUTCDate(a){a:;this.EnsureDecode();this.dd.day=a;this.ResetMs()}function DateSetUTCHours(c,a,b){this.EnsureDecode();if(!Boolean(a))a=0;if(!Boolean(b))b=0;this.dd.hr=c;this.dd.min=a;this.dd.sec=b;this.ResetMs()}function StDateDecode(){a:;return"Date Object\rYear: "+String(this.yr)+"\rMon: "+String(this.mon+1)+"\rDay: "+String(this.day)+"\rhr: "+String(this.hr)+"\rmin: "+String(this.min)+"\rsec: "+String(this.sec)}function DatePicker_InitializePrototype(){a:;DatePicker.prototype={elt:undefined,wnd:undefined}}function DatePicker(a){this.frm=a;if(a.fUseDHTML){BFormDocumentWrite('<iframe frameborder="0" src="'+a.stPagePath+'iframe.htm" scrolling="no" style="position:absolute;display:none;background:white;" id=DatePickerWind></iframe>');this.wnd=typeof DatePickerWind=="undefined"?undefined:DatePickerWind;document.body.onclick=DPCancelHandler;this.ifrm=document.getElementById("DatePickerWind")}}function DPCancelHandler(){a:;var a=frmCurrent.dp;a.Cancel()}function DPStButton(c,b){var a="";if(this.frm.fUseDHTML)a+='<img alt="'+Strings.STS.L_DatePickerAlt_Text+'" class="ms-button" onclick=\'{var elt = event.srcElement; '+b+"; if (!elt.disabled) frm.FindField("+STSScriptEncodeWithQuote(c.stName)+").PopDatePicker(elt);}'src="+StAttrQuote(this.frm.stImagesPath+"calendar.gif")+" />";return a}function DPPopup(d,c,a){if(typeof this.elt!="undefined"&&this.elt!=null&&this.elt==a){this.Cancel();return}this.Cancel();this.bRTLAlign=false;this.date=new Date(d.getTime());this.date.setUTCHours(0,0,0,0);this.field=c;this.elt=a;var b=WindowPosition(a);this.ifrm.style.pixelLeft=b.x+1;this.ifrm.style.pixelTop=b.y+a.offsetHeight;this.SetHTML(this.StBuild())}function DPAdjustFrameSize(){a:;this.ifrm.style.display="block";var a=this.wnd.document.getElementById("DatePickerDiv");if(typeof this.bDidAlign!="undefined"&&!this.bDidAlign){this.bDidAlign=true;this.ifrm.style.pixelWidth=a.offsetWidth-100}this.ifrm.style.pixelWidth=a.offsetWidth;this.ifrm.style.pixelHeight=a.offsetHeight;if(this.ifrm.currentStyle.direction=="rtl"&&!this.bRTLAlign){this.bRTLAlign=true;this.ifrm.style.pixelLeft-=this.ifrm.style.pixelWidth-event.srcElement.offsetWidth+1}}function DPStBuild(){a:;var a="";this.cal=new Calendar(this.date.getUTCFullYear(),this.date.getUTCMonth(),this.frm.dopt,"parent.frm.dp");this.cal.fDatePicker=true;this.cal.dateDP=this.date;if(typeof this.cal.StBuild!="undefined")a+=this.cal.StBuild();return a}function DPSetHTML(b){a:;var a=this.wnd.document.getElementById("onetidThemeCSS");if(Boolean(a)&&Boolean(this.frm.themeCSSurl))a.href=this.frm.themeCSSurl;this.wnd.document.body.innerHTML="<div id='DatePickerDiv'>"+b+"</div>";typeof this.wnd.document.selection!="undefined"&&typeof this.wnd.document.selection.empty!="undefined"&&this.wnd.document.selection.empty();this.AdjustFrameSize()}function DPClickDay(d,c,b){a:;var a=new Date(Date.UTC(d,c,b));if(typeof this.frm.dopt.StDate!="undefined")this.field.value=this.frm.dopt.StDate(a);this.Cancel()}function DPMoveMonth(a){a:;this.cal.SetDate(this.cal.yr,this.cal.mon+a,1);this.SetHTML(this.cal.StBuild())}function DPCancel(){a:;if(this.elt!=null){this.ifrm.style.display="none";this.elt=null}}function DPSetDate(c,b,a){a:;this.cal.SetDate(c,b,a);this.SetHTML(this.cal.StBuild())}function FrmOnSubmitRetFalse(){a:;return false}var frmCurrent;function OWSForm(c,a,b){a:;this.stName=c;this.stFieldPrefix="urn:schemas-microsoft-com:office:office#";this.dopt=new DateOptions;this.nopt=new NumberOptions;this.fUseDHTML=browseris.ie5up&&browseris.win32;if(!a)this.fUseDHTML=false;this.ifldMax=0;this.rgfld=[];this.stError="";this.stImagesPath="";this.stPagePath=b+Strings.STS.L_Language_Text+"/";this.dp=new DatePicker(this);this.stInputStyle=browseris.ie5up&&browseris.win32||browseris.nav6up?"CLASS=ms-input":"";this.stLongStyle=browseris.ie5up&&browseris.win32||browseris.nav6up?"CLASS=ms-long":"";this.fPreviewMode=false;if(document.forms[this.stName])document.forms[this.stName].onsubmit=FrmOnSubmitRetFalse;this.form=null;this.themeCSSurl=retrieveCurrentThemeLink();this.rgcts=[];this.rgctNames=[];this.ctNameToId={};this.ctIdToName={};frmCurrent=this}function FrmMapCtName(a,b){a:;this.ctNameToId[a]=b;this.ctIdToName[b]=a}function FrmAddField(a,d,b,c){this.rgfld[this.ifldMax++]=a;a.frm=this;a.stName=d;a.stDisplay=b;a.stValue=c;a.fRequired=false;a.stError="";a.stAttributes="";a.fCalcCheck=false}function FrmDataBind(){a:;var a,b;if(this.form==null)this.form=document.forms[this.stName];for(a=0;a<this.ifldMax;a++){b=this.rgfld[a];b.DataBind()}}function FrmFindField(c){a:;for(var b,a=0;a<this.ifldMax;a++){b=this.rgfld[a];if(b.stName==c)return b}return null}function FrmValidateAndSubmit(a){a:;if(this.fPreviewMode){window.alert(Strings.STS.L_cantSave_Text);return}if(this.FValidate(a)&&typeof this.form.submit!="undefined"){this.FPostProcess();this.form.submit()}}function FValidateForm(h){a:;var d,a,e=true;if(this.form==null)this.form=document.forms[this.stName];for(d=0;d<this.ifldMax;d++){a=this.rgfld[d];var b=a.frm.FieldSubPart(a,"Checkbox"),c=b!=null;if(!c)b=ControlFromFld(Object(a));if(b!=null&&b.id!="onetidIOFile"&&a.stName!="ContentType"){var i=GetTr(b);if(typeof a.GetControl!="undefined")b=a.GetControl();if(i.style.display=="none")if(b.tagName=="INPUT"&&b.type!="hidden"||b.tagName=="SELECT"){var f=GetValueAttribute(b);if(c)f=b.checked?"1":"0";b.setAttribute("oldValue",f);var g=a.frm.FieldPost(a);if(g!=null){if(typeof a.belongToCurrentContentType=="undefined"||!a.belongToCurrentContentType){if(c)b.checked=false;else b.value="";g.value=""}g.setAttribute("oldValue",f)}else if(c)b.checked=false;else b.value="";continue}}if(!a.fSkipValidation&&!a.FValidate()){if(Boolean(a.errFld))a=a.errFld;if(e){this.stError=a.stError;e=false}if(h){ShowControl(a,a.fRequired,String(0),Number(undefined));a.FieldFocus();alert(this.stError);return false}}}return e}function FPostProcessForm(){a:;var a,b;this.form=document.forms[this.stName];for(a=0;a<this.ifldMax;a++){b=this.rgfld[a];typeof b.PostProcess!="undefined"&&b.PostProcess&&b.PostProcess()}return true}function FrmSetFirstFocus(c){a:;var b;c!=true&&this.InitFormFields();if(this.rgcts.length>1)return;for(b in this.rgfld){var a=this.rgfld[b];if(!(Object(a).hasOwnProperty("fHidden")&&typeof a.fHidden!="undefined"&&a.fHidden)&&typeof a.FieldFocus!="undefined"&&a.FieldFocus&&a.FieldFocus())break}}function FrmInitFields(){a:;var a;window.focus();this.form=document.forms[this.stName];for(a in this.rgfld)this.rgfld[a].Init&&this.rgfld[a].Init();if(typeof _g_tp_rgcts!="undefined")this.rgcts=_g_tp_rgcts;else this.rgcts=[];DefaultControls()}function FrmBuildFieldUI(b,a){BFormDocumentWrite(a)}function FrmStFieldPost(a){if(!a.posted){a.posted=true;return"<input TYPE=HIDDEN NAME="+StAttrQuote(this.stFieldPrefix+String(a.stName))+">\r"}else return""}function FrmFieldPost(a){if(this.form==null)this.form=document.forms[this.stName];return this.form[this.stFieldPrefix+a.stName]}function FilenameFrmFieldPost(a){if(this.form==null)this.form=document.forms[this.stName];return this.form[a.stName]}function FrmStFieldSubPart(a,f,d){var e='maxlength="255" ',b;switch(a.direction){case 1:b=' dir="ltr"';break;case 2:b=' dir="rtl"';break;default:b=""}var c=a.IMEMode?' style="ime-mode:'+a.IMEMode+'" ':"";return"<input "+FormTabIndex()+" "+e+a.stAttributes+" title="+StAttrQuote(a.stDisplay)+" name="+StAttrQuote(this.StFieldName(a,f))+" id='id"+a.stName+"'"+c+" value="+StAttrQuote(d)+b+">"}function FrmFieldSubPart(b,a){if(this.form==null)this.form=document.forms[this.stName];return this.form[this.StFieldName(b,a)]}function FrmStFieldName(b,a){return this.StFieldNameFactory(b.stName,a)}function FrmStFieldNameFactory(b,a){a:;return"OWS:"+b+":"+a}function FrmGetSelValue(b){a:;if(this.form==null)this.form=document.forms[this.stName];var a=this.form[b];return GetValueAttribute(a[a.selectedIndex])}function FormTestURL(c){a:;var d=this.FindField(c),b=this.FieldSubPart(d,"URL"),a=StURLNormalize(TrimWhiteSpaces(GetValueAttribute(b)));if(!IsSafeHref(a))return;if(a.substr(0,7)=="mailto:")open(a,"_self");else open(a,"_blank")}function FormSetRadioValue(c,b){a:;var a=this.FindField(c);if(a.stAlias)a=this.FindField(a.stAlias);a.SetValue(b);return true}function FormRevertSelect(b,a){a:;var c=this.FindField(b);c.RevertSelect(a)}function FormSetFillInButton(b){a:;if(event!=null){var a;if(browseris.ie)a=event.keyCode;else a=event.which;if(a==9||a==16)return}var c=this.FindField(b);c.SetFillInButton()}function FormUnsetFillInButton(a){a:;var b=this.FindField(a);b.UnsetFillInButton()}function NumberOptions(){a:;this.chDigSep=",";this.chDecimal=".";this.chMinus="-";this.iNegNumber=1;this.rgcchSep=[3,0]}function NoptSetGrouping(a){this.rgcchSep=a.split(";")}function NoptNumParse(a){var d=false;a=a.toUpperCase();var f=new RegExp("\\"+this.chDigSep,"g");a=a.replace(f,"");if(this.chDecimal!="."&&a.search(/\./)!=-1)return Number.NaN;f=new RegExp("\\"+this.chDecimal,"g");a=a.replace(f,".");if(a.search(/\(/)!=-1&&a.search(/\)/)!=-1){d=true;a=a.replace(/\(/,"").replace(/\)/,"")}for(var e=0,h=false,g="",e=0;e<a.length;e++){var c=a.charAt(e);if(c=="E")h=true;if(!h&&c==this.chMinus)d=true;else g+=c}var b=Number(g);if(b>179e306)return Number.NaN;if(b!=0&&b<223e-310)b=0;if(d)b=-b;return b}function NoptStNumber(e){var f,c;if(e=="")return"";var d=Number(e);f=d<0;if(f)d=-d;var a=d.toString();a=a.toUpperCase();if(isNaN(d))return e;a=a.replace(/\./,this.chDecimal);var g=a.indexOf(this.chDecimal);if(this.rgcchSep[0]!=0&&a.indexOf("E")==-1){if(g!=-1)c=g-1;else c=a.length-1;var b=0;while(b<this.rgcchSep.length&&c>=this.rgcchSep[b]){a=StInsertAt(a,c-this.rgcchSep[b]+1,this.chDigSep);c-=this.rgcchSep[b];b++;if(b<this.rgcchSep.length&&this.rgcchSep[b]==0)b--}}if(f)switch(this.iNegNumber){case 0:a="("+a+")";break;case 1:a=this.chMinus+a;break;case 2:a=this.chMinus+" "+a;break;case 3:a=a+this.chMinus;break;case 4:a=a+" "+this.chMinus}return a}function DateField(a,d,b,c){a.AddField(this,d,b,c);this.fDateOnly=false;this.stAttributes=a.stInputStyle+" SIZE=12";this.caltype=1;this.direction=0;this.stPopUpOnClick2="";this.origDate=null;this.showDatePicker=true}function DateBuildUI(){a:;var a=this.stBuildUI();this.frm.BuildFieldUI(this,a+"\r")}function stDateBuildUI(){a:;var a="",b;a+=this.frm.StFieldPost(this);if(!this.fHideDateSpan)a+="<span ID="+StAttrQuote(this.frm.StFieldName(g_fld,"DateSpan"))+">";if(FBlankString(this.stValue)){a+=this.frm.StFieldSubPart(this,"Date","");b=this.frm.dopt.Today()}else{b=DateOptions.ParseISODate(this.stValue,this.caltype);if(String(b)=="#INVALID"){b=this.frm.dopt.Today();a+=this.frm.StFieldSubPart(this,"Date",String(b))}else{b=this.frm.dopt.RoundDate(b);a+=this.frm.StFieldSubPart(this,"Date",this.frm.dopt.StDate(b))}}this.origDate=b;a+="&nbsp;";if(this.caltype==1&&this.showDatePicker)a+=this.frm.dp.StButton(this,this.stPopUpOnClick2);a+="&nbsp;&nbsp;";if(!this.fHideDateSpan)a+="</span>";if(!this.fDateOnly)a+=this.frm.dopt.StTimeControls(this,b);a+="<img alt='' style='vertical-align: bottom' width=1pt height=16pt src="+StAttrQuote(this.frm.stImagesPath+"blank.gif")+">";var c="",d="";switch(this.caltype){case 6:c=Strings.STS.L_CalendarHijri_Text;break;case 7:c=Strings.STS.L_CalendarThai_Text;break;case 8:c=Strings.STS.L_CalendarHebrew_Text;break;case 16:c=Strings.STS.L_CalendarSaka_Text;break;case 23:c=Strings.STS.L_CalendarUmAlQura_Text;break;default:c=""}d=this.frm.dopt.StDateString(Strings.STS.L_DateOrderYear_Text,Strings.STS.L_DateOrderMonth_Text,Strings.STS.L_DateOrderDay_Text);if(!this.fHideDescription)a+="&nbsp;<br><SPAN class=ms-formdescription ID="+StAttrQuote(this.frm.StFieldName(g_fld,"DateSpan"))+">"+StBuildParam(Strings.STS.L_DateOrderDesc_Text,c,d)+"</SPAN>";return a}function DatePopDatePicker(c){a:;this.frm.form=document.forms[this.frm.stName];var a,d=this.frm.FieldPost(this),b=this.frm.FieldSubPart(this,"Date");event.cancelBubble=true;a=this.frm.dopt.Today();if(this.FValidate()&&this.date!=null)a=this.date;this.frm.dp.Popup(a,b,c);return true}function DateDataBind(){a:;var a,b=this.frm.FieldPost(this),c=this.frm.FieldSubPart(this,"Date");if(FBlankString(GetValueAttribute(b))){c.value="";a=this.frm.dopt.Today()}else{a=DateOptions.ParseISODate(GetValueAttribute(b));a=this.frm.dopt.RoundDate(a);c.value=this.frm.dopt.StDate(a)}!this.fDateOnly&&this.frm.dopt.SetTimeControls(this,a)}function DateFieldFocus(){a:;var a=this.frm.FieldSubPart(this,"Date");if(!a.disabled){a.focus();a.select();return true}return false}function DateFValidate(){a:;var g=this.frm.FieldPost(this),e=this.frm.FieldSubPart(this,"Date");if(!e.disabled){var f=TrimWhiteSpaces(GetValueAttribute(e));if(f=="")if(this.fRequired){this.stError=StBuildParam(Strings.STS.L_DateRequired_Text,this.stDisplay);return false}else{g.value="";this.date=null;return true}var a=this.frm.dopt.ParseLocaleDate(f,this.caltype);if(isNaN(Number(a))){this.stError=StBuildParam(Strings.STS.L_InvalidDate_Text,this.stDisplay);return false}var c=1900,b=8900;switch(this.caltype){case 6:c=1319;b=3481;break;case 7:c=2444;b=5043;break;case 8:c=5662;b=5998;break;case 16:c=1823;b=3920;break;case 23:c=1318;b=1450}if(!this.fDateOnly){var l=this.frm.GetSelValue(this.frm.StFieldName(this,"Hours"))-0,j=this.frm.GetSelValue(this.frm.StFieldName(this,"Minutes"));a.setUTCHours(l,j)}var d=a.getUTCFullYear(),k=a.getUTCMonth(),i=a.getUTCDate(),h=(this.origDate==null||a.getTime()>=this.origDate.getTime())&&this.caltype==1&&d==1899&&k==11&&i==31;if((d<c||d>b)&&!h){this.stError=StBuildParam(Strings.STS.L_InvalidDate_Text,this.stDisplay);return false}g.value=DateOptions.StISODate(a);this.date=a}return true}function URLField(b,e,c,a,d){if(FBlankString(a))a="http://";b.AddField(this,e,c,a);this.stDesc=d;this.stAttributes=b.stLongStyle}function URLBuildUI(){a:;var a="";a+=this.frm.StFieldPost(this);a+="<span class='ms-formdescription'>"+Strings.STS.L_URLHeading_Text+" (";a+="<a "+FormTabIndex()+" href='javascript:frm.TestURL("+STSScriptEncodeWithQuote(this.stName)+")' target='_self'>"+Strings.STS.L_URLTest_Text+"</a>)&nbsp;<br></span>\r";a+="<span dir='ltr'>";a+=this.frm.StFieldSubPart(this,"URL",this.stValue);a+="</span>";a+="&nbsp;<br>\r<span class='ms-formdescription'>"+Strings.STS.L_URLHeadingDesc_Text+"<br></span>\r";var b=this.stDisplay;this.stDisplay=Strings.STS.L_URLDescriptionTooltip_Text;a+=this.frm.StFieldSubPart(this,"Desc",this.stDesc);this.stDisplay=b;this.frm.BuildFieldUI(this,a)}function URLDataBind(){a:;var e=this.frm.FieldPost(this),g=this.frm.FieldSubPart(this,"URL"),f=this.frm.FieldSubPart(this,"Desc"),a=GetValueAttribute(e),b,d,c=a.indexOf(", ");if(c==-1){c=a.lastIndexOf(",");if(c==a.length-1)a+=" "}if(c==-1){b=a;d=a}else{b=a.substr(0,c);d=a.substr(c+2)}b=b.replace(/\,\,/,",");if(FBlankString(b))b="http://";g.value=b;f.value=d}function URLFieldFocus(){a:;var a=this.frm.FieldSubPart(this,"URL");if(!a.disabled){a.focus();a.select();return true}return false}function URLValidate(){a:;var c,f=this.frm.FieldPost(this),e=this.frm.FieldSubPart(this,"URL"),d=this.frm.FieldSubPart(this,"Desc"),a=TrimWhiteSpaces(GetValueAttribute(e)),b=TrimWhiteSpaces(GetValueAttribute(d));if(a=="http://")a="";if(this.fRequired&&FBlankString(a)){this.stError=StBuildParam(Strings.STS.L_FieldRequired_Text,this.stDisplay);return false}a=StURLNormalize(a);if(-1!=a.indexOf(";#")||-1!=b.indexOf(";#")){this.stError=Strings.STS.L_InvalidUrlValue_Text;return false}c=a.replace(/,/g,",,")+", "+b;f.value=c;return true}function StURLNormalize(a){a:;if(a.substr(0,2)=="\\\\"||a.substr(0,2)=="//")a="file:"+a;if(a.substr(0,5)=="file:")a=a.replace(/\\/g,"/");return a}function NumberField(d,c,a,b){d.AddField(this,c,a,b);this.fPercent=false;this.cchDisplaySize=undefined}function NumberBuildUI(){a:;var a=this.stBuildUI();this.frm.BuildFieldUI(this,a)}function StDivideByOneHundred(a){a:;if(a=="")return a;var b;b=a.indexOf("E");if(b==-1)b=a.indexOf("e");var c;if(b==-1)c="";else{c=a.slice(b);a=a.substr(0,b)}var d;if(a.charAt(0)=="-"){d="-";a=a.slice(1)}else d="";b=a.indexOf(".");if(b==-1){b=a.length;a+="."}a=a.substr(0,b)+a.slice(b+1);b-=2;if(b==-1){a="0"+a;b=0}a=StInsertAt(a,b,".");a=d+a+c;return a}function StMultiplyByOneHundred(a){if(a=="")return a;var b;b=a.indexOf("E");if(b==-1)b=a.indexOf("e");var c;if(b==-1)c="";else{c=a.slice(b);a=a.substr(0,b)}b=a.indexOf(".");if(b==-1)a+="00";else{a=a.substr(0,b)+a.slice(b+1);b+=2;while(b>=a.length+1)a+="0";a=StInsertAt(a,b,".")}a=a+c;return a}function stNumberBuildUI(){a:;var c=Number(this.stValue);if(this.fPercent&&!isNaN(c)){if(Number(this.stValue)!=0)this.stValue=StMultiplyByOneHundred(this.stValue);if(this.wMin!=0)this.wMin=Number(StMultiplyByOneHundred(this.wMin.toString()));if(this.wMax!=0)this.wMax=Number(StMultiplyByOneHundred(this.wMax.toString()))}var b;if(this.cchDisplaySize!=undefined)b=Number(this.cchDisplaySize);else b=11;this.stAttributes=this.frm.stInputStyle+" SIZE="+String(b);var a="";a+=this.frm.StFieldPost(this);a+=this.frm.StFieldSubPart(this,"Local",this.frm.nopt.StNumber(this.stValue));if(this.fPercent&&!this.fCalcCheck)a+="&nbsp;%";return a}function NumberDataBind(){a:;var a=this.frm.FieldPost(this),b=this.frm.FieldSubPart(this,"Local");if(this.fPercent)a.value=StMultiplyByOneHundred(GetValueAttribute(a).toString());b.value=this.frm.nopt.StNumber(GetValueAttribute(a))}function NumberFieldFocus(){a:;var a=this.frm.FieldSubPart(this,"Local");if(!a.disabled){a.focus();a.select();return true}return false}function NumberFValidate(){a:;var b=this.frm.FieldPost(this),d=this.frm.FieldSubPart(this,"Local"),c=GetValueAttribute(d);if(FBlankString(c)){if(this.fRequired){this.stError=StBuildParam(Strings.STS.L_ValueRequired_Text,this.stDisplay);return false}b.value="";return true}if(this.fCalcCheck){b.value=c;return true}var a=this.frm.nopt.NumParse(c);if(isNaN(a)){this.stError=StBuildParam(Strings.STS.L_InvalidNumber_Text,this.stDisplay);return false}if(FNumber(this.wMin)&&FNumber(this.wMax)&&(a<this.wMin||a>this.wMax)){this.stError=StBuildParam(Strings.STS.L_InvalidRange_Text,this.stDisplay,this.frm.nopt.StNumber(String(this.wMin)),this.frm.nopt.StNumber(String(this.wMax)));return false}if(FNumber(this.wMin)&&a<this.wMin){this.stError=StBuildParam(Strings.STS.L_InvalidMin_Text,this.stDisplay,this.frm.nopt.StNumber(String(this.wMin)));return false}if(FNumber(this.wMax)&&a>this.wMax){this.stError=StBuildParam(Strings.STS.L_InvalidMax_Text,this.stDisplay,this.frm.nopt.StNumber(String(this.wMax)));return false}if(this.fInteger&&Boolean(a)&&Math.floor(a)!=a){this.stError=StBuildParam(Strings.STS.L_InvalidInteger_Text,this.stDisplay);return false}if(this.fPercent)b.value=StDivideByOneHundred(a.toString());else b.value=String(a);return true}function FNumber(a){return String(a)!=""&&a!=null&&!isNaN(a)}function BooleanField(d,c,a,b){d.AddField(this,c,a,b)}function BooleanBuildUI(){a:;var a="";a+=this.frm.StFieldPost(this);a+="<input "+FormTabIndex()+" type='checkbox' "+this.stAttributes+" title="+StAttrQuote(this.stDisplay)+" name="+StAttrQuote(this.frm.StFieldName(g_fld,"Checkbox"));if(Number(this.stValue)!=0)a+=" CHECKED";a+=">\r";this.frm.BuildFieldUI(this,a)}function BooleanDataBind(){a:;var b=this.frm.FieldPost(this),a=this.frm.FieldSubPart(this,"Checkbox");a.checked=Number(GetValueAttribute(b))!=0}function BooleanFieldFocus(){a:;var a=this.frm.FieldSubPart(this,"Checkbox");if(!a.disabled){a.focus();return true}return false}function BooleanFValidate(){a:;var a=this.frm.FieldPost(this),b=this.frm.FieldSubPart(this,"Checkbox");if(b.checked)a.value="1";else a.value="0";return true}function BooleanFieldSetValue(c){a:;var a=this.frm.FieldPost(this),b=this.frm.FieldSubPart(this,"Checkbox");a.value=c;b.checked=Number(GetValueAttribute(a))!=0}function Field(c,b,a){c.AddField(this,b,a,"")}function FieldFieldFocus(){a:;var a=this.frm.FieldPost(this);if(!a.disabled){a.focus();return true}return false}function FieldDataBind(){a:;}function FieldFValidate(){a:;var a=this.frm.FieldPost(this);if(this.fRequired&&FBlankString(GetValueAttribute(a))){this.stError=StBuildParam(Strings.STS.L_FieldRequired_Text,this.stDisplay);return false}if(this.frm.wBaseType==1&&Boolean(GetValueAttribute(a))&&GetValueAttribute(a).length>255){this.stError=StBuildParam(Strings.STS.L_TextFieldMax_Text,this.stDisplay,255);return false}return true}function FieldBuildUI(){a:;}function NoteField(d,c,a,b){d.AddField(this,c,a,b);this.stDirection="";this.stNumLines=""}function NoteFieldFieldFocus(){a:;return NoteFieldFieldFocusCore(this)}function NoteFieldFieldFocusCore(b){var a=b.frm.FieldPost(b);if(!a.disabled){a.focus();return true}return false}function NoteFieldBuildUI(){a:;NoteFieldBuildUICore(this)}function NoteFieldBuildUICore(a){var b="";b+="<textarea "+FormTabIndex()+' cols="30" rows='+StAttrQuote(a.stNumLines)+" title="+StAttrQuote(a.stDisplay)+" name="+StAttrQuote(a.frm.stFieldPrefix+a.stName)+" "+a.frm.stLongStyle;b+=a.IMEMode?' style="ime-mode:'+a.IMEMode+'" ':"";b+=">";b+=STSHtmlEncode(a.stValue);b+="</textarea>";a.frm.BuildFieldUI(a,b)}function NoteFieldFValidate(){a:;return NoteFieldFValidateCore(this)}function NoteFieldFValidateCore(a){var b=a.frm.FieldPost(a);if(a.fRequired&&FBlankString(GetValueAttribute(b))){a.stError=StBuildParam(Strings.STS.L_FieldRequired_Text,a.stDisplay);return false}if(a.frm.wBaseType==1&&Boolean(GetValueAttribute(b))&&GetValueAttribute(b).length>255){a.stError=StBuildParam(Strings.STS.L_TextFieldMax_Text,a.stDisplay,255);return false}return true}function RichTextField(d,c,a,b){d.AddField(this,c,a,b);this.stDirection="";this.stNumLines="";this.fAllowHyperlink=false}function RichTextFieldFieldFocus(){a:;if(browseris.ie5up){RTE_GiveEditorFirstFocus(this.frm.stFieldPrefix+this.stName);return true}else return NoteFieldFieldFocusCore(this)}function RichTextFieldBuildUI(){a:;var a="";NoteFieldBuildUICore(this);if(browseris.ie5up&&browseris.win32)RTE_ConvertTextAreaToRichEdit(this.frm.stFieldPrefix+this.stName,true,g_fld.fAllowHyperlink,this.stDirection,Strings.STS.L_Language_Text,null,null,null,null,null,null,null,null,null,null,null,undefined,Number(undefined),Number(undefined),undefined,undefined,undefined,undefined);else{a+="&nbsp;<br><SPAN class=ms-formdescription>"+Strings.STS.L_strRichTextSupport_Text+"</SPAN>&nbsp;<br>";BFormDocumentWrite(a)}}function RichTextFieldFValidate(){a:;var m=NoteFieldFValidateCore(this);if(m&&!browseris.ie5up){var l=this.frm.FieldPost(this),a=GetValueAttribute(l),c=a.length;if(a!=""){var b=a,h=a.substr(0,5),k=a.substr(c-6,6);h.toLowerCase();k.toLowerCase();if(h!="<div>"||k!="</div>"){var d=a.substr(0,4),e=a.substr(c-5,5);d.toLowerCase();e.toLowerCase();if(d!="<ol>"&&d!="<ul>"&&e!="</ol>"&&e!="</ul>"){var f=a.substr(0,12),i=a.substr(c-13,13);f.toLowerCase();i.toLowerCase();if(f!="<blockquote>"&&i!="</blockquote>"){var g=a.substr(0,3),j=a.substr(c-4,4);g.toLowerCase();j.toLowerCase();if(g!="<p>"||j!="</p>")b="<div>"+a+"</div>"}}}var n=/\n([^<])/g;b=b.replace(n,"\n<br>$1");l.value=b}}return m}function TextField(d,c,a,b){d.AddField(this,c,a,b);this.cchMaxLength="";this.cchDisplaySize=undefined}function TextFieldBuildUI(){a:;var a=this.stBuildUI();this.frm.BuildFieldUI(this,a)}function stTextFieldBuildUI(){a:;var a="",b;if(this.cchMaxLength=="")this.cchMaxLength="255";else this.cchMaxLength=String(Number(this.cchMaxLength));if(this.cchDisplaySize!=undefined)b=Number(this.cchDisplaySize);else if(Number(this.cchMaxLength)<32)b=Number(this.cchMaxLength);a+="<input "+FormTabIndex()+" ";if(Boolean(b))a+=this.frm.stInputStyle+" size="+String(b);else a+=this.frm.stLongStyle;var c=this.IMEMode?' style="ime-mode:'+this.IMEMode+'" ':"";a+=" maxlength="+this.cchMaxLength+" "+this.stAttributes+" title="+StAttrQuote(this.stDisplay)+" name="+StAttrQuote(this.frm.stFieldPrefix+this.stName)+c+" value="+StAttrQuote(this.stValue)+">\r";return a}function TextFieldFieldFocus(){a:;var a=this.frm.FieldPost(this);if(!a.disabled){a.focus();a.select();return true}return false}function TextFieldFValidate(){a:;var a=this.frm.FieldPost(this);a.value=TrimWhiteSpaces(GetValueAttribute(a));if(GetValueAttribute(a).length>Number(this.cchMaxLength)){this.stError=StBuildParam(Strings.STS.L_TextFieldMax_Text,this.stDisplay,this.cchMaxLength);return false}if(this.fRequired&&GetValueAttribute(a)==""){this.stError=StBuildParam(Strings.STS.L_FieldRequired_Text,this.stDisplay);return false}return true}function FilenameField(d,c,a,b){d.AddField(this,c,a,b);this.cchMaxLength="";this.cchDisplaySize=undefined;this.isFileName=true}function FilenameFieldBuildUI(){a:;var a="",b;if(this.cchMaxLength=="")this.cchMaxLength="255";else this.cchMaxLength=String(Number(this.cchMaxLength));if(this.cchDisplaySize!=undefined)b=Number(this.cchDisplaySize);else if(Number(this.cchMaxLength)<32)b=Number(this.cchMaxLength);a+="<input "+FormTabIndex()+" ";if(Boolean(b))a+=this.frm.stInputStyle+" size="+String(b);else a+=this.frm.stLongStyle;if(this.stValue.length>Number(this.cchMaxLength))this.stValue=this.stValue.substr(0,Number(this.cchMaxLength));var c=this.IMEMode?' style="ime-mode:'+this.IMEMode+'" ':"";a+=" maxlength="+this.cchMaxLength+" "+this.stAttributes+" name="+StAttrQuote(this.stName)+" title="+StAttrQuote(this.stDisplay)+" "+c+" value="+StAttrQuote(this.stValue)+">\r";this.frm.BuildFieldUI(this,a)}function FilenameFieldFieldFocus(){a:;var a=this.frm.FilenameFieldPost(this);if(!a.disabled){a.focus();a.select();return true}return false}function FilenameFieldFValidate(){a:;var a=this.frm.FilenameFieldPost(this);a.value=TrimWhiteSpaces(GetValueAttribute(a));if(GetValueAttribute(a).length>Number(this.cchMaxLength)){this.stError=StBuildParam(Strings.STS.L_FilenameFieldMax_Text,this.stDisplay,this.cchMaxLength);return false}if(this.fRequired&&GetValueAttribute(a)==""){this.stError=StBuildParam(Strings.STS.L_FieldRequired_Text,this.stDisplay);return false}return true}function GridChoiceFieldFocus(){a:;return true}function GridChoiceField(d,c,a,b){d.AddField(this,c,a,b);this.rgGridChoices=[]}function GridChoiceBuildUI(){a:;var a="",g,c,o=this.frm.rgfld[this.frm.ifldMax-1].stDisplay,p=this.frm.rgfld[this.frm.ifldMax-1].stName,e=this.frm.rgfld[this.frm.ifldMax-1].stValue,m=this.rgGridChoices.length;this.iGridHeight=m;this.IsNew=e=="";var b=99,l=STSHtmlEncode(this.GridNATxt)==""?"":'<td align="right" class="ms-gridT1">&nbsp;</td>';a+=this.frm.StFieldPost(this);a+='<table cellpadding="0" cellspacing="1" border="0" height="95%">\r';a+='<tr><td>&nbsp;</td><td class="ms-verticaldots">&nbsp;</td>\r';a+='<td class="ms-gridT1">'+STSHtmlEncode(this.GridTxtRng1)+'&nbsp;</td><td align="center" class="ms-gridT1" colspan="';a+=String(this.GridEndNum-2)+'">'+STSHtmlEncode(this.GridTxtRng2)+'</td><td align="right" class="ms-gridT1">&nbsp;'+STSHtmlEncode(this.GridTxtRng3)+"</td>\r";a+=l+"</tr>\r";a+='<tr><td>&nbsp;</td><td class="ms-verticaldots">&nbsp;</td>\r';for(g=this.GridStartNum;g<=this.GridEndNum&&b>0;g++){a+='<td align="center" class="ms-gridT1">';a+=String(g);a+="</td>\r";b--}if(STSHtmlEncode(this.GridNATxt)!=""){a+='<td align="center" class="ms-gridT1">';a+=STSHtmlEncode(this.GridNATxt);a+="</td>\r";a+="</tr>"}a+='<tr><td class="ms-sectionline" colspan="100%" height="1"><img alt=\'\' src=';a+=StAttrQuote(this.frm.stImagesPath+"blank.gif");a+="</td></tr>";for(var i in this.rgGridChoices){var h=this.rgGridChoices[i],j=-999;if(!this.IsNew){var f=h.stDisplay.length,d=e.indexOf(h.stDisplay+";#",0);if(d!=-1){var k=e.indexOf("#",d+f+2);if(k>d+f+2)j=Number(e.substr(d+f+2,k-(d+f+2)))}}a+='<tr><td align="center" class="ms-gridText">';a+=STSHtmlEncode(h.stDisplay);a+='</td><td class="ms-verticaldots">&nbsp;</td>';b=99;var n=STSHtmlEncode(this.GridNATxt)==""?this.GridEndNum-1:this.GridEndNum;for(c=this.GridStartNum;c<=n&&b>0;c++){a+='<td align="center"><input '+FormTabIndex()+" ";if(this.nochange=="yes")a+='onclick="window.location.reload();"';a+=' type="RADIO" name=';a+=StAttrQuote(this.frm.StFieldName(g_fld,"RadioButtons:")+i);if(c-0==j-0)a+=" checked ";a+="></td>\r";b--}a+='<td align="center"><input '+FormTabIndex()+" ";if(this.nochange=="yes")a+='onclick="window.location.reload();"';a+=' type="RADIO" name=';a+=StAttrQuote(this.frm.StFieldName(g_fld,"RadioButtons:")+i);if(c-0==j-0)a+=" checked ";a+="></td>\r";a+="</tr>\r"}a+="</table>";this.frm.BuildFieldUI(this,a)}function GridChoiceFValidate(){a:;var d=this.frm.FieldPost(this);d.value="";var b="",c;for(c in this.rgGridChoices)for(var e=this.frm.FieldSubPart(this,"RadioButtons:"+c),f=this.GridNATxt==""?this.GridEndNum:this.GridEndNum-0+1,a=this.GridStartNum;a<=f;a++)if(e[a-this.GridStartNum].checked){b+=this.rgGridChoices[c].stValue+";#";b+=a>=0?"+"+String(a):String(a);b+="#";break}if(this.fRequired&&b==""){this.stError=StBuildParam(Strings.STS.L_FieldRequired_Text,this.stDisplay);return false}d.value=b;return true}function GridChoiceAddChoice(c,a){a:;if(a==null||a=="")a=c;var b={};b.stDisplay=c;b.stValue=a;this.rgGridChoices[this.rgGridChoices.length]=b}function ChoiceField(c,b,d,e){c.AddField(this,b,d,e);this.rgChoices=[];this.format="Dropdown";this.fFillInChoice=false;this.radioClass="class=ms-RadioText ";if(b=="ContentType"){var a={};a.frm=c;a.stName="ContentTypeId";this.fldCtId=a}this.tableClass=""}function ChoiceBuildUI(){a:;if(this.rgChoices.length==0)return;if(this.format!="Dropdown"&&this.format!="RadioButtons"&&this.format!="Checkboxes")this.format="Dropdown";var a=this.stBuildUI();if(this.stName=="ContentType"){var c=document.getElementById("js_fld_delayed");c.outerHTML=a;for(var d in this.rgChoices){var b=this.rgChoices[d];this.frm.rgctNames.push(b.stValue)}}else this.frm.BuildFieldUI(this,a)}function stChoiceBuildUI(){a:;if(this.rgChoices.length==0)return;var st="",i,choice,stClickAttr,stTitle,stKeyDownAttr,stControlName="NAME="+StAttrQuote(this.frm.StFieldName(this,this.format));if(this.fFillInChoice){var fillin_value="",stFillInButtonName=this.frm.StFieldName(this,"FillInButton");(this.format=="RadioButtons"||this.format=="Checkboxes")&&this.AddChoice(Strings.STS.L_SpecifyYourOwn_Text)}FBlankString(this.stValue)&&this.format=="Dropdown"&&this.stName!="ContentType"&&this.AddChoice("");if(typeof this.fldCtId!="undefined")st+=this.frm.StFieldPost(this.fldCtId);st+=this.frm.StFieldPost(this);if(this.format=="RadioButtons"){if(this.radioClass.indexOf("valign")==-1&&this.radioClass.indexOf("VALIGN")==-1)this.radioClass+=' valign="middle"';st+='<table cellpadding="0" cellspacing="1" '+this.tableClass+" >\r";var fValueMatched=false;for(i in this.rgChoices){choice=this.rgChoices[i];var stRawClickAttr="frm.SetRadioValue("+STSScriptEncodeWithQuote(this.stName)+", "+STSScriptEncodeWithQuote(choice.stValue)+");";stTitle="";if(this.stDisplay.length>0||choice.stDisplay.length>0)stTitle=this.stDisplay+": "+choice.stDisplay;stClickAttr="onclick="+StAttrQuote(stRawClickAttr);if(this.fIncludeMouseDown){stClickAttr+=" onmousedown="+StAttrQuote(stRawClickAttr);stClickAttr+=" onkeypress="+StAttrQuote(stRawClickAttr);stClickAttr+=" onmousewheel="+StAttrQuote(stRawClickAttr)}st+="<tr "+stClickAttr+'>\r<td valign="top"><input '+FormTabIndex()+' type="RADIO" '+this.stAttributes+" "+stControlName+" title="+StAttrQuote(stTitle)+" value="+StAttrQuote(choice.stValue);if(this.fFillInChoice&&!fValueMatched&&Number(i)==this.rgChoices.length-1&&this.stValue!=""){st+=" CHECKED";fillin_value=this.stValue}else if(choice.stValue==this.stValue){st+=" CHECKED";fValueMatched=true}st+="></td>\r<td "+this.radioClass+">";if(this.nobr)st+="<nobr>";st+=STSHtmlEncode(choice.stDisplay);if(choice.hasLayoutProc)st+=eval(choice.stLayoutProc+"(this, stRawClickAttr)");if(this.nobr)st+="</nobr>";st+="</td>\r</tr>\r"}if(this.fFillInChoice){fillin_value=RemoveReplaceDelimiter(fillin_value);stClickAttr="frm.SetFillInButton("+STSScriptEncodeWithQuote(this.stName)+");";stKeyDownAttr="frm.SetFillInButton("+STSScriptEncodeWithQuote(this.stName)+");";stClickAttr="onclick="+StAttrQuote(stClickAttr);stKeyDownAttr="onkeydown="+StAttrQuote(stKeyDownAttr);stControlName="NAME="+StAttrQuote(this.frm.StFieldName(g_fld,"FillIn"));if(fillin_value.length>255)fillin_value=fillin_value.substr(0,255);st+='<tr>\r<td valign="top"></td>\r<td class="ms-RadioText" valign="top"><input '+FormTabIndex()+' maxlength="255" '+stClickAttr+" "+stKeyDownAttr+" "+this.frm.stLongStyle+" "+this.stAttributes+" "+stControlName+" title="+StAttrQuote(this.stDisplay+": "+Strings.STS.L_FillInValue_Text);st+=this.IMEMode?' style="ime-mode:'+this.IMEMode+'" ':"";st+=" value="+STSHtmlEncode(fillin_value)+"></td>\r</tr>\r"}st+="</table>\r"}else if(this.format=="Checkboxes"){if(this.radioClass.indexOf("valign")==-1&&this.radioClass.indexOf("VALIGN")==-1)this.radioClass+=' valign="middle" ';st+='<table cellpadding="0" cellspacing="1" '+this.tableClass+" >\r";var stValue=this.stValue,fMultiValue=false;if(stValue.charAt(0)==";"&&stValue.charAt(1)=="#")fMultiValue=true;var count=0;if(this.horizontal)st+="<tr>\r";for(i in this.rgChoices){choice=this.rgChoices[i];stClickAttr="frm.RevertSelect("+STSScriptEncodeWithQuote(this.stName)+", "+STSScriptEncodeWithQuote(choice.stValue)+");";stTitle=this.stDisplay+": "+STSHtmlEncode(choice.stDisplay);stClickAttr="onclick="+StAttrQuote(stClickAttr);if(!this.horizontal)st+="<tr>\r";st+='<td valign="top">';st+="<input "+FormTabIndex()+' type="CHECKBOX" '+this.stAttributes+" "+stControlName+" title="+StAttrQuote(stTitle)+" value="+StAttrQuote(choice.stValue);if(fMultiValue){var searchPattern=";#"+choice.stValue+";#",startLocal=stValue.indexOf(searchPattern);if(startLocal!=-1){st+=" CHECKED";var end=startLocal+searchPattern.length;stValue=stValue.substr(0,startLocal+2)+stValue.substr(end);if(stValue==";#;#")stValue=""}}else if(stValue==choice.stValue){st+=" CHECKED";stValue=""}st+="></td>\r<td "+this.radioClass;st+=stClickAttr+">"+STSHtmlEncode(choice.stDisplay);st+="</td>\r";if(!this.horizontal)st+="</tr>\r";else if(Boolean(this.horizontalBreakEvery)&&0==++count%this.horizontalBreakEvery)st+="</tr>\r<tr>\r"}if(this.horizontal)st+="</tr>\r";fillin_value=RemoveReplaceDelimiter(stValue);if(this.fFillInChoice){stClickAttr="frm.SetFillInButton("+STSScriptEncodeWithQuote(this.stName)+");";stKeyDownAttr="frm.SetFillInButton("+STSScriptEncodeWithQuote(this.stName)+");";stClickAttr="onclick="+StAttrQuote(stClickAttr);stKeyDownAttr="onkeydown="+StAttrQuote(stKeyDownAttr);stControlName="name="+StAttrQuote(this.frm.StFieldName(this,"FillIn"));if(Number(fillin_value)>255)fillin_value=fillin_value.substr(0,255);st+='<tr>\r<td valign="top"></td>\r<td class="ms-RadioText" valign="top"><input '+FormTabIndex()+' maxlength="255" '+stClickAttr+" "+stKeyDownAttr+" "+this.frm.stLongStyle+" "+this.stAttributes+" "+stControlName+" title="+StAttrQuote(this.stDisplay+": "+Strings.STS.L_FillInValue_Text)+" value="+STSHtmlEncode(fillin_value)+"></td>\r</tr>\r"}st+="</table>\r"}else{if(!this.horizontal)st+='<table cellpadding="0" cellspacing="1" '+this.tableClass+" >\r";var fDropdownSelected=false;stClickAttr="";if(this.fFillInChoice){stClickAttr="frm.UnsetFillInButton("+STSScriptEncodeWithQuote(this.stName)+");";stClickAttr="onclick="+StAttrQuote(stClickAttr)}else if(this.stName=="ContentType")stClickAttr='onchange="SwitchControls(this,false,true)"';var stControls="";if(!this.horizontal)stControls+="<td";else stControls+="<span";stControls+=' class="ms-RadioText" valign="top"><select title=';if(this.fFillInChoice)stControls+=StAttrQuote(this.stDisplay+": "+Strings.STS.L_FillChoice_TXT);else stControls+=StAttrQuote(this.stDisplay);stControls+=this.IMEMode?' style="ime-mode:'+this.IMEMode+'" ':"";stControls+=" "+FormTabIndex()+" "+this.stAttributes+stClickAttr+stControlName+">\r";for(i in this.rgChoices){choice=this.rgChoices[i];stControls+="<option  value="+StAttrQuote(choice.stValue);if(choice.stValue==this.stValue){stControls+=" SELECTED";fDropdownSelected=true}stControls+=">"+STSHtmlEncode(choice.stDisplay)+"</option>\r"}stControls+="</select>";if(!this.horizontal)stControls+="</td>\r";else stControls+="</span>\r";if(this.fFillInChoice){var stDropdownButton='<tr>\r<td valign="top"><input '+FormTabIndex()+" title="+StAttrQuote(this.stDisplay+": "+Strings.STS.L_Choose_Text)+' type="RADIO" NAME='+StAttrQuote(stFillInButtonName);if(fDropdownSelected||this.stValue=="")stDropdownButton+=" CHECKED";stDropdownButton+="></td>\r"+stControls+"</tr>\r";stControls=stDropdownButton;stClickAttr="frm.SetFillInButton("+STSScriptEncodeWithQuote(this.stName)+");";stClickAttr="onclick="+StAttrQuote(stClickAttr);stControls+="<tr "+stClickAttr+'>\r<td valign="top"><input title=';stControls+=StAttrQuote(this.stDisplay+": "+Strings.STS.L_SpecifyYourOwn_Text);stControls+=this.IMEMode?' style="ime-mode:'+this.IMEMode+'" ':"";stControls+=" "+FormTabIndex()+' type="RADIO" name='+StAttrQuote(stFillInButtonName);if(!fDropdownSelected&&this.stValue!=""){stControls+=" CHECKED";fillin_value=this.stValue}stControls+='></td>\r<td class="ms-descriptiontext" valign="middle">'+Strings.STS.L_SpecifyYourOwn_Text+"</td>\r</tr>\r";fillin_value=RemoveReplaceDelimiter(fillin_value);stControlName="name="+StAttrQuote(this.frm.StFieldName(g_fld,"FillIn"));stControls+='<tr>\r<td valign="top"></td>\r<td class="ms-RadioText" valign="top"><input ';stControls+=this.IMEMode?' style="ime-mode:'+this.IMEMode+'" ':"";stControls+=" title=";stControls+=StAttrQuote(this.stDisplay+": "+Strings.STS.L_FillInValue_Text);if(Number(fillin_value)>255)fillin_value=fillin_value.substr(0,255);stControls+=" "+FormTabIndex()+' maxlength="255" '+stClickAttr+" "+this.frm.stLongStyle+" "+this.stAttributes+" "+stControlName+" value="+STSHtmlEncode(fillin_value)+"></td>\r</tr>\r";st+=stControls}else if(!this.horizontal)st+="<tr>"+stControls+"</tr>\r";else st+=stControls+"\r";if(!this.horizontal)st+="</table>\r"}return st}function ChoiceInit(){a:;if(this.rgChoices.length==0)return;this.SetValue(this.stValue)}function ChoiceAddChoice(c,b){if(b==null||b=="")b=c;var a={};a.stDisplay=c;a.stValue=b;a.hasLayoutProc=false;this.rgChoices[this.rgChoices.length]=a;return a}function ChoiceAddChoiceWithLayoutProc(b,c,d){a:;var a=this.AddChoice(b,c);a.stLayoutProc=d;a.hasLayoutProc=true}function ChoiceDataBind(){a:;if(this.rgChoices.length==0)return;var d=this.frm.FieldPost(this),e=this.GetControl(),b=GetValueAttribute(d);if(typeof this.fldCtId!="undefined"){var c=this.frm.FieldPost(this.fldCtId),a=this.frm.ctIdToName[GetValueAttribute(c)];if(typeof a!="undefined")b=a}this.SetValue(b,true)}function ChoiceSetValue(a,g){if(this.rgChoices.length==0)return;var c,d,b=this.frm.FieldSubPart(this,this.format);if(this.format=="Checkboxes"){if(this.rgChoices.length!=1)for(c in this.rgChoices)b[c].checked=false;else b.checked=false;if(this.fFillInChoice){this.SetFillInValue("");this.UnsetFillInButton()}if(FBlankString(a))return}if(this.format=="Checkboxes"&&a.charAt(0)==";"&&a.charAt(1)=="#"){for(c in this.rgChoices){d=this.rgChoices[c];var h=";#"+d.stValue+";#",f=a.indexOf(h);if(f!=-1){b=this.GetControl(c);b.checked=true;var j=f+h.length;a=a.substr(0,f+2)+a.substr(j);if(a==";#;#")break}}if(this.fFillInChoice){if(a.length>=4&&a.indexOf(";#;#")==a.length-4)a=a.substr(0,a.length-2);a=RemoveReplaceDelimiter(a);if(a!="")this.SetFillInValue(a);else{this.UnsetFillInButton();if(g)this.GetFillInControl().value=""}}return}var i=true;for(c in this.rgChoices){d=this.rgChoices[c];if(d.stValue==a){if(this.format=="Dropdown"){if(this.stName!="ContentType")b.selectedIndex=Number(c);else for(var e=0;e<b.options.length;e++)if(GetValueAttribute(b.options[e])==a){b.selectedIndex=e;break}}else{b=this.GetControl(c);b.checked=true}i=false;break}}if(this.fFillInChoice)if(i||a==Strings.STS.L_SpecifyYourOwn_Text)a!=Strings.STS.L_SpecifyYourOwn_Text&&this.SetFillInValue(a);else{this.UnsetFillInButton();if(g)this.GetFillInControl().value=""}return}function ChoiceGetControl(b){var a=this.frm.FieldSubPart(this,this.format);if((this.format=="RadioButtons"||this.format=="Checkboxes")&&this.rgChoices.length!=1){if(b!=null)return a[b];for(b in this.rgChoices)if(a[b].checked)return a[b];return a[0]}else return a}function ChoiceGetFillInButtonControl(){a:;if(this.format=="Dropdown"){var a=this.frm.FieldSubPart(this,"FillInButton");return a[1]}else{var b=this.frm.FieldSubPart(this,this.format);return b[this.rgChoices.length-1]}}function ChoiceGetFillInControl(){a:;return this.frm.FieldSubPart(this,"FillIn")}function ChoiceFieldFocus(){a:;if(this.rgChoices.length==0)return false;var a=false;if(this.fFillInChoice)if(this.format=="RadioButtons"||this.format=="Checkboxes"){var d=this.frm.FieldSubPart(this,this.format),b;for(b in this.rgChoices)if(d[b].checked)break;if(Number(b)==this.rgChoices.length-1)a=true}else{var e=this.GetFillInButtonControl();if(e.checked)a=true}var c=a?this.GetFillInControl():this.GetControl();if(!c.disabled){try{c.focus()}catch(f){}return true}return false}function ChoiceFValidate(){a:;if(this.rgChoices.length==0)return;var a=this.frm.FieldPost(this);a.value="";if(this.fFillInChoice)var i=this.GetFillInButtonControl(),c=this.GetFillInControl();var b=this.format=="Checkboxes"&&this.rgChoices.length!=1?this.frm.FieldSubPart(this,this.format):this.GetControl();if(this.format=="Dropdown")if(this.fFillInChoice&&i.checked){if(-1!=GetValueAttribute(c).indexOf(";#")){this.stError=StBuildParam(Strings.STS.L_InvalidFillIn_Text,this.stDisplay);return false}a.value=TrimWhiteSpaces(GetValueAttribute(c))}else{if(b.selectedIndex!=-1)a.value=GetValueAttribute(b[b.selectedIndex]);if(typeof this.fldCtId!="undefined"){var k=this.frm.FieldPost(this.fldCtId),j=this.frm.ctNameToId[GetValueAttribute(a)];k.value=typeof j!="undefined"?j:""}}else if(this.format=="Checkboxes"&&this.rgChoices.length!=1){var e="",d="",g=0;for(var h in this.rgChoices)if(b[h].checked==true){if(this.fFillInChoice&&Number(h)==this.rgChoices.length-1){var f=TrimWhiteSpaces(GetValueAttribute(c));if(f=="")break;if(-1!=f.indexOf(";#")){this.stError=StBuildParam(Strings.STS.L_InvalidFillIn_Text,this.stDisplay);return false}d=f}else d=this.rgChoices[h].stValue;g++;if(g==1)e=d;else if(g==2)e=";#"+e+";#"+d+";#";else e+=d+";#"}a.value=e}else if(this.fFillInChoice&&i.checked){if(-1!=GetValueAttribute(c).indexOf(";#")){this.stError=StBuildParam(Strings.STS.L_InvalidFillIn_Text,this.stDisplay);return false}a.value=TrimWhiteSpaces(GetValueAttribute(c))}else if(b.checked)a.value=GetValueAttribute(b);if(this.fRequired&&GetValueAttribute(a)==""){this.stError=StBuildParam(Strings.STS.L_FieldRequired_Text,this.stDisplay);return false}if(this.frm.wBaseType==1&&Boolean(GetValueAttribute(a))&&GetValueAttribute(a).length>255){this.stError=StBuildParam(Strings.STS.L_TextFieldMax_Text,this.stDisplay,255);return false}return true}function ChoiceRevertSelect(c){a:;if(c=="")return;for(var b in this.rgChoices){var e=this.rgChoices[b];if(e.stValue==c){var a=this.GetControl(b);if(a.checked)a.checked=false;else{a.checked=true;if(this.fFillInChoice&&Number(b)==this.rgChoices.length-1){var d=this.GetFillInControl();!d.disabled&&d.focus()}}break}}}function ChoiceFieldSetFillInButton(){a:;var b=this.GetFillInButtonControl();b.checked=true;var a=this.GetFillInControl();a.focus()}function ChoiceFieldUnsetFillInButton(){a:;if(this.format=="Dropdown"){var a=this.frm.FieldSubPart(this,"FillInButton");a[0].checked=true}else{var b=this.GetFillInButtonControl();b.checked=false}}function ChoiceSetFillInValue(c){a:;var b=this.GetFillInButtonControl();b.checked=true;var a=this.GetFillInControl();a.value=c}function RemoveReplaceDelimiter(a){a:;a=a.replace(/^;#/g,"");a=a.replace(/;#$/g,"");a=a.replace(/;#/g,"; ");return a}var _RecurDateRangeDiv,_RecurPatternTextDiv,_RecurDailyDiv,_RecurWeeklyDiv,_RecurMonthlyDiv,_recurFld;function RecurrencePattern(c,e,d){c.AddField(this,e,d,"");this.fSkipValidation=true;this.isModifyException=false;this.isNewModifyException=false;this.stStartDate="";this.stEndDate="";this.caltype=1;this.todayiso="";this.stPrefix="RecurrencePattern#";this.iCustom="1";this.fDoCustom=false;this.rgStRecurType=[Strings.STS.L_RecurPatternNone_Text,Strings.STS.L_RecurPatternCustom_Text,Strings.STS.L_RecurPatternDaily_Text,Strings.STS.L_RecurPatternWeekly_Text,Strings.STS.L_RecurPatternMonthly_Text,Strings.STS.L_RecurPatternYearly_Text];var a=0;for(var f in this.rgStRecurType)a=Math.max(a,this.rgStRecurType[f].length);this.ccRecurType=a+14;this.rgStRangeType=[Strings.STS.L_RangeTypeNone_Text,Strings.STS.L_RangeTypeCount_Text,Strings.STS.L_RangeTypeEndDate_Text];this.recurrencePatternChoice="0";this.monthlyChoiceValue="0";this.dateRangeEndChoice="0";this.dayFrequency=Strings.STS.L_DayFrequency_Text;this.weekFrequency=Strings.STS.L_WeekFrequency_Text;this.monthFrequency1=Strings.STS.L_MonthFrequency_Text;this.monthFrequency2=Strings.STS.L_MonthFrequency_Text;var b=c.dopt.Today();this.weeklyDayMultiValue=";#"+String(b.getUTCDay())+";#";this.monthly1DayValue=Strings.STS.L_Monthly1DayValue_Text;this.monthly2DayValue="0";this.monthly2WeekValue="0";this.dateRangeStart=DateOptions.StISODate(b);this.dateRangeEnd=DateOptions.StISODate(b);this.dateRangeEndOccurrences=Strings.STS.L_DateRangeEndOccurrencesValue_Text}function RecurrencePatternBuildUI(){a:;if(Number(this.recurrencePatternChoice)<0||Number(this.recurrencePatternChoice)>this.rgStRecurType.length)this.recurrencePatternChoice="0";if(Number(this.dateRangeEndChoice)<0||Number(this.dateRangeEndChoice)>this.rgStRangeType.length)this.dateRangeEndChoice="0";if(Number(this.monthlyChoiceValue)<0||Number(this.monthlyChoiceValue)>2)this.monthlyChoiceValue="0";var a="";if(this.isModifyException||this.isNewModifyException){if(this.isModifyException)a+="<input type='hidden' name="+StAttrQuote(this.frm.stFieldPrefix+this.stPrefix+"Modify:"+this.stName)+"value='TRUE'>\r";else if(this.isNewModifyException){a+="<input type='hidden' name="+StAttrQuote(this.frm.stFieldPrefix+this.stPrefix+"NewModify:"+this.stName)+"value='TRUE'>\r";a+="<input type='hidden' name="+StAttrQuote(this.frm.stFieldPrefix+g_fld.stRecurrenceIDName)+"value="+StAttrQuote(this.stRecurrenceID)+">\r";a+="<input type='hidden' name="+StAttrQuote(this.frm.stFieldPrefix+g_fld.stUIDName)+"value="+StAttrQuote(this.stUID)+">\r"}if(Boolean(this.stRecurrenceDescription))a+=STSHtmlEncode(this.stRecurrenceDescription);BFormDocumentWrite(a);this.eventHook=new RecurrencePatternEventHooks(this,this.frm,null,this.stStartDate,this.stEndDate);this.eventHook.value=0;this.eventHook.Init();return}var b=this.frm.FindField(this.stStartDate);if(Boolean(b)){a+="<input type='hidden' name="+StAttrQuote(this.frm.stFieldPrefix+this.stPrefix+"oldStartDate:"+this.stName)+"value='";a+=b.stValue;a+="'>\r"}_recurFld=this;a+="<table border='0' cellpadding='0' cellspacing='0' class='ms-formrecurrence'>\r";a+="<tr><td rowspan='5' nowrap>\r";a+=RecurrencePatternTypes(this);a+="</td>";a+="<td rowspan='5' nowrap><img width='40pt' height='1pt' src="+StAttrQuote(this.frm.stImagesPath+"blank.gif")+"></td></tr>\r";a+="<tr><td nowrap valign='top'><div id='"+_RecurPatternTextDiv+"' ";if(Number(this.recurrencePatternChoice)>1)a+="style='display:none'";a+=">\r";a+="<nobr><span class='ms-formdescription'>"+Strings.STS.L_Pattern_Text+"</span></nobr>";a+="</div></td></tr>\r";a+="<tr><td nowrap valign='top' rowspan='4' height='68pt'><table border='0' cellpadding='0' cellspacing='0' class='ms-formrecurrence'>";a+="<tr><td nowrap><img width='12pt' height='1pt' src="+StAttrQuote(this.frm.stImagesPath+"blank.gif")+"></td></tr>";a+="<tr><td nowrap valign='top'><div id='"+_RecurDailyDiv+"' ";if(this.recurrencePatternChoice!="2")a+="style='display:none'";a+=">\r";a+=RecurrencePatternDaily(this);a+="</div></td></tr>\r";a+="<tr><td nowrap valign='top'><div id='"+_RecurWeeklyDiv+"' ";if(this.recurrencePatternChoice!="3")a+="style='display:none'";a+=">\r";a+=RecurrencePatternWeekly(this);a+="</div></td></tr>\r";a+="<tr><td nowrap valign='top'><div id='"+_RecurMonthlyDiv+"' ";if(this.recurrencePatternChoice!="4")a+="style='display:none'";a+=">\r";a+=RecurrencePatternMonthly(this);a+="</div></td></tr></table></td></tr></table>\r";BFormDocumentWrite(a);a="<div ID='"+_RecurDateRangeDiv+"' ";if(Number(this.recurrencePatternChoice)>1)a+="style='display:none'";a+=">\r";a+="<table border='0' cellpadding='0' cellspacing='0' class='ms-formrecurrence'><tr>\r";a+="<td nowrap><img width='116pt' height='1pt' src="+StAttrQuote(this.frm.stImagesPath+"blank.gif")+"></td>";a+="<td valign=\"top\" nowrap><nobr><span class='ms-formdescription'>"+Strings.STS.L_DateRange_Text+"</span><br><br>"+Strings.STS.L_StartDateRange_Text+"</nobr><br>";a+=RecurrenceDateRangeStart(this);a+="</td>";a+="<td nowrap><img width=\"10pt\" height='1pt' src="+StAttrQuote(this.frm.stImagesPath+"blank.gif")+"></td><td nowrap><br><br>";a+=RecurrenceDateRangeEnd(this);a+="</td></tr></table></div>\r";BFormDocumentWrite(a);_recurFld=null}function RecurrencePatternInit(){a:;if(this.isModifyException||this.isNewModifyException){var a=this.frm.FindField(this.stEndDate);if(Boolean(a))a.fRequired=true}}function RecurrencePatternTypes(a){a:;var d="";g_fld=new ChoiceField(a.frm,a.stPrefix+"Type:"+a.stName,Strings.STS.L_RecurrenceType_Text,a.recurrencePatternChoice);g_fld.format="RadioButtons";g_fld.radioClass="class=ms-radiotext ";for(var b in a.rgStRecurType){var c="";if(b!=a.iCustom||a.fDoCustom){c=b;g_fld.AddChoice(a.rgStRecurType[b],c)}}d+=g_fld.stBuildUI();a.eventHook=new RecurrencePatternEventHooks(a,a.frm,g_fld,a.stStartDate,a.stEndDate);a.eventHook.Init();return d}function RecurrencePatternDaily(b){a:;var c="",a=new NumberField(b.frm,b.stPrefix+"daily_dayFrequency:"+b.stName,Strings.STS.L_DailyDisplay_Text,b.dayFrequency);a.cchDisplaySize=3;a.wMin=1;a.wMax=255;a.fInteger=true;a.fSkipValidation=true;_recurFld.dayFrequencyFld=a;var d=a.stBuildUI();c=StBuildParam(Strings.STS.L_Daily_Text,d);c+="<p><p>";return c}function RecurrencePatternWeekly(a){a:;var c=new NumberField(a.frm,a.stPrefix+"weekly_weekFrequency:"+a.stName,Strings.STS.L_WeeklyRecurDisplay_Text,a.weekFrequency);c.cchDisplaySize=3;c.wMin=1;c.wMax=52;c.fInteger=true;c.fSkipValidation=true;a.weeklyFrequencyFld=c;var k=c.stBuildUI(),e=[Strings.STS.L_Sunday_Text,Strings.STS.L_Monday_Text,Strings.STS.L_Tuesday_Text,Strings.STS.L_Wednesday_Text,Strings.STS.L_Thursday_Text,Strings.STS.L_Friday_Text,Strings.STS.L_Saturday_Text],d=StURLGetVar("Source");if(Boolean(d.length)){d=unescape(d);var f=StSearchVar(d,"CalendarDate"),j=StSearchVar(d,"CalendarPeriod");if(j=="day"&&Boolean(f.length)){var g=DateOptions.ParseISODate(f);if(!isNaN(Number(g)))a.weeklyDayMultiValue=";#"+String(g.getUTCDay())+";#"}}var b=new ChoiceField(a.frm,a.stPrefix+"weekly_multiDays:"+a.stName,Strings.STS.L_WeeklyDayChoiceDisplay_Text,a.weeklyDayMultiValue);b.format="Checkboxes";b.radioClass=" class=ms-input valign=baseline ";b.tableClass=" class=ms-formrecurrence ";b.horizontal=true;b.horizontalBreakEvery=4;a.weeklyMultiDayFld=b;var h="";for(var i in e){h=i;b.AddChoice(e[i],h)}var l="<DIV>"+b.stBuildUI()+"</DIV>";return StBuildParam(Strings.STS.L_Weekly_Text,k,l)}function RecurrencePatternMonthly(a){a:;g_fld=new ChoiceField(a.frm,a.stPrefix+"MonthlyRecurType:"+a.stName,"",a.monthlyChoiceValue);g_fld.format="RadioButtons";g_fld.radioClass="class=ms-input valign=baseline";g_fld.tableClass=" class=ms-formrecurrence ";g_fld.fIncludeMouseDown=true;g_fld.nobr=true;a.monthlyChoiceFld=g_fld;g_fld.AddChoiceWithLayoutProc("","0","RecurrencePatternMonthly1");g_fld.AddChoiceWithLayoutProc("","1","RecurrencePatternMonthly2");var b=g_fld.stBuildUI();return b}function RecurrencePatternMonthly1(){a:;var b=new NumberField(_recurFld.frm,_recurFld.stPrefix+"monthly_day:"+_recurFld.stName,Strings.STS.L_Monthly1DayDisplay_Text,_recurFld.monthly1DayValue);b.cchDisplaySize=2;b.wMin=1;b.wMax=31;b.fInteger=true;b.fSkipValidation=true;_recurFld.monthlyChoice1DayFld=b;var c=b.stBuildUI(),a=new NumberField(_recurFld.frm,_recurFld.stPrefix+"monthly_monthFrequency:"+_recurFld.stName,Strings.STS.L_Monthly1MonthDisplay_Text,_recurFld.monthFrequency1);a.cchDisplaySize=2;a.wMin=1;a.wMax=12;a.fInteger=true;a.fSkipValidation=true;_recurFld.monthlyChoice1MonthFreqFld=a;var d=a.stBuildUI();return StBuildParam(Strings.STS.L_Monthly1_Text,c,d)}function RecurrencePatternMonthly2(){a:;var d=[Strings.STS.L_FirstWeek_Text,Strings.STS.L_SecondWeek_Text,Strings.STS.L_ThirdWeek_Text,Strings.STS.L_FourthWeek_Text,Strings.STS.L_LastWeek_Text],e=[Strings.STS.L_Sunday_Text,Strings.STS.L_Monday_Text,Strings.STS.L_Tuesday_Text,Strings.STS.L_Wednesday_Text,Strings.STS.L_Thursday_Text,Strings.STS.L_Friday_Text,Strings.STS.L_Saturday_Text];a=new ChoiceField(_recurFld.frm,_recurFld.stPrefix+"monthlyByDay_weekOfMonth:"+_recurFld.stName,Strings.STS.L_Monthly2WhichWeekDisplay_Text,_recurFld.monthly2WeekValue);var c="",b;a.horizontal=true;for(b in d){c=b;a.AddChoice(d[b],c)}var f=a.stBuildUI();a=new ChoiceField(_recurFld.frm,_recurFld.stPrefix+"monthlyByDay_day:"+_recurFld.stName,Strings.STS.L_Monthly2DayDisplay_Text,_recurFld.monthly2DayValue);a.horizontal=true;for(b in e){c=b;a.AddChoice(e[b],c)}var g=a.stBuildUI(),a=new NumberField(_recurFld.frm,_recurFld.stPrefix+"monthlyByDay_monthFrequency:"+_recurFld.stName,Strings.STS.L_Monthly2MonthDisplay_Text,_recurFld.monthFrequency2);a.cchDisplaySize=2;a.wMin=1;a.wMax=12;a.fInteger=true;a.fSkipValidation=true;_recurFld.monthlyChoice2MonthFreqFld=a;var h=a.stBuildUI();return StBuildParam(Strings.STS.L_Monthly2_Text,f,g,h)}function RecurrenceDateRangeStart(a){a:;var b="<nobr>\r";g_fld=new DateField(a.frm,a.stPrefix+"windowStart:"+a.stName,Strings.STS.L_DateRangeStartDisplay_Text,a.todayiso);g_fld.fRequired=true;g_fld.fSkipValidation=true;g_fld.caltype=a.caltype;a.dateRangeFldStart=g_fld;g_fld.fDateOnly=true;g_fld.fHideDateSpan=true;b+=g_fld.stBuildUI();b+="</nobr>\r";return b}function RecurrenceDateRangeEnd(a){a:;g_fld=new ChoiceField(a.frm,a.stPrefix+"EndDateRangeType:"+a.stName,Strings.STS.L_DateRangeTypeDisplay_Text,a.dateRangeEndChoice);a.endRangeOptionFld=g_fld;g_fld.format="RadioButtons";g_fld.tableClass="class='ms-formrecurrence'";g_fld.radioClass="class=ms-input valign=baseline";g_fld.fIncludeMouseDown=true;g_fld.nobr=true;g_fld.AddChoice(a.rgStRangeType[0],"0");g_fld.AddChoiceWithLayoutProc(a.rgStRangeType[1],"1","RecurrenceEndDateRange1");g_fld.AddChoiceWithLayoutProc(a.rgStRangeType[2],"2","RecurrenceEndDateRange2");return g_fld.stBuildUI()}function RecurrenceEndDateRange1(){a:;var a=new NumberField(_recurFld.frm,_recurFld.stPrefix+"repeatInstances:"+_recurFld.stName,Strings.STS.L_DateRangeOccurrencesDisplay_Text,_recurFld.dateRangeEndOccurrences);a.cchDisplaySize=4;a.wMin=1;a.wMax=999;a.fInteger=true;a.fSkipValidation=true;_recurFld.dateRangeFldEndOccurrances=a;var b=a.stBuildUI();return StBuildParam(Strings.STS.L_EndDateRange_Text,b)}function RecurrenceEndDateRange2(c,b){a:;var a=new DateField(_recurFld.frm,_recurFld.stPrefix+"windowEnd:"+_recurFld.stName,Strings.STS.L_DateRangeEndDisplay_Text,"");a.fRequired=true;a.fSkipValidation=true;a.caltype=_recurFld.caltype;_recurFld.dateRangeFldEnd=a;a.fDateOnly=true;a.fHideDateSpan=true;a.stPopUpOnClick2=b;return a.stBuildUI()}function RecurrencePatternEventHooks(e,b,a,c,d){this.recurFld=e;this.frm=b;this.typeFld=a;this.stStartDate=c;this.stEndDate=d;b.AddField(this,"RecurrencePatternType","Date range, end pattern","0");if(Boolean(a))a.stAlias="RecurrencePatternType";this.rgStPatternTypes=["","",_RecurDailyDiv,_RecurWeeklyDiv,_RecurMonthlyDiv,""];this.value=-1}function RecurrencePatternEventHooksInit(){a:;this.dateFldStart=this.frm.FindField(this.recurFld.stStartDate);this.dateFldEnd=this.frm.FindField(this.recurFld.stEndDate);this.dateRangeFldStart=this.recurFld.dateRangeFldStart;this.dateRangeFldEnd=this.recurFld.dateRangeFldEnd;var d="";d=StURLGetVar("ID");if(0==d.length)if(Boolean(this.dateFldStart)){var a=StURLGetVar("Source");if(Boolean(a.length)){a=unescape(a);var b=StSearchVar(a,"CalendarDate"),f=StSearchVar(a,"CalendarPeriod");if(f=="day"&&Boolean(b.length)){var c=DateOptions.ParseISODate(b);if(!isNaN(c)){b=this.frm.dopt.StDate(c);var g=this.frm.FieldSubPart(this.dateFldStart,"Date");g.value=b}}}var e=this.dateFldStart.disabled;this.dateFldStart.disabled=false;if(this.dateFldStart.FValidate()&&Boolean(this.dateFldStart.date)){this.dateFldStart.date.setUTCHours(0,0,0,0);this.frm.dopt.SetTimeControls(this.dateFldStart,this.dateFldStart.date)}this.dateFldStart.disabled=e}this.DateToDateRange();this.InitHooks()}function DoInitRecurrencePatternEventHooks(){a:;this.divtags=document.getElementsByTagName("div");this.stRecurDateRangeDiv=this.divtags[_RecurDateRangeDiv];this.stRecurPatternTextDiv=this.divtags[_RecurPatternTextDiv];var a=document.getElementsByTagName("span");this.stStartDateSpan=a[this.frm.StFieldNameFactory(this.stStartDate,"DateSpan")];this.stEndDateSpan=a[this.frm.StFieldNameFactory(this.stEndDate,"DateSpan")];this.typeFld!=null&&this.ToggleDisplay(this.typeFld.stValue,true)}function RecurrencePatternValidate(){a:;var a=false;this.errFld=null;if(GetValueAttribute(this)==0){if(!this.dateFldEnd.FValidate()||!(this.dateFldEnd.date!=null)){var g=this.frm.GetSelValue(this.frm.StFieldName(this.dateFldEnd,"Hours"))-0,f=this.frm.GetSelValue(this.frm.StFieldName(this.dateFldEnd,"Minutes"));(g!=0||f!=0)&&this.CopyDateFld(this.dateFldStart,this.dateFldEnd)}if(this.dateFldStart.FValidate()&&this.dateFldEnd.FValidate()&&Boolean(this.dateFldStart.date)&&Boolean(this.dateFldEnd.date)&&this.dateFldEnd.date.getTime()<this.dateFldStart.date.getTime()){this.errFld=this.dateFldStart;this.errFld.stError=Strings.STS.L_DateRangeOrdering_Text;return false}}else if(GetValueAttribute(this)>=2){if(!this.dateRangeFldStart.FValidate()){this.errFld=this.dateRangeFldStart;return false}if(this.recurFld.endRangeOptionFld!=null&&this.recurFld.endRangeOptionFld.FValidate()){var c=this.frm.FieldPost(this.recurFld.endRangeOptionFld),e=this.dateRangeFldEnd.FValidate();if(c==null||GetValueAttribute(c)=="2"){if(!e){this.errFld=this.dateRangeFldEnd;return false}if(this.dateRangeFldEnd.date.getTime()<this.dateRangeFldStart.date.getTime()){this.errFld=this.dateRangeFldStart;this.errFld.stError=Strings.STS.L_DateRangeOrdering_Text;return false}}else if(GetValueAttribute(c)=="1"){if(this.recurFld.dateRangeFldEndOccurrances!=null){this.recurFld.dateRangeFldEndOccurrances.fRequired=true;a=this.recurFld.dateRangeFldEndOccurrances.FValidate();this.recurFld.dateRangeFldEndOccurrances.fRequired=false;if(!a){var b=this.recurFld.dateRangeFldEndOccurrances;this.errFld=b;return false}}!e&&this.CopyDateFld(this.dateRangeFldStart,this.dateRangeFldEnd)}else!e&&this.CopyDateFld(this.dateRangeFldStart,this.dateRangeFldEnd)}if(GetValueAttribute(this)==2){if(this.recurFld.dayFrequencyFld!=null){this.recurFld.dayFrequencyFld.fRequired=true;a=this.recurFld.dayFrequencyFld.FValidate();this.recurFld.dayFrequencyFld.fRequired=false;if(!a){b=this.recurFld.dayFrequencyFld;this.errFld=b;return false}}}else if(GetValueAttribute(this)==3){if(this.recurFld.weeklyFrequencyFld!=null){this.recurFld.weeklyFrequencyFld.fRequired=true;a=this.recurFld.weeklyFrequencyFld.FValidate();this.recurFld.weeklyFrequencyFld.fRequired=false;if(!a){b=this.recurFld.weeklyFrequencyFld;this.errFld=b;return false}}if(this.recurFld.weeklyMultiDayFld!=null){this.recurFld.weeklyMultiDayFld.fRequired=true;a=this.recurFld.weeklyMultiDayFld.FValidate();this.recurFld.weeklyMultiDayFld.fRequired=false;if(!a){b=this.recurFld.weeklyMultiDayFld;this.errFld=b;return false}}}else if(GetValueAttribute(this)==4)if(this.recurFld.monthlyChoiceFld!=null&&this.recurFld.monthlyChoiceFld.FValidate()){var d=this.frm.FieldPost(this.recurFld.monthlyChoiceFld);if(d!=null)if(GetValueAttribute(d)=="0"){this.recurFld.monthlyChoice1DayFld.fRequired=true;a=this.recurFld.monthlyChoice1DayFld.FValidate();this.recurFld.monthlyChoice1DayFld.fRequired=false;if(!a){b=this.recurFld.monthlyChoice1DayFld;this.errFld=b;return false}this.recurFld.monthlyChoice1MonthFreqFld.fRequired=true;a=this.recurFld.monthlyChoice1MonthFreqFld.FValidate();this.recurFld.monthlyChoice1MonthFreqFld.fRequired=false;if(!a){b=this.recurFld.monthlyChoice1MonthFreqFld;this.errFld=b;return false}}else if(GetValueAttribute(d)=="1"){this.recurFld.monthlyChoice2MonthFreqFld.fRequired=true;a=this.recurFld.monthlyChoice2MonthFreqFld.FValidate();this.recurFld.monthlyChoice2MonthFreqFld.fRequired=false;if(!a){b=this.recurFld.monthlyChoice2MonthFreqFld;this.errFld=b;return false}}}}return true}function RecurrencePatternEventHooksSetValue(a){a:;this.typeFld.SetValue(a);this.ToggleDisplay(a,false)}function DisplayOff(a){if(a)if(a.length==0){DoDisplayOff(a);a.children&&DoDisplayOff(a.children)}else for(var b=0;b<Number(a.length);b++){DoDisplayOff(a[b]);a[b].children&&DoDisplayOff(a[b].children)}}function DoDisplayOff(a){if(a!=null)if(a.length==0){a.disabled=true;if(a.style!=null)a.style.display="none"}else for(var b=0;b<Number(a.length);b++){a[b].disabled=true;if(a[b].style)a[b].style.display="none"}}function DisplayOn(a){if(a)if(!a.length){DoDisplayOn(a);a.children&&DoDisplayOn(a.children)}else for(var b=0;b<Number(a.length);b++){DoDisplayOn(a[b]);a[b].children&&DoDisplayOn(a[b].children)}}function DoDisplayOn(a){if(a)if(!a.length){a.disabled=false;if(a.style)a.style.display=""}else for(var b=0;b<Number(a.length);b++){a[b].disabled=false;if(a[b].style)a[b].style.display=""}}function FieldsDisabled(a){if(a)if(!a.length){a.disabled=true;if(a.style)a.style.visibility="hidden"}else for(var b=0;b<Number(a.length);b++){a[b].disabled=true;if(a[b].style)a[b].style.visibility="hidden"}}function FieldsEnabled(a){if(a)if(!a.length){a.disabled=false;if(a.style)a.style.visibility="visible"}else for(var b=0;b<Number(a.length);b++){a[b].disabled=false;if(a[b].style)a[b].style.visibility="visible"}}function FnDateRangeToDate(){a:;this.CopyDateFld(this.dateRangeFldStart,this.dateFldStart);this.CopyDateFld(this.dateRangeFldEnd,this.dateFldEnd)}function FnDateToDateRange(){a:;this.CopyDateFld(this.dateFldStart,this.dateRangeFldStart);this.CopyDateFld(this.dateFldEnd,this.dateRangeFldEnd)}function RecurrencePatternEventHooksToggleDisplay(d,c){a:;if(!c&&GetValueAttribute(this)==d)return;GetValueAttribute(this)>=0&&this.rgStPatternTypes[GetValueAttribute(this)]!=""&&DisplayOff(this.divtags[this.rgStPatternTypes[GetValueAttribute(this)]]);var f=GetValueAttribute(this);this.value=d;GetValueAttribute(this)>=0&&this.rgStPatternTypes[GetValueAttribute(this)]!=""&&DisplayOn(this.divtags[this.rgStPatternTypes[GetValueAttribute(this)]]);if(GetValueAttribute(this)==0){this.DateRangeToDate();DisplayOn(this.stStartDateSpan);DisplayOn(this.stEndDateSpan);DisplayOff(this.stRecurDateRangeDiv);DisplayOff(this.stRecurPatternTextDiv)}else{if(c||f==0){this.DateToDateRange();if(this.recurFld.endRangeOptionFld!=null&&this.recurFld.endRangeOptionFld.FValidate()){var b=this.frm.FieldPost(this.recurFld.endRangeOptionFld);if(b==null||GetValueAttribute(b)!="2"){var a=this.frm.FieldSubPart(this.dateRangeFldEnd,"Date");a.value="";var e=a.disabled;a.disabled=false;this.dateRangeFldEnd.FValidate();a.disabled=e}}}DisplayOff(this.stStartDateSpan);DisplayOff(this.stEndDateSpan);DisplayOn(this.stRecurDateRangeDiv);DisplayOn(this.stRecurPatternTextDiv)}}function DateFieldPostProcess(){a:;GetValueAttribute(this)>=2&&this.DateRangeToDate()}function FnCopyDateFld(c,a){if(c!=null&&a!=null){var g=c.frm.FieldPost(c),e=a.frm.FieldPost(a);if(Boolean(g)&&Boolean(e)){var d=this.frm.FieldSubPart(c,"Date"),h=this.frm.dopt.ParseLocaleDate(GetValueAttribute(d),this.recurFld.caltype);if(!isNaN(h)){var b=this.frm.FieldSubPart(a,"Date");b.value=GetValueAttribute(d);var f=b.disabled;b.disabled=false;a.FValidate();b.disabled=f}}}}function Position(){}function WindowPosition(a){var b=new Position;b.x=0;b.y=0;while(a.offsetParent!=null&&a.id.indexOf("WebPart")!=0){b.x+=a.offsetLeft;b.y+=a.offsetTop;a=a.offsetParent}return b}function StInsertAt(b,a,c){a:;return b.substr(0,a)+c+b.substr(a)}function WMultiple(b,a){a:;return Math.round(b/a)*a}function FBlankString(a){a:;a=a.toString();a=a.replace(/\s/g,"");return a==""}function StURL(b,a){a:;return FBlankString(b)?STSHtmlEncode(a):"<a HREF="+StAttrQuote(b)+">"+STSHtmlEncode(a)+"</a>"}function FrmLocalFieldName(a){a:;return FrmStFieldNameFactory(a,"Local")}function fDataLoseConvert(b,a){a:;switch(b){case"Text":case"Choice":switch(a){case"Number":case"Currency":case"DateTime":return true}break;case"Note":switch(a){case"Text":case"Choice":case"MultiChoice":case"Number":case"Currency":case"DateTime":return true}break;case"MultiChoice":switch(a){case"Text":case"Note":case"Choice":case"Number":case"Currency":case"DateTime":return true}break;case"DateTime":switch(a){case"Text":case"Note":case"Choice":case"MultiChoice":return true}break;case"Number":case"Currency":switch(a){case"Text":case"Note":case"Choice":case"MultiChoice":case"Boolean":return true}}return false}function Belong(c,b){var a;if(b==null)return false;for(a=0;a<b.length;a++)if(c.stName==b[a].stName)return true;return false}function RgSetMinus(b,e){for(var c=[],d=0,a=0;a<b.length;a++)if(!Belong(b[a],e)){c[d]=b[a];d++}return c}function GetAncestor(a,b){while(a!=null&&a.tagName!=b)a=a.parentNode;return a}function GetTable(a){a:;return GetAncestor(a,"TABLE")}function GetTr(a){a:;return GetAncestor(a,"TR")}function SetDisplay(a,k,n,t,o){if(a==null)return;a.fRequired=t;var b=ControlFromFld(a);if(b==null||b.id=="onetidIOFile"&&k=="none")return;var e=GetTr(b);if(e!=null){var s=e.getElementsByTagName("TH"),m=null;if(s.length>0)m=s[0];if(o>0){var l=GetTable(e);if(l!=null){var c=null,j=0,d=null;if(Object(a).hasOwnProperty("rgChoices")){if(a.fFillInChoice&&typeof a.GetFillInButtonControl!="undefined"){d=a.GetFillInButtonControl();if(typeof d.checked!="undefined"&&typeof a.GetFillInControl!="undefined"&&typeof GetValueAttribute(a.GetFillInControl)!="undefined"&&d.checked)c=GetValueAttribute(a.GetFillInControl());if(c!=null)j++}if(c==null||a.format=="Checkboxes")for(var h=0;h<a.rgChoices.length;h++)if(a.GetControl(h).checked){j++;if(j>1)c+=";#"+a.rgChoices[h].stValue;else c=a.rgChoices[h].stValue;if(a.format!="Checkboxes")break}if(a.stName!="ContentType"&&c==null&&k=="none")c=a.stValue}else{d=a.frm.FieldSubPart(a,"Checkbox");if(d!=null)c=String(d.checked?1:0)}l.moveRow(e.rowIndex,Math.min(o,l.rows.length-1));if(a.format=="Checkboxes"&&c==null)c="";if(c!=null)if(j>1)a.SetValue(";#"+c+";#;#");else a.SetValue(c)}}if(m!=null){var r=m.getElementsByTagName("NOBR");if(r.length>0){var g=r[0],q=g.innerHTML;if(n!="")g.innerText=n;else g.innerText=a.stDisplay;g.innerHTML=g.innerHTML+q.substr(q.indexOf("<"))}}e.style.display=k;if(k!="none"){ToogleRequired(e,a.fRequired);if(b!=null&&b.id!="onetidIOFile"){if(typeof a.GetControl!="undefined")b=a.GetControl();var u=a.frm.FieldSubPart(a,"Checkbox"),i=a.frm.FieldSubPart(a,"Checkbox")!=null;if(i)b=u;if(b.tagName=="INPUT"&&b.type!="hidden"||b.tagName=="SELECT")if(b.getAttribute("oldValue")!=null){var p=GetValueAttribute(b);if(i)p=b.checked?"1":"";if(p==""){if(i)b.checked=b.getAttribute("oldValue")=="1";else b.value=b.getAttribute("oldValue");var f=a.frm.FieldPost(a);if(f!=null&&GetValueAttribute(f)==""){if(i)f.value=b.checked;else f.value=GetValueAttribute(b);f.removeAttribute("oldValue")}}b.removeAttribute("oldValue")}}}}}function HideControl(a){SetDisplay(a,"none",a.stDisplay,false,0)}function ShowControl(d,a,b,c){SetDisplay(d,"",b,a,c)}function ShowListFields(c){for(var b=c.rgfld,a=0;a<b.length;a++)b[a].stName!="ContentType"&&ShowControl(b[a],b[a].fRequired,"",0)}function SwitchControls(e,o,i){var h=e.options.length>1,f=h?e.selectedIndex:0;if(f<0){e.selectedIndex=0;f=0}for(var s=GetValueAttribute(e.options[f]),b=null,d=null,n,l=frmCurrent.rgcts,j=frmCurrent.rgctNames,q=frmCurrent.rgfld,p=1,t=document.activeElement,a=0;a<j.length;a++)if(j[a]==s){n=a;b=l[a];break}if(b!=null){var k=false,m=1;for(a=0;a<b.length;a++){var g=typeof _g_tp_fNewForm=="undefined"?undefined:_g_tp_fNewForm,c=frmCurrent.FindField(b[a].stName);if(c==null||c.stName=="ContentType")continue;c.belongToCurrentContentType=true;if(!h&&b[a].stName=="ContentType")continue;if(b[a].fHidden||b[a].fReadOnly||!b[a].fShowInFileDlg||!g&&!b[a].fShowInEditForm||g&&!b[a].fShowInNewForm){HideControl(c);continue}o&&b[a].hasOwnProperty("stDefault")&&SetFormControlValue(c,b[a].stDefault);ShowControl(c,b[a].fRequired,b[a].stDisplay,m+p);m++;if(!k&&i)k=c.FieldFocus&&c.FieldFocus()}}d=RgSetMinus(q,l[n]);if(d!=null)for(a=0;a<d.length;a++)if(d[a].stName!="ContentType"){d[a].belongToCurrentContentType=false;HideControl(d[a])}if(i){var r=frmCurrent.FindField("ContentType");r.FieldFocus()}typeof checkScroll=="function"&&checkScroll()}function ControlFromFld(a){if(Object(a).hasOwnProperty("fDateOnly"))return a.frm.FieldSubPart(a,"Date");if(Object(a).hasOwnProperty("stDesc"))return a.frm.FieldSubPart(a,"URL");if(Object(a).hasOwnProperty("fPercent"))return a.frm.FieldSubPart(a,"Local");if(Object(a).hasOwnProperty("fAllowHyperlink"))return a.frm.FieldPost(a);if(Object(a).hasOwnProperty("stNumLines"))return a.frm.FieldPost(a);if(Object(a).hasOwnProperty("isFileName")){var c=document.getElementById(a.stName);if(c==null)c=document.getElementById("onetidIOFile");return c}if(Object(a).hasOwnProperty("cchDisplaySize"))return a.frm.FieldPost(a);if(Object(a).hasOwnProperty("rgGridChoices"))return a.frm.FieldSubPart(a,"RadioButtons:0");if(Object(a).hasOwnProperty("rgChoices")&&typeof a.GetControl!="undefined")return GetTable(a.GetControl());if(Object(a).hasOwnProperty("recurrencePatternChoice")){var f=a.stPrefix+"MonthlyRecurType:"+a.stName,e=a.frm.FindField(f),b=ControlFromFld(e).parentNode;b=GetTable(b).parentNode;b=GetTable(b);return b}var d=a.frm.FieldPost(a);return d!=null?d:a.frm.FieldSubPart(a,"Checkbox")}function DefaultControls(){a:;var a=frmCurrent.FindField("ContentType"),d=0,b=null,j=frmCurrent.rgcts,f=frmCurrent.rgctNames;if(a!=null){b=a.GetControl();var c;if(b!=null)for(c=0;c<b.options.length;c++){var h=GetValueAttribute(b.options[c]);for(d=0;d<f.length;d++)if(f[d]==h)break;var g=j[d];if(g!=null&&g.length==0){typeof b.options.remove!="undefined"&&b.options.remove(c);c--}}}if(b==null){if(a!=null)a.fHidden=true;ShowListFields(frmCurrent)}else{var e=typeof _g_tp_fNewForm!="undefined"?_g_tp_fNewForm:undefined;if(b.options.length>1){var i=true,k=frmCurrent.FindField("owsnewfileref");ShowControl(a,false,a.stDisplay,1);SwitchControls(a.GetControl(),e,i)}else{a.fHidden=true;SwitchControls(a.GetControl(),e,false)}}}function BoolFromString2(a,b){a:;return a==null||a==""?b:a=="true"||a=="TRUE"?true:false}function BoolFromString(a){a:;return BoolFromString2(a,false)}function ToogleRequired(d,c){a:;var a=d.getElementsByTagName("FONT");if(a.length==0)return;var b=a[0];if(c)b.innerText=" *";else b.innerText=""}function SetFormControlValue(c,a){a:;c.stValue=a;var b=ControlFromFld(c);if(b==null)return;b.value=a}function MoveDisplayRow(a,c,d){var b=document.getElementById(d);if(b!=null&&a!=null){a.moveRow(b.rowIndex,Math.min(c,a.rows.length-1));b.style.display=""}}$_global_bform();