function $_global_ganttscript(){oldGanttImages=false;ganttDragActive=false;ganttDragSourceRow=0;ganttDragSourceColumn=0;ganttBarStartIndex=0;ganttBarEndIndex=0;ganttBarLength=0;ganttShadowStart=0;ganttShadowEnd=0;ganttDragOffset=0;dragRowTolerance=2;firstValidGanttDragRow=1;(function(){a:;typeof Sys!="undefined"&&typeof Sys.Application!="undefined"&&typeof Sys.Application.notifyScriptLoaded!="undefined"&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs=="function"&&NotifyScriptLoadedAndExecuteWaitingJobs("ganttscript.js")})()}function ULSkG1(){var a={};a.ULSTeamName="Microsoft SharePoint Foundation";a.ULSFileName="GanttScript.commentedjs";return a}var oldGanttImages,ganttDragActive,ganttDragSourceRow,ganttDragSourceColumn,ganttBarStartIndex,ganttBarEndIndex,ganttBarLength,ganttShadowStart,ganttShadowEnd,ganttDragOffset,dragRowTolerance,firstValidGanttDragRow;function ganttDragStart(){a:;var b=getParentTableCell(event.srcElement),a=getParentWithTagName(b,"TR");if(a.getAttribute("dragDisabled")=="true"){ganttDragActive=false;event.returnValue=false;return}ganttDragSourceColumn=b.cellIndex;ganttDragSourceRow=a.rowIndex;getGanttBarMetricsForThisRow(a);if(ganttDragSourceColumn>=ganttBarStartIndex&&ganttDragSourceColumn<=ganttBarEndIndex){ensureTransparentDragImageChildren(a);ganttDragActive=true;event.returnValue=true}else{ganttDragActive=false;event.returnValue=false}}function ganttDragEnter(){a:;if(ganttDragActive==false)return false;var c=getParentTableCell(event.srcElement),d=getParentWithTagName(c,"TR"),e=c.cellIndex,b=d.rowIndex,a=getParentWithTagName(d,"TABLE").rows[ganttDragSourceRow];if(Math.abs(b-ganttDragSourceRow)>dragRowTolerance||b<firstValidGanttDragRow){restoreOriginalGanttBar(a);return false}ganttDragOffset=e-ganttDragSourceColumn;drawGanttDisplaced(a,ganttDragOffset);return false}function ganttDrop(offsetControl,tpIdControl,startControl,finishControl,submitCommand){a:;if(ganttDragActive==false)return;var clickedCell=getParentTableCell(event.srcElement),clickedRow=getParentWithTagName(clickedCell,"TR"),currentColumnIndex=clickedCell.cellIndex,currentRowIndex=clickedRow.rowIndex,ganttDragSourceRowObject=getParentWithTagName(clickedRow,"TABLE").rows[ganttDragSourceRow];if(Math.abs(currentRowIndex-ganttDragSourceRow)>dragRowTolerance||currentRowIndex<firstValidGanttDragRow||ganttDragOffset==0){restoreOriginalGanttBar(ganttDragSourceRowObject);return}var tpId=ganttDragSourceRowObject.getAttribute("tpId"),originalTaskStartDate=ganttDragSourceRowObject.getAttribute("originalTaskStartDate"),originalTaskFinishDate=ganttDragSourceRowObject.getAttribute("originalTaskFinishDate");offsetControl.innerText=ganttDragOffset;tpIdControl.innerText=tpId;startControl.innerText=originalTaskStartDate;finishControl.innerText=originalTaskFinishDate;eval(submitCommand)}function ganttDragEnd(){a:;if(ganttDragActive==false)return;var a=getParentWithTagName(event.srcElement,"TR");ganttDragActive=false}function getParentWithTagName(c,b){var a=c;while(a!=null&&a.tagName!=b)a=a.parentNode;return a}function getParentTableCell(b){a:;var a=b;while(a!=null&&a.tagName!="TD"&&a.tagName!="TH")a=a.parentNode;return a}function getGanttBarMetricsForThisRow(e){a:;for(var b=false,c=false,a=0;a<e.cells.length;a++){var d=e.cells(a);if(d.firstChild!=null&&d.firstChild.tagName=="IMG"){if(b==false){ganttBarStartIndex=a;b=true}}else if(b==true&&c==false){ganttBarEndIndex=a-1;c=true;break}if(c==false)ganttBarEndIndex=a-1;ganttBarLength=ganttBarEndIndex-ganttBarStartIndex+1}}function getChildWithClassName(c,d){for(var a=0;a<c.childNodes.length;a++){var b=c.childNodes(a);if(b.className==d)return b}return undefined}function drawGanttDisplaced(h,g){for(var a=h.cells,b=1;b<a.length;b++){var f=a(b),c=getChildWithClassName(f,"ms-ganttTransparentImage");c.style.visibility="hidden";var d=b-g;if(d>0&&d<a.length){var e=getChildWithClassName(a(d),"ms-ganttNonTransparentImage");if(e!=null){c.src=e.src;c.style.visibility="visible"}}}}function ensureTransparentDragImageChildren(c){a:;if(c.cells.length>1)for(var k=c.cells(1),l=k.offsetTop+(k.offsetHeight-20)/2,e=1;e<c.cells.length;e++){for(var g=false,f=false,j=c.cells(e),h=j.childNodes,i=null,d=0;d<h.length;d++){var b=h(d);if(b.tagName=="IMG")if(b.className=="ms-ganttTransparentImage")g=true;else if(b.className=="ms-ganttNonTransparentImage"){f=true;i=b}}if(g==false){var a=document.createElement("IMG");a.className="ms-ganttTransparentImage";a.style.position="absolute";a.style.top=String(l);if(f==true)a.style.left=String(i.offsetLeft);a.style.visibility="hidden";j.appendChild(a)}}}function restoreOriginalGanttBar(b){for(var a=1;a<b.cells.length;a++){var c=b.cells(a);getChildWithClassName(c,"ms-ganttTransparentImage").style.visibility="hidden"}}$_global_ganttscript();