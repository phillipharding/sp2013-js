function $_global_designgallery(){ExecuteOrDelayUntilScriptLoaded(function(){a:;var a={};a.Templates={};a.Templates.Header=RenderDesignGalleryHeader;a.Templates.Body=RenderDesignGalleryBody;a.Templates.Footer=RenderDesignGalleryFooter;a.BaseViewID=2;a.ListTemplateType=124;typeof SPClientTemplates!="undefined"&&SPClientTemplates.TemplateManager.RegisterTemplateOverrides(a)},"clienttemplates.js");GetDesignDataHashUrl=function(){a:;return""};g_desgal_hideCurrentItem=false;g_desgal_ie8CssTextBuffer="";g_desgal_ie8StylesheetElement=null;g_tableContent="";g_loadingNotificationId=null;g_needLoadingNotification=false;g_elmPreview=null;g_desbld_site_assets_list_id=null;g_desbld_imagePickerElementsInited=false;g_desbld_tryItOutClicked=false;typeof NotifyScriptLoadedAndExecuteWaitingJobs=="function"&&NotifyScriptLoadedAndExecuteWaitingJobs("designgallery.js")}function ULSUrc(){var a={};a.ULSTeamName="Microsoft SharePoint Foundation";a.ULSFileName="designgallery.commentedjs";return a}function RenderDesignGalleryHeader(){return""}function RenderDesignGalleryFooter(b){var a=[];RenderPaging(a,b);return a.join("")}var g_designData,GetDesignDataHashUrl;function RenderDesignGalleryBody(c){ShowDesignLoadingNotification();var d=c.ListData.Row,b=GetDesignDataHashUrl();if(null!==b){try{b=new URI(b).getString()}catch(e){}var a=new XMLHttpRequest;a.open("GET",b,true);a.onreadystatechange=function(){a:;if(a.readyState==4){g_designData=JSON.parse(a.responseText);RenderDesignGalleryAllItems(d);HideDesignLoadingNotification()}};a.send(null)}else HideDesignLoadingNotification();return'<div id="previewContainer"></div>'}function GetItemIgnoreCase(a,d){var c=decodeURI(d.toUpperCase());for(var b in a)if(decodeURI(b.toUpperCase())===c)return a[b];return undefined}var g_desgal_hideCurrentItem,g_desgal_ie8CssTextBuffer,g_desgal_ie8StylesheetElement;function RenderDesignGalleryAllItems(l){var c=g_designData;if(!c)return;var n=c.overrideThemesLocation.toLowerCase()=="true";g_desgal_ie8CssTextBuffer="";for(var m=[],q=l.length,d=0;d<q;d++){var a=l[d],e=a.MasterPageUrl,g=a.ThemeUrl,p=STSHtmlEncode(a.ImageUrl),f=a.FontSchemeUrl,h="",b=null,j=null,i=null;if(d==0&&a.DisplayOrder==0){if(g_desgal_hideCurrentItem)continue;h="ms-designgallery-item-current";e=c.current;b=GetItemIgnoreCase(c.preview,e);if(g=="")if(Boolean(b))g=b.defaultColorPalette}if(null===b)b=GetItemIgnoreCase(c.preview,e);if(f=="")if(Boolean(b))f=b.defaultFontScheme;if(n&&a.PackageGuid!=null&&a.PackageGuid!=""&&a.PackageVersion!=null&&a.PackageVersion!=""){j=a.PackageGuid;i=a.PackageVersion}var o=RenderPreviewItem(e,g,p,f,"thumbnail_"+String(d),h,a.Name,j,i,true);m.push(o)}RenderStylesForIE8();var k=document.getElementById("previewContainer");k.setAttribute("role","menu");k.innerHTML=m.join("")}function RenderStylesForIE8(){a:;if(browseris.ie8standard){var a;if(!Boolean(g_desgal_ie8StylesheetElement))a=g_desgal_ie8StylesheetElement=document.createStyleSheet();else a=g_desgal_ie8StylesheetElement;a.cssText=g_desgal_ie8CssTextBuffer;g_desgal_ie8CssTextBuffer=""}}function RenderPreviewItem(p,q,k,i,b,l,o,n,m,j){var e=GetThumbnailPreview(p,q,k,i,b,j);if(e.css!=null)if(browseris.ie8standard)g_desgal_ie8CssTextBuffer+=e.css;else{var c=document.getElementById("ms-design-styles-"+b);if(!Boolean(c)){c=document.createElement("style");c.setAttribute("id","ms-design-styles-"+b);c.setAttribute("type","text/css");document.getElementsByTagName("head")[0].appendChild(c)}c.innerHTML=e.css}var a;if(e.html!=null){var d;if(j)d="ms-designgallery-item";else d="ms-designbuilder-preview";if(fRightToLeft)d+=" dgp-rightToLeft";if(l!="")d+=" "+l;if(j){var g;if(Boolean(_spPageContextInfo)){var h=_spPageContextInfo.webServerRelativeUrl;if(h=="/")h="";g=h+"/_layouts/15/"}else g="";var f=g+"designbuilder.aspx?masterUrl="+encodeURIComponent(p)+"&themeUrl="+encodeURIComponent(q);if(k!=null)f+="&imageUrl="+encodeURIComponent(k);if(i!=null)f+="&fontSchemeUrl="+encodeURIComponent(i);if(n!=null&&m!=null)f=f+"&designGuid="+encodeURIComponent(n)+"&designVersion="+encodeURIComponent(m);a='<div class="'+d+'" role="menuitem" aria-labelledby="'+b+'-label" onclick="GoToPage(\''+STSScriptEncode(f)+"', true);\">";a+='<div id="'+b+'" aria-hidden="true" unselectable="true" class="ms-designgallery-thumbnail">'}else{a='<div class="'+d+'" role="menuitem">';a+='<div id="'+b+'" aria-hidden="true" class="ms-designbuilder-thumbnail">'}a+=e.html;a+="</div>";a+='<div id="'+b+'-label" class="ms-designgallery-iteminfo"><div class="ms-floatLeft">';if(o!==null){a+="<a href='#' onclick='return false;' class=\"ms-designgallery-name ms-textLarge\">";a+=o;a+="</a>"}a+="</div>";a+="</div></div>"}return a}function packageNameClick(a,c,d){a:;if(!Boolean(a))a=window.event;if(Boolean(a.stopPropagation))a.stopPropagation();else a.cancelBubble=true;Boolean(a.preventDefault)&&a.preventDefault();var b=document.getElementById(c);if(Boolean(b)){b.value=d;__doPostBack(c,"")}}function GetThumbnailPreview(t,u,k,n,q,i){var b=null,d=null,l=i?208:442,m=i?278:661,e=g_designData;try{var f=GetItemIgnoreCase(e.preview,t);if(f){var o=f.html,r=f.css,p=GetItemIgnoreCase(e.themes,u),c=GetItemIgnoreCase(e.fontSchemes,n),a;if(k==="none")a=null;else a=k;if(null!=a){a=a.replace(/'/g,"%27");a=a.replace(/"/g,"%22");a=a.replace(/\(/g,"%28");a=a.replace(/\)/g,"%29")}var j=GetCSSTokenMappings(p,a,q,l,m,c);b=ReplaceTokens(r,j);var h=[];for(var v in c.FontSlots){var g=c.FontSlots[v].CurrentLanguageFont;g.IsWebFont&&h.push(g.PreviewFontFaceBlock)}b+=h.join("");var s=GetTextTokenMappings(j);d=ReplaceTokens(o,s)}}catch(w){b=d=null}return{css:b,html:d}}function ReplaceTokens(b,c){for(var d=c.length,a=0;a<d;a++)b=b.replace(c[a][0],c[a][1]);return b}function GetTextTokenMappings(b){return[[/\[TITLE\]/g,Strings.STS.L_DGpreview_Title],[/\[CA TABLE\]/g,ReplaceTokens(ConstructTableContent(),b)],[/\[CA TABLE HEADER\]/g,Strings.STS.L_DGpreview_CATableHeader],[/\[CA TABLE DESCRIPTION\]/g,GetTableDescription()],[/\[CA ACCENT COLORS\]/g,GetAccentColors()],[/\[CA LIST TITLE\]/g,Strings.STS.L_DGpreview_CAList_Header],[/\[BRANDSTRING\]/g,Strings.STS.L_DGpreview_BrandString],[/\[SUITELINK1\]/g,Strings.STS.L_DGpreview_SuiteLink1],[/\[SUITELINK2\]/g,Strings.STS.L_DGpreview_SuiteLink2],[/\[SUITELINK3\]/g,Strings.STS.L_DGpreview_SuiteLink3],[/\[WELCOME\]/g,Strings.STS.L_DGpreview_Welcome],[/\[RIBBONTAB1\]/g,Strings.STS.L_DGpreview_Ribbon1],[/\[RIBBONTAB2\]/g,Strings.STS.L_DGpreview_Ribbon2],[/\[RIBBONTAB3\]/g,Strings.STS.L_DGpreview_Ribbon3],[/\[SEARCHBOX\]/g,Strings.STS.L_DGpreview_Searchbox],[/\[QL1\]/g,Strings.STS.L_DGpreview_QL1],[/\[QL2\]/g,Strings.STS.L_DGpreview_QL2],[/\[QL3\]/g,Strings.STS.L_DGpreview_QL3],[/\[QL4\]/g,Strings.STS.L_DGpreview_QL4],[/\[QLADD\]/g,Strings.STS.L_DGpreview_QLADD],[/\[TN1\]/g,Strings.STS.L_DGpreview_TN1],[/\[TN2\]/g,Strings.STS.L_DGpreview_TN2],[/\[TN3\]/g,Strings.STS.L_DGpreview_TN3],[/\[TN4\]/g,Strings.STS.L_DGpreview_TN4],[/\[SITETITLE\]/g,Strings.STS.L_DGpreview_SiteTitle]]}function GetTableDescription(){a:;return String.format(Strings.STS.L_DGpreview_CATableDescription,"<a>","</a>",'<a class="dgp-pageHyperLinkVisited">',"</a>")}function GetAccentColors(){a:;return'<table class="dgp-accentTable"><tbody><tr style="margin-bottom:2%;"><td class="dgp-accentTextCommon dgp-accentColor1">'+Strings.STS.L_DGpreview_Accent1+'</td><td class="dgp-accentTextCommon dgp-accentColor2">'+Strings.STS.L_DGpreview_Accent2+'</td><td class="dgp-accentTextCommon dgp-accentColor3">'+Strings.STS.L_DGpreview_Accent3+'</td><td class="dgp-accentTextCommon dgp-accentColor4">'+Strings.STS.L_DGpreview_Accent4+'</td><td class="dgp-accentTextCommon dgp-accentColor5">'+Strings.STS.L_DGpreview_Accent5+'</td><td class="dgp-accentTextCommon dgp-accentColor6">'+Strings.STS.L_DGpreview_Accent6+'</td></tr><tr><td class="dgp-accentColorBlockCommon"><div class="dgp-accentColorBlock1"><span style="visibility:hidden;";>&nbsp;</span></div></td><td class="dgp-accentColorBlockCommon"><div class="dgp-accentColorBlock2"><span style="visibility:hidden;";>&nbsp;</span></div></td><td class="dgp-accentColorBlockCommon"><div class="dgp-accentColorBlock3"><span style="visibility:hidden;";>&nbsp;</span></div></td><td class="dgp-accentColorBlockCommon"><div class="dgp-accentColorBlock4"><span style="visibility:hidden;";>&nbsp;</span></div></td><td class="dgp-accentColorBlockCommon"><div class="dgp-accentColorBlock5"><span style="visibility:hidden;";>&nbsp;</span></div></td><td class="dgp-accentColorBlockCommon"><div class="dgp-accentColorBlock6"><span style="visibility:hidden;";>&nbsp;</span></div></td></tr></tbody></table>'}var g_tableContent;function ConstructTableContent(){a:;if(g_tableContent=="")g_tableContent='<th><tr><td style="width:3%"></td><td class="dgp-tableheadertext">'+Strings.STS.L_DGpreview_CATable_H1+"</td><td>"+Strings.STS.L_DGpreview_CATable_H2+"</td><td>"+Strings.STS.L_DGpreview_CATable_H3+'</td></tr></th><tbody><tr><td></td><td><a class="dgp-tableitemlink">'+Strings.STS.L_DGpreview_CATable_Doc1+"</a></td><td>"+Strings.STS.L_DGpreview_CATable_Date1+"</td><td>"+Strings.STS.L_DGpreview_CATable_Author1+'</td></tr><tr class="dgp-tablerowselected"><td class="dgp-tablerowselectedtd"></td><td><a class="dgp-tableitemlink" style="color:[T_HYPERLINK_1];">'+Strings.STS.L_DGpreview_CATable_Doc2+"</a></td><td>"+Strings.STS.L_DGpreview_CATable_Date2+"</td><td>"+Strings.STS.L_DGpreview_CATable_Author2+'</td></tr><tr><td></td><td><a class="dgp-tableitemlink" style="color:[T_HYPERLINK_1];">'+Strings.STS.L_DGpreview_CATable_Doc3+"</a></td><td>"+Strings.STS.L_DGpreview_CATable_Date3+"</td><td>"+Strings.STS.L_DGpreview_CATable_Author3+"</td></tr></tbody>";return g_tableContent}function GetCSSTokenMappings(c,f,j,g,h,e){var a=[],b;for(var d in c.Colors){b=d.toUpperCase();a.push([new RegExp("\\[T_THEME_COLOR_"+b+"\\]","g"),GetRGBAColorString(c.Colors[d].DefaultColor,false)]);a.push([new RegExp("\\[T_THEME_COLOR_"+b+"_DARKEST\\]","g"),GetRGBAColorString(c.Colors[d].Shades[1],false)]);a.push([new RegExp("\\[T_THEME_COLOR_"+b+"_DARKER\\]","g"),GetRGBAColorString(c.Colors[d].Shades[2],false)]);a.push([new RegExp("\\[T_THEME_COLOR_"+b+"_MEDIUM\\]","g"),GetRGBAColorString(c.Colors[d].Shades[3],false)]);a.push([new RegExp("\\[T_THEME_COLOR_"+b+"_LIGHTER\\]","g"),GetRGBAColorString(c.Colors[d].Shades[4],false)]);a.push([new RegExp("\\[T_THEME_COLOR_"+b+"_LIGHTEST\\]","g"),GetRGBAColorString(c.Colors[d].Shades[5],false)]);a.push([new RegExp("\\[T_THEME_COLOR_"+b+"_AA\\]","g"),GetRGBAColorString(c.Colors[d].DefaultColor,true)]);a.push([new RegExp("\\[T_THEME_COLOR_"+b+"_DARKEST_AA\\]","g"),GetRGBAColorString(c.Colors[d].Shades[1],true)]);a.push([new RegExp("\\[T_THEME_COLOR_"+b+"_DARKER_AA\\]","g"),GetRGBAColorString(c.Colors[d].Shades[2],true)]);a.push([new RegExp("\\[T_THEME_COLOR_"+b+"_MEDIUM_AA\\]","g"),GetRGBAColorString(c.Colors[d].Shades[3],true)]);a.push([new RegExp("\\[T_THEME_COLOR_"+b+"_LIGHTER_AA\\]","g"),GetRGBAColorString(c.Colors[d].Shades[4],true)]);a.push([new RegExp("\\[T_THEME_COLOR_"+b+"_LIGHTEST_AA\\]","g"),GetRGBAColorString(c.Colors[d].Shades[5],true)])}var i=[[/\[T_IMAGE\]/g,IsNullOrUndefined(f)||f===""?"/_layouts/15/images/blank.gif?rev=23":f],[/\[ID\]/g,"#"+j],[/\[T_HEIGHT\]/g,String(g)+"px"],[/\[T_WIDTH\]/g,String(h)+"px"],[/\[T_IMGHEIGHT\]/g,String(Math.round(g*.75))+"px"],[/\[T_IMGWIDTH\]/g,String(Math.round(h*.75))+"px"],[/\[T_TITLE_FONT\]/g,'"'+e.FontSlots.title.CurrentLanguageFont.Name+'"'],[/\[T_NAVIGATION_FONT\]/g,'"'+e.FontSlots.navigation.CurrentLanguageFont.Name+'"'],[/\[T_SMALL_HEADING_FONT\]/g,'"'+e.FontSlots["small-heading"].CurrentLanguageFont.Name+'"'],[/\[T_HEADING_FONT\]/g,'"'+e.FontSlots.heading.CurrentLanguageFont.Name+'"'],[/\[T_LARGE_HEADING_FONT\]/g,'"'+e.FontSlots["large-heading"].CurrentLanguageFont.Name+'"'],[/\[T_BODY_FONT\]/g,'"'+e.FontSlots.body.CurrentLanguageFont.Name+'"'],[/\[T_LARGE_BODY_FONT\]/g,'"'+e.FontSlots["large-body"].CurrentLanguageFont.Name+'"']];return i.concat(a)}function GetRGBAColorString(a,f){var b=a.HtmlColor;if(a.A<255)if(browseris.ie8standard){var e=DecToHex(Number(a.R)),d=DecToHex(Number(a.G)),c=DecToHex(Number(a.B)),g=DecToHex(Number(a.A));b=f?"#"+g+e+d+c:"#"+e+d+c}else b="rgba("+String(a.R)+", "+String(a.G)+", "+String(a.B)+", "+String(Number(a.A)/255)+")";return b}function DecToHex(b){var a=b.toString(16);if(b<16)a="0"+a;return a}var g_loadingNotificationId,g_needLoadingNotification;function ShowDesignLoadingNotification(){a:;if(null!==g_loadingNotificationId)return;g_needLoadingNotification=true;EnsureScript("core.js",typeof addNotification,function(){a:;if(g_needLoadingNotification){g_loadingNotificationId=SP.UI.Notify.showLoadingNotification(true);g_needLoadingNotification=false}})}function HideDesignLoadingNotification(){a:;g_needLoadingNotification=false;if(null===g_loadingNotificationId)return;CoreInvoke("removeNotification",g_loadingNotificationId);g_loadingNotificationId=null}var g_designBuilderControlRoot,g_desbld_themeUrl,g_desbld_masterUrl,g_desbld_fontSchemeUrl,g_desbld_designGuid,g_desbld_designVersion;function DesignBuilderOnLoad(c){ShowDesignLoadingNotification();var b=GetDesignDataHashUrl();try{b=new URI(b).getString()}catch(d){}var a=new XMLHttpRequest;a.open("GET",b,true);a.onreadystatechange=function(){a:;if(a.readyState==4){var b=g_designData=JSON.parse(a.responseText);AddControlsToCUI();if(typeof g_desbld_masterUrl!="undefined"&&null!==g_desbld_masterUrl&&typeof g_desbld_themeUrl!="undefined"&&null!==g_desbld_themeUrl){if(typeof g_desbld_fontSchemeUrl==="undefined"||null===g_desbld_fontSchemeUrl){var d=GetItemIgnoreCase(b.preview,g_desbld_masterUrl);g_desbld_fontSchemeUrl=d.defaultFontScheme}UpdateDesignBuilderPreview(g_desbld_masterUrl,g_desbld_themeUrl,null,g_desbld_fontSchemeUrl);Boolean(c)&&UpdateDesignBuilderImagePickerImage(c,true)}HideDesignLoadingNotification()}};a.send(null)}var g_elmPreview;function UpdateDesignBuilderPreview(b,c,g,a){if(null==g_elmPreview){var d=document.getElementById("ms-designbuilder-preview");if(!Boolean(d))return;g_elmPreview=d}b=null==b?g_desbld_masterUrl:b;c=null==c?g_desbld_themeUrl:c;a=null==a?g_desbld_fontSchemeUrl:a;if(a=="default"){var e=GetItemIgnoreCase(g_designData.preview,b);a=e.defaultFontScheme}var f=RenderPreviewItem(b,c,g,a,"designbuilder-preview","",null,null,null,false);RenderStylesForIE8();g_elmPreview.innerHTML=f}function UpdateDesignBuilderImagePickerImage(a,b){if(!Boolean(a))return;ExecuteOrDelayUntilScriptLoaded(function(){a:;var c=SP.Ribbon.PageManager.get_instance();c.executeRootCommand("ImagePickerFileSelected",{FileUrl:a,UpdatePreview:b},null,null)},"sp.ribbon.js")}var g_desbld_site_assets_list_id;function InitializeDesignBuilderImageControl(e,c,b,d){g_desbld_site_assets_list_id=b;var a=document.getElementById("ms-designbuilder-imagecontrol-box");if(!Boolean(a))return;EnsureImagePickerElementsInited();g_imagePickerImage.setAttribute("alt",Strings.STS.L_DesignBuilderToolsImagePickerImageAltText);if(!registerDragUpload(a,e,c,b,d,true,true,null,OnDesignBuilderImagePickerPreUpload,OnDesignBuilderImagePickerPostUpload))g_imagePickerPlaceholderText.innerHTML=STSHtmlEncode(Strings.STS.L_DesignBuilderToolsImagePickerNoDragDropPlaceholderText)}function OnDesignBuilderImagePickerPreUpload(a){if(a.length!=1){for(var c=0,f=a.length;c<f;c++)a[c].status=FileStatus.SKIP;ShowDesignBuilderImageControlError(Strings.STS.L_DesignBuilderToolsImagePickerTooManyFilesError);return false}var b=a[0],e=b.fileName,d=GetImagePickerFileExtension(e);if(!ValidateImagePickerFileExtension(d)){b.status=FileStatus.SKIP;ShowDesignBuilderImageControlError(Strings.STS.L_DesignBuilderToolsImagePickerInvalidFileType);return false}if(!IsImagePickerCompressibleImageFormat(d))if(!ValidateImagePickerFileSize(b.fileSize)){b.status=FileStatus.SKIP;ShowDesignBuilderImageControlError(Strings.STS.L_DesignBuilderToolsImagePickerFileTooLarge);return false}EnsureImagePickerElementsInited();g_imagePickerImageContainer.style.display="none";g_imagePickerPlaceholderText.style.display="none";g_imagePickerErrorText.style.display="none";g_imagePickerProgressIcon.style.display="inline-block";return true}function GetImagePickerFileExtension(a){if(a===null)return null;var b=a.lastIndexOf(".");return b==a.length-1?null:a.substring(b+1)}function IsImagePickerCompressibleImageFormat(a){if(null===a)return false;var b=a.toUpperCase();switch(b){case"BMP":case"JPEG":case"JPG":case"THEMEDBMP":case"THEMEDJPG":return true}return false}function ValidateImagePickerFileExtension(a){if(null===a)return false;var b=a.toUpperCase();switch(b){case"BMP":case"GIF":case"JPEG":case"JPG":case"PNG":case"THEMEDBMP":case"THEMEDGIF":case"THEMEDJPG":case"THEMEDPNG":return true}return false}function ValidateImagePickerFileSize(a){return a!==null&&a<=153600}var g_desbld_imagePickerElementsInited,g_imagePickerProgressIcon,g_imagePickerImageContainer,g_imagePickerPlaceholderText,g_imagePickerErrorText,g_imagePickerImage;function EnsureImagePickerElementsInited(){a:;if(g_desbld_imagePickerElementsInited)return;g_imagePickerProgressIcon=document.getElementById("ms-designbuilder-imagecontrol-progress");g_imagePickerImageContainer=document.getElementById("ms-designbuilder-imagecontrol-imagecontainer");g_imagePickerImage=document.getElementById("ms-designbuilder-imagecontrol-image");g_imagePickerPlaceholderText=document.getElementById("ms-designbuilder-imagecontrol-placeholdertext");g_imagePickerErrorText=document.getElementById("ms-designbuilder-imagecontrol-errortext");g_desbld_imagePickerElementsInited=true}var g_desbld_imageFolderServerRelativeUrl;function OnDesignBuilderImagePickerPostUpload(a){EnsureImagePickerElementsInited();g_imagePickerImageContainer.style.display="inline-block";g_imagePickerProgressIcon.style.display="none";if(!Boolean(g_desbld_imageFolderServerRelativeUrl))return;var c=a[0],b=g_desbld_imageFolderServerRelativeUrl+c.fileName;UpdateDesignBuilderImagePickerImage(b,true)}function OnDesignBuilderChangeImageDialogReturn(d,a){a:;if(d==SP.UI.DialogResult.OK){var c=a.newFileUrl,b=GetImagePickerFileExtension(c);if(!ValidateImagePickerFileExtension(b)){ShowDesignBuilderImageControlError(Strings.STS.L_DesignBuilderToolsImagePickerInvalidFileType);return}if(!IsImagePickerCompressibleImageFormat(b)){var e=a.newFileSize;if(!ValidateImagePickerFileSize(e)){ShowDesignBuilderImageControlError(Strings.STS.L_DesignBuilderToolsImagePickerFileTooLarge);return}}EnsureImagePickerElementsInited();g_imagePickerImageContainer.style.display="inline-block";UpdateDesignBuilderImagePickerImage(c,true)}}function DesignBuilderOpenChangeImageDialog(){a:;if(g_desbld_site_assets_list_id===null)return;var a={url:"upload.aspx?RootFolder=&AllowMultipleUploads=0&List="+encodeURIComponent(g_desbld_site_assets_list_id),dialogReturnValueCallback:OnDesignBuilderChangeImageDialogReturn};SP.SOD.execute("sp.ui.dialog.js","SP.UI.ModalDialog.showModalDialog",a)}function DismissDesignBuilderImage(){a:;confirm(Strings.STS.L_DesignBuilderToolsImagePickerRemoveConfirm)&&ExecuteOrDelayUntilScriptLoaded(function(){a:;var a=SP.Ribbon.PageManager.get_instance();a.executeRootCommand("ImagePickerFileDismissed",{},null,null)},"sp.ribbon.js")}function ShowDesignBuilderImageControlError(b){EnsureImagePickerElementsInited();var a=g_imagePickerErrorText;a.innerHTML=STSHtmlEncode(b);g_imagePickerImageContainer.style.display="none";g_imagePickerPlaceholderText.style.display="none";g_imagePickerProgressIcon.style.display="none";a.style.display="inline-block"}function InitializeDesignBuilderCUI(k,h,e,f){try{var i=new CUI.BuildOptions}catch(l){return}var b=new CUI.BuildOptions;b.lazyMenuInit=true;b.trimmedIds={};b.attachToDOM=false;b.validateServerRendering=false;b.fixedPositioningEnabled=false;b.dataExtensions=null;b.clientID="ms-designbuilder-cuicontainer";try{var j=SP.Ribbon.PageManager.get_instance()}catch(l){return}var c=document.getElementById("ms-designbuilder-cuicontainer");if(!Boolean(c))return;var a=new CUI.RootProperties;a.Culture=h;a.DecimalSeparator=e;a.RootEventCommand="designBuilderRootEventCommand";a.ImageDownArrow=GetThemedImageUrl("spcommon.png");a.ImageDownArrowTop="-256";a.ImageDownArrowLeft="-104";a.TextDirection=f;var d=SP.Ribbon.PageManager.get_instance(),g=new CUI.Builder(b,c,d);g_designBuilderControlRoot=new CUI.StandaloneRoot("DesignBuilderTools",a);g_designBuilderControlRoot.setBuilder(g);d.addRoot(g_designBuilderControlRoot)}function AddControlsToCUI(){a:;var c=g_designData,i=g_designBuilderControlRoot,e=null,j=encodeURIComponent(c.newThemesLocation.toUpperCase()),f=true,o=c.overrideThemesLocation.toLowerCase()=="true";if(o){var A=g_desbld_designGuid,x=g_desbld_designVersion;f=g_desbld_designGuid==null||g_desbld_designGuid=="undefined"||g_desbld_designVersion==null||g_desbld_designVersion=="undefined";e=GetSelectedDesignPackageFolder(f,A,x);if(e!=null&&e!="")e=e.toUpperCase()}var k=document.getElementById("ms-designbuilder-cuicontainer"),D=CreateLabelElement(Strings.STS.L_DesignBuilderToolsPaletteLabel,"ms-designbuilder-palette-Medium");k.appendChild(D);var n=0,h=[],d=false,g,a,b,C=g_desbld_themeUrl;for(a in c.themes){b=a.toUpperCase();if(!o||f&&b.indexOf(j)==-1||!f&&(b.indexOf(j)==-1||b.indexOf(e)!=-1)){var v=c.themes[a];if(!d&&decodeURI(v.ServerRelativeUrl.toUpperCase())==decodeURI(C.toUpperCase())){g=a;d=true}h.push(CreatePaletteGalleryButtonXml(a,v,n++))}}var m=h.join(""),y=['<DropDown Id="ms-designbuilder-palette" Alt="',Strings.STS.L_DesignBuilderToolsPaletteAlt,'" Command="PalettePickerSelected" QueryCommand="PalettePickerQuery" CommandPreview="PalettePickerPreview" CommandRevert="PalettePickerPreviewRevert" Width="111px" SelectedItemDisplayMode="Menu" InitialItem="',g,'"><Menu Id="DesignBuilderTools.Palette.Menu"><MenuSection Id="ms-designbuilder-palette-menusection" MaxHeight="269px" Scrollable="true"><Controls Id="DesignBuilderTools.Palette.Menu.MenuSection.Controls">',m,"</Controls></MenuSection></Menu></DropDown>"];i.addControl("DesignBuilderTools.Palette",y.join(""));var H=i.getDOMElementForControlDisplayMode("DesignBuilderTools.Palette","Medium");k.appendChild(H);var E=CreateLabelElement(Strings.STS.L_DesignBuilderToolsLayoutLabel,"ms-designbuilder-layout-Medium");k.appendChild(E);n=0;h=[];d=false;g=null;var u=g_desbld_masterUrl;for(a in c.preview){b=a.toUpperCase();if(!o||f&&b.indexOf(j)==-1||!f&&(b.indexOf(j)==-1||b.indexOf(e)!=-1)){var K=c.preview[a];if(!d&&decodeURI(a.toUpperCase())==decodeURI(u.toUpperCase())){g=a;d=true}h.push(CreateLayoutButtonXml(a,K,n++))}}m=h.join("");var z=['<DropDown Id="ms-designbuilder-layout" Alt="',Strings.STS.L_DesignBuilderToolsLayoutAlt,'" Command="LayoutPickerSelected" QueryCommand="LayoutPickerQuery" CommandPreview="LayoutPickerPreview" CommandRevert="LayoutPickerPreviewRevert" Width="103px" InitialItem="',g,'"><Menu Id="DesignBuilderTools.Layout.Menu"><MenuSection Id="ms-designbuilder-layout-menusection"><Controls Id="DesignBuilderTools.Layout.Menu.MenuSection.Controls">',m,"</Controls></MenuSection></Menu></DropDown>"];i.addControl("DesignBuilderTools.Layout",z.join(""));var J=i.getDOMElementForControlDisplayMode("DesignBuilderTools.Layout","Medium");k.appendChild(J);var G=CreateLabelElement(Strings.STS.L_DesignBuilderToolsFontLabel,"ms-designbuilder-fontscheme-Medium");k.appendChild(G);n=0;h=[];d=false;g=null;var p=null===g_desbld_fontSchemeUrl?null:g_desbld_fontSchemeUrl;if(null===p||"DEFAULT"===p.toUpperCase()){var r=GetItemIgnoreCase(c.preview,u);if(Boolean(r)&&Boolean(r.defaultFontScheme))p=r.defaultFontScheme}var t=p.toUpperCase(),B=c.fontSchemeDuplicateKeyCount,l=new Array(B),q;for(a in c.fontSchemes){q=c.fontSchemeDuplicateKeys[a];if(!Boolean(l[q]))l[q]=a;else if(!d&&decodeURI(a.toUpperCase())==decodeURI(t))l[q]=a}d=false;for(var s=0;s<l.length;s++){a=l[s];b=a.toUpperCase();if(!o||f&&b.indexOf(j)==-1||!f&&(b.indexOf(j)==-1||b.indexOf(e)!=-1)){var I=c.fontSchemes[a];if(!d&&decodeURI(b)==decodeURI(t)){g=a;d=true}h.push(CreateFontSchemeButtonXml(a,I,n++))}}m=h.join("");var w=['<DropDown Id="ms-designbuilder-fontscheme" Alt="',Strings.STS.L_DesignBuilderToolsFontSchemeAlt,'" Command="FontSchemePickerSelected" QueryCommand="FontSchemePickerQuery" Width="132px" SelectedItemDisplayMode="Menu" InitialItem="',g,'"><Menu Id="DesignBuilderTools.FontScheme.Menu"><MenuSection Id="ms-designbuilder-fontscheme-menusection"><Controls Id="DesignBuilderTools.FontScheme.Menu.MenuSection.Controls">',m,"</Controls></MenuSection></Menu></DropDown>"];i.addControl("DesignBuilderTools.FontScheme",w.join(""));var F=i.getDOMElementForControlDisplayMode("DesignBuilderTools.FontScheme","Medium");k.appendChild(F);i.pollForStateAndUpdate()}function CreateLabelElement(c,b){var a=document.createElement("label");a.className="ms-designbuilder-label ms-h3";a.setAttribute("for",b);a.innerHTML=c;return a}function GetSelectedDesignPackageFolder(a,c,b){return!a?encodeURIComponent(c)+"/"+encodeURIComponent(b):""}function CreatePaletteGalleryButtonXml(b,a,i){var h=i.toString(),c=a.Colors[a.PreviewSlot1].DefaultColor,d=a.Colors[a.PreviewSlot2].DefaultColor,e=a.Colors[a.PreviewSlot3].DefaultColor,g=CreatePaletteHtml(b,c.HtmlColor,d.HtmlColor,e.HtmlColor,true),j=STSHtmlEncode(a.AccessibleDescription),f=['<GalleryButton Id="DesignBuilderTools.Palette.Palette',h,'" Alt="',j,'" InnerHTML="',g,'" CommandType="OptionSelection" ElementDimensions="SizeCustom" MenuItemId="',b,'" CommandValueId="',b,'" Command="PalettePickerSelected" QueryCommand="QueryAlwaysTrue" CommandPreview="PalettePickerPreview" CommandRevert="PalettePickerPreviewRevert" />'];return f.join("")}function CreatePaletteHtml(i,f,g,h,d){var c=d?"&lt;":"<",b=d?"&gt;":">",a=d?"&quot;":'"',e=[c,"span class=",a,"ms-designbuilder-palette",a," rel=",a,i,a,b,c,"span class=",a,"ms-designbuilder-palette-color ms-designbuilder-palette-color1",a," style=",a,"background-color:",f,a,b," ",c,"/span",b,c,"span class=",a,"ms-designbuilder-palette-color ms-designbuilder-palette-color2",a," style=",a,"background-color:",g,a,b," ",c,"/span",b,c,"span class=",a,"ms-designbuilder-palette-color ms-designbuilder-palette-color3",a," style=",a,"background-color:",h,a,b," ",c,"/span",b,c,"/span",b];return e.join("")}function CreateLayoutButtonXml(a,d,e){var c=e.toString(),b=['<Button Id="DesignBuilderTools.Layout.Layout',c,'" LabelText="',d.title,'" CommandType="OptionSelection" MenuItemId="',a,'" CommandValueId="',a,'" Command="LayoutPickerSelected" QueryCommand="QueryAlwaysTrue" CommandPreview="LayoutPickerPreview" CommandRevert="LayoutPickerPreviewRevert" />'];return b.join("")}function CreateFontSchemeButtonXml(f,c,k){var j=k.toString(),a=c.FontSlots[c.PreviewSlot1].CurrentLanguageFont,b=c.FontSlots[c.PreviewSlot2].CurrentLanguageFont,d,e;if(a.IsWebFont)d="&lt;img src=&quot;"+encodeURI(a.LargeImageUrl)+"&quot; alt=&quot;"+STSHtmlEncode(a.Name)+"&quot;/&gt;";else d="&lt;span class=&quot;ms-designbuilder-fontScheme-font&quot; style=&quot;font-family:'"+STSHtmlEncode(a.Name)+"';&quot;&gt;"+STSHtmlEncode(a.Name)+"&lt;/span&gt;";if(b.IsWebFont)e="&lt;img src=&quot;"+encodeURI(b.SmallImageUrl)+"&quot; alt=&quot;"+STSHtmlEncode(b.Name)+"&quot;/&gt;";else e="&lt;span class=&quot;ms-designbuilder-fontScheme-font&quot; style=&quot;font-family:'"+STSHtmlEncode(b.Name)+"';&quot;&gt;"+STSHtmlEncode(b.Name)+"&lt;/span&gt;";var g=["&lt;ul class=&quot;ms-designbuilder-fontScheme ms-noList&quot; rel=&quot;",f,"&quot;&gt;&lt;li class=&quot;ms-designbuilder-fontScheme-fontLarge&quot;&gt;",d,"&lt;/li&gt;&lt;li class=&quot;ms-designbuilder-fontScheme-fontSmall&quot;&gt;",e,"&lt;/li&gt;&lt;/ul&gt;"],i=g.join(""),l=STSHtmlEncode(a.Name+", "+b.Name),h=['<GalleryButton Id="DesignBuilderTools.FontScheme.FontScheme',j,'" Alt="',l,'" InnerHTML="',i,'" CommandType="OptionSelection" ElementDimensions="SizeCustom" MenuItemId="',f,'" CommandValueId="',f,'" Command="FontSchemePickerSelected" QueryCommand="QueryAlwaysTrue" />'];return h.join("")}var g_desbld_tryItOutClicked;function DesignBuilderTryItOutOnClick(){a:;if(g_desbld_tryItOutClicked)return false;g_desbld_tryItOutClicked=true;var a=document.querySelector(".ms-designbuilder-livePreviewButton");if(Boolean(a))a.style.cursor="wait";return true}function DesignPreviewOnLoad(a){DesignPreviewFixIframeDimensions();var b=document.getElementById("ifmPreviewFrame");if(!Boolean(b))return;if(null!=a)b.src=a;AddEvtHandler(window,"onresize",DesignPreviewFixIframeDimensions)}function DesignPreviewFixIframeDimensions(){a:;var a=document.getElementById("ms-designpreview-iframe-container");if(!Boolean(a))return;var c=GetViewportHeight(),d=AbsTop(a),b=c-d-1-1-33;a.style.height=b.toString()+"px"}$_global_designgallery();