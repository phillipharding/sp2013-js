function $_global_filepreview(){RegisterSod("mediaplayer.js","/_layouts/15/mediaplayer.js");RegisterSod("sp.publishing.resources.resx","/_layouts/15/ScriptResx.ashx?name=sp.publishing.resources&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name));RegisterSodDep("mediaplayer.js","sp.publishing.resources.resx");previewBase=function(){a:;var a=0;return{init:function(d,c,b){this.fpId=++a;this.fpDomId="FilePreviewID-"+String(this.fpId);this.fpCtx=d;this.fpExtension=b;this.fpListItem=c},getHtml:function(){a:;return['<div class="js-filePreview-containingElement" id=',StAttrQuote(this.fpDomId),">",this.getInnerHtml(),"</div>"].join("")},getDomId:function(){a:;return this.fpDomId},getContainingElement:function(){a:;var a=document.getElementById(this.fpDomId);return a},canRender:function(){a:;return true},getLoadingIndicatorHtml:function(a){if(m$.isUndefined(a))a="";return['<div class="js-filePreview-loading-image" style="width:',this.getWidth(),"px; height:",this.getHeight(),"px; line-height:",this.getHeight(),"px; text-align:center; vertical-align:middle; display: inline-block; "+a+'">','<img src="',"/_layouts/15/images/loading.gif?rev=23",'" />',"</div>"].join("")},hideLoadingIndicator:function(){a:;var a=document.getElementById(this.fpDomId);m$(a).find("div.js-filePreview-loading-image").css({display:"none"})},getInnerHtml:function(){a:;return""},getWidth:function(){a:;return null},getHeight:function(){a:;return null},onPostRender:function(){},onVisible:function(){},onHidden:function(){}}}();blankPreview=Object.create(previewBase);blankPreview.type="blankPreview";blankPreview.getHtml=function(){a:;return""};embeddedWACPreview=Object.create(previewBase);embeddedWACPreview.type="embeddedWACPreview";embeddedWACPreview.dimensions={docx:{width:379,height:252},docm:{width:379,height:252},dotx:{width:379,height:252},dot:{width:379,height:252},doc:{width:379,height:252},odt:{width:379,height:252},pptx:{width:350,height:221},potx:{width:350,height:221},ppt:{width:350,height:221},pot:{width:350,height:221},potm:{width:350,height:221},pptm:{width:350,height:221},ppsx:{width:350,height:221},pps:{width:350,height:221},ppsm:{width:350,height:221},odp:{width:350,height:221},xlsx:{width:352,height:237},xlsb:{width:352,height:237},xlsm:{width:352,height:237}};embeddedWACPreview.getWidth=function(){a:;return this.dimensions[this.fpExtension].width};embeddedWACPreview.getHeight=function(){a:;return this.dimensions[this.fpExtension].height};embeddedWACPreview.getInnerHtml=function(){a:;return this.getLoadingIndicatorHtml()};embeddedWACPreview.canRender=function(){a:;var a=getWACManualOverride(),b=m$.isNotNull(a)?a:!this.fpCtx.DocumentLibraryCalloutOfficeWebAppPreviewersDisabled;return b&&m$.isDefined(this.dimensions[this.fpExtension])&&m$.isDefinedAndNotNull(this.fpListItem.ServerRedirectedEmbedUrl)&&this.fpListItem.ServerRedirectedEmbedUrl!==""};embeddedWACPreview.onVisible=function(){a:;var b=this.fpListItem.ServerRedirectedEmbedUrl+"&wdSmallView=1",e=String(this.getWidth())+"px",d=String(this.getHeight())+"px",a=[];a.push('<div class="js-frame-wrapper" style="line-height:0" >');a.push('  <iframe style="width:'+e+"; height:"+d+';"');a.push("    src="+StAttrQuote(b));a.push('    frameborder="0"');a.push("  ></iframe>");a.push("</div>");var c=this.getContainingElement();c.innerHTML=a.join("")};WACImagePreview=Object.create(previewBase);WACImagePreview.type="WACImagePreview";WACImagePreview.canRender=function(){a:;return false};folderPreview=Object.create(previewBase);folderPreview.type="folderPreview";folderPreview.canRender=function(){a:;return m$.isDefinedAndNotNull(this.fpListItem.FileLeafRef)&&m$.isDefinedAndNotNull(this.fpListItem.FSObjType)&&m$.isDefinedAndNotNull(this.fpListItem.ID)&&m$.isDefinedAndNotNull(this.fpCtx.listName)};folderPreview.getFolderSource=function(){a:;return this.fpCtx.imagesPath+"skydrive_folder.png"};folderPreview.getWidth=function(){a:;return 213};folderPreview.getHeight=function(){a:;return 128};folderPreview.getInnerHtml=function(){a:;var a=[];a.push('<div style="position:relative; display: inline-block" class="js-folder-preview-wrapper" width="',this.getWidth(),'" height="',this.getHeight(),'">');a.push('  <img class="js-documentIcon" width="',this.getWidth(),'" height="',this.getHeight(),'"');a.push('    border="0" ');a.push('    alt="'+this.fpListItem.FileLeafRef+'"');a.push('    title="'+this.fpListItem.FileLeafRef+'"');a.push('    src="'+this.getFolderSource()+'"');a.push('    style="display: inline"');a.push("  />");a.push('  <span class="js-folder-preview-count"></span>');a.push(this.getLoadingIndicatorHtml("position: absolute; left: 0; top: 0;"));a.push("</div>");return a.join("")};folderPreview.onVisible=function(){a:;var e=this.getContainingElement(),a=SP.ClientContext.get_current(),d=a.get_web().get_lists().getById(this.fpCtx.listName),b=d.getItemById(this.fpListItem.ID),c=b.get_folder(),f=m$.proxy(function(){a:;this.hideLoadingIndicator();var b=c.get_itemCount(),a=m$(e).find("span.js-folder-preview-count");a.append(document.createTextNode(b))},this),g=m$.proxy(function(){a:;this.hideLoadingIndicator()},this);a.load(d);a.load(b);a.load(c,"ItemCount");a.executeQueryAsync(f,g)};mediaPreview=Object.create(previewBase);mediaPreview.type="mediaPreview";mediaPreview.getWidth=function(){a:;return 350};mediaPreview.getHeight=function(){a:;return 197};mediaPreview.canRender=function(){a:;var a=browseris.firefox||browseris.chrome,b=this.fpExtension==="ogg"||this.fpExtension==="ogv"||this.fpExtension==="webm",c=browseris.ie9standardUp&&this.fpExtension==="wav";return(browseris.firefox||this.fpExtension!=="oga")&&(a||!b)&&!c};mediaPreview.getPlayerId=function(){a:;return this.getDomId()+"-MediaPlayer"};mediaPreview.getMediaPlayer=function(){a:;return document.getElementById(this.getPlayerId())};mediaPreview.getInnerHtml=function(){a:;return this.getLoadingIndicatorHtml()};mediaPreview.onVisible=function(){a:;var a=this,b=this.getContainingElement(),f=this.fpCtx.CurrentItem,c=new URI(this.fpCtx.HttpRoot),e=c.getScheme()+"://"+c.getAuthority(),d=e+f.FileRef;EnsureScript("mediaplayer.js",typeof mediaPlayer,function(){a:;if(!m$(":root").contains(b))return;mediaPlayer.ensureCssIsIncluded(a.fpCtx.CurrentLanguage);b.style.width=a.getWidth()+"px";b.style.height=a.getHeight()+"px";var c;if(mediaPlayer.isVideoFileExtension(a.fpExtension))c=a.fpCtx.imagesPath+"videopreview.png";else c=a.fpCtx.imagesPath+"audiopreview.png";var f={mediaSource:d,previewImageSource:c,embedModePreview:true,mediaFileExtension:a.fpExtension};a.hideLoadingIndicator();mediaPlayer.createMediaPlayer(b,a.getPlayerId(),a.getWidth()+"px",a.getHeight()+"px",f,null);var e=document.createElement("div");e.style.clear="both";b.appendChild(e)})};mediaPreview.onHidden=function(){a:;var a=this;EnsureScript("mediaplayer.js",typeof mediaPlayer,function(){a:;mediaPlayer.performPlayBackAction(a.getMediaPlayer(),mediaPlayer.playBackActionNames.Stop)})};imagePreview=Object.create(previewBase);imagePreview.type="imagePreview";imagePreview.getWidth=function(){a:;return 350};imagePreview.getHeight=function(){a:;return 250};imagePreview.canRender=function(){a:;return m$.isDefinedAndNotNull(this.fpListItem.FileLeafRef)&&m$.isDefinedAndNotNull(this.fpListItem.FSObjType)&&m$.isDefinedAndNotNull(this.fpListItem["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"])&&this.fpListItem["HTML_x0020_File_x0020_Type.File_x0020_Type.mapico"]!==""&&!(browseris.ie8standard&&this.fpExtension==="svg")};imagePreview.getInnerHtml=function(){a:;var a=[];a.push("<img");a.push(' alt="'+this.fpListItem.FileLeafRef+'"');a.push(' title="'+this.fpListItem.FileLeafRef+'"');a.push(' src="'+this.fpListItem.FileRef+'"');a.push(' style="max-width: '+String(350)+"px; max-height: "+String(250)+"px; min-height: "+String(50)+'px"');a.push(" onload=\"(event.srcElement ? event.srcElement : event.target).style.minHeight = '';\"");a.push("/>");return a.join("")};filePreviewManager={previewers:{other:{noExtension:[blankPreview],extensionNotInMapping:[blankPreview],folder:[folderPreview],fallback:[blankPreview]},extensionToPreviewerMap:{docx:[embeddedWACPreview,WACImagePreview],docm:[embeddedWACPreview,WACImagePreview],dotx:[embeddedWACPreview,WACImagePreview],dot:[embeddedWACPreview,WACImagePreview],doc:[embeddedWACPreview,WACImagePreview],odt:[embeddedWACPreview,WACImagePreview],pptx:[embeddedWACPreview],potx:[embeddedWACPreview],ppt:[embeddedWACPreview],pot:[embeddedWACPreview],potm:[embeddedWACPreview],pptm:[embeddedWACPreview],ppsx:[embeddedWACPreview],pps:[embeddedWACPreview],ppsm:[embeddedWACPreview],odp:[embeddedWACPreview],xlsx:[embeddedWACPreview],xlsb:[embeddedWACPreview],xlsm:[embeddedWACPreview],avi:[mediaPreview],mp4:[mediaPreview],ogg:[mediaPreview],ogv:[mediaPreview],webm:[mediaPreview],wmv:[mediaPreview],mp3:[mediaPreview],oga:[mediaPreview],wav:[mediaPreview],wma:[mediaPreview],jpg:[imagePreview],jpeg:[imagePreview],gif:[imagePreview],png:[imagePreview],bmp:[imagePreview],svg:[imagePreview]}},createPreviewFromListItem:function(i,d){var b=d.File_x0020_Type,h=d.FSObjType==="1",g=m$.isDefinedAndNotNull(b)&&b.trim()!=="",a;if(h)a=this.previewers.other.fallback;else if(g){var f=this.previewers.extensionToPreviewerMap[b];if(m$.isDefined(f))a=f;else a=this.previewers.other.extensionNotInMapping}else a=this.previewers.other.noExtension;a.push.apply(a,this.previewers.other.fallback);for(var c,e=0;e<a.length;++e){c=Object.create(a[e]);c.init(i,d,b);if(c.canRender())return c}return null}};getWACManualOverride=function(){a:;var a=null;if(m$.isDefinedAndNotNull(localStorage.SPWacPreviewEnabled))a=localStorage.SPWacPreviewEnabled==1;else{var c=new URI(window.location.href,{queryCaseInsensitive:true}),b=c.getQueryParameter("callout_wac_enabled");if(m$.isDefinedAndNotNull(b))a=b.toUpperCase()==="TRUE"}return a};notifyScriptsLoadedAndExecuteWaitingJobs("filePreview.js")}function ULS7RK(){var a={};a.ULSTeamName="Microsoft SharePoint Foundation";a.ULSFileName="filePreview.commentedjs";return a}var previewBase,blankPreview,embeddedWACPreview,WACImagePreview,folderPreview,mediaPreview,imagePreview,filePreviewManager,getWACManualOverride;$_global_filepreview();