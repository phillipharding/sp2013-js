function $_global_menu(){kfnDisableEvent=new Function("return false");g_menuHtc_lastMenu=null;g_uniqueNumber=0;g_MenuEndOfDOM=false;ElementPosition_InitializePrototype();MenuTag_InitializePrototype();MMU_chDelim=",";MMU_chDelimEnc="%2c";MMU_postbackPrefix="javascript:__doPostBack(";MMU_chDelim2="%";MMU_chDelim2Enc="%25";MHash_InitializePrototype();ParseContext_InitializePrototype();MMU_reDelimEnc=new RegExp(MMU_chDelimEnc,"g");MMU_reDelim2Enc=new RegExp(MMU_chDelim2Enc,"g");MMU_reDelimDec=new RegExp(MMU_chDelim,"g");MMU_reDelim2Dec=new RegExp(MMU_chDelim2,"g");g_MMU_HighlightedEcbTable=null;g_MMU_HighlightedEcbTableOpen=null;g_MMU_OpenTimeoutHandle=null;g_MMU_theFormActionAtPageLoad=null;g_MMU_Form0ActionAtPageLoad=null;g_MMU_Form0ActionAtPreMenuOpen=null;g_MMU_RequestTimeoutTimeoutHandle=null;typeof Sys!="undefined"&&Boolean(Sys)&&Boolean(Sys.Application)&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs=="function"&&NotifyScriptLoadedAndExecuteWaitingJobs("menu.js")}function ULSv4Y(){var a={};a.ULSTeamName="Microsoft SharePoint Foundation";a.ULSFileName="menu.commentedjs";return a}function FNEmpWz(a){return null!=a&&""!=a}function AChld(b,a){null!=b&&null!=a&&b.appendChild(a)}function AImg(a,c,b){if(null==a)return;FNEmpWz(c)&&a.setAttribute("iconSrc",c);if(FNEmpWz(b))a.setAttribute("iconAltText",b);else a.setAttribute("iconAltText","")}function CMenu(b){var a=document.getElementById(b);if(null!=a){a._initialized=false;a._oContents=null;a.innerHTML="";return a}a=document.createElement("MENU");if(null==a)return null;if(null!=b)a.id=b;a.className="ms-SrvMenuUI";var d=document.body;if(typeof g_clientIdDeltaPlaceHolderUtilityContent!="undefined"&&Boolean(g_clientIdDeltaPlaceHolderUtilityContent)){var c=document.getElementById(g_clientIdDeltaPlaceHolderUtilityContent);if(Boolean(c))d=c}AChld(d,a);return a}function CMItm(b){var a=document.createElement("SPAN");if(null==a)return null;a.setAttribute("type",b);return a}function CMOpt(f,g,e,d,c,b){var a=CMItm("option");if(null==a)return null;a.setAttribute("text",f);a.setAttribute("onMenuClick",g);null!=b&&a.setAttribute("description",b);AImg(a,e,d);FNEmpWz(c)&&a.setAttribute("sequence",c);return a}function CAMOpt(h,f,g,e,c,d,b){var a=CMOpt(f,g,e,c,d,b);if(null==a)return null;AChld(h,a);return a}function CIMOpt(c,h,i,g,f,d){var a=CMOpt(h,i,g,f,d);if(null==a)return null;for(var b=0;b<c.childNodes.length;b++){var e=c.childNodes[b].getAttribute("sequence");if(e)if(Number(e)>Number(d)){c.childNodes[b].parentNode.insertBefore(a,c.childNodes[b]);return a}}AChld(c,a);return a}function CMSep(){a:;var a=CMItm("separator");setInnerText(a,"");return a}function CAMSep(b){var a=CMSep();if(null==a)return null;AChld(b,a);return a}function CSubM(f,e,d,c,b){var a=CMItm("submenu");if(null==a)return null;a.setAttribute("text",f);null!=b&&a.setAttribute("description",b);AImg(a,e,d);FNEmpWz(c)&&a.setAttribute("sequence",c);return a}function CASubM(g,f,e,c,d,b){var a=CSubM(f,e,c,d,b);if(null==a)return null;AChld(g,a);return a}function FRdy(a){if(null==a)return false;if(a.readyState==null)return true;switch(a.readyState){case"loaded":case"interactive":case"complete":return true;default:return false}return false}function OMenu(j,k,g,h,e,d,c,f){var b=j,a;if(typeof b=="string"){var i=b;a=document.getElementById(i)}else a=b;null!=a&&OMenuInt(a,k,g,h,e,d,c,f);return false}function OMenuInt(a,h,b,g,e,d,c,f){(null!=a&&!MenuHtc_isOpen(a)||null!=a&&null!=b)&&MenuHtc_show(a,h,b,g,e,d,c,f)}function OMenuEvnt(){a:;var a=event.srcElement;if(null!=a&&FRdy(document)){var e=a.relativeTo,c=a.forceRefresh,d=a.flipTop,b=a.yOffsetTop;e!=null&&a.removeAttribute("relativeTo");c!=null&&a.removeAttribute("forceRefresh");d!=null&&a.removeAttribute("flipTop");b!=null&&a.removeAttribute("yOffsetTop");a.onreadystatechange=null;OMenuInt(a,e,c,d,b)}}var kfnDisableEvent,g_menuHtc_lastMenu,g_uniqueNumber,g_MenuEndOfDOM;function RenderECBBackwardCompatibilityMode(a){g_MenuEndOfDOM=a}function IsAccessibilityFeatureEnabledProxy(){a:;var a=false;if(typeof IsAccessibilityFeatureEnabled!="undefined")a=IsAccessibilityFeatureEnabled();return a}function MenuHtc_show(oMaster,oParent,fForceRefresh,fFlipTop,yOffset,fShowClose,fShowCheckBoxes,evt){MenuHtc_hide();MenuHtc_init(oMaster);oMaster._oParent=oParent;oMaster._fIsRtL=IsElementRtl(oMaster._oParent);if((browseris.ie||browseris.nav)&&IsAccessibilityFeatureEnabledProxy()){var menu=null;if(oParent.foa!=null){var foa=oParent.foa;menu=byid(foa);if(menu==null)menu=eval(foa)}if(menu!=null)typeof menu.onblur!="undefined"&&menu.onblur!=null&&menu.onblur();RenderAccessibleMenu(oMaster,fForceRefresh);g_menuHtc_lastMenu=oMaster}else{SetBodyEventHandlers(null);AssureId(oParent);var result=ShowRoot(oMaster,oParent,fForceRefresh,fFlipTop,yOffset,fShowClose,fShowCheckBoxes,evt);g_menuHtc_lastMenu=oMaster;SetBodyEventHandlers(HandleDocumentBodyClick)}if(browseris.ie)if(window.event!=null)window.event.cancelBubble=true;return false}function MenuHtc_hide(){a:;ClearTimeOutToHideMenu();var a=g_menuHtc_lastMenu;if(a!=null)if(a._accessibleMenu!=null)CloseAccessibleMenu(a);else HideMenu(a);g_menuHtc_lastMenu=null}function MenuHtc_isOpen(a){if(null==a||null==a._initialized)return false;var b=IsOpen(a);return b}function MenuHtc_item(a,c,b){MenuHtc_init(a);var d=GetItem(a,c,b);return d}function TrapMenuClick(a){if(a!=null)a.cancelBubble=true;return false}function SetBodyEventHandlers(a){SetEvent("click",a,document.body)}function HandleDocumentBodyClick(){if(g_menuHtc_lastMenu!=null){var a=g_menuHtc_lastMenu;a!=null&&HideMenu(a)}return false}function GetEventPopup(b){var a=GetEventSrcElement(b);while(a!=null){if(a.master!=null)return a;a=a.parentNode}return null}function GetUniqueNumber(){a:;g_uniqueNumber++;return g_uniqueNumber}function MenuHtc_init(a){if(a._initialized)return;a._initialized=true;a._wzPrefixID="mp"+String(GetUniqueNumber());if(a.id==null)a.id=a._wzPrefixID+"_id";a._nLevel=0;a._arrPopup=[];a._arrSelected=[];if(typeof a._onDestroy=="undefined")a._onDestroy=null;a._fLargeIconMode=false;a._fCompactItemsWithoutIcons=false}function PrepContents(a){var c;a._fLargeIconMode=a.getAttribute("largeIconMode")=="true";a._fHideIcons=a.getAttribute("hideicons")=="true";a._fCompactItemsWithoutIcons=a.getAttribute("CompactMode")=="true";if(!browseris.safari){c=document.createElement("span");a._oContents=c;c.style.display="none";var b=a.innerHTML;if(b.indexOf("<IE:MENUITEM ")<0&&b.indexOf("<MENUITEM ")>=0){b="<?XML:NAMESPACE PREFIX = IE />"+b;b=b.replace(/<MENUITEM/g,"<IE:MENUITEM");b=b.replace(/<\/MENUITEM/g,"</IE:MENUITEM")}c.innerHTML=b}else{c=a.cloneNode(true);a._oContents=c;c.style.display="none"}a._wzMArrPath="/LAYOUTS_RMJ/images/MArr.gif";a._wzMArrPathRtL="/LAYOUTS_RMJ/images/MArrRtL.gif"}function FixUpMenuStructure(j){for(var f=j._oRoot,h=f.childNodes,g=null,a=null,d=false,c=0;c<h.length;c++){var b=h[c];if(b.nodeType!=1)continue;var e=false,k=b.style!=null&&b.style.display=="none",l=FIsIHidden(b);if(k||l)e=true;else if(FIsIType(b,"separator"))if(a!=null||c==0)e=true;else{a=b;d=true}else{var i=b.getAttribute("menuGroupId");if(i!=g&&a==null&&c!=0){a=document.createElement("ie:menuitem");a.setAttribute("type","separator");f=j._oRoot;f.insertBefore(a,b)}else if(FIsIType(b,"submenu")&&a!=null&&!d){b.parentNode.removeChild(a);a=null}else a=null;g=i;d=false}if(e){b.parentNode.removeChild(b);c--}}a!=null&&a.parentNode.removeChild(a)}function IsElementRtl(a){while(a!=null&&a.tagName!=null){var b=a.getAttribute("dir");if((b==null||b=="")&&a.style!=null)b=a.style.direction;if(b=="rtl")return true;else if(b=="ltr")return false;a=a.parentNode}return false}function getElementOverFlowStyle(a){try{return typeof a.currentStyle!=undefined&&a.currentStyle!=null?a.currentStyle.overflow.toLowerCase():document.defaultView.getComputedStyle(a,null).getPropertyValue("overflow").toLowerCase()}catch(b){return""}}function AdjustScrollPosition(d,e,b){var a=d;while(a!=null&&a!=e&&a!=d.offsetParent&&a.tagName!=null&&a.tagName.toLowerCase()!="body"&&a.tagName.toLowerCase()!="html"&&!(getElementOverFlowStyle(a)=="hidden")){if(a.scrollWidth>a.clientWidth&&a.offsetWidth>=a.clientWidth&&a.clientWidth!=0)if(!IsElementRtl(a)){if(a.scrollLeft>0)b.x-=a.scrollLeft}else if(browseris.ie8standardUp)b.x+=a.scrollLeft;else if(browseris.firefox)b.x-=a.scrollLeft;else{var c=getElementOverFlowStyle(a);if(browseris.ie||browseris.safari&&(c=="auto"||c=="scroll"))b.x+=a.scrollWidth-a.clientWidth-a.scrollLeft}if(a.scrollTop>0)b.y-=a.scrollTop;a=a.parentNode}}function ElementPosition_InitializePrototype(){a:;ElementPosition.prototype.x=undefined;ElementPosition.prototype.y=undefined;ElementPosition.prototype.width=undefined;ElementPosition.prototype.height=undefined}function ElementPosition(c,d,b,a){this.x=c;this.y=d;this.width=b;this.height=a}function MenuHtc_GetElementPosition(a,d){var b=new ElementPosition(0,0,0,0);if(null!=a.offsetParent){var c=a;while(c!=null&&c!=d){b.x+=c.offsetLeft;b.y+=c.offsetTop;AdjustScrollPosition(c,d,b);var e=c.tagName.toLowerCase();if(e!="body"&&e!="html"&&c.clientTop!=null&&c.clientLeft!=null&&c!=a){b.x+=c.clientLeft;b.y+=c.clientTop}c=c.offsetParent}}else if(0!=a.offsetLeft||0!=a.offsetTop){b.x=a.offsetLeft;b.y=a.offsetTop}else{if(Boolean(a.x))b.x=a.x;if(Boolean(a.y))b.y=a.y}if(0!=a.offsetWidth&&0!=a.offsetHeight){b.width=a.offsetWidth;b.height=a.offsetHeight}else if(null!=a.style&&typeof a.style.pixelWidth!="undefined"&&0!=a.style.pixelWidth&&typeof a.style.pixelHeight!="undefined"&&0!=a.style.pixelHeight){b.width=a.style.pixelWidth;b.height=a.style.pixelHeight}return b}function MenuTag(b,a){this.tagName=b;this.className=a}function MenuTag_InitializePrototype(){a:;MenuTag.prototype.tagName=undefined;MenuTag.prototype.className=undefined}function CreateMenuTag(a){var b=null;if(a.tagName!=null){b=document.createElement(a.tagName);if(a.className!=null)b.className=a.className}return b}function TransferEventToMenu(b,c){var a;if(browseris.ie)a={srcElement:b,keyCode:c.keyCode};else a={target:b,which:c.which};PopupKeyDown(a)}function MenuHtcInternal_Show(c,b,B,k,y,x,m){var q,A,z,p;!Boolean(c._oContents)&&PrepContents(c);var i="ms-core-menu-box";if(c._fLargeIconMode)i+="Big";if(!Boolean(c._fHideIcons))i+=" ms-core-menu-hasIcons";i+=" ms-core-defaultFont ms-shadow";q=new MenuTag("div",i);p=new MenuTag("ul","ms-core-menu-list");var t=c._arrPopup,r=c._arrSelected,e=c._nLevel,a=t[e];if(!Boolean(c._oContents)||IsOpen(c))return;if(null==a&&!Boolean(c._oRoot)){c._nLevel=0;e=0;c._oRoot=c._oContents}var h=e==0;k=k&&h;if(null==a){a=CreateMenuTag(q);a.title="";t[e]=a;a.isMenu=true;a.master=c;a.level=e;var j=CreateMenuTag(p);a.style.top="0px";a.style.position="fixed";a.style.visibility="hidden";if(c._fIsRtL){a.style.right="0px";a.setAttribute("dir","rtl")}else{a.style.left="0px";a.setAttribute("dir","ltr")}a.contentEditable=false;a.appendChild(j);if(g_MenuEndOfDOM==true)document.body.appendChild(a);else if(b.tagName=="TABLE")b.parentNode.appendChild(a);else b.appendChild(a);FixUpMenuStructure(c);var n=0,u=c._oRoot;e=c._nLevel;for(var w=u.childNodes.length,l=0;l<w;l++){var f=u.childNodes[l];if(f.nodeType!=1)continue;if(!FIsIType(f,"label")){var g=CreateMenuItem(c,f,MakeID3(c,e,n),null,x);null!=g&&j.appendChild(g);n++}}if(c.id=="filter_menu"||y){g=document.createElement("div");g.id=MakeID3(c,e,n);g.className="ms-core-menu-closebutton";f=document.createElement("button");g.appendChild(f);f.id="fmi_cls";f.innerHTML=Strings.STS.L_CloseButtonCaption;f.onclick=MenuHtc_hide;j.appendChild(g)}a.oncontextmenu=kfnDisableEvent;a.ondragstart=kfnDisableEvent;a.onselectstart=kfnDisableEvent;if(b._onmouseover==null&&typeof b.onmouseover!="undefined")b._onmouseover=b.onmouseover;if(b._onmouseout==null&&typeof b.onmouseout!="undefined")b._onmouseout=b.onmouseout;if(b._onmousedown==null&&typeof b.onmousedown!="undefined")b._onmousedown=b.onmousedown;if(b._onclick==null&&typeof b.onclick!="undefined")b._onclick=b.onclick;if(b._oncontextmenu==null&&typeof b.oncontextmenu!="undefined")b._oncontextmenu=b.oncontextmenu;if(h)if(b._onkeydown==null&&typeof b.onkeydown!="undefined")b._onkeydown=b.onkeydown;if(browseris.nav){SetEvent("keypress",function(){a:;return false},a);SetEvent("keyup",function(){a:;return false},a);SetEvent("keydown",function(a){a:;PopupKeyDown(a);a.cancelBubble=true;return false},a);SetEvent("mousedown",function(a){a:;TrapMenuClick(a);return false},a);SetEvent("mouseover",function(a){a:;PopupMouseOver(a);return false},a);SetEvent("mouseout",function(a){a:;PopupMouseLeave(a);return false},a);SetEvent("click",function(a){a:;PopupMouseClick(a);TrapMenuClick(a);return false},a);SetEvent("mouseover",function(a){a:;PopupMouseOverParent(a);return false},b);SetEvent("mouseout",function(a){a:;PopupMouseLeaveParent(a);return false},b);SetEvent("mousedown",function(a){a:;TrapMenuClick(a);return false},b);SetEvent("click",function(a){a:;TrapMenuClick(a);return false},b);SetEvent("contextmenu",function(a){a:;TrapMenuClick(a);return false},b);if(h)b.onkeydown=function(b){a:;TransferEventToMenu(a,b);return false}}else{SetEvent("keydown",new Function("PopupKeyDown(event); event.cancelBubble = true; return false;"),a);SetEvent("mousedown",new Function("TrapMenuClick(event); return false;"),a);SetEvent("mouseover",new Function("PopupMouseOver(event); return false;"),a);SetEvent("mouseout",new Function("PopupMouseLeave(event); return false;"),a);SetEvent("click",new Function("PopupMouseClick(event); TrapMenuClick(event); return false;"),a);SetEvent("mouseover",new Function("PopupMouseOverParent(event); return false;"),b);SetEvent("mouseout",new Function("PopupMouseLeaveParent(event); return false;"),b);SetEvent("mousedown",new Function("TrapMenuClick(event); return false;"),b);SetEvent("click",new Function("TrapMenuClick(event); return false;"),b);SetEvent("contextmenu",new Function("TrapMenuClick(event); return false;"),b);if(h)b.onkeydown=function(){a:;TransferEventToMenu(a,event);return false}}if(h){var s=c.getAttribute("onunloadtext");null!=s&&SetEvent("unload",new Function(s),a)}}else{var v=r[e];null!=v&&UnselectItem(v)}r[e]=null;var d;if(browseris.ie&&m==null){var o=document.body.scrollLeft;d=document.createElement("iframe");AssureId(d);d.src="/_layouts/blank.htm";d.style.position="absolute";d.style.display="none";d.scrolling="no";d.frameBorder=0;if(g_MenuEndOfDOM==true)document.body.appendChild(d);else if(b.tagName=="TABLE")b.parentNode.appendChild(d);else b.appendChild(d);a.style.zIndex="103";a._backgroundFrameId=d.id;if(o!=document.body.scrollLeft)document.body.scrollLeft=o}a.style.width=String(a.offsetWidth)+"px";if(c._fIsRtL)a.style.right="";a.style.position="absolute";SetMenuPosition(c,b,a,k,h,m);a.style.visibility="visible";NavigateToMenu(c);if(browseris.ie&&m==null){SetBackFrameSize(null,a);a.onresize=new Function("SetBackFrameSize(event, null);");d.style.display="block";d.style.zIndex=String(101)}}function GetWindowPosition(){var a=new ElementPosition(0,0,0,0);a.width=window.screen.width;a.height=window.screen.height;if(Boolean(self.innerHeight)){a.width=self.innerWidth;a.height=self.innerHeight}else if(null!=document.documentElement&&Boolean(document.documentElement.clientHeight)){a.width=document.documentElement.clientWidth;a.height=document.documentElement.clientHeight}else if(null!=document.body){a.width=document.body.clientWidth;a.height=document.body.clientHeight}return a}function SetMenuPosition(M,D,c,L,w,E){var x=GetWindowPosition(),j=x.width,m=x.height,d=c.offsetWidth,h=c.offsetHeight,K=false,J=false;if(d>j-50){K=true;d=j-50<0?0:j-50}if(h>=m-50){J=true;h=m-50<0?0:m-50}if(K){c.style.width=String(d)+"px";c.style.overflowX="scroll"}if(J){c.style.height=String(h)+"px";c.style.overflowY="scroll"}d=c.offsetWidth;h=c.offsetHeight;var y=x.x,P=x.y,v=j,b=0,r=0,O=D,k;if(E!=null)k=new ElementPosition(E.clientX,E.clientY,0,0);else k=MenuHtc_GetElementPosition(O,null);b=k.x;r=k.y;var g;if(w){g=k.width;r+=k.height}else g=k.width+1;var N=!L&&!document.body.WZ_ATTRIB_FLIPPED,u,C,z,A;if(!M._fIsRtL){var s,q;if(w){z=b;s=b+d;q=b+g-d}else{z=b+g;s=b+g+d;q=b-d}A=q;u=s>v&&q>y;C=!(q<y&&s<v)}else{var p,t;if(w){p=b+g-d;t=b+d;A=b}else{p=b-d;t=b+g+d;A=b+g}z=p;u=p<y&&t<v;C=!(t>v&&p>y)}var i=N?u:C,B=i?A:z,f,n;if(typeof window.pageXOffset!="undefined"){f=window.pageXOffset;n=window.pageYOffset}else{var l=document.body.parentNode;if(!IsElementRtl(document.body)){f=document.body.scrollLeft;f+=l.scrollLeft}else if(browseris.ie8standard){f=-document.body.scrollLeft;f+=-l.scrollLeft}else{var F=getElementOverFlowStyle(document.body);if(browseris.ie||browseris.safari&&(F=="auto"||F=="scroll"))f=-document.body.scrollWidth+document.body.clientWidth+document.body.scrollLeft;f+=-l.scrollWidth+l.offsetWidth+l.scrollLeft}n=document.body.scrollTop;n+=l.scrollTop}if(d>=j)B=f;else if(B-f+d>=j)B=f+j-d;var o;if(h>=m)o=n;else if(r+h-n>=m)o=n+m-h;else o=r;if(browseris.safari)o+=window.pageYOffset;else o+=document.documentElement.scrollTop;c.setAttribute("flipped",String(L?i&&u:i));var a=B,e=o;if(browseris.safari)e-=window.pageYOffset;else e-=document.documentElement.scrollTop;if(g_MenuEndOfDOM==false)if(!w){if(M._fIsRtL)if(browseris.ie)if(i)a=a-b;else a=a-b+1;else if(i)a=a-b;else a=a-b+3;else if(browseris.ie)if(i)a=a-b+1;else a=a-b;else if(i)a=a-b+3;else a=a-b;if(e==0)e=D.offsetTop-c.offsetParent.firstChild.scrollTop;else e=e-r+D.offsetTop-c.offsetParent.firstChild.scrollTop;if(browseris.ie8standard)e=e-1}else if(c.offsetParent!=null&&c.offsetParent.tagName.toLowerCase()!="body"){var G,H,I=MenuHtc_GetElementPosition(c.offsetParent);G=I.x;H=I.y;e=e-H;a=a-G}else{a=a+document.documentElement.scrollLeft;e=e+document.documentElement.scrollTop}c.style.left=String(a)+"px";c.style.top=String(e)+"px";c.LeftForBackIframe=a;c.TopForBackIframe=e}function SetBackFrameSize(f,a){a:;if(a==null)a=GetEventSrcElement(f);var e=a.offsetWidth,d=a.offsetHeight,c,b=document.getElementById(a._backgroundFrameId);if(b!=null){c=a.LeftForBackIframe;b.style.left=String(c)+"px";c=a.TopForBackIframe;b.style.top=String(c)+"px";b.style.width=String(e)+"px";b.style.height=String(d)+"px"}}function HideMenu(b,d){ClearTimeOutToHideMenu();if(d==null)d=0;if(d==2){if(typeof b._onDestroy=="function"){b._onDestroy();b._onDestroy=null}return}if(IsOpen(b)&&!IsAccessibilityFeatureEnabledProxy()){var a=b._oParent;if(a!=null){a.onclick=a._onclick;a.onmouseover=a._onmouseover;a.onmouseout=a._onmouseout;a.onmousedown=a._onmousedown;a.oncontextmenu=a._oncontextmenu;a.onkeydown=a._onkeydown}SetBodyEventHandlers(typeof window.origBodyOnClickHandler=="undefined"?null:window.origBodyOnClickHandler);UpdateLevel(b,0);var f=b._arrPopup,c=f[0];if(c!=null){var e=document.getElementById(c._backgroundFrameId);e!=null&&e.parentNode.removeChild(e);c.parentNode!=null&&c.parentNode.removeChild(c);f[0]=null;if(d==0)if(typeof b._onDestroy=="function"){b._onDestroy();b._onDestroy=null}}g_menuHtc_lastMenu=null;RenderECBBackwardCompatibilityMode(false)}}function IsOpen(a){var b=a._accessibleMenu;if(a._accessibleMenuInProgress||null!=b&&!b.closed)return true;var c=a._arrPopup;if(null==c)return false;var d=a._nLevel,e=c[d];return e?true:false}function FindLabel(d){var a=Boolean(d)?d.childNodes:null;if(null!=a)for(var b=0;b<a.length;b++){var c=a[b];if(c.nodeType!=1)continue;if(FIsIType(c,"label"))return c}return null}function ShowRoot(a,f,d,b,h,e,c,g){UpdateLevel(a,0);if(d){a._oContents=null;a._oRoot=null;a._nLevel=0;a._arrPopup=[];a._arrSelected=[]}else a._oRoot=a._oContents;b=b!=false;MenuHtcInternal_Show(a,f,0,b,e,c,g)}function ShowSubMenu(a,c,b){if(null==b)return;if(b.submenuRoot==null)return;if(b.submenuRoot==a._oRoot)return;UpdateLevel(a,c);a._oRoot=b.submenuRoot;var d=a._nLevel;a._nLevel=d+1;MenuHtcInternal_Show(a,b,-1)}function ShowSubMenuEvnt(a){if(a!=null){var f=a._arrPopup,b=a._nLevel,c=f[b];if(null!=c){c.removeAttribute("timeoutID");var d=a._arrSelected,e=d[b];ShowSubMenu(a,b,e)}}}function SetShowSubMenuEvnt(a){var b=a._arrPopup,c=a._nLevel,d=b[c];if(null!=d){ClearTimeOut("timeoutID");document.body.setAttribute("timeoutID",String(window.setTimeout(function(){a:;ShowSubMenuEvnt(a)},100)))}}function ClearTimeOut(a){var b=document.body.getAttribute(a);b!=null&&window.clearTimeout(Number(b));document.body.removeAttribute(a)}function ClearShowSubMenuEvnt(){a:;ClearTimeOut("timeoutID")}function GetEventSrcItem(e,b){var d,a,c;d="li";if(b!=null&&FIStringEquals(b.tagName,"div")&&b.className.indexOf("ms-core-menu-box")!=-1)return null;c=e._wzPrefixID;for(a=b;a!=null&&!FIStringEquals(a.tagName,"body");a=a.parentNode)if(FIStringEquals(a.tagName,d)&&a.id.substring(0,c.length)==c)return a;return null}function UpdateLevel(c,h){var f,b,a,g,d=c._nLevel;while(d>h){f=c._arrSelected;b=c._arrPopup;if(b!=null)a=b[d];if(null!=a){ClearShowSubMenuEvnt(a);var e=document.getElementById(a._backgroundFrameId);e!=null&&e.parentNode.removeChild(e);a.parentNode.removeChild(a)}b[d]=null;f[d]=null;g=c._oRoot;c._oRoot=g.parentNode;d--;c._nLevel=d}b=c._arrPopup;if(b!=null)a=b[d];null!=a&&ClearShowSubMenuEvnt(a)}function PopupMouseOver(e){var d=GetEventPopup(e);if(d!=null){var a=d.master,c=d.level;if(c<0)return;var g=a._arrSelected,b=GetEventSrcItem(a,GetEventSrcElement(e));if(null!=b){var h=g[c],f=a._nLevel;if(b!=h){if(FIsIType(b,"separator"))return;ToggleMenuItem(a,c,b);FIsIType(b,"submenu")&&EngageSelection(a,true,true,false)}else c<f&&UnselectCurrentOption(a)}ClearTimeOutToHideMenu()}}function PopupMouseLeave(b){var a;a=GetEventPopup(b);if(a!=null){UnselectCurrentOption(a.master);SetTimeOutToHideMenu()}return false}function PopupMouseOverParent(){if(g_menuHtc_lastMenu!=null){ClearTimeOutToHideMenu();var a=g_menuHtc_lastMenu._oParent;if(a!=null)typeof a._onmouseover=="function"&&a._onmouseover()}}function PopupMouseLeaveParent(){if(g_menuHtc_lastMenu!=null){var a=g_menuHtc_lastMenu._oParent;if(a!=null)typeof a._onmouseout=="function"&&a._onmouseout();SetTimeOutToHideMenu()}}function ClearTimeOutToHideMenu(){a:;document.body.getAttribute("HideMenuTimeOut")!=null&&ClearTimeOut("HideMenuTimeOut")}function SetTimeOutToHideMenu(){a:;ClearTimeOut("HideMenuTimeOut");document.body.setAttribute("HideMenuTimeOut",String(window.setTimeout(MenuHtc_hide,5e3)))}function PopupMouseClick(a){var h=GetEventPopup(a),b=h.master,c=h.level;if(c<0)return;var g=b._arrSelected,i=g[c],e=GetEventSrcItem(b,GetEventSrcElement(a));if(i!=e)if(null!=e)g[c]=e;UpdateLevel(b,c);var d=null,f=false;if(browseris.nav){if(null!=a&&null!=a.target){f=a.target.className=="hierarchy";d=a.target.getAttribute("onExpand")}}else if(null!=a&&null!=a.srcElement){f=a.srcElement.className=="hierarchy";d=a.srcElement.getAttribute("onExpand")}EngageSelection(b,true,false,false,f,d)}function PopupKeyDown(c){var d=GetEventPopup(c),b=d.master,f=d.level;if(f<0)return;var a=GetEventKeyCode(c),e=c.shiftKey;if(b._fIsRtL)if(a==37)a=39;else if(a==39)a=37;if(a==9)a=!e?40:38;ClearShowSubMenuEvnt(d);switch(a){case 38:MoveMenuSelection(b,-1);break;case 40:MoveMenuSelection(b,1);break;case 37:case 27:CloseCurrentLevel(b,a==27);break;case 39:case 32:case 13:EngageSelection(b,a==13||a==32,false,true)}c.returnValue=false}function SetNewId(a){a:;a.id="msomenuid"+String(GetUniqueNumber());return a.id}function AssureId(a){a:;if(a.id==null||a.id=="")a.id="msomenuid"+String(GetUniqueNumber());return a.id}function NavigateToMenu(b){if(IsAccessibilityFeatureEnabledProxy())return;var c=null,e=b._nLevel,d=b._arrPopup;c=d[e];try{var a=c.firstChild.firstChild;a=a.getElementsByTagName("A")[0];if(a!=null)if(typeof a.setActive!="undefined"&&a.setActive!=null)a.setActive();else typeof a.focus!="undefined"&&a.focus!=null&&a.focus()}catch(f){}}function ExecuteOnClick(fnOnClick,oMaster){try{if(browseris.safari)if(FIStringEquals(typeof fnOnClick,"string"))eval("var document=window.document; {"+fnOnClick+"}");else fnOnClick();else{if(FIStringEquals(typeof fnOnClick,"string"))fnOnClick=new Function("event","var document=window.document; {"+fnOnClick+"}");var oTemp=window.document.body.appendChild(window.document.createElement("span"));oTemp.master=oMaster;oTemp.onclick=fnOnClick;var evt,ctxVar=null;if(typeof currentCtx!="undefined"&&currentCtx!=null)ctxVar=currentCtx;else if(typeof ctxFilter!="undefined"&&ctxFilter!=null)ctxVar=ctxFilter;if(browseris.ie)evt={srcElement:oTemp,fakeEvent:1,currentCtx:ctxVar};else evt={target:oTemp,fakeEvent:1,currentCtx:ctxVar};oTemp.onclick(evt);oTemp.parentNode.removeChild(oTemp)}}catch(e){}}function EngageSelection(oMaster,fDoSelection,fDelayExpandSM,fEnterSM,fExpand,fCommand){var nLevel=oMaster._nLevel,arrSelected=oMaster._arrSelected,oItem=arrSelected[nLevel];if(null==oItem||oItem.optionDisabled)return;if(FIsIType(oItem,"submenu"))if(fDelayExpandSM)SetShowSubMenuEvnt(oMaster);else{ShowSubMenu(oMaster,nLevel,oItem);fEnterSM&&MoveMenuSelection(oMaster,1)}else if(fDoSelection){var fEnabled=oItem.getAttribute("enabled");if(fEnabled!="false")if(!fExpand){var fnOnClick=oItem.getAttribute("onMenuClick");if(null!=fnOnClick){var noHideMenu=false,executed=false;if(oMaster.id=="filter_menu"){ExecuteOnClick(fnOnClick,oMaster);executed=true;RefreshOpenedSortMenu(oMaster,nLevel);RefreshClearAndFilterMenu(oMaster,oItem,nLevel);var idValue=oMaster._wzPrefixID+"_"+String(nLevel)+"_";if(oItem.id!=idValue+String(1)&&oItem.id!=idValue+String(0)&&!oMaster.hideMenu)noHideMenu=true}if(!noHideMenu){HideMenu(oMaster,1);!executed&&ExecuteOnClick(fnOnClick,oMaster);HideMenu(oMaster,2)}}else{var oItemAnchor=oItem.firstChild,fnClick=oItemAnchor.onclick;null!=fnClick&&fnClick()}}else eval(fCommand)}}function RefreshClearAndFilterMenu(n,i,r){if(ctxFilter==null)return;var h=parseInt(i.id.substr(i.id.lastIndexOf("_")+1)),y=n._oRoot,e=y.childNodes,u=filterTable.getAttribute("Name"),k=document.getElementById("FilterIframe"+filterTable.getAttribute("CtxNum")),g=null;if(typeof k.contentDocument!="undefined")g=k.contentDocument;if(g==null&&null!=k.contentWindow)g=k.contentWindow.document;if(g==null)g=k.ownerDocument;var s=g.getElementById("diidFilter"+u);if(s==null)return;var q=s==null?null:s.childNodes,p=true,c=null;if(e[h].id!="fmi_asc"&&e[h].id!="fmi_desc"&&e[h].id!="fmi_clr"){c=document.getElementById(i.id+"_ICON");if(i.getAttribute("checked")=="true"){i.setAttribute("checked","false");if(c!=null){c.checked=false;window.setTimeout(function(){a:;c.checked=false},0)}}else{i.setAttribute("checked","true");if(c!=null){c.checked=true;window.setTimeout(function(){a:;c.checked=true},0)}}}else if(e[h].id=="fmi_asc"||e[h].id=="fmi_desc")p=false;for(var f="",w=q==null?0:q.length,d=-1,o=0,j=1;o<e.length&&j<w;o++,j++){f=n._wzPrefixID+"_"+String(r)+"_"+String(o);var a=document.getElementById(f);if(d<0){var b=a.firstChild;if(b!=null)b=b.firstChild;if(b!=null)b=b.nextSibling;if(b!=null&&b.id=="fmi_clr")d=o;j=0;continue}var v=FilterFieldV3(ctxFilter.view,escapeProperly(u),q[j].value,j,ctxFilter.queryString,true),x="javascript:HandleFilter(event, '"+STSScriptEncode(v)+"')";a.setAttribute("onMenuClick",x);if(h==d){a.setAttribute("checked","false");var t=document.getElementById(f+"_ICON");if(t!=null)t.checked=false}if(a.getAttribute("checked")=="true")p=false}if(d<0)return;f=n._wzPrefixID+"_"+String(r)+"_"+String(d);a=document.getElementById(f);if(a==null)return;var l=document.getElementById(f+"_ICON"),m=document.getElementById(MakeID3(n,r,d));if(!p){a.setAttribute("enabled","true");a.disabled=false;a.optionDisabled=false;a.setAttribute("iconSrc",GetThemedImageUrl("DeleteFilterGlyph.png"));if(l!=null)l.src=GetThemedImageUrl("DeleteFilterGlyph.png");m!=null&&RemoveCssClassFromElement(m,"ms-core-menu-itemDisabled")}else{a.setAttribute("enabled","false");a.disabled=true;a.optionDisabled=true;a.setAttribute("iconSrc",GetThemedImageUrl("DisabledDeleteFilterGlyph.png"));if(l!=null)l.src=GetThemedImageUrl("DisabledDeleteFilterGlyph.png");m!=null&&Menu_AddCssClassToElement(m,"ms-core-menu-itemDisabled")}}function RefreshOpenedSortMenu(i,j){if(ctxFilter==null)return;var e="",d="",a=ctxFilter.queryString;if(a==null)a="";var k=new URI(a,{disableEncodingDecodingForLegacyCode:true});a="?"+k.getQuery();a=RemovePagingArgs(a);var f=filterTable.getAttribute("SortFields"),c=a.indexOf("&SortDir="),b=a.indexOf("&",c+1);if(c==-1){c=f.indexOf("&SortDir=");b=f.indexOf("&SortField=");e=a+f.substr(b,c-b)+"&SortDir=Asc";d=a+f.substr(b,c-b)+"&SortDir=Desc"}else if(c!=-1){e=a.substr(0,c)+"&SortDir=Asc";d=a.substr(0,c)+"&SortDir=Desc";if(b!=-1){e+=a.substr(b);d+=a.substr(b)}}e="HandleFilter(event, '"+STSScriptEncode(e)+"', 1);";d="HandleFilter(event, '"+STSScriptEncode(d)+"', 1);";var g=i._wzPrefixID+"_"+String(j)+"_"+String(0),h=document.getElementById(g);h.setAttribute("onMenuClick",e);g=i._wzPrefixID+"_"+String(j)+"_"+String(1);h=document.getElementById(g);h.setAttribute("onMenuClick",d)}function CloseCurrentLevel(oMaster,fAllowHideRoot){var nLevel=oMaster._nLevel,arrSelected,obj;if(nLevel>0){UpdateLevel(oMaster,nLevel-1);nLevel=oMaster._nLevel;arrSelected=oMaster._arrSelected;obj=arrSelected[nLevel];if(obj!=null){typeof obj.onclick!="undefined"&&obj.onclick!=null&&SetEvent("click",obj._onclick,obj);obj=obj.getElementsByTagName("a")[0];if(obj!=null)if(typeof obj.setActive!="undefined"&&obj.setActive!=null)obj.setActive();else typeof obj.focus!="undefined"&&obj.focus!=null&&obj.focus()}}else if(fAllowHideRoot){HideMenu(oMaster);var oParent=oMaster._oParent;while(oParent!=null&&oParent.tagName=="SPAN"&&oParent.getAttribute("contentEditable")=="true")oParent=oParent.parentNode;if(oParent!=null){var focusElement=oParent,foastr=oParent.getAttribute("foa");if(foastr!=null){var foa=eval(foastr);if(foa==null)foa=byid(foastr);if(foa!=null)focusElement=foa}else if(focusElement.tagName!="A"){var anchorList=focusElement.getElementsByTagName("a"),anchorListLen=anchorList.length;if(anchorListLen>0)focusElement=anchorList[anchorListLen-1]}if(focusElement!=null)try{if(typeof focusElement.setActive!="undefined"&&focusElement.setActive!=null)focusElement.setActive();else typeof focusElement.focus!="undefined"&&focusElement.focus!=null&&focusElement.focus()}catch(e){}}}}function UnselectCurrentOption(c){var a=c._nLevel;if(a>=0){var b=c._arrSelected,d=b[a];if(FIsIType(d,"option")){UnselectItem(d);b[a]=null}}}function MakeID3(a,c,b){return a._wzPrefixID+"_"+String(c)+"_"+String(b)}function GetItem(a,b,d){var c=a._arrPopup,e=c[b];return Boolean(e)?document.getElementById(MakeID3(a,b,d)):null}function MoveMenuSelection(d,h){var a=-1,l=d._oRoot,c=l.childNodes.length,g=d._nLevel,j=d._arrSelected,i=j[g],b=null;if(null!=i){var e=Boolean(i)?i.id:null;if(null!=e){var f=parseInt(e.substring(e.lastIndexOf("_")+1,e.length));if(f==c)f=-1;if(f+h==c){a=c;b=GetItem(d,g,c)}if(b==null)a=(f+h)%c}}if(a<0)a=h>0?0:c-1;if(b==null){var k=a;do{b=GetItem(d,g,a);a=(a+h)%c}while(a!=k&&(null==b||b.style.display=="none"||!(FIsIType(b,"option")||FIsIType(b,"submenu"))))}ToggleMenuItem(d,g,b)}function ToggleMenuItem(f,d,c){var e=f._arrSelected,a=e[d];if(null==c||null!=a&&c.id==a.id)return;if(null!=a){UnselectItem(a);a.onkeydown=null;a.onmousedown=null;a.onmouseover=null;a.onmouseout=null;a.oncontextmenu=null}UpdateLevel(f,d);SelectItem(c);e[d]=c;try{var b=c.firstChild;if(b!=null)if(typeof b.setActive!="undefined"&&b.setActive!=null)b.setActive();else typeof b.focus!="undefined"&&b.focus!=null&&b.focus()}catch(g){}}function SelectItemStatic(a){if(null==a)return;if(a.tagName!="HR"&&a.tagName!="DIV"){a.setAttribute("selectedStatic","true");a.className+=" ms-core-menu-staticItemSelected"}}function SelectItem(a){if(null==a)return;if(a.tagName!="HR"&&a.tagName!="DIV")a.className+=" ms-core-menu-itemSelected"}function UnselectItem(a){if(null==a)return;if(a.tagName!="HR"&&a.tagName!="DIV")a.className=a.className.replace("ms-core-menu-itemSelected","")}function SetImageSize(c,b,a){if(a==null)if(c._fLargeIconMode)a=32;else a=16;b.width=String(a);b.height=String(a)}function CreateMenuOption(o,j,c,y,C,E){var a=null,h,b,n,B,e,k,q,G=null,f,m,D,l,A,s,i,v,t,d,u,F=new MenuTag("span",null),x=new MenuTag("div",null);h=CreateMenuTag(x);b=CreateMenuTag(x);n=CreateMenuTag(F);B=CreateMenuTag(x);a=document.createElement("a");a.className="ms-core-menu-link";j.getAttribute("isindented")=="true"&&Menu_AddCssClassToElement(a,"ms-core-menu-indent");a.id=y+"_Anchor";a.appendChild(h);a.appendChild(b);a.appendChild(n);a.appendChild(B);a.href="javascript:;";a.setAttribute("onclick","return false;");if(o._fCompactItemsWithoutIcons&&null==c.getAttribute("iconSrc"))b.className="ms-core-menu-labelCompact";else b.className="ms-core-menu-label";b.id=c.id;if(c.getAttribute("enabled")=="false"){j.disabled=true;Menu_AddCssClassToElement(j,"ms-core-menu-itemDisabled");var p=document.createElement("span");p.appendChild(document.createTextNode(Strings.STS.L_DisabledMenuItem));p.className="ms-accessible ms-core-menu-disabledText";b.appendChild(p);a.setAttribute("aria-disabled","true")}e=EvalAttributeValue(c,"text","textScript");if(e==null||e==""){k=c.firstChild;if(k!=null&&k.nodeType==3)e=k.nodeValue}q=EvalAttributeValue(c,"description","descriptionScript");if(q!=null&&e!=null&&o._fLargeIconMode){f=document.createElement("span");f.className="ms-core-menu-title";m=document.createTextNode(e);D=document.createElement("br");l=document.createElement("span");A=document.createTextNode(q);l.className="ms-core-menu-itemDescription";b.appendChild(f);f.appendChild(m);b.appendChild(D);b.appendChild(l);l.appendChild(A)}else if(e!=null){f=document.createElement("span");f.className="ms-core-menu-title";s=c.getAttribute("hierarchy");if(s!=null){i=document.createElement("span");v=c.getAttribute("onExpand");v!=null&&i.setAttribute("onExpand",v);i.className="hierarchy";b.appendChild(i);i.innerHTML=s;b.appendChild(f);f.innerHTML=e}else{m=document.createTextNode(e);b.appendChild(f);f.appendChild(m)}}if(e!=null)a.title=e;t=document.createElement("span");t.innerHTML=Boolean(C)?C:"";b.appendChild(t);if(Boolean(o._fHideIcons))h.className="ms-hide";else if(o._fLargeIconMode)h.className="ms-core-menu-iconLarge";else h.className="ms-core-menu-icon";var w=null,g=null,r=false,z=false;if(c.getAttribute("checked")=="true"){z=true;r=true}else if(c.getAttribute("checked")=="false"&&(currentFilterMenu!=null&&currentFilterMenu.id=="filter_menu"||E))r=true;else{w=EvalAttributeValue(c,"iconSrc","iconScript");g=c.getAttribute("iconAltText")}if(r){d=document.createElement("INPUT");d.setAttribute("type","checkbox");z&&d.setAttribute("checked","yes");d.title=Boolean(g)?g:"";h.appendChild(d);d.id=y+"_ICON";d.setAttribute("style","padding-left:0px")}else if(Boolean(w)){d=document.createElement("img");d.src=w;d.alt=Boolean(g)?g:"";d.title=Boolean(g)?g:"";h.appendChild(d);d.id=y+"_ICON"}u=c.getAttribute("accessKeyText");if(null!=u)n.innerHTML=u;else n.className="ms-accessible";SetIType(j,"option");j.appendChild(a)}function CreateMenuSeparator(b,a){a.innerHTML='<hr class="ms-core-menu-separatorHr" />';SetIType(a,"separator")}function CreateSubmenu(c,a,e,g){var f=FindLabel(e);CreateMenuOption(c,a,e,g,Boolean(f)?f.innerHTML:null);var d=null,b=document.createElement("img");if(a.className.indexOf("ms-core-menu-hasArrow")==-1)a.className+=" ms-core-menu-hasArrow";d=a.childNodes[0].childNodes[3];d.className="ms-core-menu-arrowBox";b.className="ms-core-menu-arrow";d.appendChild(b);b.src=!c._fIsRtL?c._wzMArrPath:c._wzMArrPathRtL;b.alt=Strings.STS.L_SubMenu_Text;b.title="";SetIType(a,"submenu");a.submenuRoot=e}function MergeAttributes(c,b){if(!browseris.nav&&typeof c.mergeAttributes!="undefined"&&c.mergeAttributes!=null)c.mergeAttributes(b);else{var d=b.attributes,f=0;if(typeof d.length!="undefined"&&d.length!=null)f=d.length;for(var e=0;e<f;e++){var a=d[e];a!=null&&a.specified&&a.nodeName!="id"&&a.nodeName!="ID"&&a.nodeName!="name"&&c.setAttribute(a.nodeName,a.nodeValue)}b.getAttribute("type")!=null&&c.setAttribute("type",b.getAttribute("type"));if(b.submenuRoot!=null)c.submenuRoot=b.submenuRoot}}function CreateMenuItem(e,b,f,i,h){var a,g,d,c;if(FIsIType(b,"label"))return null;a=document.createElement("li");MergeAttributes(a,b);a.id=f;if(FIsIType(b,"separator")){CreateMenuSeparator(e,a);a.className="ms-core-menu-separator";return a}a.className="ms-core-menu-item";null==GetIType(b)&&SetIType(b,"option");if(FIsIType(b,"submenu"))CreateSubmenu(e,a,b,f);else FIsIType(b,"option")&&CreateMenuOption(e,a,b,f,i,h);if(a.disabled==true||a.getAttribute("enabled")=="false"){Menu_AddCssClassToElement(a,"ms-core-menu-itemDisabled");a.disabled=false;g=a.childNodes.length;for(d=0;d<g;d++){c=a.childNodes[d];if(c.nodeType!=1||c.tagName=="A")continue;c.disabled=true}a.optionDisabled=true}return a}function GetItems(b){var a=b._oContents;null==a&&PrepContents(b);a=b._oContents;return a.childNodes}function GetIType(a){return Boolean(a)?a.getAttribute("type"):null}function FIsIType(b,a){return FIStringEquals(GetIType(b),a)}function SetIType(a,b){null!=a&&a.setAttribute("type",b)}function FIStringEquals(a,b){return a!=null&&b!=null&&a.toLowerCase()==b.toLowerCase()}function RenderAccessibleMenu(a,c){a:;if(c){a._oContents=null;a._oRoot=null;a._nLevel=0;a._arrPopup=[];a._arrSelected=[]}else a._oRoot=a._oContents;!Boolean(a._oContents)&&PrepContents(a);if(!Boolean(a._oContents))return;if(!Boolean(a._oRoot)){a._nLevel=0;a._oRoot=a._oContents}FixUpMenuStructure(a);var d=a._fIsRtL?"rtl":"ltr";g_menuHtc_html="<html dir='"+d+"'><head><title>"+Strings.STS.L_AccessibleMenu_Text+"</title></head><body><ul id='root'>";RenderMenuLevel(a,a._oRoot,true);g_menuHtc_html=g_menuHtc_html+"</ul></body></html>";a._accessibleMenuInProgress=true;var b=window.open("/_layouts/blank.htm","_blank","status=no,toolbar=no,menubar=no,location=no");a._accessibleMenu=b;b.document.write(g_menuHtc_html);b.document.close();b.onunload=MenuHtc_hide;b.focus()}function CloseAccessibleMenu(a,b){if(b==null)b=0;if(a!=null){a._accessibleMenuInProgress=false;if(b==0||b==1){var c=a._accessibleMenu;if(c!=null){c.close();try{c.opener!=null&&c.opener.focus()}catch(d){}a._accessibleMenu=null}}if(b==0||b==2)if(typeof a._onDestroy=="function"){a._onDestroy();a._onDestroy=null}}}function GetMenuItemText(d,b,a){if(a==""){a=EvalAttributeValue(b,"text","textScript");var c=EvalAttributeValue(b,"description","descriptionScript");if(c!=null&&c!=""&&d._fLargeIconMode){if(a!="")a=a+": ";a=a+c}}if(b.getAttribute("checked")=="true")a="* "+a;if(b.title!=null&&b.title!="")a=a+": "+b.title;return a}function GetMenuItemEnabled(a,b){return!b?false:a.getAttribute("enabled")=="false"?false:a.getAttribute("disabled")!=null&&a.getAttribute("disabled")!=""?false:true}var g_menuHtc_html;function RenderMenuLevel(d,j,g){for(var h=j.childNodes,i=h.length,e=0;e<i;e++){var a=h[e];if(a.nodeType!=1)continue;if(a.style.display=="none")continue;var b;if(FIsIType(a,"option")){b=GetMenuItemText(d,a,a.innerHTML.trim());if(!GetMenuItemEnabled(a,g))g_menuHtc_html=g_menuHtc_html+'<li><span id="'+a.id+'">'+b+"</span></li>";else g_menuHtc_html=g_menuHtc_html+'<li><a href="#" id="'+a.id+'" onMenuClick="'+a.getAttribute("onMenuClick")+'" onclick="javascript:opener.ExecuteOnAccessibleClick(this.getAttribute(\'onMenuClick\')); return false;">'+b+"</a></li>"}else if(FIsIType(a,"submenu")){b=GetMenuItemText(d,a,"");g_menuHtc_html=g_menuHtc_html+'<li><span id="'+a.id+'">'+b;for(var f=0;f<a.childNodes.length;f++){var c=a.childNodes[f];if(c.nodeType!=1)continue;if(c.style.display=="none")continue;if(FIsIType(c,"label")){g_menuHtc_html=g_menuHtc_html+" "+c.innerHTML;break}}g_menuHtc_html=g_menuHtc_html+"</span><ul>";RenderMenuLevel(d,a,GetMenuItemEnabled(a,g));g_menuHtc_html=g_menuHtc_html+"</ul></li>"}}}function ExecuteOnAccessibleClick(b){var a=g_menuHtc_lastMenu;if(a!=null){CloseAccessibleMenu(a,1);ExecuteOnClick(b,a);CloseAccessibleMenu(a,2)}}function FIsIHidden(oItem){if(null!=oItem){var hiddenFunc=oItem.getAttribute("hidden");return null==hiddenFunc?false:eval(hiddenFunc)}else return false}function EvalAttributeValue(oNode,sAttribute1,sAttribute2){var result=oNode.getAttribute(sAttribute2);if(result!=null&&result.toLowerCase().indexOf("javascript:")==0)result=String(eval(result.substring(11)));else result=null;if(result==null||result=="")result=oNode.getAttribute(sAttribute1);if(result==null)result="";return result}function Menu_AddCssClassToElement(a,b){var d=a.className;if(d!=null){if(!c(a,b))a.className=a.className+" "+b}else a.className=b;function c(c,e,f){var d=c.className;if(d==null)return false;for(var a=d.split(" "),b=0;b<a.length;b++)if(a[b]==e){if(f){a.splice(b,1);c.className=a.join(" ")}return true}return false}}function setInnerText(a,b){var c=a.ownerDocument;if(Boolean(c.createTextNode)){var d=c.createTextNode(b);a.innerHTML="";a.appendChild(d)}else a.innerText=b}var MMU_chDelim,MMU_chDelimEnc,MMU_postbackPrefix,MMU_chDelim2,MMU_chDelim2Enc;function MHash_InitializePrototype(){a:;MHash.prototype._keys=undefined;MHash.prototype._values=undefined;MHash.prototype.Add=MHash_Add;MHash.prototype.Count=MHash_Count;MHash.prototype.Keys=MHash_Keys;MHash.prototype.Values=MHash_Values;MHash.prototype.Exists=MHash_Exists;MHash.prototype.Item=MHash_Item}function MHash(){a:;this._keys=[];this._values=[]}function MHash_Add(b,a){a:;this._keys.push(b);this._values.push(a)}function MHash_Count(){a:;return this._keys.length}function MHash_Keys(){a:;return this._keys}function MHash_Values(){a:;return this._values}function MHash_Exists(c){a:;for(var d=this.Count(),b=this.Keys(),a=0;a<d;a++)if(b[a]==c)return true;return false}function MHash_Item(c){a:;for(var d=this.Count(),b=this.Keys(),a=0;a<d;a++)if(b[a]==c)return this.Values()[a];return null}function ParseContext_InitializePrototype(){a:;ParseContext.prototype.TemplateClientId=undefined;ParseContext.prototype.MenuClientId=undefined;ParseContext.prototype.TimeoutMessage=undefined}function ParseContext(c){try{var b=c.split(";"),a=b[0];this.TemplateClientId=a;a=b[1];this.MenuClientId=a;a=b[2];this.TimeoutMessage=a.replace(/%semi%/g,";").replace(/%quot%/g,"'")}catch(d){alert(Strings.STS.L_Loading_Error_Text)}}var MMU_reDelimEnc,MMU_reDelim2Enc,MMU_reDelimDec,MMU_reDelim2Dec;function MMU_EncVal(a){return a.replace(MMU_reDelimDec,MMU_chDelimEnc).replace(MMU_reDelim2Dec,MMU_chDelim2Enc)}function MMU_DecVal(a){return a.replace(MMU_reDelim2Enc,MMU_chDelim2).replace(MMU_reDelimEnc,MMU_chDelim)}function MMU_ParseNV(h){var g=new MHash,c=h.split(MMU_chDelim);if(c!=null)for(var f=0;f<c.length;f++){var a=c[f],b=a.indexOf("=");if(b==0)continue;var e=null,d=null;if(b<0)e=a;else{e=a.substr(0,b);if(b<a.length-1)d=MMU_DecVal(a.substr(b+1));else d=""}g.Add(e,d)}return g}function MMU_ParseNVAttr(b,d){var a=b.getAttribute(d);if(a==null&&b.childNodes.length>0){var c=b.childNodes[0];if(c.nodeType==1)a=c.getAttribute(d)}return a==null?new MHash:MMU_ParseNV(a)}function MMU_ResetMenuState(j,h,i,g,b){for(var f=j.childNodes,e=0;e<f.length;e++){var a=f[e];if(a.nodeType!=1)continue;var c=a.getAttribute("id");if(a!=null&&c!=null&&c.length>0){if(a.childNodes.length>0){MMU_ResetMenuState(a,h,i,g,b);continue}if(i.Exists(c))a.style.display="none";else{a.style.display="";var d=a.getAttribute("enabledOverride");if(d!=null&&d.length>0)a.setAttribute("enabled",d);else if(h.Exists(c))a.setAttribute("enabled","false");else{a.setAttribute("enabled","true");if(g.Exists(c))a.setAttribute("checked","true");else a.setAttribute("checked","false")}}MMU_ReplTokValAttr(a,"onMenuClick",b);MMU_ReplTokValAttr(a,"text",b);MMU_ReplTokValAttr(a,"description",b);MMU_ReplTokValVal(a,b)}}}function MMU_ReplTokValAttr(c,b,f){a:;var a=c.getAttribute(b),d=c.getAttribute(b+"_Original");if(a!=null&&d==null&&f.Count()>0)c.setAttribute(b+"_Original",a);else if(a!=null&&d!=null&&a!=d)a=d;if(a==null||a.length<=0)return;var e=MMU_ReplTokVal(a,f);e!=a&&c.setAttribute(b,e)}function MMU_ReplTokValVal(c,e){a:;if(c.nextSibling==null)return;var a=c.nextSibling.nodeValue,b=c.getAttribute("valOrig");if(a!=null&&b==null&&e.Count()>0){b=a;c.setAttribute("valOrig",b)}else if(a!=null&&b!=null&&a!=b)a=b;var d=MMU_ReplTokVal(a,e);if(a!=null&&d!=null&&d!=a)c.nextSibling.nodeValue=d}function MMU_ReplTokVal(a,b){if(a!=null&&a.indexOf("%")>=0&&b!=null&&b.Count()>0)for(var d=b.Keys(),e=b.Values(),f=d.length,c=0;c<f;c++){var g=d[c],h=e[c];a=a.replace("%"+g+"%",h)}return a}var g_MMU_HighlightedEcbTable,g_MMU_HighlightedEcbTableOpen,g_MMU_OpenTimeoutHandle;function MMU_Open(menu,ecbLink,e,fAlignRight,alignId,delay){try{if(menu==null||ecbLink==null)return;if(ecbLink.getAttribute("suppressBubbleIfPostback")!=null&&e!=null&&e.srcElement!=null&&e.srcElement.href!=null&&e.srcElement.href.substr(0,MMU_postbackPrefix.length)==MMU_postbackPrefix){event.cancelBubble=true;return}ClearHighlightedEcbTableOpen();if(fAlignRight==null)fAlignRight=true;MMU_ResetMenuState(menu,MMU_ParseNVAttr(ecbLink,"menuItemsDisabled"),MMU_ParseNVAttr(ecbLink,"menuItemsHidden"),MMU_ParseNVAttr(ecbLink,"menuItemsChecked"),MMU_ParseNVAttr(ecbLink,"menuTokenValues"));var elemAlign=null;if(alignId!=null&&alignId.length>0)elemAlign=document.getElementById(alignId);if(elemAlign==null)elemAlign=document.getElementById(ecbLink.id+"_t");if(elemAlign==null)elemAlign=ecbLink;MMU_EcbHighlight(MMU_GetHighlightElement(ecbLink),true);var openMenuScript="MenuHtc_show(document.getElementById('"+menu.id+"'), document.getElementById('"+elemAlign.id+"'), true, "+String(fAlignRight)+", null);";openMenuScript+="SetEcbMouseOutAndDestroy('"+menu.id+"');";if(delay!=null&&delay>0){openMenuScript+=" g_MMU_OpenTimeoutHandle = null;";g_MMU_OpenTimeoutHandle=window.setTimeout(openMenuScript,delay,"javascript")}else eval(openMenuScript);if(e!=null)try{e.cancelBubble=true}catch(exIgnored){}}catch(ex){alert(Strings.STS.L_Loading_Error_Text)}}function SetEcbMouseOutAndDestroy(a){if(g_MMU_HighlightedEcbTable!=null){g_MMU_HighlightedEcbTable.onmouseout=null;g_MMU_HighlightedEcbTableOpen=g_MMU_HighlightedEcbTable;document.getElementById(a)._onDestroy=ClearHighlightedEcbTableOpen}}function ClearHighlightedEcbTableOpen(){a:;if(g_MMU_HighlightedEcbTableOpen!=null){MMU_EcbHighlight(g_MMU_HighlightedEcbTableOpen,false);g_MMU_HighlightedEcbTableOpen=null}}function MMU_EcbLinkOnFocusBlurDeferCall(d,c,a){if(a)c.onblur=a?new Function("MMU_EcbLinkOnFocusBlurDeferCall(null, this, false)"):null;if(g_MMU_HighlightedEcbTableOpen!=null)return;var b=document.getElementById(c.id+"_t");b!=null&&MMU_EcbHighlight(b,a)}function MMU_EcbTableMouseOverOutDeferCall(b,a){if(a){if(b==g_MMU_HighlightedEcbTableOpen)return;b.onmouseout=a?new Function("MMU_EcbTableMouseOverOut(this, false)"):null}MMU_EcbHighlight(b,a)}function MMU_EcbHighlight(a,b){if(a==null&&!b)a=g_MMU_HighlightedEcbTableOpen;if(a==null)return;if(b==null)b=false;var d=a.getAttribute("hoverActive"),c=a.getAttribute("hoverInactive");if(d==null)d="ms-selectedtitle";if(c==null)c="ms-unselectedtitle";if(b){a.className=d;g_MMU_HighlightedEcbTable=a}else a.className=c;var f=a.getAttribute("menuformat"),e=document.getElementById(a.id+"i");if(e!=null&&f!=null&&f=="ArrowOnHover")e.style.visibility=b?"visible":"hidden";if(!b)g_MMU_HighlightedEcbTable=null}function MMU_PopMenuIfShowingDeferCall(){}function MMU_HandleArrowSplitButtonKeyDown(a,c,b){return!a.shiftKey&&!a.altKey&&!a.ctrlKey&&GetEventKeyCode(a)==13?undefined:Boolean(b)?MMU_EcbLinkOnKeyDown(byid(c),b,a):undefined}function MMU_HandleArrowOnHoverKeyDown(c,b,a){return!a.shiftKey&&!a.altKey&&!a.ctrlKey&&GetEventKeyCode(a)==13?undefined:null!=b?MMU_EcbLinkOnKeyDown(c,b,a):undefined}function MMU_GetHighlightElement(b){var a=null;a=document.getElementById(b.id+"_t");return a!=null?a:b}var g_MMU_theFormActionAtPageLoad,g_MMU_Form0ActionAtPageLoad,g_MMU_Form0ActionAtPreMenuOpen;function MMU_CallbackPreMenuOpen(templateClientId,menuClientId,callbackEventReference,timeoutLength,timeoutMessage,e){try{var menuTemplate=document.getElementById(templateClientId),menuLink=document.getElementById(menuClientId);if(menuLink.getAttribute("suppressBubbleIfPostback")!=null&&e!=null&&e.srcElement!=null&&e.srcElement.href!=null&&e.srcElement.href.substr(0,MMU_postbackPrefix.length)==MMU_postbackPrefix){event.cancelBubble=true;return}MMU_StopPendingTimerEventsFromCallback();MMU_RemoveCallbackItemsFromMenuTemplate(menuTemplate);var menu=document.getElementById(menuClientId);menu.setAttribute("callbackInProgress","true");loadingMessageMenuItem=CAMOpt(menuTemplate,Strings.STS.L_Loading_Text,"null");if(loadingMessageMenuItem!=null){loadingMessageMenuItem.setAttribute("callbackitem","true");loadingMessageMenuItem.setAttribute("enabled","false")}var callbackContext=templateClientId+";"+menuClientId+";"+timeoutMessage.replace(/;/g,"%semi%").replace(/\'/g,"%quot%");callbackEventReference=callbackEventReference.replace(/__CALLBACKCONTEXT__/g,callbackContext);eval(callbackEventReference);g_MMU_RequestTimeoutTimeoutHandle=window.setTimeout("MMU_CallbackErrHandler('timeout', '"+callbackContext+"')",timeoutLength,"javascript")}catch(ex){alert(Strings.STS.L_Loading_Error_Text)}}var g_MMU_RequestTimeoutTimeoutHandle;function MMU_RemoveCallbackItemsFromMenuTemplate(b){try{for(var a=0;a<b.childNodes.length;a++){var c=b.childNodes[a];if(c.nodeType==1&&c.getAttribute("callbackitem")=="true"){b.removeChild(c);--a}}}catch(d){alert(Strings.STS.L_Loading_Error_Text)}}function MMU_StopPendingTimerEventsFromCallback(){a:;if(g_MMU_OpenTimeoutHandle!=null){window.clearTimeout(g_MMU_OpenTimeoutHandle);g_MMU_OpenTimeoutHandle=null}if(g_MMU_RequestTimeoutTimeoutHandle!=null){window.clearTimeout(g_MMU_RequestTimeoutTimeoutHandle);g_MMU_RequestTimeoutTimeoutHandle=null}}var loadingMessageMenuItem;function MMU_UpdateMenuTemplateWithErrorItem(a,b){MMU_RemoveCallbackItemsFromMenuTemplate(a);var c=CAMOpt(a,b,"null");if(loadingMessageMenuItem!=null){loadingMessageMenuItem.setAttribute("callbackitem","true");loadingMessageMenuItem.setAttribute("enabled","false")}}function MMU_UpdateOpenedMenuWithErrorItem(c,a,b){MMU_UpdateMenuTemplateWithErrorItem(a,b);HideMenu(a);MMU_Open(a,c)}function MMU_CallbackHandler(l,k){MMU_StopPendingTimerEventsFromCallback();var j=new ParseContext(k),c=document.getElementById(j.TemplateClientId);if(c==null){alert(Strings.STS.L_Loading_Error_Text);return}var b=document.getElementById(j.MenuClientId);if(b==null){alert(Strings.STS.L_Loading_Error_Text);return}var g="",i="",h="",f="",e="",a=l.split(MMU_chDelim);if(a==null||a.length!=5){if(typeof MMU_GenerateErrorMenuItem!="undefined")e=MMU_GenerateErrorMenuItem(Strings.STS.L_Loading_Error_Text)}else{var d=new RegExp(MMU_chDelimEnc,"g");g=a[0].replace(d,MMU_chDelim);i=a[1].replace(d,MMU_chDelim);h=a[2].replace(d,MMU_chDelim);f=a[3].replace(d,MMU_chDelim);e=a[4].replace(d,MMU_chDelim)}b.setAttribute("menuItemsDisabled",g);b.setAttribute("menuItemsHidden",i);b.setAttribute("menuItemsChecked",h);b.setAttribute("menuTokenValues",f);MMU_RemoveCallbackItemsFromMenuTemplate(c);c.innerHTML=c.innerHTML+e;HideMenu(c);MMU_Open(c,b);b.setAttribute("callbackInProgress","")}function MMU_CallbackErrHandler(f,e){try{alert(Strings.STS.L_Loading_Error_Text);var a=new ParseContext(e),d=document.getElementById(a.TemplateClientId);if(d==null){alert(Strings.STS.L_Loading_Error_Text);return}var b=document.getElementById(a.MenuClientId);if(b==null){alert(Strings.STS.L_Loading_Error_Text);return}b.setAttribute("callbackInProgress","");var c=Strings.STS.L_Loading_Error_Text;if(f=="timeout"&&a.TimeoutMessage!=null&&a.TimeoutMessage.length>0)c=a.TimeoutMessage;MMU_UpdateOpenedMenuWithErrorItem(b,d,c)}catch(g){alert(Strings.STS.L_Loading_Error_Text)}}$_global_menu();