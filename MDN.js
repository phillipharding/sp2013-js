function ULSveE(){var o=new Object;o.ULSTeamName="DLC Server";o.ULSFileName="MDN.js";return o;}
Type.registerNamespace("Microsoft.Office.Server.Ajax");Microsoft.Office.Server.Ajax.ViewDropDownFilter=function(a){ULSveE:;Microsoft.Office.Server.Ajax.ViewDropDownFilter.initializeBase(this);this.$0_1=a};Microsoft.Office.Server.Ajax.ViewDropDownFilter.prototype={$0_1:null,getGlobalCommands:function(){ULSveE:;return["CustomPopulateViewDropDown"]},canHandleCommand:function(a){ULSveE:;return a==="CustomPopulateViewDropDown"?this.$0_1.get_commandDispatcher().isCommandEnabled("PopulateViewDropDown"):false},$4_1:function(h){ULSveE:;var e=h;if(SP.ScriptUtility.isNullOrEmptyString(e.PopulationXML))return;var b=SP.Ribbon.NativeUtility.createXMLDocFromStringCore(e.PopulationXML,true);if(SP.ScriptUtility.isNullOrUndefined(b))return;var a=this.$2_1(b,"/Menu/MenuSection[@Id='Ribbon.Library.CustomViews.DisplayView.Menu.Other']");if(!a)return;var c=this.$2_1(a,"Controls/Button[@Id='Ribbon.Library.CustomViews.DisplayView.Menu.Other.__DlcPlvConfigLink']");if(!c)return;var g=this.$1_1(a,"Controls/Button"),d=a;if(g.length!==1){c.parentNode.removeChild(c);d=a.cloneNode(false);var f=b.createElement("Controls");d.appendChild(f);this.$3_1(f,"Id","Ribbon.Library.CustomViews.DisplayView.Menu.Settings.Controls");f.appendChild(c);a.parentNode.appendChild(d)}this.$3_1(d,"Title",SP.UI.Policy.Resources.mdn_SettingsMenuGroup);e.PopulationXML=this.$5_1(b)},handleCommand:function(b,a){ULSveE:;if(b==="CustomPopulateViewDropDown"){if(this.$0_1.get_commandDispatcher().executeCommand("PopulateViewDropDown",a)){this.$4_1(a);return true}return false}return false},$1_1:function($p0,$p1){try{return $p0.selectNodes($p1)}catch($$e_2){}for(var $v_0=new XPathEvaluator,$v_1=$v_0.evaluate($p1,$p0,eval("document.createNSResolver(document)"),XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),$v_2=new Array($v_1.snapshotLength),$v_5=0;$v_5<$v_1.snapshotLength;$v_5++)$v_2[$v_5]=$v_1.snapshotItem($v_5);var $v_3=$v_2,$v_4=$v_3;return $v_4},$2_1:function(c,d){ULSveE:;try{return c.selectSingleNode(d)}catch(e){}var a=this.$1_1(c,d+"[1]");if(a.length)for(var b=a.length-1;b>=0;b--)if(a[b])return a[b];return null},$3_1:function(a,b,c){ULSveE:;a.setAttribute(b,c)},$5_1:function($p0){var $v_0=$p0.xml;if(SP.ScriptUtility.isNullOrUndefined($v_0)){var $v_1=eval("new XMLSerializer()");return $v_1.serializeToString($p0)}else return $p0.xml.toString()}};Microsoft.Office.Server.Ajax.TaxTreeViewResources=function(){};Microsoft.Office.Server.Ajax.TaxTreeViewResources.GetIncludeTooltipString=function(){ULSveE:;return SP.UI.Policy.Resources.taxTreeView_TooltipIncludeDescendants};Microsoft.Office.Server.Ajax.TaxTreeViewResources.GetExcludeTooltipString=function(){ULSveE:;return SP.UI.Policy.Resources.taxTreeView_TooltipExcludeDescendants};Microsoft.Office.Server.Ajax.ViewDropDownFilter.registerClass("Microsoft.Office.Server.Ajax.ViewDropDownFilter",CUI.Page.PageComponent,CUI.Page.ICommandHandler);Microsoft.Office.Server.Ajax.TaxTreeViewResources.registerClass("Microsoft.Office.Server.Ajax.TaxTreeViewResources");function mdn_initialize(){}mdn_initialize();function loadFilterFn(){ULSveE:;var a=SP.Ribbon.PageManager.get_instance();a.addPageComponent(new Microsoft.Office.Server.Ajax.ViewDropDownFilter(a))}function PlvHandleFolder(g,f,a,h,i,j,k,l,m,n,o,b,p,q,r,s){ULSveE:;try{if(ctx.overrideFilterQstring!=undefined){for(var c=RemoveParametersFromUrl(a)+"?"+ctx.overrideFilterQstring,d=["TreeField","TreeValue","OverrideScope","ProcessQStringToCAML","TaxDesc","FallbackLimit","IndexKey"],b=d.length-1;b>=0;b--)c=RemoveQueryParameterFromUrl(c,d[b]);var e="RootFolder";a=StURLSetVar2(c,e,GetUrlKeyValue(e,true,a))}}catch(l){}return OldHandleFolder(g,f,a,h,i,j,k,l,m,n,o,b,p,q,r,s)}function getElementsByClass(g,b,d){ULSveE:;var e=[];if(b===null)b=document;if(d===null)d="*";for(var c=b.getElementsByTagName(d),i=c.length,h=new RegExp("(^|\\s)"+g+"(\\s|$)"),f=0,a=0;a<i;a++)if(h.test(c[a].className)){e[f]=c[a];f++}return e}function getSelectedNode(){ULSveE:;var a=getElementsByClass(treeSelectedNodeClassName,null,"TD");return a.length!=1?null:a[0]}function applyStyles(b){ULSveE:;var a=b.parentNode.parentNode.parentNode;do a=a.nextSibling;while(a&&a.nodeType!=1);if(a){a.className+=treeSelectedNodeDescendantClassName;setIconsToSelected(a.getElementsByTagName("IMG"))}}function displayDescendantsButton(e,h){ULSveE:;var f=document.createElement("A"),a=document.createElement("IMG"),c=e.childNodes[0].href;if(h){c=c.replace("\\u0026TreeValue=","\\u0026TaxDesc=0&TreeValue=");a.src="/_layouts/images/IncludeDescendantsSelected.png";a.alt=Microsoft.Office.Server.Ajax.TaxTreeViewResources.GetExcludeTooltipString();a.title=Microsoft.Office.Server.Ajax.TaxTreeViewResources.GetExcludeTooltipString();applyStyles(e);var b=e;while(b!=null){if(b.tagName=="TABLE"&&b.nextSibling!=null&&b.nextSibling.tagName=="DIV"){b.nextSibling.className+=" "+treeSelectedNodeClassName;break}b=b.parentNode}}else{c=c.replace("\\u0026TreeValue=","\\u0026TaxDesc=1&TreeValue=");a.src="/_layouts/images/IncludeDescendants.png";a.alt=Microsoft.Office.Server.Ajax.TaxTreeViewResources.GetIncludeTooltipString();a.title=Microsoft.Office.Server.Ajax.TaxTreeViewResources.GetIncludeTooltipString()}f.href=c;e.childNodes[0].href=c;var d=e;do d=d.previousSibling;while(d&&d.nodeType!=1);if(d)d.childNodes[0].href=c;a.style.borderStyle="none";f.appendChild(a);var g=document.createElement("TD");g.style.width="100%";g.appendChild(f);e.parentNode.appendChild(g)}function IncludeDescendants_Load(){ULSveE:;var a=getSelectedNode();if(a==null)return;typeof dlc_tvi!="undefined"&&dlc_tvi!=null&&dlc_tvi.ShowIncludeDescendantsUI&&displayDescendantsButton(a,dlc_tvi.IncludeDescendants);a&&a.previousSibling&&setIconsToSelected(a.previousSibling.getElementsByTagName("IMG"))}function setChildrenIconsToSelected(a){ULSveE:;while(a!=null){if(a.tagName=="DIV"&&a.className!=null&&a.className.indexOf(treeSelectedNodeDescendantClassName)!=-1){setIconsToSelected(a.getElementsByTagName("IMG"));break}a=a.parentNode}}function setIconsToSelected(a){ULSveE:;var d=GetThemedImageUrl("EMMTerm.png"),c=GetThemedImageUrl("mdnvalueselected.png");if(!a||typeof a.length=="undefined")return;for(i=0;i<a.length;++i){if(a[i].tagName!="IMG")continue;var b=a[i].src.indexOf(d);if(b!=-1)a[i].src=a[i].src.substring(0,b)+c}}var OldHandleFolder,treeSelectedNodeClassName,treeSelectedNodeDescendantClassName;ExecuteAndRegisterBeginEndFunctions("mdn.js",mdn_initialize,null,function(){ULSveE:;loadFilterFn();treeSelectedNodeClassName="ms-tv-selected";treeSelectedNodeDescendantClassName="descendant";if(HandleFolder!=PlvHandleFolder){OldHandleFolder=HandleFolder;HandleFolder=PlvHandleFolder}IncludeDescendants_Load()});typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs!="undefined"&&NotifyScriptLoadedAndExecuteWaitingJobs("mdn.js");