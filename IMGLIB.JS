function $_global_imglib(){fImglibJssLoaded=true;fImglibDefautlView=false;imglibItems=[];firstId=-1;fSelectFieldAppeared=false;previewedId=0;currentRecursiveViewStyle="";currentRootFolder="";ids=[];fAllSelected=false;selectedIdsStr="";filterIdsStr="";fSelectedView=false;currentViewGuid="";fInitSelection=false;detailStyleText="";currentViewStyle="";selectedViewLink=null;vCurrentListID="";vCurrentListUrlAsHTML="";vCurrentWebUrl="";urlCmdForDisplay="";fNewItem=false;fInit=false;tbImg=null;tbTitle=null;tbPreview=null;hilitedRow=null;previewTimer=-1;timedItem=-1;currentPicture=0;currentStrip=0;stripSize=5;listDirection="ltr";lastMenuId="";firstIdWithCheckbox=-1;fInitAttempted=false;fRecursive=false;fRTL=false;fEmptyView=false;fWebFldrView=false;fFilterOn=false;fInitViewStyle=false;fNextImageLoaded=false;fNeedReload=false;fEditingInProcess=false;listInfo=null;fIsInGroupByView=false;picturePreviewAlt=null;unverifiedSelectionIdsCount=0;verifiedSelectionIdsCount=0;selectionLimit=200;SlideshowObject_InitializePrototype();expirationInMilSeconds=6048e5;bTranState=0;slideshowInterval=5e3;slideshowIncremental=500;timerId=-1;fAutoRun=false;fRepeat=false;fRetry=0;fRetryLimit=2;typeof Sys!="undefined"&&Boolean(Sys)&&typeof Sys.Application!="undefined"&&Boolean(Sys.Application)&&typeof Sys.Application.notifyScriptLoaded!="undefined"&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs=="function"&&NotifyScriptLoadedAndExecuteWaitingJobs("imglib.js")}function ULSjYp(){var a={};a.ULSTeamName="Microsoft SharePoint Foundation";a.ULSFileName="imglib.commentedjs";return a}var fImglibJssLoaded,fImglibDefautlView,imglibItems,firstId,fSelectFieldAppeared,previewedId,currentRecursiveViewStyle,currentRootFolder,ids,fAllSelected,selectedIdsStr,filterIdsStr,fSelectedView,currentViewGuid,fInitSelection,detailStyleText,currentViewStyle,selectedViewLink,vCurrentListID,vCurrentListUrlAsHTML,vCurrentWebUrl,urlCmdForDisplay,fNewItem,fInit,tbImg,tbTitle,tbPreview,hilitedRow,previewTimer,timedItem,currentPicture,currentStrip,stripSize,listDirection,lastMenuId,firstIdWithCheckbox,fInitAttempted,fRecursive,fRTL,fEmptyView,fWebFldrView,fFilterOn,fInitViewStyle,fNextImageLoaded,fNeedReload,fEditingInProcess,listInfo,fIsInGroupByView,picturePreviewAlt,selectionCacheMgr,unverifiedSelectionIdsCount,verifiedSelectionIdsCount,selectionLimit;function ShowPic(a){var b=a.index,c=0;if(a.index!=a.pictureArray.length-1)c=a.index+1;var d=a.pictureArray.length-1;if(a.index!=0)d=a.index-1;a.image.src=a.pictureArray[b];a.image.height=a.heightArray[b];a.image.width=a.widthArray[b];a.image.alt=a.descriptionArray[b];a.link.href=a.linkArray[b];if(a.title!=null)a.title.innerHTML=a.titleArray[b];if(a.description!=null)a.description.innerHTML=a.descriptionArray[b];a.imageNext.src=a.pictureArray[c];a.imagePrev.src=a.pictureArray[d]}function ShowOnePic(a){if(a.text!=null){a.text.style.filter="alpha(opacity=100)";a.text.style.opacity=1}a.image.src=a.pictureArray[0];a.image.height=a.heightArray[0];a.image.width=a.widthArray[0];a.image.alt=a.descriptionArray[0];a.link.href=a.linkArray[0];a.image.style.filter="alpha(opacity=100)";a.image.opacity=1;if(a.title!=null)a.title.innerHTML=a.titleArray[0];if(a.description!=null)a.description.innerHTML=a.descriptionArray[0]}function ChangePic(a){if(a.index==-1){a.index++;ShowPic(a);if(a.filters&&a.filters.length>0){a.image.style.filter="alpha(opacity=100)";a.image.opacity=1;if(a.text!=null){a.text.style.filter="alpha(opacity=100)";a.text.opacity=1}a.timeout=setTimeout(function(){a:;ChangePic(a)},a.speed*1e3)}else a.timeout=setTimeout(function(){a:;SSFade(a,1)},1);return}if(a.filters&&a.filters.length>0){if(!a.imageNext.complete){a.timeout=setTimeout(function(){a:;ChangePic(a)},10);return}a.cell.style.filter=a.transition;if(a.text!=null)a.text.style.filter=a.transition;a.cell.filters[0].Apply();a.text!=null&&a.text.filters[0].Apply();if(++a.index==a.pictureArray.length)a.index=0;ShowPic(a);a.cell.filters[0].Play();a.text!=null&&a.text.filters[0].Play();a.timeout=setTimeout(function(){a:;ChangePic(a)},(a.speed+a.transitionTime)*1e3)}else{a.image.style.filter="alpha(opacity=0)";a.image.style.opacity=0;if(a.text!=null){a.text.style.filter="alpha(opacity=0)";a.text.style.opacity=0}if(++a.index==a.pictureArray.length)a.index=0;ShowPic(a);a.timeout=setTimeout(function(){a:;SSFade(a,1)},1)}}function SSFade(a,b){if(a.opacity>0&&b==-1||a.opacity<1&&b==1){a.image.style.filter="alpha(opacity="+(100*a.opacity).toString()+")";a.image.style.opacity=a.opacity;if(a.text!=null){a.text.style.filter="alpha(opacity="+(100*a.opacity).toString()+")";a.text.style.opacity=a.opacity}a.opacity+=b*.01;a.timeout=setTimeout(function(){a:;SSFade(a,b)},1)}else if(b==1)a.timeout=setTimeout(function(){a:;SSFade(a,-1)},a.speed*1e3);else if(b==-1)a.timeout=setTimeout(function(){a:;ChangePic(a)},1)}function NextPrevious(a,b){clearTimeout(a.timeout);if(a.index==-1)a.index++;if(b){if(!Boolean(a.filters)||Boolean(a.cell.filters)&&(a.cell.filters.length==0||a.cell.filters[0].status==0))if(++a.index>=a.pictureArray.length)a.index=0}else if(--a.index<=-1)a.index=a.pictureArray.length-1;if(a.filters&&a.filters.length>0){ShowPic(a);if(a.cell.filters.length>0){a.cell.filters[0].enabled=false;if(a.text!=null)a.text.filters[0].enabled=false}if(!a.paused)a.timeout=setTimeout(function(){a:;ChangePic(a)},a.speed*1e3)}else{ShowPic(a);a.image.style.filter="alpha(opacity=100)";a.image.style.opacity=1;if(a.text!=null){a.text.style.filter="alpha(opacity=100)";a.text.style.opacity=1}if(!a.paused)a.timeout=setTimeout(function(){a:;SSFade(a,-1)},a.speed*1e3)}}function PlayPause(a){var b="/_layouts/15/images/";if(!a.paused){clearTimeout(a.timeout);a.paused=true;if(a.filters&&a.filters.length>0){if(Boolean(a.cell.filters)&&a.cell.filters.length>0&&a.cell.filters[0].status!=0)if(--a.index<0)a.index=a.pictureArray.length-1;ShowPic(a);if(a.cell.filters.length>0){a.cell.filters[0].enabled=false;if(a.text!=null)a.text.filters[0].enabled=false}}else{a.image.style.filter="alpha(opacity=100)";a.image.style.opacity=1;if(a.text!=null){a.text.style.filter="alpha(opacity=100)";a.text.style.opacity=1}}if(!fRTL)a.playpause.src=b+"plplay1.gif";else a.playpause.src=b+"plplayr1.gif";a.playpause.alt=Strings.STS.L_SlideShowPlayButton_Text;a.playpausePreload.src=b+"plpause1.bmp"}else{a.paused=false;a.playpause.src=b+"plpause1.gif";a.playpause.alt=Strings.STS.L_SlideShowPauseButton_Text;if(!fRTL)a.playpausePreload.src=b+"plplay1.gif";else a.playpausePreload.src=b+"plplayr1.gif";if(a.filters&&a.filters.length>0)ChangePic(a);else a.timeout=setTimeout(function(){a:;SSFade(a,-1)},a.speed*1e3)}}function SlideshowObject_InitializePrototype(){a:;SlideshowObject.prototype={text:undefined,cell:undefined,image:undefined,link:undefined,imageNext:undefined,imagePrev:undefined,title:undefined,description:undefined,pictureArray:undefined,linkArray:undefined,titleArray:undefined,descriptionArray:undefined,heightArray:undefined,widthArray:undefined,index:undefined,opacity:undefined,speed:undefined,mode:undefined,timeout:undefined,paused:undefined,playpause:undefined,playpausePreload:undefined,transitionTime:undefined,transition:undefined,filters:undefined}}function SlideshowObject(a,d,h,f,c,e,g,i,b,j){a:;this.text=document.getElementById(a+"text");this.cell=document.getElementById(a+"cell");this.image=document.getElementById(a+"curr");this.link=document.getElementById(a+"link");this.imageNext=document.getElementById(a+"next");this.imagePrev=document.getElementById(a+"prev");this.title=document.getElementById(a+"title");this.description=document.getElementById(a+"desc");this.pictureArray=d;this.linkArray=h;this.titleArray=f;this.descriptionArray=c;this.heightArray=e;this.widthArray=g;this.index=-1;this.opacity=0;this.speed=i;this.mode=j;this.timeout=null;this.paused=false;this.playpause=document.getElementById(a+"playpause");this.playpausePreload=document.getElementById(a+"pp");this.transitionTime=b;this.transition="progid:DXImageTransform.Microsoft.Fade(duration="+String(b)+");";if(Boolean(this.image.filters))this.filters=true;else this.filters=false}function CListInfo(c,b,a){a:;if(c>=160&&c<1280)this.webImageWidth=c;else this.webImageWidth=640;if(b>=160&&b<1280)this.webImageHeight=b;else this.webImageHeight=640;if(a>=20&&a<=this.webImageWidth&&a<=this.webImageHeight)this.thumbnailSize=a;else this.thumbnailSize=160}function CreateDerivedImageUrl(b,c){var a=b.replace(/\.([^\.]+)$/,"_$1");a=a+".jpg";a=a.replace(/\/([^\/]+)$/,c+"$1");return a}function EncodedThumbnailImage(a){a:;return a==null||imglibItems[a]==null?void 0:imglibItems[a].objType==1?imglibItems[a].thumbnail:imglibItems[a].fUnknownImageType==true?imglibItems[a].thumbnail:CreateDerivedImageUrl(imglibItems[a].originalImg,"/_t/")}function GetAltText(a){a:;return a==null||imglibItems[a]==null?void 0:imglibItems[a].alt}function EncodedWebImage(a){a:;return a==null||imglibItems[a]==null?void 0:imglibItems[a].objType==1?imglibItems[a].webimage:imglibItems[a].fUnknownImageType==true?imglibItems[a].webimage:CreateDerivedImageUrl(imglibItems[a].originalImg,"/_w/")}function ViewEmptyScript(c,a,b){a:;listInfo=new CListInfo(c,a,b);fEmptyView=true;InitViewUrls();InitItems();AddSelectAllCheckbox();return}function WebFolderViewInit(a){a:;if(browseris.ie5up&&browseris.win){fWebFldrView=true;InitViewUrls();vCurrentListID=a;InitSelection()}}function GotoInfoPage(b){a:;if(b==null||b=="")return;var a=GetLayoutUrl()+"infopage.aspx?List="+vCurrentListID;a+="&reason="+b;var c=GetUrlKeyValue("RootFolder",true);if(c!="")a+="&RootFolder="+c;if(window.frameElement!=null&&typeof window.frameElement.commitPopup!="undefined"&&window.frameElement.commitPopup!=null)a+="&IsDlg=1";window.location.href=a}function MakeFullUrl(b,c){a:;var a=unescapeProperly(b);return 0==a.indexOf("http://")||0==a.indexOf("https://")?a:c+a}function StartOIS(c){a:;var b=false;try{var a=new ActiveXObject("OISCTRL.OISClientLauncher");if(Boolean(a)){b=true;typeof a.LaunchOIS!="undefined"&&a.LaunchOIS(c)}}catch(d){}return b}function PLMultipleUploadView(){a:;if(vCurrentListUrlAsHTML=="")return false;var h=vCurrentListUrlAsHTML.substring(0,vCurrentListUrlAsHTML.length-1),i=h.lastIndexOf("/");if(i==-1)return false;var c=h.substring(0,i),f=c.indexOf("://");if(f==-1)return false;var e=c,g=c.indexOf("/",f+3);if(g!=-1)e=c.substring(0,g);var a,d="";if(document.getElementById("destination")!=null)a=document.getElementById("destination").value;if(a==null||a=="")d=GetUrlKeyValue("RootFolder",true);var b=false;if(a!="")b=StartOIS('ois.exe /upload "'+MakeFullUrl(a,e)+'"');else if(d!="")b=StartOIS('ois.exe /upload "'+MakeFullUrl(d,e)+'"');else b=StartOIS('ois.exe /upload "'+vCurrentListUrlAsHTML+'"');if(!b)return false;GotoInfoPage("uploading");return true}function _EditSelectedImages(){a:;if(!browseris.ie||!browseris.win){alert(Strings.STS.L_IEOnlyFeature_Text);return}if(!fImglibDefautlView){alert(Strings.STS.L_NotOurView_Text);return}if(tbPreview==null){alert(Strings.STS.L_NotAvailableOnWebPart_Text);return}var a=MakeSelectionStr();a=a.replace(/\;/g," ");if(a==""){alert(Strings.STS.L_NoImageSelected_Text);return}if(vCurrentListUrlAsHTML=="")return;var b="ois.exe /editSP ";b+='"'+vCurrentListUrlAsHTML+'" '+a;if(StartOIS(b)){fEditingInProcess=true;SaveSelection();GotoInfoPage("editing")}else GotoInfoPage("noclient")}function EditSingleImage(b){a:;if(!browseris.ie||!browseris.win){alert(Strings.STS.L_IEOnlyFeature_Text);return}if(b=="")return;if(vCurrentListUrlAsHTML=="")return;var a="ois.exe /editSP ";a+='"'+vCurrentListUrlAsHTML+'" '+b;if(StartOIS(a)){fEditingInProcess=true;SaveSelection();GotoInfoPage("editing")}else GotoInfoPage("noclient")}function SendImagesCore(a,b){a:;if(!browseris.ie||!browseris.win){alert(Strings.STS.L_IEOnlyFeature_Text);return true}if(a==""){alert(Strings.STS.L_NoImageSelected_Text);return true}var c='ois.exe /sendto "'+b+'" '+a;return StartOIS(c)}function _SendImages(){a:;if(!browseris.ie||!browseris.win){alert(Strings.STS.L_IEOnlyFeature_Text);return}if(!fImglibDefautlView){alert(Strings.STS.L_NotOurView_Text);return}if(tbPreview==null){alert(Strings.STS.L_NotAvailableOnWebPart_Text);return}var a=MakeSelectionStr();if(a==""){alert(Strings.STS.L_NoImageSelected_Text);return}if(vCurrentListUrlAsHTML=="")return;!SendImagesCore(a,vCurrentListUrlAsHTML)&&GotoInfoPage("noclient")}function _DownloadImages(){a:;if(!browseris.ie||!browseris.win){alert(Strings.STS.L_IEOnlyFeature_Text);return}if(!fImglibDefautlView){alert(Strings.STS.L_NotOurView_Text);return}if(tbPreview==null){alert(Strings.STS.L_NotAvailableOnWebPart_Text);return}var b=MakeSelectionStr();if(b==""){alert(Strings.STS.L_NoImageSelected_Text);return}var a=GetLayoutUrl()+"Dladvopt.aspx?List="+vCurrentListID+"&SelectedIds="+b+"&ViewUI=1",c=GetUrlKeyValue("RootFolder",true);if(c!="")a+="&RootFolder="+c;window.location.href=a}function GetLayoutUrl(){a:;return vCurrentWebUrl!=""?vCurrentWebUrl+"/_layouts/15/":"../../_layouts/15/"}function DownloadOriginalImage(a){a:;if(tbPreview==null){alert(Strings.STS.L_NotAvailableOnWebPart_Text);return}if(a==null||imglibItems[a]==null||imglibItems[a].objType!=0)return;var b=GetLayoutUrl()+"download.aspx?List="+vCurrentListID+"&ItemId="+a+"&Version=0";window.location.href=b}function GetLinks(a){a:;return browseris.ie?document.getElementById(a):document.links[a]}function InitImglibView(a){a:;vCurrentListID=a}function RedirectToCorrectSelectView(){a:;fRecursive=true;fSelectedView=false;InitSelection();LoadSelection();var a=window.location.href,c=a.indexOf("?"),e="",b="";if(c!=-1){e=a.substring(c+1,a.length);b=a.substring(0,c)}else b=a;var h=/SortField=[^&]*/i,i=/SortDir=[^&]*/i,f=e.match(h),g=e.match(i),d=MakeSelectionStr();if(d=="")d="none";b+="?View="+currentViewGuid+"&FilterName=ID&FilterMultiValue="+d;if(f!=null&&g!=null)b+="&"+f.toString()+"&"+g.toString();window.open(b,"_self","",true)}function InitViewUrls(){a:;var a=window.location.href,c=a.indexOf("?"),b="",d="";if(c!=-1){b=a.substring(c+1,a.length);d=a.substring(0,c)}else d=a;if(!browseris.ie5up||!browseris.win)if(fSelectedView){alert(Strings.STS.L_SelectedViewError_Text);var h=d.replace(/\/forms\/[^\/]*$/i,"/");window.location.href=h;return}currentRootFolder=String(b.match(/RootFolder=[^&]*/));var f=b.split("&"),g=b.match(/View=([^&]*)&FilterName=ID&FilterMultiValue=([^&]*)/),i=false;if(fSelectedView)if(g!=null)filterIdsStr=g[1];else RedirectToCorrectSelectView();b="";for(var e=0;e<f.length;e++)if(f[e].match(/Filter=1/))fFilterOn=true}function SwitchViewStyle(a){a:;if(a==currentViewStyle||fEmptyView)return;if(tbPreview!=null){if(a=="filmstrip"){document.getElementById("contentfilmstrip").style.display="block";document.getElementById("contentthumbnail").style.display="none";document.getElementById("selectionCacheMgr").parentNode.parentNode.parentNode.style.display="none";if(stripSize>0){var b=document.getElementById("fstb0");b!=null&&b.focus()}}else if(a=="thumbnail"){document.getElementById("contentfilmstrip").style.display="none";document.getElementById("contentthumbnail").style.display="block";document.getElementById("selectionCacheMgr").parentNode.parentNode.parentNode.style.display="none"}else{document.getElementById("contentfilmstrip").style.display="none";document.getElementById("contentthumbnail").style.display="none";document.getElementById("selectionCacheMgr").parentNode.parentNode.style.display="block";document.getElementById("selectionCacheMgr").parentNode.parentNode.parentNode.style.display="block"}currentViewStyle=a;if(currentViewStyle=="list")tbPreview.style.display="block";else tbPreview.style.display="none"}InitSelection()}function NextSelectionOverLimit(a){a:;return unverifiedSelectionIdsCount+verifiedSelectionIdsCount+a>selectionLimit?true:false}function ToggleSelection(a){a:;if(tbPreview==null)return;if(a<0||imglibItems[a]==null)return;if(imglibItems[a].fSelected==false)if(NextSelectionOverLimit(1)){UIChange(a,false);alert(Strings.STS.L_ExceedSelectionLimit_Text);return false}else{imglibItems[a].fSelected=true;verifiedSelectionIdsCount++;UIChange(a,true)}else{imglibItems[a].fSelected=false;verifiedSelectionIdsCount--;UIChange(a,false)}SaveSelection();ConstructSelectionHref()}function ToggleSelectionAll(){a:;if(tbPreview==null)return;for(var c=!fAllSelected,b=0,a=0;a<ids.length;a++)if(imglibItems[ids[a]].objType!=1&&imglibItems[ids[a]].fSelected!=c)b++;if(c){if(NextSelectionOverLimit(b)){alert(Strings.STS.L_ExceedSelectionLimit_Text);return}verifiedSelectionIdsCount=verifiedSelectionIdsCount+b}else verifiedSelectionIdsCount=verifiedSelectionIdsCount-b;for(a=0;a<ids.length;a++)if(imglibItems[ids[a]].objType!=1){imglibItems[ids[a]].fSelected=c;UIChange(ids[a],c)}SaveSelection();ConstructSelectionHref()}function ConstructSelectionHref(){a:;var b=MakeSelectionStr();if(b=="")b="none";var a=document.getElementById("cbxSelectAll");if(a!=null)if(fAllSelected)a.src=ctx.imagesPath+"checkall.gif";else a.src=ctx.imagesPath+"unchecka.gif"}function LoadSelection(){a:;if(!fInitSelection)if(Boolean(window.ActiveXObject))try{selectionCacheMgr.load("OISSelectionStore")}catch(j){return}else return;selectedIdsStr="";var f=false;if(Boolean(selectionCacheMgr.getAttribute("listGuid"))&&vCurrentListID!=""){var g=selectionCacheMgr.getAttribute("listGuid");if(g!=vCurrentListID)f=true}if(Boolean(selectionCacheMgr.getAttribute("cachedValue"))&&!f){selectedIdsStr=selectionCacheMgr.getAttribute("cachedValue");selectionCacheMgr.innerText=selectedIdsStr;var c=selectedIdsStr.split(";"),i=c.length;selectedIdsStr="";unverifiedSelectionIdsCount=0;verifiedSelectionIdsCount=0;for(var a=0;a<i;a++){var d=parseInt(c[a]),e=false,b;if(isNaN(d))continue;for(b=0;b<ids.length;b++)if(ids[b]==d){if(!NextSelectionOverLimit(1)){imglibItems[ids[b]].fSelected=true;verifiedSelectionIdsCount++;UIChange(d,true)}e=true;break}if(!e&&!fSelectedView)if(!NextSelectionOverLimit(1)){if(selectedIdsStr=="")selectedIdsStr=c[a];else selectedIdsStr+=";"+c[a];unverifiedSelectionIdsCount++}}}var h=selectionCacheMgr.getAttribute("Reload");if(h=="1")fNeedReload=true}function InitSelection(){a:;if(Boolean(window.ActiveXObject))try{typeof selectionCacheMgr.load!="undefined"&&selectionCacheMgr.load("OISSelectionStore")}catch(c){if(!fInitAttempted){fInitAttempted=true;setTimeout("InitSelection()",500)}return}else return;fInitSelection=true;if(!fInitViewStyle){fInitViewStyle=true;var a="thumbnail";if(Boolean(selectionCacheMgr.getAttribute("viewStyle"))){a=selectionCacheMgr.getAttribute("viewStyle");if(a!="list"&&a!="filmstrip")a="thumbnail";if(fFilterOn||fIsInGroupByView)a="list"}if(!fWebFldrView)if(!fRecursive){SwitchViewStyle(a);a=="filmstrip"&&ClickFrame(currentPicture)}else currentViewStyle=a;else currentViewStyle=a}LoadSelection();var b=fNeedReload;fNeedReload=false;SaveSelection();b&&window.location.reload(true);ConstructSelectionHref();return}function ClearSelections(){a:;if(!fInitSelection)return;selectedIdsStr="";for(var a=0;a<ids.length;a++){imglibItems[ids[a]].fSelected=false;UIChange(ids[a],false)}SaveSelection();ConstructSelectionHref()}function GetSelectionCount(){a:;for(var b=0,a=0;a<ids.length;a++)if(imglibItems[ids[a]].fSelected==true)b++;return b}function MakeSelectionStr(){a:;var b=selectedIdsStr,a;fAllSelected=true;for(a=0;a<ids.length;a++)if(imglibItems[ids[a]].fSelected==true)if(b=="")b=""+ids[a];else b+=";"+ids[a];else if(imglibItems[ids[a]].objType==0)fAllSelected=false;return b}var expirationInMilSeconds;function SaveSelection(){a:;if(browseris.ie5up&&browseris.win&&fInitSelection){selectionCacheMgr.setAttribute("cachedValue",MakeSelectionStr());selectionCacheMgr.setAttribute("viewStyle",currentViewStyle);selectionCacheMgr.setAttribute("listGuid",vCurrentListID);if(fEditingInProcess)selectionCacheMgr.setAttribute("Reload","1");else selectionCacheMgr.setAttribute("Reload","0");var a=new Date;a.setTime(a.getTime()+expirationInMilSeconds);var b=a.toUTCString();selectionCacheMgr.expires=b;typeof selectionCacheMgr.save!="undefined"&&selectionCacheMgr.save("OISSelectionStore")}return}function RemoveQueryParameterFromUrlImgLib(a,c){a:;var d=new RegExp("[&?]"+c+"=[^&]*","");a=a.replace(d,"");if(a.indexOf("?")==-1){var b=a.indexOf("&");if(b!=-1)a=a.substring(0,b)+"?"+a.substring(b+1)}return a}function CreateRootFolderHref(b){a:;if(b==null||imglibItems[b]==null)return"";if(imglibItems[b].objType!=1)return"";var a=window.location.href;if(!ctx.recursiveView){var c="RootFolder="+escapeProperly(unescapeProperly(imglibItems[b].originalImg));if(-1==a.indexOf("?"))a=a+"?"+c;else if(Boolean(a.match(/RootFolder=/)))a=a.replace(/RootFolder=[^&]*/,c);else a=a+"&"+c}a=a.replace(/&p_\w+=[^&]*/g,"");a=a.replace(/&PageFirstRow=[^&]*/,"");a=RemoveQueryParameterFromUrlImgLib(a,"View");a=a.replace(/\?Paged=TRUE&/,"?");a=STSHtmlEncode(a);return-1==a.indexOf("?")?a+"?View="+currentViewGuid:a+"&amp;View="+currentViewGuid}function DisplayItemUrl(b){if(b==null||imglibItems[b]==null)return"";if(imglibItems[b].objType==1)return CreateRootFolderHref(b);else if(imglibItems[b].fUnknownImageType==true)return imglibItems[b].originalImg;else{var c="";if(urlCmdForDisplay==null)return;c=urlCmdForDisplay+"&ID="+b.toString();c+="&Source="+GetSource();var d=document.getElementById("title"+b.toString());if(d!=null){var a=GetAttributeFromItemTable(d.parentNode.parentNode,"DRef","FileDirRef");if(a!=null&&a!=""){if(a.charAt(0)!="/")a="/"+a;a=escapeProperly(a);c=c.replace(/RootFolder=[^&]*&/,"");c=c+"&RootFolder="+a}}return c}}function CallDisplayItem(a){if(a==null||imglibItems[a]==null)return;window.location.href=DisplayItemUrl(a)}function DisplayItemOnFileRef(a){a:;if(!browseris.ie5up||!browseris.win){CallDisplayItem(a);return false}event.cancelBubble=true;if(browseris.ie55up){CallDisplayItem(a);return false}else{CallDisplayItem(a);return true}}function CallEditItem(e){var b="";if(urlCmdForDisplay==null)return;b=urlCmdForDisplay+"&ID="+e.toString();b+="&Source="+GetSource();var d=document.getElementById("title"+e.toString());if(d!=null){var a=GetAttributeFromItemTable(d.parentNode.parentNode,"DRef","FileDirRef");if(a!=null&&a!=""){if(a.charAt(0)!="/")a="/"+a;a=escapeProperly(a);b=b.replace(/RootFolder=[^&]*&/,"");b=b+"&RootFolder="+a}}var c=b.replace(/dispform\.aspx/i,"EditForm.aspx");if(c!="")window.location.href=c}function _DeleteImages(){a:;if(tbPreview==null){alert(Strings.STS.L_NotAvailableOnWebPart_Text);return}if(!fImglibDefautlView){alert(Strings.STS.L_NotOurView_Text);return}var d=MakeSelectionStr();if(d==""){alert(Strings.STS.L_NoImageSelected_Text);return}if(GetLayoutUrl()=="")return;var b=false;if(GetSelectionCount()>1){if(confirm(ctx.RecycleBinEnabled?Strings.STS.L_RecycleMultipleItems_Text:Strings.STS.L_DeleteMultipleItems_Text))b=true}else if(confirm(ctx.RecycleBinEnabled?Strings.STS.L_RecycleSingleItem_Text:Strings.STS.L_DeleteSingleItem_Text))b=true;if(b){var c=GetLayoutUrl()+"DeleteMu.aspx";c+="?List="+vCurrentListID+"&SelectedIds="+MakeSelectionStr()+"&Source="+GetSource();if(typeof MSOWebPartPageFormName!="undefined"){var a=document.forms[MSOWebPartPageFormName];if(null!=a){ClearSelections();a.action=c;a.method="POST";a.submit()}}}}function GetUint(b){var a=parseInt(b.replace(/,/g,""));return a>0?a:0}function GetScaleRatio(g,f,e,d){a:;var b=e*1/g,c=d*1/f,a=b>c?c:b;if(a>1)a=1;return a}function GetHeight(d,a,e,c){a:;if(d==0||a==0)return c;var b=a*GetScaleRatio(d,a,e,c);return b<1?1:b}function GetWidth(a,d,e,c){a:;if(a==0||d==0)return c;var b=a*GetScaleRatio(a,d,e,c);return b<1?1:b}function UIChangeList(a,c){a:;if(a<0||imglibItems[a]==null)return;if(imglibItems[a].objType!=0)return;var d=document.getElementById("cbx_"+a.toString());if(d!=null)d.checked=c;if(!browseris.ie5up||!browseris.win)return;var b=document.getElementById("row"+a.toString());if(b!=null)if(c==true)b.className="ms-imglibselectedrow s4-itm-selected";else b.className=""}function MouseOverRow(a){a:;if(tbPreview==null)return;if(FILIsMenuShown()==1)return;if(timedItem!=a){previewTimer>=0&&clearTimeout(previewTimer);previewTimer=setTimeout("HiLiteRow("+a.toString()+")",200);timedItem=a}}function MouseOutRow(a){a:;if(tbPreview==null)return;if(FILIsMenuShown()==1)return;if(previewTimer>=0&&timedItem==a){clearTimeout(previewTimer);previewTimer=-1;timedItem=-1}}function HiLiteRow(a){a:;if(!fImglibDefautlView)return;if(fInit==false){InitItems();fInit=true}if(a<0||imglibItems[a]==null)return;if(tbPreview==null)return;previewedId=a;if(Boolean(tbImg)){tbImg.src=EncodedThumbnailImage(a);if(imglibItems[a].alt==null||imglibItems[a].alt=="")tbImg.alt=picturePreviewAlt;else tbImg.alt=imglibItems[a].alt;tbImg.width=String(GetWidth(imglibItems[a].imgWidth,imglibItems[a].imgHeight,120,90));tbImg.height=String(GetHeight(imglibItems[a].imgWidth,imglibItems[a].imgHeight,120,90))}if(Boolean(tbTitle))tbTitle.innerHTML=imglibItems[a].caption;if(!browseris.ie5up||!browseris.win)return;var b=document.getElementById("title"+a.toString());if(b!=null){if(hilitedRow==b)return;else if(hilitedRow!=null){hilitedRow.children[1].style.visibility="hidden";hilitedRow.parentNode.parentNode.className="ms-unselectedtitle"}hilitedRow=b;b.children[1].className="ms-menuimagecell";b.children[1].style.visibility="visible";b.parentNode.parentNode.className="ms-selectedtitle"}}function ClickRow(a){a:;if(!fImglibDefautlView)return;if(tbPreview==null)return;if(a<0||imglibItems[a]==null)return;if(browseris.ie){if(event==null)event=window.event;if(event!=null)event.cancelBubble=true}HiLiteRow(a);ILShowMenu(a)}function ContextMenuOnRow(a){a:;if(!browseris.ie55up||!browseris.win)return true;if(event.srcElement.tagName=="A")return true;ClickRow(a);return false}function FILIsMenuShown(){a:;if(!browseris.ie5up||!browseris.win)return false;if(lastMenuId=="")return 0;var b=document.getElementById(lastMenuId);if(b!=null){var a=false;if(Boolean(window.ActiveXObject))try{if(typeof b.isOpen!="undefined")a=b.isOpen()}catch(c){}if(!a)lastMenuId="";return a}return 0}function ILShowMenu(a){a:;if(!browseris.ie5up||!browseris.win)return;if(!browseris.ie55up){CallEditItem(a);return}var d="plmenu_"+a.toString(),c=document.getElementById(d);if(c==null)c=CMenu(d);else c.innerHTML="";currentItemID=a.toString();currentItemFileUrl=imglibItems[a].originalImg;currentItemFSObjType=imglibItems[a].objType;currentItemPermMaskH=null;var b=document.getElementById("title"+a.toString());if(b!=null){if(typeof b.COUId!="undefined")currentItemCheckedOutUserId=b.COUId;itemTable=b.parentNode.parentNode;if(imglibItems[a].fUnknownImageType==false)itemTable.IsImage="1";else if(imglibItems[a].objType!=1)itemTable.IsImage=""}CtxSetIsWebEditorPreview(0);AddDocLibMenuItems(c,ctx);lastMenuId=d;if(b!=null)OMenu(c,b.parentNode.parentNode,undefined,undefined,Number(undefined));else OMenu(c,window.event.srcElement.parentNode,undefined,undefined,Number(undefined))}function InitItems(){a:;tbImg=document.getElementById("ImgPreviewThumbnail");if(tbImg!=null)picturePreviewAlt=tbImg.alt;if(browseris.ie){tbPreview=document.getElementById("ImgPreviewTable");tbTitle=document.getElementById("lnkPreviewTitle")}else{if(browseris.nav6up){tbPreview=document.getElementById("ImgPreviewTable");if(tbPreview!=null)tbPreview.style.display="block"}tbTitle=document.anchors.lnkPreviewTitle}}function AddSelectAllCheckbox(){a:;var a=document.getElementById("diidHeaderImageSelectedFlag");if(a==null)return;var b=null;if(browseris.nav6up)b=a.parentNode;else b=a.parentNode;if(b==null||b.tagName.toLowerCase()!="th")return;if(firstIdWithCheckbox==-1)b.innerHTML="";else{b.innerHTML="<a href='Javascript:ToggleSelectionAll()' onclick='ToggleSelectionAll();return false;'><img style='border:0' src='"+ctx.imagesPath+"unchecka.gif' id='cbxSelectAll' alt='"+Strings.STS.L_SelectAll_Text+"' /></a>";var c=document.getElementsByName("selectionCheckBox");if(c==null)return;for(var d=0;d<c.length;d++){a=c[d];if(a!=null){a.disabled=false;a.style.visibility="visible";if(browseris.ie){a.parentNode.width="30";a.style.height="18"}}}}}function ClickPreview(){a:;CallDisplayItem(previewedId)}function ClickThumbnail(a){a:;CallDisplayItem(a)}function UIChangeThumbnail(a,b){a:;if(imglibItems[a]==null||imglibItems[a].objType!=0)return;var d=document.getElementById("tb_"+String(a));if(null==d)return;var c=document.getElementById("cbxTB_"+String(a));if(c!=null)c.checked=b;var e=d.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;if(b)CoreInvoke("AddCssClassToElement",e,"ms-imglibthumbnail-selected");else CoreInvoke("RemoveCssClassFromElement",e,"ms-imglibthumbnail-selected")}function CreateTile(b){a:;var c=listInfo.thumbnailSize+10,a="";if(!browseris.ie)return;else{if(FV4UI())a+="<div class='thumbnail'>";else a+="<span class='thumbnail'>";a+="<table style='display:inline;'><tr height='"+(2+c).toString()+"'><td  width='"+c.toString()+"' class='ms-imglibthumbnail' align='center'>";a+="<table border='0' cellspacing='2' cellpadding='0' class='ms-imglibthumbnail'><tr height='"+(listInfo.thumbnailSize+4).toString()+"'><td width='"+(listInfo.thumbnailSize+4).toString()+"' align='center' verticalAlign='middle'>";a+="<a href='#' onclick='ClickThumbnail("+b+");return false;'><img class='thumbnail' height='"+GetHeight(imglibItems[b].imgWidth,imglibItems[b].imgHeight,listInfo.thumbnailSize,listInfo.thumbnailSize).toString()+"' id='tb_"+b+"' src='"+imglibItems[b].thumbnail+"' style='border:0' alt='";if(imglibItems[b].alt!="")a+=STSHtmlEncode(imglibItems[b].alt);else if(imglibItems[b].objType!=0)a+=Strings.STS.L_FolderAlt_Text;else if(imglibItems[b].fUnknownImageType==true)a+=Strings.STS.L_DocumentAlt_Text;else a+=Strings.STS.L_ImgAlt_Text;a+="'></img></a>";a+="</td></tr></table>";a+="</td></tr><tr height='0'><td valign='top' nowrap='nowrap'";if(browseris.ie55up)a+=">";else a+=" dir="+listDirection+">";if(imglibItems[b].objType!=1)a+="<input type='checkbox' id='cbxTB_"+b+"' onclick='ToggleSelection("+b+")'>";else a+="&nbsp";a+="<span style='width:"+(listInfo.thumbnailSize-20).toString()+"px;display:inline-block;text-wrapping:nowrap;overflow:hidden;text-overflow:ellipsis'><label for='cbxTB_"+b.toString()+"'>"+imglibItems[b].caption+"</label></span>";a+="</td></tr></table>";if(FV4UI())a+="</div>";else a+="</span>";a+="\n";document.write(a)}}function UIChangeFilmstrip(d,c){a:;for(var a=currentPicture;a<currentPicture+stripSize;a++)if(ids[a]==d)break;if(a>=currentPicture+stripSize)return;var b=document.getElementById("cbxFS_"+(a-currentPicture).toString());if(b!=null&&b.tagName.toLowerCase()=="input")b.checked=c}function LoadNextPicture(h){a:;event.cancelBubble=true;if(ids.length<=stripSize)return;var a=null;if(currentStrip>=0&&currentStrip<stripSize){a=document.getElementById("fstb"+currentStrip.toString());if(a!=null)a.parentNode.className="ms-imglibthumbnail"}if(h==1){if(currentPicture+stripSize>=ids.length)return;currentPicture=currentPicture+1;currentStrip=currentStrip-1}else{if(currentPicture<=0)return;currentPicture=currentPicture-1;currentStrip=currentStrip+1}for(var d=0;d<stripSize;d++){var b=ids[currentPicture+d];a=document.getElementById("fstb"+d.toString());if(a!=null){a.src=EncodedThumbnailImage(b);a.height=String(GetHeight(imglibItems[b].imgWidth,imglibItems[b].imgHeight,96,96));a.width=String(GetWidth(imglibItems[b].imgWidth,imglibItems[b].imgHeight,96,96));if(imglibItems[b].alt!="")a.alt=imglibItems[b].alt;else if(imglibItems[b].objType!=0)a.alt=Strings.STS.L_FolderAlt_Text;else if(imglibItems[b].fUnknownImageType==true)a.alt=Strings.STS.L_DocumentAlt_Text;else a.alt=Strings.STS.L_ImgAlt_Text}var c=document.getElementById("cbxFS_"+d.toString());if(c!=null&&c.tagName.toLowerCase()=="input")if(imglibItems[b].objType!=0){c.style.display="none";c.checked=false}else{c.style.display="inline";c.checked=imglibItems[b].fSelected}var f=document.getElementById("title_"+d.toString());if(f!=null)f.innerHTML=imglibItems[b].caption}var g,e;if(fRTL){g=ctx.imagesPath+"plslforw.gif";e=ctx.imagesPath+"plslback.gif"}else{g=ctx.imagesPath+"plslback.gif";e=ctx.imagesPath+"plslforw.gif"}if(currentPicture==0)document.getElementById("backgif").parentNode.parentNode.style.display="none";else document.getElementById("backgif").parentNode.parentNode.style.display="block";if(currentPicture+stripSize>=ids.length)document.getElementById("forwardgif").parentNode.parentNode.style.display="none";else document.getElementById("forwardgif").parentNode.parentNode.style.display="block";if(currentStrip>=0&&currentStrip<stripSize){a=document.getElementById("fstb"+currentStrip.toString());if(a!=null)a.parentNode.className="ms-imglibthumbnail-selected"}return false}function ClickFrame(f){a:;if(f<0||f>=stripSize)return false;var a=ids[currentPicture+f];previewedId=a;var c=null;if(currentStrip>=0&&currentStrip<stripSize){c=document.getElementById("fstb"+currentStrip.toString());if(c!=null)c.parentNode.className="ms-imglibthumbnail"}currentStrip=f;c=document.getElementById("fstb"+currentStrip.toString());if(c!=null){c.parentNode.className="ms-imglibthumbnail ms-imglibthumbnail-selected";c.focus()}var b=document.getElementById("CurrentPic");if(b!=null){var i=0;b.style.visibility="hidden";if(browseris.ie55up&&browseris.win&&imglibItems[a].objType!=1&&!imglibItems[a].fUnknownImageType){var e=document.getElementById("webImageSyncer");if(e!=null&&typeof e.imagedata!="undefined"&&e.imagedata!=null){e.imagedata.src=EncodedWebImage(a);i=1}}if(i==0){b.src=EncodedWebImage(a);b.alt=GetAltText(a)}else window.setTimeout("document.getElementById('CurrentPic').src = EncodedWebImage("+a.toString()+"); document.getElementById('CurrentPic').alt = GetAltText("+a.toString()+");",500);b.height=String(GetHeight(imglibItems[a].imgWidth,imglibItems[a].imgHeight,448,448));b.width=String(GetWidth(imglibItems[a].imgWidth,imglibItems[a].imgHeight,448,448))}var d=GetLinks("OriginalPicLink"),g=GetLinks("OpenItemLink");if(d!=null){if(imglibItems[a].objType==1){var h=CreateRootFolderHref(a);if(h!="")d.href=h;document.getElementById("descrRow").style.visibility="hidden";b.alt=Strings.STS.L_GotoFolder_Text}else{d.href=imglibItems[a].originalImg;document.getElementById("descrRow").style.visibility="visible";if(imglibItems[a].alt!="")b.alt=imglibItems[a].alt;else b.alt=Strings.STS.L_AltViewProperty_Text}d.href=DisplayItemUrl(a)}if(g!=null)g.href=DisplayItemUrl(a);document.getElementById("titleSpan").innerHTML=imglibItems[a].caption;document.getElementById("descrSpan").innerHTML=imglibItems[a].description;if(imglibItems[a].fUnknownImageType&&imglibItems[a].objType==0){b.style.display="none";document.getElementById("noPreviewSpan").style.display="block"}else{b.style.display="block";document.getElementById("noPreviewSpan").style.display="none"}return false}function ToggleSelectedItem(a){a:;if(a<0||a>=stripSize)return;currentPicture+a<ids.length&&ToggleSelection(ids[currentPicture+a])}function FilmstripTbKeyPressed(a){a:;if(event.keyCode!=13)return true;event.cancelBubble=true;ClickFrame(a);return false}function FilmstripKeyPressed(){a:;var a;if(event.keyCode==37)if(fRTL)a=1;else a=-1;else if(event.keyCode==39)if(fRTL)a=-1;else a=1;else return;if(currentStrip<0||currentStrip>=stripSize){if(a>0)ClickFrame(stripSize-1);else ClickFrame(0);return}var b=currentStrip+a;(b<0||b>=stripSize)&&LoadNextPicture(Number(a==1));b=currentStrip+a;if(b<0||b>=stripSize){if(a>0)ClickFrame(stripSize-1);else ClickFrame(0);return}ClickFrame(b)}function CreateStrip(){a:;var c,h=")' onkeydown='Javascript:FilmstripTbKeyPressed(",e=');\'><table style=\'cursor:hand\' width="108" border="0" cellspacing="0" cellpadding="0"><tr height="108"><td',f=' width="108" align="center" class="ms-imglibthumbnail"><img onclick=\'Javascript:ClickFrame(',l="); return false;'",g=" galleryimg='false' border=\"0\" alt='",i="' height=",j=" tabindex='0' id=fstb",m=" src='",n='\'></td><tr><td nowrap="nowrap"><input style=\'width:16\' type="checkbox" id=cbxFS_',o="><span style='overflow:hidden;text-overflow:ellipsis; width:90' id=title_",p="><label for=cbxFS_",k=">",q="</label></span></td></tr></table><td>",b,d=" style='display:none'";if(browseris.ie5up&&browseris.win)c="<td valign='top' onclick='ClickFrame(";else c="<td width='108' onclick='ClickFrame(";if(stripSize>ids.length)stripSize=ids.length;document.write("<table><tr>");for(var a=0;a<stripSize;a++){b=c+a.toString()+h+a.toString()+e;if(a==currentStrip)b+=" class='ms-imglibthumbnail-selected'";b+=f+a.toString()+l+a.toString()+g;if(imglibItems[ids[a]].alt!="")b+=STSHtmlEncode(imglibItems[ids[a]].alt);else if(imglibItems[ids[a]].objType==1)b+=Strings.STS.L_FolderAlt_Text;else if(imglibItems[ids[a]].fUnknownImageType==true)b+=Strings.STS.L_DocumentAlt_Text;else b+=Strings.STS.L_ImgAlt_Text;b+=i+GetHeight(imglibItems[ids[a]].imgWidth,imglibItems[ids[a]].imgHeight,96,96).toString()+j+a.toString()+m+imglibItems[ids[a]].thumbnail+n+a.toString();b+=" onclick=ToggleSelectedItem("+a.toString()+")";if(imglibItems[ids[a]].objType==1)b+=d;b+=o+a.toString()+p+a.toString()+k+imglibItems[ids[a]].caption+q;document.write(b)}document.write("</tr></table>")}function UIChange(b,a){a:;if(browseris.ie&&tbPreview!=null){UIChangeThumbnail(b,a);UIChangeFilmstrip(b,a)}UIChangeList(b,a)}function GenerateFooterContent(g,h){a:;if(g=="thumbnail"){if(browseris.ie){var c='<table id="contentthumbnail"';if(!h)c+=" style='display:none;'";c+=' border="0" cellspacing="0" cellpadding="3" width=\'100%\'><tr><td';if(browseris.ie55up)c+=" dir="+listDirection+">";else c+=" dir=ltr>";document.write(c);for(var f=0;f<ids.length;f++)CreateTile(ids[f]);document.write("</td></tr></table>")}}else if(g=="filmstrip"){if(currentPicture+stripSize>ids.length)currentPicture=ids.length-stripSize;if(currentPicture<0)currentPicture=0;currentStrip=0;var b=ids[currentPicture+currentStrip];previewedId=b;var a="<table id='contentfilmstrip' dir="+listDirection+" border='0' cellspacing='0' cellpadding='3' width='100%' onkeydown='Javascript:FilmstripKeyPressed()'";if(!h)a+="style='display:none'";a+="><tr>";var e,d,i="/blank.gif";if(fRTL){e="/forward.gif";d="/back.gif"}else{e="/back.gif";d="/forward.gif"}a+='<td valign="center" class="ms-imglibmenuarea" style=\'cursor:hand';if(currentPicture==0)a+="; display:none";a+="' onclick='Javascript:LoadNextPicture(0);'><a href='Javascript:LoadNextPicture(0)' onclick='Javascript:LoadNextPicture(0); return false;'><img id=\"backgif\" src='"+ctx.imagesPath+e+'\' border="0" alt="'+Strings.STS.L_PreviousPicture_Text+'" /></a></td>';a+='<td nowrap="nowrap" align="center" width="100%">';document.write(a);CreateStrip();a='</td><td valign="center" class="ms-imglibmenuarea" style=\'cursor:hand';if(currentPicture+stripSize>=ids.length)a+="; display:none";a+="' onclick='Javascript:LoadNextPicture(1);'><a href='Javascript:LoadNextPicture(1)' onclick='Javascript:LoadNextPicture(1); return false;'><img id=\"forwardgif\" src='"+ctx.imagesPath+d+'\' border="0" alt="'+Strings.STS.L_NextPicture_Text+'" /></a></td><tr>';a+='<tr><td align="center" colspan="3"><hr>';document.write(a);a='<table class="ms-descriptiontext"><tr height="336"><td valign="middle" align="center" width="448"><a id=\'OriginalPicLink\' name=\'OriginalPicLink\' href=\''+DisplayItemUrl(b)+"'>";a=a+"<img  onload='CurrentPic.style.visibility=\"visible\";' border=\"0\" tabindex='2' galleryimg='false' id='CurrentPic' name='CurrentPic' height="+GetHeight(imglibItems[b].imgWidth,imglibItems[b].imgHeight,448,448).toString();a=a+" src='"+imglibItems[b].webimage+"'";if(imglibItems[b].alt!="")a=a+"alt='"+STSHtmlEncode(imglibItems[b].alt)+"'";else if(imglibItems[b].objType==1)a=a+"alt='"+Strings.STS.L_GotoFolder_Text+"'";else a=a+"alt='"+Strings.STS.L_AltViewProperty_Text+"'";a=a+'align="center" border="2"/></a>';a=a+"<span id=\"noPreviewSpan\" style='display:none;font-size:150%'>"+Strings.STS.L_NoPreview_Text+"<br /><a id='OpenItemLink' name='OpenItemLink' href='"+DisplayItemUrl(b)+"'>"+Strings.STS.L_OpenItem_Text+"</a></span>";a=a+'</td></tr><tr><td><table><tr><td valign="top">'+Strings.STS.L_FileName_Text+': </td><td>&nbsp;</td><td width="300">';a=a+'<span id="titleSpan">'+imglibItems[b].caption+'</td></tr><tr id="descrRow"><td valign="top">';a=a+Strings.STS.L_Description_Text+': </td><td>&nbsp;</td><td width="300"><span id="descrSpan">'+imglibItems[b].description+"</span></td></tr></table></td></tr></table></td></tr></table>";document.write(a)}}function ViewHeaderScript(a,d,b,c){a:;if(a=="list"||a=="filmstrip")currentViewStyle=a;else currentViewStyle="thumbnail";listInfo=new CListInfo(d,b,c);InitViewUrls()}function ViewFooterScript(){a:;InitItems();if(!browseris.ie5up||!browseris.win){if(firstId!=-1){var b="HiLiteRow("+firstId.toString()+")";window.setTimeout(b,200)}if(fSelectFieldAppeared)tbPreview!=null&&AddSelectAllCheckbox();return}fInit=true;if(tbPreview!=null){listDirection=document.getElementById("selectionCacheMgr").parentNode.parentNode.parentNode.currentStyle.direction;if(listDirection!="rtl"&&listDirection!="RTL")listDirection="ltr";else{fRTL=true;var a=GetLinks("lnkPreviewTitle");if(a!=null)a.style.direction="RTL"}if(currentViewStyle=="thumbnail"){GenerateFooterContent("thumbnail",true);GenerateFooterContent("filmstrip",false);document.getElementById("selectionCacheMgr").parentNode.parentNode.style.display="none";document.getElementById("selectionCacheMgr").parentNode.parentNode.parentNode.style.display="none"}else if(currentViewStyle=="filmstrip"){GenerateFooterContent("thumbnail",false);GenerateFooterContent("filmstrip",true);document.getElementById("selectionCacheMgr").parentNode.parentNode.style.display="none";document.getElementById("selectionCacheMgr").parentNode.parentNode.parentNode.style.display="none"}else{GenerateFooterContent("thumbnail",false);GenerateFooterContent("filmstrip",false)}}if(firstId!=-1){HiLiteRow(firstId);if(tbPreview!=null)if(currentViewStyle=="list")tbPreview.style.display="block";else tbPreview.style.display="none";if(fSelectFieldAppeared)tbPreview!=null&&AddSelectAllCheckbox()}if(tbPreview!=null)if(browseris.verIEFull>=5.5&&browseris.iever<6&&browseris.win)setTimeout("InitSelection()",500);else browseris.ie5up&&browseris.win&&InitSelection()}function ViewPreBodyScript(a){a:;document.write("<tr id='row"+a+"'>")}function ViewPostBodyScript(){a:;document.write("</tr>")}var bTranState,slideshowInterval,slideshowIncremental,timerId,fAutoRun,fRepeat,fRetry,fRetryLimit;function LoadNextSlide(){a:;if(fNextImageLoaded==false&&fRetry<fRetryLimit){fRetry++;return}fRetry=0;if(currentPicture>=ids.length)if(!fRepeat)return;else currentPicture=0;var a=document.getElementById("thisPic");if(browseris.ie5up&&browseris.win)a.style.visibility="hidden";a.src=EncodedWebImage(ids[currentPicture]);a.alt=GetAltText(ids[currentPicture]);a.height=String(GetHeight(imglibItems[ids[currentPicture]].imgWidth,imglibItems[ids[currentPicture]].imgHeight,listInfo.webImageWidth,listInfo.webImageHeight));a.width=String(GetWidth(imglibItems[ids[currentPicture]].imgWidth,imglibItems[ids[currentPicture]].imgHeight,listInfo.webImageWidth,listInfo.webImageHeight));document.getElementById("tdCaption").innerHTML=imglibItems[ids[currentPicture]].caption+"<br />";document.getElementById("tdDesc").innerHTML=imglibItems[ids[currentPicture]].description+"<br />";document.getElementById("tdImgDate").innerHTML=imglibItems[ids[currentPicture]].createdDate+"<br />";currentPicture++;document.getElementById("currentCount").innerHTML=""+currentPicture.toString();if(currentPicture+1<ids.length){if(browseris.ie5up&&browseris.win)fNextImageLoaded=false;var b=document.getElementById("nextPic");b.src=EncodedWebImage(ids[currentPicture+1])}}function AutoRun(){a:;if(fAutoRun){LoadNextSlide();timerId=setTimeout("AutoRun()",slideshowInterval)}}function StartSlideShow(){a:;if(fAutoRun)return;fAutoRun=true;timerId=setTimeout("AutoRun()",slideshowInterval)}function StopSlideShow(){a:;PauseSlideShow();currentPicture=0;LoadNextSlide()}function PauseSlideShow(){a:;if(fAutoRun){if(timerId!=-1){clearTimeout(timerId);timerId=-1}fAutoRun=false}}function ToggleRepeat(){a:;fRepeat=!fRepeat}function NextSlide(){a:;if(browseris.ie)event.bubble=false;PauseSlideShow();if(currentPicture<ids.length)if(currentPicture>=0){fRetry=fRetryLimit;LoadNextSlide()}}function PreviousSlide(){a:;if(browseris.ie)event.bubble=false;PauseSlideShow();if(currentPicture>1){currentPicture--;currentPicture--;fRetry=fRetryLimit;LoadNextSlide()}}function HiliteButton(){a:;if(!browseris.ie)return;var b=event.srcElement,a=b.src;a=a.replace(/1.gif$/g,"2.gif");b.src=a}function DemoteButton(){a:;if(!browseris.ie)return;var b=event.srcElement,a=b.src;a=a.replace(/2.gif$/g,"1.gif");b.src=a}function ShowSlidePic(){a:;if(browseris.ie5up&&browseris.win){var a=document.getElementById("thisPic");if(a!=null)a.style.visibility="visible"}}function SortIds(){a:;var b=window.location.href,f=b.indexOf("?"),c="";if(f!=-1)c=b.substring(f+1,b.length);else return;var i=c.split("&"),g=c.match(/InstanceID=all&FilterName=ID&FilterMultiValue=([^&]*)/);if(g!=null)filterIdsStr=g[1];if(filterIdsStr==""||filterIdsStr==null)return;for(var a=[],h=filterIdsStr.split(";"),e=0,j=0;e<h.length;e++){var d=parseInt(h[e]);if(d>=0&&imglibItems[d]!=null)a[a.length]=d}ids=a;a=null}function SlideShowContent(){a:;if(ids.length==0)return;SortIds();if(currentPicture<0)currentPicture=0;if(currentPicture>=ids.length)currentPicture=ids.length-1;var a='<table cellspacing="0" cellpadding="0" valign="middle" align="center" width="100%" dir='+listDirection+' height="100%">';a+="<tr height="+listInfo.webImageHeight.toString()+">";a+='<td width="15">&nbsp;</td>';a+='<td id="cellImage" align="center" valign="middle" width='+listInfo.webImageWidth.toString()+">";a+="<img onload='ShowSlidePic();' id=\"thisPic\" galleryimg='false' src='"+imglibItems[ids[currentPicture]].webimage+"' alt='"+STSHtmlEncode(imglibItems[ids[currentPicture]].alt)+"' width="+GetWidth(imglibItems[ids[currentPicture]].imgWidth,imglibItems[ids[currentPicture]].imgHeight,listInfo.webImageWidth,listInfo.webImageHeight).toString()+" height="+GetHeight(imglibItems[ids[currentPicture]].imgWidth,imglibItems[ids[currentPicture]].imgHeight,listInfo.webImageWidth,listInfo.webImageHeight).toString()+">";var c="<img id=nextPic style='position:absolute;visibility:hidden' width=10 height=10";if(currentPicture+1<ids.length){c+=" src='"+imglibItems[ids[currentPicture+1]].webimage+"'";c+=" onload='fNextImageLoaded=true;'"}c+=" >";a+=c;a+="</td>";a+='<td width="15">&nbsp;</td><td valign="top"><table class="ms-formdescription" cellspacing="2">';a+='<tr height="40"><td>'+Strings.STS.L_Picture_Of_Text.replace(/{(0)}/,'<a id="currentCount">1</a>').replace(/{(1)}/,ids.length.toString())+"</td></tr>";a+='<tr id="controlRow"><td>';var f="",d="",e="";if(fRTL){f="plnext1.gif";d="plprev1.gif";e="plplayr1.gif"}else{f="plprev1.gif";d="plnext1.gif";e="plplay1.gif"}var b="<img border=0 height=23 style='position:relative;cursor:hand' onmouseover='HiliteButton()' onmouseout='DemoteButton()' src='"+ctx.imagesPath,i="<a onclick='StartSlideShow(); return false;' href='javascript:StartSlideShow()'>"+b+e+"' id=playButton alt='"+Strings.STS.L_SlideShowPlayButton_Text+"'></a> ",g="<a onclick='PauseSlideShow(); return false;' href='javascript:StartSlideShow()'>"+b+"plpause1.gif' alt='"+Strings.STS.L_SlideShowPauseButton_Text+"'></a> ",k="<a onclick='StopSlideShow(); return false;' href='javascript:StopSlideShow()'>"+b+"plstop1.gif' id=stopButton alt='"+Strings.STS.L_SlideShowStopButton_Text+"'></a> ",j="<a onclick='PreviousSlide(); return false;' href='javascript:PreviousSlide()'>"+b+f+"' alt='"+Strings.STS.L_SlideShowPrevButton_Text+"'></a> ",h="<a onclick='NextSlide(); return false;' href='javascript:NextSlide()'>"+b+d+"' alt='"+Strings.STS.L_SlideShowNextButton_Text+"'></a>";if(fRTL)a+=j+h+k+g+i;else a+=i+g+k+j+h;a+="<hr /></td></tr>";a+="<tr><td><b>"+Strings.STS.L_FileName_Text+':&nbsp;</b></td></tr><tr><td id="tdCaption" width="75%">'+imglibItems[ids[currentPicture]].caption+"<br /></td></tr>";a+="<tr><td><b>"+Strings.STS.L_ImageCreateDate_Text+':&nbsp;</b></td></tr><tr><td id="tdImgDate">'+imglibItems[ids[currentPicture]].createdDate+"<br /></td></tr>";a+="<tr><td><b>"+Strings.STS.L_Description_Text+':&nbsp;</b></td></tr><tr><td id="tdDesc">'+imglibItems[ids[currentPicture]].description+"<br /></td></tr>";if(ids.length>1)currentPicture++;a+="</table></td>";a+="</tr></table>";document.write(a)}function RecursiveViewHeaderScript(a,d,b,c){a:;fRecursive=true;listInfo=new CListInfo(d,b,c);if(a=="details"){currentRecursiveViewStyle=a;document.write("<table style='display:none'>")}else{currentRecursiveViewStyle="slideshow";document.write("<table>")}}function RecursiveViewFooterScript(){a:;if(!browseris.ie5up||!browseris.win)return;listDirection=document.getElementById("selectionCacheMgr").parentNode.parentNode.parentNode.currentStyle.direction;if(listDirection!="rtl"&&listDirection!="RTL")listDirection="ltr";else fRTL=true;if(browseris.verIEFull>=5.5&&browseris.iever<6&&browseris.win)setTimeout("InitSelection()",500);else browseris.ie5up&&browseris.win&&InitSelection()}function CItem(b,m,a,d,k,i,l,f,h,e,j){this.baseName=a;this.title=l;this.originalImg=b;this.imgWidth=GetUint(k);this.imgHeight=GetUint(i);this.id=m;this.fSelected=false;this.fNewItem=j;this.description=STSHtmlEncode(f);this.description=this.description.replace(/\r?\n/g,"<br>\n");this.alt=f;this.objType=h;this.fUnknownImageType=true;this.iconUrl=e;this.caption=a;if(h==1){if(""!=d)this.caption+="."+d;this.thumbnail=this.webimage=ctx.imagesPath+"/fldrnew.gif";this.imgWidth=this.imgHeight=37;return}if(b=="")return;var g=b.lastIndexOf("/");if(g<=0)return;var c=b.substring(0,g+1);c=escapeProperlyCore(c,true);if(this.imgWidth>0&&this.imgHeight>0){a=escapeProperly(a);this.thumbnail=c+"_t/"+a+"_"+d+".jpg";this.webimage=c+"_w/"+a+"_"+d+".jpg";this.fUnknownImageType=false}else{this.thumbnail=this.webimage=e.indexOf("/")==0?e:ctx.imagesPath+"/"+e;this.imgWidth=this.imgHeight=32}}function InsertItem(b,a,i,h,f,d,j,c,g,k,e){a:;if(b=="")return;imglibItems[a]=new CItem(b,a,i,h,f,d,j,c,g,k,e);if(firstId==-1)firstId=a;ids[ids.length]=a}function TryLaunchPictureLibrary(c,a,d){a:;vCurrentListID=c;vCurrentListUrlAsHTML=a;vCurrentWebUrl=d;var b=StartOIS('ois.exe /upload "'+a+'"');if(!b)return false;GotoInfoPage("uploading");return true}function ViewSlideShow(h,e,d){a:;var a=h+"slidshow.aspx?ViewStyle=slideshow",b=GetUrlKeyValue("RootFolder",true);if(b!="")a+="&RootFolder="+b;var g=240+e,f=160+d,c=window.open(a,"slideshow","height="+f.toString()+",width="+g.toString()+",toolbar=no,menubar=no,scrollbars=no");c!=null&&c.focus()}$_global_imglib();