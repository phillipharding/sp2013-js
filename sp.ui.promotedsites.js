Type.registerNamespace("SP.UI.PromotedSitesList");SP.UI.PromotedSitesList.EditLinkDialog=function(a,b){this.$$d_$U_0=Function.createDelegate(this,this.$U_0);this.$$d_$V_0=Function.createDelegate(this,this.$V_0);this.$$d_$Q_0=Function.createDelegate(this,this.$Q_0);this.$$d_$X_0=Function.createDelegate(this,this.$X_0);this.$$d_$W_0=Function.createDelegate(this,this.$W_0);this.$$d_$Y_0=Function.createDelegate(this,this.$Y_0);this.$0_0=a;this.$6_0=b};SP.UI.PromotedSitesList.EditLinkDialog.$B=function(i,g,j,k,h,l){var c=document.createElement("tr"),a=document.createElement("h3");a.id=SP.UI.PromotedSitesList.EditLinkDialog.$H("label"+h);a.className="ms-standardheader";a.innerHTML=STSHtmlEncode(g);var d=document.createElement("td");d.className="ms-formlabel ms-contentFollowing-promoSiteFormLabel";d.appendChild(a);if(l){var b=document.createElement("span");b.className="ms-formvalidation";b.title=Strings.STS.L_RequiredField_Tooltip;b.innerHTML=" *";a.appendChild(b)}var e=document.createElement("td");e.className="ms-formbody ms-contentFollowing-promoSiteFormInput";var f=SP.UI.PromotedSitesList.EditLinkDialog.$P(g,k,j,"text"+h);e.appendChild(f);c.appendChild(d);c.appendChild(e);i.appendChild(c);return f};SP.UI.PromotedSitesList.EditLinkDialog.$P=function(b,c,d,e){var a=document.createElement("input");a.id=SP.UI.PromotedSitesList.EditLinkDialog.$H(e);a.title=b;a.type="text";a.setAttribute("maxLength",c);a.value=d;a.className="ms-contentFollowing-promoSiteFormInput";return a};SP.UI.PromotedSitesList.EditLinkDialog.$G=function(b,c){var a=document.createElement("input");a.className="ms-ButtonHeightWidth";a.id=SP.UI.PromotedSitesList.EditLinkDialog.$H(c);a.type="button";a.value=b;return a};SP.UI.PromotedSitesList.EditLinkDialog.$H=function(a){return"editDialog_"+a};SP.UI.PromotedSitesList.EditLinkDialog.$L=function(d){var b=true,c=new URI(d),a=c.getScheme();if(!SP.ScriptUtility.isNullOrEmptyString(a))a=a.toLowerCase();if(a!=="http"&&a!=="https")b=false;else if(SP.ScriptUtility.isNullOrEmptyString(c.getHost()))b=false;return b};SP.UI.PromotedSitesList.EditLinkDialog.prototype={$0_0:null,$6_0:false,$D_0:false,$4_0:null,$5_0:null,$E_0:null,$3_0:null,$C_0:null,$2_0:null,$F_0:null,get_$9_0:function(){return this.$D_0},set_$9_0:function(a){if(this.$D_0!==a){this.$D_0=a;this.$I_0()}return a},$K_0:function(){var a=new SP.UI.DialogOptions;a.title=this.$6_0?Strings.STS.L_PromoSites_EditDialogTitle:Strings.STS.L_PromoSites_NewDialogTitle;a.autoSize=true;a.html=this.$O_0();this.$I_0();SP.UI.ModalDialog.showModalDialog(a);this.$4_0.focus()},$O_0:function(){var b=document.createElement("div");b.className="ms-core-form";var c="",d="http://",e="",f="http://";if(this.$6_0){c=STSHtmlDecode(this.$0_0.Title);d=this.$0_0.LinkLocation;e=STSHtmlDecode(this.$0_0.Description);f=this.$0_0.BackgroundImageLocation}var g=document.createElement("table"),a=document.createElement("tbody");this.$4_0=SP.UI.PromotedSitesList.EditLinkDialog.$B(a,Strings.STS.L_PromoSites_TitleField,c,50,"Title",true);this.$5_0=SP.UI.PromotedSitesList.EditLinkDialog.$B(a,Strings.STS.L_PromoSites_URLField,d,250,"Url",true);this.$E_0=SP.UI.PromotedSitesList.EditLinkDialog.$B(a,Strings.STS.L_PromoSites_DescriptionField,e,100,"Description",false);this.$3_0=SP.UI.PromotedSitesList.EditLinkDialog.$B(a,Strings.STS.L_PromoSites_ImageURLField,f,250,"ImageUrl",false);g.appendChild(a);$addHandler(this.$4_0,"keyup",this.$$d_$Y_0);$addHandler(this.$4_0,"change",this.$$d_$Y_0);$addHandler(this.$5_0,"keyup",this.$$d_$Y_0);$addHandler(this.$5_0,"change",this.$$d_$Y_0);$addHandler(this.$3_0,"keyup",this.$$d_$Y_0);$addHandler(this.$3_0,"change",this.$$d_$Y_0);var h=this.$N_0();b.appendChild(a);b.appendChild(h);return b},$N_0:function(){var a=document.createElement("div");a.className="ms-core-form-bottomButtonBox";this.$C_0=SP.UI.PromotedSitesList.EditLinkDialog.$G(Strings.STS.L_PromoSites_DeleteButton,"buttonDelete");this.$2_0=SP.UI.PromotedSitesList.EditLinkDialog.$G(Strings.STS.L_PromoSites_SaveButton,"buttonSave");this.$F_0=SP.UI.PromotedSitesList.EditLinkDialog.$G(Strings.STS.L_PromoSites_CancelButton,"buttonCancel");this.$6_0&&a.appendChild(this.$C_0);a.appendChild(this.$2_0);a.appendChild(this.$F_0);$addHandler(this.$C_0,"click",this.$$d_$W_0);$addHandler(this.$2_0,"click",this.$$d_$X_0);$addHandler(this.$F_0,"click",this.$$d_$Q_0);return a},$Q_0:function(a){a.preventDefault();a.stopPropagation();SP.UI.ModalDialog.commonModalDialogClose(0,null)},$W_0:function(){if(confirm(Strings.STS.L_PromoSites_DeleteConfirmation))if(!this.get_$9_0()){var a=SP.ClientContext.get_current();Microsoft.SharePoint.Portal.UserProfiles.PromotedSites.deleteSiteLink(a,this.$0_0.ID);a.executeQueryAsync(this.$$d_$V_0,this.$$d_$U_0);this.set_$9_0(true)}},$X_0:function(){if(!this.get_$9_0()){var b=SP.ClientContext.get_current(),a=this.$3_0.value;if(a==="http://")a="";if(this.$6_0)Microsoft.SharePoint.Portal.UserProfiles.PromotedSites.updateSiteLink(b,this.$0_0.ID,this.$5_0.value,this.$4_0.value,this.$E_0.value,a);else Microsoft.SharePoint.Portal.UserProfiles.PromotedSites.addSiteLink(b,this.$5_0.value,this.$4_0.value,this.$E_0.value,a);b.executeQueryAsync(this.$$d_$V_0,this.$$d_$U_0);this.set_$9_0(true)}},$Y_0:function(){this.$I_0()},$V_0:function(){SP.UI.ModalDialog.RefreshPage(1)},$U_0:function(b,a){alert(a.get_message());this.set_$9_0(false)},$I_0:function(){var a=this.$D_0;this.$E_0.disabled=a;this.$3_0.disabled=a;this.$4_0.disabled=a;this.$5_0.disabled=a;this.$C_0.disabled=a;this.$2_0.disabled=a||!SP.UI.PromotedSitesList.EditLinkDialog.$L(this.$5_0.value)||!this.$4_0.value.trim().length;if(this.$3_0.value.trim().length>0&&this.$3_0.value!=="http://"&&!SP.UI.PromotedSitesList.EditLinkDialog.$L(this.$3_0.value))this.$2_0.disabled=true;if(!this.$6_0&&!this.$2_0.disabled)this.$2_0.className="ms-button-emphasize";else this.$2_0.className=""}};SP.UI.PromotedSitesList.GlobalTemplateOverrides=function(){};SP.UI.PromotedSitesList.GlobalTemplateOverrides.$$cctor=function(){var a=new SP.UI.PromotedSitesList.PromotedSitesTileViewRenderer(170,0);SPClientTemplates.TemplateManager.RegisterTemplateOverrides(a.createRenderingContextOverrides())};SP.UI.PromotedSitesList.PromotedSitesTileViewRenderer=function(a,b){this.$$d_$S_2=Function.createDelegate(this,this.$S_2);this.$$d_$T_2=Function.createDelegate(this,this.$T_2);SP.UI.PromotedSitesList.PromotedSitesTileViewRenderer.initializeBase(this,[a,b])};SP.UI.PromotedSitesList.PromotedSitesTileViewRenderer.prototype={$8_2:null,$1_2:false,$A_2:false,get_$7_2:function(){return this.$1_2},set_$7_2:function(a){if(this.$1_2!==a){this.$1_2=a;if(this.$8_2){var b={};b[this.get_$J_2()]=a?"1":"0";var c=window.self.ajaxNavigate;c.update(null,b)}}return a},get_$J_2:function(){return"IsEditing_"+this.$8_2.wpq},createTileRenderer:function(a,b,c,d,e){return new SP.UI.PromotedSitesList.PromotedSitesTileRenderer(a,b,c,d,e,this.get_$7_2())},onPostRender:function(a){var c=$get("promotedSitesAdminMode_"+a.wpq);!SP.ScriptHelpers.isNullOrUndefined(c)&&$addHandler(c,"click",this.$$d_$T_2);if(this.get_$7_2()){var d=$get("promotedSitesAddLink_"+a.wpq);!SP.ScriptHelpers.isNullOrUndefined(d)&&$addHandler(d,"click",this.$$d_$S_2);for(var e=a.ListData.Row,h=e.length,b=0;b<h;b++){var f=e[b],i=SP.UI.TileView.TileRenderer.tileElementId(a,f.ID,3),g=$get(i);if(!SP.ScriptHelpers.isNullOrUndefined(g)){var j=new SP.UI.PromotedSitesList.PromotedSitesTileViewRenderer.TileClickHandler(f);j.attach(g)}}}SP.UI.PromotedLinks.PromotedLinksTileViewRenderer.prototype.onPostRender.call(this,a)},renderBodyContent:function(b,a){a.addCssClass("ms-contentFollowing-promoSiteRootContainer");a.renderBeginTag("div");if(this.get_$7_2()){a.addAttribute("id","promotedSitesAddLink_"+b.wpq);a.addAttribute("href","javascript:;");a.addCssClass("ms-floatLeft");a.addCssClass("ms-contentFollowing-newPromoSite");a.renderBeginTag("a");a.addCssClass("ms-textLarge");a.renderBeginTag("span");a.writeEncoded(Strings.STS.L_PromoSites_NewLinkCommand);a.renderEndTag();a.renderEndTag();if(!this.$A_2){a.addCssClass("ms-contentFollowing-promoSiteTilesContainer");a.renderBeginTag("div");SP.UI.PromotedLinks.PromotedLinksTileViewRenderer.prototype.renderBodyContent.call(this,b,a);a.renderEndTag()}}else if(!this.$A_2){a.addAttribute("style","margin-left:-3px;");a.renderBeginTag("div");SP.UI.PromotedLinks.PromotedLinksTileViewRenderer.prototype.renderBodyContent.call(this,b,a);a.renderEndTag()}a.addCssClass("ms-clear");a.renderBeginTag("div");a.renderEndTag();a.renderEndTag()},renderHeaderContent:function(b,a){this.$8_2=b;var c=this.$8_2.ListData.Row;this.$A_2=!SP.ScriptHelpers.isNullOrUndefined(c)&&!c.length;var d=b.IsProfileAdmin;if(this.$A_2)this.set_$7_2(true);else{var e=window.self.ajaxNavigate,f=e.getParam(this.get_$J_2());if(f==="1")this.$1_2=true}if(!this.$A_2){var g=this.$1_2?Strings.STS.L_PromoSites_StopAdminModeCommand:Strings.STS.L_PromoSites_StartAdminModeCommand,h=this.$1_2?Strings.STS.L_PromoSites_StopAdminModeTitle:Strings.STS.L_PromoSites_StartAdminModeTitle,i=String.format(STSHtmlEncode(g),'<a href="javascript:;" id="promotedSitesAdminMode_'+b.wpq+'" title="'+STSHtmlEncode(h)+'">',"</a>");a.addAttribute("id","promotedSitesAdminModeContainer_"+b.wpq);a.addCssClass("ms-textLarge");if(!d){a.addAttribute("style","display:none;");var j=this;SP.SOD.executeOrDelayUntilEventNotified(function(a){if(SP.ScriptUtility.isNullOrUndefined(a))return;var c=$get("promotedSitesAdminModeContainer_"+b.wpq);if(!SP.ScriptUtility.isNullOrUndefined(c)){var d=a.AdminLink;if(!SP.ScriptUtility.isNullOrUndefined(d))c.style.display=""}},"SPSuiteLinksRendered")}a.renderBeginTag("span");a.write(i);a.renderEndTag()}},$S_2:function(a){a.preventDefault();a.stopPropagation();var b=new SP.UI.PromotedSitesList.EditLinkDialog(null,false);b.$K_0()},$T_2:function(a){a.preventDefault();a.stopPropagation();this.set_$7_2(!this.get_$7_2());RenderListView(this.$8_2,this.$8_2.wpq)}};SP.UI.PromotedSitesList.PromotedSitesTileViewRenderer.TileClickHandler=function(a){this.$$d_$R_0=Function.createDelegate(this,this.$R_0);this.$0_0=a};SP.UI.PromotedSitesList.PromotedSitesTileViewRenderer.TileClickHandler.prototype={$0_0:null,attach:function(a){$addHandler(a,"click",this.$$d_$R_0)},$R_0:function(a){a.preventDefault();a.stopPropagation();var b=this.$0_0.IsPersonalizedLink;if(b!=="true"){var c=new SP.UI.PromotedSitesList.EditLinkDialog(this.$0_0,true);c.$K_0()}}};SP.UI.PromotedSitesList.PromotedSitesTileRenderer=function(a,b,c,d,e,f){SP.UI.PromotedSitesList.PromotedSitesTileRenderer.initializeBase(this,[a,b,c,d,e]);this.$1_2=f};SP.UI.PromotedSitesList.PromotedSitesTileRenderer.prototype={$1_2:false,onBackgroundPostRender:function(a){SP.UI.PromotedLinks.PromotedLinksTileRenderer.prototype.onBackgroundPostRender.call(this,a);if(this.$1_2){a.renderBeginTag("div");a.writeEncoded(Strings.STS.L_PromoSites_EditTileCaption);a.renderEndTag()}}};Type.registerNamespace("Microsoft.SharePoint.Portal.UserProfiles");Microsoft.SharePoint.Portal.UserProfiles.PromotedSites=function(){};Microsoft.SharePoint.Portal.UserProfiles.PromotedSites.addSiteLink=function(a,f,d,b,c){if(!a)throw Error.argumentNull("context");var e=new SP.ClientActionInvokeStaticMethod(a,"{3704ccfc-2b1b-4b46-b681-12c72e4a635c}","AddSiteLink",[f,d,b,c]);a.addQuery(e)};Microsoft.SharePoint.Portal.UserProfiles.PromotedSites.deleteSiteLink=function(a,b){if(!a)throw Error.argumentNull("context");var c=new SP.ClientActionInvokeStaticMethod(a,"{3704ccfc-2b1b-4b46-b681-12c72e4a635c}","DeleteSiteLink",[b]);a.addQuery(c)};Microsoft.SharePoint.Portal.UserProfiles.PromotedSites.getPromotedLinksAsTiles=function(a){if(!a)throw Error.argumentNull("context");var b,c=new SP.ClientActionInvokeStaticMethod(a,"{3704ccfc-2b1b-4b46-b681-12c72e4a635c}","GetPromotedLinksAsTiles",null);a.addQuery(c);b=[];a.addQueryIdAndResultObject(c.get_id(),b);return b};Microsoft.SharePoint.Portal.UserProfiles.PromotedSites.updateSiteLink=function(a,d,g,e,b,c){if(!a)throw Error.argumentNull("context");var f=new SP.ClientActionInvokeStaticMethod(a,"{3704ccfc-2b1b-4b46-b681-12c72e4a635c}","UpdateSiteLink",[d,g,e,b,c]);a.addQuery(f)};SP.UI.PromotedSitesList.EditLinkDialog.registerClass("SP.UI.PromotedSitesList.EditLinkDialog");SP.UI.PromotedSitesList.GlobalTemplateOverrides.registerClass("SP.UI.PromotedSitesList.GlobalTemplateOverrides");SP.UI.PromotedSitesList.PromotedSitesTileViewRenderer.registerClass("SP.UI.PromotedSitesList.PromotedSitesTileViewRenderer",SP.UI.PromotedLinks.PromotedLinksTileViewRenderer);SP.UI.PromotedSitesList.PromotedSitesTileViewRenderer.TileClickHandler.registerClass("SP.UI.PromotedSitesList.PromotedSitesTileViewRenderer.TileClickHandler");SP.UI.PromotedSitesList.PromotedSitesTileRenderer.registerClass("SP.UI.PromotedSitesList.PromotedSitesTileRenderer",SP.UI.PromotedLinks.PromotedLinksTileRenderer);Microsoft.SharePoint.Portal.UserProfiles.PromotedSites.registerClass("Microsoft.SharePoint.Portal.UserProfiles.PromotedSites");function sp_ui_promotedsites_initialize(){SP.UI.PromotedSitesList.GlobalTemplateOverrides.$$cctor()}sp_ui_promotedsites_initialize();RegisterModuleInit("sp.ui.promotedsites.js",sp_ui_promotedsites_initialize);typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();NotifyScriptLoadedAndExecuteWaitingJobs("sp.ui.promotedsites.js");