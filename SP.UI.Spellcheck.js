function ULSH0S(){var o=new Object;o.ULSTeamName="CMS";o.ULSFileName="SP.UI.Spellcheck.js";return o;}
Type.registerNamespace("CUI");Type.registerNamespace("CUI.Page");if(typeof CUI.Page.PageComponent=="undefined"){CUI.Page.ICommandHandler=function(){};CUI.Page.ICommandHandler.registerInterface("CUI.Page.ICommandHandler");CUI.Page.PageComponent=function(){};CUI.Page.PageComponent.prototype={init:function(){},getGlobalCommands:function(){ULSH0S:;return null},getFocusedCommands:function(){ULSH0S:;return null},handleCommand:function(){ULSH0S:;return false},canHandleCommand:function(){ULSH0S:;return false},isFocusable:function(){ULSH0S:;return false},receiveFocus:function(){ULSH0S:;return false},yieldFocus:function(){ULSH0S:;return true},getId:function(){ULSH0S:;return"PageComponent"}};CUI.Page.PageComponent.registerClass("CUI.Page.PageComponent",null,CUI.Page.ICommandHandler)}Type.registerNamespace("SP.UI.Spellcheck");SP.UI.Spellcheck.SpellChecker=function(){};SP.UI.Spellcheck.SpellChecker.$e=function(){ULSH0S:;if(!SP.UI.Spellcheck.SpellChecker.$B)SP.UI.Spellcheck.SpellChecker.$B=SP.UI.ModalDialog.showWaitScreenSize(SP.Publishing.Resources.spellcheckerWaitScreenTitle,SP.Publishing.Resources.spellcheckerWaitScreenText,SP.UI.Spellcheck.SpellingEventHandler.OnWaitingScreenCallback,null,null)};SP.UI.Spellcheck.SpellChecker.$f=function(){ULSH0S:;if(SP.UI.Spellcheck.SpellChecker.$3)SP.UI.Spellcheck.SpellChecker.$3.innerHTML=SP.Publishing.Resources.spellingNoSpeller;else{addNotification(SP.Publishing.Resources.spellingNoSpeller,false);SP.UI.Spellcheck.SpellChecker.$i()}};SP.UI.Spellcheck.SpellChecker.$i=function(){ULSH0S:;if(SP.UI.Spellcheck.SpellChecker.$B){SP.UI.Spellcheck.SpellChecker.$B.close(1);SP.UI.Spellcheck.SpellChecker.$B=null}};SP.UI.Spellcheck.SpellChecker.Load=function(){ULSH0S:;if(SP.UI.Spellcheck.Externs.spellcheck){document.body.spellcheck=false;SP.UI.Spellcheck.SpellChecker.registerSpellingHandler();var a=RTE.RteUtility.getFirstStyleSheet();RTE.RteUtility.addStyleSheetRule(a,".ms-spellcheck-error","background: url('/_layouts/images/spell_underline.gif') repeat-x 0 100%;padding-bottom:1px;z-index:20;",0);RTE.SafeHtml.addDisallowedPasteClass("ms-spellcheck-error");SP.UI.Spellcheck.SpellChecker.$5=SP.UI.Spellcheck.Externs.spellcheck.defaultLanguage;RTE.Imports.ExecuteOrDelayUntilScriptLoaded(SP.UI.Spellcheck.SpellcheckComponent.$15,"sp.ribbon.js")}};SP.UI.Spellcheck.SpellChecker.clear=function(){ULSH0S:;if(!SP.UI.Spellcheck.SpellChecker.$0)return;for(var a=0;a<SP.UI.Spellcheck.SpellChecker.$0.length;a++)SP.UI.Spellcheck.SpellChecker.$0[a].$W_0();RTE.Cursor.update();if(SP.UI.Spellcheck.SpellingEventHandler.$J){SP.UI.Spellcheck.SpellingEventHandler.$J=false;RTE.CanvasEvents.unRegisterListener(RTE.CanvasEvents.editableRegionChangedEvent,SP.UI.Spellcheck.SpellingEventHandler.$Z)}SP.UI.Spellcheck.SpellChecker.$H=false};SP.UI.Spellcheck.SpellChecker.ClearNode=function(c){ULSH0S:;for(var a=0;a<SP.UI.Spellcheck.SpellChecker.$0.length;a++){var b=SP.UI.Spellcheck.SpellChecker.$0[a];b.element===c&&b.$W_0()}RTE.Cursor.update()};SP.UI.Spellcheck.SpellChecker.ClearCurrentElement=function(){ULSH0S:;var a=RTE.Canvas.currentEditableRegion();if(!a)return;SP.UI.Spellcheck.SpellChecker.ClearNode(a)};SP.UI.Spellcheck.SpellChecker.SpellCheckCurrentElement=function(){ULSH0S:;var a=RTE.Canvas.currentEditableRegion();if(!a)return;SP.UI.Spellcheck.SpellChecker.SpellCheckChunk(a)};SP.UI.Spellcheck.SpellChecker.SpellCheckChunk=function(a){ULSH0S:;SP.UI.Spellcheck.SpellChecker.$D=a;SP.UI.Spellcheck.SpellChecker.$e();window.setTimeout(SP.UI.Spellcheck.SpellChecker.$11,0)};SP.UI.Spellcheck.SpellChecker.$11=function(){ULSH0S:;for(var c=SP.UI.Spellcheck.SpellChecker.$D,d=-1,a=null,b=0;b<SP.UI.Spellcheck.SpellChecker.$0.length;b++){var e=SP.UI.Spellcheck.SpellChecker.$0[b];if(e.element===c){d=b;a=e;break}}if(d===-1){d=SP.UI.Spellcheck.SpellChecker.$0.length;a=new SP.UI.Spellcheck.SpellingChunk(c)}if(a.text.length>0){var f=new Array(1);f[0]=a;SP.UI.Spellcheck.XMLRequest.$c(SP.UI.Spellcheck.SpellChecker.$5,0,f)}SP.UI.Spellcheck.SpellChecker.ClearNode(c)};SP.UI.Spellcheck.SpellChecker.Spellcheck=function(){ULSH0S:;SP.UI.Spellcheck.XMLRequest.$R=true;SP.UI.Spellcheck.SpellChecker.$D=RTE.Canvas.currentEditableRegion();SP.UI.Spellcheck.SpellChecker.$e();window.setTimeout(SP.UI.Spellcheck.SpellChecker.$j,0)};SP.UI.Spellcheck.SpellChecker.$j=function(){ULSH0S:;SP.UI.Spellcheck.SpellChecker.clear();var a=new Array(0);SP.UI.Spellcheck.SpellingChunk.$N(a,"div");SP.UI.Spellcheck.SpellingChunk.$N(a,"span");SP.UI.Spellcheck.SpellingChunk.$N(a,"input");SP.UI.Spellcheck.SpellingChunk.$N(a,"textarea");SP.UI.Spellcheck.SpellChecker.$0=a;SP.UI.Spellcheck.XMLRequest.$c(SP.UI.Spellcheck.SpellChecker.$5,0,a)};SP.UI.Spellcheck.SpellChecker.$14=function(b,a){ULSH0S:;if(!a)return 0;SP.UI.Spellcheck.SpellChecker.$3=Pub.Ribbon.PubCommands.generateInProgressSection(a,SP.Publishing.Resources.spellingHeader,SP.Publishing.Resources.spellingInProgress);window.setTimeout(SP.UI.Spellcheck.SpellChecker.$j,0);return 58};SP.UI.Spellcheck.SpellChecker.$12=function(){ULSH0S:;SP.UI.Spellcheck.SpellChecker.$3=null;SP.UI.Spellcheck.XMLRequest.$U()};SP.UI.Spellcheck.SpellChecker.$13=function(a){ULSH0S:;return!!SP.Ribbon.PageState.ImportedNativeData&&!!SP.Ribbon.PageState.ImportedNativeData.PageState&&(a===SP.Ribbon.PageState.PageStateCommands.pageStateGroupCheckin||a===SP.Ribbon.PageState.PageStateCommands.pageStateGroupSubmitForApproval||a===SP.Ribbon.PageState.PageStateCommands.pageStateGroupPublish)&&!!SP.Ribbon.PageState.ImportedNativeData.PageState[SP.Ribbon.PageState.PageStateStrings.itemIsCheckedOutToCurrentUserStateName]||(a===SP.Ribbon.PageState.PageStateCommands.pageStateGroupApprove||a===SP.Ribbon.PageState.PageStateCommands.pageStateGroupReject)&&!!SP.Ribbon.PageState.ImportedNativeData.PageState[SP.Ribbon.PageState.PageStateStrings.itemIsPendingApprovalStateName]};SP.UI.Spellcheck.SpellChecker.registerSpellingHandler=function(){ULSH0S:;var a=new SP.Ribbon.PageState.StateChangeDialogHandler;a.initialize=SP.UI.Spellcheck.SpellChecker.$14;a.enabled=SP.UI.Spellcheck.SpellChecker.$13;a.abort=SP.UI.Spellcheck.SpellChecker.$12;SP.Ribbon.PageState.Handlers.addStateChangeDialogHandler(a)};SP.UI.Spellcheck.SpellingChunk=function(a){ULSH0S:;this.$$d_$W_0=Function.createDelegate(this,this.$W_0);this.$$d_$10_0=Function.createDelegate(this,this.$10_0);this.element=a;this.text=SP.UI.Spellcheck.Utilities.$l(a)};SP.UI.Spellcheck.SpellingChunk.$N=function(b,f){ULSH0S:;for(var d=document.getElementsByTagName(f),c=0;c<d.length;c++){var a=d[c];if(a.className.indexOf("ms-spellcheck-true")!==-1)if(a.tagName===RTE.HtmlTagName.INPUT){var e=a;e.type.toLowerCase()==="text"&&e.value.length>0&&SP.UI.Spellcheck.SpellingChunk.$I(b,a)}else if(a.tagName===RTE.HtmlTagName.TEXTAREA)SP.UI.Spellcheck.SpellingChunk.$g(b,a);else SP.UI.Spellcheck.SpellingChunk.$I(b,a);else if(a.className.indexOf("ms-spellcheck-false")===-1&&a.getAttribute("excludeFromSpellCheck")!=="true")if(a.tagName===RTE.HtmlTagName.TEXTAREA)SP.UI.Spellcheck.SpellingChunk.$g(b,a);else a.className.indexOf(RTE.Canvas.editableItemClass)!==-1&&SP.UI.Spellcheck.SpellingChunk.$I(b,a);else a.className.indexOf("ms-rtestate-write")!==-1&&SP.UI.Spellcheck.SpellingChunk.$I(b,a)}};SP.UI.Spellcheck.SpellingChunk.$I=function(b,c){ULSH0S:;var a=new SP.UI.Spellcheck.SpellingChunk(c);a.text.length>0&&b.push(a)};SP.UI.Spellcheck.SpellingChunk.$g=function(d,a){ULSH0S:;var b=FindInlineHTMLEditor(a);if(b){if(b.body.innerText.length>0){var c=new SP.UI.Spellcheck.SpellingChunk(a);c.text=b.body.innerText;d.push(c)}}else{var e=a;e.value.length>0&&SP.UI.Spellcheck.SpellingChunk.$I(d,a)}};SP.UI.Spellcheck.SpellingChunk.prototype={errors:null,text:null,element:null,warning:null,$x_0:function(d){ULSH0S:;this.errors=new Array(0);var a=d.firstChild.nextSibling.childNodes;if(a.length>0)SP.UI.Spellcheck.SpellChecker.$H=true;for(var b=0;b<a.length;b++){var c=new SP.UI.Spellcheck.SpellingError(a[b]);this.errors.push(c)}},$S_0:false,$F_0:0,$X_0:null,$E_0:0,show:function(){ULSH0S:;if(this.errors.length>0)if(this.element.tagName===RTE.HtmlTagName.INPUT||this.element.tagName===RTE.HtmlTagName.TEXTAREA){this.$S_0=true;this.createSpellingWarning()}else{this.$S_0=false;this.$E_0=0;this.$F_0=0;this.$X_0=new RTE.DOMTreePosition(this.element,this.$F_0);this.$X_0.normalize();window.setTimeout(this.$$d_$10_0,0)}},$10_0:function(){ULSH0S:;var a=this.$E_0+100;if(a>this.errors.length)a=this.errors.length;for(var c=this.$E_0;c<a;c++){var b=this.errors[c];if(b.offset>=this.$F_0){b.$y_0(this.$X_0,this.$F_0);this.$F_0=b.offset+b.word.length}}this.$E_0=a;if(this.errors.length>this.$E_0)window.setTimeout(this.$$d_$10_0,0);else{this.$S_0=true;window.setTimeout(SP.UI.Spellcheck.XMLRequest.$V,0)}},$W_0:function(){ULSH0S:;if(this.element.tagName===RTE.HtmlTagName.INPUT||this.element.tagName===RTE.HtmlTagName.TEXTAREA)this.warning&&this.warning.parentNode&&this.warning.parentNode.removeChild(this.warning);if(this.errors)for(var a=0;a<this.errors.length;a++)this.errors[a].$d_0(false)},createSpellingWarning:function(){ULSH0S:;var b=document.createElement("div");b.id=SP.UI.UIUtility.generateRandomElementId();b.style.fontSize="11px";b.style.display="Inline";b.className="ms-spellcheck-warning";b.innerHTML="<a style='color:red;' href='#'><img src='/_layouts/"+SP.PageContextInfo.get_webLanguage()+"/images/RTE2SPCHK.GIF'alt='"+SP.Publishing.Resources.spellcheckerCheckSpelling+"' border='0' /></a> <a style='color:red;' href='#'>"+SP.Publishing.Resources.spellcheckerErrorFound+"</a>";$addHandler(b,"click",SP.UI.Spellcheck.SpellingEventHandler.OnSpellingMessageClick);this.warning=b;var a=this.element;while(a&&a.className!=="ms-formfieldvaluecontainer")a=a.parentNode;while(a&&a.className!=="ms-formfieldlabelcontainer")a=a.previousSibling;if(a)a.appendChild(b);else{a=this.element.parentNode;a.insertBefore(b,this.element)}},$s_0:function(){ULSH0S:;SpellCheckOneElement(SP.UI.Spellcheck.Externs.spellcheck.siteUrl+"_vti_bin/SpellCheck.asmx",SP.UI.Spellcheck.Externs.spellcheck.siteUrl+SP.Utilities.Utility.get_layoutsLatestVersionRelativeUrl()+"SpellChecker.aspx",true,this.element,SP.UI.Spellcheck.SpellChecker.$5.toString(),this.$$d_$W_0)}};SP.UI.Spellcheck.SpellingError=function(b){ULSH0S:;var a=b.firstChild;this.word=SP.UI.Spellcheck.XMLRequest.$C(a);a=a.nextSibling;this.type=SP.UI.Spellcheck.XMLRequest.$C(a);a=a.nextSibling;this.offset=parseInt(SP.UI.Spellcheck.XMLRequest.$C(a))};SP.UI.Spellcheck.SpellingError.prototype={word:null,type:null,offset:0,spellingNode:null,contextNode:null,contextAndSpellingNodesWrapperNode:null,$r_0:function(){ULSH0S:;var f=RTE.Canvas.isEditable(this.spellingNode),d=this.spellingNode.id,b=SP.UI.Menu.create("SpellingContext"),a=0;if(this.type!=="UnknownWord"){var h=null;if(f)h="SP.UI.Spellcheck.SpellingEventHandler.RemoveRepeat('"+d+"')";b.addMenuItem(SP.Publishing.Resources.spellcheckerDuplicateMenuItem,h,null,null,a,null,null);a++}else{var e=SP.UI.Spellcheck.SpellChecker.$a[this.word];if(e)for(var c=0;c<e.possibilities.length;c++){var i=null;if(f)i="SP.UI.Spellcheck.SpellingEventHandler.Suggestion('"+d+"', '"+e.possibilities[c].replace("'","\\'")+"')";b.addMenuItem(e.possibilities[c],i,null,null,a,null,"spellingsuggestion"+c.toString());a++}else{b.addMenuItem(SP.Publishing.Resources.spellcheckerNoneFoundMenuItem,null,null,null,a,null,"nosuggestions");$get("nosuggestions").setAttribute("disabled",true);a++}}if(f){b.addSeparator();b.addMenuItem(SP.Publishing.Resources.spellcheckerIgnoreMenuItem,"SP.UI.Spellcheck.SpellingEventHandler.Ignore('"+d+"')",null,null,a,null,"ignorespellerror");a++;b.addMenuItem(SP.Publishing.Resources.spellcheckerIgnoreAllMenuItem,"SP.UI.Spellcheck.SpellingEventHandler.IgnoreAll('"+d+"')",null,null,a,null,"ignoreall");a++}var g=document.createElement(RTE.HtmlTagName.SPAN);g.innerHTML="a";this.contextNode.appendChild(g);b.show(this.contextNode,true,false,0);SP.UI.UIUtility.removeNode(g);Sys.UI.DomElement.addCssClass(this.contextNode,RTE.Canvas.notifyOnGenerateClass);RTE.Cursor.update()},$p_0:function(){ULSH0S:;return RTE.RteUtility.getInnerText(this.spellingNode)!==this.word},ignore:function(){ULSH0S:;if(this.spellingNode){RTE.Cursor.get_range().moveAfterNode(this.spellingNode);this.clear()}},replace:function(b){ULSH0S:;var a=RTE.Canvas.getEditableRegion(this.spellingNode);RTE.SnapshotManager.takeEditableRegionSnapshot(a);SP.UI.UIUtility.setInnerText(this.spellingNode,unescape(b));RTE.Cursor.get_range().moveAfterNode(this.spellingNode.parentNode);!SP.ScriptUtility.isNullOrUndefined(RTE.SnapshotManager.setRegionDirty)&&RTE.SnapshotManager.setRegionDirty(a);this.clear();RTE.SnapshotManager.takeEditableRegionSnapshot(a)},clear:function(){ULSH0S:;this.$d_0(true)},$d_0:function(a){ULSH0S:;if(this.spellingNode){$clearHandlers(this.spellingNode);this.spellingNode.parentNode&&RTE.RteUtility.removeNodeAndKeepChildNodes(this.spellingNode);this.spellingNode=null}if(this.contextNode){this.contextNode.parentNode&&this.contextNode.parentNode.removeChild(this.contextNode);this.contextNode=null}if(this.contextAndSpellingNodesWrapperNode){this.contextAndSpellingNodesWrapperNode.parentNode&&RTE.RteUtility.removeNodeAndKeepChildNodes(this.contextAndSpellingNodesWrapperNode);this.contextAndSpellingNodesWrapperNode=null}a&&RTE.Cursor.update()},$y_0:function(c,e){ULSH0S:;this.spellingNode=document.createElement(RTE.HtmlTagName.SPAN);this.spellingNode.id=SP.UI.UIUtility.generateRandomElementId();this.spellingNode.className="ms-spellcheck-error";RTE.RteUtility.ignoreNodeInOutput(this.spellingNode);SP.UI.Spellcheck.Utilities.$h(c,SP.UI.Spellcheck.SpellingError.$6,this.offset-e,true);SP.UI.Spellcheck.Utilities.$h(c,SP.UI.Spellcheck.SpellingError.$A,unescape(this.word).length,false);if(SP.UI.Spellcheck.SpellingError.$6.nextSibling&&SP.UI.UIUtility.isTextNode(SP.UI.Spellcheck.SpellingError.$6.nextSibling)&&SP.UI.Spellcheck.SpellingError.$6.nextSibling.nextSibling===SP.UI.Spellcheck.SpellingError.$A){this.spellingNode.appendChild(SP.UI.Spellcheck.SpellingError.$6.nextSibling);SP.UI.UIUtility.insertBefore(this.spellingNode,SP.UI.Spellcheck.SpellingError.$A)}else{var d=new RTE.CanvasRange("spelling");d.moveToMarkers(SP.UI.Spellcheck.SpellingError.$6,SP.UI.Spellcheck.SpellingError.$A);d.wrapRange(this.spellingNode);d.dispose()}SP.UI.Spellcheck.SpellingError.$6.parentNode.removeChild(SP.UI.Spellcheck.SpellingError.$6);SP.UI.Spellcheck.SpellingError.$A.parentNode.removeChild(SP.UI.Spellcheck.SpellingError.$A);if(!SP.UI.Spellcheck.SpellingError.$4){SP.UI.Spellcheck.SpellingError.$4=document.createElement(RTE.HtmlTagName.SPAN);SP.UI.Spellcheck.SpellingError.$4.className=RTE.Canvas.atomicItemClass;SP.UI.Spellcheck.SpellingError.$4.style.fontSize=SP.Publishing.Resources.spellingSuggestionFontSize;SP.UI.Spellcheck.SpellingError.$4.contentEditable=false;RTE.RteUtility.ignoreNodeInOutput(SP.UI.Spellcheck.SpellingError.$4);var a=document.createElement(RTE.HtmlTagName.a);RTE.RteUtility.ignoreNodeInOutput(a);SP.UI.Spellcheck.SpellingError.$4.appendChild(a);var b=document.createElement(RTE.HtmlTagName.IMG);b.src="/_layouts/images/blank.gif";b.alt=SP.Publishing.Resources.spellcheckerMisspelled;b.style.width="0px";RTE.RteUtility.ignoreNodeInOutput(b);a.appendChild(b);$addHandler(a,"click",SP.UI.Spellcheck.SpellingEventHandler.OnSpellingErrorClick);$addHandler(a,"contextmenu",SP.UI.Spellcheck.SpellingEventHandler.OnSpellingErrorClick)}this.contextNode=SP.UI.Spellcheck.SpellingError.$4.cloneNode(true);this.contextAndSpellingNodesWrapperNode=document.createElement(RTE.HtmlTagName.SPAN);RTE.RteUtility.ignoreNodeInOutput(this.contextAndSpellingNodesWrapperNode);this.contextAndSpellingNodesWrapperNode.style.whiteSpace="nowrap";this.spellingNode.parentNode.insertBefore(this.contextAndSpellingNodesWrapperNode,this.spellingNode);this.contextAndSpellingNodesWrapperNode.appendChild(this.contextNode);this.contextAndSpellingNodesWrapperNode.appendChild(this.spellingNode);SP.UI.Spellcheck.SpellChecker.$7[this.spellingNode.id]=this;c.setCurrentNode(this.spellingNode);c.setLocationAtEnd();c.moveToNextElement();$addHandler(this.spellingNode,"contextmenu",SP.UI.Spellcheck.SpellingEventHandler.OnSpellingErrorClick);$addHandler(this.spellingNode,"click",SP.UI.Spellcheck.SpellingEventHandler.OnSpellingErrorClick)}};SP.UI.Spellcheck.SpellingEventHandler=function(){};SP.UI.Spellcheck.SpellingEventHandler.onRteChange=function(){ULSH0S:;var a=SP.UI.Spellcheck.Utilities.$n(RTE.Cursor.get_range().get_startMarker());if(a){var b=SP.UI.Spellcheck.SpellChecker.$7[a.id];b.$p_0()&&b.clear()}};SP.UI.Spellcheck.SpellingEventHandler.OnSpellingErrorClick=function(a){ULSH0S:;if(!a||!a.target)return;SP.UI.Spellcheck.SpellingEventHandler.$K=SP.UI.Spellcheck.SpellChecker.$7[a.target.id];if(SP.UI.Spellcheck.SpellingEventHandler.$K){a.type==="contextmenu"&&a.preventDefault();window.setTimeout(SP.UI.Spellcheck.SpellingEventHandler.$v,0)}};SP.UI.Spellcheck.SpellingEventHandler.$v=function(){ULSH0S:;SP.UI.Spellcheck.SpellingEventHandler.$K.$r_0()};SP.UI.Spellcheck.SpellingEventHandler.OnSpellingMessageClick=function(a){ULSH0S:;if(!a||!a.target)return;for(var d=SP.UI.Spellcheck.Utilities.$o(a.target),b=0;b<SP.UI.Spellcheck.SpellChecker.$0.length;b++){var c=SP.UI.Spellcheck.SpellChecker.$0[b];if(c.warning===d){c.$s_0();a.preventDefault()}}};SP.UI.Spellcheck.SpellingEventHandler.Suggestion=function(c,a){ULSH0S:;var b=SP.UI.Spellcheck.SpellChecker.$7[c];b.replace(a)};SP.UI.Spellcheck.SpellingEventHandler.Ignore=function(b){ULSH0S:;var a=SP.UI.Spellcheck.SpellChecker.$7[b];a.ignore()};SP.UI.Spellcheck.SpellingEventHandler.IgnoreAll=function(g){ULSH0S:;for(var e=SP.UI.Spellcheck.SpellChecker.$7[g],f=e.word,a=0;a<SP.UI.Spellcheck.SpellChecker.$0.length;a++){var b=SP.UI.Spellcheck.SpellChecker.$0[a];if(b.errors)for(var c=0;c<b.errors.length;c++){var d=b.errors[c];d.word===f&&d.ignore()}}};SP.UI.Spellcheck.SpellingEventHandler.OnWaitingScreenCallback=function(a){ULSH0S:;!a&&SP.UI.Spellcheck.XMLRequest.$U()};SP.UI.Spellcheck.SpellingEventHandler.RemoveRepeat=function(b){ULSH0S:;var a=SP.UI.Spellcheck.SpellChecker.$7[b];a.replace("")};SP.UI.Spellcheck.SpellingEventHandler.OnUndoRedo=function(){ULSH0S:;var a=RTE.Canvas.currentEditableRegion();if(!a)return;for(var c=false,b=0;b<SP.UI.Spellcheck.SpellingEventHandler.$9.length;b++)if(SP.UI.Spellcheck.SpellingEventHandler.$9[b]===a){c=true;break}if(!c){SP.UI.Spellcheck.SpellingEventHandler.$9.push(a);SP.UI.Spellcheck.SpellChecker.ClearNode(a)}SP.UI.Spellcheck.SpellingEventHandler.$L++;window.setTimeout(SP.UI.Spellcheck.SpellingEventHandler.$w,2e3)};SP.UI.Spellcheck.SpellingEventHandler.$w=function(){ULSH0S:;SP.UI.Spellcheck.SpellingEventHandler.$L--;if(0===SP.UI.Spellcheck.SpellingEventHandler.$L){for(var a=0;a<SP.UI.Spellcheck.SpellingEventHandler.$9.length;a++)SP.UI.Spellcheck.SpellChecker.SpellCheckChunk(SP.UI.Spellcheck.SpellingEventHandler.$9[a]);SP.UI.Spellcheck.SpellingEventHandler.$9=new Array(0)}};SP.UI.Spellcheck.SpellingEventHandler.queryRemoveSpellChecks=function(){ULSH0S:;var a=new RTE.CommandState;a.set_enabled(SP.UI.Spellcheck.SpellChecker.$H);return a};SP.UI.Spellcheck.SpellcheckRichTextEditorComponentProvider=function(){ULSH0S:;SP.UI.Spellcheck.SpellcheckRichTextEditorComponentProvider.initializeBase(this)};SP.UI.Spellcheck.SpellcheckRichTextEditorComponentProvider.prototype={$1_1:null,$M_1:null,init:function(a){ULSH0S:;this.$1_1=a;this.$M_1=["SpellCheckGroup","PublishingTab","SpellcheckUsing","SpellcheckUsingDefault","NoSpelling","GetSpellCheckMenuXml"]},$q_1:function(){ULSH0S:;var b=SP.UI.Spellcheck.Externs.spellcheck.languages;if(b.length>0){var f=this;b.sort(function(a,b){ULSH0S:;return a.name.localeCompare(b.name)});var a=new Sys.StringBuilder;a.append("<Menu Id='Ribbon.EditingTools.CPEditTab.SpellCheck.SpellCheck.Menu'>");a.append("<MenuSection Id='Ribbon.EditingTools.CPEditTab.SpellCheck.SpellCheck.Menu.Languages'>");a.append("<Controls Id='Ribbon.EditingTools.CPEditTab.SpellCheck.SpellCheck.Menu.Languages.Controls'>");a.append("<Button");a.append(" id='Ribbon.EditingTools.CPEditTab.SpellCheck.SpellCheck.Menu.Languages.RemoveSpellCheck' LabelText='");a.append(SP.Utilities.HttpUtility.escapeXmlText(SP.Publishing.Resources.spellcheckerRemoveButton));a.append("' CommandType='General'");a.append(" Command='");a.append("NoSpelling");a.append("' />");for(var d=-1,e=0;e<b.length;e++)if(b[e].lcid===SP.UI.Spellcheck.SpellChecker.$5)d=e;if(d!==-1){a.append("<Button");a.append(" id='Ribbon.EditingTools.CPEditTab.SpellCheck.SpellCheck.Menu.Languages.DefaultLanguage' LabelText='");a.append(SP.Utilities.HttpUtility.escapeXmlText(b[d].name));a.append("' CommandType='General'");a.append(" Command='");a.append("SpellcheckUsing");a.append("' CommandValueId= '");a.append(SP.UI.Spellcheck.SpellChecker.$5.toString());a.append("' />")}for(var c=0;c<b.length;c++)if(c!==d){a.append("<Button");a.append(" id='Ribbon.EditingTools.CPEditTab.SpellCheck.SpellCheck.Menu.Languages.Language");a.append(c.toString());a.append("' LabelText='");a.append(SP.Utilities.HttpUtility.escapeXmlText(b[c].name));a.append("' CommandType='OptionSelection' MenuItemId='");a.append(c.toString());a.append("' CommandValueId='");a.append(b[c].lcid.toString());a.append("' Command='");a.append("SpellcheckUsing");a.append("' />")}a.append("</Controls></MenuSection></Menu>");return a.toString()}return""},canHandleCommand:function(a){ULSH0S:;return a==="NoSpelling"?SP.UI.Spellcheck.SpellChecker.$H:Array.indexOf(this.$M_1,a)>=0&&SP.UI.Spellcheck.Externs.spellcheck?true:this.$1_1?this.$1_1.canHandleCommand(a):false},getGlobalCommands:function(){ULSH0S:;return this.$1_1?this.$1_1.getGlobalCommands():null},getFocusedCommands:function(){ULSH0S:;if(this.$1_1){var a=[];Array.addRange(a,this.$M_1);Array.addRange(a,this.$1_1.getFocusedCommands());return a}return this.$M_1},handleCommand:function(a,b,e){ULSH0S:;if(!a)return false;if(a==="GetSpellCheckMenuXml"){var c=b;c.PopulationXML=this.$q_1()}else if(a==="SpellcheckUsing"){var d=b.CommandValueId;SP.UI.Spellcheck.SpellChecker.$5=parseInt(d);SP.UI.Spellcheck.SpellChecker.Spellcheck()}else if(a==="SpellcheckUsingDefault")SP.UI.Spellcheck.SpellChecker.Spellcheck();else if(a==="NoSpelling")SP.UI.Spellcheck.SpellChecker.clear();else if(this.$1_1)return this.$1_1.handleCommand(a,b,e);return true},isFocusable:function(){ULSH0S:;return this.$1_1?this.$1_1.isFocusable():true},receiveFocus:function(){ULSH0S:;return this.$1_1?this.$1_1.receiveFocus():true},yieldFocus:function(){ULSH0S:;this.$1_1&&this.$1_1.yieldFocus();return true}};SP.UI.Spellcheck.SpellingSuggestion=function(c){ULSH0S:;this.possibilities=new Array(0);this.word=SP.UI.Spellcheck.XMLRequest.$C(c.firstChild);for(var b=c.firstChild.nextSibling.childNodes,a=0;a<b.length;a++)this.possibilities.push(SP.UI.Spellcheck.XMLRequest.$C(b[a]))};SP.UI.Spellcheck.SpellingSuggestion.prototype={word:null};SP.UI.Spellcheck.SpellcheckComponent=function(){ULSH0S:;SP.UI.Spellcheck.SpellcheckComponent.initializeBase(this);this.$8_1=new SP.UI.Spellcheck.SpellcheckRichTextEditorComponentProvider};SP.UI.Spellcheck.SpellcheckComponent.get_instance=function(){ULSH0S:;if(!SP.UI.Spellcheck.SpellcheckComponent.$O)SP.UI.Spellcheck.SpellcheckComponent.$O=new SP.UI.Spellcheck.SpellcheckComponent;return SP.UI.Spellcheck.SpellcheckComponent.$O};SP.UI.Spellcheck.SpellcheckComponent.$15=function(){ULSH0S:;var a=SP.UI.Spellcheck.SpellcheckComponent.$m();a&&a.addPageComponent(SP.UI.Spellcheck.SpellcheckComponent.get_instance())};SP.UI.Spellcheck.SpellcheckComponent.$m=function(){ULSH0S:;var a=null;if(window.SP&&window.SP.Ribbon)a=window.SP.Ribbon.PageManager.get_instance();return a};SP.UI.Spellcheck.SpellcheckComponent.prototype={$8_1:null,init:function(){ULSH0S:;this.$8_1.init(null)},getFocusedCommands:function(){ULSH0S:;return[]},getGlobalCommands:function(){ULSH0S:;return this.$8_1.getFocusedCommands()},canHandleCommand:function(a){ULSH0S:;return this.$8_1.canHandleCommand(a)},handleCommand:function(a,c,d){ULSH0S:;RTE.RteUtility.assertNotNull("commandId",a);var b=this.$8_1.handleCommand(a,c,d);return b},isFocusable:function(){ULSH0S:;return this.$8_1.isFocusable()},receiveFocus:function(){ULSH0S:;return this.$8_1.receiveFocus()},yieldFocus:function(){ULSH0S:;return this.$8_1.yieldFocus()},getId:function(){ULSH0S:;return"SpellCheckComponent"}};SP.UI.Spellcheck.Utilities=function(){};SP.UI.Spellcheck.Utilities.$n=function(a){ULSH0S:;while(a){if(a.className==="ms-spellcheck-error")return a;a=a.parentNode}return null};SP.UI.Spellcheck.Utilities.$o=function(a){ULSH0S:;while(a){if(a.className==="ms-spellcheck-warning")return a;a=a.parentNode}return null};SP.UI.Spellcheck.Utilities.$l=function(b){ULSH0S:;if(b.tagName===RTE.HtmlTagName.INPUT){var e=b;return e.value}else if(b.tagName===RTE.HtmlTagName.TEXTAREA){var f=b;return f.value}if(!b.childNodes.length)return"";var c=new Sys.StringBuilder,d=new RTE.DOMTreePosition(b,0);d.normalize();do{var a=d.getCurrentNode();if(a===b)break;if(SP.UI.UIUtility.isTextNode(a)){var g=a.nodeValue;c.append(g)}else if(a.className.search(SP.UI.Spellcheck.Utilities.$T)!==-1){c.append(" ");d.setLocationAtEnd()}else if(a.tagName===RTE.HtmlTagName.BR)c.append(" ");else(SP.UI.UIUtility.isNodeOfType(a,RTE.HtmlTagName.blockElements)||a.tagName===RTE.HtmlTagName.a)&&c.append(" ")}while(d.moveToNextElement());return c.toString()};SP.UI.Spellcheck.Utilities.$h=function(c,g,a,f){ULSH0S:;do{var b=c.getCurrentNode();if(SP.UI.UIUtility.isTextNode(b)){var d=c.getOffset(),e=b.nodeValue;if(e.length>a+d&&f||e.length>=a+d&&!f){c.setOffset(a+d);c.insertMarker(g);return}else a-=e.length-d}else if(b.className.search(SP.UI.Spellcheck.Utilities.$T)!==-1){a--;c.setLocationAtEnd()}else if(b.tagName===RTE.HtmlTagName.BR)a--;else if(SP.UI.UIUtility.isNodeOfType(b,RTE.HtmlTagName.blockElements)||b.tagName===RTE.HtmlTagName.a)a--}while(c.moveToNextElement());return};SP.UI.Spellcheck.XMLRequest=function(){};SP.UI.Spellcheck.XMLRequest.$k=function(d,c){ULSH0S:;var a=new String;a+='<?xml version="1.0" encoding="utf-8"?>\n';a+='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"';a+=' xmlns:xsd="http://www.w3.org/2001/XMLSchema"';a+=' xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">\n';a+="<soap:Body>\n";a+='<SpellCheck xmlns="http://schemas.microsoft.com/sharepoint/publishing/spelling/">';a+="<chunksToSpell>\n";for(var b=0;b<c.length;b++){a+="<string>";a+=SP.Utilities.HttpUtility.escapeXmlText(c[b].text);a+="</string>\n"}a+="</chunksToSpell>";a+="<declaredLanguage>"+d+"</declaredLanguage>\n";a+="<useLad> false </useLad>\n";a+="</SpellCheck>\n";a+="</soap:Body>\n";a+="</soap:Envelope>";return a};SP.UI.Spellcheck.XMLRequest.$U=function(){ULSH0S:;SP.UI.Spellcheck.XMLRequest.$2.abort();SP.UI.Spellcheck.XMLRequest.$Q=false};SP.UI.Spellcheck.XMLRequest.$c=function(c,d,a){ULSH0S:;if(!a.length){if(SP.UI.Spellcheck.SpellChecker.$3)SP.UI.Spellcheck.SpellChecker.$3.innerHTML=SP.Publishing.Resources.spellingNoIssues;SP.UI.Spellcheck.XMLRequest.$G=0;SP.UI.Spellcheck.XMLRequest.$V();return}if(SP.UI.Spellcheck.SpellChecker.$5===-1){SP.UI.Spellcheck.SpellChecker.$f();return}SP.UI.Spellcheck.XMLRequest.$Q&&SP.UI.Spellcheck.XMLRequest.$U();var b=window.escapeUrlForCallback(SP.UI.Spellcheck.Externs.spellcheck.siteUrl+"_vti_bin/SpellCheck.asmx");SP.UI.Spellcheck.XMLRequest.$2.open("POST",b,true);SP.UI.Spellcheck.XMLRequest.$2.setRequestHeader("Content-type","text/xml; charset=utf-8");SP.UI.Spellcheck.XMLRequest.$2.setRequestHeader("SOAPAction",'"http://schemas.microsoft.com/sharepoint/publishing/spelling/SpellCheck"');SP.UI.Spellcheck.XMLRequest.$2.onreadystatechange=SP.UI.Spellcheck.XMLRequest.$u;SP.UI.Spellcheck.XMLRequest.$Q=true;SP.UI.Spellcheck.XMLRequest.$Y=d;SP.UI.Spellcheck.XMLRequest.$2.send(SP.UI.Spellcheck.XMLRequest.$k(c,a))};SP.UI.Spellcheck.XMLRequest.$C=function(a){ULSH0S:;return a.text?a.text:a.textContent};SP.UI.Spellcheck.XMLRequest.$t=function(){ULSH0S:;SP.UI.Spellcheck.XMLRequest.$P.close(1);SP.UI.Spellcheck.XMLRequest.$P=null;SP.UI.Spellcheck.SpellChecker.$D&&SP.UI.Spellcheck.SpellChecker.$D.focus()};SP.UI.Spellcheck.XMLRequest.$z=function(f){ULSH0S:;var d=document.createElement("div"),c=document.createElement("DIV");c.style.margin="8px 0px";c.innerHTML=f;d.appendChild(c);var e=document.createElement("DIV");e.style.textAlign=SP.Publishing.Resources.alignRight;var b=document.createElement("INPUT");b.value=SP.Publishing.Resources.okButtonText;b.type="button";$addHandler(b,"click",SP.UI.Spellcheck.XMLRequest.$t);b.style.margin="4px";b.id="messageboxdialog_okbutton";e.appendChild(b);d.appendChild(e);var a=new SP.UI.DialogOptions;a.html=d;a.title=SP.Publishing.Resources.spellCheckMessageBoxTitle;a.autoSize=true;a.showClose=true;a.showMaximized=false;a.width=Number.parseInvariant(SP.Publishing.Resources.messageBoxModalDialogWidth);a.height=Number.parseInvariant(SP.Publishing.Resources.messageBoxModalDialogHeight);SP.UI.Spellcheck.XMLRequest.$P=SP.UI.ModalDialog.showModalDialog(a);c.tabIndex=0;window.setTimeout(function(){ULSH0S:;c.focus()},0)};SP.UI.Spellcheck.XMLRequest.$u=function(){ULSH0S:;if(SP.UI.Spellcheck.XMLRequest.$2.readyState===4){var e=SP.UI.Spellcheck.XMLRequest.$2.responseXML.getElementsByTagName("errorCode");if(e.length>0&&e[0].firstChild.nodeValue==="SpellCheckerNotInstalled"){SP.UI.Spellcheck.SpellChecker.$f();return}for(var f=SP.UI.Spellcheck.XMLRequest.$2.responseXML.getElementsByTagName("SpellingSuggestions"),d=0;d<f.length;d++){var g=new SP.UI.Spellcheck.SpellingSuggestion(f[d]);SP.UI.Spellcheck.SpellChecker.$a[g.word]=g}if(!SP.UI.Spellcheck.SpellingEventHandler.$J){SP.UI.Spellcheck.SpellingEventHandler.$J=true;RTE.CanvasEvents.registerListener(RTE.CanvasEvents.editableRegionChangedEvent,SP.UI.Spellcheck.SpellingEventHandler.$Z)}var b=SP.UI.Spellcheck.XMLRequest.$2.responseXML.getElementsByTagName("FlaggedWord");if(SP.UI.Spellcheck.SpellChecker.$3){SP.UI.Spellcheck.SpellChecker.$3.tabIndex=0;if(b.length>0)SP.UI.Spellcheck.SpellChecker.$3.innerHTML=SP.Publishing.Resources.spellingWithIssues.replace("|0",b.length.toString());else SP.UI.Spellcheck.SpellChecker.$3.innerHTML=SP.Publishing.Resources.spellingNoIssues}for(var c=SP.UI.Spellcheck.XMLRequest.$2.responseXML.getElementsByTagName("SpellingErrors"),a=0;a<c.length;a++){var i=parseInt(SP.UI.Spellcheck.XMLRequest.$C(c[a].firstChild)),h=SP.UI.Spellcheck.SpellChecker.$0[i+SP.UI.Spellcheck.XMLRequest.$Y];h.$x_0(c[a]);h.show()}SP.UI.Spellcheck.XMLRequest.$G=b.length;SP.UI.Spellcheck.XMLRequest.$V()}};SP.UI.Spellcheck.XMLRequest.$V=function(){ULSH0S:;for(var a=0;a<SP.UI.Spellcheck.SpellChecker.$0.length;a++){var c=SP.UI.Spellcheck.SpellChecker.$0[a];if(c.errors&&!c.$S_0)return}SP.UI.Spellcheck.SpellChecker.$i();if(SP.UI.Spellcheck.XMLRequest.$R){var b;if(SP.UI.Spellcheck.XMLRequest.$G>0)b=SP.Publishing.Resources.spellingWithIssues.replace("|0",SP.UI.Spellcheck.XMLRequest.$G.toString());else b=SP.Publishing.Resources.spellingNoIssues;SP.UI.Spellcheck.XMLRequest.$z(b);SP.UI.Spellcheck.XMLRequest.$R=false}};SP.UI.Spellcheck.SpellChecker.registerClass("SP.UI.Spellcheck.SpellChecker");SP.UI.Spellcheck.SpellingChunk.registerClass("SP.UI.Spellcheck.SpellingChunk");SP.UI.Spellcheck.SpellingError.registerClass("SP.UI.Spellcheck.SpellingError");SP.UI.Spellcheck.SpellingEventHandler.registerClass("SP.UI.Spellcheck.SpellingEventHandler");SP.UI.Spellcheck.SpellcheckRichTextEditorComponentProvider.registerClass("SP.UI.Spellcheck.SpellcheckRichTextEditorComponentProvider",RTE.RichTextEditorComponentProvider);SP.UI.Spellcheck.SpellingSuggestion.registerClass("SP.UI.Spellcheck.SpellingSuggestion");SP.UI.Spellcheck.SpellcheckComponent.registerClass("SP.UI.Spellcheck.SpellcheckComponent",CUI.Page.PageComponent);SP.UI.Spellcheck.Utilities.registerClass("SP.UI.Spellcheck.Utilities");SP.UI.Spellcheck.XMLRequest.registerClass("SP.UI.Spellcheck.XMLRequest");function sp_ui_spellcheck_initialize(){ULSH0S:;SP.UI.Spellcheck.SpellChecker.$a={};SP.UI.Spellcheck.SpellChecker.$0=new Array(0);SP.UI.Spellcheck.SpellChecker.$7={};SP.UI.Spellcheck.SpellChecker.$5=0;SP.UI.Spellcheck.SpellChecker.$H=false;SP.UI.Spellcheck.SpellChecker.$B=null;SP.UI.Spellcheck.SpellChecker.$D=null;SP.UI.Spellcheck.SpellChecker.$3=null;SP.UI.Spellcheck.SpellingError.$6=document.createElement(RTE.HtmlTagName.SPAN);SP.UI.Spellcheck.SpellingError.$A=document.createElement(RTE.HtmlTagName.SPAN);SP.UI.Spellcheck.SpellingError.$4=null;SP.UI.Spellcheck.SpellingEventHandler.$J=false;SP.UI.Spellcheck.SpellingEventHandler.$Z=SP.UI.Spellcheck.SpellingEventHandler.onRteChange;SP.UI.Spellcheck.SpellingEventHandler.$K=null;SP.UI.Spellcheck.SpellingEventHandler.$L=0;SP.UI.Spellcheck.SpellingEventHandler.$9=new Array(0);SP.UI.Spellcheck.SpellcheckComponent.$O=null;SP.UI.Spellcheck.Utilities.$T=new RegExp(RTE.Canvas.atomicItemClass);SP.UI.Spellcheck.XMLRequest.$2=new XMLHttpRequest;SP.UI.Spellcheck.XMLRequest.$Q=false;SP.UI.Spellcheck.XMLRequest.$Y=0;SP.UI.Spellcheck.XMLRequest.$R=false;SP.UI.Spellcheck.XMLRequest.$G=0;SP.UI.Spellcheck.XMLRequest.$P=null}sp_ui_spellcheck_initialize();function Spellcheck(){ULSH0S:;SP.UI.Spellcheck.SpellChecker.Spellcheck()}function Spellclear(){ULSH0S:;SP.UI.Spellcheck.SpellChecker.Clear()}function SpellCleanCurrentElement(){ULSH0S:;SP.UI.Spellcheck.SpellChecker.ClearCurrentElement()}function SpellOnUndoRedo(){ULSH0S:;SP.UI.Spellcheck.SpellingEventHandler.OnUndoRedo()}function SpelcheckElement(){ULSH0S:;SP.UI.Spellcheck.SpellChecker.SpellCheckCurrentElement()}function FindInlineHTMLEditor(a){ULSH0S:;return null!=a.id&&typeof RTE_GetEditorDocument!="undefined"?RTE_GetEditorDocument(a.id):null}function SpellCheckOneElement(j,l,i,c,o,k){ULSH0S:;if(null==document.getElementById("__spPickerHasReturnValue")){var g=document.createElement("INPUT");g.type="hidden";g.id="__spPickerHasReturnValue";document.body.appendChild(g)}if(null==document.getElementById("__spPickerReturnValueHolder")){var f=document.createElement("INPUT");f.type="hidden";f.id="__spPickerReturnValueHolder";document.body.appendChild(f)}var a,b=[],h=[];b[0]=c;var e=null;if(c.tagName=="TEXTAREA")e=FindInlineHTMLEditor(c);if(e==null)h[0]=new ChunkToSpell(c.value,"text",c.title,0);else if(e.body.innerHTML.length>0)h[0]=new ChunkToSpell(e.body.innerHTML,"html",c.title,0);var n=SpellCheckerDialogFeaturesString(),d={};d.chunks=h;d.lang=o;d.webServiceUrl=j;d.alertNoWebParts=i;var m=function(c){ULSH0S:;if(null==c){var e=document.getElementById("__spPickerHasReturnValue"),d=document.getElementById("__spPickerReturnValueHolder");if(null!=e&&e.value=="1"&&null!=d)try{c=jsonDeserialize(d.value)}catch(h){}}else if("string"==typeof c)try{c=jsonDeserialize(c)}catch(h){}if(null!=c&&"string"!=typeof c&&"boolean"!=typeof c){for(a=0;a<c.length;++a)if("INPUT"==b[c[a].Index].tagName){if("text"==b[c[a].Index].type)b[c[a].Index].value=c[a].Text}else if("TEXTAREA"==b[c[a].Index].tagName){var g=b[c[a].Index],f=FindInlineHTMLEditor(g);if(f!=null){if(null!=c[a].Html)f.body.innerHTML=c[a].Html}else if(null!=c[a].Text)b[c[a].Index].value=c[a].Text}k()}};commonShowModalDialog(l,n,m,d)}ExecuteAndRegisterBeginEndFunctions("SP.UI.Spellcheck.js",sp_ui_spellcheck_initialize,null,function(){ULSH0S:;SP.UI.Spellcheck.Externs=function(){};if(typeof spellcheck!="undefined")SP.UI.Spellcheck.Externs.spellcheck=spellcheck;ExecuteOrDelayUntilScriptLoaded(SP.UI.Spellcheck.SpellChecker.Load,"sp.ribbon.js")});typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs!="undefined"&&NotifyScriptLoadedAndExecuteWaitingJobs("SP.UI.Spellcheck.js");