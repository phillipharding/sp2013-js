function ULSBR8(){var o=new Object;o.ULSTeamName="SharePoint Portal Server";o.ULSFileName="SP.UI.CollabMailbox.js";return o;}
Type.registerNamespace("Microsoft.SharePoint.Portal");Microsoft.SharePoint.Portal.CollaborationMailboxStatus=function(){};Microsoft.SharePoint.Portal.CollaborationMailboxStatus.prototype={showOwaFrame:0,showProvisionFrame:1,errorStart:49,notSiteOwner:50,unsupportedExchangeVersion:51,unsupportedExchangeTopology:52,autoDiscoverFailed:53,unsupportedSharePointConfiguration:54,ewsClientMissing:55,webUrlChanged:56,mailboxNotReady:57,memberGroupsNotAvailable:58,serviceError:98,errorEnd:99,loadShowOwaFrame:100,loadShowProvisionFrame:101,defaultStatus:1e3};Microsoft.SharePoint.Portal.CollaborationMailboxStatus.registerEnum("Microsoft.SharePoint.Portal.CollaborationMailboxStatus",false);Microsoft.SharePoint.Portal.CollaborationMailbox=function(){};Microsoft.SharePoint.Portal.CollaborationMailbox.getCollabMailboxViewInfo=function(a){ULSBR8:;if(!a)throw Error.argumentNull("context");var b,c=new SP.ClientActionInvokeStaticMethod(a,"{c5f8e1b0-748e-4fa3-b799-c6fe07013774}","GetCollabMailboxViewInfo",null);a.addQuery(c);b=new Microsoft.SharePoint.Portal.CollaborationMailboxResponse;a.addQueryIdAndResultObject(c.get_id(),b);return b};Microsoft.SharePoint.Portal.CollaborationMailboxResponse=function(){ULSBR8:;Microsoft.SharePoint.Portal.CollaborationMailboxResponse.initializeBase(this)};Microsoft.SharePoint.Portal.CollaborationMailboxResponse.prototype={$2_1:null,$3_1:null,$4_1:0,$1_1:0,$5_1:null,get_alternateUrl:function(){ULSBR8:;return this.$2_1},set_alternateUrl:function(a){ULSBR8:;this.$2_1=a;return a},get_correlationId:function(){ULSBR8:;return this.$3_1},set_correlationId:function(a){ULSBR8:;this.$3_1=a;return a},get_errorCode:function(){ULSBR8:;return this.$4_1},set_errorCode:function(a){ULSBR8:;this.$4_1=a;return a},get_status:function(){ULSBR8:;return this.$1_1},set_status:function(a){ULSBR8:;this.$1_1=a;return a},get_url:function(){ULSBR8:;return this.$5_1},set_url:function(a){ULSBR8:;this.$5_1=a;return a},get_typeId:function(){ULSBR8:;return "{53cc7746-0596-478c-ae12-d5b1ed5da52e}"},writeToXml:function(b,a){ULSBR8:;if(!b)throw Error.argumentNull("writer");if(!a)throw Error.argumentNull("serializationContext");var c=["AlternateUrl","CorrelationId","ErrorCode","Status","Url"];SP.DataConvert.writePropertiesToXml(b,this,c,a);SP.ClientValueObject.prototype.writeToXml.call(this,b,a)},initPropertiesFromJson:function(b){ULSBR8:;SP.ClientValueObject.prototype.initPropertiesFromJson.call(this,b);var a;a=b.AlternateUrl;if(!SP.ScriptUtility.isUndefined(a)){this.$2_1=a;delete b.AlternateUrl}a=b.CorrelationId;if(!SP.ScriptUtility.isUndefined(a)){this.$3_1=a;delete b.CorrelationId}a=b.ErrorCode;if(!SP.ScriptUtility.isUndefined(a)){this.$4_1=a;delete b.ErrorCode}a=b.Status;if(!SP.ScriptUtility.isUndefined(a)){this.$1_1=SP.DataConvert.fixupType(null,a);delete b.Status}a=b.Url;if(!SP.ScriptUtility.isUndefined(a)){this.$5_1=a;delete b.Url}}};Type.registerNamespace("SP.UI.CollaborationMailbox");SP.UI.CollaborationMailbox.CollaborationMailboxControl=function(a){ULSBR8:;SP.UI.CollaborationMailbox.CollaborationMailboxControl.initializeBase(this,[a])};SP.UI.CollaborationMailbox.CollaborationMailboxControl.$$cctor=function(){ULSBR8:;SP.UI.CollaborationMailbox.CollaborationMailboxControl.$0[1]="ShowProvisionFrame";SP.UI.CollaborationMailbox.CollaborationMailboxControl.$0[2]="ShowManageFrame";SP.UI.CollaborationMailbox.CollaborationMailboxControl.$0[50]="NotSiteOwner";SP.UI.CollaborationMailbox.CollaborationMailboxControl.$0[51]="UnsupportedExchangeVersion";SP.UI.CollaborationMailbox.CollaborationMailboxControl.$0[52]="UnsupportedExchangeTopology";SP.UI.CollaborationMailbox.CollaborationMailboxControl.$0[53]="AutoDiscoverFailed";SP.UI.CollaborationMailbox.CollaborationMailboxControl.$0[54]="UnsupportedSharePointConfiguration";SP.UI.CollaborationMailbox.CollaborationMailboxControl.$0[55]="EwsClientMissing";SP.UI.CollaborationMailbox.CollaborationMailboxControl.$0[56]="WebUrlChanged";SP.UI.CollaborationMailbox.CollaborationMailboxControl.$0[57]="MailboxNotReady";SP.UI.CollaborationMailbox.CollaborationMailboxControl.$0[58]="MemberGroupsNotAvailable";SP.UI.CollaborationMailbox.CollaborationMailboxControl.$0[98]="ServiceError";SP.UI.CollaborationMailbox.CollaborationMailboxControl.$0[100]="LoadShowOwaFrame";SP.UI.CollaborationMailbox.CollaborationMailboxControl.$0[101]="LoadShowProvisionFrame";SP.UI.CollaborationMailbox.CollaborationMailboxControl.$0[102]="LoadShowManageFrame"};SP.UI.CollaborationMailbox.CollaborationMailboxControl.prototype={initializeMailboxControl:function(a){ULSBR8:;this.$6_2(a,null,null,0);(a<49||a>99)&&this.$8_2()},$8_2:function(){ULSBR8:;var a=Microsoft.SharePoint.Portal.CollaborationMailbox.getCollabMailboxViewInfo(SP.ClientContext.get_current()),b=this,c=this;SP.ClientContext.get_current().executeQueryAsync(function(){ULSBR8:;if(!a.$1_1||a.$1_1===1)window.location.replace(a.$5_1);else b.$6_2(a.$1_1,a.$2_1,a.$3_1,a.$4_1)},function(){ULSBR8:;c.$6_2(98,null,SP.ClientContext.get_current().get_traceCorrelationId(),0)})},$B_2:function($p0){var $v_0=SP.UI.CollaborationMailbox.CollaborationMailboxControl.$0[$p0],$v_1=eval(String.format("SpsClient.ScriptResources.collabMailbox_Status_{0}_Title",$v_0)),$v_2=eval(String.format("SpsClient.ScriptResources.collabMailbox_Status_{0}_Description",$v_0)),$v_3=String.format("<h1 id='{0}_stathead'>{1}</h1><p id='{0}_statdesc'>{2}</p>",this.get_element().id,$v_1,$v_2);return $v_3},$9_2:function($p0,$p1){if(!$p1||!$p1.length)return "";var $v_0=SP.UI.CollaborationMailbox.CollaborationMailboxControl.$0[$p0],$v_1=eval(String.format("SpsClient.ScriptResources.collabMailbox_Status_{0}_AlternateAddress",$v_0)),$v_2=String.format("<a href='{0}'>",$p1),$v_3=String.format($v_1,$v_2,"</a>"),$v_4=String.format("<p id='{0}_statlink'>{1}</p>",this.get_element().id,$v_3);return $v_4},$6_2:function(a,e,f,g){ULSBR8:;var c=this.$B_2(a),d=this.$9_2(a,e),b="";if(49<=a&&99>=a)b=this.$A_2(f,g);this.get_element().innerHTML=c+d+b},$A_2:function(b,d){ULSBR8:;var c=new Date,a="";if(b)a=String.format("<p id='{0}_corid'>{1}</p>",this.get_element().id,String.format(SpsClient.ScriptResources.collabMailbox_CorrelationId_Message,b,d));a+=String.format("<p id='{0}_datetime'>{1}</p>",this.get_element().id,c.toLocaleString());return a}};Microsoft.SharePoint.Portal.CollaborationMailbox.registerClass("Microsoft.SharePoint.Portal.CollaborationMailbox");Microsoft.SharePoint.Portal.CollaborationMailboxResponse.registerClass("Microsoft.SharePoint.Portal.CollaborationMailboxResponse",SP.ClientValueObject);SP.UI.CollaborationMailbox.CollaborationMailboxControl.registerClass("SP.UI.CollaborationMailbox.CollaborationMailboxControl",Sys.UI.Control);function sp_ui_collabmailbox_initialize(){ULSBR8:;SP.UI.CollaborationMailbox.CollaborationMailboxControl.$0=new Array(0);SP.UI.CollaborationMailbox.CollaborationMailboxControl.$$cctor()}sp_ui_collabmailbox_initialize();RegisterModuleInit("sp.ui.collabmailbox.js",sp_ui_collabmailbox_initialize);typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();NotifyScriptLoadedAndExecuteWaitingJobs("sp.ui.collabmailbox.js");_spApplicationPagesScriptLoaded=true;