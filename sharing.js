function $_global_sharing(){(function(){a:;var c=function(){};c.prototype={showSharingHintImages:false,showSharedWithNoneLink:false,appendCountToSharedWithListUserLinkId:false,appendCountToSharedWithMoreLinkId:false,sharedWithListDivId:"",sharedWithListDivClass:"",sharedWithListImageId:"",sharedWithListImageClass:"",sharedWithListInnerSpanId:"",sharedWithListInnerSpanClass:"",sharedWithListUserLinkId:"",sharedWithListUserLinkClass:"",sharedWithNoneLinkId:"",sharedWithNoneLinkClass:"",sharedWithMoreLinkId:"",sharedWithMoreLinkClass:"",sharedWithManyLinkId:"",sharedWithManyLinkClass:"",guestLinkDivId:"",guestLinkDivClass:"",guestLinkImageId:"",guestLinkImageClass:"",guestLinkInnerSpanId:"",guestLinkInnerSpanClass:"",guestLinkId:"",guestLinkClass:"",guestLinkOnClickCallback:""};function k(e,d){var a=new c;if(e){a.showSharingHintImages=true;a.showSharedWithNoneLink=true;a.appendCountToSharedWithListUserLinkId=true;a.appendCountToSharedWithMoreLinkId=true;a.sharedWithListDivClass="ms-core-form-line ms-textSmall";a.sharedWithListImageId="js-sharingdlg-imageUserAccess";a.sharedWithListImageClass="ms-verticalAlignTop";a.sharedWithListInnerSpanId="js-sharingdlg-labelUserAccess";a.sharedWithListInnerSpanClass="ms-aclinv-label ms-verticalAlignTop ms-soften";a.sharedWithListUserLinkId="js-sharingdlg-user";a.sharedWithNoneLinkId="js-sharingdlg-notshared";a.sharedWithNoneLinkClass="js-sharingdlg-sharedWithLink";a.sharedWithMoreLinkId="js-sharingdlg-nmore-";a.sharedWithMoreLinkClass="js-sharingdlg-sharedWithLink";a.sharedWithManyLinkId="js-sharingdlg-lotspeople";a.sharedWithManyLinkClass="js-sharingdlg-sharedWithLink";a.guestLinkDivId="js-sharingdlg-guestLinkDiv";a.guestLinkDivClass="ms-core-form-line ms-textSmall";a.guestLinkImageId="js-sharingdlg-imageGuestLink";a.guestLinkImageClass="ms-verticalAlignTop";a.guestLinkInnerSpanId="js-sharingdlg-labelGuestLink";a.guestLinkInnerSpanClass="ms-aclinv-label ms-verticalAlignTop ms-soften";a.guestLinkId="js-sharingdlg-guestLink";a.guestLinkClass="js-sharingdlg-guestLink";a.guestLinkOnClickCallback="ManageLink();"}else{var b="";if(m$.isDefinedAndNotNull(d))b=GetCalloutElementIDFromCallout(d);a.sharedWithListDivClass="js-callout-sharedWithList";a.sharedWithListUserLinkClass="js-callout-sharedWithDisplayNameLink";a.showSharedWithNoneLink=true;a.sharedWithNoneLinkId=b+"js-callout-notshared";a.sharedWithNoneLinkClass="js-callout-sharedWithLink";a.sharedWithMoreLinkId=b+"SharedWithLink";a.sharedWithMoreLinkClass="js-callout-sharedWithLink";a.sharedWithManyLinkId=b+"SharedWithLink";a.sharedWithManyLinkClass="js-callout-sharedWithLink";a.guestLinkDivClass="js-callout-sharedWithManageLinks";a.guestLinkId=b+"GuestLink";a.guestLinkClass="js-callout-sharedWithGuestLink"}return a}function a(c,a){var b="";if(m$.isDefinedAndNotNull(a)&&a.length>0)b=" "+c+"="+StAttrQuote(a)+" ";return b}GetSharingStatusHtml=function(g,s,m,r,y,C,u,F,E){var c=k(y,E),d=[],f="";if(g.length===0&&!m&&!s){if(!r){var l="",j="";if(c.showSharedWithNoneLink){l='<a href="#" onclick="return false;"'+a("id",c.sharedWithNoneLinkId)+a("class",c.sharedWithNoneLinkClass)+">";j="</a>"}d.push(l,Strings.STS.L_SharedWithNone,j);f="js-sharingHint-unshared"}}else{f="js-sharingHint-sharedDefault";var h="";if(isDefinedAndNotNullOrEmpty(u))h=StBuildParam(Strings.STS.L_SharedWithTooltip,u);if(m||s){var x='<a href="#" onclick="return false;"'+a("id",c.sharedWithManyLinkId)+a("title",h)+a("class",c.sharedWithManyLinkClass)+">",w="</a>";d.push(StBuildParam(STSHtmlEncode(Strings.STS.L_SharedWithMany),x,w))}else{for(var B={HasUserLink:true,DefaultRender:true,AllowMultipleValues:true,InlineRender:true,InlineRenderMoreAsLink:true},D={EffectivePresenceEnabled:"1",PresenceAlt:Strings.STS.L_UserFieldNoUserPresenceAlt,UserDispUrl:C},o=[],p=g.length,i=0;i<p;i++)o.unshift(g[i]);var e=document.createElement("div"),A=new UserFieldRenderer("SharedWith");e.innerHTML=A.RenderField(F,B,{SharedWith:o},D);var v=0,t=m$(e).find(".ms-imnSpan");t.forEach(function(d){var b=c.sharedWithListUserLinkClass,a=c.sharedWithListUserLinkId;if(c.appendCountToSharedWithListUserLinkId)a+=String(t.length-v);if(m$.isDefinedAndNotNull(a)&&a.length>0)d.id=a;m$.isDefinedAndNotNull(b)&&b.length>0&&m$(d).addClass(b);v++});var z=m$(e).find(".ms-imnMoreLink");z.forEach(function(e){var g=p-3,f=c.sharedWithMoreLinkId;if(c.appendCountToSharedWithMoreLinkId)f+=String(g);var b=c.sharedWithMoreLinkClass,a=h,d=f;if(m$.isDefinedAndNotNull(d)&&d.length>0)e.id=d;m$.isDefinedAndNotNull(b)&&b.length>0&&m$(e).addClass(b);if(m$.isDefinedAndNotNull(a)&&a.length>0)e.title=a});d.push(StBuildParam(STSHtmlEncode(Strings.STS.L_SharedWithUsers),e.innerHTML))}}if(d.length>0){d.unshift("<span",a("id",c.sharedWithListInnerSpanId),a("class",c.sharedWithListInnerSpanClass),">");d.push("</span>");var q="";if(c.showSharingHintImages){q=b(c.sharedWithListImageClass,f,c.sharedWithListImageId);d.unshift(q)}d.unshift("<div",a("id",c.sharedWithListDivId),a("class",c.sharedWithListDivClass),">");d.push("</div>")}if(r){var n="";if(c.showSharingHintImages)n=b(c.guestLinkImageClass,"js-sharingHint-sharedAnonymously",c.guestLinkImageId);d.push("<div",a("id",c.guestLinkDivId),a("class",c.guestLinkDivClass),">",n,"<span",a("id",c.guestLinkInnerSpanId),a("class",c.guestLinkInnerSpanClass),">",StBuildParam(STSHtmlEncode(Strings.STS.L_SharedWithGuest),'<a href="#"'+a("onclick",c.guestLinkOnClickCallback+"return false;")+a("id",c.guestLinkId)+a("title",Strings.STS.L_SharedWithGuestTooltip)+a("class",c.guestLinkClass)+">","</a>"),"</span>","</div>")}return d.join("")};function b(d,b,e){var c=["<span ",a("class","js-sharingHint-iconContainer "+d),"><img ",a("class",b),a("id",e),a("src",GetThemedImageUrl("spcommon.png")),"></img></span>"];return c.join("")}ApplySharingListStyles=function(a){m$.isFunction(ProcessImn)&&ProcessImn();var c=function(){if(typeof a.calloutRenderCtx!=="undefined"&&a.calloutRenderCtx!==null){var q=CalloutManager.getFromCalloutDescendant(a),b=a.calloutRenderCtx,l=b.HttpRoot,e=b.listName,c=b.CurrentItem.ID,d=b.CurrentItem.FileLeafRef;if(m$.isUndefinedOrNull(d)||d.length===0)d=b.CurrentItem.Title;var p=function(){a:;m$(document).trigger("SharingEvents.SharingModified",e,c)},j=function(a){q.close();var b=a.get_canManagePermissions(),f=a.get_anonymousEditLink(),g=a.get_anonymousViewLink(),h=new ManageLinkParams(l,e,c,d,f,g,b,p);DisplayManageLinkDialog(h)};if(typeof a.objectSharingInformation!=="undefined"&&a.objectSharingInformation!==null)j(a.objectSharingInformation);else{var f=new SP.ClientContext(l),m=f.get_web(),g=m,i=null,h=null;if(e.length>0){i=m.get_lists().getById(e);if(c.length>0){h=i.getItemById(c);g=h}else{h=null;g=i}}var k=SP.ObjectSharingInformation.getObjectSharingInformation(f,g,false,false,false,true,false,false,false);f.load(k,"CanManagePermissions","AnonymousEditLink","AnonymousViewLink");var n=function(){a:;j(k)},o=function(){};f.executeQueryAsync(n,o)}}return false};m$(a).find(".js-callout-sharedWithGuestLink").click(c);m$(a).css({display:"block"});var b=window.top.g_childDialog;m$.isDefinedAndNotNull(b)&&b.autoSize()};NavigateToRootLibraryWithoutQueryString=function(){a:;var a=ajaxNavigate.get_href(),b=a.indexOf("?");if(b>-1){a=a.substring(0,b);STSNavigate(a)}};var o=450;DisplaySharingDialog=function(c,a,b){if(!c.endsWith("/"))c+="/";var d=[c,"_layouts/15/aclinv.aspx","?forSharing=1"];if(m$.isDefinedAndNotNull(a)&&a.length>0){d.push("&List=",escapeProperly(a));m$.isDefinedAndNotNull(b)&&b.length>0&&d.push("&obj=",a,",",b,",DOCUMENT")}var h=d.join(""),f=function(d){var f=new URI(ajaxNavigate.get_href()),e=f.getQueryParameter("sharingDialogForListItemId");if(e)NavigateToRootLibraryWithoutQueryString();else if(d===SP.UI.DialogResult.OK)m$(document).trigger("SharingEvents.SharingAdded",a,b);else d===100&&DisplaySharedWithDialog(c,a,b)},e={};e.LaunchedWithCallback=true;var g={url:h,dialogReturnValueCallback:f,args:e,autoSizeStartWidth:o};OpenPopUpPageWithDialogOptions(g)};var j=450,i=300,h=350;DisplaySharedWithDialog=function(c,b,a,e,d){var f=_dlgWndTop();if(Boolean(f)&&f!=window&&typeof f.EnsureScriptParams=="function"){f.EnsureScriptParams("sharing.js","DisplaySharedWithDialog",c,b,a,e,d);return}if(!c.endsWith("/"))c+="/";if(m$.isUndefinedOrNull(b))b="";if(m$.isUndefinedOrNull(a))a="";if(m$.isUndefinedOrNull(e))e=false;if(m$.isUndefinedOrNull(d))d=false;if(a.length>0)typeof CalloutManager!=="undefined"&&CalloutManager!==null&&CalloutManager.closeAll();EnsureScriptFunc("SP.js","SP.ClientContext",function(){a:;EnsureScriptFunc("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",function(){a:;var u=null,R=["<img src=",StAttrQuote("/_layouts/15/images/progress-circle-24.gif?rev=23"),'class="js-sharing-fullListDialogWaitImg" id=',StAttrQuote("sl-waitImg"+a)," onclick="+StAttrQuote("this.style.display='none'"),"/>",'<div class="js-sharing-fullListDialogStatusBar" id='+StAttrQuote("sl-StatusBar"+a)+">","</div>",'<div class="js-sharing-fullListDialogCommandsTop">','<span class="js-sharing-fullListDialogManageGuestLinks ms-textSmall ms-soften">','<span class="js-sharingHint-iconContainer ms-verticalAlignMiddle">','<img class="js-sharingHint-sharedAnonymously"'," src=",StAttrQuote(GetThemedImageUrl("spcommon.png")),"></img>","</span>",StBuildParam(STSHtmlEncode(Strings.STS.L_SharedWithGuest),"<a id="+StAttrQuote("sl-ManageGuestLinks"+a)+' href="#" onclick="return false;">',"</a>"),"</span>","</div>",'<div class="js-sharing-fullListDialog">',"</div>",'<div class="js-sharing-fullListDialogCommandsLeft">','<a href="#" onclick="return false;" id=',StAttrQuote("sl-InviteLink"+a),' class="js-sharing-fullListDialogCommandInvite ms-calloutLink">',STSHtmlEncode(Strings.STS.L_SharedWithDialogInvitePeople),"</a>",'<a href="#" onclick="return false;" id=',StAttrQuote("sl-EmailLink"+a),' class="js-sharing-fullListDialogCommandEmail ms-calloutLink">',STSHtmlEncode(Strings.STS.L_SharedWithDialogEmailEveryone),"</a>",'<a href="#" onclick="return false;" id=',StAttrQuote("sl-AdvancedLink"+a),' class="js-sharing-fullListDialogCommandAdvanced ms-calloutLink">',STSHtmlEncode(Strings.STS.L_SharedWithDialogAdvanced),"</a>","</div>",'<div class="js-sharing-fullListDialogCommandsRight">','<span class="js-sharing-fullListDialogApplyText ms-textXSmall" id=',StAttrQuote("sl-applyText"+a),"></span>","<img src=",StAttrQuote("/_layouts/15/images/loadingcirclests16.gif?rev=23"),' class="js-sharing-fullListDialogApplyWaitImg" id=',StAttrQuote("sl-applyWaitImg"+a)," onclick="+StAttrQuote("this.style.display='none'"),"/>","<button id=",StAttrQuote("sl-OKButton"+a),' class="js-sharing-fullListDialogCommandApply" disabled="disabled">',STSHtmlEncode(Strings.STS.L_SharedWithDialogApply),"</button>","<button id=",StAttrQuote("sl-CloseButton"+a),' class="js-sharing-fullListDialogCommandCancel">',STSHtmlEncode(Strings.STS.L_SharedWithDialogCancel),"</button>","</div>"].join(""),n=document.createElement("div");n.className="js-sharing-fullListDialogContainer";n.id="sl-Container"+a;n.innerHTML=R;m$(n).click(MenuHtc_hide);m$(n).find(".js-sharing-fullListDialog").scroll(MenuHtc_hide);var V={html:n,title:Strings.STS.L_SharedWithDialogTitle,allowMaximize:false,includeScrollBarPadding:false,autoSizeStartWidth:j};u=SP.UI.ModalDialog.showModalDialog(V);var H=document.getElementById("sl-waitImg"+a),q=document.getElementById("sl-applyText"+a),o=document.getElementById("sl-applyWaitImg"+a),y=document.getElementById("sl-InviteLink"+a),F=document.getElementById("sl-EmailLink"+a),D=document.getElementById("sl-AdvancedLink"+a),p=document.getElementById("sl-OKButton"+a),E=document.getElementById("sl-CloseButton"+a),C=document.getElementById("sl-ManageGuestLinks"+a),t=m$(n).find(".js-sharing-fullListDialog")[0],A=[],v=false,w="",x="",B="";m$(y).click(function(){a:;SP.UI.ModalDialog.commonModalDialogClose(SP.UI.DialogResult.OK,null);var d=typeof window.top.g_childDialog!="undefined"?window.top.g_childDialog:undefined;Boolean(d)&&d.close(SP.UI.DialogResult.cancel);DisplaySharingDialog(c,b,a);return false});m$(D).click(function(){a:;var d=[c,"_layouts/15/User.aspx","?"];if(m$.isDefinedAndNotNull(b)&&b.length>0){d.push("List=",escapeProperly(b));m$.isDefinedAndNotNull(a)&&a.length>0&&d.push("&obj=",b,",",a,",LISTITEM")}var e=d.join("");e=AddSourceToUrl(e);STSNavigate(e);return false});m$(p).click(function(){a:;if(m$.isDefinedAndNotNull(o))o.style.display="inline";W()});m$(E).click(function(){a:;SP.UI.ModalDialog.commonModalDialogClose(SP.UI.DialogResult.OK,null)});E.focus();var k=new SP.ClientContext(c),r=k.get_web(),z=r,l=null,g=null,s=null;if(b.length>0){b=unescapeProperly(b);l=r.get_lists().getById(b);if(a.length>0){g=l.getItemById(a);z=g}else{g=null;z=l}}else{l=null;g=null}k.load(r,"Title","ServerRelativeUrl");if(m$.isDefinedAndNotNull(l)){k.load(l,"BaseType","Title");s=l.get_rootFolder();m$.isDefinedAndNotNull(s)&&k.load(s,"ServerRelativeUrl")}m$.isDefinedAndNotNull(g)&&k.load(g,"ID","FileRef","FileLeafRef","Title");var m=SP.ObjectSharingInformation.getObjectSharingInformation(k,z,false,false,false,true,true,true,!e),G=m.getSharedWithUsers(k);k.load(m,"IsSharedWithGuest","CanManagePermissions","AnonymousEditLink","AnonymousViewLink","HasPendingAccessRequests","PendingAccessRequestsLink","HasPermissionLevels");k.load(G);var K=function(){a:;var l=m.get_isSharedWithGuest(),h=m.get_hasPendingAccessRequests();v=m.get_canManagePermissions();w=m.get_anonymousEditLink();x=m.get_anonymousViewLink();var d=m.get_hasPermissionLevels(),f=G.getEnumerator(),g=0;while(f.moveNext()){var a=f.get_current(),e=a.get_id(),C=a.get_name(),c=a.get_email(),y=a.get_picture(),z=a.get_jobTitle(),s=a.get_department(),D=a.get_sipAddress(),o=a.get_customRoleNames(),j=a.get_hasEditPermission(),k=a.get_hasViewPermission(),r=a.get_isSiteAdmin(),i=P({id:e,title:C,email:c,pictureURL:y,sip:D,jobTitle:z,department:s},d),n=d?S(e,a,r,o,j,k):null,p=T(i,n,e);t.appendChild(p);m$.isDefinedAndNotNull(c)&&c.length>0&&A.push(escapeProperly(c));g++}var q=30;if(g>=q){var b=document.createElement("DIV");b.className="js-sharing-fullListDialogEntry js-sharing-fullListDialogEntrySharedWithMany ms-soften";b.id="sharingListEntry_many";b.innerHTML=STSHtmlEncode(Strings.STS.L_SharedWithDialogManyMessage);t.appendChild(b)}if(h){B=m.get_pendingAccessRequestsLink();I()}l&&(Boolean(w)||Boolean(x))&&N();u.autoSize();Q(!d)},M=function(c,b){if(m$.isDefinedAndNotNull(t)){var a=document.createElement("SPAN");a.innerHTML=b.get_message();t.appendChild(a);H.style.display="none"}};k.executeQueryAsync(K,M);var I=function(){a:;var d=[STSHtmlEncode(Strings.STS.L_SharedWithDialogPendingAccessRequests)," <a href=",StAttrQuote(B)," onclick='STSNavigate(this.href);return false;'",">",STSHtmlEncode(Strings.STS.L_SharedWithDialogViewAccessRequests),"</a>"].join(""),e=_createStatusMarkup("",d,false),b=document.createElement("SPAN");b.className=StatusBarClassNames[StatusPriority.yellow]+" ms-status-msg";b.style.display="block";b.appendChild(e);var c=document.getElementById("sl-StatusBar"+a);c.appendChild(b);c.style.display="block"},N=function(){a:;C.parentNode.style.display="inline-block";m$(C).click(function(){a:;u.close();var d=g.get_item("FileLeafRef");if(m$.isUndefinedOrNull(d)||d.length===0)d=g.get_item("Title");var e=new ManageLinkParams(c,b,a,d,w,x,v);DisplayManageLinkDialog(e);return false})},Q=function(a){if(!d&&(m$.isUndefinedOrNull(l)||m$.isUndefinedOrNull(g)||m$.isDefinedAndNotNull(g)&&l.get_baseType()==1))y.style.display="inline";else y.style.display="none";U();if(a)p.style.visibility="hidden";else{p.style.visibility="visible";p.disabled=true}if(!a||v)D.style.display="inline";H.style.display="none";window.setTimeout(function(){a:;m$.isFunction(ProcessImn)&&ProcessImn()},0);u.autoSize()},f={edit:"edit",view:"view",custom:"custom",none:"none"},W=function(){a:;var a=[];m$(n).find(".js-sharing-fullListDialogEntryPermissionsInnerContainer").forEach(function(b){if(b.currentSelection!==b.initialSelection){var e=b.loginName,c;switch(b.currentSelection){case f.edit:c=SP.Sharing.Role.edit;break;case f.view:c=SP.Sharing.Role.view;break;case f.none:c=SP.Sharing.Role.none;break;default:return}}b.initialSelection=b.currentSelection;if(b.currentSelection!==f.custom)b.actualPermission=null;var d=new SP.Sharing.UserRoleAssignment;d.set_userId(e);d.set_role(c);a.push(d)});a.length>0&&O(a,function(){a:;p.disabled=true})},U=function(){a:;if(A.length>0){F.style.display="inline";var a=[];a.push("mailto:");a.push(A.join(";"));var b=null,d=null;if(m$.isDefinedAndNotNull(g))if(l.get_baseType()==1){b=g.get_item("FileLeafRef");d=getHostUrl(c)+g.get_item("FileRef")}else b=g.get_item("Title");else if(m$.isDefinedAndNotNull(l)){b=l.get_title();if(m$.isDefinedAndNotNull(s))d=getHostUrl(ajaxNavigate.get_href())+s.get_serverRelativeUrl()}else if(m$.isDefinedAndNotNull(r)){b=r.get_title();d=getHostUrl(ajaxNavigate.get_href())+r.get_serverRelativeUrl()}(m$.isDefinedAndNotNull(b)||m$.isDefinedAndNotNull(d))&&a.push("?");var e=false;if(m$.isDefinedAndNotNull(b)){a.push("subject=");a.push(escapeProperly(b));e=true}if(m$.isDefinedAndNotNull(d)){e&&a.push("&");a.push("body=");a.push(encodeURIComponent(encodeURI(d)))}m$(F).click(function(){a:;window.location.href=a.join("");return false})}},O=function(a,d){var b=getHostUrl(c)+g.get_item("FileRef");SP.Sharing.DocumentSharingManager.updateDocumentSharingInfo(k,b,a,false,false,false,null,false);k.executeQueryAsync(function(){a:;J(d)},L)},J=function(c){if(m$.isDefinedAndNotNull(o)){o.style.display="none";!q.hasChildNodes()&&q.appendChild(document.createTextNode(Strings.STS.L_SharedWithDialogApplySuccessText));q.style.display="inline";q.style.opacity=1;var d=function(){a:;SPAnimationUtility.BasicAnimator.FadeOut(q,function(){a:;q.style.display="none";o.style.display="none"})};window.setTimeout(d,500)}m$(document).trigger("SharingEvents.SharingModified",b,a);m$.isDefinedAndNotNull(c)&&c()},L=function(){a:;if(m$.isDefinedAndNotNull(o))o.style.display="none";alert(Strings.STS.L_SharedWithDialogApplyUpdatedPermissionsFailed)},P=function(b,f){var d=document.createElement("div");d.className="js-sharing-fullListDialogEntryNameAndTitleContainer";var e=new ContextInfo;e.Templates={};e.Templates.Fields={};var g={Field:[{Name:"SharedWith",FieldType:"User",RealFieldName:"SharedWith",WithPicture:"1",PictureSize:"Size_48px",WithPictureDetail:"1",HasUserLink:"1",Type:"User",MaxWidth:f?i:h}],EffectivePresenceEnabled:"1",PresenceAlt:Strings.STS.L_UserFieldNoUserPresenceAlt,UserDispUrl:c+"_layouts/15/userdisp.aspx"},j={ID:a,SharedWith:[{id:b.id,title:b.title,email:b.email,picture:b.pictureURL,sip:b.sip,jobTitle:b.jobTitle,department:b.department}]},k=spMgr.RenderFieldByName(e,"SharedWith",j,g);d.innerHTML=k;return d},S=function(h,i,g,e,j,k){var c=document.createElement("div");c.className="js-sharing-fullListDialogEntryPermissionsContainer";var a;if(g)a=document.createElement("span");else{a=document.createElement("a");a.href="#";a.onclick=function(){a:;return false}}a.className="js-sharing-fullListDialogEntryPermissionsInnerContainer";a.id="sl-permissionsMenuElement"+h;c.appendChild(a);if(g)a.innerHTML=STSHtmlEncode(Strings.STS.L_SharedWithDialogOwnerPermission);else{m$(a).addClass("js-sharing-fullListDialogEntryPermissionsMenu");var d=document.createElement("span");m$(d).addClass("js-sharing-fullListDialogEntryPermissionsText");a.appendChild(d);var b=document.createElement("img");m$(b).addClass("js-sharing-fullListDialogEntryPermissionsMenuArrow");b.src="/_layouts/15/images/ecbarw.png?rev=23";b.alt=Strings.STS.L_OpenMenu_Text;a.appendChild(b);m$(a).click(function(g){var a=m$(g.target).closest(".js-sharing-fullListDialogEntryPermissionsMenu")[0],d="sl-permissionsMenu"+h,e=CMenu(d),c=function(c){var b="";switch(c){case f.edit:b=Strings.STS.L_EditPermission;break;case f.view:b=Strings.STS.L_ViewPermission;break;case f.custom:b=a.actualPermission;break;case f.none:b=Strings.STS.L_StopSharing}CAMOpt(e,b,'SetSelectedPermission("'+c+'", "'+a.id+'");')};c(f.edit);c(f.view);isDefinedAndNotNullOrEmpty(a.actualPermission)&&c(f.custom);c(f.none);var b=document.createElement("span");b.id=d;b.style.position="absolute";a.appendChild(b);var j=m$(a).offset().left,i=m$(a).offset().bottom;m$(b).offset({left:j,top:i});MenuHtc_hide();OMenu(e,b,undefined,false);g.stopPropagation();return false});if(isDefinedAndNotNullOrEmpty(e)){a.initialSelection=f.custom;a.actualPermission=e}else if(j)a.initialSelection=f.edit;else if(k)a.initialSelection=f.view;a.loginName=i.get_loginName();SetSelectedPermission(a.initialSelection,a)}return c};SetSelectedPermission=function(c,a){if(!m$.isElement(a))a=document.getElementById(a);if(a.currentSelection!==c){var b="";switch(c){case f.edit:b=Strings.STS.L_EditPermission;break;case f.view:b=Strings.STS.L_ViewPermission;break;case f.custom:b=a.actualPermission;break;case f.none:b=Strings.STS.L_StopSharing}m$(a).find(".js-sharing-fullListDialogEntryPermissionsText")[0].innerHTML=STSHtmlEncode(b);a.currentSelection=c;p.disabled=false}a.focus()};var T=function(d,b,c){var a=document.createElement("div");a.className="js-sharing-fullListDialogEntry";if(m$.isDefinedAndNotNull(c))a.id="sharingListEntry_"+c;a.appendChild(d);m$.isDefinedAndNotNull(b)&&a.appendChild(b);return a}})})};var q="<div class='ms-table ms-manageLink-table'>",t=["<div class='ms-tableRow'>","<div class='ms-tableCell ms-manageLink-cell'><div class='ms-manageLink-column ms-accentText'>{0}</div></div>","<div class='ms-tableCell ms-manageLink-cell'><div class='ms-manageLink-column' id='{1}'><input type='text' class='ms-manageLink-url ms-noWrap' value='{2}' title='{3}' readonly='readonly' onmousedown='SelectOnFocus(this, event);'/>","<span style='display:none' class='ms-manageLink-progress'><img class='ms-manageLink-progress-img' src='","/_layouts/15/images/loadingcirclests16.gif?rev=23","' onclick='javascript:style.display=\"none\";' alt=",StAttrQuote(Strings.STS.L_Sharing_ManageLink_ProgressTooltip),"/><span>",STSHtmlEncode(Strings.STS.L_Sharing_ManageLink_ProgressText),"</span></span>","</div></div>","<div class='ms-tableCell' style='display:{4}'><a href='#' onclick='OnDisableLink({6}, this);return false;'><img id='{5}' class='ms-manageLink-table-img' src='","/_layouts/15/images/delete.gif?rev=23","'/></a></div></div>"],s="<div class='ms-core-form-bottomButtonBox ms-manageLink-buttonrow'><button onclick='DismissTopDlg(0);' id='js-manageLink-CloseBtn'>"+STSHtmlEncode(Strings.STS.L_CloseButtonCaption)+"</button></div>",f="js-manageLinkUrl-",e="js-manageLink-deletelink-";ManageLinkParams=function(b,a,j,h,g,i,e,f){if(!b.endsWith("/"))b+="/";var c=a.indexOf("{"),d=a.indexOf("}");if(c>=0&&d>=0)a=a.substring(c+1,d);this.webUrl=b;this.listId=a;this.itemId=j;this.itemName=h;this.editLink=g;this.viewLink=i;this.allowDisableLink=e;this.onReturnCallback=f};ManageLinkParams.prototype={webUrl:undefined,listId:undefined,itemId:undefined,itemName:undefined,editLink:undefined,viewLink:undefined,allowDisableLink:undefined,onReturnCallback:undefined};DisplayManageLinkDialog=function(a){if(!Boolean(a))return;var b=q,c=a.allowDisableLink?"":"none",k=STSHtmlEncode(Strings.STS.L_Sharing_ManageLink_ViewOnlyLabel),j=STSHtmlEncode(Strings.STS.L_Sharing_ManageLink_EditLabel),g=t.join("");if(Boolean(a.viewLink))b+=String.format(g,k,f+"View",a.viewLink,a.viewLink,c,e+"View","false");if(Boolean(a.editLink))b+=String.format(g,j,f+"Edit",a.editLink,a.editLink,c,e+"Edit","true");b+="</div>";b+=s;var h=String.format(Strings.STS.L_Sharing_ManageLink_Title,a.itemName),d=document.createElement("DIV");d.innerHTML=b;var l={html:d,showClose:true,title:h,dialogReturnValueCallback:a.onReturnCallback,args:a},i=function(){a:;var b=new SP.UI.ModalDialog.showModalDialog(l),a=window.top.document.getElementById("js-manageLink-CloseBtn");Boolean(a)&&a.focus()};EnsureScriptFunc("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",i)};SelectOnFocus=function(a,b){Boolean(a)&&a.select();cancelDefault(b)};DismissTopDlg=function(b){var a=window.top.g_childDialog;Boolean(a)&&a.close(b)};OnDisableLink=function(b,c){var a=null,e="js-manageLinkUrl-"+(b?"Edit":"View");a=document.getElementById(e);var d=function(f){a:;if(f==SP.UI.DialogResult.OK){a!=null&&n(c,a,b);var d=commonModalDialogGetArguments();Boolean(d)&&p(c,a,b,d)}var e=document.getElementById("js-manageLink-CloseBtn");Boolean(e)&&e.focus()};l(d)};function m(){a:;var a=commonModalDialogGetArguments(),c=Boolean(a)&&Boolean(a.editLink)?g(true):true,d=Boolean(a)&&Boolean(a.viewLink)?g(false):true,b=SP.UI.ModalDialog.get_childDialog();if(Boolean(b)){var e={editLinkDisabled:c,viewLinkDisabled:d};b.set_returnValue(e)}}var r=["<div>",STSHtmlEncode(Strings.STS.L_Sharing_ManageLink_ConfirmText),"</div>","<div class='ms-core-form-bottomButtonBox'>","<button id='js-disableLinkBtn' onclick='DismissTopDlg(1)'>",STSHtmlEncode(Strings.STS.L_Sharing_ManageLink_ConfirmButtonOK),"</button>","<button id='js-keepLinkBtn' onclick='DismissTopDlg(0)'>",STSHtmlEncode(Strings.STS.L_Sharing_ManageLink_ConfirmButtonCancel),"</button></div>"];function l(c){a:;var b=document.createElement("DIV");b.innerHTML=r.join("");var d={html:b,title:Strings.STS.L_Sharing_ManageLink_ConfirmTitle,dialogReturnValueCallback:c},e=new SP.UI.ModalDialog.showModalDialog(d),a=document.getElementById("js-keepLinkBtn");Boolean(a)&&a.focus()}function n(d,c){var a=c.firstChild,b=a.nextSibling;if(a!=null&&b!=null){a.style.display="none";b.style.display="";d.style.display="none"}}function d(c,e,f,d){var a=e.firstChild,b=a.nextSibling;if(a!=null&&b!=null){if(d){a.value=Strings.STS.L_Sharing_ManageLink_DisabledText;a.title="";c.style.display="none"}else c.style.display="";a.style.display="";b.style.display="none";m()}}function p(f,e,c,b){var a=[];a.push(b.webUrl);a.push("_layouts/15/aclinv.aspx");a.push("?obj=");a.push("{");a.push(b.listId);a.push("},");a.push(b.itemId);a.push(",DOCUMENT");a.push("&List=");a.push(escapeProperly(b.listId));a.push("&command=disablelink");a.push("&readwrite=");a.push(String(c));var g=function(g){if(g.status!=200){var a=g.getResponseHeader("SharePoint-DestroySharingLink-Error");if(!Boolean(a)||a=="")a=Strings.STS.L_Sharing_ManageLink_DefaultError;var h=b.webUrl+"_layouts/15/error.aspx?ErrorText="+a;OpenPopUpPageWithTitle(h,null,null,null,Strings.STS.L_Sharing_ManageLink_ErrorTitle);g.onreadystatechange=null;d(f,e,c,false)}else d(f,e,c,true)};SendAjaxFormPostWithFormDigest(a.join(""),null,g)}function g(d){var a=false,c=document.getElementById("js-manageLinkUrl-"+(d?"Edit":"View"));if(Boolean(c)){var b=c.firstChild;if(Boolean(b))a=b.value==Strings.STS.L_Sharing_ManageLink_DisabledText}return a}m$.isDefinedAndNotNull(Sys)&&m$.isDefinedAndNotNull(Sys.Application)&&Sys.Application.notifyScriptLoaded();m$.isFunction(NotifyScriptLoadedAndExecuteWaitingJobs)&&NotifyScriptLoadedAndExecuteWaitingJobs("sharing.js")})()}function ULSoNk(){var a={};a.ULSTeamName="Microsoft SharePoint Foundation";a.ULSFileName="sharing.commentedjs";return a}var GetSharingStatusHtml,ApplySharingListStyles,DisplaySharingDialog,NavigateToRootLibraryWithoutQueryString,DisplaySharedWithDialog,SetSelectedPermission,ManageLinkParams,DisplayManageLinkDialog,OnDisableLink,DismissTopDlg,SelectOnFocus;$_global_sharing();