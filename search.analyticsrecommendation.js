Type.registerNamespace("Srch");Srch.HashTagDataView=function(a){Srch.HashTagDataView.initializeBase(this,[a])};Srch.HashTagDataView.prototype={count:function(){return 6},get_ensureSocialFollowingManager:function(){if(!this.$I_1)this.$I_1=new SP.Social.SocialFollowingManager(Srch.ScriptApplicationManager.get_clientRuntimeContext());return this.$I_1},$I_1:null,buildDataSet:function(a){return this.buildNextDataSet(a,0)},getPivots:function(){return null},buildView:function(l){var d=l,e=d.$9_1;if(e){var b=e.split("|");if(b.length===3){var f=b[2],a=b[1];if(a.length>1)a=a.substr(2);var c=d.$E_0,g="?TermID="+a,h=Srch.DataView.getHostUrl()+SP.Utilities.VersionUtility.getLayoutsPageUrl("HashTagProfile.aspx")+g,i='<a class="ms-textLarge ms-subtleLink" href="'+h+'">'+f+"</a>",j='<div style="max-width: 250px;" class="ms-noWrap">'+i+"</div>",k=c&&c.length>0?'<div style="max-width: 250px;" class="ms-noWrap ms-metadata">'+c+"</div>":"";return "<div>"+j+k+"</div>"}}return ""},$O_1:function(a){var e,f=a.$0_0?"ms-contentFollowing-followingImg":"ms-contentFollowing-notFollowingImg",g='<img class="{1}" src="/_layouts/15/images/socialcommon.png" {0}>',h='<span class="ms-contentFollowing-followingSpan s4-clust ms-promotedActionButton-icon">{0}</span>',i='<span class="ms-metadata" style="vertical-align:bottom;">{0}</span>',b,c;if(!a.$8_1){var d;if(!a.$0_0)d=Srch.AnalyticsRecommendation.strIsNotFollowed;else d=Srch.AnalyticsRecommendation.strIsFollowed;b=String.format(g,"",f);c=String.format(h,b);var j=String.format(i,d);return c+j}else{b=String.format(g,Srch.AnalyticsRecommendation.strFollow,f);e="title='"+String.format(Srch.AnalyticsRecommendation.strStopFollowing,a.$9_1)+"'";c=String.format(h,b);var k="onclick=\"Srch.AnalyticsRecommendation.handleTagFollow('"+this.$4_0.$1_0+"', '"+a.$A_0+"', this); return false;\"",l=String.format(i,Srch.AnalyticsRecommendation.strFollow),m="<a "+e+' class="ms-subtleLink" '+k+">"+c+l+"</a>";return m}},doFollow:function(b,f){var c=b,d=this.get_ensureSocialFollowingManager(),a=new SP.Social.SocialActorInfo;a.set_actorType(3);a.set_tagGuid(new SP.Guid(c.$8_1));try{if(!b.$0_0)d.follow(a);else d.stopFollowing(a);b.$0_0=!b.$0_0;f.parentNode.innerHTML=this.$O_1(c)}catch(e){}}};Srch.AnalyticsRecommendation=function(b,c,a){this.$$d_$Q_0=Function.createDelegate(this,this.$Q_0);this.$G_0=Srch.AnalyticsRecommendation.strNoResults;if(SP.ScriptUtility.isNullOrEmptyString(a))a=null;this.$1_0=b;this.$6_0=c;this.$H_0=a};Srch.AnalyticsRecommendation.doRecommend=function(a,b,c){var d=Srch.AnalyticsRecommendation.$J(a);d.$L_0(b,c);return false};Srch.AnalyticsRecommendation.ensureObject=function(b,d,c){var a=Srch.AnalyticsRecommendation.$J(b);if(!a){a=new Srch.AnalyticsRecommendation(b,d,c);Array.add(Srch.AnalyticsRecommendation.$F,a);Srch.AnalyticsRecommendation.$K++}a.$S_0()};Srch.AnalyticsRecommendation.handleTagFollow=function(b,f,c){var a=Srch.AnalyticsRecommendation.$J(b),d=a.$C_0(),e=a.$7_0.findId(f);d.doFollow(e,c)};Srch.AnalyticsRecommendation.$J=function(c){for(var a=0;a<Srch.AnalyticsRecommendation.$K;a++){var b=Srch.AnalyticsRecommendation.$F[a];if(b.$1_0===c)return b}return null};Srch.AnalyticsRecommendation.prototype={get_itemTemplateId:function(){return this.$1_0},set_itemTemplateId:function(a){this.$1_0=a;return a},$1_0:"",get_recommendationType:function(){return this.$6_0},set_recommendationType:function(a){this.$6_0=a;return a},$6_0:"",get_searchUrl:function(){return this.$H_0},set_searchUrl:function(a){this.$H_0=a;return a},$H_0:null,get_getPivotId:function(){return "Recommendation_"+this.$1_0+"_pivot"},get_getResultsId:function(){return "Recommendation_"+this.$1_0+"_results"},$L_0:function(b,a){this.$C_0().updatePivot(a);this.$R_0(b,a)},$D_0:null,$S_0:function(){this.$C_0().ensurePivotControl();window.setTimeout(this.$$d_$Q_0,500)},$Q_0:function(){this.$L_0(this.$6_0,this.$C_0().getDefaultPivot())},$M_0:function(){var a=$get(this.get_getResultsId());a.innerHTML="";for(var d=this.$C_0(),b=d.buildNextDataSet(this.$7_0,0),c=0;c<b.$3_0;c++)a.innerHTML+=d.buildView(b.get(c));if(!b.$3_0)a.innerHTML='<div class="ms-textLarge">'+this.$G_0+"</div>"},$C_0:function(){if(this.$D_0)return this.$D_0;if(this.$6_0==="HashTags"){this.$D_0=new Srch.HashTagDataView(this);return this.$D_0}return null},$7_0:null,$R_0:function(){if(this.$7_0){this.$M_0();return}this.$7_0=new Srch.DataSet;var a=null,b=$get("AnalyticsRecommendation_SerializedHashTagCollection");if(b){var e=SP.ClientContext.get_current();a=e.parseObjectFromJsonString(SP.UI.UIUtility.getInnerText(b));b.parentNode.removeChild(b)}if(!a||!a.get_count())this.$G_0=Srch.AnalyticsRecommendation.strNoResults;else for(var c=0;c<a.get_count();c++){var d=a.get_item(c),f=String.format(Srch.AnalyticsRecommendation.strExplanation,d.get_useCount().localeFormat("N0")),g=new Srch.HashTagData(d.get_name(),false,f,d.get_useCount(),null);this.$7_0.add(g)}this.$M_0()}};Srch.DataSet=function(){this.$B_0=[]};Srch.DataSet.$P=function(c,d){var a=c,b=d;if(b.$5_0>a.$5_0)return 1;else if(b.$5_0<a.$5_0)return -1;else return 0};Srch.DataSet.prototype={$3_0:0,$B_0:null,add:function(a){Array.add(this.$B_0,a);this.$3_0++},remove:function(a){var b=this.get(a);Array.removeAt(this.$B_0,a);this.$3_0--;return b},findId:function(c){for(var a=0;a<this.$3_0;a++){var b=this.get(a);if(b.$A_0===c)return b}return null},get_count:function(){return this.$3_0},"get":function(a){return this.$B_0[a]},sort:function(){this.$B_0.sort(Srch.DataSet.$P)}};Srch.BaseData=function(a,b,c,d){this.$0_0=a;this.$E_0=b;this.$5_0=c;this.$A_0=d};Srch.BaseData.prototype={get_isFollowed:function(){return this.$0_0},set_isFollowed:function(a){this.$0_0=a;return a},$0_0:false,get_explanation:function(){return this.$E_0},set_explanation:function(a){this.$E_0=a;return a},$E_0:null,get_relevance:function(){return this.$5_0},set_relevance:function(a){this.$5_0=a;return a},$5_0:0,get_id:function(){return this.$A_0},set_id:function(a){this.$A_0=a;return a},$A_0:null};Srch.HashTagData=function(b,c,d,e,a){Srch.HashTagData.initializeBase(this,[c,d,e,a]);this.$9_1=b;this.$8_1=a};Srch.HashTagData.prototype={get_hashTag:function(){return this.$9_1},set_hashTag:function(a){this.$9_1=a;return a},$9_1:null,get_guid:function(){return this.$8_1},set_guid:function(a){this.$8_1=a;return a},$8_1:null};Srch.DataView=function(a){this.$4_0=a};Srch.DataView.getHostUrl=function(){return window.location.protocol+"//"+window.location.host};Srch.DataView.prototype={$2_0:null,get_rec:function(){return this.$4_0},set_rec:function(a){this.$4_0=a;return a},$4_0:null,ensurePivotControl:function(){if(this.$2_0||!this.getPivots())return;var a=new ClientPivotControl;a.PivotParentId=this.$4_0.get_getPivotId();this.$N_0(a)},getDefaultPivot:function(){var a=this.getPivots();if(a&&a.length>0)return a[0][1];return null},buildNextDataSet:function(c,f){for(var b=new Srch.DataSet,d=this.count(),e=c.$3_0,a=f;a<d&&a<e;a++)b.add(c.get(a));return b},$N_0:function(d){var a=this.getPivots();if(a){for(var b=0;b<a.length;b++){var c=new ClientPivotControlMenuOption;c.DisplayText=a[b][0];c.Description=a[b][1];c.SelectedOption=!b;c.OnClickAction='Srch.AnalyticsRecommendation.doRecommend("'+this.$4_0.$1_0+'", "'+this.$4_0.$6_0+'", "'+a[b][1]+'");';d.AddMenuOption(c)}this.$2_0=d;this.$2_0.SurfacedPivotCount=a.length;this.$2_0.Render()}},updatePivot:function(d){if(!this.$2_0)return;for(var c=this.$2_0.SurfacedOptions,a=0;a<this.$2_0.SurfacedPivotCount;a++){var b=c[a];b.SelectedOption=b.Description===d}this.$2_0.Render()}};Srch.DataView.registerClass("Srch.DataView");Srch.HashTagDataView.registerClass("Srch.HashTagDataView",Srch.DataView);Srch.AnalyticsRecommendation.registerClass("Srch.AnalyticsRecommendation");Srch.DataSet.registerClass("Srch.DataSet");Srch.BaseData.registerClass("Srch.BaseData");Srch.HashTagData.registerClass("Srch.HashTagData",Srch.BaseData);Srch.AnalyticsRecommendation.$F=[];Srch.AnalyticsRecommendation.$K=0;Srch.AnalyticsRecommendation.strFollow=Srch.Res.ar_htv_Follow;Srch.AnalyticsRecommendation.strStartFollowing=Srch.Res.ar_htv_StartFollowing;Srch.AnalyticsRecommendation.strStopFollowing=Srch.Res.ar_htv_StopFollowing;Srch.AnalyticsRecommendation.strNoResults=Srch.Res.ar_rec_NoResults;Srch.AnalyticsRecommendation.strExplanation=Srch.Res.ar_Explanation;Srch.AnalyticsRecommendation.strIsFollowed=Srch.Res.ar_htv_IsFollowed;Srch.AnalyticsRecommendation.strIsNotFollowed=Srch.Res.ar_htv_IsNotFollowed;typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();NotifyScriptLoadedAndExecuteWaitingJobs("search.analyticsrecommendation.js")