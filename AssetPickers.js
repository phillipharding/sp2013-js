function $_global_assetpickers(){CONST_AssetPickerPopUpZIndex=600;CONST_AssetPickerSupportedPlayerExtensions=["wmv","wma","mp3","mp4","ogg","ogv","oga","webm"];CONST_AssetPickerImagesElementName="pickerimages";CONST_FieldName_Keywords="TaxKeyword";CONST_FieldName_PeopleInMedia="PeopleInMedia";CONST_FieldName_VideoSetDescription="VideoSetDescription";CONST_FieldName_Comments="_Comments";CONST_FieldName_VideoEncodingOverriden="VideoSetUserOverrideEncoding";CONST_FieldName_VideoEncodingDefault="VideoSetDefaultEncoding";CONST_FieldName_VideoExternalPath="VideoSetExternalLink";CONST_FieldName_VideoShowDownload="VideoSetShowDownloadLink.value";CONST_FieldName_VideoShowEmbed="VideoSetShowEmbedLink.value";CONST_FieldName_AlternateThumbnailUrl="AlternateThumbnailUrl";CONST_FieldName_VideoRenditions="VideoSetRenditionsInfo";CONST_FieldName_AverageRating="AverageRating";CONST_FieldName_LikesCount="LikesCount";CONST_FieldName_Thumbnail="PreviewOnForm";CONST_AssetCallout_TextCharacterLimit=100;CONST_UserRender_MoreLinkClassName="ms-imnMoreLink";CONST_NoCalloutSectionHeader=null;CONST_AssetCalloutContentWidth=370;CONST_WhiteSpaceLastIndexOfRegex=/\s(?!.*\s)/g;assetLibraryCalloutCtx={};assetLibraryCalloutCtx.Templates={};assetLibraryCalloutCtx.BaseViewID="Callout";assetLibraryCalloutCtx.ListTemplateType=851;assetLibraryCalloutCtx.Templates.Item=AssetLibraryCalloutRenderItemTemplate;assetLibraryCalloutCtx.Templates.OnPostRender=AssetLibraryCalloutOnPostRender;assetLibraryCalloutCtx.Templates.Footer=function(a){a:;return CalloutRenderFooterTemplate(a,AssetLibraryCalloutActionsMenuPopulator)};ExecuteOrDelayUntilScriptLoaded(function(){a:;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(assetLibraryCalloutCtx)},"clienttemplates.js");g_isMediaPlayerReady=false;g_currentLCID=1033;AssetPickerItemList.prototype.nodeID="";AssetPickerItemList.prototype.itemName="";AssetPickerItemList.prototype.listItem=null;AssetPickerItemList.prototype.navUrl="";AssetPickerItemList.prototype.absUrl="";AssetPickerItemList.prototype.propsUrl="";AssetPickerItemList.prototype.dwnlUrl="";AssetPickerItemList.prototype.editUrl="";AssetPickerItemList.prototype.isContainer=false;AssetPickerItemList.prototype.rootFolder="";AssetPickerItemList.prototype.folderCTID="";AssetPickerItemList.prototype.hiddenCheckbox=null;AssetPickerItemList.prototype.tableRow=null;AssetPickerItemList.prototype.tableCell=null;AssetPickerItemList.prototype.preview=null;AssetPickerItemList.prototype.thumbnail=null;AssetPickerItemList.prototype.imageHeight=null;AssetPickerItemList.prototype.imageWidth=null;AssetPickerItemList.prototype.previewHeight=null;AssetPickerItemList.prototype.previewWidth=null;AssetPickerItemList.prototype.thumbHeight=null;AssetPickerItemList.prototype.thumbWidth=null;AssetPickerItemList.prototype.previewExists=false;AssetPickerItemList.prototype.thumbnailExists=false;AssetPickerItemList.prototype.canEdit=false;AssetPickerItemList.prototype.itemTitle=null;AssetPickerItemList.prototype.checkoutUserId="";AssetPickerItemList.prototype.isCheckedoutToLocal=0;AssetPickerItemList.prototype.alternateThumbnailUrl="";AssetPickerItemList.prototype.isVideoSet=false;AssetPickerItemList.prototype.defMediaUrl="";AssetPickerItemList.prototype.showDwnlCntrl=false;AssetPickerItemList.prototype.showEmbdCntrl=false;AssetPickerItemList.prototype.renditions=null;CONST_ImageAssetPickerDialogName="AssetPortalBrowser.aspx";CONST_LinkAssetPickerDialogName="AssetPortalBrowser.aspx";CONST_EditHyperLinkDialogDialogName="AssetEditHyperLink.aspx";CONST_EditImageDialogDialogName="AssetImagePicker.aspx";CONST_AssetIconClassName="ms-asset-icon";CONST_AssetBoommarkOnlyClassName="ms-asset-internalBookmark";CONST_AssetPickerItemHoverClassName="ms-itmhover";CONST_AssetPickerItemSelectedClassName="s4-itm-selected";CONST_AssetPickerRTE2AnchorPath="/_layouts/15/images/rte2anchor.gif?rev=23";CONST_AssetBoommarkOnlyClassCssText="width: 20px; height: 20px; display: inline-block; background-color: transparent; background-image: url("+CONST_AssetPickerRTE2AnchorPath+"); background-repeat: no-repeat; background-attachment: fixed; background-position: bottom right;";CONST_AssetPickerNewWindowQSParanName="APIsNewWindow";CONST_AssetPickerSelectionClassName="ms-tileview-tile-selected";CONST_SiteManagerSelectItemName="SMItem";CONST_ImageSelectItemName="ImageItem";CONST_AssetPickerItemUrlDataLinkName="SMItemUrlDataLink";CONST_AssetPickerPagerTable="pagertable";CONST_AssetPickerPagerLocation="APD_PagerLocation";CONST_AssetPickerNoItemSelectedIndex=-1;CONST_AssetPickerModalDialogOptions={showMaximized:true,showClose:true,autoSize:true};CONST_EditModalDialogOptions={showMaximized:false,showClose:true,autoSize:true};CONST_AssetPickerQueryStringParamsToRender=["APRemoteUrl","AssetView","APDExts","ReturnItemFields","AssetType","IsDlg","APDPrevLstTmplt"];g_APD_CSRRendering=true;APD_AssetConfigGlobalObjectDictionary={};g_APO_CachedCurrentConfigForDialog=null;AssetPickerConfig.prototype.GenerateQueryStringSegment=AssetPickerConfig_GenerateQueryStringSegment;AssetPickerConfig.prototype.GetDialogUrl=AssetPickerConfig_GetDialogUrl;AssetPickerConfig.prototype.LaunchUrlWithAsset=AssetPickerConfig_LaunchUrlWithAsset;AssetPickerConfig.prototype.GetCurrentAssetUrlValue=AssetPickerConfig_GetCurrentAssetUrlValue;AssetPickerConfig.prototype.DefaultAssetLocation="";AssetPickerConfig.prototype.DefaultAssetImageLocation="";AssetPickerConfig.prototype.DisplayLookInSection=true;AssetPickerConfig.prototype.DefaultToLastUsedLocation=true;AssetPickerConfig.prototype.ManageHyperlink=true;AssetPickerConfig.prototype.DisplayWidth="";AssetPickerConfig.prototype.DisplayHeight="";AssetPickerConfig.prototype.RenditionId="";AssetPickerConfig.prototype.AllowExternalUrls=true;AssetPickerConfig.prototype.OverrideDialogImageUrl="";AssetPickerConfig.prototype.OverrideDialogTitle="";AssetPickerConfig.prototype.ReturnItemFields="";AssetPickerConfig.prototype.AssetType="";AssetPickerConfig.prototype.CurrentWebBaseUrl="";AssetPickerConfig.prototype.ReturnCallback=null;AssetPickerConfig.prototype.OverrideDialogFeatures=null;AssetPickerConfig.prototype.OverrideDialogDesc="";AssetPickerConfig.prototype.AssetUrlClientID="";AssetPickerConfig.prototype.AssetTextClientID="";AssetPickerConfig.prototype.UseImageAssetPicker=false;ImageAsset.prototype.GenerateSeralizedData=ImageAsset_GenerateSeralizedData;ImageAsset.prototype.ReadSerializedData=ImageAsset_ReadSerializedData;ImageAsset.prototype.GenerateQueryStringSegment=AP_QStringSerializeThisObject;ImageAsset.prototype.CopyValuesFromObject=AP_CopyValuesFromObjectToThisObject;ImageAsset.prototype.LaunchModalAssetPicker=ImageAsset_LaunchModalAssetPicker;ImageAsset.prototype.LaunchModalEditProperties=ImageAsset_LaunchModalEditProperties;ImageAsset.prototype.LaunchModalDialogOnElement=AP_LaunchModalDialogOnElement;ImageAsset.prototype.PopulateValuesFromElement=ImageAsset_PopulateValuesFromElement;ImageAsset.prototype.SetValuesIntoElement=ImageAsset_SetValuesIntoElement;ImageAsset.prototype.SetValuesIntoElement=ImageAsset_SetValuesIntoElement;ImageAsset.prototype.AssetText="";ImageAsset.prototype.ListItemFields=null;ImageAsset.prototype.Alignment="";ImageAsset.prototype.Hyperlink="";ImageAsset.prototype.HSpacing="";ImageAsset.prototype.VSpacing="";ImageAsset.prototype.Border=0;ImageAsset.prototype.Height="";ImageAsset.prototype.Width="";ImageAsset.prototype.UseDefaultSize=true;ImageAsset.prototype.ManageLinkDisplayText=true;ImageAsset.prototype.Target="";LinkAsset.prototype.GenerateSeralizedData=LinkAsset_GenerateSeralizedData;LinkAsset.prototype.ReadSerializedData=LinkAsset_ReadSerializedData;LinkAsset.prototype.GenerateQueryStringSegment=AP_QStringSerializeThisObject;LinkAsset.prototype.CopyValuesFromObject=AP_CopyValuesFromObjectToThisObject;LinkAsset.prototype.LaunchModalAssetPicker=LinkAsset_LaunchModalAssetPicker;LinkAsset.prototype.LaunchModalEditProperties=LinkAsset_LaunchModalEditProperties;LinkAsset.prototype.LaunchModalDialogOnElement=AP_LaunchModalDialogOnElement;LinkAsset.prototype.PopulateValuesFromElement=LinkAsset_PopulateValuesFromElement;LinkAsset.prototype.SetValuesIntoElement=LinkAsset_SetValuesIntoElement;LinkAsset.prototype.FixupIconsAndEmptyAnchors=LinkAsset_FixupIconsAndEmptyAnchors;LinkAsset.prototype.FindAssetIconElement=LinkAsset_FindAssetIconElement;LinkAsset.prototype.ManageLinkDisplayText=false;LinkAsset.prototype.ManageLinkIcon=true;LinkAsset.prototype.AssetText="";LinkAsset.prototype.TooltipText="";LinkAsset.prototype.Target="";LinkAsset.prototype.IconUrl="";LinkAsset.prototype.Name="";LinkAsset.prototype.ListItemFields=null;g_APD_locationUrlInput=undefined;g_APD_objectListDiv=null;g_APD_dictItemRows={};g_APD_arrItemRows=new Array(0);g_APD_usingThumbnailMode=false;g_APD_itemHandlersAdded=false;g_APD_returnedUrl="";g_APD_returnedText="";g_APD_returnPromptString="";g_APD_returnListItemFields=null;g_APD_CachedReturnValue=null;AssetPickerItemRow.prototype.nodeID="";AssetPickerItemRow.prototype.itemName="";AssetPickerItemRow.prototype.tableRow=null;AssetPickerItemRow.prototype.tableCell=null;AssetPickerItemRow.prototype.hiddenCheckbox=null;AssetPickerItemRow.prototype.urlDataAnchor=null;AssetPickerItemRow.prototype.navUrl="";AssetPickerItemRow.prototype.absUrl="";AssetPickerItemRow.prototype.propsUrl="";AssetPickerItemRow.prototype.isContainer=false;AssetPickerItemRow.prototype.listItem=null;AssetPickerPageCache.prototype.Cache=new Array(0);AssetPickerPageCache.prototype.TokenCache=new Array(0);AssetPickerPageCache.prototype.length=0;AssetPickerCSRItem.prototype.listItem=null;AssetPickerCSRItem.prototype.ctx=null;AssetPickerCSRItem.prototype.itemName="";AssetPickerCSRItem.prototype.navUrl="";AssetPickerCSRItem.prototype.folderCTID="";AssetPickerCSRItem.prototype.isVideoSet=false;AssetPickerCSRItem.prototype.isContainer=false;AssetPickerCSRItem.prototype.rootFolder="";AssetPickerCSRItem.prototype.isSelected=false;AssetPickerCSRItem.prototype.defMediaUrl="";assetPickerCalloutCtx={};assetPickerCalloutCtx.Templates={};assetPickerCalloutCtx.BaseViewID="Callout";assetPickerCalloutCtx.Templates.OnPreRender=function(){a:;EnsureScript("mediaplayer.js",typeof mediaPlayer,APD_EnsureOverlayPlayer)};assetPickerCalloutCtx.Templates.Footer=function(a){a:;return CalloutRenderFooterTemplate(a,APD_ActionsMenuPopulator)};ExecuteOrDelayUntilScriptLoaded(function(){a:;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(assetPickerCalloutCtx)},"clienttemplates.js");assetPickerCtx={};assetPickerCtx.Templates={};assetPickerCtx.Templates.OnPostRender=APD_InitializeAssetPickerElements;assetPickerCtx.Templates.Fields={FilenameMenuNoLink:{View:APD_RenderTitleField},LinkFilename:{View:APD_RenderTitleField},LinkFilenameNoMenu:{View:APD_RenderTitleField},LinkTitle:{View:APD_RenderTitleField},PublishingAssociatedContentType:{View:RenderAssociatedContentTypeField}};ExecuteOrDelayUntilScriptLoaded(function(){a:;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(assetPickerCtx)},"clienttemplates.js");typeof APD_CallbackWssView!="undefined"&&APD_CallbackWssView("assetpickers");typeof Sys!="undefined"&&Sys!=null&&Sys.Application!=null&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs!="undefined"&&NotifyScriptLoadedAndExecuteWaitingJobs("AssetPickers.js")}function ULSX8o(){var a={};a.ULSTeamName="CMS";a.ULSFileName="AssetPickers.commentedjs";return a}var CONST_AssetPickerPopUpZIndex,CONST_AssetPickerSupportedPlayerExtensions,CONST_AssetPickerImagesElementName,CONST_FieldName_Keywords,CONST_FieldName_PeopleInMedia,CONST_FieldName_VideoSetDescription,CONST_FieldName_Comments,CONST_FieldName_VideoEncodingOverriden,CONST_FieldName_VideoEncodingDefault,CONST_FieldName_VideoExternalPath,CONST_FieldName_VideoShowDownload,CONST_FieldName_VideoShowEmbed,CONST_FieldName_AlternateThumbnailUrl,CONST_FieldName_VideoRenditions,CONST_FieldName_AverageRating,CONST_FieldName_LikesCount,CONST_FieldName_Thumbnail,CONST_AssetCallout_TextCharacterLimit,CONST_UserRender_MoreLinkClassName,CONST_NoCalloutSectionHeader,CONST_AssetCalloutContentWidth,CONST_WhiteSpaceLastIndexOfRegex;function AssetLibraryCalloutRenderItemTemplate(a){var b=a.CurrentItem,n=GetCalloutElementIDFromRenderCtx(a),c=[];c.push(Callout.GenerateDefaultSection(CONST_NoCalloutSectionHeader,a.RenderFieldByName(a,CONST_FieldName_Thumbnail,b,a.ListSchema)));var g=function(a){return'<span class="ms-forceWrap" title="'+a+'">'+AssetLibraryCalloutTruncateString(a,CONST_AssetCallout_TextCharacterLimit)+"</span>"},f=b[CONST_FieldName_Keywords];if(APD_Def(f)&&APD_Def(f.length)&&f.length>0){var j=a.RenderFieldByName(a,CONST_FieldName_Keywords,b,a.ListSchema);c.push(Callout.GenerateDefaultSection(Strings.CMS.L_AssetLibraryCalloutKeywords,g(j)))}if(APD_Def(b[CONST_FieldName_LikesCount]))c.push(Callout.GenerateDefaultSection(CONST_NoCalloutSectionHeader,a.RenderFieldByName(a,CONST_FieldName_LikesCount,b,a.ListSchema)));else APD_Def(b[CONST_FieldName_AverageRating])&&c.push(Callout.GenerateDefaultSection(CONST_NoCalloutSectionHeader,a.RenderFieldByName(a,CONST_FieldName_AverageRating,b,a.ListSchema)));var d=b[CONST_FieldName_PeopleInMedia];if(APD_Def(d)&&APD_Def(d.length)&&d.length>0){var l={HasUserLink:true,DefaultRender:true,AllowMultipleValues:true,InlineRender:true,InlineRenderMoreAsLink:true},m={EffectivePresenceEnabled:"1",PresenceAlt:Strings.STS.L_UserFieldNoUserPresenceAlt,UserDispUrl:a.ListSchema.UserDispUrl},k=new UserFieldRenderer(CONST_FieldName_PeopleInMedia),i=k.RenderField(a,l,{PeopleInMedia:d},m);c.push(Callout.GenerateDefaultSection(Strings.CMS.L_AssetLibraryCalloutPeopleInMedia,i))}var e=b[CONST_FieldName_VideoSetDescription];if(AP_IsEmpty(e))e=String(b[CONST_FieldName_Comments]);!AP_IsEmpty(e)&&c.push(Callout.GenerateDefaultSection(CONST_NoCalloutSectionHeader,g(e)));c.push(CalloutRenderSourceUrl(a));var h=GetCalloutFromRenderCtx(a);APD_Def(h)&&h.set({contentWidth:CONST_AssetCalloutContentWidth});return c.join("")}function AssetLibraryCalloutTruncateString(a,b){var d=APD_Str(a)&&!isNaN(b)&&b>0&&a.length>b;if(d){a=a.substring(0,b-1);var c=CONST_WhiteSpaceLastIndexOfRegex.exec(a);d=APD_Def(c)&&c.index>0;if(d)a=a.substring(0,c.index);return a+"&#133"}return a}function AssetLibraryCalloutFieldItemIdGeneration(a,b){return a+b}function AssetLibraryCalloutActionsMenuPopulator(c,d){a:;if(TileViewIsInAssetPicker&&typeof APD_ActionsMenuPopulator=="function"){APD_ActionsMenuPopulator(c,d);return}var b=c.CurrentItem;if(!APD_Def(b,b.PermMask,c.displayFormUrl,c.editFormUrl))return;var a={isVideoSet:b.ContentTypeId.indexOf("0x0120D520A808")==0,navUrl:b.FileRef};if(a.isVideoSet){if(APD_Def(b[CONST_FieldName_VideoEncodingOverriden],b[CONST_FieldName_VideoEncodingDefault],b[CONST_FieldName_VideoExternalPath]))a.defMediaUrl=APD_GetVideoSetDefaultMediaUrl(b);a.showDwnlCntrl=b[CONST_FieldName_VideoShowDownload]=="1";a.showEmbdCntrl=b[CONST_FieldName_VideoShowEmbed]=="1";a.alternateThumbnailUrl=b[CONST_FieldName_AlternateThumbnailUrl];var f=b[CONST_FieldName_VideoRenditions];if(!AP_IsEmpty(f))a.rendInfo=Sys.Serialization.JavaScriptSerializer.deserialize(APD_DecodeSpecialChars(f))}var i=APD_IsItemSupportedByMediaPlayer(a);if(i){g_currentLCID=String(c.CurrentLanguage);APD_EnsureOverlayPlayer();d.addAction(new CalloutAction({text:Strings.CMS.L_PlayCommand_TEXT,isEnabledCallback:function(){a:;return APD_IsItemPlayable(a)},onClickCallback:function(){a:;mediaPlayer.onOverlayModePlay(null,a.isVideoSet?a.defMediaUrl:a.navUrl,b.FileLeafRef,a)}}))}var g=b.FileRef,j=b.CheckedOutUserId==String(SYSTEM_ACCOUNT_ID)&&c.CurrentUserId!=String(SYSTEM_ACCOUNT_ID);d.addAction(new CalloutAction({text:Strings.CMS.L_EditImageRenditionsAction,onClickCallback:function(){Pub.Ribbon.ManageImageRenditionsCommands.navigateToManageRenditions(g)},isVisibleCallback:function(){return j||!APD_HasPermissions(b.PermMask,0,4)?false:typeof Pub=="undefined"||typeof Pub.Ribbon=="undefined"||typeof Pub.Ribbon.ManageImageRenditionsCommands=="undefined"?false:Pub.Ribbon.ManageImageRenditionsCommands.isManageRenditionsLinkVisible(g)}}));d.addAction(new CalloutAction({text:Strings.STS.L_CalloutShareAction,onClickCallback:function(a,b){CalloutAction_Share_OnClick(a,b,c)},isVisibleCallback:function(b){return!a.isVideoSet&&CalloutAction_Share_IsVisible(b,c)}}));var h=a.isVideoSet&&a.showDwnlCntrl&&a.defMediaUrl!=b[CONST_FieldName_VideoExternalPath],k=a.isVideoSet?a.defMediaUrl:b.FileRef,e=ctx.HttpRoot+"/_layouts/15/download.aspx?SourceUrl="+escapeProperly(k);e=AddSourceToUrl(e);d.addAction(new CalloutAction({text:Strings.CMS.L_CalloutDownloadAction,onClickCallback:function(){STSNavigate(e)},isEnabledCallback:function(){return APD_HasPermissions(b.PermMask,0,32)&&(!a.isVideoSet||a.isVideoSet&&h)}}))}function AssetLibraryCalloutOnPostRender(b){ProcessImn();var c=GetCalloutElementIDFromRenderCtx(b),a=document.getElementById(c+"IconLink");APD_Def(a)&&APD_IsFileSupportedByMediaPlayer(a.href)&&EnsureScript("mediaplayer.js",typeof mediaPlayer,function(){a:;APD_EnsureOverlayPlayer();mediaPlayer.attachToMediaLinks(a.parentNode,CONST_AssetPickerSupportedPlayerExtensions,null,true,null)});AssetLibraryPeopleInMediaOnPostRender(b)}var assetLibraryCalloutCtx;function TileViewIsInAssetPicker(){return typeof APD_InAssetPicker=="function"&&APD_InAssetPicker()}function AssetLibraryPeopleInMediaOnPostRender(f){var g=f.CurrentItem,a=g[CONST_FieldName_PeopleInMedia];if(APD_Def(a)&&APD_Def(a.length)&&a.length>3){var d=document.getElementById(AssetLibraryCalloutFieldItemIdGeneration(GetCalloutElementIDFromRenderCtx(f),CONST_FieldName_PeopleInMedia));if(APD_Def(d))for(var e=d.getElementsByTagName("A"),b=0;b<e.length;b++){var c=e[b],h=c.className.indexOf(CONST_UserRender_MoreLinkClassName)!=-1;if(h){c.href=g.FileRef;c.onclick="GoToLinkOrDialogNewWindow(this)";break}}}}function APD_Def(){for(var a=0;a<arguments.length;++a)if(null==arguments[a]||typeof arguments[a]=="undefined")return false;return true}function APD_Str(){for(var a=0;a<arguments.length;++a)if(typeof arguments[a]!="string")return false;return true}function APD_IsNullOrEmpty(a){if(a)if(""!=a)return false;return true}function AP_IsEmpty(a){return"undefined"==typeof a||null==a||""==a?true:false}function APD_HasPermissions(a,d,e){var b=GetPermMaskH(a),c=GetPermMaskL(a);return CheckIfHasRights(d,e,b,c)}function APD_DecodeSpecialChars(b){if(!APD_Def(b))return null;var a=b.replace(/&quot;/g,'"');a=a.replace(/&gt;/g,">");a=a.replace(/&lt;/g,"<");a=a.replace(/&#39;/g,"'");a=a.replace(/&amp;/g,"&");return a}function APD_InAssetPicker(){if(typeof g_APD_locationUrlInput=="undefined"&&typeof APD_FindNamedElement=="function")g_APD_locationUrlInput=APD_FindNamedElement("LocationUrl",document.getElementsByTagName("INPUT"),true);else if(typeof g_APD_locationUrlInput=="undefined")g_APD_locationUrlInput=null;return typeof g_APD_locationUrlInput!="undefined"&&g_APD_locationUrlInput!=null}var g_isMediaPlayerReady,g_currentLCID;function APD_EnsureOverlayPlayer(){a:;if(mediaPlayer.getOverlayPlayerElement()==null){var a={overlayZIndex:CONST_AssetPickerPopUpZIndex+1};mediaPlayer.createOverlayPlayer(null,a);g_isMediaPlayerReady=mediaPlayer.getOverlayPlayerElement()!=null}else g_isMediaPlayerReady=true;mediaPlayer.ensureCssIsIncluded(g_currentLCID)}function APD_GetFileExtension(c){var b=null;if(APD_Def(c)){var a=c.toLowerCase().split(".");if(a.length>1)b=a[a.length-1]}return b}function APD_IsItemSupportedByMediaPlayer(a){return APD_IsFileSupportedByMediaPlayer(a.isVideoSet?a.defMediaUrl:a.navUrl)}function APD_IsFileSupportedByMediaPlayer(d){var c=false,b=APD_GetFileExtension(d);if(b!=null)for(var a=0;a<CONST_AssetPickerSupportedPlayerExtensions.length;a++)if(b==CONST_AssetPickerSupportedPlayerExtensions[a]){c=true;break}return c}function APD_IsItemPlayable(a){return g_isMediaPlayerReady&&APD_IsItemSupportedByMediaPlayer(a)}function APD_GetVideoSetDefaultMediaUrl(b){var c=function(a){a:;return APD_Def(b[a])?APD_Str(b[a])?b[a]:b[a].get_url():null},a="";a=c(CONST_FieldName_VideoEncodingOverriden);if(AP_IsEmpty(a))a=c(CONST_FieldName_VideoEncodingDefault);if(AP_IsEmpty(a))a=c(CONST_FieldName_VideoExternalPath);return a}function APD_ArrayLastIndexOf(a,d){a:;if(Array.prototype.lastIndexOf&&APD_Def(a))return a.lastIndexOf(d);"use strict";if(a===void 0||a===null)throw new TypeError;var c=Object(a),e=c.length>>>0;if(e===0)return-1;for(var b=e-1;b>=0;b--)if(b in c&&c[b]===d)return b;return-1}function APD_AddCssClass(a,b){if(!APD_Def(a))return;if(APD_Def(a.classList))a.classList.add(b);else if(!APD_ElementContainsClass(a,b))a.className=a.className===""?b:a.className+" "+b}function APD_RemoveCssClass(a,b){if(!APD_Def(a))return;if(APD_Def(a.classList)){a.classList.remove(b);return}else if(!APD_ElementContainsClass(a,b))return;var c=a.className.split(/\s+/);while(APD_ArrayLastIndexOf(c,b)!=-1)c.splice(APD_ArrayLastIndexOf(c,b),1);a.className=c.join(" ")}function APD_ElementContainsClass(a,b){return APD_Def(a)&&APD_ArrayLastIndexOf(a.className.split(/\s+/),b)!=-1}function AssetPickerItemList(b){a:;if(!(this instanceof AssetPickerItemList))return new AssetPickerItemList;this.tableCell=null;var f=document.getElementById(CONST_AssetPickerImagesElementName);if(null==f)return;if(f.nodeName.toLowerCase()=="ul"){this.listItem=APD_ParentElement("LI",b);this.tableRow=null;g_APD_usingThumbnailMode=true}else{this.listItem=APD_ParentElement("TR",b);this.tableRow=this.listItem;g_APD_usingThumbnailMode=false}if(!this.listItem)return;this.isContainer=false;if(b.nodeName.toLowerCase()=="input")this.hiddenCheckbox=b;else this.hiddenCheckbox=APD_FindNamedElement(ImageSelectItemName,this.listItem.getElementsByTagName("INPUT"),false);if(this.hiddenCheckbox){this.nodeID=this.hiddenCheckbox.id;this.listItem.id=this.nodeID+"_item";var a=this.hiddenCheckbox.value;this.canEdit=APD_ParseBooleanProperty("canEdit",a);this.navUrl=unescapeProperly(APD_ParseProperty("navUrl",a));this.absUrl=unescapeProperly(APD_ParseProperty("absUrl",a));this.propsUrl=APD_ParseProperty("propsUrl",a);this.dwnlUrl=APD_ParseProperty("dwnlUrl",a);this.editUrl=APD_ParseProperty("editUrl",a);this.isContainer=APD_ParseBooleanProperty("isContainer",a);this.rootFolder=APD_ParseProperty("rootFolder",a);this.folderCTID=APD_ParseProperty("folderCTID",a);this.isVideoSet=this.folderCTID.indexOf("0x0120D520A808")==0;if(APD_InAssetPicker()&&this.isVideoSet)this.isContainer=false;this.imageHeight=APD_ParseProperty("imageHeight",a);this.imageWidth=APD_ParseProperty("imageWidth",a);this.itemTitle=APD_ParseProperty("itemTitle",a);this.previewExists=APD_ParseBooleanProperty("previewExists",a);this.thumbnailExists=APD_ParseBooleanProperty("thumbnailExists",a);var c=APD_ParseProperty("coutId_Loc",a).split("_");if(c.length>1){this.checkoutUserId=c[0];this.isCheckedoutToLocal=c[1];if(typeof SYSTEM_ACCOUNT_ID!="undefined"&&this.checkoutUserId==SYSTEM_ACCOUNT_ID&&!(ctx&&ctx.CurrentUserId==SYSTEM_ACCOUNT_ID))this.canEdit=false}this.alternateThumbnailUrl=APD_ParseProperty("alternateThumbnailUrl",a);this.defMediaUrl=APD_ParseProperty("defMediaUrl",a);this.showDwnlCntrl=APD_ParseBooleanProperty("showDwnlCntrl",a);this.showEmbdCntrl=APD_ParseBooleanProperty("showEmbdCntrl",a);var d=APD_ParseProperty("rendInfo",a);if(APD_Def(d)&&d!="")this.rendInfo=Sys.Serialization.JavaScriptSerializer.deserialize(APD_DecodeSpecialChars(d))}this.itemName=this.listItem.id;if(this.hiddenCheckbox.checked)if(this.listItem.tagName=="LI")this.listItem.className="s4-ctx-show";else this.listItem.className="s4-itm-selected";else this.listItem.className="";this.preview=null;this.preview=APD_GetImagePreview(this.listItem);if(!g_APD_itemHandlersAdded)if(this.isContainer){commonAttachEvent(this.listItem,"click",APD_HandleSelection);commonAttachEvent(this.listItem,"dblclick",APD_HandleDoubleClick);if(this.alternateThumbnailUrl!=""){commonAttachEvent(this.listItem.firstChild,"mouseover",APD_SchedulePopup);commonAttachEvent(this.listItem.firstChild,"mouseout",APD_ClearPopup)}}else{commonAttachEvent(this.listItem,"click",APD_HandleSelection);commonAttachEvent(this.listItem,"dblclick",APD_HandleDoubleClick);commonAttachEvent(this.listItem.firstChild,"mouseover",APD_SchedulePopup);commonAttachEvent(this.listItem.firstChild,"mouseout",APD_ClearPopup)}if(null!=this.preview){var e=this.preview.clientHeight==0?this.imageHeight:this.preview.clientHeight;this.previewHeight=ParseUnit(e);e=this.preview!=null&&this.preview.clientWidth==0?this.imageWidth:this.preview.clientWidth;this.previewWidth=ParseUnit(e)}commonAttachEvent(this.listItem,"keydown",APD_HandleItemKeyDown);this.GetIsSelected=function(){a:;return this.hiddenCheckbox.checked};this.SetIsSelected=function(b,a){a:;if(a==null)a=true;var c=this.hiddenCheckbox.getAttribute("iid");if(b){this.hiddenCheckbox.checked=true;this.listItem.focus();if(this.listItem.tagName=="LI")this.listItem.className="s4-ctx-show";else this.listItem.className="s4-itm-selected";this.focusElement&&this.focusElement.focus()}else{this.hiddenCheckbox.checked=false;this.listItem.className=""}a==true&&SP.ListOperation.Selection.selectListItem(c,b)}}function APD_ParseProperty(d,e){a:;for(var f="|",c="",b=e.split(f),a=0;a<b.length;a++)if(b[a].indexOf(d)==0){c=b[a].substring(b[a].indexOf("^")+1);break}return c}function APD_ParseBooleanProperty(b,c){a:;var a=APD_ParseProperty(b,c);return a=="1"||a=="true"}function ParseUnit(b){a:;var a=parseInt(b);return isNaN(a)?0:a}function APD_GetItemListObject(d){a:;var b=null,a="LI";if(!g_APD_usingThumbnailMode)a="TR";var c=APD_ParentElement(a,d,true);if(c)b=g_APD_dictItemRows[c.id];return b}function SmtDef(){a:;for(var a=0;a<arguments.length;++a)if(null==arguments[a]||typeof arguments[a]=="undefined")return false;return true}function SmtGetChildren(a){a:;return SmtDef(a)?a.childNodes?a.childNodes:a.children:null}function SmtGridView_RemoveOldFilterValuesFromMenuTemplate(c){a:;for(var d=SmtGetChildren(c),a=0;a<d.length;a++){var b=d[a];if(b.attributes!=null&&b.getAttribute("isFilterItem")=="true"){c.removeChild(b);--a}}}function SmtGridView_FilterCallbackHandler(q,u){a:;var a=u.split(";");if(a.length!=4){alert("ERROR: SPGridView_FilterCallbackHandler() - values.length != 4");return}var s=a[0],l=a[1],o=a[2],n=a[3];if(q=="__SMTThrottled__")SmtGridView_Throttled_ClearOldFilterValuesFromMenuTemplate(l,o);else{var k=document.getElementById(s);if(k==null){alert("ERROR: SPGridView_FilterCallbackHandler() - gridView == null");return}var d=document.getElementById(l);if(d==null){alert("ERROR: SPGridView_FilterCallbackHandler() - menuTemplate == null");return}var r=document.getElementById(o);if(r==null){alert("ERROR: SPGridView_FilterCallbackHandler() - menu == null");return}var i=k.getAttribute("postbackEventReference");if(i==null||i.length<=0){alert("ERROR: SPGridView_FilterCallbackHandler() - postbackEventReference is null or empty");return}var h=k.getAttribute("postbackClearFilterEventReference");if(h==null||h.length<=0){alert("ERROR: SPGridView_FilterCallbackHandler() - postbackClearFilterEventReference is null or empty");return}SmtGridView_RemoveOldFilterValuesFromMenuTemplate(d);a=q.split(";");if(a.length>1){var f=CAMOpt(d,StBuildParam(Strings.CMS.L_DontFilterBy_Text,a[0]),h.replace(/__POSTBACKARGUMENT__/g,n),"/_layouts/15/images/filteroffdisabled.gif?rev=23");f.setAttribute("isFilterItem","true");f.setAttribute("enabled","false");for(var j=1;j<a.length;j++){var b=unescape(a[j]),c=b,g="__Clear",m="__TypeImage",p="",e=b.indexOf(m);if(e>=0){b=b.substring(0,e);e+=m.length;c=c.substring(e,c.length)}if(b.indexOf(g)==0){f.setAttribute("enabled","true");f.setAttribute("iconSrc","/_layouts/15/images/filteroff.gif?rev=23");b=b.substring(g.length,b.length);p="/_layouts/15/images/CNSAPP16.GIF?rev=23"}if(c.indexOf(g)==0)c=c.substring(g.length,c.length);var v=i.replace(/__POSTBACKARGUMENT__/g,n+";"+c.replace(/\\/g,"\\\\").replace(/\'/g,"\\'").replace(/%/g,"%25").replace(/;/g,"%3b").replace(/\$/g,"%24")),t=CAMOpt(d,b,v,p);t.setAttribute("isFilterItem","true")}}HideMenu(d);MMU_Open(d,r)}}function SmtGridView_ClearOldFilterValuesFromMenuTemplate(a,b){a:;SmtGridViewSetTextMenuItem(a,b,Strings.CMS.L_FilterDisabled_TEXT)}function SmtGridView_Throttled_ClearOldFilterValuesFromMenuTemplate(a,b){a:;SmtGridViewSetTextMenuItem(a,b,Strings.CMS.L_FilterThrottled_TEXT)}function SmtGridViewSetTextMenuItem(g,h,i){a:;var a=document.getElementById(g);if(a==null){alert("ERROR: SPGridView_FilterCallbackHandler() - menuTemplate == null");return}var f=document.getElementById(h);if(f==null){alert("ERROR: SPGridView_FilterCallbackHandler() - menu == null");return}for(var e=SmtGetChildren(a),b=0;b<e.length;b++){var c=e[b];if(c.attributes!=null&&c.getAttribute("isFilterItem")=="true"){a.removeChild(c);--b}}var d=CAMOpt(a,i,"","");d.setAttribute("isFilterItem","true");d.setAttribute("enabled","false");HideMenu(a);MMU_Open(a,f)}function SmtGridView_FilterCallbackErrorHandler(b,a){a:;alert("ERROR: SmtGridView_FilterCallbackErrorHandler() was called - result = "+b+", context = "+a)}function SetPopUpInnerContents(b,c){a:;b.innerHTML="";var a=document.createElement("div");a.innerHTML=c;b.appendChild(a)}function $(){a:;for(var c=[],b=0;b<arguments.length;b++){var a=arguments[b];if(typeof a=="string")a=document.getElementById(a);if(arguments.length==1)return a;c.push(a)}return c}function APD_Smt_TurnOnCamlFilter(){a:;if(null!=theForm){var a="Filter=1";if(theForm.action.indexOf(a)==-1)if(theForm.action.indexOf("?")>0)theForm.action+="&"+a;else theForm.action+="?"+a;var b="FilterOnly=1";if(theForm.action.indexOf(b)==-1)theForm.action+="&"+b}}function RenderAssociatedContentTypeField(j,i,h){var e=h[i.Name],a=document.createElement("div");a.innerHTML=e;var d=a.textContent;if(a.innerText!=null)d=a.innerText;var f,g,b,c=d.split(", ");if(c.length==2){f=c[1];g=c[0];var k=j.HttpRoot+"/_layouts/15/ManageContentType.aspx?ctype="+encodeURIComponent(f);b='<a href="'+STSHtmlEncode(k)+'" target="_new">'+STSHtmlEncode(g)+"</a>"}else b=e;return b}var CONST_ImageAssetPickerDialogName,CONST_LinkAssetPickerDialogName,CONST_EditHyperLinkDialogDialogName,CONST_EditImageDialogDialogName,CONST_AssetIconClassName,CONST_AssetBoommarkOnlyClassName,CONST_AssetPickerItemHoverClassName,CONST_AssetPickerItemSelectedClassName,CONST_AssetPickerRTE2AnchorPath,CONST_AssetBoommarkOnlyClassCssText,CONST_AssetPickerNewWindowQSParanName,CONST_AssetPickerSelectionClassName,CONST_SiteManagerSelectItemName,CONST_ImageSelectItemName,CONST_AssetPickerItemUrlDataLinkName,CONST_AssetPickerPagerTable,CONST_AssetPickerPagerLocation,CONST_AssetPickerNoItemSelectedIndex,CONST_AssetPickerModalDialogOptions,CONST_EditModalDialogOptions,CONST_AssetPickerQueryStringParamsToRender,g_APD_CSRRendering;function commonAttachEvent(a,c,b){a:;if(a.attachEvent)a.attachEvent("on"+c,b);else a.addEventListener(c,b,false)}function commonGetAttribute(a,c){a:;var b="";if(a)if(c!="hspace"&&a.getAttribute)b=a.getAttribute(c,2);else if(a.getAttributeNode){var d=a.getAttributeNode(c);if(d&&d.specified)b=d.value}return b}function commonGetEventElement(a){a:;if(!a)a=window.event;return!a?null:a.target?a.target:a.srcElement}function commonGetElementText(a){a:;if(a)if("undefined"!=typeof a.textContent)return a.textContent;else if("undefined"!=typeof a.innerText)return a.innerText;return null}function commonSetElementText(a,b){a:;if(a)if("undefined"!=typeof a.textContent)a.textContent=b;else if("undefined"!=typeof a.innerText)a.innerText=b}function AP_EncodeQParam(b,a){a:;return b+"="+encodeURIComponent(a)}function AP_GetCurrentQParamValue(a){a:;return AP_GetQParamValueFromString(a,window.location.search)}function AP_GetQParamValueFromString(d,b){a:;var c=new RegExp(d+"=([^&]*)","i"),a=b.match(c);return null==a?null:decodeURIComponent(a[1])}function AP_AppendQParamToUrl(c,b,a){a:;return/\?/.test(a)?a+"&"+AP_EncodeQParam(c,b):a+"?"+AP_EncodeQParam(c,b)}function AP_InsertQParamToUrl(a,c,b){a:;if(null==AP_GetQParamValueFromString(a,b))return AP_AppendQParamToUrl(a,c,b);else{var d=new RegExp(a+"=([^&]*)","i");return b.replace(d,AP_EncodeQParam(a,c))}}function AP_AppendQParamToQString(c,b,a){a:;return a&&""!=a?a+"&"+AP_EncodeQParam(c,b):AP_EncodeQParam(c,b)}function AP_InsertQParamToQString(a,c,b){a:;if(null==AP_GetQParamValueFromString(a,b))return AP_AppendQParamToQString(a,c,b);else{var d=new RegExp(a+"=([^&]*)","i");return b.replace(d,AP_EncodeQParam(a,c))}}function AP_GenerateSerializedObjectQString(a){a:;var d=true,c,b="";for(prop in a){c=typeof a[prop];if("string"==c||"boolean"==c||"number"==c){b=AP_InsertQParamToQString(prop,a[prop],b);"true"==AP_GetCurrentQParamValue("DebugQString")&&alert("Adding: "+prop+"("+typeof a[prop]+") = ["+a[prop]+"]\n"+b)}}return b}function AP_PopulateFromSerializedObjectQString(f,a){a:;var c=a,d=a.indexOf("?");if(-1!=d)c=a.substr(d);var e=c.split("&");for(var g in e){var b=e[g].split("=");if(b.length==2)f[b[0]]=decodeURIComponent(b[1])}}function AP_CopyObjectValues(b,c){a:;var a;for(prop in b){a=typeof b[prop];if("string"==a||"boolean"==a||"number"==a||prop=="ListItemFields")c[prop]=b[prop]}}function AP_QStringSerializeThisObject(){a:;return AP_GenerateSerializedObjectQString(this)}function AP_PopulateThisObjectFromQstring(){a:;return AP_PopulateFromSerializedObjectQString(this)}function AP_CopyValuesFromObjectToThisObject(a){a:;return AP_CopyObjectValues(a,this)}function AP_HtmlElementMatchesTagName(a,b){a:;return null==a||typeof a!="object"||"undefined"==a.tagName?false:a.tagName==b}function AP_LaunchModalDialogOnElement(b,d,g,e){a:;if(e)if(!this.PopulateValuesFromElement(d))return false;var h=null,f=false,a=this,c=b.ReturnCallback;b.ReturnCallback=function(i,h,e,b){a:;if(b){if(b.AssetUrl||b.Name){f=true;var g=a.ManageLinkDisplayText;a.CopyValuesFromObject(b);a.ManageLinkDisplayText=g;try{a.SetValuesIntoElement(d,e)}catch(j){window.alert(Strings.CMS.L_BrowserErrorSettingProperties_TEXT);return}}"function"==typeof c&&c(b.AssetUrl,b.AssetText,e,b)}};return g?this.LaunchModalEditProperties(b):this.LaunchModalAssetPicker(b)}var APD_AssetConfigGlobalObjectDictionary;function APD_GetAssetPickerConfig(a){a:;return APD_AssetConfigGlobalObjectDictionary[a]}function APD_LaunchAssetPickerUseConfigCurrentUrl(b){a:;var a=APD_GetAssetPickerConfig(b);!AP_IsEmpty(a)&&APD_LaunchAssetPicker(a.GetCurrentAssetUrlValue(),b);return null}function APD_LaunchAssetPicker(a,d){a:;var b=APD_GetAssetPickerConfig(d);if(!AP_IsEmpty(b)){if(AP_IsEmpty(a))a="";var c;if(true==b.UseImageAssetPicker)c=new ImageAsset(a);else c=new LinkAsset(a);c.LaunchModalAssetPicker(b)}return null}function AssetPickerConfig(a){a:;this.ClientID=a;APD_AssetConfigGlobalObjectDictionary[a]=this;SP.SOD.executeFunc("SP.js","SP.Utilities.Utility.getLayoutsPageUrl",null)}function AssetPickerConfig_GetDialogUrl(a){a:;return SP.Utilities.Utility.getLayoutsPageUrl(a)}function AssetPickerConfig_GetDialogFeatures(b){a:;var a=b;if(this.OverrideDialogFeatures&&this.OverrideDialogFeatures!="")a=this.OverrideDialogFeatures;return a}function AssetPickerConfig_GetCurrentAssetUrlValue(){a:;var a="";if(!AP_IsEmpty(this.AssetUrlClientID)){var b=document.getElementById(this.AssetUrlClientID);if(!AP_IsEmpty(b)){a=b.value;if(AP_IsEmpty(a))a=this.DefaultAssetImageLocation;if(AP_IsEmpty(a))a=this.DefaultAssetLocation}}return a}function AssetPickerConfig_LaunchUrlWithAsset(c,b){a:;var a=b;if(this.OverrideDialogFeatures&&this.OverrideDialogFeatures!=null)a=this.OverrideDialogFeatures;g_APO_CachedCurrentConfigForDialog=this;a.url=c;a.dialogReturnValueCallback=APO_InternalCallbackHandler;SP.SOD.executeFunc("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",function(){a:;SP.UI.ModalDialog.showModalDialog(a);return null})}var g_APO_CachedCurrentConfigForDialog;function APO_InternalCallbackHandler(e,b){a:;if(!e)return;if(!AP_IsEmpty(g_APO_CachedCurrentConfigForDialog)&&"object"==typeof b&&null!=b){var a=new LinkAsset;if(g_APO_CachedCurrentConfigForDialog.UseImagePicker)a=new ImageAsset;a.CopyValuesFromObject(b);if(!AP_IsEmpty(g_APO_CachedCurrentConfigForDialog.AssetUrlClientID)&&!AP_IsEmpty(a.AssetUrl)){var d=document.getElementById(g_APO_CachedCurrentConfigForDialog.AssetUrlClientID);if(!AP_IsEmpty(d))d.value=a.AssetUrl}if(!AP_IsEmpty(g_APO_CachedCurrentConfigForDialog.AssetTextClientID)&&!AP_IsEmpty(a.AssetText)){var c=document.getElementById(g_APO_CachedCurrentConfigForDialog.AssetTextClientID);if(!AP_IsEmpty(c))c.value=a.AssetText}"function"==typeof g_APO_CachedCurrentConfigForDialog.ReturnCallback&&g_APO_CachedCurrentConfigForDialog.ReturnCallback(a.AssetUrl,a.AssetText,g_APO_CachedCurrentConfigForDialog,a)}g_APO_CachedCurrentConfigForDialog=null}function AssetPickerConfig_GenerateQueryStringSegment(){a:;var a={};a.DefaultAssetLocation=this.DefaultAssetLocation;a.DefaultAssetImageLocation=this.DefaultAssetImageLocation;a.DisplayLookInSection=this.DisplayLookInSection;a.DefaultToLastUsedLocation=this.DefaultToLastUsedLocation;a.ManageHyperlink=this.ManageHyperlink;a.DisplayWidth=this.DisplayWidth;a.DisplayHeight=this.DisplayHeight;a.RenditionId=this.RenditionId;a.AllowExternalUrls=this.AllowExternalUrls;a.OverrideDialogImageUrl=this.OverrideDialogImageUrl;a.AssetType=this.AssetType;a.OverrideDialogTitle=this.OverrideDialogTitle;a.APDExts=this.APDExts;a.ReturnItemFields=this.ReturnItemFields;return AP_GenerateSerializedObjectQString(a)}function ImageAsset(a){a:;this.AssetUrl=a}function ImageAsset_LaunchModalAssetPicker(a){a:;if(a.AssetType=="")a.AssetType="Image";var b=a.GetDialogUrl(CONST_ImageAssetPickerDialogName)+"?APDView=Thumbs&"+CONST_AssetPickerNewWindowQSParanName+"=true&"+a.GenerateQueryStringSegment()+"&"+this.GenerateQueryStringSegment();return a.LaunchUrlWithAsset(b,CONST_AssetPickerModalDialogOptions)}function ImageAsset_LaunchModalEditProperties(a){a:;var b=a.GetDialogUrl(CONST_EditImageDialogDialogName)+"?"+a.GenerateQueryStringSegment()+"&"+this.GenerateQueryStringSegment();return a.LaunchUrlWithAsset(b,CONST_EditModalDialogOptions)}function ImageAsset_PopulateValuesFromElement(a){a:;if(!AP_HtmlElementMatchesTagName(a,"IMG"))return false;this.AssetUrl=commonGetAttribute(a,"src");this.AssetText=commonGetAttribute(a,"alt");if(!this.AssetUrl||this.AssetUrl==""){this.Height=0;this.Width=0}else{var c=false;if(a.style.height||commonGetAttribute(a,"height"))c=true;var d=false;if(a.style.width||commonGetAttribute(a,"width"))d=true;this.Width=a.width;this.Height=a.height;this.UseDefaultSize=true;if(d||c){this.UseDefaultSize=false;if(!d)this.Width="";if(!c)this.Height=""}}this.Border=0;if(a.style.borderWidth){if(-1!=a.style.borderWidth.toString().indexOf("px")){this.Border=parseInt(a.style.borderWidth);if(this.Border.isNaN)this.Border=0}}else if(commonGetAttribute(a,"border"))this.Border=commonGetAttribute(a,"border");this.HSpacing="";if(a.style.marginLeft&&-1!=a.style.marginLeft.indexOf("px")&&a.style.marginRight&&a.style.marginLeft==a.style.marginRight){this.HSpacing=parseInt(a.style.marginLeft);if(this.HSpacing.isNaN)this.HSpacing=""}if(this.HSpacing==""&&commonGetAttribute(a,"hspace"))this.HSpacing=commonGetAttribute(a,"hspace");this.VSpacing="";if(a.style.marginTop&&-1!=a.style.marginTop.indexOf("px")&&a.style.marginBottom&&a.style.marginTop==a.style.marginBottom){this.VSpacing=parseInt(a.style.marginBottom);if(this.VSpacing.isNaN)this.VSpacing=""}if(this.VSpacing==""&&commonGetAttribute(a,"vspace"))this.VSpacing=commonGetAttribute(a,"vspace");this.Alignment="";if(commonGetAttribute(a,"align"))this.Alignment=a.align;if(AP_HtmlElementMatchesTagName(a.parentNode,"A")){var b=a.parentNode;if(commonGetAttribute(b,"href")&&""!=commonGetAttribute(b,"href"))this.Hyperlink=commonGetAttribute(b,"href");this.Target=commonGetAttribute(b,"target")}else{this.Hyperlink="";this.Target=""}return true}function ImageAsset_SetValuesIntoElement(a,c){a:;if(!AP_HtmlElementMatchesTagName(a,"IMG"))return false;var b=a.parentNode;if(!AP_HtmlElementMatchesTagName(b,"A"))b=null;a.removeAttribute("src");a.removeAttribute("alt");a.removeAttribute("border");a.removeAttribute("hspace");a.removeAttribute("vspace");a.removeAttribute("align");a.style.width="";a.style.height="";a.style.border="";a.style.borderStyle="";a.style.borderBottomStyle="";a.style.borderLeftStyle="";a.style.borderRightStyle="";a.style.borderTopStyle="";a.style.borderWidth="";a.style.borderBottom="";a.style.borderBottomWidth="";a.style.borderLeft="";a.style.borderLeftWidth="";a.style.borderRight="";a.style.borderRightWidth="";a.style.borderTop="";a.style.borderTopWidth="";a.style.margin="";a.style.marginBottom="";a.style.marginLeft="";a.style.marginRight="";a.style.marginTop="";a.style.textAlign="";a.style.verticalAlign="";a.src=this.AssetUrl;if(c&&c.ManageHyperlink&&b!=null)if(this.Hyperlink&&this.Hyperlink!=""){b.href=this.Hyperlink;if(this.Target&&this.Target!="")b.target=this.Target;else b.removeAttribute("target")}else b.removeAttribute("href");a.removeAttribute("width");a.removeAttribute("height");if(this.AssetText&&this.AssetText!="")a.alt=this.AssetText;if(!this.UseDefaultSize&&this.Width&&this.Width!="")a.style.width=this.Width+"px";if(!this.UseDefaultSize&&this.Height&&this.Height!="")a.style.height=this.Height+"px";if(this.Border&&this.Border!=""){a.border=this.Border;a.style.borderWidth=this.Border+"px";a.style.borderStyle="solid"}if(this.HSpacing&&this.HSpacing!="")a.hspace=this.HSpacing;if(this.VSpacing&&this.VSpacing!="")a.vspace=this.VSpacing;if(this.Alignment&&this.Alignment!="")a.align=this.Alignment;return true}function ImageAsset_GenerateSeralizedData(){a:;var a={};a.USEDEFAULTSIZE=this.UseDefaultSize;a.SRC=this.AssetUrl;a.ALT=this.AssetText;a.ALIGN=this.Alignment;a.HSPACE=this.HSpacing;a.VSPACE=this.VSpacing;a.BORDER=this.Border;if(!this.UseDefaultSize&&this.Height&&this.Height!=""&&this.Height!=0)a.HEIGHT=this.Height;if(!this.UseDefaultSize&&this.Width&&this.Width!=""&&this.Width!=0)a.WIDTH=this.Width;if(this.Target&&this.Target!="")a.TARGET=this.Target;if(this.Hyperlink&&this.Hyperlink!="")a.HREF=this.Hyperlink;return AP_GenerateSerializedObjectQString(a)}function ImageAsset_ReadSerializedData(b){a:;var a={};AP_PopulateFromSerializedObjectQString(a,b);this.UseDefaultSize=a.USEDEFAULTSIZE;this.AssetUrl=a.SRC;this.AssetText=a.ALT;this.Alignment=a.ALIGN;this.HSpacing=a.HSPACE;this.VSpacing=a.VSPACE;this.Border=a.BORDER;this.Height=a.HEIGHT;this.Width=a.WIDTH;this.Hyperlink=a.HREF;this.Target=a.TARGET;return a}function LinkAsset(a){a:;this.AssetUrl=a}function LinkAsset_LaunchModalAssetPicker(a){a:;if(a.AssetType=="")a.AssetType="Link";var b=a.GetDialogUrl(CONST_LinkAssetPickerDialogName)+"?"+a.GenerateQueryStringSegment()+"&"+CONST_AssetPickerNewWindowQSParanName+"=true&"+this.GenerateQueryStringSegment();return a.LaunchUrlWithAsset(b,CONST_AssetPickerModalDialogOptions)}function LinkAsset_LaunchModalEditProperties(a){a:;var b=a.GetDialogUrl(CONST_EditHyperLinkDialogDialogName)+"?"+a.GenerateQueryStringSegment()+"&"+this.GenerateQueryStringSegment();return a.LaunchUrlWithAsset(b,CONST_EditModalDialogOptions)}function LinkAsset_PopulateValuesFromElement(a){a:;if(!AP_HtmlElementMatchesTagName(a,"A"))return false;this.AssetUrl=commonGetAttribute(a,"href");this.Name=commonGetAttribute(a,"name");if(this.Name=="")this.Name=commonGetAttribute(a,"id");if(this.ManageLinkDisplayText)this.AssetText=commonGetElementText(a);this.Target=commonGetAttribute(a,"target");this.TooltipText=commonGetAttribute(a,"title");this.IconUrl="";var b=this.FindAssetIconElement(a);if(b)this.IconUrl=commonGetAttribute(b,"src");return true}function LinkAsset_FindAssetIconElement(d){a:;var a=d.childNodes,c=null;if(a!=null&&a.length>0)for(var b=0;b<a.length;b++)if(a[b].tagName=="IMG"&&a[b].className==CONST_AssetIconClassName){c=a[b];break}return c}function LinkAsset_FixupIconsAndEmptyAnchors(a){a:;var b=LinkAsset_FindAssetIconElement(a);if(this.IconUrl)if(b)b.src=this.IconUrl;else a.innerHTML='<img class="'+CONST_AssetIconClassName+'" src="'+this.IconUrl+'" border="0" />'+a.innerHTML;else b&&b.parentNode.removeChild(b);var e=!AP_IsEmpty(this.AssetUrl),d=!AP_IsEmpty(this.TooltipText),f=!AP_IsEmpty(this.Name),c=AP_IsEmpty(a.innerHTML);if(f&&!e&&c){a.className=CONST_AssetBoommarkOnlyClassName;if(!d&&AP_IsEmpty(a.title))a.title=this.Name}else if(!AP_IsEmpty(a.className))a.className=a.className.replace(CONST_AssetBoommarkOnlyClassName,"");if(!d&&!c&&this.Name==a.title)a.title=""}function LinkAsset_SetValuesIntoElement(a){a:;if(!AP_HtmlElementMatchesTagName(a,"A"))return false;var b=this.AssetUrl&&this.AssetUrl!="",c=this.AssetText&&this.AssetText!="",d=this.Name&&this.Name!="";if(b){a.href=this.AssetUrl;a.target=this.Target}else{a.removeAttribute("href");a.removeAttribute("target")}a.removeAttribute("name");a.removeAttribute("id");if(d){a.name=this.Name;a.id=this.Name}if(!c)if(b)this.AssetText=this.AssetUrl;else this.AssetText="";(this.ManageLinkDisplayText||AP_IsEmpty(commonGetElementText(a)))&&commonSetElementText(a,this.AssetText);a.title=this.TooltipText;this.FixupIconsAndEmptyAnchors(a);return true}function LinkAsset_GenerateSeralizedData(){a:;var a={};a.MANAGELINKDISPLAYTEXT=this.ManageLinkDisplayText;a.MANAGELINKICON=this.ManageLinkIcon;a.HREF=this.AssetUrl;a.NAME=this.Name;a.HTMLTAGTEXT=this.AssetText;a.TITLE=this.TooltipText;a.TARGET=this.Target;a.SRC=this.IconUrl;return AP_GenerateSerializedObjectQString(a)}function LinkAsset_ReadSerializedData(b){a:;var a={};AP_PopulateFromSerializedObjectQString(a,b);this.ManageLinkDisplayText=a.MANAGELINKDISPLAYTEXT;this.ManageLinkIcon=a.MANAGELINKICON;this.AssetUrl=a.HREF;this.Name=a.NAME;this.AssetText=a.HTMLTAGTEXT;this.TooltipText=a.TITLE;this.Target=a.TARGET;this.IconUrl=a.SRC}var g_APD_locationUrlInput,g_APD_objectListDiv,g_APD_dictItemRows,g_APD_arrItemRows,g_APD_usingThumbnailMode,g_APD_itemHandlersAdded;function APD_InitializeAssetPickerElements(b){if(!AP_IsEmpty(g_APD_returnedUrl))if(APD_SetReturnValuesAndCloseDialog(g_APD_returnedUrl,g_APD_returnedText,g_APD_returnPromptString,g_APD_returnListItemFields))return;else{g_APD_returnedUrl="";g_APD_returnedText="";g_APD_returnPromptString=""}if(APD_Def(_fV4UI))_fV4UI=true;g_APD_CSRRendering=APD_Def(b);APD_Smt_TurnOnCamlFilter();APD_EnsureListContext(b);APD_InAssetPicker();APD_InitializeAssetItemRowObjects(b);if(g_APD_locationUrlInput){commonAttachEvent(g_APD_locationUrlInput,"keydown",APD_HandleLocationKeyDown);commonAttachEvent(g_APD_locationUrlInput,"paste",APD_ClearSelection);commonAttachEvent(g_APD_locationUrlInput,"change",APD_ClearSelection);g_APD_locationUrlInput.focus()}g_APD_objectListDiv=document.getElementById("ObjectListDiv");var c=null;if(g_APD_objectListDiv){c=g_APD_objectListDiv;var a=APD_FirstChildOfTagTName(g_APD_objectListDiv,"DIV");if(a){a=APD_FirstChildOfTagTName(a,"DIV");a.style.width="100%"}}}function APD_InitializeAssetItemRowObjects(a){g_APD_dictItemRows={};g_APD_arrItemRows=new Array(0);var b;if(APD_Def(a)){var j=a.ListData!=null&&a.ListData[a.ListDataJSONItemsKey]!=null&&a.ListData[a.ListDataJSONItemsKey].length>0;if(j){var g=0;do var f=GenerateIIDForListItem(a,a.ListData[a.ListDataJSONItemsKey][g]),l=f.indexOf("undefined")!=-1&&a.ListData[a.ListDataJSONItemsKey].length>++g;while(l);var i=document.getElementById(f);if(i!=null&&i.parentNode!=null)for(var h=g;h<a.ListData[a.ListDataJSONItemsKey].length;h++)(function(){a:;var c=a.ListData[a.ListDataJSONItemsKey][h];f=GenerateIIDForListItem(a,c);var d=document.getElementById(f);b=new AssetPickerCSRItem(d,c);if(APD_IsNullOrEmpty(b.navUrl))b.navUrl=CreateItemPropertiesTitleUrl(a,c);APD_CacheItem(b.itemName,b)})()}}else if("undefined"!=typeof g_AssetPickerPageCache){for(var e=document.getElementsByName(CONST_ImageSelectItemName),c=0;c<e.length;c++){b=new AssetPickerItemList(e[c]);APD_CacheItem(b.itemName,b)}g_APD_itemHandlersAdded=true}else for(var e=document.getElementsByName(CONST_SiteManagerSelectItemName),c=0;c<e.length;c++){b=new AssetPickerItemRow(e[c]);APD_CacheItem(b.nodeID,b)}APD_Pager();var d=document.getElementById("AddNewItemLink"),k=APD_Def(d)&&APD_Def(d.parentNode)&&d.parentNode.hasAttribute("data-ieonly");if(k&&APD_Def(browseris)&&!browseris.ie)d.parentNode.style.display="none"}function APD_CacheItem(b,a){g_APD_dictItemRows[b]=a;g_APD_arrItemRows.push(a)}function APD_EnsureListContext(b){var a=null;if("undefined"!=typeof g_AssetPickerXslContext&&null!=g_AssetPickerXslContext)a=g_AssetPickerXslContext.ListId();else if(APD_Def(b))a=b.listName;a&&APD_AddQP("List",a)}var g_APD_returnedUrl,g_APD_returnedText,g_APD_returnPromptString,g_APD_returnListItemFields;function APD_SetReturnValuesAndCloseDialog(e,d,b,c){a:;var a=true;if(window.confirm)if(!AP_IsEmpty(b))a=window.confirm(b);SP.SOD.executeFunc("SP.UI.Dialog.js","SP.UI.ModalDialog.get_childDialog",function(){a:;if(a){var f=new ImageAsset(e);f.AssetText=d;f.ListItemFields=c;var b=SP.UI.ModalDialog.get_childDialog();if(APD_Def(b)){b.set_returnValue(f);b.close(SP.UI.DialogResult.OK)}}return a})}var g_APD_CachedReturnValue;function APD_OkReturnAndClose(a){a:;APD_CloseDialogWithReturnValues(a.navUrl,a.itemName)}function APD_CloseDialogWithReturnValues(b,a){a:;g_APD_CachedReturnValue=new LinkAsset(APD_TrimSpace(b));g_APD_CachedReturnValue.AssetText=a;"function"==typeof APD_CallBackVerifyChosenUrl&&APD_CallBackVerifyChosenUrl(g_APD_CachedReturnValue.AssetUrl)}function APD_HandleReturnValuesForDialogClose(d,c,b,a){a:;g_APD_returnedUrl=d;g_APD_returnedText=c;g_APD_returnPromptString=b;if(a)g_APD_returnListItemFields=a}function AssetPickerItemRow(b){a:;this.thumbnailTable=APD_ParentElement("TABLE",b);this.tableRow=APD_ParentElement("TR",b);var a=this.tableRow;if(g_APD_usingThumbnailMode)a=this.thumbnailTable;if(a){this.listItem=a;if(!g_APD_itemHandlersAdded){commonAttachEvent(a,"click",APD_HandleSelection);commonAttachEvent(a,"dblclick",APD_HandleDoubleClick);commonAttachEvent(a,"keydown",APD_HandleItemKeyDown)}this.hiddenCheckbox=APD_FindNamedElement(CONST_SiteManagerSelectItemName,a.getElementsByTagName("INPUT"),false);if(this.hiddenCheckbox)this.nodeID=this.hiddenCheckbox.id;var c=a.getElementsByTagName("A");APD_DisableAllAnchorElements(c);this.urlDataAnchor=APD_FindNamedElement(CONST_AssetPickerItemUrlDataLinkName,c,false);if(this.urlDataAnchor){this.itemName=this.urlDataAnchor.innerText;this.navUrl=this.urlDataAnchor.getAttribute("navUrl");if(APD_IsNullOrEmpty(this.navUrl))this.navUrl="";this.propsUrl=this.urlDataAnchor.getAttribute("propsUrl");if(APD_IsNullOrEmpty(this.propsUrl))this.propsUrl="";this.absUrl=this.urlDataAnchor.getAttribute("absUrl");if(APD_IsNullOrEmpty(this.absUrl))this.absUrl="";this.isContainer=this.urlDataAnchor.getAttribute("isContainer")=="true";this.tableCell=APD_ParentElement("TD",this.urlDataAnchor);if(!g_APD_usingThumbnailMode&&this.tableCell)this.focusElement=this.tableCell;else this.focusElement=a;this.focusElement.tabIndex=0}this.GetIsSelected=function(){a:;return this.hiddenCheckbox.checked};this.SetIsSelected=function(b){a:;if(b){this.hiddenCheckbox.checked=true;a.focus();APD_AddCssClass(this.listItem,CONST_AssetPickerItemSelectedClassName);this.focusElement&&this.focusElement.focus()}else{this.hiddenCheckbox.checked=false;APD_RemoveCssClass(this.listItem,CONST_AssetPickerItemSelectedClassName)}}}}function APD_GetItemRowObject(e){a:;var c=null,b="TR";if(g_APD_usingThumbnailMode)b="TABLE";var d=APD_ParentElement(b,e);if(d){var a=null;a=APD_FindNamedElement(CONST_SiteManagerSelectItemName,d.getElementsByTagName("INPUT"),false);if(a)c=g_APD_dictItemRows[a.id]}return c}function APD_Pager(){a:;var b=CONST_AssetPickerPagerTable,a=document.getElementById(CONST_AssetPickerPagerLocation);if(!a)return;var d=document.getElementById(b);if(!d&&a.hasChildNodes()&&a.childNodes[0].nodeType!=3)return;if("undefined"==typeof document.forms[0].elements.firstrow||"undefined"==typeof document.forms[0].elements.lastrow){a.parentNode.style.display="none";return}var e=document.forms[0].elements.firstrow.value,f=document.forms[0].elements.lastrow.value,c=document.forms[0].elements.nextpagedata.value;APD_RenderPager(CONST_AssetPickerPagerLocation,b,c,e,f,APD_NextPage,APD_PrevPage)}function APD_RenderPager(n,l,j,g,f,h,i){a:;var e,b,d,a,k=document.getElementById(n);if(!k)return;if(!h)h=APD_NextPage;if(!i)i=APD_PrevPage;var c=document.getElementById(l);if(!c){c=document.createElement("table");c.id=l;c.cellpadding=0;c.cellspacing=0;c.border=0}else c.deleteRow(0);e=c.insertRow(c.rows.length);b=e.insertCell(e.cells.length);b.setAttribute("valign","center");if(g>1){d=document.createElement("a");d.setAttribute("href","#");if("function"==typeof i)d.onclick=i;a=document.createElement("img");a.setAttribute("border","0");a.setAttribute("alt",Strings.CMS.L_PrevPage_TEXT);a.setAttribute("src",Strings.CMS.L_APDPrevImgUrl);d.appendChild(a);b.appendChild(d)}else{a=document.createElement("img");a.setAttribute("border","0");a.setAttribute("src","/_layouts/15/images/blank.gif?rev=23");b.appendChild(a)}b=e.insertCell(e.cells.length);b.vAlign="middle";b.className="ms-listheaderlabel";b.noWrap=true;if(null==f)f=0;if(null==g)g=0;if(f>0)b.innerHTML="&nbsp;"+g+"-"+f+"&nbsp;";b=e.insertCell(e.cells.length);b.setAttribute("valign","center");var m=j.length==j.indexOf(";")+1?true:false;if(m){a=document.createElement("img");a.setAttribute("border","0");a.setAttribute("src","/_layouts/15/images/blank.gif?rev=23");b.appendChild(a)}else{d=document.createElement("a");d.setAttribute("href","#");if("function"==typeof h)d.onclick=h;a=document.createElement("img");a.setAttribute("border","0");a.setAttribute("alt",Strings.CMS.L_NextPage_TEXT);a.setAttribute("src",Strings.CMS.L_APDNextImgUrl);d.appendChild(a);b.appendChild(d)}k.appendChild(c)}function APD_PrevPage(){a:;if("undefined"!=typeof g_AssetPickerPageCache){g_AssetPickerPageCache.pop();var a=g_AssetPickerPageCache.GetCurrent();if(a){APD_SetPageContent(a[3]);APD_InitializeAssetPickerElements();APD_RenderPager(CONST_AssetPickerPagerLocation,CONST_AssetPickerPagerTable,a[0],a[1],a[2])}else history.back()}else history.back()}function APD_NextPage(){a:;if("undefined"==typeof document.forms[0].elements.webpartclientid||"undefined"==typeof document.forms[0].elements.nextpagedata){alert("Serious Error: Cannot find args for paging.");return}var b=document.forms[0].elements.webpartclientid.value,a=document.forms[0].elements.nextpagedata.value;DoPagingCallback(b,a)}function UpdatePaging(b){a:;if(!(null==b||b.length==0)){APD_SetPageContent(b);APD_InitializeAssetPickerElements();if("undefined"!=typeof g_AssetPickerPageCache){g_AssetPickerPageCache.push(b);var a=g_AssetPickerPageCache.GetCurrent();a&&APD_RenderPager(CONST_AssetPickerPagerLocation,CONST_AssetPickerPagerTable,a[0],a[1],a[2])}}}function APD_SetPageContent(b){a:;var a=APD_FindContentContainer();a.innerHTML=b}function APD_FindContentContainer(){a:;var a=document.getElementById(CONST_AssetPickerImagesElementName);if(a)return a.parentNode;else if("undefined"!=typeof document.forms[0].elements.listid){var b=document.forms[0].elements.listid.value,c=document.getElementsByTagName("table");a=APD_FindNamedElement(b,c,true);return APD_Def(a)?a.parentNode:null}else a=document.getElementById(g_APD_objectListDiv);return a}function AssetPickerPageCache(){a:;this.push=function(d){a:;var c=0,b=0,a="";if("undefined"!=typeof document.forms[0].elements.firstrow)c=document.forms[0].elements.firstrow.value;if("undefined"!=typeof document.forms[0].elements.lastrow)b=document.forms[0].elements.lastrow.value;if("undefined"!=typeof document.forms[0].elements.nextpagedata)a=document.forms[0].elements.nextpagedata.value;this.TokenCache.push([a,c,b]);this.Cache.push(d)};this.pop=function(){a:;var a,b,c;if(this.TokenCache.length>0&&this.Cache.length>0){a=this.TokenCache.pop();b=this.Cache.pop();c=[a[0],a[1],a[2],b]}else c=null;return null};this.GetCurrent=function(){a:;var a,c,b;if(this.TokenCache.length>0&&this.Cache.length>0){a=this.TokenCache[this.TokenCache.length-1];c=this.Cache[this.Cache.length-1];b=[a[0],a[1],a[2],c]}else b=null;return b};this.length=function(){a:;return this.Cache.length}}function AssetPickerXslContext(){a:;this.Picking=function(){a:;var a=false;if("undefined"!=typeof document.forms[0].elements.assetpicking)a=document.forms[0].elements.assetpicking.value=="yes"?true:false;return a};this.WebPartClientId=function(){a:;var a=null;if("undefined"!=typeof document.forms[0].elements.webpartclientid)a=document.forms[0].elements.webpartclientid.value;return a};this.NextPageData=function(){a:;var a=null;if("undefined"!=typeof document.forms[0].elements.nextpagedata)a=document.forms[0].elements.nextpagedata.value;return a};this.FirstRow=function(){a:;var a=null;if("undefined"!=typeof document.forms[0].elements.firstrow)a=document.forms[0].elements.firstrow.value;return a};this.LastRow=function(){a:;var a=null;if("undefined"!=typeof document.forms[0].elements.lastrow)a=document.forms[0].elements.lastrow.value;return a};this.ListId=function(){a:;var a=null;if("undefined"!=typeof document.forms[0].elements.listid)a=document.forms[0].elements.listid.value;return a};this.ThumbnailSize=function(){a:;var a=0;if("undefined"!=typeof document.forms[0].elements.thumbnailsize)a=parseInt(document.forms[0].elements.thumbnailsize.value);return a};this.WebImageWidth=function(){a:;var a=0;if("undefined"!=typeof document.forms[0].elements.webimagewidth)a=parseInt(document.forms[0].elements.webimagewidth.value);return a};this.WebImageHeight=function(){a:;var a=0;if("undefined"!=typeof document.forms[0].elements.webimageheight)a=parseInt(document.forms[0].elements.webimageheight.value);return a};this.ImageSizeStyle=function(){a:;var a;if("undefined"!=typeof document.forms[0].elements.APDThumbNailStyle)a=parseInt(document.forms[0].elements.APDThumbNailStyle.value);return a};this.CanEdit=function(){a:;var a=true;if("undefined"!=typeof document.forms[0].elements.canedit)a=document.forms[0].elements.canedit.value=="true"?true:false;return a}}function APD_EnterFolder(a){a:;if(null==a&&"undefined"!=g_APD_arrItemRows)for(var c=null,b=0;b<g_APD_arrItemRows.length;b++){c=g_APD_arrItemRows[b];if(c.rootFolder==g_APD_locationUrlInput.value)a=c}if(null!=theForm&&null!=a&&a.isContainer){APD_SetRootFolderContext(a.rootFolder,a.folderCTID);theForm.submit()}}function APD_HandleSelection(b){a:;var a=commonGetEventElement(b),c=APD_SetSelectionFromElement(a,APD_MultiSelection(b,a))}function APD_SetSelectionFromElement(b,c){a:;var a=null;if(g_APD_CSRRendering)a=APD_GetCSRItemObject(b);else if("undefined"!=typeof g_AssetPickerPageCache)a=APD_GetItemListObject(b);else a=APD_GetItemRowObject(b);if(a){!a.GetIsSelected()&&(null==c||false==c)&&APD_ClearSelection();if(b.tagName=="INPUT")a.SetIsSelected(a.GetIsSelected());else a.SetIsSelected(!a.GetIsSelected());if("undefined"!=typeof g_APD_locationUrlInput&&null!=g_APD_locationUrlInput)g_APD_locationUrlInput.value=a.navUrl}return a}function APD_HandleDoubleClick(b){a:;var a=APD_SetSelectionFromElement(commonGetEventElement(b));if(a)if(a.isContainer)if(g_APD_CSRRendering||"undefined"!=typeof g_AssetPickerPageCache)APD_EnterFolder(a);else document.location=a.urlDataAnchor.href;else APD_OkReturnAndClose(a)}function APD_ClearSelection(){a:;for(var b=null,a=0;a<g_APD_arrItemRows.length;a++){g_APD_arrItemRows[a].GetIsSelected()&&g_APD_arrItemRows[a].SetIsSelected(false,false);if(APD_Def(g_APD_arrItemRows[a].hiddenCheckbox))b=g_APD_arrItemRows[a].hiddenCheckbox.getAttribute("iid")}return null}function APD_HandleItemKeyDown(a){a:;var b=APD_MultiSelection(a);switch(a.keyCode){case 32:var c=APD_SetSelectionFromElement(commonGetEventElement(a));a.preventDefault&&a.preventDefault();return false;break;case 13:APD_HandleDoubleClick(a);break;case 39:case 40:APD_SelectNextItemRow(commonGetEventElement(a),b);break;case 37:case 38:APD_SelectPreviousItemRow(commonGetEventElement(a),b)}}function APD_HandleLocationKeyDown(a){a:;(a.keyCode==8||a.keyCode==32||a.keyCode>45)&&APD_ClearSelection(a)}function APD_MultiSelection(b,a){a:;return"undefined"!=typeof g_AssetPickerXslContext&&!g_AssetPickerXslContext.Picking()&&(b.ctrlKey||a&&a.tagName=="INPUT")}function APD_SelectNextItemRow(d,c){a:;var a=APD_GetHighestSelectedItemIndex(),b=APD_GetItemRowByIndex(a+1);if(a!=CONST_AssetPickerNoItemSelectedIndex&&b){false==c&&APD_ClearSelection();APD_SetSelectionFromElement(b.listItem)}}function APD_SelectPreviousItemRow(c,b){a:;var a=APD_GetItemRowByIndex(APD_GetLowestSelectedItemIndex()-1);if(a){false==b&&APD_ClearSelection();APD_SetSelectionFromElement(a.listItem)}}function APD_GetItemRowByIndex(a){a:;return a>=0&&a<g_APD_arrItemRows.length?g_APD_arrItemRows[a]:null}function APD_GetCurrentlySelectedItemRow(){a:;return APD_GetItemRowByIndex(APD_GetHighestSelectedItemIndex())}function APD_GetLowestSelectedItemIndex(){a:;for(var a=0;a<g_APD_arrItemRows.length;a++)if(g_APD_arrItemRows[a].GetIsSelected())return a;return CONST_AssetPickerNoItemSelectedIndex}function APD_GetHighestSelectedItemIndex(){a:;for(var a=g_APD_arrItemRows.length-1;a>=0;a--)if(g_APD_arrItemRows[a].GetIsSelected())return a;return CONST_AssetPickerNoItemSelectedIndex}function APD_Validate(e){a:;var c=true;if(g_APD_locationUrlInput.value.indexOf("/")!=0){c=false;if(APD_AnalyzeUrl(g_APD_locationUrlInput.value,e))c=true}else if("undefined"!=g_APD_arrItemRows){for(var b=null,a=null,d=0;d<g_APD_arrItemRows.length;d++){b=g_APD_arrItemRows[d];if(APD_Str(b.rootFolder)&&b.rootFolder.toLowerCase()==g_APD_locationUrlInput.value.toLowerCase()){a=b;break}}if(null!=a)a.isContainer&&APD_SetRootFolderContext(a.rootFolder,a.folderCTID)}return c}function APD_SetRootFolderContext(a,b){a:;APD_RemoveFormQP("RootFolder");APD_RemoveFormQP("FolderCTID");APD_AddFormQP("RootFolder",a);APD_AddFormQP("FolderCTID",b)}function APD_GoToUrlHook(postback){a:;var go=APD_Validate(true);if(go==true)eval(postback)}function APD_AnalyzeUrl(a,d){a:;var b=false;try{var h=APD_GetProtocol(a),g=APD_GetPort(a),e=APD_GetHost(a),f=APD_GetPath(a);b=true}catch(i){if(!d){var c=Strings.CMS.L_CannotRedirect_TEXT+"'"+a+"' ... "+i;alert(c)}b=false}return b}function APD_GetProtocol(b){a:;var c=b.search(/http[s]{0,1}:[\/]{2}[^\/]+/i);if(c==-1)throw Strings.CMS.L_InvalidProtocol_TEXT;var a=b.match(/^(http[s]{0,1}):[\/]{2}[^\/]+/i);return a[a.length-1]}function APD_GetPort(a){a:;var b=a.search(/[\/]{2}[^\/]+:([0-9]{2,})/);if(b==-1)return 80;var c=a.match(/[\/]{2}[^\/]+:([0-9]{2,10})/);return c[1]}function APD_GetHost(a){a:;var b=a.search(/[\/]{2}([^:\/\s]+)[\/:]?/);if(b==-1)throw Strings.CMS.L_InvalidHostname_TEXT;var c=a.match(/[\/]{2}([^:\/\s]+)[\/:]?/);return c[1]}function APD_GetPath(b){a:;var a=b.match(/[\/]{2}([^\/:]+):{0,1}([^\/]*)([\/]?[\S]*)/);return a[3]}function APD_TrimSpace(b){a:;var a=b.replace(/^\s+/g,"");return a.replace(/\s+$/g,"")}function APD_FirstChildOfTagTName(d,e){a:;for(var b=null,a=0;a<d.childNodes.length;a++){var c=d.childNodes[a];if(AP_HtmlElementMatchesTagName(c,e)){b=c;return b}}return null}function APD_ParentElement(d,c,b){a:;if(!APD_Def(b))b=false;var a=c;while(null!=a){if(a.nodeName==d&&(!b||!APD_IsNullOrEmpty(a.id)))break;a=a.parentNode}return a}function APD_FindNamedElement(c,b,d){a:;for(var a=0;a<b.length;a++){if(b[a].name==c)return b[a];if(d&&-1!=b[a].id.search(c))return b[a]}return null}function APD_AddQP(a,b){a:;if(!APD_Str(a)||!APD_Str(b))return;if(""!=a&&""!=b)APD_AddFormQP(a,b);else""!=a&&""==b&&APD_RemoveFormQP(a)}function APD_RemoveFormQP(a){a:;if(null==a||!APD_Str(a))return;if(null!=theForm)theForm.action=APD_RemoveQPFromUrl(theForm.action,a)}function APD_AddFormQP(b,a){a:;if(!APD_Str(b)||!APD_Str(a)||""==a)return;if(null!=theForm)theForm.action=APD_AddQPToUrl(theForm.action,b,a)}function APD_RemoveQPFromUrl(a,c){a:;if(null==a||null==c)return;var b=a.indexOf(c);if(b<0)return a;var d=a.indexOf("&",b);b=a.charAt(b-1)=="?"?b:b-1;a=a.substring(0,b)+(d==-1?"":a.substring(d));return APD_RemoveQPFromUrl(a,c)}function APD_AddQPToUrl(c,b,d){a:;if(null==c||null==b)return;var a=APD_RemoveQPFromUrl(c,b);a=a.indexOf("?")==-1?a+"?":a+"&";a+=b+"="+d;return a}function APD_DisableAllAnchorElements(d){a:;for(var b=false,c=0;c<d.length;c++){var a=d[c];a.disabled=!b;if(a.tagName=="A"&&a.style.display!="none"){if(b&&a.disabledHref)a.href=a.disabledHref;if(!b&&a.href){a.disabledHref=a.href;a.removeAttribute("href",0)}}}}function APD_IsInTileView(b){var a=GetCtxRgiidFromIid(b);if(APD_Def(a)&&APD_Def(a.ctx))return a.ctx.BaseViewID==40||a.ctx.BaseViewID==6}function AssetPickerCSRItem(a,b){this.listItem=a;this.ctx=b;this.itemName=this.listItem.id;this.navUrl=this.ctx.FileRef;this.isContainer=this.ctx.FSObjType=="1";if(this.isContainer){this.folderCTID=this.ctx.ContentTypeId;this.isVideoSet=this.folderCTID.indexOf("0x0120D520A808")==0;this.isContainer=!this.isVideoSet;this.rootFolder=this.ctx.FileRef;if(this.isVideoSet&&APD_Def(this.ctx.VideoSetUserOverrideEncoding,this.ctx.VideoSetDefaultEncoding,this.ctx.VideoSetExternalLink))this.defMediaUrl=APD_GetVideoSetDefaultMediaUrl(this.ctx)}else{this.isVideoSet=false;this.rootFolder=this.folderCTID=""}this.isSelected=false;if(APD_IsInTileView(this.listItem.id))a=a.parentNode;commonAttachEvent(a,"click",APD_HandleSelection);commonAttachEvent(a,"dblclick",APD_HandleDoubleClick);commonAttachEvent(a,"keydown",APD_HandleItemKeyDown);APD_AddCssClass(this.listItem,CONST_AssetPickerItemHoverClassName);this.GetIsSelected=function(){a:;return this.isSelected};this.SetIsSelected=function(c){a:;var a=CONST_AssetPickerItemSelectedClassName,b=this.listItem;if(APD_IsInTileView(this.listItem.id))a=CONST_AssetPickerSelectionClassName;this.isSelected=c;if(c){b.focus();APD_AddCssClass(b,a)}else APD_RemoveCssClass(b,a)}}function APD_GetCSRItemObject(c){var b=null,a=c;if(a&&a.firstChild&&a.firstChild.nodeType==1&&a.firstChild.hasAttribute("iid"))return g_APD_dictItemRows[a.firstChild.id];while(null!=a&&a.nodeType==1&&!a.hasAttribute("iid"))a=a.parentNode;if(a)b=g_APD_dictItemRows[a.id];return b}function APD_ActionsMenuPopulator(c,b){a:;var d=c.CurrentItem,f=GenerateIIDForListItem(c,d),a=g_APD_dictItemRows[f];if(!APD_Def(a))return;b.addAction(new CalloutAction({text:Strings.CMS.L_AssetCalloutInsertAction,onClickCallback:function(){a:;APD_OkReturnAndClose(a)}}));var e=APD_IsItemSupportedByMediaPlayer(a);if(e){g_currentLCID=String(c.CurrentLanguage);APD_EnsureOverlayPlayer();b.addAction(new CalloutAction({text:Strings.CMS.L_PlayCommand_TEXT,isVisibleCallback:function(){a:;return APD_IsItemPlayable(a)},onClickCallback:function(){a:;mediaPlayer.onOverlayModePlay(null,a.isVideoSet?a.defMediaUrl:a.navUrl,a.ctx.FileLeafRef,a)}}))}b.addAction(new CalloutAction({text:Strings.CMS.L_OpenLink_TEXT,isVisibleCallback:function(){a:;return a.isContainer},onClickCallback:function(){a:;APD_EnterFolder(a)}}));APD_Def(d.FileRef)&&b.addAction(new CalloutAction({text:Strings.CMS.L_OpenLink_TEXT,isVisibleCallback:function(){a:;return!a.isContainer&&!e},onClickCallback:function(){a:;window.open(d.FileRef)}}))}var assetPickerCalloutCtx,assetPickerCtx;function APD_RenderTitleField(l,j,a,e){var b=[],i=a.FSObjType=="1"&&a.ContentTypeId.indexOf("0x0120D520A808")==-1;if(i){var h=a.ContentTypeId.indexOf("0x0120D520")==0;if(h)a["serverurl.progid"]="";for(var d=[],c=0;c<CONST_AssetPickerQueryStringParamsToRender.length;c++){var g=CONST_AssetPickerQueryStringParamsToRender[c],f=AP_GetCurrentQParamValue(g);!APD_IsNullOrEmpty(f)&&d.push("&",g,"=",f)}a.AdditionalQueryString=d.join("");return ComputedFieldWorker.LinkFilenameNoMenu(l,j,a,e)}else{b.push('<a href="javascript:{}" onclick="APD_SetSelectionFromElement(this);">');var k=e.IsDocLib=="1"?a.FileLeafRef:a.Title;b.push(STSHtmlEncode(k));b.push("</a>")}return b.join("")}function APD_ItemLinkNavigate(b){var a=g_APD_dictItemRows[b];if(a.isContainer)if(a.isVideoSet)return void 0;else APD_EnterFolder(a);else return void 0}$_global_assetpickers();