Type.registerNamespace("SP.UI.Reputation");SP.UI.Reputation.AverageRatingRenderer=function(j,h,c,b,f,g,e,d,i,a){this.$$d_$Y_0=Function.createDelegate(this,this.$Y_0);this.$$d_$Z_0=Function.createDelegate(this,this.$Z_0);this.$$d_$W_0=Function.createDelegate(this,this.$W_0);this.$$d_$X_0=Function.createDelegate(this,this.$X_0);this.$$d_$V_0=Function.createDelegate(this,this.$V_0);this.$$d_$U_0=Function.createDelegate(this,this.$U_0);this.$6_0=j;this.$F_0=h;this.$P_0=e;this.$H_0=d;this.$4_0=c;this.$2_0=SP.ScriptHelpers.isNullOrUndefinedOrEmpty(b)?"0":b;this.$I_0=f;this.$J_0=g;this.$G_0=i;if(SP.ScriptHelpers.isNullOrUndefinedOrEmpty(a)||a.toUpperCase()!=="RTL"&&a.toUpperCase()!=="LTR")this.$L_0=!SP.ScriptHelpers.isNullOrUndefinedOrEmpty(document.documentElement.dir)&&document.documentElement.dir.toUpperCase()==="RTL"?true:false;else this.$L_0=a.toUpperCase()==="RTL"?true:false;this.elementId=this.$R_0();this.$3_0=this.$S_0();this.onClickHandler=this.$$d_$U_0;this.onClickStopPropagationHandler=this.$$d_$V_0;this.onMouseOverHandler=this.$$d_$X_0;this.onMouseOutHandler=this.$$d_$W_0};SP.UI.Reputation.AverageRatingRenderer.prototype={onClickHandler:null,onClickStopPropagationHandler:null,onMouseOverHandler:null,onMouseOutHandler:null,elementId:null,$6_0:0,$F_0:0,$P_0:null,$H_0:null,$4_0:0,$2_0:null,$J_0:null,$3_0:null,$O_0:null,$I_0:null,$G_0:false,$L_0:false,$5_0:null,$9_0:null,render:function(){var a=new SP.HtmlBuilder;a.addCssClass("ms-comm-noWrap");if(this.$H_0==="108"){a.addCssClass("ms-comm-cmdSpaceListItem");a.renderBeginTag("li")}else if(this.$H_0==="301")a.renderBeginTag("span");else{a.addAttribute("align","right");a.renderBeginTag("div")}this.$b_0(a);a.addCssClass("ms-comm-ratingSeparator");a.renderBeginTag("span");a.renderEndTag();this.$a_0(a);a.renderEndTag();return a.toString()},renderStars:function(){SP.UI.Reputation.AverageRatingRenderer.$K&&SP.UI.Reputation.RatingsHelpers.$c(this.$G_0);this.$5_0=this.$M_0();var e=new SP.HtmlBuilder,b=1,c=this.$5_0;for(var d in c){var f={key:d,value:c[d]},a="";a+='<a href="javascript:;">';a+="<span ";a+='class="ms-comm-ratingsImageContainer"';if(SP.UI.Reputation.AverageRatingRenderer.isAnonymous.toUpperCase()!=="TRUE")a+=this.$T_0(b);a+=">";a+="<img ";a+='id="'+this.elementId+"-img-"+f.key+'" ';a+=String.format('alt="'+SP.Utilities.LocUtility.getLocalizedCountValue(Strings.STS.L_SPRatingsNotRatedAltText,Strings.STS.L_SPRatingsNotRatedAltTextIntervals,b)+'"',b);a+='src="'+f.value+'"/>';a+="</span>";a+="</a>";e.write(a);b++}return e.toString()},$b_0:function(a){a.addAttribute("id",this.elementId);a.renderBeginTag("span");a.write(this.renderStars());a.renderEndTag()},$a_0:function(a){a.addCssClass("ms-comm-ratingCountContainer");a.addAttribute("id",this.elementId+"-count");a.addAttribute("title",String.format(SP.Utilities.LocUtility.getLocalizedCountValue(Strings.STS.L_SPRatingsCountAltText,Strings.STS.L_SPRatingsCountAltTextIntervals,Number.parseLocale(this.$2_0)),this.$2_0));a.renderBeginTag("span");a.write(this.$2_0);a.renderEndTag()},$X_0:function(d){if(SP.ScriptHelpers.isNullOrUndefined(d.target))return;var c=null;switch(d.target.tagName){case"A":c=d.target.firstChild.firstChild;break;case"SPAN":c=d.target.firstChild;break;case"IMG":c=d.target}if(!SP.ScriptHelpers.isNullOrUndefined(c)){var e=SP.UI.Reputation.RatingsHelpers.$N(c.id),a=0,b=6;while(a!==e||b!==e){if(a!==e){a=a+1;var f=$get(this.elementId+"-img-"+a.toString());if(!SP.ScriptHelpers.isNullOrUndefined(f))f.src=SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$C}if(b!==e){b=b-1;if(b!==a){var g=$get(this.elementId+"-img-"+b.toString());if(!SP.ScriptHelpers.isNullOrUndefined(g))g.src=SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$B}}}}},$W_0:function(c){if(SP.ScriptHelpers.isNullOrUndefined(c.target)||SP.ScriptHelpers.isNullOrUndefined(c.target.parentNode))return;for(var a=1;a<=5;a++){var b=$get(this.elementId+"-img-"+a.toString());if(!SP.ScriptHelpers.isNullOrUndefined(b))b.src=this.$5_0[a.toString()].toString()}},$U_0:function(d){d.preventDefault();var a=d.target;if(SP.ScriptHelpers.isNullOrUndefined(a)){a=d.rawEvent.srcElement;if(SP.ScriptHelpers.isNullOrUndefined(a))return}var c=null;switch(a.tagName){case"A":c=a.firstChild;break;case"SPAN":c=a;break;case"IMG":c=a.parentNode}if(!SP.ScriptHelpers.isNullOrUndefined(c)&&!SP.ScriptHelpers.isNullOrUndefined(c.firstChild)){var e=c.firstChild;e.src=SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$A;var f=SP.UI.Reputation.RatingsHelpers.$N(e.id),b=this;EnsureScriptFunc("reputation.js","Microsoft.Office.Server.ReputationModel.Reputation",function(){var a=new SP.ClientContext;b.$9_0=Microsoft.Office.Server.ReputationModel.Reputation.setRating(a,b.$P_0,b.$6_0,f);a.executeQueryAsync(b.$$d_$Z_0,b.$$d_$Y_0);b.$O_0=f.toString()})}d.stopPropagation()},$V_0:function(a){a.stopPropagation()},$Z_0:function(){if(SP.ScriptHelpers.isNullOrUndefined(this.$9_0)||SP.ScriptHelpers.isNullOrUndefined(this.$9_0.get_value()))return;this.$4_0=this.$9_0.get_value();this.$5_0=this.$M_0();for(var a=1;a<=5;a++){var b=$get(this.elementId+"-img-"+a.toString());if(!SP.ScriptHelpers.isNullOrUndefined(b))b.src=this.$5_0[a.toString()].toString()}if(SP.ScriptHelpers.isNullOrUndefinedOrEmpty(this.$3_0)){var c=$get(this.elementId+"-count");if(!SP.ScriptHelpers.isNullOrUndefined(c)){this.$2_0=(Number.parseInvariant(this.$2_0)+1).toString();c.innerHTML=this.$2_0;this.$3_0=this.$O_0}}},$Y_0:function(b,a){alert(a.get_message())},$T_0:function(b){var a="";if(SP.ScriptHelpers.isNullOrUndefinedOrEmpty(this.$3_0))a=String.format('title="'+SP.Utilities.LocUtility.getLocalizedCountValue(Strings.STS.L_SPRatingsNotRatedAltText,Strings.STS.L_SPRatingsNotRatedAltTextIntervals,b)+'"',b);else a=String.format('title="'+SP.Utilities.LocUtility.getLocalizedCountValue(Strings.STS.L_SPRatingsRatedAltText,Strings.STS.L_SPRatingsRatedAltTextIntervals,Number.parseLocale(this.$3_0))+'"',this.$3_0);return a},$S_0:function(){var f="";if(!SP.ScriptHelpers.isNullOrUndefinedOrEmpty(this.$J_0)&&!SP.ScriptHelpers.isNullOrUndefined(this.$F_0)){var a=[];Array.addRange(a,this.$J_0.split(","));for(var b=0,k=a.length;b<k;b++)SP.ScriptHelpers.isNullOrUndefinedOrEmpty(a[b].toString())&&Array.removeAt(a,b);if(this.$G_0){var c=this.$I_0;if(!SP.ScriptHelpers.isNullOrUndefined(c)&&a.length===c.length)for(var h=null,d=0,l=c.length;d<l;d++){h=c[d];if(h.id===this.$F_0.toString()){f=a[d].toString();break}}}else{var i=this.$I_0;if(!SP.ScriptHelpers.isNullOrUndefinedOrEmpty(i)){var m=new RegExp("(\\d+);#","g"),g=i.match(m);if(a.length===g.length)for(var e=0,n=g.length;e<n;e++){var j=g[e],o=j.substr(0,j.length-2);if(o===this.$F_0.toString()){f=a[e].toString();break}}}}}return f},$R_0:function(){var a="averageRatingElement-";if(SP.ScriptHelpers.isNullOrUndefined($get(a+this.$6_0)))a+=this.$6_0;else a+="best"+this.$6_0;return a},$M_0:function(){for(var d={},b=this.$4_0-Math.floor(this.$4_0),e=this.$4_0-b,a="",c=1;c<=5;c++){if(e>0){a=SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$8;e--}else if(b>0){if(b>=.25&&b<=.75)if(this.$L_0)a=SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$E;else a=SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$D;else if(b>.75)a=SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$8;else a=SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$7;b=0}else a=SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$7;d[c.toString()]=a}return d}};SP.UI.Reputation.AverageRatingRenderer.ImageUrls=function(){};SP.UI.Reputation.RatingsHelpers=function(){};SP.UI.Reputation.RatingsHelpers.$N=function(a){var b=a.substr(a.length-1);return Number.parseInvariant(b)};SP.UI.Reputation.RatingsHelpers.$c=function(a){if(a){SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$A=GetThemedImageUrl("RatingsLargeStarFilled.png");SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$7=GetThemedImageUrl("RatingsSmallStarEmpty.png");SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$8=GetThemedImageUrl("RatingsSmallStarFilled.png");SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$D=GetThemedImageUrl("RatingsSmallStarLeftHalfFilled.png");SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$E=GetThemedImageUrl("RatingsSmallStarRightHalfFilled.png");SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$B=GetThemedImageUrl("RatingsSmallStarHoveroverEmpty.png");SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$C=GetThemedImageUrl("RatingsSmallStarHoveroverFilled.png")}else{SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$A=SP.UI.Reputation.RatingsHelpers.$1("RatingsLargeStarFilled.png");SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$7=SP.UI.Reputation.RatingsHelpers.$1("RatingsSmallStarEmpty.png");SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$8=SP.UI.Reputation.RatingsHelpers.$1("RatingsSmallStarFilled.png");SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$D=SP.UI.Reputation.RatingsHelpers.$1("RatingsSmallStarLeftHalfFilled.png");SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$E=SP.UI.Reputation.RatingsHelpers.$1("RatingsSmallStarRightHalfFilled.png");SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$B=SP.UI.Reputation.RatingsHelpers.$1("RatingsSmallStarHoveroverEmpty.png");SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$C=SP.UI.Reputation.RatingsHelpers.$1("RatingsSmallStarHoveroverFilled.png")}SP.UI.Reputation.AverageRatingRenderer.$K=false};SP.UI.Reputation.RatingsHelpers.$1=function(c){var a="",b=$get(c);if(!SP.ScriptHelpers.isNullOrUndefined(b))a=b.src;return a};function Context(){this.Templates={}}Context.prototype={CurrentFieldSchema:null,CurrentItem:null,HttpRoot:null,listName:null,listTemplate:null,ListSchema:null,OnPreRender:null,OnPostRender:null};function FormContext(){}FormContext.prototype={controlMode:0,fieldName:null,fieldSchema:null,fieldValue:null,itemAttributes:null,listAttributes:null,webAttributes:null};function UserInfo(){}UserInfo.prototype={email:null,id:null,picture:null,sip:null,title:null,value:null};SP.UI.Reputation.AverageRatingRenderer.registerClass("SP.UI.Reputation.AverageRatingRenderer");SP.UI.Reputation.AverageRatingRenderer.ImageUrls.registerClass("SP.UI.Reputation.AverageRatingRenderer.ImageUrls");SP.UI.Reputation.RatingsHelpers.registerClass("SP.UI.Reputation.RatingsHelpers");Context.registerClass("Context");FormContext.registerClass("FormContext");UserInfo.registerClass("UserInfo");function sp_ui_ratings_initialize(){SP.UI.Reputation.AverageRatingRenderer.isAnonymous="false";SP.UI.Reputation.AverageRatingRenderer.$K=true;SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$A="";SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$7="";SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$8="";SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$D="";SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$E="";SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$B="";SP.UI.Reputation.AverageRatingRenderer.ImageUrls.$C=""}sp_ui_ratings_initialize();RegisterModuleInit("sp.ui.ratings.js",sp_ui_ratings_initialize);typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();NotifyScriptLoadedAndExecuteWaitingJobs("sp.ui.ratings.js");