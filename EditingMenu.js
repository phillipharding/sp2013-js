function $_global_editingmenu(){g_bWarnBeforeLeave=true;g_bResourcesAlreadyChecked=false;g_UrlElements=["a","area","base","bgsound","body","div","img","input","param","table","td","th","span"];UniqueElementCounter.prototype={Add:function(a){a:;if(typeof this.set[a]=="undefined"){this.set[a]=null;this.count++}},Count:function(){a:;return this.count}};draftItems=null;preTransferContentsEventHandler=function(){a:;RemoveDraftOutlines()};previousNotification=null;typeof Sys!="undefined"&&Sys!=null&&Sys.Application!=null&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs!="undefined"&&NotifyScriptLoadedAndExecuteWaitingJobs("EditingMenu.js")}function ULS12U(){var a={};a.ULSTeamName="CMS";a.ULSFileName="EditingMenu.commentedjs";return a}var g_bWarnBeforeLeave,g_bResourcesAlreadyChecked;function EncodeForXmlText(a){a:;return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#39;")}var g_UrlElements,l_ur_rfct,l_ur_wsurl,l_ur_formname,l_ur_fullreport,l_ur_recsready,l_ur_plsWait;function GetSingleNamedNode(a,d){a:;if(!a)return null;for(var c=0;c<a.length;c++){var b=a.item(c);if(b&&b.nodeName==d)return b}return null}function GetNodeTextValue(a){a:;return a?a.firstChild.nodeValue:""}function HideServerGeneratedMessage(){a:;var b=document.getElementById("consoleErrorMessageRow"),a=document.getElementById("consoleErrorMessageSeparator");if(b&&a){b.style.display="none";a.style.display="none"}}var showUnapprovedXmlHttp,urlObjects,absoluteUrls,urlObjectTypes;function ShowUnapprovedResourcesPage(){a:;window.status=l_chkResStatus;showConsoleMessage(l_ur_plsWait,false);var e=document.getElementsByTagName("*");urlObjects=new Array(e.length);absoluteUrls=new Array(e.length);urlObjectTypes=new Array(e.length);for(var b=0,d="",f=0;f<e.length;f++)for(var a=e[f],c=0;c<g_UrlElements.length;c++)if(a.tagName.toLowerCase()==g_UrlElements[c].toLowerCase())if(a.src!=undefined&&a.src!=""){d+="<string>"+EncodeForXmlText(a.src)+"</string>";urlObjects[b]=a;absoluteUrls[b]=a.src;urlObjectTypes[b]=g_UrlElements[c].toLowerCase();b++}else if(a.lowersrc!=undefined&&a.lowersrc!=""){d+="<string>"+EncodeForXmlText(a.lowersrc)+"</string>";urlObjects[b]=a;absoluteUrls[b]=a.lowersrc;urlObjectTypes[b]=g_UrlElements[c].toLowerCase();b++}else if(a.href!=undefined&&a.href!=""){if(a.href.split("#")[0].split("?")[0].toLowerCase()!=document.URL.split("#")[0].split("?")[0].toLowerCase()){d+="<string>"+EncodeForXmlText(a.href)+"</string>";urlObjects[b]=a;absoluteUrls[b]=a.href;urlObjectTypes[b]=g_UrlElements[c].toLowerCase();b++}}else if(a.style.backgroundImage!=undefined&&a.style.backgroundImage!=""&&a.style.backgroundImage.split(")").length>1){var g=a.style.backgroundImage.split("(")[1].split(")")[0];d+="<string>"+EncodeForXmlText(g)+"</string>";urlObjects[b]=a;absoluteUrls[b]=g;urlObjectTypes[b]=g_UrlElements[c].toLowerCase();b++}else if(a.datasrc!=undefined&&a.datasrc!=""){d+="<string>"+EncodeForXmlText(a.datasrc)+"</string>";urlObjects[b]=a;absoluteUrls[b]=a.datasrc;urlObjectTypes[b]=g_UrlElements[c].toLowerCase();b++}else if(a.dynsrc!=undefined&&a.dynsrc!=""){d+="<string>"+EncodeForXmlText(a.dynsrc)+"</string>";urlObjects[b]=a;absoluteUrls[b]=a.dynsrc;urlObjectTypes[b]=g_UrlElements[c].toLowerCase();b++}else if(a.tagName=="SPAN"&&a.id==l_ur_rfct&&a.getAttribute("fragmentid")!=null&&a.getAttribute("fragmentid").length>0){d+="<string>"+EncodeForXmlText(a.getAttribute("fragmentid"))+"</string>";urlObjects[b]=a;absoluteUrls[b]=a.getAttribute("fragmentid");urlObjectTypes[b]=g_UrlElements[c].toLowerCase();b++}var h;try{showUnapprovedXmlHttp=new XMLHttpRequest}catch(h){try{showUnapprovedXmlHttp=new ActiveXObject("Microsoft.XMLHTTP")}catch(h){}}showUnapprovedResourcesAborted=false;showUnapprovedXmlHttp.open("POST",escapeUrlForCallback(l_ur_wsurl),true);showUnapprovedXmlHttp.setRequestHeader("Content-Type","text/xml; charset=utf-8");showUnapprovedXmlHttp.setRequestHeader("SOAPAction",'"http://schemas.microsoft.com/sharepoint/soap/GetObjectStatusCollectionWithExclusions"');showUnapprovedXmlHttp.onreadystatechange=ShowUnapprovedResourcesPageResponse;showUnapprovedXmlHttp.send('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">  <soap:Body>    <GetObjectStatusCollectionWithExclusions xmlns="http://schemas.microsoft.com/sharepoint/soap/">      <objectUrls>'+d+"      </objectUrls>      <thisPageUrl>"+document.URL.split("#")[0].split("?")[0].toLowerCase()+"      </thisPageUrl>    </GetObjectStatusCollectionWithExclusions>  </soap:Body></soap:Envelope>")}var showUnapprovedResourcesAborted;function ShowUnapprovedResourcesPageAbort(){a:;showUnapprovedResourcesAborted=true;showUnapprovedXmlHttp.abort();window.status=""}function UniqueElementCounter(){a:;this.set={};this.count=0}var draftItems;function SetBorderToUrlObj(c,a,e){a:;var b={element:c,border:a.border,margin:a.margin};if(browseris.safari)b.cssText=a.cssText;var d="; border: dashed "+e+" 2px !important; margin: 5px;";if(c.nodeName!="IMG"&&(c.innerHTML==null||c.innerHTML=="")){d=d+" width: 18px; height: 18px;";b.width=a.width;b.height=a.height}a.cssText=a.cssText+d;return b}function ShowUnapprovedResourcesPageResponse(){a:;if(showUnapprovedXmlHttp.readyState!=4||showUnapprovedResourcesAborted)return;xml=showUnapprovedXmlHttp.responseXML;if(typeof"xml"!="undefined"&&typeof"xml.documentElement"!="undefined"&&typeof"xml.documentElement.firstChild"!="undefined"&&typeof"xml.documentElement.firstChild.firstChild"!="undefined"&&typeof"xml.documentElement.firstChild.firstChild.firstChild"!="undefined"&&typeof"xml.documentElement.firstChild.firstChild.firstChild.childNodes"!="undefined")nodes=xml.documentElement.firstChild.firstChild.firstChild.childNodes;else nodes={length:0};var t=true,h=false,g="";if(nodes.length>0){var j=nodes.item(0).childNodes,r=GetSingleNamedNode(j,"ObjectType");if(GetNodeTextValue(r).toLowerCase()=="unrecoverablefailure"){h=true;g=GetNodeTextValue(GetSingleNamedNode(j,"Description"))}}var e=new UniqueElementCounter;if(!h){draftItems=[];for(i=0;i<nodes.length;i++){var b=nodes.item(i).childNodes,l=GetSingleNamedNode(b,"PublishingUrl");if(l!=undefined){var f=GetNodeTextValue(l);if(f!=undefined&&f!=""){lastMajor=GetSingleNamedNode(b,"LastMajorVersion");lastMinor=GetSingleNamedNode(b,"LastMinorVersion");objType=GetSingleNamedNode(b,"ObjectType");var s=GetSingleNamedNode(b,"Url"),n=GetNodeTextValue(lastMajor),o=GetNodeTextValue(lastMinor),m=GetNodeTextValue(objType),p=GetNodeTextValue(s),q=xml.createElement("MarkupType");q.appendChild(xml.createTextNode(urlObjectTypes[i]));nodes.item(i).appendChild(q);var k=xml.createElement("AbsoluteUrl");k.appendChild(xml.createTextNode(f));nodes.item(i).appendChild(k);if(m.toLowerCase()!="undefined"&&m.toLowerCase()!="accessdenied"){var a=urlObjects[i],d;if(a.runtimeStyle)d=a.runtimeStyle;else d=a.style;var c;if(n=="0"){c=SetBorderToUrlObj(a,d,"red");draftItems.push(c);e.Add(p)}else if(o!="0"&&o/n>1){c=SetBorderToUrlObj(a,d,"orange");draftItems.push(c);e.Add(p)}else if(a.runtimeStyle){a.runtimeStyle.borderStyle=a.style.borderStyle;a.runtimeStyle.borderWidth=a.style.borderWidth;a.runtimeStyle.borderColor=a.style.borderColor;a.runtimeStyle.margin=a.style.margin;if(urlObjectTypes[i]=="a"){a.runtimeStyle.top=a.style.top;a.runtimeStyle.left=a.style.left;a.runtimeStyle.height=a.style.height}}}}}}if(e.Count()>0){typeof RTE!="undefined"&&typeof RTE.CanvasEvents!="undefined"&&RTE.CanvasEvents.registerListener(RTE.CanvasEvents.transferEvent,preTransferContentsEventHandler);document.forms[l_ur_formname].MSOShowUnapproved_Xml.value=xml.xml;g_ProcessedXml=xml;if(browseris.ie6up)showConsoleMessage(l_ur_fullreport,true);else showConsoleMessage(l_ur_fullreportnors,true)}else showConsoleMessage(l_ur_recsready,false)}else showConsoleMessage(g,true);document.body.style.cursor="default";g_bResourcesAlreadyChecked=true;window.status=""}function DraftOutlinesExist(){a:;return draftItems!=null&&draftItems.length>0}var preTransferContentsEventHandler;function RemoveDraftOutlines(){a:;typeof RTE!="undefined"&&typeof RTE.CanvasEvents!="undefined"&&RTE.CanvasEvents.unRegisterListener(RTE.CanvasEvents.transferEvent,preTransferContentsEventHandler);if(draftItems==null)return;for(i=0;i<draftItems.length;i++){var a=draftItems[i],c=a.element,b;if(c.runtimeStyle)b=c.runtimeStyle;else b=c.style;if(browseris.safari)b.cssText=a.cssText;else{b.border=a.border;b.margin=a.margin}if(a.width!=undefined)b.width=a.width;if(a.height!=undefined)b.height=a.height}draftItems=null}var previousNotification;function RemovePreviousConsoleMessageNotification(){a:;if(previousNotification!=null){removeNotification(previousNotification);previousNotification=null}}function showConsoleMessage(b,c){a:;if(document.getElementById("consoleNegativeMessage")!=null&&document.getElementById("consolePositiveMessage")!=null)if(c){document.getElementById("consoleNegativeMessage").innerHTML=b;document.getElementById("consoleNegativeMessageBar1").style.display="";document.getElementById("consoleNegativeMessageBar2").style.display="";document.getElementById("consolePositiveMessageBar1").style.display="none";document.getElementById("consolePositiveMessageBar2").style.display="none"}else{document.getElementById("consolePositiveMessage").innerHTML=b;document.getElementById("consolePositiveMessageBar1").style.display="";document.getElementById("consolePositiveMessageBar2").style.display="";document.getElementById("consoleNegativeMessageBar1").style.display="none";document.getElementById("consoleNegativeMessageBar2").style.display="none"}else{RemovePreviousConsoleMessageNotification();var a="";if(c){a="<img alt='";if(typeof SP!="undefined"&&typeof SP.Publishing!="undefined"&&typeof SP.Publishing.Resources!="undefined"&&typeof SP.Publishing.Resources.warningMessage!="undefined")a+=SP.Publishing.Resources.warningMessage;a+="' src='/_layouts/images/wppinval.gif'></img>"}else{a="<img alt='";if(typeof SP!="undefined"&&typeof SP.Publishing!="undefined"&&typeof SP.Publishing.Resources!="undefined"&&typeof SP.Publishing.Resources.informationalMessage!="undefined")a+=SP.Publishing.Resources.informationalMessage;a+="' src='/_layouts/images/check.gif'></img>"}a+="&nbsp;"+b;previousNotification=addNotification(a,true)}}function ShowConsoleBlockPadding(b,a){a:;var d=document.getElementById(b),c=document.getElementById(a);ShowHtmlElement(d,true);ShowHtmlElement(c,true)}function ShowHtmlElement(a,b){a:;if(a!=null&&a.style!=null)if(b)a.style.display="";else a.style.display="none"}function AddMPOverhang(d,c){a:;var b=document.getElementById(d),a=document.getElementById(c);if(b!=null&&b.style!=null){b.style.position="relative";b.style.bottom="-7px"}if(a!=null&&a.style!=null){a.style.position="relative";a.style.bottom="-7px"}}function ShowConsoleBlockPaddingWithOverhang(b,a,d,c){a:;ShowConsoleBlockPadding(b,a);AddMPOverhang(d,c)}$_global_editingmenu();