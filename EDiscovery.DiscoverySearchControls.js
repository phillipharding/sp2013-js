function ULSOAt(){var o=new Object;o.ULSTeamName="DLC Server";o.ULSFileName="EDiscovery.DiscoverySearchControls.js";return o;}
Type.registerNamespace("Discovery");Discovery.DiscoveryProperties=function(a){ULSOAt:;Discovery.DiscoveryProperties.initializeBase(this,[a])};Discovery.DiscoveryProperties.onTextQueryChange=function(){ULSOAt:;if(!Discovery.DiscoveryProperties.$14(Discovery.DiscoveryProperties.$J.value))Sys.UI.DomElement.removeCssClass(Discovery.DiscoveryProperties.$N,"ms-hide");else Sys.UI.DomElement.addCssClass(Discovery.DiscoveryProperties.$N,"ms-hide")};Discovery.DiscoveryProperties.$14=function(e){ULSOAt:;if(!Srch.U.e(e)){var c=e.match(Discovery.DiscoveryProperties.$t);if(!Srch.U.n(c))for(var b=c,f=b.length,a=0;a<f;++a){var d=b[a];if(d!==d.toUpperCase())return false}}return true};Discovery.DiscoveryProperties.showGhostText=function(){ULSOAt:;Discovery.DiscoveryProperties.$J=Discovery.DiscoveryProperties.$0("textarea","Discovery_Search_Textarea");Discovery.DiscoveryProperties.$N=$get("discovery_properties_warning");$addHandler(Discovery.DiscoveryProperties.$J,"change",Discovery.DiscoveryProperties.onTextQueryChange)};Discovery.DiscoveryProperties.showAdvancedOptionsDialog=function(){ULSOAt:;var e=Srch.ScriptApplicationManager.get_current(),f=e.queryGroups.Discovery_Sharepoint,g=e.queryGroups.Discovery_Exchange,b=f.dataProvider,c=g.dataProvider,d=new SP.UI.DialogOptions;d.url=SP.Utilities.Utility.getLayoutsPageUrl("DiscoveryAdvancedSrch.aspx");d.autoSize=true;d.dialogReturnValueCallback=Discovery.DiscoveryProperties.onAdvancedPropertiesDialogReturn;var a={};a.dedup=Discovery.DiscoveryProperties.get_$B();a.stem=Discovery.DiscoveryProperties.get_$5();a.SPK=b.get_currentQueryState().k;a.SPR=Discovery.DiscoveryProperties.$h(b.get_currentQueryState().r);a.SPRD=Discovery.DiscoveryProperties.$g(b);a.SPP=b.get_properties().Discovery_Properties;a.SPS=b.get_properties().Discovery_Sharepoint_Xml;a.EXK=c.get_currentQueryState().k;a.EXR=Discovery.DiscoveryProperties.$h(c.get_currentQueryState().r);a.EXRD=Discovery.DiscoveryProperties.$g(c);a.EXP=c.get_properties().Discovery_Properties;a.EXS=c.get_properties().Discovery_Sources_Display;a.DSI=b.get_properties().Discovery_Sources_AdvancedSearch_Info;d.args=a;SP.UI.ModalDialog.showModalDialog(d)};Discovery.DiscoveryProperties.$h=function(a){ULSOAt:;var b=a;if(!Srch.U.n(a))b=JSON.stringify(a);return b};Discovery.DiscoveryProperties.$g=function(d){ULSOAt:;if(!Srch.U.n(d)&&!Srch.U.n(d.get_currentQueryState())&&!Srch.U.n(d.get_currentQueryState().r)){for(var h=new Array(0),g=d.get_currentQueryState().r,i=g.length,e=0;e<i;++e){var a=g[e],b=new Srch.RefinementCategory(a.n);b.k=true;b.n=a.n;b.o=a.o;b.t=[];for(var f=0;f<a.t.length;f++){var c=a.t[f];if(!Srch.U.n(a.m)&&c in a.m&&!Srch.U.w(a.m[c]))c=a.m[c];Srch.U.appendArray(b.t,c)}if(Srch.U.n(b.o))b.o="or";Srch.U.appendArray(h,b)}return h.toString()}return null};Discovery.DiscoveryProperties.onAdvancedPropertiesDialogReturn=function(a,f){ULSOAt:;if(!a||a===-1)return;var b=f,c=Srch.ScriptApplicationManager.get_current(),d=c.queryGroups.Discovery_Sharepoint,e=c.queryGroups.Discovery_Exchange;Discovery.DiscoveryProperties.set_$B(b.dedup);Discovery.DiscoveryProperties.set_$5(b.stem);d.dataProvider.set_enableStemming(Discovery.DiscoveryProperties.get_$5());e.dataProvider.set_enableStemming(Discovery.DiscoveryProperties.get_$5());d.dataProvider.set_trimDuplicates(false);e.dataProvider.set_trimDuplicates(Discovery.DiscoveryProperties.get_$B())};Discovery.DiscoveryProperties.get_$5=function(){ULSOAt:;var b=false,a=Discovery.DiscoveryProperties.$0("input","Discovery_Stemming_Hidden");if(!Srch.U.n(a)&&!Srch.U.e(a.value))b=Discovery.DiscoveryProperties.$Z(a);return b};Discovery.DiscoveryProperties.set_$5=function(b){ULSOAt:;var a=Discovery.DiscoveryProperties.$0("input","Discovery_Stemming_Hidden");if(!Srch.U.n(a))a.value=b.toString();return b};Discovery.DiscoveryProperties.get_$B=function(){ULSOAt:;var b=true,a=Discovery.DiscoveryProperties.$0("input","Discovery_Deduplication_Hidden");if(!Srch.U.n(a)&&!Srch.U.e(a.value))b=Discovery.DiscoveryProperties.$Z(a);return b};Discovery.DiscoveryProperties.set_$B=function(b){ULSOAt:;var a=Discovery.DiscoveryProperties.$0("input","Discovery_Deduplication_Hidden");if(!Srch.U.n(a))a.value=b.toString();return b};Discovery.DiscoveryProperties.$Z=function(a){ULSOAt:;return!Srch.U.n(a)&&!Srch.U.e(a.value)?a.value.toUpperCase()==="TRUE":false};Discovery.DiscoveryProperties.search=function(){ULSOAt:;if(!Srch.U.n(Discovery.DiscoveryProperties.$I)){var a=Discovery.DiscoveryProperties.$0("textarea","Discovery_Search_Textarea");Discovery.DiscoveryProperties.$I.search(a.value)}};Discovery.DiscoveryProperties.registerOnSDP=function(){ULSOAt:;if(!Discovery.DiscoveryProperties.$Q){for(var e=Srch.ScriptApplicationManager.get_current(),a=e.queryGroups.Discovery_Sharepoint,f=e.queryGroups.Discovery_Exchange,d=0;d<a.searchBoxes.length;d++)if(a.searchBoxes[d].get_id().indexOf("Discovery_Searchbox")>0){Discovery.DiscoveryProperties.$I=a.searchBoxes[d];break}if(!Srch.U.n(a)){var b=a.dataProvider;if(!Srch.U.n(b)){b.set_enableStemming(Discovery.DiscoveryProperties.get_$5());b.set_trimDuplicates(false);b.add_queryIssuing(Discovery.DiscoveryProperties.$c);b.add_resultReady(Discovery.DiscoveryProperties.$6)}}if(!Srch.U.n(f)){var c=f.dataProvider;if(!Srch.U.n(c)){c.set_enableStemming(Discovery.DiscoveryProperties.get_$5());c.set_trimDuplicates(Discovery.DiscoveryProperties.get_$B());c.add_queryIssuing(Discovery.DiscoveryProperties.$c);c.add_resultReady(Discovery.DiscoveryProperties.$6)}}Discovery.DiscoveryProperties.$Q=true}};Discovery.DiscoveryProperties.$12=function(o){ULSOAt:;var k=new Array(0),c=null,l=Discovery.DiscoveryProperties.$0("div","Discovery_People_Picker");if(!Srch.U.n(l)){var b=l;while(b){if(b.nodeType===1){var q=!Srch.U.w(b.getAttribute("SPClientPeoplePicker"));if(q){var m=b.id;if(!Srch.U.n(SPClientPeoplePicker.SPClientPeoplePickerDict[m]))c=SPClientPeoplePicker.SPClientPeoplePickerDict[m];break}}b=b.hasChildNodes()?b.childNodes[0]:null}}var p=!Srch.U.n(c)&&c.TotalUserCount>0;if(p){var f=$get(c.ResolvedListElementId),r=!Srch.U.n(f)&&f.hasChildNodes();if(r)for(var s=0,g=0;g<f.childNodes.length;g++){var t=f.childNodes[g],h=t.id,u=!Srch.U.w(h)&&!Srch.U.n(c.ProcessedUserList[h]);if(u){var a=c.ProcessedUserList[h];if(!Srch.U.n(a.UserInfo)){var d=new Array(3),e=0;if(o&&!Srch.U.n(a.UserInfo.EntityData)){var i=!Srch.U.w(a.UserInfo.EntityData.SIPAddress)?a.UserInfo.EntityData.SIPAddress:a.UserInfo.EntityData.Email;if(Srch.U.w(i))i=a.UserInfo.DisplayText;d[e++]=i}else if(!o&&!Srch.U.w(a.UserInfo.Description)){d[e++]=a.UserInfo.Description;d[e++]=a.UserInfo.DisplayText;if(!Srch.U.n(a.UserInfo.EntityData))d[e++]=a.UserInfo.EntityData.Email}for(var j=0;j<e;j++){var n=d[j];if(!Srch.U.w(n))k[s++]=n}}}}}return k};Discovery.DiscoveryProperties.get_$10=function(){ULSOAt:;var a=Discovery.DiscoveryProperties.$0("input","Discovery_Start_Date");return a.value};Discovery.DiscoveryProperties.get_$1B=function(){ULSOAt:;var a=Discovery.DiscoveryProperties.$0("input","Discovery_End_Date");return a.value};Discovery.DiscoveryProperties.get_$d=function(){ULSOAt:;var a=Discovery.DiscoveryProperties.$0("input","Discovery_Domain_Textarea");return a?a.value:""};Discovery.DiscoveryProperties.$6=function(){ULSOAt:;window.clearInterval(Discovery.DiscoveryProperties.$C);Discovery.DiscoveryProperties.$H--;if(Discovery.DiscoveryProperties.$H<=0){Discovery.DiscoveryProperties.$H=0;Discovery.DiscoveryProperties.$O()}};Discovery.DiscoveryProperties.$w=function(){ULSOAt:;var a=Srch.ScriptApplicationManager.get_current(),b=a.queryGroups.Discovery_Sharepoint,c=a.queryGroups.Discovery_Exchange;if(!Srch.U.n(b)){var d=b.dataProvider;if(!Srch.U.n(d))if(Discovery.DiscoveryProperties.$i(d)){Discovery.DiscoveryProperties.$O();window.clearInterval(Discovery.DiscoveryProperties.$C)}}if(!Srch.U.n(c)){var e=c.dataProvider;if(!Srch.U.n(e))if(Discovery.DiscoveryProperties.$i(e)){Discovery.DiscoveryProperties.$O();window.clearInterval(Discovery.DiscoveryProperties.$C)}}};Discovery.DiscoveryProperties.$i=function(b){ULSOAt:;if(b.get_messages().length>0){for(var a=0;a<b.get_messages().length;a++){var c=b.get_messages()[a];if(c.level===2)return true}return false}else return false};Discovery.DiscoveryProperties.$O=function(){ULSOAt:;if(Discovery.DiscoveryProperties.$A){Discovery.DiscoveryProperties.$A.close(1);Discovery.DiscoveryProperties.$A=null}};Discovery.DiscoveryProperties.$z=function(g,h,c){ULSOAt:;var i=!Srch.U.w(g),d=!Srch.U.w(h),e=c?"{0}{1}{2}":"{0}{1}{2}",b="Received",a="",f=c&&i;if(f)a+=String.format(e,b,">=",g.trim());if(f&&d)a+=" AND ";if(d){if(!c)b="Created";a+=String.format(e,b,"<=",h.trim())}return a};Discovery.DiscoveryProperties.$y=function(c,d){ULSOAt:;var a="";if(c.length>1)a+=" (";for(var b=0;b<c.length;b++){if(b>0)a+=" OR ";if(d)a+=String.format('From:"{0}"',c[b]);else a+=String.format('Author:"{0}"',c[b])}if(c.length>1)a+=")";return a};Discovery.DiscoveryProperties.$c=function(o){ULSOAt:;var a=o;Discovery.DiscoveryProperties.$C=window.setInterval(Discovery.DiscoveryProperties.$w,1e3);var n=Discovery_Waitscreen_Text,e="";if(a.get_properties().Discovery_SP_Sources_Count>100||a.get_properties().Discovery_EX_Sources_Count>100)e=Discovery_Waitscreen_LRO_Text;if(!Discovery.DiscoveryProperties.$A)Discovery.DiscoveryProperties.$A=SP.UI.ModalDialog.showWaitScreenSize(n,e,null,null,null);Discovery.DiscoveryProperties.$H++;var b="";if(!a.get_isInitialLoad()){var f=Discovery.DiscoveryProperties.$12(a.get_queryGroupName()==="Discovery_Exchange"),g=Discovery.DiscoveryProperties.get_$10(),h=Discovery.DiscoveryProperties.get_$1B(),i=a.get_queryGroupName()==="Discovery_Exchange",c=0;if(!Srch.U.w(g)||!Srch.U.w(h)){if(c>0)b+=" AND ";b+=Discovery.DiscoveryProperties.$z(g,h,i);c++}if(f.length>0){if(c>0)b+=" AND ";b+=Discovery.DiscoveryProperties.$y(f,i);c++}if(a.get_queryGroupName()==="Discovery_Exchange"&&!Srch.U.e(Discovery.DiscoveryProperties.get_$d())){if(c>0)b+=" AND ";b+=String.format('(From:"@{0}" OR Recipients:"@{0}")',Discovery.DiscoveryProperties.get_$d());c++}a.get_properties().Discovery_Properties=b}if(a.get_queryGroupName()==="Discovery_Sharepoint"){var j=$get(getSharePointQueryId()),k=$get(getOriginalSharePointQueryId());if(!Srch.U.n(j)&&!Srch.U.n(k)){var l=k.value,d=a.get_properties().Discovery_Properties,m=Srch.U.e(d)?l:"("+l+") AND "+d;j.value=m;a.get_properties().HiddenConstraints=m;a.get_properties().Discovery_Filter=d}}};Discovery.DiscoveryProperties.$0=function(c,d){ULSOAt:;for(var b=document.getElementsByTagName(c),a=0;a<b.length;a++)if(b[a].id.indexOf(d)>0)return b[a];return null};Discovery.DiscoveryQueryStatistics=function(){};Discovery.DiscoveryQueryStatistics.registerOnSDP=function(){ULSOAt:;if(Discovery.DiscoveryQueryStatistics.$U)Discovery.DiscoveryQueryStatistics.$M=Discovery.DiscoveryQueryStatistics.$L=0;else{for(var b=Srch.ScriptApplicationManager.get_current(),f=b.queryGroups.Discovery_Sharepoint,g=b.queryGroups.Discovery_Exchange,a=b.queryGroups.Discovery_Sharepoint_Stats,h=b.queryGroups.Discovery_Exchange_Stats,c=0;c<a.searchBoxes.length;c++)if(a.searchBoxes[c].get_id().indexOf("DiscoveryStatsSearchbox")>0){Discovery.DiscoveryQueryStatistics.$P=a.searchBoxes[c];break}if(!Srch.U.n(h)){var d=h.dataProvider;if(!Srch.U.n(d)){d.add_resultReady(Discovery.DiscoveryQueryStatistics.$s);d.add_queryIssuing(Discovery.DiscoveryQueryStatistics.$r)}}if(!Srch.U.n(a)){var e=a.dataProvider;if(!Srch.U.n(e)){e.add_resultReady(Discovery.DiscoveryQueryStatistics.$s);e.add_queryIssuing(Discovery.DiscoveryQueryStatistics.$r)}}if(!Srch.U.n(f)){var i=f.dataProvider;!Srch.U.n(i)&&i.add_resultReady(Discovery.DiscoveryQueryStatistics.$6)}if(!Srch.U.n(g)){var j=g.dataProvider;!Srch.U.n(j)&&j.add_resultReady(Discovery.DiscoveryQueryStatistics.$6)}Discovery.DiscoveryQueryStatistics.$U=true}};Discovery.DiscoveryQueryStatistics.$q=function(a){ULSOAt:;Discovery.DiscoveryQueryStatistics.$P.search(a)};Discovery.DiscoveryQueryStatistics.$s=function(d,e){ULSOAt:;if(Srch.U.n(Discovery.DiscoveryQueryStatistics.$1))return;var a=d;if(a.get_queryGroupName()==="Discovery_Sharepoint_Stats")Discovery.DiscoveryQueryStatistics.$E=true;else if(a.get_queryGroupName()==="Discovery_Exchange_Stats")Discovery.DiscoveryQueryStatistics.$D=true;if(Discovery.DiscoveryQueryStatistics.$3!==Discovery.DiscoveryQueryStatistics.$4){try{Discovery.DiscoveryQueryStatistics.$3+=Discovery.DiscoveryQueryStatistics.$S(a,e)}catch(f){Srch.U.trace(null,"DiscoveryQueryStatistics.DataProvider_ResultReady",f.message);Discovery.DiscoveryQueryStatistics.$3=Discovery.DiscoveryQueryStatistics.$4;Discovery.DiscoveryQueryStatistics.$D=true;Discovery.DiscoveryQueryStatistics.$E=true}var b=$get(String.format("Disc_Query_Stat_{0}",Discovery.DiscoveryQueryStatistics.$1.$j_0));if(Srch.U.n(b))return;var c=Discovery.DiscoveryQueryStatistics.$3===Discovery.DiscoveryQueryStatistics.$4?Discovery.Resources.ediscovery_SourceError:Discovery.DiscoveryQueryStatistics.$3.toString();b.innerHTML=SP.Utilities.HttpUtility.htmlEncode(c)}if(Discovery.DiscoveryQueryStatistics.$E&&Discovery.DiscoveryQueryStatistics.$D){Discovery.DiscoveryQueryStatistics.$E=false;Discovery.DiscoveryQueryStatistics.$D=false;Discovery.DiscoveryQueryStatistics.$3=0;if(Discovery.DiscoveryQueryStatistics.$G.length>0){Discovery.DiscoveryQueryStatistics.$1=Array.dequeue(Discovery.DiscoveryQueryStatistics.$G);!Srch.U.e(Discovery.DiscoveryQueryStatistics.$1.$X_0)&&Discovery.DiscoveryQueryStatistics.$q(Discovery.DiscoveryQueryStatistics.$1.$X_0)}else Discovery.DiscoveryQueryStatistics.$1=null}};Discovery.DiscoveryQueryStatistics.$r=function(c,b){ULSOAt:;var a=b;if(!Discovery.DiscoveryQueryStatistics.$K&&a)a.result={}};Discovery.DiscoveryQueryStatistics.$19=function(a,e,f,g){ULSOAt:;var d=false;if(a.get_queryGroupName()==="Discovery_Sharepoint")if(!Srch.U.n(f)){var b=f.dataProvider;if(!Srch.U.n(b)){b.get_currentQueryState().r=a.get_currentQueryState().r;b.get_properties().Discovery_Properties=a.get_properties().Discovery_Properties;b.get_properties().HiddenConstraints=a.get_properties().HiddenConstraints;b.set_sourceID(a.get_sourceID());b.set_enableStemming(a.get_enableStemming());b.set_trimDuplicates(a.get_trimDuplicates());try{Discovery.DiscoveryQueryStatistics.$M=Discovery.DiscoveryQueryStatistics.$S(a,e)}catch(h){d=true;Srch.U.trace(null,"DiscoveryQueryStatistics.DataProvider_ResultReady",h.message)}Discovery.DiscoveryQueryStatistics.$9=true;Discovery.DiscoveryQueryStatistics.$K=true}}if(a.get_queryGroupName()==="Discovery_Exchange")if(!Srch.U.n(g)){var c=g.dataProvider;if(!Srch.U.n(c)){c.get_currentQueryState().r=a.get_currentQueryState().r;c.get_properties().Discovery_Properties=a.get_properties().Discovery_Properties;c.get_properties().Discovery_Sources=a.get_properties().Discovery_Sources;c.set_sourceID(a.get_sourceID());c.set_enableStemming(a.get_enableStemming());c.set_trimDuplicates(a.get_trimDuplicates());try{Discovery.DiscoveryQueryStatistics.$L=Discovery.DiscoveryQueryStatistics.$S(a,e)}catch(i){d=true;Srch.U.trace(null,"DiscoveryQueryStatistics.DataProvider_ResultReady",i.message)}Discovery.DiscoveryQueryStatistics.$8=true;Discovery.DiscoveryQueryStatistics.$K=true}}return d};Discovery.DiscoveryQueryStatistics.$6=function(l,m){ULSOAt:;var d=Srch.ScriptApplicationManager.get_current(),a=l,h=d.queryGroups.Discovery_Sharepoint_Stats,i=d.queryGroups.Discovery_Exchange_Stats,c=$get("discovery_query_statistics_error");if(c)if(a.get_properties().Discovery_SP_Sources_Count>100||a.get_properties().Discovery_EX_Sources_Count>100){Sys.UI.DomElement.removeCssClass(c,"ms-hide");return}else Sys.UI.DomElement.addCssClass(c,"ms-hide");var e=Discovery.DiscoveryQueryStatistics.$19(a,m,h,i);Discovery.DiscoveryQueryStatistics.$v(a);if(!Discovery.DiscoveryQueryStatistics.$8||!Discovery.DiscoveryQueryStatistics.$9)return;Discovery.DiscoveryQueryStatistics.$9=false;Discovery.DiscoveryQueryStatistics.$8=false;var f=a.get_currentQueryState().k;Discovery.DiscoveryQueryStatistics.$T=Discovery.DiscoveryQueryStatistics.$F(a,true)||Discovery.DiscoveryQueryStatistics.$F(a,false);var j=!Srch.U.w(f)&&Discovery.DiscoveryQueryStatistics.$T&&!e,b=$get("Discovery_Query_Statistics_Container");while(Discovery.DiscoveryQueryStatistics.$x(b))b.removeChild(b.lastChild);var g=$get("discovery_query_statistics_header");if(!j){Sys.UI.DomElement.addCssClass(g,"ms-hide");return}Discovery.DiscoveryQueryStatistics.$1=null;Discovery.DiscoveryQueryStatistics.$G=[];var k=Discovery.DiscoveryQueryStatistics.$a(f,0,e?Discovery.DiscoveryQueryStatistics.$4:Discovery.DiscoveryQueryStatistics.$L+Discovery.DiscoveryQueryStatistics.$M);b.appendChild(k);Sys.UI.DomElement.removeCssClass(g,"ms-hide")};Discovery.DiscoveryQueryStatistics.$v=function(a){ULSOAt:;var b=Srch.U.n(a.get_currentQueryState().r)?null:a.get_currentQueryState().r.toString(),d=a.get_queryGroupName()==="Discovery_Sharepoint"?Discovery.DiscoveryQueryStatistics.$W:Discovery.DiscoveryQueryStatistics.$V,c=b!==d;if(!Discovery.DiscoveryQueryStatistics.$8&&c&&a.get_queryGroupName()==="Discovery_Sharepoint"&&!Discovery.DiscoveryQueryStatistics.$F(a,true))Discovery.DiscoveryQueryStatistics.$8=true;else if(!Discovery.DiscoveryQueryStatistics.$9&&c&&a.get_queryGroupName()==="Discovery_Exchange"&&!Discovery.DiscoveryQueryStatistics.$F(a,false))Discovery.DiscoveryQueryStatistics.$9=true;if(a.get_queryGroupName()==="Discovery_Sharepoint")Discovery.DiscoveryQueryStatistics.$W=b;else Discovery.DiscoveryQueryStatistics.$V=b};Discovery.DiscoveryQueryStatistics.$x=function(a){ULSOAt:;return!Srch.U.n(a)&&a.hasChildNodes()&&(Srch.U.w(a.lastChild.tagName)||a.lastChild.tagName!=="CAPTION")};Discovery.DiscoveryQueryStatistics.$F=function(a,b){ULSOAt:;return!Srch.U.n(a)&&(b?!Srch.U.w(a.get_properties().Discovery_Sources):!Srch.U.w(a.get_properties().HiddenConstraints))};Discovery.DiscoveryQueryStatistics.$a=function(a,j,f){ULSOAt:;var g=a,c=document.createElement("TR");Sys.UI.DomElement.addCssClass(c,"discovery-querystats-stat-container");Discovery.DiscoveryQueryStatistics.$7++;var n=String.format("Disc_Query_Node_{0}",Discovery.DiscoveryQueryStatistics.$7);c.id=n;var d=document.createElement("TD"),b=document.createElement("DIV"),h=j+20;if(Discovery.DiscoveryQueryStatistics.$1A()&&f!==Discovery.DiscoveryQueryStatistics.$4)b.innerHTML=String.format('<a href="javascript:{0}" title="{1}" class="{2}">+</a>',String.format("Discovery.DiscoveryQueryStatistics.expandQuery({0},'{1}',{2});",Discovery.DiscoveryQueryStatistics.$7,SP.Utilities.HttpUtility.ecmaScriptStringLiteralEncode(a),h),String.format(Discovery.Resources.ediscovery_ExpandNodeTooltip,SP.Utilities.HttpUtility.htmlEncode(a)),"discovery-querystats-expander ms-floatLeft");b.title=a;var o=Sys.Browser.agent===Sys.Browser.InternetExplorer&&Sys.Browser.version<=8;if(o){var m=55-h/5;if(a.length>m)g=a.substr(0,m)+"&#8230"}if(Sys.Browser.agent===Sys.Browser.InternetExplorer&&Sys.Browser.version===9){var p=String.format('<div style="max-width:{0}px" class="ms-noWrap" title="{1}">{2}</div>',385-h,a,g);b.innerHTML+=p}else b.innerHTML+=g;Sys.UI.DomElement.addCssClass(b,"ms-noWrap ms-floatLeft");b.style.maxWidth=Discovery.DiscoveryQueryStatistics.$R(385);d.appendChild(b);Sys.UI.DomElement.addCssClass(d,"ms-fullWidth");c.appendChild(d);var k=document.createElement("TD"),i=document.createElement("SPAN");i.id=String.format("Disc_Query_Stat_{0}",Discovery.DiscoveryQueryStatistics.$7);var l=f!==Discovery.DiscoveryQueryStatistics.$Y;if(l){var q=f===Discovery.DiscoveryQueryStatistics.$4?Discovery.Resources.ediscovery_SourceError:f.toString();i.innerHTML=SP.Utilities.HttpUtility.htmlEncode(q)}if(Discovery.DiscoveryQueryStatistics.$13())d.style.paddingRight=Discovery.DiscoveryQueryStatistics.$R(j);else d.style.paddingLeft=Discovery.DiscoveryQueryStatistics.$R(j);k.appendChild(i);c.appendChild(k);if(!l){var e=new Discovery.DiscoveryQueryStatistics.PendingQuery;e.$j_0=Discovery.DiscoveryQueryStatistics.$7;e.$X_0=a;if(Srch.U.n(Discovery.DiscoveryQueryStatistics.$1)){Discovery.DiscoveryQueryStatistics.$1=e;!Srch.U.e(a)&&Discovery.DiscoveryQueryStatistics.$q(a)}else Array.enqueue(Discovery.DiscoveryQueryStatistics.$G,e)}return c};Discovery.DiscoveryQueryStatistics.$1A=function(){ULSOAt:;return true};Discovery.DiscoveryQueryStatistics.expandQuery=function(c,b,d){ULSOAt:;var a=new Discovery.DiscoveryQueryStatistics.PendingQueryExpansion;a.$e_0=c;a.$k_0=b;a.$o_0=d;Array.enqueue(Discovery.DiscoveryQueryStatistics.$2,a);Discovery.DiscoveryQueryStatistics.$2.length===1&&Discovery.DiscoveryQueryStatistics.$p(b)};Discovery.DiscoveryQueryStatistics.$p=function(c){ULSOAt:;var a={};a.query=c;var b=Discovery_WebServiceUrl;Sys.Net.WebServiceProxy.invoke(b,"ParseKQLQueryForStats",false,a,Discovery.DiscoveryQueryStatistics.$16,Discovery.DiscoveryQueryStatistics.$15,null,Sys.Net.WebRequestManager.get_defaultTimeout(),false,null)};Discovery.DiscoveryQueryStatistics.$16=function(i){ULSOAt:;var c=i,f=Array.dequeue(Discovery.DiscoveryQueryStatistics.$2),b=$get(String.format("Disc_Query_Node_{0}",f.$e_0)),a=b.querySelector("."+"discovery-querystats-expander ms-floatLeft".replace(" ","."));if(!Srch.U.n(a)){var d=document.createElement("span");d.innerHTML=a.innerHTML;d.className=a.className;a.parentNode.replaceChild(d,a)}if(c.length>100){alert(Discovery.Resources.ediscovery_TooManyKeywordsError);return}for(var e=c.length-1;e>=0;e--){var g=Discovery.DiscoveryQueryStatistics.$a(c[e],f.$o_0,Discovery.DiscoveryQueryStatistics.$Y),h=b.nextSibling;if(h)b.parentNode.insertBefore(g,h);else b.parentNode.appendChild(g)}Discovery.DiscoveryQueryStatistics.$f()};Discovery.DiscoveryQueryStatistics.$15=function(a){ULSOAt:;if(!a)throw Error.argumentNull("error");Srch.U.trace(null,"OnFailedSplitQuery",a.get_message());var b=Array.dequeue(Discovery.DiscoveryQueryStatistics.$2);Discovery.DiscoveryQueryStatistics.$f()};Discovery.DiscoveryQueryStatistics.$f=function(){ULSOAt:;var a=Discovery.DiscoveryQueryStatistics.$2.length;if(a>0){var b=Array.dequeue(Discovery.DiscoveryQueryStatistics.$2);Array.enqueue(Discovery.DiscoveryQueryStatistics.$2,b);for(var c=0;c<a-1;++c){var d=Array.dequeue(Discovery.DiscoveryQueryStatistics.$2);Array.enqueue(Discovery.DiscoveryQueryStatistics.$2,d)}Discovery.DiscoveryQueryStatistics.$p(b.$k_0)}};Discovery.DiscoveryQueryStatistics.$S=function(c,i){ULSOAt:;var f=0,g=false,d=null,a=null,e=false;if(!Srch.U.n(i))d=i;if(!Srch.U.n(d)&&!Srch.U.n(d.result)){a=d.result.ResultTables;g=Srch.U.isArray(a)}var h=c.get_queryGroupName()==="Discovery_Exchange_Stats"||c.get_queryGroupName()==="Discovery_Exchange";if(g)for(var b=0;b<a.length;b++){var j=a[b].TableType;if(j==="RelevantResults")if(c.get_queryGroupName()==="Discovery_Sharepoint_Stats"||c.get_queryGroupName()==="Discovery_Sharepoint"){f+=Discovery.DiscoveryQueryStatistics.$l(a[b].TotalRows);e=true}else if(h){f+=Discovery.DiscoveryQueryStatistics.$l(a[b].Properties.Discovery_TotalItemCount);e=true}}else if(!Discovery.DiscoveryQueryStatistics.$F(c,h))e=true;if(!e)throw Error.invalidOperation("Unable to find results table collection");return f};Discovery.DiscoveryQueryStatistics.$R=function(a){ULSOAt:;return a.toString()+"px"};Discovery.DiscoveryQueryStatistics.$l=function(a){ULSOAt:;return!Srch.U.n(a)&&!isNaN(a)?a:0};Discovery.DiscoveryQueryStatistics.$13=function(){ULSOAt:;return!Srch.U.n(document.body.parentNode)&&document.body.parentNode.dir.toUpperCase()==="RTL"};Discovery.DiscoveryQueryStatistics.PendingQuery=function(){};Discovery.DiscoveryQueryStatistics.PendingQueryExpansion=function(){};Discovery.Refiners=function(){};Discovery.Refiners.createSpecifyOtherDropdownSP=function(a,c){ULSOAt:;var b=["Author","Title","ContentClass","ContentType","WebTemplate"];return Discovery.Refiners.$b(a,c,b)};Discovery.Refiners.createSpecifyOtherDropdownEX=function(a,c){ULSOAt:;var b=["from","participants","recipients","subject"];return Discovery.Refiners.$b(a,c,b)};Discovery.Refiners.createSpecifyOtherValueBox=function(b,d){ULSOAt:;if(!Srch.U.n(b)){var c=document.createElement("div"),a=document.createElement("input");a.type="text";a.setAttribute("id",d+"Val");a.className="ms-ref-refineritem";c.appendChild(a);b.appendChild(c);return a}return null};Discovery.Refiners.createSpecifyOtherSubmitTag=function(b){ULSOAt:;if(!Srch.U.n(b)){var c=document.createElement("div"),a=document.createElement("a");a.setAttribute("href","javascript:{}");a.innerHTML=SP.Utilities.HttpUtility.htmlEncode(Srch.U.loadResource("rf_Apply"));c.appendChild(a);b.appendChild(c);return a}return null};Discovery.Refiners.submitUserSpecifiedRefiner=function(d,e){ULSOAt:;var f=$get(d+"Prop"),g=$get(d+"Val"),a=f.value,b=g.value,c=e;!Srch.U.n(c)&&!Srch.U.w(a)&&!Srch.U.w(b)&&c.addRefinementFilter(a,Srch.Refinement.ensureUserSpecifiedRefinerValueHasWhiteSpaceQuotes(b))};Discovery.Refiners.$b=function(k,l,c){ULSOAt:;var h=document.createElement("div"),a=document.createElement("select");a.setAttribute("id",l+"Prop");a.className="ms-ref-refineritem";for(var e=new Array(c.length),b=0;b<c.length;b++){var f=document.createElement("option");f.innerHTML=Srch.Refinement.getRefinementLocalizedTitle(c[b]);f.value=c[b];e[b]=f}e.sort(Discovery.Refiners.$11());for(var g=e,i=g.length,d=0;d<i;++d){var j=g[d];a.appendChild(j)}h.appendChild(a);k.appendChild(h);return a};Discovery.Refiners.$11=function(){ULSOAt:;return function(c,d){ULSOAt:;var a=c.innerHTML.toLowerCase(),b=d.innerHTML.toLowerCase();a=!a?"":a;b=!b?"":b;return a===b?0:a<b?-1:1}};Discovery.Refiners.clearAllRefiners=function(b){ULSOAt:;if(Srch.U.n(b))return;var a=new Srch.QueryState;a.r=new Array(0);a.s=1;b.refresh(a)};Discovery.DiscoverySearchGlobalControl=function(){};Discovery.DiscoverySearchGlobalControl.registerOnSDP=function(){ULSOAt:;var a=Srch.ScriptApplicationManager.get_current(),b=a.queryGroups.Discovery_Sharepoint,c=a.queryGroups.Discovery_Exchange;if(!Srch.U.n(b)){var d=b.dataProvider;!Srch.U.n(d)&&d.add_resultReady(Discovery.DiscoverySearchGlobalControl.$6)}if(!Srch.U.n(c)){var e=c.dataProvider;!Srch.U.n(e)&&e.add_resultReady(Discovery.DiscoverySearchGlobalControl.$6)}};Discovery.DiscoverySearchGlobalControl.$6=function(g){ULSOAt:;var a=g,c=a.get_currentQueryState().r,d="";if(!Srch.U.n(c))d=JSON.stringify(c);var b=null;if(a.get_queryGroupName()==="Discovery_Sharepoint")b=Discovery.DiscoveryProperties.$0("input","Discovery_SPRefinements_Hidden");else if(a.get_queryGroupName()==="Discovery_Exchange")b=Discovery.DiscoveryProperties.$0("input","Discovery_EXRefinements_Hidden");b.value=d;var e=Discovery.DiscoveryProperties.$0("input","Discovery_Deduplication_Hidden");e.value=Discovery.DiscoveryProperties.get_$B().toString();var f=Discovery.DiscoveryProperties.$0("input","Discovery_Stemming_Hidden");f.value=Discovery.DiscoveryProperties.get_$5().toString()};Discovery.DiscoverySearchGlobalControl.showExchange=function(){ULSOAt:;Discovery.DiscoverySearchGlobalControl.$n(true)};Discovery.DiscoverySearchGlobalControl.showSharepoint=function(){ULSOAt:;Discovery.DiscoverySearchGlobalControl.$n(false)};Discovery.DiscoverySearchGlobalControl.$n=function(a){ULSOAt:;var f=$get("exchange");Discovery.DiscoverySearchGlobalControl.$m(f,a);var g=$get("sharepoint");Discovery.DiscoverySearchGlobalControl.$m(g,!a);var b=$get("SPTab"),c=$get("EXTab"),d=a?c:b,e=a?b:c;Sys.UI.DomElement.removeCssClass(e,"edisc-ActiveTab");Sys.UI.DomElement.addCssClass(e,"edisc-UnactiveTab");Sys.UI.DomElement.removeCssClass(d,"edisc-UnactiveTab");Sys.UI.DomElement.addCssClass(d,"edisc-ActiveTab")};Discovery.DiscoverySearchGlobalControl.$m=function(a,b){ULSOAt:;if(!Srch.U.n(a)&&!Srch.U.n(a.style))a.style.display=b?"inline":"none"};Discovery.DiscoveryProperties.registerClass("Discovery.DiscoveryProperties",Srch.ClientControl);Discovery.DiscoveryQueryStatistics.registerClass("Discovery.DiscoveryQueryStatistics");Discovery.DiscoveryQueryStatistics.PendingQuery.registerClass("Discovery.DiscoveryQueryStatistics.PendingQuery");Discovery.DiscoveryQueryStatistics.PendingQueryExpansion.registerClass("Discovery.DiscoveryQueryStatistics.PendingQueryExpansion");Discovery.Refiners.registerClass("Discovery.Refiners");Discovery.DiscoverySearchGlobalControl.registerClass("Discovery.DiscoverySearchGlobalControl");function ediscovery_discoverysearchcontrols_initialize(){ULSOAt:;Discovery.DiscoveryProperties.$t=new RegExp("\\b(OR|AND|NEAR|ONEAR)\\b","gi");Discovery.DiscoveryProperties.$I=null;Discovery.DiscoveryProperties.$N=null;Discovery.DiscoveryProperties.$J=null;Discovery.DiscoveryProperties.$A=null;Discovery.DiscoveryProperties.$H=0;Discovery.DiscoveryProperties.$C=0;Discovery.DiscoveryProperties.$Q=false;Discovery.DiscoveryQueryStatistics.$P=null;Discovery.DiscoveryQueryStatistics.$Y=-1;Discovery.DiscoveryQueryStatistics.$4=-2;Discovery.DiscoveryQueryStatistics.$U=false;Discovery.DiscoveryQueryStatistics.$G=[];Discovery.DiscoveryQueryStatistics.$2=[];Discovery.DiscoveryQueryStatistics.$1=null;Discovery.DiscoveryQueryStatistics.$3=0;Discovery.DiscoveryQueryStatistics.$M=0;Discovery.DiscoveryQueryStatistics.$L=0;Discovery.DiscoveryQueryStatistics.$E=false;Discovery.DiscoveryQueryStatistics.$D=false;Discovery.DiscoveryQueryStatistics.$9=false;Discovery.DiscoveryQueryStatistics.$8=false;Discovery.DiscoveryQueryStatistics.$K=false;Discovery.DiscoveryQueryStatistics.$T=false;Discovery.DiscoveryQueryStatistics.$W="";Discovery.DiscoveryQueryStatistics.$V="";Discovery.DiscoveryQueryStatistics.$7=0}ediscovery_discoverysearchcontrols_initialize();RegisterModuleInit("ediscovery.discoverysearchcontrols.js",ediscovery_discoverysearchcontrols_initialize);typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();NotifyScriptLoadedAndExecuteWaitingJobs("EDiscovery.DiscoverySearchControls.js");