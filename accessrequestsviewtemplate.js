function $_global_accessrequestsviewtemplate(){(function(){a:;var a={};a.Templates={};a.BaseViewID="Callout";a.ListTemplateType=160;a.Templates.Footer=function(a){return l(a,s)};a.Templates.Item=p;a.Templates.Header=m;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(a);function s(a,c){var f=a,b=a.CurrentItem,d=b["IsInvitation.value"];if(f.clvp.ctx.BaseViewID==_pendingRequestsBaseViewId&&d=="0"){var g={contactingServerMsg:Strings.STS.L_AccReqSendingApproval,successMsg:Strings.STS.L_AccReqApprovalSuccess,failureMsg:Strings.STS.L_AccReqApprovalFail},h={contactingServerMsg:Strings.STS.L_AccReqSendingDenial,successMsg:Strings.STS.L_AccReqDenialSuccess,failureMsg:Strings.STS.L_AccReqDenialFail};c.addAction(new CalloutAction({text:Strings.STS.L_AccRqCllUtActApprv,isEnabledCallback:u(b.ID,this,a),disabledTooltip:Strings.STS.L_AccRqWrnPerm,onClickCallback:e(a,b.ID,1,g)}));c.addAction(new CalloutAction({text:Strings.STS.L_AccRqCllUtActDcl,onClickCallback:e(a,b.ID,3,h)}));var k=a.CurrentItem.ID+_permSelectIdSuffix,l=document.getElementById(k);l.onchange=function(){a:;c.render();return false}}else if(f.clvp.ctx.BaseViewID==_pendingInvitationsBaseViewId&&d=="1"){var i={contactingServerMsg:Strings.STS.L_AccReqResendingInv,successMsg:Strings.STS.L_AccReqResendingInvSuccess,failureMsg:Strings.STS.L_AccReqResendingInvFail},j={contactingServerMsg:Strings.STS.L_AccReqRevokingInv,successMsg:Strings.STS.L_AccReqRevokingInvSuccess,failureMsg:Strings.STS.L_AccReqRevokingInvFail};c.addAction(new CalloutAction({text:Strings.STS.L_AccRqCllUtActRsnd,onClickCallback:e(a,b.ID,0,i)}));c.addAction(new CalloutAction({text:Strings.STS.L_AccRqCllUtActRvk,onClickCallback:e(a,b.ID,5,j)}))}}function u(a){return function(){a:;var d=document.getElementById(a+_permSelectIdSuffix),e=d.value,c=e.split(_accRqOptSep),b=c[1];return!g_accReqCSRBridgeSPGroups[b]&&!g_accReqCSRBridgeSPIndvPerms[b]?false:true}}function l(b,a){if(a==undefined||a==null)a=CalloutOnPostRenderTemplate;var c=GetCalloutElementIDFromRenderCtx(b);AddPostRenderCallback(b,function(){a:;var d=new CalloutActionMenu(c+"-actions");a(b,d);d.render()});return Callout.GenerateDefaultFooter(c,null)}function m(a){var d=GetCalloutElementIDFromRenderCtx(a),c=a.CurrentItem.ReqForUser,b=STSHtmlEncode(a.CurrentItem.RequestedForDisplayName);if(c.length>0)b=STSHtmlEncode(a.CurrentItem.ReqForUser[0].title);return Callout.GenerateDefaultHeader(d,b,null,true)}function p(a){var b=a.CurrentItem,g=GetCalloutElementIDFromRenderCtx(a),e=[];e.push(w(a,b,g));var c=b["IsInvitation.value"]=="1",d=GetCalloutFromRenderCtx(a);if(c){var f=GetConversationCalloutWidth();d.set({contentWidth:f})}else d.set({contentWidth:520});!c&&GetCalloutOpeningCallbackFunc(b.ID,b.ID+_convDivIdSuffix,1)();return e.join("")}function o(b,a,e,d){a:;var h=b+_permSelectIdSuffix,c="",f;if(a.RequestedListItemId!=SP.Guid.get_empty().toString("B"))c=g(b,a,e,d,null);else if(a.RequestedListId!=SP.Guid.get_empty().toString("B"))c=g(b,a,e,d,null);else{f=g_accReqCSRBridgeSPSecToGrps[a.RequestedWebId];c=g(b,a,e,d,f)}return c}function g(n,k,j,o,d){var e=k.PermissionLevelRequested,m=n+_permSelectIdSuffix,i="",b,f,c;if(j!=_pendingRequestsBaseViewId&&j!=_pendingInvitationsBaseViewId)i='disabled="true"';var a="<select "+i+' id="'+m+'" class="ms-accRqCllOt-PrmCmbBx">';if(!g_accReqCSRBridgeSPGroups[e]&&!g_accReqCSRBridgeSPIndvPerms[e])a=a+'<option selected="yes" name="permissionLevelNotSelected" title ="'+Strings.STS.L_AccessRequestPermissionFieldDisplayError+'" value = "'+Strings.STS.L_AccessRequestPermissionFieldDisplayError+'">'+Strings.STS.L_AccessRequestPermissionFieldDisplayError+"</option>";if(Boolean(d)&&d.length>0)for(var l in d){var h=d[l];b=g_accReqCSRBridgeSPGroups[h];f=_strAccRqSPGrp+_accRqOptSep+h;if(h==e)c='selected="yes"';else c="";a=a+"<option "+c+' name="'+b+'" title = "'+b+'" value = "'+f+'">'+b+"</option>"}for(var g in g_accReqCSRBridgeSPIndvPerms){b=g_accReqCSRBridgeSPIndvPerms[g];f=_strAccRqSPRlDf+_accRqOptSep+g;if(g==e)c='selected="yes"';else c="";a=a+"<option "+c+' name="'+b+'" title = "'+b+'" value = "'+f+'">'+b+"</option>"}a=a+"</select>";return a}function w(p,b,n){a:;var a=b.ID,k=p,l="";if(b.ApprovedBy)l=b.ApprovedBy[0].title;var q=j(b),i=a+_convDivIdSuffix,e="",f="",c='"ms-accReqCtl-clltTtl ms-textLarge ms-soften"';if(k.clvp.ctx.BaseViewID==_pendingRequestsBaseViewId){e='<div id="'+a+'convTitle" class='+c+">"+Strings.STS.L_AccReqList_Conversation+"</div>";e=e+"<div>"+GetCalloutConvAreaMarkup(b.ID,a,true,null)+"</div>";f=String.format(_strconvDivContent,"ms-accRqCllOt-CnvMsg",i)}else f=String.format(_strconvDivContent,"ms-accRqCllOt-CnvMsgTall",i);var m=b["IsInvitation.value"],h="",g="";if(m=="0"){h="ms-accRqCllOt-CllMnDv";g="ms-accRqCllOt-CllLfDv"}else{h="ms-accReqCtl-PrsPermCllOt";g=""}var d='<div class="'+h+"\"><div class='"+g+"'><div id=\""+a+_PermDivIdSuffix+'" class='+c+">"+Strings.STS.L_AccRqCllUtPermTtl+"</div><div class='ms-accReqCtl-clltDes'>"+o(a,b,k.clvp.ctx.BaseViewID,n+"-actions")+'</div><div id="'+a+_ReqByDivIdSuffix+'" class='+c+">"+Strings.STS.L_AccRqCllUtRqBy+'</div><div id="'+a+_ReqByValueDivIdSuffix+"\" class='ms-accReqCtl-clltDes'>"+STSHtmlEncode(b.ReqByUser[0].title)+'</div><div id="'+a+_ReqResrcDivIdSuffix+'" class='+c+">"+Strings.STS.L_AccRqCllUtRqFor+'</div><div id="'+a+_ReqResrcValueDivIdSuffix+"\" class='ms-accReqCtl-clltDes'>"+STSHtmlEncode(b.RequestedObjectTitle)+'</div><div id="'+a+_CrtdDivIdSuffix+'" class='+c+">"+Strings.STS.L_AccRqCllUtCrtd+'</div><div id="'+a+_CrtdValueDivIdSuffix+"\" class='ms-accReqCtl-clltDes'>"+b.Created+'</div><div id="'+a+_StatDivIdSuffix+'" class='+c+">"+Strings.STS.L_AccRqCllUtSts+'</div><div id="'+a+_StatValueDivIdSuffix+"\" class='ms-accReqCtl-clltDes'>"+q+"</div></div>";if(b["IsInvitation.value"]=="0")d=d+"<div class='ms-accRqCllOt-CllRtDv'>"+e+f+"</div>";d=d+"</div>";return d}function e(c,d,b,a){a:;return function(f,e){a:;v(e,c,d,b,a)}}function v(e,d,b,c,a){EnsureScriptFunc("SP.js","SP.ClientContext",function(){a:;var g=document.getElementById(b+_permSelectIdSuffix);if(g!=null){var k=d.clvp.ctx.BaseViewID,j=k==_pendingRequestsBaseViewId;if(j||k==_pendingInvitationsBaseViewId){var n=g.value,e=n.split(_accRqOptSep);if(e[0]==_strAccRqSPGrp||e[0]==_strAccRqSPRlDf||c!=1){var m=e[1],f=null;if(j){f=document.getElementById(b+_newCommentBoxName).value;if(f==Strings.STS.L_AccRqCllUtPst)f=""}var h=SP.ClientContext.get_current();if(h!=null){SP.AccessRequests.changeRequestStatus(h,b,c,f,e[0],m);h.executeQueryAsync(function(a){a:;return function(b,c){onUpdateAccRqItm(b,c,a)}}(a),function(a){a:;return function(b,c){x(b,c,a)}}(a));i(g,a.contactingServerMsg)}}else{var l=Strings.STS.L_AccRqWrnPerm+e[0];i(g,l)}}}})}function i(c,b){a:;var d=addNotification(b,true),a=CalloutManager.getFromCalloutDescendant(c);a!=null&&a.close(true);setTimeout(GetClearToastFunction(d),_timeOut)}function x(c,d,a){var b=addNotification(a.failureMsg,true);setTimeout(GetClearToastFunction(b),_timeOut)}var f={};f.Templates={};f.ListTemplateType=160;f.Templates.Fields={User:{View:n},StatusDisp:{View:q},PermissionDisp:{View:t},ObjectRequestedTitleDisp:{View:k},RequestDate:{View:r}};function j(c){var a="",o=c.Status,j=c["IsInvitation.value"];switch(o){case"0":if("1"==j){var k=new Date(c.Expires),b=new Date;b=new Date(b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate(),b.getUTCHours(),b.getUTCMinutes(),b.getUTCSeconds(),b.getUTCMilliseconds());var d=Math.round(k.getTime()-b.getTime());if(d<0)a=a+Strings.STS.L_AccessRequestStatusExpired;else{var m=24*60*60*1e3,f=Math.round(d/m);a=a+Strings.STS.L_AccessRequestStatusPending;if(f>0)a=a+String.format(Strings.STS.L_AccessRequestStatusExpiresInDays,f);else{var l=1*60*60*1e3,e=Math.round(d/l);if(e>0)a=a+String.format(Strings.STS.L_AccessRequestStatusExpiresInHours,e);else{var n=1*60*1e3,g=Math.round(d/n);if(g>0)a=a+Strings.STS.L_AccessRequestStatusExpiresInAnyMinNow}}}}else a=a+Strings.STS.L_AccessRequestStatusPending;break;case"1":var i=Boolean(c.ApprovedBy)?STSHtmlEncode(c.ApprovedBy[0].title):"";a=a+String.format(Strings.STS.L_AccessRequestStatusApproved,i);break;case"2":var h=Boolean(c.ReqForUser)?STSHtmlEncode(c.ReqForUser[0].title):"";a=a+String.format(Strings.STS.L_AccessRequestStatusAccepted,h);break;case"3":a=a+Strings.STS.L_AccessRequestStatusDenied;break;case"4":a=a+Strings.STS.L_AccessRequestStatusExpired;break;case"5":a=a+Strings.STS.L_AccessRequestStatusRevoked}return a}function k(g,h,b){var c,a=[],e=b.RequestedObjectUrl,d=STSHtmlEncode(b.RequestedObjectTitle);a.push('<a onfocus="OnLink(this)" href="');a.push(e);a.push('">');a.push(d);a.push("</a>");c=a.join("");return c}function r(d,e,a,c){var b=new DateTimeFieldRenderer("RequestDate");a["RequestDate.FriendlyDisplay"]=a["Created.FriendlyDisplay"];return b.RenderField(d,e,a,c)}function t(h,i,d){var f,a=[];if(Boolean(g_accReqCSRBridgeSPGroups)&&Boolean(g_accReqCSRBridgeSPIndvPerms)&&d.PermissionType.length>0){var b=d.PermissionLevelRequested,e=d.PermissionType,c=Strings.STS.L_AccessRequestPermissionFieldDisplayError;if(e==="SharePoint Group"){if(g_accReqCSRBridgeSPGroups[b]!=null)c=g_accReqCSRBridgeSPGroups[b]}else if(e==="Role Definition")if(g_accReqCSRBridgeSPIndvPerms[b]!=null)c=g_accReqCSRBridgeSPIndvPerms[b];a.push("<span>");a.push(c);a.push("</span>")}else{a.push("<span>");a.push(Strings.STS.L_CantDisplayAccessRequestPermissionField);a.push("</span>")}f=a.join("");return f}function q(e,f,c){var b,a=[];a.push(j(c));a.push("<span>");b=a.join("");a.push("</span>");return b}function n(b,j,c,h){if("1"==c["IsInvitation.value"]){var g=b.CurrentItem,d=g.RequestedForDisplayName,i={ID:"0",Editor:[{title:d,email:d,CustomDetail:""}]},e={Field:[{Name:"Editor",FieldType:"User",WithPictureDetail:"1",PictureSize:"Size_36px",Type:"User"}],PresenceAlt:Strings.STS.L_UserFieldNoUserPresenceAlt,EffectivePresenceEnabled:"1"},a=new ContextInfo;a.Templates={};a.Templates.Fields={};return spMgr.RenderFieldByName(a,"Editor",i,e)}else{var f=new UserFieldRenderer("ReqForUser");return f.RenderField(b,j,c,h)}}SPClientTemplates.TemplateManager.RegisterTemplateOverrides(f);var c={};c.Templates={};c.BaseViewID=1;c.ListTemplateType=160;c.Templates.View=function(a){return h(a,Strings.STS.AccReqList_PendReqView)};SPClientTemplates.TemplateManager.RegisterTemplateOverrides(c);var d={};d.Templates={};d.BaseViewID=2;d.ListTemplateType=160;d.Templates.View=function(a){return h(a,Strings.STS.AccReqList_PendInvView)};SPClientTemplates.TemplateManager.RegisterTemplateOverrides(d);var b={};b.Templates={};b.BaseViewID=3;b.ListTemplateType=160;b.Templates.View=function(a){return h(a,Strings.STS.AccReqList_HistoryView)};SPClientTemplates.TemplateManager.RegisterTemplateOverrides(b);function h(a,b){return a.Templates.Body!=""&&a.Templates.Header!=""?"<h2 class='ms-uppercase'>"+b+"</h2>"+RenderViewTemplate(a):RenderViewTemplate(a)}})();typeof Sys!="undefined"&&Sys!=null&&Sys.Application!=null&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs=="function"&&NotifyScriptLoadedAndExecuteWaitingJobs("accessrequestsviewtemplate.js")}function ULSaQO(){var a={};a.ULSTeamName="Microsoft SharePoint Foundation";a.ULSFileName="accessRequestsviewtemplate.commentedjs";return a}var g_accReqCSRBridgeSPSecToGrps,g_accReqCSRBridgeSPGroups,g_accReqCSRBridgeSPIndvPerms;$_global_accessrequestsviewtemplate();