function $_global_devdash(){CSSUtil={AddClass:function(b,a){b.className+=" "+a},RemoveClass:function(a,b){a.className=a.className.replace(" "+b,"")}};EV_MOUSE_DOWN="mousedown";EV_MOUSE_MOVE="mousemove";EV_MOUSE_UP="mouseup";(function(){ddTabCtrlEvents.elLoading=null;ddTabCtrlEvents.ACTION_REFRESH="refresh";ddTabCtrlEvents.ACTION_FOCUS="focus";ddTabCtrlEvents.ACTION_BLUR="blur";ddTabCtrlEvents.ACTION_CLEAR="clear";ddTabCtrlEvents.ACTION_PAUSE="pause";ddTabCtrlEvents.createLoading=function(){var a;a=document.createElement("DIV");a.className="ms-dd-loading";a.innerHTML="<i>Loading...</i>";return a}})();(function(){DevDashOOB.RECEIVEMSG="receiveMsg";DevDashOOB()})();(function(){ScopeUtils={GetTimeLength:g,AddServerDataToGantt:a,AddClientDataToGantt:b,NormalizeCPUDuration:d,GetMemoryBytesString:c,RequestHasMemoryData:e};function g(b){var a,c;a=b.StartTimeUtc;c=b.EndTimeUtc;return c-a}function a(i,m,f,n){var j,p,b,h,o,l,k,g;if(null==m||null==f)return;p=m.length;for(j=0;j<p;j++){b=m[j];if("ChildScopes"in f&&b.Id in f.ChildScopes){h=f.ChildScopes[b.Id];o=d(h.CPUDuration);if(e(f))l=c(h.Memory_ManagedBytes,h.Memory_ManagedBytesLOH)}if(undefined==n)if(b.Name=="ExecuteWcfServerOperation")g=true;else g=false;else g=n;k=[o];l!=null&&k.push(l);i.addRow(b.Name,b.StartTimeUtc,b.EndTimeUtc,[b.Machine],k,g);if(g)a(i,b.Children,f,true);else a(i,b.Children,f);i.endRow()}}function b(d,e){var c,f,a;if(null==e)return;f=e.length;for(c=0;c<f;c++){a=e[c];d.addRow(a.Name,a.StartTimeUtc,a.EndTimeUtc);b(d,a.Children);d.endRow()}}function d(a){return a}function f(a){return(a/1048576).toFixed(3)+Strings.DevDash.Common_MB}function c(a,c){var b;if(a==undefined||a==null)return Strings.DevDash.Common_NA;if(a==0)return"-";b=f(a);if(c>0)b+=" [LOH: "+f(c)+"]";return b}function e(b){var a,c;if(b===null)return false;a=b.Memory_ManagedBytes;return a!==undefined&&a!==null&&a!==0}})();(function(){var a={};DiagnosticsDataDepot={Add:c,Get:d,Remove:b};function c(c,d){var b;b=!(c in a);a[c]=d;return b}function d(b){return!(b in a)?null:a[b]}function b(b){delete a[b]}})();(function(){var b,a;b=null;a=null;DiagnosticsDataProvider={GetRequests:f,GetDataForRequest:d,GetULSLog:g,SetUpdatedTime:e};function f(d){var b;b="/_vti_bin/diagnosticsdata.svc/my/scopes";if(null!=a)b=b+"?startTimeUtc="+a;c(b,d)}function d(b,d,e){var a;a="/_vti_bin/diagnosticsdata.svc/"+b+"/data?executionplanAsLink=true";c(a,d,e)}function g(b,d,e){var a;a="/_vti_bin/diagnosticsdata.svc/"+b+"/uls";c(a,d,e)}function c(e,b,d){var a;a=new XMLHttpRequest;a.open("GET",e,true);a.onreadystatechange=c;a.send();function c(){var response;if(4!=a.readyState)return;else if(200!=a.status){b(null);return}try{response=eval(a.responseText);b(response,d)}catch(e){}}}function e(c){if(null==b||c.valueOf()>b.valueOf()){b=c;a=ddGetUTCTimeString(c)}}})();(function(){var b,a;a=0;b=0;DeveloperDashboard.Messaging.Subscribe("MS.DiagnosticsData",{Start:o,Stop:h,Refresh:c,receiveMsg:null});function o(){if(0!=a)return;window.setTimeout(c,0);a=window.setInterval(c,3e3)}function h(){if(0==a)return;window.clearInterval(a);a=0}function c(){DiagnosticsDataProvider.GetRequests(m)}function m(c){var b,d,a;if(null==c||0==(d=c.length)){g();return}f();for(b=0;b<d;b++){a=c[b];e(a);DiagnosticsDataProvider.GetDataForRequest(a.CorrelationId,i,a)}}function i(c,a){var d;if(null==c){g();return}d=k(c,a);if(a.ParentId==-1){var b=a.Id;DiagnosticsDataDepot.Add(b,a)&&DeveloperDashboard.Messaging.PostMsg("MS.Requests","AddRequest",b)}}function k(i,d){var g,k,a,b,c,f,h,e;e=0;k=i.length;for(g=0;g<k;g++){a=i[g];if(d.Id==a.ScopeId)c=d;else{if(!("ChildScopes"in d))d.ChildScopes={};c=d.ChildScopes[a.ScopeId];if(undefined===c)c=d.ChildScopes[a.ScopeId]={}}b=n(a.Name);if(1==b.length)c[b[0]]=a.Value;else if(2==b.length){if(!(b[0]in c))c[b[0]]={};c[b[0]][b[1]]=a.Value}else j(a,d,b);if("PutTimeUtc"in a){f=ddGetDateFromJsonString(a.PutTimeUtc);if(f.valueOf()>e){e=f.valueOf();h=f}}}e>0&&DiagnosticsDataProvider.SetUpdatedTime(h)}function j(f,c,a){var b,e,d;if(!(a[0]in c))c[a[0]]={};b=c[a[0]].Children;if(undefined===b)b=c[a[0]].Children=[];d=g(b,a[1],a[2]);if(null!=d)d[a[2]]=f.Value;else{e={Name:a[1],Scope:f.ScopeId,Properties:{}};e.Properties[a[2]]=f.Value;b.push(e)}function g(e,g,f){var d,a,b,c;d=e.length;for(a=0;a<d;a++){b=e[a];if(b.Name==g&&(c=b.Properties)!=undefined&&!(f in c))return c}return null}}function n(a){var b,c;b=a.indexOf(".");if(-1==b)return[a];c=a.lastIndexOf(".");return c==b?[a.substring(0,b),a.substring(b+1)]:[a.substring(0,b),a.substring(b+1,c),a.substring(c+1)]}function e(d){var b,f,a,c;l(d);a=d.Children;if(null==a)return;f=a.length;for(b=0;b<f;b++){c=a[b];e(c)}}function l(a){var b;if("string"==typeof a.StartTimeUtc)a.StartTimeUtc=d(a.StartTimeUtc);if("string"==typeof a.EndTimeUtc)a.EndTimeUtc=d(a.EndTimeUtc)}function d(a){a=a.replace("/Date(","");a=a.replace(")/","");return Number(a)}function g(){b++;if(61==b){f();h();DeveloperDashboard.Messaging.PostMsg("MS.Requests","Pause",null)}}function f(){b=0}})();(function(){var f,d,m,k,a,c,g,h,o,p,b,n,i,e;p={AddRequest:v,Pause:j};n=false;b=true;i=null;e=0;DeveloperDashboard.Modes.Add({_syncInit:null,name:"MS.Requests",displayName:Strings.DevDash.Requests_Tab,init:C,focus:A,blur:B,refresh:y,pause:j,clear:z,onResize:x,receiveMsg:w});function C(i){var b,e;f=document.createElement("DIV");f.style.height="100%";d=ddVSplitView(f,true,.4*i);a=document.createElement("DIV");a.style.height="100%";a.style.overflowY="auto";k=document.createElement("DIV");o=CreateDisplayText(Strings.DevDash.Requests_Placeholder);a.appendChild(o);d.top.appendChild(a);m=ddListView(k,l);b=document.createElement("DIV");h=ddTabCtrlEvents(b,null,u,s);e=GetClientHeight(b,document.body);c=ddVSplitView(d.bottom,false,e);c.top.appendChild(b);c.bottom.className="ms-dd-reqinfo-panel";g=document.createElement("DIV");g.className="ms-dd-reqinfo-tab";c.bottom.appendChild(g);DeveloperDashboard.Modes.Requests={AddDiagnostics:h.addTab};return f}function u(b){var a;a=g;ClearArea(a);a.appendChild(b);window.setTimeout(t,0)}function s(){var a;a=c.bottom.scrollHeight;return a}function A(){!n&&b&&j()}function B(){n=b;!b&&j()}function y(){DeveloperDashboard.Messaging.PostMsg("MS.DiagnosticsData","Refresh",null)}function j(){var a,c;if(b){a="Resume";c="Start"}else{a="Pause";c="Stop"}DeveloperDashboard.Messaging.PostMsg("MS.DiagnosticsData",c,null);DeveloperDashboard.Messaging.PostMsg("MS.DevDash",a,null);b=!b}function z(){m.clear();e=0;i=null;q(null);r()}function r(){ClearArea(a);if(0==e)a.appendChild(o);else a.appendChild(k)}function w(a,b){if(!(a in p))return;p[a](b)}function v(a){var d,b,g,f,c;c=0==e;d=DiagnosticsDataDepot.Get(a);b=document.createElement("SPAN");g=document.createTextNode(d.Name);f=h(g);b.appendChild(f);m.addRow(b,a,true);e++;c&&r();function h(c){var b;b=document.createElement("A");b.className="ms-dd-req-entry";b.appendChild(c);b.href="javascript:return false;";b.onClick=function(){l(a)};return b}}function t(){l(undefined)}function l(a){if(!Boolean(a))a=i;else i=a;q(a)}function q(b){var a;a=h.getActive();if(!Boolean(a)||!Boolean(a.display))return;"_init"in a&&a._init&&a.display(b)}function x(){var a,e,b;e=f.clientHeight;d.redraw(e);b=d.bottom.clientHeight;c.redraw(b);a=h.getActive();Boolean(a)&&Boolean(a.onResize)&&a.onResize()}})();(function(){var f,j,d,a,i,h,k,g,l,c,e,b;l={AddScenario:p};c=0;e={};b={};DeveloperDashboard.Modes.Add({name:"MS.Scenarios",displayName:Strings.DevDash.Scenarios_Tab,init:u,focus:null,blur:null,refresh:null,pause:null,clear:t,onResize:s,receiveMsg:r});function u(b){f=document.createElement("DIV");f.style.height="100%";g=ddVSplitView(f,true,.4*b);d=document.createElement("DIV");j=document.createElement("DIV");a=document.createElement("DIV");a.className="ms-dd-sc-info";g.top.appendChild(d);g.bottom.appendChild(a);k=ddListView(j,m);i=CreateDisplayText(Strings.DevDash.Scenarios_Placeholder);d.appendChild(i);h=CreateDisplayText(Strings.DevDash.Scenarios_DetailPlaceholder);a.appendChild(h);return f}function t(){k.clear();c=0;o();m(null);n()}function r(a,b){if(!(a in l))return;l[a](b)}function p(a){var d,g,b,f;f=0==c;if(!("Name"in a)||!("StartTimeUtc"in a)||!("EndTimeUtc"in a))return;d=document.createElement("SPAN");g=document.createTextNode(a.Name);d.appendChild(g);b=String(c);k.addRow(d,b);e[b]=a;c++;f&&n()}function m(d){var c;ClearArea(a);if(null==d){a.appendChild(h);return}if(!(d in b)){c=q(d);if(null==c)return;b[d]=c}else c=b[d];a.appendChild(c.el)}function q(f,d){var a,c,b;a=e[f];if(null==a)return null;c=ScopeUtils.GetTimeLength(a);b=ddGanttView(a.StartTimeUtc,c,-1,d);ScopeUtils.AddClientDataToGantt(b,a.Children);return b}function s(){var a;a=f.clientHeight;g.redraw(a)}function o(){var a;for(a in e)delete e[a];for(a in b)delete b[a]}function n(){ClearArea(d);if(0==c)d.appendChild(i);else d.appendChild(j)}})();(function(){var a;a={};if(true)return;DeveloperDashboard.Modes.Add({name:"MS.PLT",displayName:Strings.DevDash.PLT_Tab,receiveMsg:null})})();(function(){var a,b={AddAnimationData:d};DeveloperDashboard.Modes.Add({name:"MS.AnimationTelemetry",displayName:Strings.DevDash.Animation_Tab,init:f,focus:null,blur:null,refresh:null,pause:null,clear:e,onResize:null,receiveMsg:c});function f(){a=document.createElement("DIV");a.className="ms-dd-anim-container";return a}function e(){a.innerHTML=""}function c(a,c){if(!(a in b))return;b[a](c)}function d(b){a.innerHTML+=b}})();(function(){var a,b={AddMDSData:d};DeveloperDashboard.Modes.Add({name:"MS.MDSTelemetry",displayName:Strings.DevDash.MDS_Tab,init:f,focus:null,blur:null,refresh:null,pause:null,clear:e,onResize:null,receiveMsg:c});function f(){a=document.createElement("DIV");a.className="ms-dd-mds-container";return a}function e(){a.innerHTML=""}function c(a,c){if(!(a in b))return;b[a](c)}function d(b){a.innerHTML+=b}})();(function(){var e,a,r,h,l,m,t,j,s,p,g,f,o,q,k,i,n,b="-";DeveloperDashboard.Modes.Requests.AddDiagnostics({name:"MS.Requests.Server",displayName:Strings.DevDash.ServerInfo_Tab,init:w,display:v});function w(){e=document.createElement("DIV");e.className="ms-dd-reqinfo";a=document.createElement("TABLE");a.className="ms-dd-reqinfo";u(a,Strings.DevDash.ServerInfo_Summary);r=c(a,Strings.DevDash.ServerInfo_StartTime);h=c(a,Strings.DevDash.ServerInfo_Duration);l=c(a,Strings.DevDash.ServerInfo_CPUTime);m=c(a,Strings.DevDash.ServerInfo_Memory);t=c(a,Strings.DevDash.ServerInfo_Username);j=c(a,Strings.DevDash.ServerInfo_PCL);s=c(a,Strings.DevDash.ServerInfo_Server);p=c(a,Strings.DevDash.ServerInfo_ClientAdd);g=c(a,Strings.DevDash.ServerInfo_CorrID);u(a,Strings.DevDash.ServerInfo_Aggregate);f=c(a,Strings.DevDash.ServerInfo_SQLCount);o=c(a,Strings.DevDash.ServerInfo_SQLDur);q=c(a,Strings.DevDash.ServerInfo_ReqCount);k=c(a,Strings.DevDash.ServerInfo_AssertCount);i=c(a,Strings.DevDash.ServerInfo_ServCount);n=c(a,Strings.DevDash.ServerInfo_ServDur);e.appendChild(a);return e}function u(e,d){var b,a,c;b=document.createElement("TR");a=document.createElement("TD");c=document.createTextNode(d);a.colSpan=2;a.className="ms-dd-TableView-Title ms-dd-reqinfo-group";a.appendChild(c);b.appendChild(a);e.appendChild(b)}function c(h,g){var d,a,c,f,e;d=document.createElement("TR");a=document.createElement("TD");c=document.createElement("TD");f=document.createTextNode(g);e=document.createTextNode(b);a.className="ms-dd-reqinfo-caption";c.className="ms-dd-reqinfo-text";a.appendChild(f);c.appendChild(e);d.appendChild(a);d.appendChild(c);h.appendChild(d);return e}function v(c){var e,a,u;a=null;if(null!=c)a=DiagnosticsDataDepot.Get(c);if(null!=a){e=Number(a.ExecutionTime);r.data=undefined!=a.StartTimeUtc?new Date(a.StartTimeUtc).toUTCString():Strings.DevDash.Common_NA;h.data=String(e.toFixed(2))+Strings.DevDash.Common_ms;t.data=a.CurrentUser;j.data=a.FileLevel;s.data=a.Machine;p.data=a.ClientUserAddress;g.data=a.CorrelationId;l.data=Boolean(a.CPUDuration)?ScopeUtils.NormalizeCPUDuration(a.CPUDuration)+Strings.DevDash.Common_ms:Strings.DevDash.Common_NA;m.data=ScopeUtils.GetMemoryBytesString(a.Memory_ManagedBytes,a.Memory_ManagedBytesLOH);f.data=d(a,"SqlQuery","TotalCount");o.data=d(a,"SqlQuery","TotalDuration",Strings.DevDash.Common_ms);q.data=d(a,"SPRequest","TotalCount");k.data=d(a,"CriticalTrace","TotalCount");i.data=d(a,"ServiceCall","TotalCount");n.data=d(a,"ServiceCall","TotalDuration",Strings.DevDash.Common_ms)}else{r.data=b;h.data=b;t.data=b;j.data=b;s.data=b;p.data=b;g.data=b;l.data=b;m.data=b;f.data=b;o.data=b;q.data=b;k.data=b;i.data=b;n.data=b}}function d(f,d,e,c){var a,b;a=f[d];if(!Boolean(a))return Strings.DevDash.Common_NA;b=a[e];return undefined===b?Strings.DevDash.Common_NA:b+(undefined!==c?c:"")}})();(function(){var a,f,b;b={};DeveloperDashboard.Modes.Requests.AddDiagnostics({name:"MS.Requests.Scopes",displayName:Strings.DevDash.Scopes_Tab,init:e,display:d});function e(){a=document.createElement("DIV");return a}function d(d){var e;a.childNodes.length>0&&a.removeChild(a.childNodes[0]);if(null==d)return;if(!(d in b)){e=c(d,[Strings.DevDash.Scopes_Machine],[Strings.DevDash.Scopes_CPU]);b[d]=e}else e=b[d];a.appendChild(e.el)}function c(f,e,c){var b,a,d;a=DiagnosticsDataDepot.Get(f);if(null==a)return null;ScopeUtils.RequestHasMemoryData(a)&&c.push(Strings.DevDash.Scopes_Memory);d=ScopeUtils.GetTimeLength(a);b=ddGanttView(a.StartTimeUtc,d,-1,e,c);ScopeUtils.AddServerDataToGantt(b,a.Children,a);return b}})();(function(){var a,g,e,f,d,c;DeveloperDashboard.Modes.Requests.AddDiagnostics({name:"MS.Requests.SQL",displayName:Strings.DevDash.SQL_Tab,init:n,display:m});function n(){a=document.createElement("DIV");g=document.createElement("DIV");d=ddTableView(g,l,[Strings.DevDash.SQL_Query,Strings.DevDash.SQL_Duration,Strings.DevDash.SQL_Reads,Strings.DevDash.SQL_Writes,Strings.DevDash.SQL_CPU,Strings.DevDash.SQL_SQLDuration,Strings.DevDash.SQL_ExecPlan]);return a}function m(q){var m,o,f,s,e,r,n,p,l;c=null;a.childNodes.length>0&&a.removeChild(a.childNodes[0]);if(null==q)return;m=DiagnosticsDataDepot.Get(q);if(null==m)return;o=m.SqlQuery;if(!Boolean(o)){k();return}c=o.Children;if(!Boolean(c)){j();return}else{d.clear();a.appendChild(g)}s=c.length;for(f=0;f<s;f++){e=c[f];r=new Number(e.Properties.Duration);n=document.createElement("SPAN");if(e.Name=="RawSqlText"&&null!=e.Properties.Text&&undefined!=e.Properties.Text)l=h(e.Properties.Text);else l=e.Name;n.appendChild(MakeLink(l));p=i(e);d.addRow(String(f),[n,b(r,3),b(e.Properties.NumLogicalReads),b(e.Properties.NumPhysicalWrites),b(e.Properties.SqlCPU),b(e.Properties.SqlDuration),p])}}function l(b){var a;d.clearSelection();a=c[b];SetSqlWindowText(Strings.DevDash.MoreInfo_Text,a.Properties.Text,Strings.DevDash.MoreInfo_Callstack,a.Properties.CallStack,Strings.DevDash.MoreInfo_IOStats,a.Properties.IOStatistics)}function k(){if(null==f)f=CreateDisplayText(Strings.DevDash.SQL_NoInfo);a.appendChild(f)}function j(){if(null==e)e=CreateDisplayText(Strings.DevDash.SQL_NoQueries);a.appendChild(e)}function i(c){var a,d;if(c.Properties.ExecutionPlan==undefined)a=b();else{a=document.createElement("A");a.setAttribute("href",c.Properties.ExecutionPlan+"?filename=query.sqlplan");a.appendChild(document.createTextNode("plan"))}return a}function h(b){var a;a=b.indexOf("'",0);return a>0?b.substr(a+1,16):b.substr(0,16)}function b(d,b,c){var a;a=document.createElement("SPAN");if(d!=undefined){if(b==undefined)b=0;if(c==undefined)c="";a.appendChild(document.createTextNode(d.toFixed(b)+c))}else a.appendChild(document.createTextNode(Strings.DevDash.Common_NA));return a}})();(function(){var a,e,d,c,b;DeveloperDashboard.Modes.Requests.AddDiagnostics({name:"MS.Requests.SPRequests",displayName:Strings.DevDash.SPRequests_Tab,init:i,display:h});function i(){a=document.createElement("DIV");e=document.createElement("DIV");c=ddListView(e,g);return a}function h(i){var g,h,d,k,j;b=null;a.childNodes.length>0&&a.removeChild(a.childNodes[0]);if(null==i)return;g=DiagnosticsDataDepot.Get(i);if(null==g)return;h=g.SPRequest;if(!Boolean(h))return;b=h.Children;if(!Boolean(b)){f();return}else{c.clear();a.appendChild(e)}k=b.length;for(d=0;d<k;d++){j=b[d];c.addRow(MakeLink(j.Name),String(d))}}function g(d){var a;c.clearSelection();a=b[d];SetSqlWindowText(Strings.DevDash.MoreInfo_Callstack,a.Properties.CallStack,null,null,null,null)}function f(){if(null==d)d=CreateDisplayText(Strings.DevDash.Requests_NoRequests);a.appendChild(d)}})();(function(){var a,c,b,d;DeveloperDashboard.Modes.Requests.AddDiagnostics({name:"MS.Requests.Asserts",displayName:Strings.DevDash.Asserts_Tab,init:g,display:f});function g(){a=document.createElement("DIV");b=document.createElement("DIV");a.appendChild(b);d=ddListView(b,null);return a}function f(i){var c,g,j,h,k,f;a.childNodes.length>0&&a.removeChild(a.childNodes[0]);if(null==i)return;c=DiagnosticsDataDepot.Get(i);if(null==c)return;g=c.CriticalTrace;if(!Boolean(g))return;j=g.TotalCount;if(0==j)e();else{d.clear();a.appendChild(b);h=c.CriticalTrace.TraceMessages.split("\n");k=h.length;for(f=0;f<k;f++)d.addRow(document.createTextNode(h[f]),null)}}function e(){if(null==c)c=CreateDisplayText(Strings.DevDash.Asserts_NoAsserts);a.appendChild(c)}})();(function(){var a,e,c,d,b;DeveloperDashboard.Modes.Requests.AddDiagnostics({name:"MS.Requests.ServiceCalls",displayName:Strings.DevDash.ServiceCalls_Tab,init:i,display:h});function i(){a=document.createElement("DIV");c=document.createElement("DIV");a.appendChild(c);d=ddListView(c,g);return a}function h(l){var k,h,e,m,g,i,j;b=null;a.childNodes.length>0&&a.removeChild(a.childNodes[0]);if(null==l)return;h=DiagnosticsDataDepot.Get(l);if(null==h)return;k=h.ServiceCall;if(!Boolean(k))return;b=k.Children;if(!Boolean(b)){f();return}else{d.clear();a.appendChild(c)}m=b.length;for(e=0;e<m;e++){g=b[e];i=new Number(g.Properties.Duration);if(isNaN(i))j=MakeLink(g.Name);else j=MakeLinkWithInfoText(g.Name,String(i.toFixed(3))+Strings.DevDash.Common_ms);d.addRow(j,String(e))}}function g(c){var a;d.clearSelection();a=b[c];SetSqlWindowText(Strings.DevDash.MoreInfo_Callstack,a.Properties.CallStack,Strings.DevDash.MoreInfo_Duration,a.Properties.Duration,null,null)}function f(){if(null==e)e=CreateDisplayText(Strings.DevDash.ServiceCalls_NoServCalls);a.appendChild(e)}})();(function(){var b,d,c,e;e={};DeveloperDashboard.Modes.Requests.AddDiagnostics({name:"MS.Requests.ULS",displayName:Strings.DevDash.ULS_Tab,init:k,display:f});function k(){d=CreateDisplayText(Strings.DevDash.ULS_Fetching);c=null;b=document.createElement("DIV");b.appendChild(d);return b}function f(a){var h,c,f;ClearArea(b);if(null==a)return;h=e[a];if(Boolean(h)){b.appendChild(h);return}f=DiagnosticsDataDepot.Get(a);if(null==f)return;c=f.CorrelationId;if(null==c)return;b.appendChild(d);DiagnosticsDataProvider.GetULSLog(c,g,a)}function g(c,a){var b;if(null==c){i();return}b=h(c);e[a]=b;f(a)}function h(d){var b,a,e,f,c;b=document.createElement("DIV");c=ddTableView(b,null,[Strings.DevDash.ULS_Time,Strings.DevDash.ULS_Event,Strings.DevDash.ULS_Process,Strings.DevDash.ULS_Thread,Strings.DevDash.ULS_Level,Strings.DevDash.ULS_Category,Strings.DevDash.ULS_Area,Strings.DevDash.ULS_Message]);e=d.length;for(a=0;a<e;a++)j(c,d[a]);return b}function j(c,b){c.addRow(null,[a(ddGetTimeWithMsFromServerString(b.Timestamp)),a(b.EventID),a(b.Process),a(String(b.ThreadID)),a(b.Level),a(b.Category),a(b.Area),a(b.Message)])}function a(b){var a;a=document.createTextNode(b);return a}function i(){if(null==c)c=CreateDisplayText(Strings.DevDash.ULS_Error);ClearArea(b);b.appendChild(c)}})();(function(){var b,t,s,d,c,r,k,l,e,p,i,n,g,m,f,o,h,q,j;DeveloperDashboard.Modes.Requests.AddDiagnostics({name:"MS.Requests.Cache",displayName:Strings.DevDash.Cache_Tab,init:x,display:w});function x(){b=document.createElement("DIV");t=document.createElement("DIV");k=new Number;e=new Number;i=new Number;g=new Number;f=new Number;h=new Number;j=new Number;d=ddTableView(t,v,[Strings.DevDash.Cache_Method,Strings.DevDash.Cache_Duration,Strings.DevDash.Cache_Objects_Requested,Strings.DevDash.Cache_Key,Strings.DevDash.Cache_ReadSize,Strings.DevDash.Cache_WriteSize,Strings.DevDash.Cache_Miss,Strings.DevDash.Cache_Hit,Strings.DevDash.Cache_Failures,Strings.DevDash.Cache_Usage]);return b}function w(y){var v,w,s,x;c=null;b.childNodes.length>0&&b.removeChild(b.childNodes[0]);if(null==y)return;v=DiagnosticsDataDepot.Get(y);if(null==v)return;w=v.SPDistributedCache;if(!Boolean(w))return;c=w.Children;if(!Boolean(c)){u();return}else{d.clear();b.appendChild(t)}x=c.length;for(s=0;s<x;s++)A(c[s]);x>0&&z();function A(b){r=new Number(b.Properties.CacheOperationDuration);k+=r;var c;if(b.Properties.CachedKey==null||b.Properties.CachedKey==undefined||b.Properties.CachedKey=="")c=Strings.DevDash.Common_NA;else c=b.Properties.CachedKey;l=new Number(b.Properties.CachedObjectsRequested);e+=l;p=new Number(b.Properties.CachedObjectReadSize);i+=p;n=new Number(b.Properties.CachedObjectWriteSize);g+=n;m=new Number(b.Properties.CachedObjectMissCount);f+=m;o=new Number(b.Properties.CachedObjectHitCount);h+=o;q=new Number(b.Properties.CachedObjectFailure);j+=q;d.addRow(String(s),[MakeLink(b.Properties.CacheMethod),a(r,3),a(l),document.createTextNode(c),a(p),a(n),a(m),a(o),a(q),document.createTextNode(b.Properties.CacheUsageName)])}function z(){d.addRow("",[document.createTextNode(Strings.DevDash.Cache_Totals),a(k,3),a(e),document.createTextNode(Strings.DevDash.Common_NA),a(i),a(g),a(f),a(h),a(j),document.createTextNode(Strings.DevDash.Common_NA)]);k=0;e=0;i=0;g=0;f=0;h=0;j=0}}function v(b){var a;d.clearSelection();a=c[b];SetSqlWindowText(Strings.DevDash.MoreInfo_Callstack,a.Properties.CallStack,null,null,null,null)}function u(){if(null==s)s=CreateDisplayText(Strings.DevDash.Cache_NoCache);b.appendChild(s)}function a(d,b,c){var a;a=document.createElement("SPAN");if(d!=undefined){if(b==undefined)b=0;if(c==undefined)c="";a.appendChild(document.createTextNode(d.toFixed(b)+c))}else a.appendChild(document.createTextNode(Strings.DevDash.Common_NA));return a}})()}function SetSqlWindowText(i,k,h,f,j,g){var b;if(typeof document.sqlWindow!="undefined")b=document.sqlWindow;if(!Boolean(b)||b.closed){b=window.open("","","width=800,height=770,status=yes,location=no,scrollbar=yes,resize=yes");document.sqlWindow=b}var a=b.document,e,c,d;if(Boolean(e)){a.open();a.write("");a.close()}a.open();a.write('<html><head><link rel="stylesheet" type="text/css" href="');a.write("/_layouts/15/1033/styles/layouts.css");a.write('"/></head><body><div class="ms-developerdashboard"><table width="100%"><tr><td style="font-weight:bold">');a.write(i);a.write('</td></tr><tr><td><textarea id="sqlText" rows="18" cols="94"></textarea></td></tr>');if(Boolean(f)){a.write('<tr><td style="font-weight:bold">');a.write(h);a.write('</td></tr><tr><td><textarea id="sqlStack" rows="14" cols="94"></textarea></td></tr>')}if(Boolean(g)){a.write('<tr><td style="font-weight:bold">');a.write(j);a.write('</td></tr><tr><td><textarea id="sqlIO" rows="8" cols="94"></textarea></td></tr>')}a.write("</table></div></body></html>");a.close();e=a.getElementById("sqlText");c=a.getElementById("sqlStack");d=a.getElementById("sqlIO");e.value=k;if(typeof c!="undefined"&&Boolean(c))c.value=f;if(typeof d!="undefined"&&Boolean(d))d.value=g;b.focus()}function ddGetUTCTimeString(a){var b;if(null==a)a=new Date;return String(a.getUTCFullYear())+"-"+String(a.getUTCMonth()+1)+"-"+String(a.getUTCDate())+" "+String(a.getUTCHours())+":"+String(a.getUTCMinutes())+":"+String(a.getUTCSeconds())+"."+String(a.getUTCMilliseconds())}function ddGetDateFromJsonString(str){var date;str=str.substr(1,str.length-2);date=eval("new "+str);return date}function ddGetTimeWithMsFromServerString(d,c){var a,b;a=ddGetDateFromJsonString(d);b=ddGetTimeWithMsFromDate(a,c);return b}function ddGetTimeWithMsFromDate(a,d){var c,b;b=Boolean(d)?ddGetPaddedString2(a.getMonth()+1)+"/"+ddGetPaddedString2(a.getDate())+"/"+String(a.getFullYear())+" ":"";c=b+ddGetPaddedString2(a.getHours())+":"+ddGetPaddedString2(a.getMinutes())+":"+ddGetPaddedString2(a.getSeconds())+"."+ddGetPaddedString3(a.getMilliseconds());return c}function ddGetPaddedString2(a){return ddGetPaddedStringN(a,"0")}function ddGetPaddedString3(a){return ddGetPaddedStringN(a,"00")}function ddGetPaddedStringN(e,d){var b,a,c;a=String(e);b=a.length;a=d+a;c=a.slice(b-1);return c}function GetAbsoluteX(a){var b=0;while(a!=null){b+=a.offsetLeft;a=a.offsetParent}return b}function GetAbsoluteY(a){var b=0;while(a!=null){b+=a.offsetTop;a=a.offsetParent}return b}function GetCurrentStyle(b,c){var d,a;if("undefined"!==typeof b.currentStyle)a=b.currentStyle[c];else if("undefined"!==typeof window.getComputedStyle){d=document.defaultView.getComputedStyle(b,null);a=d.getPropertyValue(c)}return a}function FALSE(){return false}function MakeLink(b){var a;a=document.createElement("A");a.href="javascript:;";a.onclick=FALSE;a.appendChild(document.createTextNode(b));return a}function MakeLinkWithInfoText(d,e){var a,b,c;a=document.createElement("SPAN");b=MakeLink(d);c=document.createTextNode(" ("+e+")");a.appendChild(b);a.appendChild(c);return a}function GetClientHeight(b,d){var a,c;a=document.createElement("DIV");a.style.visible="false";a.appendChild(b);d.appendChild(a);c=b.clientHeight;a.removeChild(b);d.removeChild(a);return c}var CSSUtil,EV_MOUSE_DOWN,EV_MOUSE_MOVE,EV_MOUSE_UP;function RegisterEvent(a,b,c){if("undefined"===typeof a.addEventListener)a.attachEvent("on"+b,c);else a.addEventListener(b,c,false)}function UnregisterEvent(a,b,c){if("undefined"===typeof a.removeEventListener)a.detachEvent("on"+b,c);else a.removeEventListener(b,c,false)}function GetMouseCoords(a){return a.pageX?{x:a.pageX,y:a.pageY}:{x:a.clientX+document.body.scrollLeft-document.body.clientLeft,y:a.clientY+document.body.scrollTop-document.body.clientTop}}function RegisterDrag(e,c,a){RegisterEvent(e,EV_MOUSE_DOWN,d);function d(){var d;d=document.body;RegisterEvent(d,EV_MOUSE_MOVE,c);RegisterEvent(d,EV_MOUSE_UP,b);d.style.cursor="n-resize";null!=a&&a()}function b(){var a;a=document.body;a.style.cursor="default";UnregisterEvent(a,EV_MOUSE_UP,b);UnregisterEvent(a,EV_MOUSE_MOVE,c)}}function CreateDisplayText(c){var a,b;a=document.createElement("DIV");b=document.createElement("I");b.appendChild(document.createTextNode(c));a.appendChild(b);a.className="ms-dd-req-loading";return a}function ClearArea(a){a.childNodes.length>0&&a.removeChild(a.childNodes[0])}function ddListView(h,e){var a,b,c;c=true;b=null;a=document.createElement("DIV");a.className="ms-dd-ListView";h.appendChild(a);return{addRow:g,clear:f,clearSelection:d};function g(j,k,i){var f,g;if(c)g="ms-dd-ListView-Row ms-dd-ListView-Row-Odd";else g="ms-dd-ListView-Row";f=document.createElement("DIV");f.className=g;f.onclick=h;f.appendChild(j);a.appendChild(f);i&&f.scrollIntoView();c=!c;function h(){d.call();CSSUtil.AddClass(f,"ms-dd-ListView-Row-Sel");b=f;Boolean(e)&&e(k);return false}}function f(){var d,e,b;e=a.childNodes.length;for(d=0;d<e;d++){b=a.firstChild;a.removeChild(b);delete b.onclick;delete b}c=true}function d(){null!=b&&CSSUtil.RemoveClass(b,"ms-dd-ListView-Row-Sel");b=null}}function ddTabCtrl(k,h,g){var e,f,c,a,d,b;e={};f={};c=null;b=null;k.innerHTML="";l();return{addTab:n,addButton:m};function l(){var c,e;c=document.createElement("TABLE");c.className="ms-dd-TabCtrl";a=document.createElement("TR");e=document.createElement("TD");e.className="ms-dd-TabLc";a.appendChild(e);d=document.createElement("TD");d.className="ms-dd-TabRc";a.appendChild(d);b=i("[]",null);b.style.visible="false";a.insertBefore(b,d);c.appendChild(a);k.appendChild(c)}function i(c,d){var b,a,e;b=document.createElement("TD");b.className="ms-dd-Tab";b.unselectable=true;a=document.createElement("A");a.className="ms-dd-Tab";a.title=c;a.href="javascript:;";if(null!=d)a.onclick=d;e=document.createTextNode(c);a.appendChild(e);b.appendChild(a);return b}function n(f){var g;if(null!=b){a.removeChild(b);b=null}if(f.name in e)return false;g=i(f.displayName,h);a.insertBefore(g,d);e[f.name]=g;null==c&&j(f);return true;function h(){j(f);return false}}function j(b){var a;a=e[b.name];if(undefined==a)return false;if(c==a)return false;null!=c&&CSSUtil.RemoveClass(c,"ms-dd-TabActive");CSSUtil.AddClass(a,"ms-dd-TabActive");c=a;Boolean(h)&&h(b.name);return true}function m(c){var b;if(c.name in f)return false;b=document.createElement("TD");b.className="ms-dd-Button";b.unselectable=true;b.onclick=d;b.appendChild(c.el);a.appendChild(b);f[c.name]=b;return true;function d(){Boolean(g)&&g(c.name)}}}function ddTabCtrlEvents(r,l,k,h){var d,e,c,b,j,a;j=ddTabCtrlEvents.createLoading();d=ddTabCtrl(r,o,m);e={};c={};b={};Boolean(l)&&l(d);return{addTab:q,addButton:p,getActive:n};function q(a){var c;if(a.name in e)return false;e[a.name]=a;c=d.addTab({name:a.name,displayName:a.displayName});window.setTimeout(function(){if(a.name in b)return;i(a)},0);return c}function p(a){if(a.name in c)return;c[a.name]=a;d.addButton(a)}function n(){return a}function o(k){var l,c,d;f(ddTabCtrlEvents.ACTION_BLUR);c=e[k];d=b[k];l="_syncInit"in c;if(undefined==d){g(j);if(l)h();else window.setTimeout(h,0)}else g(d);a=c;function h(){var a;a=i(c);null!=a&&g(a)}f(ddTabCtrlEvents.ACTION_FOCUS)}function i(c){var d,a;if(!Boolean(c.init))return null;if(Boolean(h))d=h();else d=0;a=c.init(d);if(!Boolean(a))return null;c._init=true;b[c.name]=a;return a}function m(a){if(!(a in c))return;f(a)}function f(b){if(!Boolean(a)||!Boolean(a[b]))return;a[b]()}function g(a){Boolean(k)&&k(a)}}function ddVSplitView(e,p,c){var a,f,d,b,g,h=false;i();e.innerHTML="";if(-1==c)c=b>>1;a=document.createElement("DIV");a.className="ms-dd-VSplitView-Top";a.style.height=String(c)+"px";e.appendChild(a);if(p){d=document.createElement("DIV");d.className="ms-dd-VSplitView-Grip";RegisterDrag(d,o,i);e.appendChild(d)}else d=null;f=document.createElement("DIV");j(b,c);e.appendChild(f);return{top:a,bottom:f,setResizeCallback:n,redraw:q};function j(e,c){var a,b;a=GetBottomSize(e,c,d);b=String(a)+"px";f.style.height=b;return a}function o(c){var e,f,d;c=Boolean(c)?c:window.event;e=GetMouseCoords(c);f=GetAbsoluteY(a);d=e.y-f;d>0&&d<b&&k(b,d);return false}function k(d,b){var c;h=true;a.style.height=String(b)+"px";c=j(d,b);Boolean(g)&&g({topHeight:b,bottomHeight:c});h=false}function l(){var a;a=e.scrollHeight;return a}function i(){b=l()}function m(d){var a;if(h)return;a=c;k(d,a);b=d;c=a}function q(a){m(a)}function n(a){g=a}}function GetBottomSize(c,d,e){var a,b;if(null!=e)a=e.offsetHeight;else a=0;if(0==c)b=d-a;else b=c-d-a;return b}function ddClusteredImage(b){var c,a,d,e;d=document.createElement("SPAN");d.className="ms-dd-clust";g(d,b);if(b.useLink){a=document.createElement("A");a.className="ms-dd-clust";a.href="javascript:;";a.onclick=FALSE;a.title=b.linkTitle;g(a,b)}c=document.createElement("IMG");c.src=b.imageUrl;c.className="ms-dd-clust";f(b.left,b.top);if(b.useLink){a.appendChild(c);e=a}else e=c;d.appendChild(e);return{el:d,setOffset:f,setTitle:h};function g(b,a){b.style.width=String(a.width)+"px";b.style.height=String(a.height)+"px"}function f(a,b){c.style.left="-"+String(a)+"px";c.style.top="-"+String(b)+"px"}function h(b){a.title=b}}function ddGanttView(g,d,c,f,e){var b,a;a=document.createElement("DIV");a.className="ms-dd-GanttView";h(f,e);b=0;if(!Boolean(c))c=3;return{el:a,addRow:i,endRow:j};function i(v,t,w,m,l,u){var r,p,h,x,q,j,k,f,n,o,e,s,i;r=w-t;p=t-g;h=document.createElement("DIV");h.className="ms-dd-GanttView-Row";if(undefined!=m&&null!=m){s=m.length;for(i=0;i<s;i++){e=document.createElement("DIV");e.className="ms-dd-GanttView-Text";if(u)e.className+=" ms-dd-GanttView-Text-Green";else e.className+=" ms-dd-GanttView-Text-Blue";e.appendChild(document.createTextNode(m[i]));h.appendChild(e)}}q=document.createElement("DIV");q.className="ms-dd-GanttView-Cont";h.appendChild(q);j=document.createElement("DIV");j.className="ms-dd-GanttView-CellWrap";q.appendChild(j);k=document.createElement("SPAN");k.className="ms-dd-GanttView-Name";k.style.paddingLeft=String(10*b)+"px";k.appendChild(document.createTextNode(v));j.appendChild(k);f=document.createElement("DIV");f.className="ms-dd-GanttView-Bar";if(-1!=c){f.style.width=String(r/c+1)+"px";f.style.left=String(p/c)+"px"}else{f.style.width=String(100*r/d)+"%";f.style.left=String(100*p/d)+"%"}f.appendChild(document.createTextNode("\u00a0"));j.appendChild(f);n=document.createElement("DIV");n.className="ms-dd-GanttView-Text";n.appendChild(document.createTextNode(String(p)));h.appendChild(n);o=document.createElement("DIV");o.className="ms-dd-GanttView-Text";o.appendChild(document.createTextNode(String(r)));h.appendChild(o);if(undefined!=l&&null!=l){s=l.length;for(i=0;i<s;i++){e=document.createElement("DIV");e.className="ms-dd-GanttView-Text";e.appendChild(document.createTextNode(l[i]));h.appendChild(e)}}a.appendChild(h);b++}function j(){if(0==b)return;b--}function h(g,f){var d,b,e;d=document.createElement("DIV");d.className="ms-dd-GanttView-Row";if(Boolean(g)){e=g.length;for(b=0;b<e;b++)c(g[b],"ms-dd-GanttView-Text")}c(Strings.DevDash.Scopes_Name,"ms-dd-GanttView-Cont");c(Strings.DevDash.Scopes_StartTime,"ms-dd-GanttView-Text");c(Strings.DevDash.Scopes_Duration,"ms-dd-GanttView-Text");if(Boolean(f)){e=f.length;for(b=0;b<e;b++)c(f[b],"ms-dd-GanttView-Text")}a.appendChild(d);function c(c,b){var a;a=document.createElement("DIV");a.className=b+" ms-dd-TableView-Title";a.appendChild(document.createTextNode(c));d.appendChild(a)}}}function ddTableView(n,f,l){var c,g,a,b,d;d=true;b=null;c=document.createElement("TABLE");c.className="ms-dd-Table";g=h(l);c.appendChild(g);a=document.createElement("TBODY");a.className="ms-dd-TableView";n.appendChild(c);c.appendChild(a);return{addRow:m,clear:k,clearSelection:e};function m(k,i){var c,g;if(d)g="ms-dd-TableView-Row ms-dd-TableView-Row-Odd";else g="ms-dd-TableView-Row";c=document.createElement("TR");c.className=g;j(i,c);if(Boolean(c.firstChild))c.firstChild.onclick=h;a.appendChild(c);d=!d;function h(){e();CSSUtil.AddClass(c,"ms-dd-TableView-Row-Sel");b=c;Boolean(f)&&f(k);return false}}function j(c,f){var d,a,b,e;e=c.length;for(b=0;b<e;b++){d=c[b];a=document.createElement("TD");a.className="ms-dd-TableView-Cell";a.appendChild(d);f.appendChild(a)}}function k(){var c,e,b;e=a.childNodes.length;for(c=0;c<e;c++){b=a.firstChild;a.removeChild(b);delete b.onclick;delete b}d=true}function e(){null!=b&&CSSUtil.RemoveClass(b,"ms-dd-TableView-Row-Sel");b=null}function h(d){var b,c,f,e,a;b=document.createElement("THEAD");c=document.createElement("TR");e=d.length;for(a=0;a<e;a++){f=i(d[a]);c.appendChild(f)}b.appendChild(c);return b}function i(b){var a;a=document.createElement("TH");a.className="ms-dd-TableView-Title";a.appendChild(document.createTextNode(b));return a}}var DeveloperDashboard;function DevDashOOB(){var f,c,e,b,a,h,d;a={};f=document.getElementById("ddWnd");d=document.createElement("DIV");e=ddTabCtrlEvents(d,null,k,j);l(e);h=GetClientHeight(d,f);c=ddVSplitView(f,false,h);c.top.appendChild(d);DeveloperDashboard={Modes:{Add:n},Messaging:{Subscribe:g,PostMsg:m}};g("MS.DevDash",{receiveMsg:null,Pause:p,Resume:o});window.onresize=i;window.setTimeout(i,0);function n(b){if(b.name in a)return false;if(!(DevDashOOB.RECEIVEMSG in b))return false;g(b.name,b);e.addTab(b);return true}function g(b,c){if(b in a)return false;a[b]=c;return true}function m(e,c,d){var b;if(!(e in a))return false;b=a[e];if(c in b)window.setTimeout(function(){b[c](d)},0);else window.setTimeout(function(){b[DevDashOOB.RECEIVEMSG](c,d)},0);return true}function p(){b.setOffset(0,0);b.setTitle(Strings.DevDash.OOB_Resume)}function o(){b.setOffset(0,16);b.setTitle(Strings.DevDash.OOB_Pause)}function l(a){var c,d;c=ddClusteredImage({imageUrl:"/_layouts/15/images/DevDash15.png",top:16,left:16,height:16,width:16,useLink:true,linkTitle:Strings.DevDash.OOB_Refresh});b=ddClusteredImage({imageUrl:"/_layouts/15/images/DevDash15.png",top:16,left:0,height:16,width:16,useLink:true,linkTitle:Strings.DevDash.OOB_Pause});d=ddClusteredImage({imageUrl:"/_layouts/15/images/DevDash15.png",top:0,left:16,height:16,width:16,useLink:true,linkTitle:Strings.DevDash.OOB_Clear});a.addButton({name:ddTabCtrlEvents.ACTION_REFRESH,el:c.el});a.addButton({name:ddTabCtrlEvents.ACTION_PAUSE,el:b.el});a.addButton({name:ddTabCtrlEvents.ACTION_CLEAR,el:d.el})}function k(b){var a;a=c.bottom;a.childNodes.length>0&&a.removeChild(a.childNodes[0]);a.appendChild(b)}function j(){var a;a=c.bottom.scrollHeight;return a}function i(){var b,a;b=f.clientHeight;c.redraw(b);a=e.getActive();Boolean(a)&&Boolean(a.onResize)&&a.onResize()}}var ScopeUtils,DiagnosticsDataDepot,DiagnosticsDataProvider;$_global_devdash();