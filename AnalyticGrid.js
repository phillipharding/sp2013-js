function ULSCnY(){var a={};a.ULSTeamName="PerformancePoint Monitoring Service";a.ULSFileName="AnalyticGrid.js";return a}Type.registerNamespace("PPSMA");PPSMA.ReportLayoutEnum=function(){};PPSMA.ReportLayoutEnum.prototype={TabularForm:0,CompactForm:1};PPSMA.ReportLayoutEnum.registerEnum("PPSMA.ReportLayoutEnum",false);PPSMA.OlapGrid=function(d,c,b){a:;this.$$d_processFilterDialogResult=Function.createDelegate(this,this.processFilterDialogResult);this.$$d_handleOlapGridCallback=Function.createDelegate(this,this.handleOlapGridCallback);this.$$d_doShowContextMenu=Function.createDelegate(this,this.doShowContextMenu);this.$$d_$i_0=Function.createDelegate(this,this.$i_0);this.$2_0=d;this.$1_0=null;this.$0_0=c;this.$4_0=[];this.$F_0=false;this.$A_0=false;this.$G_0=null;this.$8_0=1;this._showProperties=new PPSMA.ShowProperties(this.$2_0,this.$0_0);this._changeMeasure=new PPSMA.ChangeMeasure(this.$0_0);this._valueFilter=new PPSMA.FilterDialog(this.$0_0,this.$2_0);this.$E_0=b;if(this.$0_0){var a=$get(this.$0_0.get_outerTargetId());$clearHandlers(a);this.$U_0(null,this.$0_0);a.attachEvent("onpropertychange",this.$$d_$i_0)}var e=this;$addHandler(document.body,"touchstart",function(){})};PPSMA.OlapGrid.$R=function(f,e){var d=0,b=0,a=f.firstChild;while(a&&b<e){var c=a.getAttribute("colspan");if(!c)c="1";b+=parseInt(c);if(b<=e)d++;a=a.nextSibling}return d};PPSMA.OlapGrid.$g=function(a){if(a&&a.tagName){if(PPSMA.DomElementEx.tagsMatch(a.tagName,"table"))return a;if(PPSMA.DomElementEx.tagsMatch(a.tagName,"td"))return a;if(PPSMA.DomElementEx.tagsMatch(a.tagName,"a")&&PPSMA.DomElementEx.tagsMatch(a.parentNode.tagName,"td"))return a.parentNode;if(PPSMA.DomElementEx.tagsMatch(a.tagName,"img")&&PPSMA.DomElementEx.tagsMatch(a.parentNode.tagName,"a")&&PPSMA.DomElementEx.tagsMatch(a.parentNode.parentNode.tagName,"td"))return a.parentNode.parentNode;else return null}return null};PPSMA.OlapGrid.$s=function(){a:;var b=window.document.styleSheets,a=true,c=b[0].cssRules;if(isNullOrUndefined(c))a=false;return a};PPSMA.OlapGrid.$Q=function(e){for(var b=window.document.styleSheets,d=b.length,a=0;a<d;a++){var c=b[a].href;if(!isNullUndefinedOrEmpty(c)&&c.toUpperCase().indexOf(e.toUpperCase())>=0)return b[a]}return null};PPSMA.OlapGrid.$7=function(a,f,g){var d=PPSMA.OlapGrid.$s(),b;if(d)b=a.cssRules;else b=a.rules;for(var c=0;c<b.length;c++)if(b[c].selectorText.toLowerCase()===f.toLowerCase()){if(d){a.deleteRule(c);b=a.cssRules}else a.removeRule(c);break}if(d){var e=f+" {";e+=g;e+="}";a.insertRule(e,b.length)}else a.addRule(f,g)};PPSMA.OlapGrid.prototype={$2_0:null,$1_0:null,$0_0:null,$4_0:null,$F_0:false,$A_0:false,$G_0:null,$8_0:0,_showProperties:null,_changeMeasure:null,_valueFilter:null,$E_0:false,$C_0:0,$J_0:null,$i_0:function(){a:;var $v_0="window.event.propertyName",$v_1=eval($v_0);switch($v_1){case "executeValueFilterRow":this.handleValueFilterMenuClick();break;case "executeTopFilterRow":this.handleTopFilterMenuClick();break;case "clearFilterRow":this.handleClearFilterMenuClick();break;case "filterEmptyRows":this.$O_0();break;case "filterEmptyCols":this.$N_0();break;case "sortAscRow":this.handleSortMenuClick("asc");break;case "sortDescRow":this.handleSortMenuClick("desc");break;case "noSortRow":this.handleSortMenuClick("nosort");break;case "MeasureGroupName":this.handleMeasureGroupNameChange()}},get_isDefaultGridStyle:function(){a:;return this.$E_0},get_reportLayout:function(){a:;return this.$8_0},set_reportLayout:function(a){a:;this.$8_0=a;return a},get_cubeMetadata:function(){a:;return null},set_cubeMetadata:function(a){a:;return a},get_$3_0:function(){a:;return this.$0_0.get_results().get_canNavigate()},get_$9_0:function(){a:;return this.$0_0.get_results().get_isDesigner()},$6_0:function(a){var b=null;if(a){var c=PPSMA.ReportsCommon.getCellRowPosition(a),d=PPSMA.ReportsCommon.getCellColumnPosition(a);if(c!==-1&&d!==-1){var e=PPSMA.ReportsCommon.getCellTypeId(a);switch(e){case "R":var f=this.$0_0.get_results().get_rowMembers();b=f[c][d];break;case "C":var g=this.$0_0.get_results().get_columnMembers();b=g[d][c]}}}return b},$h_0:function(c){var b=null;if(c){var d=PPSMA.ReportsCommon.getCellRowPosition(c),e=PPSMA.ReportsCommon.getCellColumnPosition(c);if(d!==-1&&e!==-1){var a,f=PPSMA.ReportsCommon.getCellTypeId(c);switch(f){case "R":a=this.$B_0(this.$0_0.get_results().get_rowHierarchies(),this.$0_0.get_formatDimHierarchyName());if(a>=0){var g=this.$0_0.get_results().get_rowMembers();b=g[d][a]}break;case "C":a=this.$B_0(this.$0_0.get_results().get_columnHierarchies(),this.$0_0.get_formatDimHierarchyName());if(a>=0){var h=this.$0_0.get_results().get_columnMembers();b=h[e][a]}break;case "D":a=this.$B_0(this.$0_0.get_results().get_columnHierarchies(),this.$0_0.get_formatDimHierarchyName());if(a>=0){var i=this.$0_0.get_results().get_columnMembers();b=i[e][a]}else{a=this.$B_0(this.$0_0.get_results().get_rowHierarchies(),this.$0_0.get_formatDimHierarchyName());if(a>=0){var j=this.$0_0.get_results().get_rowMembers();b=j[d][a]}}}}}return b},$B_0:function(c,e){for(var b=-1,a=0;a<c.length;a++){var d=c[a];if(d.get_name()===e){b=a;break}}return b},$o_0:function(b){if(b){var a=this.$h_0(b);a&&this.$0_0.setOuterTagAttribute("selectedFormatMember",a.get_name())}},$5_0:function(a){this.$1_0&&Sys.UI.DomElement.removeCssClass(this.$1_0,"ms-bigrid-selectedcell");if(a){if(!isNullUndefinedOrEmpty(a.tagName)){if(PPSMA.DomElementEx.tagsMatch(a.tagName,"div")||PPSMA.DomElementEx.tagsMatch(a.tagName,"a"))a=a.parentNode;else if(PPSMA.DomElementEx.tagsMatch(a.tagName,"img"))a=a.parentNode.parentNode}else if(PPSMA.DomElementEx.tagsMatch(a.parentNode.tagName,"div"))a=a.parentNode.parentNode;else if(PPSMA.DomElementEx.tagsMatch(a.parentNode.tagName,"td"))a=a.parentNode;Sys.UI.DomElement.addCssClass(a,"ms-bigrid-selectedcell");this.$1_0=a;this.$o_0(a);this.$U_0(a,this.$0_0)}},$U_0:function(f,b){if(b&&b.get_results()){var c;if(this.get_$3_0()){var a="D";c="row:{0};col:{1};emptyrow:{2};emptycol:{3};sortrow:{4}";var d="no",i="no",g="no",h="no",e="nosort";if(f)a=PPSMA.ReportsCommon.getCellTypeId(f);else if(b.get_results().get_sortColIndex()===1)e=b.get_results().get_sortTypeRow();if(a==="D"||a==="P"||a==="R"){if(b.get_results().get_valueFilterRow()===1)d="value";if(b.get_results().get_topFilterRow()===1)d="top"}else{d="disable";i="disable"}if(a==="D"||a==="P"||a==="R"){if((b.get_results().get_filterEmptyAxis()&2)>0)g="yes"}else g="disable";if(a==="D"||a==="C"){if((b.get_results().get_filterEmptyAxis()&1)>0)h="yes"}else h="disable";if(f&&PPSMA.ReportsCommon.getSortedCellColumnPosition(f)===b.get_results().get_sortColIndex())e=b.get_results().get_sortTypeRow();if(a==="P"||a==="R")e="disablesort";c=String.format(c,d,i,g,h,e)}else c="disable";b.setOuterTagAttribute("arFilterState",c)}},selectLinkCell:function(a){a:;if(a){this.$5_0(a.parentNode);a.innerHTML!==""&&PPSMA.DomElementEx.tagsMatch(a.firstChild.tagName,"a")&&a.firstChild.focus()}},$T_0:function(a){if(a){a.focus();this.$5_0(a)}},selectOlapReportAndFocus:function(){a:;if(this.get_$9_0())return;var a=$get(this.$0_0.get_ctrlProxyId()+"_ag");a&&a.focus()},handleSingleClick:function(d){a:;var a=PPSMA.EventsEx.getCurrentElement(d),b=a.parentNode,c=this.$0_0.get_ctrlProxyId(),e=$get(c+"_srlink");if(PPSMA.NewWindow.isInMoreAccessibleMode()){if(a.tagName!=="IMG")if(a.tagName==="A"){this.$5_0(b);a.focus()}else{this.$5_0(a);a.firstChild&&a.firstChild.focus()}}else{if(PPSMA.DomElementEx.tagsMatch(a.tagName,"img")&&PPSMA.DomElementEx.tagsMatch(a.parentNode.tagName,"a")&&Sys.UI.DomElement.containsCssClass(a.parentNode,"js-bigrid-bubblelink")&&PPSMA.DomElementEx.tagsMatch(a.parentNode.parentNode.tagName,"td"))a=a.parentNode.parentNode;if(PPSMA.DomElementEx.tagsMatch(a.tagName,"a")&&Sys.UI.DomElement.containsCssClass(a,"js-bigrid-bubblelink")&&PPSMA.DomElementEx.tagsMatch(a.parentNode.tagName,"td"))a=a.parentNode;this.$5_0(a)}},selectLink:function(e){a:;var a=PPSMA.EventsEx.getEvent(e),b=a.button===2,d=a.button!==2;if(d||b){var c=PPSMA.EventsEx.getCurrentElement(a);this.selectLinkCell(c);this.$F_0=PPSMA.DomElementEx.tagsMatch(c.tagName,"a")&&b}},handleContextMenu:function(a){a:;Array.clear(this.$4_0);var f=PPSMA.EventsEx.getCurrentElement(a),d=PPSMA.OlapGrid.$g(f),b,c;if(a.keyCode===93||a.shiftKey&&a.keyCode===121||!d||PPSMA.DomElementEx.tagsMatch(d.tagName,"table")){b=0;c=0}else{var e=this.$P_0(a);b=e[0];c=e[1];if(b<0)b=0;if(c<0)c=0}PPSMA.ContextMenu.neutralizeBrowserMenu(new Sys.UI.DomEvent(a));PPSMA.ContextMenu.createForReportsNScorecards(d,this,b,c,this.$F_0)},$P_0:function(b){var a=b.srcElement;if(a)if(PPSMA.DomElementEx.tagsMatch(a.tagName,"a")||PPSMA.DomElementEx.tagsMatch(a.tagName,"td")||PPSMA.DomElementEx.tagsMatch(a.tagName,"img")||PPSMA.DomElementEx.tagsMatch(a.tagName,"span")||PPSMA.DomElementEx.tagsMatch(a.tagName,"div")){if(!isNullOrUndefined(a.id)&&a.id.endsWith("_PrXcYLink")){var c=b.offsetX,f=b.offsetY,d=b.x,g=b.y;if(isNaN(c)&&isNaN(d))return [a.offsetLeft,a.offsetTop];else if(!isNaN(c)&&!isNaN(d))return [Math.min.call(null,c,d),Math.min.call(null,f,g)];else if(!isNaN(c))return [c,f];else if(!isNaN(d))return [d,g]}var e=PPSMA.EventsEx.getEventOffset(b);return [e.x,e.y]}return [0,0]},hideViewInfoBarCtxMenu:function(c){a:;var e=PPSMA.EventsEx.getEvent(c);if(e.button===2){this.$A_0=true;Array.clear(this.$4_0);var a=PPSMA.EventsEx.getCurrentElement(c);this.$G_0=PPSMA.OlapViewContext.getViewInfoDiv(a);var b=this.$P_0(c),d;if(PPSMA.DomElementEx.tagsMatch(a.tagName,"a")){d=Sys.UI.DomElement.getLocation(a);b[0]=d.x;b[1]=d.y}else if(PPSMA.DomElementEx.tagsMatch(a.tagName,"span")&&Sys.UI.DomElement.containsCssClass(a,"ms-binavigablecontrol-closeinfoicon"))if(c.target){b[0]=c.target.offsetLeft;b[1]=c.target.offsetTop}else{b[0]=a.offsetLeft;b[1]=a.offsetTop}else if(PPSMA.DomElementEx.tagsMatch(a.tagName,"span")){d=Sys.UI.DomElement.getLocation(a);a=a.parentNode;if(!c.target){b[0]-=d.x;b[1]-=d.y}}PPSMA.ContextMenu.neutralizeBrowserMenu(new Sys.UI.DomEvent(c));PPSMA.ContextMenu.createForReportsNScorecards(a,this,b[0],b[1],false)}},handleKeyEvent:function(j){a:;var d=true,p=PPSMA.EventsEx.getEvent(j),q=this.$0_0.get_ctrlProxyId(),c=PPSMA.EventsEx.getCurrentElement(j),h=$get(q+"_srlink");if(Sys.UI.DomElement.containsCssClass(c,"js-bigrid-bubblelink"))return d;if(PPSMA.DomElementEx.tagsMatch(c.tagName,"a"))if(h){if(c.id!==h.id)c=c.parentNode}else c=c.parentNode;var b=c;if(b.nodeType===3&&PPSMA.DomElementEx.tagsMatch(b.parentNode.tagName,"td"))b=b.parentNode;else if(b.nodeType===3&&PPSMA.DomElementEx.tagsMatch(b.parentNode.tagName,"a")&&PPSMA.DomElementEx.tagsMatch(b.parentNode.parentNode.tagName,"td"))b=b.parentNode.parentNode;else if(PPSMA.DomElementEx.tagsMatch(b.tagName,"a")&&PPSMA.DomElementEx.tagsMatch(b.parentNode.tagName,"td"))b=b.parentNode.parentNode;else if(PPSMA.DomElementEx.tagsMatch(b.tagName,"table"))b=this.$1_0;if(!b||(b.nodeType===3||b.nodeType!==3&&!PPSMA.DomElementEx.tagsMatch(b.tagName,"td")))return d;var a=b,g=a.cellIndex,r=p.keyCode,s=37,t=39,u=38,v=40,w=32,x=13,y=1,k,z=this.$0_0.get_results().get_rowHierarchies();k=z.length;var i=0;if(this.$8_0===1)if(!k)i=1;else i=2;if(!this.$8_0)i=y+k;var A=this._showProperties.getTotalMemberPropertyCount(),l=i+A;switch(r){case s:if(a.previousSibling){a=a.previousSibling;a.focus();this.$5_0(a);if(a.innerHTML!=="")PPSMA.DomElementEx.tagsMatch(a.firstChild.tagName,"a")&&a.firstChild.focus()}d=false;break;case u:if(a.parentNode.previousSibling){var e=PPSMA.ReportsCommon.getCellColumnPosition(a),n=PPSMA.ReportsCommon.getCellTypeId(this.$1_0);if(n==="C"||n==="D")if(e>0&&g>0){e=e-a.colSpan+l;e=PPSMA.OlapGrid.$R(a.parentNode.previousSibling,e)}else e=g;else e=g;a=a.parentNode.previousSibling.childNodes[e];a.focus();this.$5_0(a);if(a.innerHTML!=="")PPSMA.DomElementEx.tagsMatch(a.firstChild.tagName,"a")&&a.firstChild.focus()}d=false;break;case t:if(a.nextSibling){a=a.nextSibling;a.focus();this.$5_0(a)}d=false;break;case v:if(a.parentNode.nextSibling){var f=PPSMA.ReportsCommon.getCellColumnPosition(a),o=PPSMA.ReportsCommon.getCellTypeId(this.$1_0);if(o==="C"||o==="D")if(f>0&&g>0){f=f-a.colSpan+l;f=PPSMA.OlapGrid.$R(a.parentNode.nextSibling,f)}else f=g;else f=g;a=a.parentNode.nextSibling.childNodes[f];a.focus();this.$5_0(a)}d=false;break;case x:if(h)if(c.id===h.id)this.handleSkipReport(j);else{a.focus();this.$5_0(a);this.handleContextMenu(j)}else d=false;break;case w:var m=this.$6_0(this.$1_0);if(m)if(m.get_drilledDown())this.$H_0(this.$1_0);else this.$I_0(this.$1_0)}return d},handleTabEvent:function(c){a:;var a=PPSMA.EventsEx.getCurrentElement(c),b=a.parentNode;this.$5_0(b)},handleDeselectCell:function(b){a:;var a=PPSMA.EventsEx.getCurrentElement(b);if(PPSMA.DomElementEx.tagsMatch(a.tagName,"a"))a=a.parentNode;else if(PPSMA.DomElementEx.tagsMatch(a.tagName,"td"))a=a.parentNode;Sys.UI.DomElement.removeCssClass(a,"ms-bigrid-selectedcell")},handleDoubleClick:function(e){a:;window.document.onselectstart=eval("new Function('return false;')");document.selection.empty();var $v_0=PPSMA.EventsEx.getCurrentElement(e);this.$M_0($v_0)},handleExpandClick:function(d){a:;var a=PPSMA.EventsEx.getCurrentElement(d),b=null;if(a){if(PPSMA.DomElementEx.tagsMatch(a.tagName,"img")&&a.className.toLowerCase().startsWith("ms-bigrid-expandcollapseimage".toLowerCase()))b=a.parentNode.parentNode;else if(PPSMA.DomElementEx.tagsMatch(a.tagName,"a")&&a.className.toLowerCase().startsWith("ms-bigrid-expandcollapseanchor".toLowerCase()))b=a.parentNode;b&&this.$I_0(b);var c=new Sys.UI.DomEvent(d);c.preventDefault();c.stopPropagation()}},handleCollapseClick:function(d){a:;var a=PPSMA.EventsEx.getCurrentElement(d),b=null;if(a){if(PPSMA.DomElementEx.tagsMatch(a.tagName,"img")&&a.className.toLowerCase().startsWith("ms-bigrid-expandcollapseimage".toLowerCase()))b=a.parentNode.parentNode;else if(PPSMA.DomElementEx.tagsMatch(a.tagName,"a")&&a.className.toLowerCase().startsWith("ms-bigrid-expandcollapseanchor".toLowerCase()))b=a.parentNode;b&&this.$H_0(b);var c=new Sys.UI.DomEvent(d);c.preventDefault();c.stopPropagation()}},doShowContextMenu:function(){a:;this.handleSingleClick(this.$J_0);this.handleContextMenu(this.$J_0)},handleTouchStart:function(a){a:;if(a.touches.length==1){this.$J_0=a;this.$C_0=window.setTimeout(this.$$d_doShowContextMenu,1500);if(a.touches!=undefined&&a.touches[0]!=undefined){this._screenTouchPositionX=a.touches[0].screenX;this._screenTouchPositionY=a.touches[0].screenY}}else window.clearTimeout(this.$C_0)},handleTouchMove:function(a){a:;if(a.targetTouches!=undefined&&a.targetTouches[0]!=undefined)(Math.abs(a.targetTouches[0].screenX-this._screenTouchPositionX)>=PPSMA.OlapGrid._contextCancelDeltaX||Math.abs(a.targetTouches[0].screenY-this._screenTouchPositionY)>=PPSMA.OlapGrid._contextCancelDeltaX)&&window.clearTimeout(this.lastTimeout)},handleTouchEnd:function(){a:;window.clearTimeout(this.$C_0)},handleTouchCancel:function(){a:;window.clearTimeout(this.$C_0)},addPrimaryMenuItems:function(a){a:;var f=this.$6_0(this.$1_0),j=PPSMA.ReportsCommon.getHeaderCellHierarchy(this.$0_0,this.$1_0),b=new PPSMA.MenuOptionHelper(f,j,this.get_$3_0(),this.$0_0);if(this.$A_0){b.showHideInfo(a,this.$2_0+".handleShowHideInfoByDiv();",false);this.$A_0=false;return b.get_optionsAdded()>0}var c=PPSMA.ReportsCommon.getCellTypeId(this.$1_0);if(c==="R"||c==="C"||c==="P"){if(c==="R"||c==="C")if(f){b.drillDown(a,this.$2_0+".handleDrillDownMenuClick();",false);var g=b.drillDownTo(a,this.$2_0+".fetchCallback("+this.$4_0.length+")",this.$2_0+".populateCallback("+this.$4_0.length+")",this.$2_0+".hoverOffCallback("+this.$4_0.length+")",false);if(g){var k=new PPSMA.SubMenu(g,0);Array.add(this.$4_0,k)}b.drillUp(a,this.$2_0+".handleDrillUpMenuClick();",false);(this.$8_0===1||c==="C")&&b.expandCollapse(a,this.$2_0+".handleExpandMenuClick();",this.$2_0+".handleCollapseMenuClick();",false);b.showOnly(a,this.$2_0+".handleShowOnlyMenuClick();",false);b.remove(a,this.$2_0+".handleRemoveMenuClick();",false)}if(this.get_$3_0()){if(c==="R"&&f){b.showChangeMeasure(a,this.$2_0+".handleShowChangeMeasureMenuClick();",this.get_$9_0(),false);PPSMA.ContextMenu.addMenuSeparator(a);b.showProperties(a,this.$2_0+".handleShowPropertiesMenuClick();",false,this._showProperties.isEnabled(this.$1_0));PPSMA.ContextMenu.addMenuSeparator(a)}if(c==="P"){b.showChangeMeasure(a,this.$2_0+".handleShowChangeMeasureMenuClick();",this.get_$9_0(),false);b.showProperties(a,this.$2_0+".handleShowPropertiesMenuClick();",false,this._showProperties.isEnabled(this.$1_0));PPSMA.ContextMenu.addMenuSeparator(a)}if(c==="C"){b.showChangeMeasure(a,this.$2_0+".handleShowChangeMeasureMenuClick();",this.get_$9_0(),false);PPSMA.ContextMenu.addMenuSeparator(a);this.$L_0(a)}(c==="P"||c==="R"||c==="C")&&this.$K_0(a,c);b.pivot(a,this.$2_0+".handlePivotMenuClick();",false)}}else if(c==="D"){if(!this.get_$9_0()){var d=true;if(this.$1_0.innerHTML==="")d=false;b.decompositionTree(a,this.$2_0+".handleAnalyzeInDecompMenuClick('');",false,d,this.get_$9_0());var l=b.hasAggregatedBackGroundHierarchies();if(l)d=false;b.showDetails(a,this.$2_0+".handleShowDetailsMenuClick('');",false,d);var e=true,h=this.$1_0.getAttribute("rt");if(h&&h==="aggr")e=false;if(b.hasAggregatedBackGroundHierarchies())e=false;e&&this.$0_0.set_cellActionData(null);var i=b.additionalActions(a,this.$2_0+".fetchCallback("+this.$4_0.length+")",this.$2_0+".populateCallback("+this.$4_0.length+")",this.$2_0+".hoverOffCallback("+this.$4_0.length+")",false,e);if(i){var m=new PPSMA.SubMenu(i,1);Array.add(this.$4_0,m)}}if(this.get_$3_0()){PPSMA.ContextMenu.addMenuSeparator(a);b.showChangeMeasure(a,this.$2_0+".handleShowChangeMeasureMenuClick();",this.get_$9_0(),false);PPSMA.ContextMenu.addMenuSeparator(a);this.$L_0(a);this.$K_0(a,c);b.pivot(a,this.$2_0+".handlePivotMenuClick();",false)}}else if((c==="Z"||c==="Y")&&this.get_$3_0()){var n=this._showProperties.isEnabled(this.$1_0);b.showProperties(a,this.$2_0+".handleShowPropertiesMenuClick();",false,n);this.$a_0(a,b);PPSMA.ContextMenu.addMenuSeparator(a);b.pivot(a,this.$2_0+".handlePivotMenuClick();",false)}this.get_$3_0()&&this.$Z_0(a,b);b.showHideInfo(a,this.$2_0+".handleShowHideInfoMenuClick();",false);return b.get_optionsAdded()>0},$K_0:function(h,a){var c=this.$0_0.get_results().get_filterEmptyAxis();if(this.$0_0.get_results().get_filterEmptyAxis()===-1)return;var f=(c&2)>0,g=(c&1)>0,b=PPSMA.ContextMenu.addSubMenu(h,PPSMA.SR.OlapContextMenu_Filter,"/_layouts/15/images/filter.gif",false);if(a==="D"||a==="P"||a==="R"){var d=this.$0_0.get_results().get_valueFilterRow()===1,e=this.$0_0.get_results().get_topFilterRow()===1;if(d||e)PPSMA.ContextMenu.addMenuOption(b,PPSMA.SR.OlapContextMenu_ClearFilter,this.$2_0+".handleClearFilterMenuClick();",this.$0_0.get_resourcePath()+"ClearFilter.gif","",false,false);else PPSMA.ContextMenu.addDisabledMenuOption(b,PPSMA.SR.OlapContextMenu_ClearFilter,null,this.$0_0.get_resourcePath()+"ClearFilterD.gif",false);if(!isNullUndefinedOrEmpty(this.$0_0.get_results().get_rowMembers())&&this.$0_0.get_results().get_rowMembers().length>0){PPSMA.ContextMenu.addMenuOption(b,PPSMA.SR.OlapContextMenu_ValueFilter,this.$2_0+".handleValueFilterMenuClick();",d?this.$0_0.get_resourcePath()+"Check.gif":"","",false,false);PPSMA.ContextMenu.addMenuOption(b,PPSMA.SR.OlapContextMenu_TopFilter,this.$2_0+".handleTopFilterMenuClick();",e?this.$0_0.get_resourcePath()+"Check.gif":"","",false,false)}PPSMA.ContextMenu.addMenuSeparator(b)}(a==="D"||a==="P"||a==="R")&&PPSMA.ContextMenu.addToggleMenuOption(b,PPSMA.SR.OlapContextMenu_EmptyRows,this.$2_0+".handleFilterEmptyRowMenuClick();",this.$0_0.get_resourcePath()+"FilterEmpRow.gif","",f,false);(a==="D"||a==="C")&&PPSMA.ContextMenu.addToggleMenuOption(b,PPSMA.SR.OlapContextMenu_EmptyCols,this.$2_0+".handleFilterEmptyColMenuClick();",this.$0_0.get_resourcePath()+"FilterEmpCol.gif","",g,false)},$a_0:function(i,j){var e=PPSMA.ReportsCommon.getCellRowPosition(this.$1_0),b=PPSMA.ReportsCommon.getCellColumnPosition(this.$1_0),f=this.$0_0.get_results().get_rowHierarchies(),c=f[e],d=c.get_memberProperties(),g=d.get_captions(),h=d.get_names(),a=g[b];if(a.length>20)a=a.substring(0,20)+PPSMA.SR.OlapPropertiesDialog_LongStringPadding;j.hideProperty(i,String.format(PPSMA.SR.OlapContextMenu_HideProperty,a),this.$2_0+'._showProperties.handleHidePropertyMenuClick("'+c.get_name()+'", "'+h[b]+'");',false)},$L_0:function(c){var b=PPSMA.ReportsCommon.getSortedCellColumnPosition(this.$1_0)===this.$0_0.get_results().get_sortColIndex(),a=PPSMA.ContextMenu.addSubMenu(c,PPSMA.SR.OlapContextMenu_Sort,this.$0_0.get_resourcePath()+"Sort.gif",false);PPSMA.ContextMenu.addMenuOption(a,PPSMA.SR.OlapContextMenu_LargeToSmall,this.$2_0+".handleSortMenuClick('desc');",this.$0_0.get_resourcePath()+"SortAscNum.gif",null,b&&this.$0_0.get_results().get_sortTypeRow()==="desc",false);PPSMA.ContextMenu.addMenuOption(a,PPSMA.SR.OlapContextMenu_SmallToLarge,this.$2_0+".handleSortMenuClick('asc');",this.$0_0.get_resourcePath()+"SortDescNum.gif",null,b&&this.$0_0.get_results().get_sortTypeRow()==="asc",false);PPSMA.ContextMenu.addMenuOption(a,PPSMA.SR.OlapContextMenu_NoSort,this.$2_0+".handleSortMenuClick('nosort');",null,null,true,false)},$Z_0:function(a,b){PPSMA.ContextMenu.addMenuSeparator(a);b.reportTypeSubMenu(a,this.$2_0,0);this.$Y_0(a,b)},$Y_0:function(b,c){var a=c.formatReportSubMenu(b,false);PPSMA.ContextMenu.addMenuOption(a,PPSMA.SR.OlapContextMenu_CompactLayout,this.$2_0+".handleFormatReportMenuClick(1);",this.$0_0.get_resourcePath()+"LayoutCompact.gif",null,this.$8_0===1,false);PPSMA.ContextMenu.addMenuOption(a,PPSMA.SR.OlapContextMenu_TabularLayout,this.$2_0+".handleFormatReportMenuClick(0);",this.$0_0.get_resourcePath()+"LayoutTabular.gif",null,!this.$8_0,false)},fetchCallback:function(b){a:;var a=this.$4_0[b];if(a){a.set_hoverOn(true);switch(a.get_menuType()){case 1:if(isNullUndefinedOrEmpty(this.$0_0.get_cellActionData())&&!this.$D_0){this.$D_0=true;var c=PPSMA.ReportsCommon.getCellRowPosition(this.$1_0),d=PPSMA.ReportsCommon.getCellColumnPosition(this.$1_0),e=new PPSMA.DetailsHelper(this.$0_0,this.$2_0,c,d,""),f=e.getCellTupleXml();this.$0_0.getCellLevelActions(f)}break;case 0:!this.$0_0.get_cubeMetadata()&&this.$0_0.loadCubeMetadata(this.$0_0.get_ctrlProxyId());break;default:a.set_hoverOn(false)}}},$D_0:false,populateCallback:function(d){a:;var a=this.$4_0[d];if(a&&a.get_hoverOn()){var b=a.get_menu(),c=a.get_isPopulated();if(!c){PPSMA.ContextMenu.removeAllButFirst(b);switch(a.get_menuType()){case 1:if(!isNullUndefinedOrEmpty(this.$0_0.get_cellActionData())){this.$k_0(b);a.set_isPopulated(true);this.$D_0=false}break;case 0:if(this.$0_0.get_cubeMetadata()){this.$l_0(b);a.set_isPopulated(true)}}}if(c)PPSMA.ContextMenu.refreshMenu(b,false);else a.get_isPopulated()&&PPSMA.ContextMenu.refreshMenu(b,true)}},hoverOffCallback:function(b){a:;var a=this.$4_0[b];a&&a.set_hoverOn(false)},$k_0:function(g){var e=PPSMA.XmlEx.loadXml(this.$0_0.get_cellActionData()),f=0,a=e.getElementsByTagName("UrlAction");if(a&&a.length>0)for(var c=0;c<a.length;c++){PPSMA.ContextMenu.addMenuOption(g,a[c].getAttribute("caption"),this.$2_0+".handleShowUrlMenuClick('"+a[c].getAttribute("content")+"');",null,null,false,false);++f}var b=e.getElementsByTagName("DDAction");if(b&&b.length>0)for(var d=0;d<b.length;d++){PPSMA.ContextMenu.addMenuOption(g,b[d].getAttribute("caption"),this.$2_0+".handleShowDetailsMenuClick('"+b[d].getAttribute("resulttableindex")+"');",null,null,false,false);++f}if(!f){var h=e.getElementsByTagName("AdditionalActions");h&&PPSMA.ContextMenu.addDisabledMenuOption(g,h[0].getAttribute("message"),null,null,false)}},$l_0:function(e){var c=PPSMA.ReportsCommon.getCellTypeId(this.$1_0),a=this.$6_0(this.$1_0),b=PPSMA.ReportsCommon.getHeaderCellHierarchy(this.$0_0,this.$1_0);if(a&&b){var d=new PPSMA.DrillDownToHelper(a,b,c,this.$0_0);d.populateSubMenuItems(e,this.$2_0+".handleDrillDownToMenuClick")}},handleDrillDownMenuClick:function(){a:;this.$M_0(this.$1_0)},handleDrillDownToMenuClick:function(a,b,c){a:;this.$e_0(this.$1_0,unescape(a),unescape(b),unescape(c))},handleDrillUpMenuClick:function(){a:;this.$f_0(this.$1_0)},handleExpandMenuClick:function(){a:;this.$I_0(this.$1_0)},handleCollapseMenuClick:function(){a:;this.$H_0(this.$1_0)},handleShowOnlyMenuClick:function(){a:;this.$q_0(this.$1_0)},handleRemoveMenuClick:function(){a:;this.$m_0(this.$1_0)},handleShowPropertiesMenuClick:function(){a:;this.$0_0.set_dimensionData(null);this._showProperties.setCallbackMethod(this.$$d_handleOlapGridCallback);this._showProperties.show(this.$1_0)},handleOlapGridCallback:function(){a:;(this._showProperties.get_selectedButton()==="2"||this._changeMeasure.get_selectedButton()==="2")&&this.$T_0(this.$1_0)},handlePivotMenuClick:function(){a:;this.$j_0()},handleFilterEmptyRowMenuClick:function(){a:;this.$O_0()},handleSortMenuClickAsc:function(a,b){a:;this.$W_0("asc",a,b)},handleClearFilterMenuClick:function(){a:;this.$0_0.clearFilter("2",false)},handleValueFilterMenuClick:function(){a:;var b=null;if(this.$0_0&&this.$0_0.get_results())b=this.$0_0.get_results().get_valueFilterParamsRow();var a=null;this._valueFilter.set_selectedButton("2");if(b&&b!=="")a=b.split(";");var c=0;if(a&&a[0]!=="0")c=parseInt(a[0]);this.$V_0("disablefilter",true);this._valueFilter.setCallbackMethod(this.$$d_processFilterDialogResult);if(c>6&&a){this._valueFilter.set_filterType(c);this._valueFilter.set_hierarchyName(a[1]);var d=a[2];isNullUndefinedOrEmpty(this._valueFilter.get_value1())&&this._valueFilter.set_value1(this._valueFilter.getFormattedStringFromInvariantNumber(Number.parseInvariant(a[3]),false));isNullUndefinedOrEmpty(this._valueFilter.get_value2())&&this._valueFilter.set_value2(this._valueFilter.getFormattedStringFromInvariantNumber(Number.parseInvariant(a[4]),false));this._valueFilter.set_levelName(a[5]);this._valueFilter.loadFilterDialog(a[0],d,a[5],this._valueFilter.get_hierarchyName(),this._valueFilter.get_value1(),this._valueFilter.get_value2(),this.$1_0,"2")}else{this._valueFilter.set_filterType(9);this._valueFilter.set_showClearOption(false);this._valueFilter.set_tupleIndex(0);if(this.$1_0){var e=PPSMA.ReportsCommon.getCellTypeId(this.$1_0);e!=="R"&&this._valueFilter.set_tupleIndex(PPSMA.ReportsCommon.getCellColumnPosition(this.$1_0))}this._valueFilter.set_value1("0");this._valueFilter.set_value2("100");this._valueFilter.set_currentCell(this.$1_0);this._valueFilter.set_axis("2");this._valueFilter.set_innerTargetID(this.$0_0?this.$0_0.get_innerTargetId():null);this._valueFilter.showValueFilterDlg()}},processFilterDialogResult:function(){a:;this.$n_0("disablefilter");if(this._valueFilter.get_selectedButton()==="1")this.$0_0.filter(this._valueFilter.get_filterType().toString(),this._valueFilter.get_hierarchyName(),this._valueFilter.get_tupleXML(),this._valueFilter.get_axis(),this._valueFilter.get_levelName(),this._valueFilter.get_value1(),this._valueFilter.get_value2());else if(this._valueFilter.get_selectedButton()==="2")this.$T_0(this.$1_0);else this._valueFilter.get_selectedButton()==="3"&&this.$0_0.clearFilter(this._valueFilter.get_axis(),this._valueFilter.get_axis()==="2")},$n_0:function(b){var a="";a=this.$0_0.getOuterTagAttribute("arFilterState");a=a.replace(";"+b,"");this.$0_0.setOuterTagAttribute("arFilterState",a)},$V_0:function(b,c){var a="";if(c){a=this.$0_0.getOuterTagAttribute("arFilterState");a=a+";"+b}this.$0_0.setOuterTagAttribute("arFilterState",a)},handleTopFilterMenuClick:function(){a:;var b=null;if(this.$0_0&&this.$0_0.get_results())b=this.$0_0.get_results().get_valueFilterParamsRow();var a=null;this._valueFilter.set_selectedButton("2");if(b&&b!=="")a=b.split(";");var c=0;if(a&&a[0]!=="0")c=parseInt(a[0]);this.$V_0("disablefilter",true);this._valueFilter.setCallbackMethod(this.$$d_processFilterDialogResult);if(c>0&&c<7&&a){this._valueFilter.set_filterType(c);this._valueFilter.set_hierarchyName(a[1]);var d=a[2];this._valueFilter.set_value1(a[3]);this._valueFilter.set_value2(a[4]);this._valueFilter.set_levelName(a[5]);this._valueFilter.loadFilterDialog(a[0],d,a[5],this._valueFilter.get_hierarchyName(),this._valueFilter.get_value1(),this._valueFilter.get_value2(),this.$1_0,"2")}else{this._valueFilter.set_filterType(1);this._valueFilter.set_showClearOption(false);this._valueFilter.set_tupleIndex(0);this.$1_0&&this._valueFilter.set_tupleIndex(PPSMA.ReportsCommon.getSortedCellColumnPosition(this.$1_0));this._valueFilter.set_value1("10");this._valueFilter.set_currentCell(this.$1_0);this._valueFilter.set_axis("2");this._valueFilter.set_innerTargetID(this.$0_0?this.$0_0.get_innerTargetId():null);this._valueFilter.showTopFilterDlg()}},loadFilterDialog:function(a,b,f,e,c,d,g){a:;this._valueFilter.setCallbackMethod(this.$$d_processFilterDialogResult);this._valueFilter.loadFilterDialog(a,f,e,b,c,d,this.$1_0,g)},handleSortMenuClickDesc:function(a,b){a:;this.$W_0("desc",a,b)},handleSortMenuClick:function(a){a:;this.$r_0(this.$1_0,a)},handleFilterEmptyColMenuClick:function(){a:;this.$N_0()},handleFormatReportMenuClick:function(a){a:;this.$b_0(a)},handleShowHideInfoByDiv:function(){a:;this.$0_0.toggleViewInfoBar(this.$G_0.firstChild)},handleShowHideInfoMenuClick:function(){a:;var b=null,a=this.$1_0.parentNode;while(a){if(PPSMA.DomElementEx.tagsMatch(a.tagName,"table")){b=a;break}a=a.parentNode}var c=null;if(b){var d=b.parentNode.parentNode;a=d.firstChild;while(a){if(PPSMA.DomElementEx.tagsMatch(a.tagName,"div")&&a.id==="_viewInfoId"){c=a;break}a=a.nextSibling}}c&&this.$0_0.toggleViewInfoBar(c.firstChild)},handleMeasureGroupNameChange:function(){a:;var $v_0="window.event.srcElement.id",$v_1=eval($v_0),$v_2=$get($v_1);if($v_2){var $v_3=$v_2.getAttribute("MeasureGroupName");this.$0_0.get_measures().set_measureGroupName($v_3)}},handleShowChangeMeasureMenuClick:function(){a:;this._changeMeasure.setCallbackMethod(this.$$d_handleOlapGridCallback);this._changeMeasure.show(this.$1_0)},handleShowUrlMenuClick:function(a){a:;PPSMA.NewWindow.openUrl(a)},handleAnalyzeInDecompMenuClick:function(){a:;var a=PPSMA.ReportsCommon.getCellRowPosition(this.$1_0),b=PPSMA.ReportsCommon.getCellColumnPosition(this.$1_0),c=new PPSMA.AnalyzeInDecompHelper;c.launchAnalyzeRequest(this.$0_0,this.$2_0,a,b)},handleShowDetailsMenuClick:function(a){a:;this.$p_0(this.$1_0,a)},$M_0:function(c){if(this.get_$3_0()){var a=this.$6_0(c),b=PPSMA.ReportsCommon.getHeaderCellHierarchy(this.$0_0,c);if(a&&b)a.get_hasChildren()&&this.$0_0.drillDown(b.get_name(),a.get_name())}},$e_0:function(c,d,e,f){if(this.get_$3_0()){var a=this.$6_0(c),b=PPSMA.ReportsCommon.getHeaderCellHierarchy(this.$0_0,c);a&&b&&this.$0_0.crossDrill(b.get_name(),a.get_name(),d,e,f)}},$f_0:function(c){if(this.get_$3_0()){var a=this.$6_0(c),b=PPSMA.ReportsCommon.getHeaderCellHierarchy(this.$0_0,c);if(a&&b)a.get_hasParent()&&this.$0_0.drillUp(b.get_name(),a.get_name())}},$I_0:function(c){if(this.get_$3_0()){var a=this.$6_0(c),b=PPSMA.ReportsCommon.getHeaderCellHierarchy(this.$0_0,c);if(a&&b)a.get_hasChildren()&&this.$0_0.expand(b.get_name(),a.get_name())}},$H_0:function(c){if(this.get_$3_0()){var a=this.$6_0(c),b=PPSMA.ReportsCommon.getHeaderCellHierarchy(this.$0_0,c);if(a&&b)a.get_drilledDown()&&this.$0_0.collapse(b.get_name(),a.get_name())}},$q_0:function(c){if(this.get_$3_0()){var b=this.$6_0(c),a=PPSMA.ReportsCommon.getHeaderCellHierarchy(this.$0_0,c);if(b&&a)!a.get_isSingleton()&&this.$0_0.showOnly(a.get_name(),b.get_name())}},$m_0:function(c){if(this.get_$3_0()){var b=this.$6_0(c),a=PPSMA.ReportsCommon.getHeaderCellHierarchy(this.$0_0,c);if(b&&a)!a.get_isSingleton()&&this.$0_0.hide(a.get_name(),b.get_name())}},$j_0:function(){a:;this.get_$3_0()&&this.$0_0.pivot()},$O_0:function(){a:;if(this.get_$3_0()){var a=(this.$0_0.get_results().get_filterEmptyAxis()&2)>0;this.$0_0.filterEmpty("2",!a)}},$N_0:function(){a:;if(this.get_$3_0()){var a=(this.$0_0.get_results().get_filterEmptyAxis()&1)>0;this.$0_0.filterEmpty("1",!a)}},$W_0:function(c,d,e){if(this.get_$3_0()){var b=new PPSMA.DetailsHelper(this.$0_0,this.$2_0,e,d,""),a=b.getCellTupleXml();a&&this.$S_0(c,a)}},$r_0:function(c,f){if(this.get_$3_0()&&this.$0_0){var d=0,a=0;if(c)a=PPSMA.ReportsCommon.getSortedCellColumnPosition(c);var e=new PPSMA.DetailsHelper(this.$0_0,this.$2_0,d,a,""),b=e.getCellTupleXml();b&&this.$S_0(f,b)}},$S_0:function(b,c){if(this.get_$3_0()){var a="false";if(this.$8_0===1)a="true";this.$0_0.sort("2",c,b,a)}},$b_0:function(a){this.$0_0.changeViewConfiguration("ReportLayout",a.toString())},switchToGrid:function(){},switchToColumnChart:function(){a:;this.$0_0.switchOlapReportType(1,null)},switchToColumnChartStacked:function(){a:;this.$0_0.switchOlapReportType(2,null)},switchToColumnChartStacked100:function(){a:;this.$0_0.switchOlapReportType(3,null)},switchToLineChart:function(){a:;this.$0_0.switchOlapReportType(4,null)},switchToLineChartWithMarkers:function(){a:;this.$0_0.switchOlapReportType(5,null)},switchToPieChart:function(){a:;this.$0_0.switchOlapReportType(6,null)},$p_0:function(a,e){var b=PPSMA.ReportsCommon.getCellRowPosition(a),c=PPSMA.ReportsCommon.getCellColumnPosition(a),d=new PPSMA.DetailsHelper(this.$0_0,this.$2_0,b,c,e);d.showDetails()},addDatasourceFormattingStyle:function(d,b,c){a:;var a=PPSMA.OlapGrid.$Q(d);if(!a)return;PPSMA.OlapGrid.$7(a,"."+b,c)},replaceGridStyles:function(h,f,e,b,g,r,c){a:;if(!this.$E_0){var a=PPSMA.OlapGrid.$Q(h);if(!a)return;var i=String.format("font-size:{0}pt !Important; font-family:{1} !Important; color:{2} !Important; background-color:{3}; {4}",f,e,b,g,c),j=String.format("font-size:{0}pt !Important; font-family:{1} !Important; color:{2} !Important; background-color:{3}; {4}",f,e,b,g,c),k=String.format("font-size:{0}pt !Important; font-family:{1} !Important; color:{2} !Important; {3}",f,e,b,c),l=String.format("font-size:{0}pt !Important; font-family:{1} !Important; color:{2} !Important; {3}",f,e,b,c),m=String.format("font-size:{0}pt !Important; font-family:{1} !Important; color:{2} !Important; {4}",f,e,b,c),n=String.format("color:{0} !Important; {1}",b,c),o=String.format("font-size:{0}pt !Important; font-family:{1} !Important; color:{2} !Important; {4}",f,e,b,c),p=String.format("font-size:{0}pt !Important; font-family:{1} !Important; color:{2} !Important; background-color:{3}; {4}",f,e,b,g,c),q=String.format("color:{0} !Important; {1}",b,c),d=this.$0_0.get_ctrlProxyId();PPSMA.OlapGrid.$7(a,"."+d+"_ms-bigrid-rowheaders",i);PPSMA.OlapGrid.$7(a,"."+d+"_ms-bigrid-oncolumns",j);PPSMA.OlapGrid.$7(a,"."+d+"_ms-bigrid-columnheaderspanalignment",k);PPSMA.OlapGrid.$7(a,"."+d+"_ms-bigrid-columnheaders",l);PPSMA.OlapGrid.$7(a,"."+d+"_ms-bigrid-pulpitheader",m);PPSMA.OlapGrid.$7(a,"."+d+"_ms-bigrid-pulpitheaderlink",n);PPSMA.OlapGrid.$7(a,"."+d+"_ms-bigrid-propertiesrowheaders",o);PPSMA.OlapGrid.$7(a,"."+d+"_ms-bigrid-propertiesrowvalues",p);PPSMA.OlapGrid.$7(a,"."+d+"_ms-bigrid-accessibilitymodelink",q)}},handleSkipReport:function(){a:;var b=$get(this.$0_0.get_ctrlProxyId()+"_ag"),a=null;if(!b){PPSMA.ReportsCommon.logErrorCondition("can't find the grid, bailing");return}else try{a=b.lastChild.lastChild.lastChild.lastChild}catch(c){a=null}if(a&&PPSMA.DomElementEx.tagsMatch(a.tagName,"a")&&a.className&&(Sys.UI.DomElement.containsCssClass(a,this.$0_0.get_ctrlProxyId()+"_ms-bigrid-accessibilitymodelink")||Sys.UI.DomElement.containsCssClass(a,"ms-bigrid-accessibilitymodelink")))a.focus();else PPSMA.ReportsCommon.logErrorCondition("can't find the last cell link in the grid, bailing")},assignFocus:function(){a:;var a=this.$0_0.get_ctrlProxyId(),c=$get(a+"_srlink"),b=$get(a+"_PrXcYLink").firstChild,d=b.parentNode;if(PPSMA.NewWindow.isInMoreAccessibleMode())c.focus();else{this.$5_0(d);b.focus()}}};PPSMA.OlapGrid.registerClass("PPSMA.OlapGrid",null,PPSMA.OlapView);PPSMA.OlapGrid.$c=40;PPSMA.OlapGrid.$d=40;typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs!="undefined"&&NotifyScriptLoadedAndExecuteWaitingJobs("analyticgrid.js")