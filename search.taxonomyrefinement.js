Type.registerNamespace("Srch");Srch.TaxonomyRefinementSortOrder=function(){};Srch.TaxonomyRefinementSortOrder.prototype={Frequency:0,TermSet:1};Srch.TaxonomyRefinementSortOrder.registerEnum("Srch.TaxonomyRefinementSortOrder",false);Srch.TaxonomyRefinement=function(a){this.$$d_$8_4=Function.createDelegate(this,this.$8_4);this.$3_4=Srch.TaxonomyRefinementSortOrder.toString(0);Srch.TaxonomyRefinement.initializeBase(this,[a])};Srch.TaxonomyRefinement.$6=function(c,d){var a=c,b=d;if(a.count<b.count)return 1;else if(a.count===b.count)return 0;else return -1};Srch.TaxonomyRefinement.$7=function(e,a){var b=5;if(!a.startsWith("GP")||a.length<b)return false;var c=a.charAt(2);if(c!=="0"&&c!=="P")return false;if(a.charAt(3)!=="|")return false;if(a.charAt(4)!=="#")return false;var d=a.substring(b,a.length);return d.toLowerCase()===e.id};Srch.TaxonomyRefinement.prototype={get_taxonomyRefinerName:function(){return this.$4_4},set_taxonomyRefinerName:function(a){this.$4_4=a;return a},$4_4:null,get_currentTaxonomyNodes:function(){return this.$0_4},set_currentTaxonomyNodes:function(a){this.$0_4=a;return a},$0_4:null,get_renderCounts:function(){return this.$2_4},set_renderCounts:function(a){this.$2_4=a;return a},$2_4:true,get_sortMode:function(){return this.$3_4},set_sortMode:function(a){this.$3_4=a;return a},get_itemTemplateId:function(){return this.$1_4},set_itemTemplateId:function(a){this.$1_4=a;return a},$1_4:"",render:function(){Srch.U.ensureNotNullOrUndefined(this.get_element(),this,"RenderControl","this.Element");this.set_renderedResult(false);this.displayControlMessages();if(Srch.U.w(this.$4_4))return;for(var c=new Array(this.$0_4.length),d=0;d<this.$0_4.length;d++)c[d]=new Srch.TaxonomyNodeSearchResult(this.$0_4[d],0);if(!Srch.U.n(this.get_dataProvider().get_refinementInfo())){var e=this.get_dataProvider().get_refinementInfo()[this.$4_4];if(!Srch.U.n(e))for(var f=0;f<e.length;f++)for(var i=e[f],l=i["RefinementValue"],g=0;g<c.length;g++){var j=c[g];if(Srch.TaxonomyRefinement.$7(j,l)){var m=i["RefinementCount"];j.count+=m}}}for(var b=[],h=0;h<c.length;h++){var k=c[h];k.count>0&&Array.add(b,k)}this.$3_4===Srch.TaxonomyRefinementSortOrder.toString(0)&&b.sort(Srch.TaxonomyRefinement.$6);if(!Srch.U.n(this.alternateRenderer)){if(Srch.U.n(this.alternateRenderContext))this.alternateRenderContext={};this.alternateRenderContext["ListData"]=b;this.alternateRenderContext["CurrentItems"]=b;this.alternateRenderContext["ClientControl"]=this;this.alternateRenderContext["DataProvider"]=this.get_dataProvider();this.alternateRenderContext["ScriptApplicationManager"]=Srch.ScriptApplicationManager.get_current();this.alternateRenderContext["RenderCounts"]=this.$2_4;this.invokeAlternateRender(this.alternateRenderer,this.get_element(),this.alternateRenderContext)}else{var a={};a["ResolveTemplate"]=this.$$d_$8_4;a["ListData"]=b;a["CurrentItems"]=b;a["ClientControl"]=this;a["DataProvider"]=this.get_dataProvider();a["ScriptApplicationManager"]=Srch.ScriptApplicationManager.get_current();a["RenderCounts"]=this.$2_4;this.invokeClientRenderer(this.get_element(),a)}this.raiseResultRenderedEvent(new Srch.ResultEventArgs(this.get_currentResultTableCollection()))},scriptApplication_PreLoad:function(a,b){Srch.U.trace(this,"ScriptApplication_PreLoad","TaxonomyRefinement");this.get_delayLoadTemplateScripts()&&Srch.U.appendScriptsToLoad(this.serverTemplateScriptsToLoad,this.$1_4);Srch.DisplayControl.prototype.scriptApplication_PreLoad.call(this,a,b)},$8_4:function(a,c,b){if(b==="Item")return Srch.U.getRenderTemplateByName(this.$1_4,a);else return Srch.U.resolveRenderTemplate(a,c,b)},handleClickOnCategoryLink:function(c){for(var a=null,b=0;b<this.$0_4.length;b++){var d=this.$0_4[b];if(Srch.TaxonomyRefinementNodeInfo.$5(d)===c){a=d;break}}if(!a){Srch.U.traceFormatted(this,"HandleClickOnCategoryLink","Can't find TaxonomyRefinementNodeInfo for category '{0}'",c);return}var e=this.get_dataProvider().get_currentQueryState();e.s=1;Srch.ScriptApplicationManager.get_current().navigateTo(a.TopicPageUrl,true)}};Srch.TaxonomyRefinementNodeInfo=function(){};Srch.TaxonomyRefinementNodeInfo.$5=function(a){return a.Id.toString("D").toLowerCase()};Srch.TaxonomyRefinementNodeInfo.prototype={DisplayName:null,TopicPageUrl:null,TopicPageQueryString:null,Id:null};Srch.TaxonomyNodeSearchResult=function(a,b){this.count=b;this.displayName=a.DisplayName;this.topicPageUrl=a.TopicPageUrl;this.topicPageQueryString=a.TopicPageQueryString;this.id=Srch.TaxonomyRefinementNodeInfo.$5(a)};Srch.TaxonomyNodeSearchResult.prototype={count:0,displayName:null,topicPageUrl:null,topicPageQueryString:null,id:null};Srch.TaxonomyRefinement.registerClass("Srch.TaxonomyRefinement",Srch.DisplayControl);Srch.TaxonomyRefinementNodeInfo.registerClass("Srch.TaxonomyRefinementNodeInfo");Srch.TaxonomyNodeSearchResult.registerClass("Srch.TaxonomyNodeSearchResult");typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();NotifyScriptLoadedAndExecuteWaitingJobs("search.taxonomyrefinement.js")