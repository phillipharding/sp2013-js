function ULSQqP(){var a={};a.ULSTeamName="PerformancePoint Monitoring Service";a.ULSFileName="AnalyticReports.js";return a}Type.registerNamespace("PPSMA");PPSMA.AjaxOlapRenderRequestRecord=function(f,e,d,g,i,b,h,a,c){a:;this.TargetControlId=f;this.TargetControlType=e;this.OlapContextId=d;this.Height=g;this.Width=i;this.ReportLocation=b;this.Inputs=h;this.NavigationAction=a;this.ViewProperties=c};PPSMA.AjaxOlapMetadataRequestRecord=function(f,e,d,a,c,b){a:;this.TargetControlId=f;this.TargetControlType=e;this.OlapContextId=d;this.MetadataContextId=a;this.ReportLocation=c;this.MetadataAction=b};PPSMA.SubMenuType=function(){};PPSMA.SubMenuType.prototype={DrillDownTo:0,AddActions:1};PPSMA.SubMenuType.registerEnum("PPSMA.SubMenuType",false);PPSMA.MenuMetadataTypes=function(){};PPSMA.MenuMetadataTypes.prototype={None:0,CellActions:1,MeasureData:2,DimensionData:3};PPSMA.MenuMetadataTypes.registerEnum("PPSMA.MenuMetadataTypes",false);PPSMA.OlapReportType=function(){};PPSMA.OlapReportType.prototype={Grid:0,ColumnChart:1,ColumnChartStacked:2,ColumnChartStacked100:3,LineChart:4,LineChartWithMarkers:5,PieChart:6,BarChart:7,BarChartStacked:8,BarChartStacked100:9};PPSMA.OlapReportType.registerEnum("PPSMA.OlapReportType",false);PPSMA.OlapView=function(){};PPSMA.OlapView.registerInterface("PPSMA.OlapView");PPSMA.Dimension=function(b,a,c){a:;this.$1_0=b;this.$B_0=a;this.$16_0=c};PPSMA.Dimension.prototype={$1_0:null,$B_0:null,$16_0:0,$1z_0:null,$1r_0:null,get_name:function(){a:;return this.$1_0},get_caption:function(){a:;return this.$B_0},get_dimensionType:function(){a:;return this.$16_0},get_userDefinedHierarchies:function(){a:;return this.$1z_0},get_attributeHierarchies:function(){a:;return this.$1r_0},createUserDefinedHierarchies:function(a){a:;this.$1z_0=new Array(a);return this.$1z_0},createAttributeHierarchies:function(a){a:;this.$1r_0=new Array(a);return this.$1r_0}};PPSMA.DimensionProperties=function(d,c,a){a:;this.$1o_0=d;this.$2b_0=c;this.$A_0=a;this.$L_0=new Array(a+1);this.$z_0=new Array(a+1);this.$Y_0=new Array(a+1);for(var b=0;b<a+1;b++)this.$Y_0[b]=false};PPSMA.DimensionProperties.prototype={$1o_0:null,$2b_0:null,$A_0:0,$L_0:null,$z_0:null,$Y_0:null,$27_0:null,get_name:function(){a:;return this.$1o_0},get_caption:function(){a:;return this.$2b_0},get_enabledCount:function(){a:;for(var b=0,a=0;a<this.$A_0;a++)if(this.$Y_0[a])++b;return b},get_count:function(){a:;return this.$A_0},get_captions:function(){a:;return this.$z_0},get_names:function(){a:;return this.$L_0},get_checked:function(){a:;return this.$Y_0},get_noPropertiesMessage:function(){a:;return this.$27_0},set_noPropertiesMessage:function(a){a:;this.$27_0=a;return a}};PPSMA.Hierarchy=function(b,a,c){a:;this.$1_0=b;this.$B_0=a;this.$16_0=c;if(this.$16_0!==1)this.$16_0=0};PPSMA.Hierarchy.prototype={$1_0:null,$B_0:null,$v_0:null,$16_0:0,get_hierarchyType:function(){a:;return this.$16_0},get_name:function(){a:;return this.$1_0},get_caption:function(){a:;return this.$B_0},get_levels:function(){a:;return this.$v_0},createLevels:function(a){a:;this.$v_0=new Array(a);return this.$v_0}};PPSMA.Level=function(c,a,b){a:;this.$1_0=c;this.$B_0=a;this.$4C_0=b};PPSMA.Level.prototype={$1_0:null,$B_0:null,$4C_0:0,get_name:function(){a:;return this.$1_0},get_caption:function(){a:;return this.$B_0},get_index:function(){a:;return this.$4C_0}};PPSMA.ResultHierarchy=function(f,d,b,c,a,e){a:;this.$1_0=f;this.$2Q_0=d;this.$2E_0=b;this.$4A_0=c;this.$38_0=a;this.$1a_0=false;this.$1Q_0=null;this.$2F_0=e;this.$2O_0=false};PPSMA.ResultHierarchy.prototype={$1_0:null,$2Q_0:false,$2E_0:0,$4A_0:0,$38_0:null,$1a_0:false,$1Q_0:null,$2F_0:null,$2O_0:false,get_name:function(){a:;return this.$1_0},get_dimension:function(){a:;return this.$2F_0},get_isSingleton:function(){a:;return this.$2Q_0},get_deepestLevel:function(){a:;return this.$2E_0},get_highestLevel:function(){a:;return this.$4A_0},get_highestLevelName:function(){a:;return this.$38_0},get_isAggregated:function(){a:;return this.$1a_0},set_isAggregated:function(a){a:;this.$1a_0=a;return a},get_isCalculated:function(){a:;return this.$2O_0},set_isCalculated:function(a){a:;this.$2O_0=a;return a},createMemberProperties:function(b,a){a:;if(!this.$1Q_0)this.$1Q_0=new PPSMA.ResultMemberProperties(b,a)},get_memberProperties:function(){a:;return this.$1Q_0}};PPSMA.ResultMemberProperties=function(a,b){a:;this.$1o_0=a;this.$28_0=b;this.$L_0=new Array(this.$28_0);this.$z_0=new Array(this.$28_0);this.$1m_0=new Array(this.$28_0);this.$A_0=0};PPSMA.ResultMemberProperties.prototype={$1o_0:null,$A_0:0,$L_0:null,$z_0:null,$1m_0:null,$28_0:0,createProperty:function(b,a){a:;this.$L_0[this.$A_0]=b;this.$z_0[this.$A_0]=a;this.$1m_0[this.$A_0]=true;++this.$A_0},hide:function(b){a:;for(var a=0;a<this.$A_0;a++)if(this.$L_0[a]===b){this.$1m_0[a]=false;break}},isPropertyHidden:function(b){a:;for(var a=0;a<this.$A_0;a++)if(this.$L_0[a]===b)return this.$1m_0[a]?false:true;return true},get_numPropertiesHidden:function(){a:;for(var b=0,a=0;a<this.$A_0;a++)if(!this.$1m_0[a])++b;return b},get_count:function(){a:;return this.$A_0},get_name:function(){a:;return this.$1o_0},get_captions:function(){a:;return this.$z_0},get_names:function(){a:;return this.$L_0}};PPSMA.Results=function(d,b,a,c){a:;this.$E_0=new Array(0);this.$m_0=new Array(0);this.$14_0=new Array(0);this.$2V_0=d;this.$2D_0=b;this.$1s_0=a;this.$1N_0=c;this.$2z_0=0;this.$3I_0=0;this.$3K_0=null;this.$3L_0="nosort";this.$3M_0="nosort";this.$3H_0=0;this.$3J_0=0;this.$3V_0=0;this.$3Y_0=0;this.$3P_0=0;this.$3Q_0=0;this.$3W_0="";this.$3X_0=""};PPSMA.Results.prototype={$3S_0:false,$4P_0:0,$w_0:null,$3r_0:0,$u_0:null,$40_0:0,$15_0:null,$2V_0:0,$2D_0:0,$1s_0:false,$1N_0:false,$2z_0:0,$3I_0:0,$3K_0:null,$3L_0:null,$3M_0:null,$3H_0:0,$3J_0:0,$3V_0:0,$3Y_0:0,$3P_0:0,$3Q_0:0,$3W_0:null,$3X_0:null,get_rowMembers:function(){a:;return this.$w_0},get_columnMembers:function(){a:;return this.$u_0},get_filterMembers:function(){a:;return this.$15_0},get_rowHierarchies:function(){a:;return this.$E_0},get_columnHierarchies:function(){a:;return this.$m_0},get_filterHierarchies:function(){a:;return this.$14_0},get_rowCount:function(){a:;return this.$2V_0},get_columnCount:function(){a:;return this.$2D_0},get_canNavigate:function(){a:;return this.$1s_0},get_isDesigner:function(){a:;return this.$1N_0},get_filterEmptyAxis:function(){a:;return this.$2z_0},set_filterEmptyAxis:function(a){a:;this.$2z_0=a;return a},get_sortedAxes:function(){a:;return this.$3I_0},set_sortedAxes:function(a){a:;this.$3I_0=a;return a},get_sortTuple:function(){a:;return this.$3K_0},set_sortTuple:function(a){a:;this.$3K_0=a;return a},get_sortTypeCol:function(){a:;return this.$3L_0},set_sortTypeCol:function(a){a:;this.$3L_0=a;return a},get_sortTypeRow:function(){a:;return this.$3M_0},set_sortTypeRow:function(a){a:;this.$3M_0=a;return a},get_sortColIndex:function(){a:;return this.$3H_0},set_sortColIndex:function(a){a:;this.$3H_0=a;return a},get_sortRowIndex:function(){a:;return this.$3J_0},set_sortRowIndex:function(a){a:;this.$3J_0=a;return a},get_unknownFilterParameters:function(){a:;return this.$3S_0},set_unknownFilterParameters:function(a){a:;this.$3S_0=a;return a},get_valueFilterCol:function(){a:;return this.$3V_0},set_valueFilterCol:function(a){a:;this.$3V_0=a;return a},get_valueFilterRow:function(){a:;return this.$3Y_0},set_valueFilterRow:function(a){a:;this.$3Y_0=a;return a},get_valueFilterParamsCol:function(){a:;return this.$3W_0},set_valueFilterParamsCol:function(a){a:;this.$3W_0=a;return a},get_valueFilterParamsRow:function(){a:;return this.$3X_0},set_valueFilterParamsRow:function(a){a:;this.$3X_0=a;return a},get_topFilterCol:function(){a:;return this.$3P_0},set_topFilterCol:function(a){a:;this.$3P_0=a;return a},get_topFilterRow:function(){a:;return this.$3Q_0},set_topFilterRow:function(a){a:;this.$3Q_0=a;return a},createRowMembers:function(b){a:;this.$4P_0=b;this.$E_0=new Array(b);this.$w_0=new Array(this.$2V_0);for(var a=0;a<this.$2V_0;a++)this.$w_0[a]=new Array(this.$4P_0);return this.$w_0},createColumnMembers:function(b){a:;this.$3r_0=b;this.$m_0=new Array(b);this.$u_0=new Array(this.$2D_0);for(var a=0;a<this.$2D_0;a++)this.$u_0[a]=new Array(this.$3r_0);return this.$u_0},createFilterMembers:function(a){a:;this.$40_0=a;this.$14_0=new Array(a);this.$15_0=new Array(this.$40_0);return this.$15_0}};PPSMA.Member=function(h,e,f,a,d,c,b,g){a:;this.$4B_0=h;this.$1_0=e;this.$B_0=f;this.$3C_0=a;this.$3D_0=d;this.$36_0=c;this.$1t_0=b;this.$2H_0=g};PPSMA.Member.prototype={$4B_0:null,$1_0:null,$B_0:null,$3C_0:null,$3D_0:0,$36_0:false,$1t_0:false,$2H_0:false,get_id:function(){a:;return this.$4B_0},get_name:function(){a:;return this.$1_0},get_caption:function(){a:;return this.$B_0},get_levelName:function(){a:;return this.$3C_0},get_levelNumber:function(){a:;return this.$3D_0},get_hasParent:function(){a:;return this.$36_0},get_hasChildren:function(){a:;return this.$1t_0},get_drilledDown:function(){a:;return this.$2H_0},set_drilledDown:function(a){a:;this.$2H_0=a;return a}};PPSMA.ReportsCommon=function(){};PPSMA.ReportsCommon.getCellTypeId=function(b){a:;var c="\0";if(b){var a=b.getAttribute("id");if(a&&a.length>=5){var d=a.charAt(0);switch(d){case "R":case "C":case "D":case "P":case "Z":case "Y":c=d}}}return c};PPSMA.ReportsCommon.logErrorCondition=function(){};PPSMA.ReportsCommon.getHeaderCellHierarchy=function(d,a){a:;var b=null;if(a){var e=PPSMA.ReportsCommon.getCellRowPosition(a),f=PPSMA.ReportsCommon.getCellColumnPosition(a);if(e!==-1&&f!==-1){var g=PPSMA.ReportsCommon.getCellTypeId(a),c;switch(g){case "Z":case "Y":c=d.$8_0.$E_0;b=c[e];break;case "R":c=d.$8_0.$E_0;b=c[f];break;case "C":var h=d.$8_0.$m_0;b=h[e]}}}return b};PPSMA.ReportsCommon.getCellRowPosition=function(d){a:;var e=-1;if(d){var a=d.getAttribute("id");if(a&&a.length>=5){var b=a.match(new RegExp("R[0-9]+","g"));if(b&&b.length>=1){var c=b[0];if(c.length>=1)e=parseInt(c.substring(1,c.length))}}}return e};PPSMA.ReportsCommon.getSortedCellColumnPosition=function(a){a:;var c=PPSMA.ReportsCommon.getCellTypeId(a),b=PPSMA.ReportsCommon.getCellColumnPosition(a);if(c==="C"){var d=a;b=b-(d.colSpan-1)}return b};PPSMA.ReportsCommon.getCellColumnPosition=function(d){a:;var e=-1;if(d){var a=d.getAttribute("id");if(a&&a.length>=5){var b=a.match(new RegExp("C[0-9]+","g"));if(b&&b.length>=1){var c=b[0];if(c.length>=1)e=parseInt(c.substring(1,c.length))}}}return e};PPSMA.DialogsCommon=function(){};PPSMA.DialogsCommon.addDialogResizeEventHandlers=function(e,d){a:;try{e&&$addHandler(window,"resize",e)}catch(f){return false}var a=document.getElementsByTagName("a");if(!a)return false;for(var b=0;b<a.length;b++){var c=a[b];if(PPSMA.DomElementEx.tagsMatch(c.tagName,"a")&&c.className==="ms-dlgCloseBtn"&&d){$addHandler(c,"click",d);return true}}return false};PPSMA.DialogsCommon.removeWindowResizeEventHandler=function(a){a:;try{$removeHandler(window,"resize",a);return true}catch(b){return false}};PPSMA.DialogsCommon.getDlgFrameContainerDiv=function(){a:;for(var c=document.getElementsByTagName("div"),a=0;a<c.length;a++){var b=c[a];if(Sys.UI.DomElement.containsCssClass(b,"ms-dlgframecontainer")||Sys.UI.DomElement.containsCssClass(b,"ms-dlgFrameContainer"))return b}return null};PPSMA.DialogsCommon.getDlgTitleDiv=function(){a:;for(var c=document.getElementsByTagName("div"),a=0;a<c.length;a++){var b=c[a];if(Sys.UI.DomElement.containsCssClass(b,"ms-dlgtitle")||Sys.UI.DomElement.containsCssClass(b,"ms-dlgTitle"))return b}return null};PPSMA.ContextMenu=function(){};PPSMA.ContextMenu.createForReportsNScorecards=function(a,e,b,c,d){a:;if(isNaN(b))b=0;if(isNaN(c))c=0;var f=!!a&&PPSMA.DomElementEx.tagsMatch(a.tagName,"a")&&a.id.startsWith(PPSMA.ContextMenu.$4c);if(PPSMA.ContextMenu.isMenuOn()&&PPSMA.ContextMenu.get_menuType()!=="tooltip")return false;PPSMA.ContextMenu.$1v();if(!a||PPSMA.DomElementEx.tagsMatch(a.tagName,"a")&&!d&&!f)return false;return PPSMA.ContextMenu.$3u(a,e,b,c,"menu")};PPSMA.ContextMenu.createForParameterTree=function(a,d,b,c){a:;if(PPSMA.ContextMenu.isMenuOn()&&PPSMA.ContextMenu.get_menuType()!=="tooltip")return false;PPSMA.ContextMenu.$1v();return PPSMA.ContextMenu.$52(a,d,b,c,"menu")};PPSMA.ContextMenu.createTooltip=function(b,a,c,d){a:;if(PPSMA.ContextMenu.isMenuOn()&&PPSMA.ContextMenu.get_menuType()!=="tooltip")return false;PPSMA.ContextMenu.$1v();return PPSMA.ContextMenu.$3u(b,a,c,d,"tooltip")};PPSMA.ContextMenu.get_menuType=function(){a:;return PPSMA.Menu.GetType(PPSMA.ContextMenu.$j)};PPSMA.ContextMenu.isMenuOn=function(){a:;return PPSMA.Menu.IsOpen(PPSMA.ContextMenu.$j)};PPSMA.ContextMenu.addMenuSeparator=function(b){a:;var a=PPSMA.ContextMenu.$54();if(!a)return null;PPSMA.ContextMenu.$13(b,a);return a};PPSMA.ContextMenu.addSubMenu=function(e,b,c,d){a:;var a=PPSMA.ContextMenu.$3z(b,null,null,null,c,d);if(!a)return null;PPSMA.ContextMenu.$13(e,a);return a};PPSMA.ContextMenu.addDynamicSubMenu=function(g,e,d,c,b,f){a:;var a=PPSMA.ContextMenu.$3z(e,d,c,b,null,f);if(!a)return null;PPSMA.ContextMenu.$13(g,a);return a};PPSMA.ContextMenu.addToggleMenuOption=function(h,f,b,c,e,d,g){a:;var a=PPSMA.ContextMenu.$3w(f,b,c,e,d,true,g);if(!a)return null;PPSMA.ContextMenu.$13(h,a);return a};PPSMA.ContextMenu.addMenuOption=function(h,f,b,c,e,d,g){a:;var a=PPSMA.ContextMenu.$3w(f,b,c,e,d,false,g);if(!a)return null;PPSMA.ContextMenu.$13(h,a);return a};PPSMA.ContextMenu.addDisabledMenuOption=function(e,c,f,b,d){a:;var a=PPSMA.ContextMenu.$4z(c,b,"",d);if(!a)return null;PPSMA.ContextMenu.$13(e,a);return a};PPSMA.ContextMenu.addMenuItem=function(c,b){a:;var a=PPSMA.ContextMenu.$1X(b);if(!a)return null;PPSMA.ContextMenu.$13(c,a);return a};PPSMA.ContextMenu.removeAllButFirst=function(a){a:;while(a.childNodes.length>1)a.removeChild(a.lastChild)};PPSMA.ContextMenu.refreshMenu=function(a,b){a:;PPSMA.ContextMenu.isMenuOn()&&PPSMA.Menu.Refresh(PPSMA.ContextMenu.$j,a,b)};PPSMA.ContextMenu.neutralizeBrowserMenu=function(a){a:;a.rawEvent.cancelBubble=true;a.rawEvent.returnValue=false;a.preventDefault();a.stopPropagation()};PPSMA.ContextMenu.$1v=function(){a:;PPSMA.ContextMenu.$j=null;PPSMA.ContextMenu.$i=null};PPSMA.ContextMenu.$3u=function(a,d,e,f,b){if(PPSMA.DomElementEx.tagsMatch(a.tagName,"span"))PPSMA.ContextMenu.$i=a.parentNode;else if(PPSMA.DomElementEx.tagsMatch(a.tagName,"strong"))PPSMA.ContextMenu.$i=a.parentNode.parentNode;else PPSMA.ContextMenu.$i=a;var c=PPSMA.ContextMenu.$i.getAttribute("ID");PPSMA.ContextMenu.$j=PPSMA.ContextMenu.$3v(c+"_"+b,b);if(!d.addPrimaryMenuItems(PPSMA.ContextMenu.$j)){PPSMA.ContextMenu.$1v();return false}PPSMA.ContextMenu.$4K(PPSMA.ContextMenu.$j,PPSMA.ContextMenu.$i,true,false,e,f);return true};PPSMA.ContextMenu.$52=function(b,c,d,e,a){PPSMA.ContextMenu.$i=b;PPSMA.ContextMenu.$j=PPSMA.ContextMenu.$3v(PPSMA.ContextMenu.$i.id+"_"+a,a);if(!c(PPSMA.ContextMenu.$j,PPSMA.ContextMenu.$i)){PPSMA.ContextMenu.$1v();return false}PPSMA.ContextMenu.$4K(PPSMA.ContextMenu.$j,PPSMA.ContextMenu.$i,true,false,d,e);return true};PPSMA.ContextMenu.$4K=function(a,b,c,d,e,f){if(a)!PPSMA.Menu.IsOpen(a)&&PPSMA.Menu.Show(a,b,c,d,e,f)};PPSMA.ContextMenu.$2p=function(a,b,c){if(!a)return;!isNullOrEmpty(b)&&a.setAttribute("iconSrc",b);!isNullOrEmpty(c)&&a.setAttribute("iconAltText",c)};PPSMA.ContextMenu.$13=function(a,b){a&&b&&a.appendChild(b)};PPSMA.ContextMenu.$3v=function(b,c){var a=$get(b);if(a){a._initialized=false;a._oContents=null;a.innerHTML="";return a}a=document.createElement("MENU");if(!a)return null;if(!isNullOrEmpty(b))a.id=b;a.className="bsm-SrvMenuUI";a._menuType=c;PPSMA.ContextMenu.$13(document.body,a);return a};PPSMA.ContextMenu.$3w=function(d,e,c,f,g,h,i){var a=PPSMA.ContextMenu.$1X("option");if(!a)return null;PPSMA.DomElementEx.setInnerText(a,d);i&&a.setAttribute("indent","true");var b=e;if(g&&!isNullOrEmpty(c)){a.setAttribute("selected","true");if(!h)b=""}a.setAttribute("onMenuClick",b);PPSMA.ContextMenu.$2p(a,c,f);return a};PPSMA.ContextMenu.$4z=function(b,c,d,e){var a=PPSMA.ContextMenu.$1X("option");if(!a)return null;PPSMA.DomElementEx.setInnerText(a,b);a.setAttribute("enabled","false");e&&a.setAttribute("indent","true");PPSMA.ContextMenu.$2p(a,c,d);return a};PPSMA.ContextMenu.$54=function(){a:;var a=PPSMA.ContextMenu.$1X("separator");PPSMA.DomElementEx.setInnerText(a,"");return a};PPSMA.ContextMenu.$1X=function(b){var a=document.createElement("SPAN");if(!a)return null;a.setAttribute("type",b);return a};PPSMA.ContextMenu.$3z=function(f,b,c,d,g,h){var a=PPSMA.ContextMenu.$1X("submenu");if(!a)return null;h&&a.setAttribute("indent","true");PPSMA.ContextMenu.$2p(a,g,null);!isNullOrEmpty(b)&&a.setAttribute("onfetch",b);!isNullOrEmpty(c)&&a.setAttribute("onpopulate",c);!isNullOrEmpty(d)&&a.setAttribute("onhoveroff",d);var e=PPSMA.ContextMenu.$53(f);PPSMA.ContextMenu.$13(a,e);return a};PPSMA.ContextMenu.$53=function(b){var a=PPSMA.ContextMenu.$1X("label");if(!a)return null;PPSMA.DomElementEx.setInnerText(a,b);return a};PPSMA.ShowProperties=function(b,a){a:;this.$$d_$2s_0=Function.createDelegate(this,this.$2s_0);this.$$d_inputClick=Function.createDelegate(this,this.inputClick);this.$$d_cancel=Function.createDelegate(this,this.cancel);this.$$d_apply=Function.createDelegate(this,this.apply);this.$$d_selectAll=Function.createDelegate(this,this.selectAll);this.$$d_$5S_0=Function.createDelegate(this,this.$5S_0);this.$$d_$5U_0=Function.createDelegate(this,this.$5U_0);this.$$d_$4L_0=Function.createDelegate(this,this.$4L_0);this.$4h_0=b;this.$0_0=a;this.$1K_0=null;this.$1l_0=-1};PPSMA.ShowProperties.prototype={$4h_0:null,$0_0:null,$1K_0:null,$1l_0:0,$1n_0:null,$1V_0:null,$1E_0:null,$x_0:null,$1W_0:null,$f_0:null,get_selectedButton:function(){a:;return this.$f_0},setCallbackMethod:function(a){a:;this.$x_0=a},show:function(a){a:;this.$1K_0=a;this.$5Y_0();this.$5q_0();this.$4r_0()},getTotalMemberPropertyCount:function(){a:;if(this.$1l_0===-1){this.$1l_0=0;var a=this.$0_0.$8_0.$E_0;if(a)for(var b=0;b<a.length;b++){var c=a[b].$1_0,d=this.$2M_0(c);this.$1l_0+=d.$A_0}}return this.$1l_0},isEnabled:function(b){a:;var a=this.$1Z_0(b);if(!a)return true;if(a.$1_0===this.$0_0.$1P_0)return false;else return true},$5q_0:function(){a:;var a=this.$1Z_0(this.$1K_0);if(a){this.$1n_0=a.$1_0;if(!this.$0_0.getDimensionPropertiesList(a.$1_0))this.$0_0.getDimensionProperties(this.$48_0(),this.$$d_$4L_0);else this.$4L_0(true)}},$4L_0:function(a){if(this.$0_0.$1Y_0&&a)if(this.$4l_0()){this.$61_0();this.setInitialFocus();this.$0_0.notifyBrowserOfAsyncUpdate($get(this.$0_0.$3_0+"_ShowPropertiesDiv"))}else this.$1E_0.close(0);else this.$0_0.getDimensionProperties(this.$48_0(),this.$$d_$4L_0)},setInitialFocus:function(){a:;var a=$get(this.$0_0.$3_0+"_DimPropertiesDiv");if(a&&a.firstChild&&a.firstChild.firstChild)a.firstChild.firstChild.focus();else PPSMA.ReportsCommon.logErrorCondition("ShowProperties: can't set initial focus.")},inputClick:function(m){a:;var i=$get(this.$0_0.$3_0+"_DimPropertiesDiv"),a=i.getElementsByTagName("input"),j=this.$1Z_0(this.$1K_0).$1_0,k=this.$0_0.getDimensionPropertiesList(j),d=k.$Y_0,c=PPSMA.EventsEx.getCurrentElement(m.rawEvent);if(c.className==="ms-bishowproperties-checkbox"){var e=c.id,f=parseInt(e.substr(this.$0_0.$3_0.length+17,e.length));a[f].checked=!a[f].checked}else if(c.className==="ms-bishowproperties-checkboxlabel"){var g=c.id,h=parseInt(g.substr(this.$0_0.$3_0.length+14,g.length));a[h].checked=!a[h].checked}for(var b=0;b<a.length;++b){var l=a[b];if(!l.checked)d[b]=false;else d[b]=true}},selectAll:function(){a:;for(var e=$get(this.$0_0.$3_0+"_DimPropertiesDiv"),c=e.getElementsByTagName("input"),b=$get(this.$0_0.$3_0+"_propSelectAll"),f=this.$1Z_0(this.$1K_0).$1_0,g=this.$0_0.getDimensionPropertiesList(f),h=g.$Y_0,a=0;a<c.length;++a){var d=c[a];if(d.checked!==b.checked){d.checked=b.checked;h[a]=b.checked}}},handleHidePropertyMenuClick:function(e,d){a:;if(!this.get_$4x_0())return;var b=this.$0_0.getDimensionPropertiesList(e);if(b){for(var j=b.$L_0,f=b.$Y_0,a=0;a<b.$A_0;a++)if(j[a]===d&&f[a]){f[a]=false;break}}else for(var g=this.$0_0.$8_0.$E_0,c=0;c<g.length;c++){var h=g[c];if(h.$1_0===e){var i=h.$1Q_0;if(i){i.hide(d);break}}}this.$0_0.applyDimensionProperties()},apply:function(){a:;var a=this.$1Z_0(this.$1K_0);if(!a||isNullUndefinedOrEmpty(a.$1_0)||!this.$5Z_0(a.$1_0)){this.$1E_0.close(0);return}var f=$get(this.$0_0.$3_0+"_ShowPropertiesDiv");f.style.display="none";var g=$get(this.$0_0.$3_0+"_DimPropertiesDiv"),d=g.getElementsByTagName("input"),c=this.$0_0.getDimensionPropertiesList(a.$1_0);if(c){for(var e=c.$Y_0,b=0;b<d.length;++b){var i=d[b];e[b]=i.checked}var h=$get(this.$0_0.$3_0+"_propSelectAll");e[c.$A_0]=h.checked}this.$0_0.applyDimensionProperties();this.$1E_0.close(1)},cancel:function(){a:;this.$1E_0.close(0)},$2s_0:function(b){this.$f_0="1";if(!b){this.$f_0="2";var a=this.$1Z_0(this.$1K_0);a&&!isNullUndefinedOrEmpty(a.$1_0)&&this.$5u_0(a.$1_0)}this.$5t_0();this.$x_0&&this.$x_0()},get_$4x_0:function(){a:;return this.$0_0.$8_0.$1s_0},$4r_0:function(){a:;this.$1W_0=this.$$d_$5U_0;!PPSMA.DialogsCommon.addDialogResizeEventHandlers(this.$1W_0,this.$$d_$5S_0)&&PPSMA.ReportsCommon.logErrorCondition("ShowProperties: couldn't add the resize event handlers");var a=$get(this.$0_0.$3_0+"_propSelectAll");a&&$addHandler(a,"click",this.$$d_selectAll);a=$get(this.$0_0.$3_0+"_propApply_");a&&$addHandler(a,"click",this.$$d_apply);a=$get(this.$0_0.$3_0+"_propCancel_");a&&$addHandler(a,"click",this.$$d_cancel);a=$get(this.$0_0.$3_0+"_DimPropertiesDiv");a&&$addHandler(a,"click",this.$$d_inputClick)},$5t_0:function(){a:;!PPSMA.DialogsCommon.removeWindowResizeEventHandler(this.$1W_0)&&PPSMA.ReportsCommon.logErrorCondition("ShowProperties: couldn't remove the resize event handlers");this.$1W_0=null},$5U_0:function(){},$5S_0:function(){},$1Z_0:function(c){var a=PPSMA.ReportsCommon.getCellTypeId(c),b=null;if(a==="R"||a==="Z"||a==="Y")b=PPSMA.ReportsCommon.getHeaderCellHierarchy(this.$0_0,c);else if(a==="P"){var d=this.$0_0.$8_0.$E_0,e=PPSMA.ReportsCommon.getCellColumnPosition(c);b=d[e]}return b},$5Y_0:function(){a:;var a=this.$0_0.$3_0,c=document.createElement("div");c.id=a+"_ShowPropertiesDiv";c.className="ms-bishowproperties-main";document.body.appendChild(c);var h=document.createElement("div");h.id=a+"_SelectedMemberNameTable";h.className="ms-bishowproperties-selectedmember";var n=document.createElement("span");n.id=a+"_gspanSelectedDimension";h.appendChild(n);c.appendChild(h);var m=document.createElement("div");m.id=a+"_DimPropertiesDiv";m.className="ms-bishowproperties-checkboxlist";c.appendChild(m);var e=document.createElement("div");e.id=a+"_ShowPropertiesFooter";e.className="ms-bishowproperties-footer";c.appendChild(e);var i=document.createElement("div");i.className="ms-bishowproperties-selectall";e.appendChild(i);var j=document.createElement("div");j.className="ms-bishowproperties-buttons";e.appendChild(j);var k=document.createElement("input");k.id=a+"_propSelectAll";k.setAttribute("type","checkbox");k.title=PPSMA.SR.OlapPropertiesDialog_SelectAll;i.appendChild(k);var d=document.createElement("label");d.id=a+"_propSelectAlllabel";d.setAttribute("for",a+"_propSelectAll");d.setAttribute("title",PPSMA.SR.OlapPropertiesDialog_SelectAll);d.className="ms-bishowproperties-checkboxlabel";d.innerHTML=PPSMA.SR.OlapPropertiesDialog_SelectAll;i.appendChild(d);var f=document.createElement("input");f.id=a+"_propApply_";Sys.UI.DomElement.addCssClass(f,"ms-bishowproperties-apply");f.type="button";j.appendChild(f);f.value=PPSMA.SR.OlapPropertiesDialog_Apply;var g=document.createElement("input");g.id=a+"_propCancel_";Sys.UI.DomElement.addCssClass(g,"ms-bishowproperties-cancel");g.type="button";j.appendChild(g);g.value=PPSMA.SR.OlapPropertiesDialog_Cancel;var l=document.createElement("div");l.className="ms-bishowproperties-positioningparent";l.appendChild(c);var o=PPSMA.SizeEx.getCenterXandY(PPSMA.ScriptConstants.defaultDialogWidth,PPSMA.ScriptConstants.defaultDialogHeight),b=new SP.UI.DialogOptions;b.height=PPSMA.ScriptConstants.defaultDialogHeight;b.width=PPSMA.ScriptConstants.defaultDialogWidth;b.title=PPSMA.SR.OlapPropertiesDialog_Title;b.allowMaximize=true;b.html=l;b.html.innerHTML=l.innerHTML;PPSMA.DomElementEx.removeElement(c);b.x=o.x;b.y=o.y;b.dialogReturnValueCallback=this.$$d_$2s_0;this.$1E_0=SP.UI.ModalDialog.showModalDialog(b)},$4l_0:function(){a:;var t=$get(this.$0_0.$3_0+"_ShowPropertiesDiv"),a,f=null,d=null,j=null,k;if(this.$0_0.$1Y_0){var q=PPSMA.XmlEx.loadXml(this.$0_0.$1Y_0),r=q.getElementsByTagName("DimensionProperties"),g=q.getElementsByTagName("DimProperty");k=r[0].getAttribute("caption");a=this.$0_0.addDimensionPropertiesList(this.$1n_0,k,g.length);a.$27_0=r[0].getAttribute("NoPropertiesMessage");if(g.length>0){var l=this.$2M_0(this.$1n_0),s=null;if(l)s=l.$L_0;f=a.$L_0;d=a.$z_0;j=a.$Y_0;for(var c=0;c<g.length;c++){f[c]=g[c].getAttribute("name");d[c]=g[c].getAttribute("caption");if(l)for(var n=0;n<l.$A_0;n++)if(s[n]===f[c])j[c]=true}}}else{a=this.$0_0.getDimensionPropertiesList(this.$1n_0);k=a.$2b_0;f=a.$L_0;d=a.$z_0;j=a.$Y_0}var u=$get(this.$0_0.$3_0+"_DimPropertiesDiv");if(a.$A_0>0){var v=PPSMA.DomElementEx.getChildElementById(t,this.$0_0.$3_0+"_SelectedMemberNameTable"),w=PPSMA.DomElementEx.getChildElementById(v,this.$0_0.$3_0+"_gspanSelectedDimension");w.innerHTML=String.format(PPSMA.SR.OlapPropertiesDialog_PropertiesCaption,k);var o=0;this.$1V_0=new Array(a.$A_0+1);for(var b=0;b<a.$A_0;b++){var p=this.$0_0.$3_0+"_inputPropCheckBox_"+b,y=this.$0_0.$3_0+"_divPropCheckBox_"+b,z=this.$0_0.$3_0+"_divPropLabel_"+b,h=document.createElement("div"),i=document.createElement("input"),e=document.createElement("label");h.id=y;h.className="ms-bishowproperties-checkbox";i.setAttribute("type","checkbox");i.setAttribute("title",d[b]);i.setAttribute("value",f[b]);i.setAttribute("id",p);e.setAttribute("for",p);e.setAttribute("title",d[b]);e.className="ms-bishowproperties-checkboxlabel";e.id=z;var m=d[b];if(m.length>100)m=m.substr(0,100)+PPSMA.SR.OlapPropertiesDialog_LongStringPadding;e.innerHTML="&nbsp;"+m;h.appendChild(i);h.appendChild(e);u.appendChild(h);if(j[b])this.$1V_0[o++]=p}var x=$get(this.$0_0.$3_0+"_propSelectAll");if(o===a.$A_0)this.$1V_0[o]=x.id;return true}alert(a.$27_0);return false},$61_0:function(){a:;for(var a=0;a<this.$1V_0.length;a++){if(isNullUndefinedOrEmpty(this.$1V_0[a]))break;var b=$get(this.$1V_0[a]);b.checked=true}},$48_0:function(){a:;var a=PPSMA.XmlEx.loadXml("<_dimProp />"),b=a.createElement("Dimension");a.documentElement.appendChild(b);b.setAttribute("name",this.$1n_0);return PPSMA.XmlEx.getXml(a.documentElement)},$2M_0:function(d){for(var b=this.$0_0.$8_0.$E_0,a=0;a<b.length;a++)if(b[a].$1_0===d){var c=b[a];return c.$1Q_0}return null},$5u_0:function(f){var c=this.$2M_0(f);if(c){var g=c.$L_0,b=this.$0_0.getDimensionPropertiesList(f);if(b)for(var h=b.$L_0,e=b.$Y_0,a=0;a<b.$A_0;a++){e[a]=false;for(var d=0;d<c.$A_0;d++)if(g[d]===h[a])e[a]=true}}},$5Z_0:function(h){var a=this.$2M_0(h),c=this.$0_0.getDimensionPropertiesList(h);if(c){if((!a||!a.$A_0)&&c.get_enabledCount()>0)return true;var d=null;if(a)d=a.$L_0;for(var i=c.$L_0,e=c.$Y_0,b=0;b<c.$A_0;b++)if(!a||!d){if(e[b])return true}else{for(var g=false,f=0;f<a.$A_0;f++)if(d[f]===i[b]){g=true;if(!e[b])return true}if(!g&&e[b])return true}}return false}};PPSMA.ThinFieldListItemSelectedEventArgs=function(b,c,a){a:;PPSMA.ThinFieldListItemSelectedEventArgs.initializeBase(this);this.itemUniqueName=b;this.itemCaption=c;this.itemIsSelected=a};PPSMA.ThinFieldListItemSelectedEventArgs.prototype={itemUniqueName:null,itemCaption:null,itemIsSelected:false};PPSMA.ThinFieldList=function(a,c,b){a:;this.$$d_$4y_0=Function.createDelegate(this,this.$4y_0);this.$$d_cancel=Function.createDelegate(this,this.cancel);this.$$d_apply=Function.createDelegate(this,this.apply);this.$$d_$4M_0=Function.createDelegate(this,this.$4M_0);this.$1A_0=new Sys.EventHandlerList;this.$0_0=a;this.$1j_0=false;this.$s_0=false;this.$0_0.$5_0.$S_0=this.$0_0.$3_0;this.$0_0.$5_0.$X_0=c;this.$0_0.$5_0.$c_0=b;this.$0_0.$5_0.$U_0=this.$0_0.$C_0;this.$0_0.$5_0.$W_0=this.$0_0.$39_0;this.$3h_0=this.$0_0.$3_0+"_ThinFieldListDiv";this.$3i_0=this.$0_0.$3_0+"_ULDisplayObjects"};PPSMA.ThinFieldList.prototype={$0_0:null,$1h_0:null,$1j_0:false,$s_0:false,$Q_0:null,$3h_0:null,$3i_0:null,resize:function(c,b){a:;var a=$get("_ScrollList");if(a)a.style.height=c+"px";this.$0_0.$5_0.resize(b)},showInChangeMeasure:function(){a:;this.show(null,$get("flId"))},show:function(b,a){a:;this.$1h_0=b;this.$Q_0=a;this.$5H_0(this.$0_0.$8_0);this.$65_0();if(!this.$0_0.$1O_0)this.$0_0.getMeasureGroups(this.$$d_$4M_0);else this.$4M_0(true)},reOrderItem:function(c,b){a:;if(!this.$s_0)return false;var a=this.$0_0.$5_0.getObjectByName(c);if(a)return this.$0_0.$5_0.setQueryOrder(a,b,this.$0_0.$3_0);return false},deSelectItem:function(a){a:;if(!this.$s_0)return false;var b=this.$0_0.$5_0.getObjectByName(a);if(this.$0_0.$5_0.deSelectObject(b)){this.$0_0.$5_0.$M_0=this.$0_0.$5_0.$M_0-1;return true}else return false},get_measuresLoaded:function(){a:;return this.$s_0},add_itemSelected:function(a){a:;this.$1A_0.addHandler("__ItemSelected__",a)},remove_itemSelected:function(a){a:;this.$1A_0.removeHandler("__ItemSelected__",a)},$1c_0:function(b,c,d){var a=this.$1A_0.getHandler("__ItemSelected__");a&&a(this,new PPSMA.ThinFieldListItemSelectedEventArgs(b,c,d))},$4M_0:function(a){this.$s_0=false;if(this.$0_0.$1O_0&&a){this.$s_0=this.$4o_0();if(!this.$s_0)this.$4a_0();else this.$0_0.notifyBrowserOfAsyncUpdate($get("_ScrollList"))}else this.$4a_0()},$4y_0:function(i){var g=PPSMA.EventsEx.getCurrentElement(i.rawEvent);if(!g)return;var c=g.parentNode,a=this.$0_0.$5_0.findMeasureOrKpiByID(c.id);if(!a){alert("Error. Unknown object was selected.");return}var b,d="",h=false;if(Object.getType(a).getName()==="PPSMA.Measure")b=!a.get_selected();else{h=a.get_selected();d=this.$0_0.$5_0.findKpiComponentID(c.id);b=!a.isComponentSelected(d)}if(!this.$0_0.$5_0.$X_0&&b)for(var e=0;e<this.$0_0.$5_0.$M_0;e++){var f=this.$0_0.$5_0.getSelectedMeasureOrKpiByOrder(e);if(f){this.$1c_0(f._uniqueName,f._displayCaption,false);break}}else this.$0_0.$5_0.$X_0&&h&&b&&this.$1c_0(a._uniqueName,a._displayCaption,false);this.$1c_0(a._uniqueName,a._displayCaption,b);this.$0_0.$5_0.componentClicked(a,c,d,b)},apply:function(){a:;if(this.$1j_0){var a=$get(this.$0_0.$3_0+"_ThinFieldListDiv");a.style.display="none";this.$3q_0();this.$0_0.applyMeasureSelectorChanges()}},cancel:function(){a:;if(this.$1j_0){var a=$get(this.$0_0.$3_0+"_ThinFieldListDiv");if(a)a.style.display="none";this.$3q_0()}},$3q_0:function(){a:;this.$1j_0=false},$4X_0:function(c){var b=c+"_propApply_",a=$get(b);a&&$addHandler(a,"click",this.$$d_apply);b=c+"_propCancel_";a=$get(b);a&&$addHandler(a,"click",this.$$d_cancel)},$5H_0:function(a){for(var e=false,b=0;b<a.$E_0.length;b++)if(a.$E_0[b].$1_0===this.$0_0.$1P_0){var f=a.$w_0;if(f)for(var g=0;g<f.length;g++){this.$1c_0(f[g][b].$1_0,f[g][b].$B_0,true);if(!this.$0_0.$5_0.$X_0)return;e=true}}if(e)return;for(var c=0;c<a.$m_0.length;c++)if(a.$m_0[c].$1_0===this.$0_0.$1P_0){var h=a.$u_0;if(h)for(var i=0;i<h.length;i++){this.$1c_0(h[i][c].$1_0,h[i][c].$B_0,true);if(!this.$0_0.$5_0.$X_0)return;e=true}}if(e)return;if(0===a.$E_0.length||0===a.$m_0.length)return;for(var d=0;d<a.$14_0.length;d++)if(a.$14_0[d].$1_0===this.$0_0.$1P_0){var j=a.$15_0;if(j){this.$1c_0(j[d].$1_0,j[d].$B_0,true);if(!this.$0_0.$5_0.$X_0)return}}},$5X_0:function(){a:;var j=true,g=this.$0_0.$3_0,a=$get(g+"_ThinFieldListDiv");if(a){if(!this.$Q_0)document.body.removeChild(a);else this.$Q_0.removeChild(a);this.$4X_0(g);j=false}a=document.createElement("div");a.id=this.$3h_0;var c=document.createElement("div");c.id=this.$0_0.$3_0+"MeasureGroupsDropDownSelectWrapperDiv";c.className="ms-bichangemeasures-selectgroupdiv";var h;if(!this.$Q_0){a.className="ms-bichangemeasures-thinfieldlistmaindiv";h=this.$0_0.$5_0.getMeasureGroupComboBoxHtml()}else h=this.$0_0.$5_0.getMeasureGroupComboBoxHtml();c.appendChild(h);a.appendChild(c);var d=document.createElement("div");d.id="_ScrollList";d.className="ms-bichangemeasures-scrolllist";var i=document.createElement("ul");i.id=this.$3i_0;i.className="ms-bichangemeasures-thinfieldlistitems";a.appendChild(d);d.appendChild(i);if(!this.$Q_0){var b=document.createElement("div");b.id=this.$0_0.$3_0+"_MeasureGroupsFooter";b.className="ms-bichangemeasures-thinfieldlistfooter";var e=document.createElement("A");e.id=this.$0_0.$3_0+"_propApply_";e.className="ms-bichangemeasures-thinfieldlistapply";e.innerHTML=PPSMA.SR.OlapPropertiesDialog_Apply;var f=document.createElement("A");f.id=this.$0_0.$3_0+"_propCancel_";f.className="ms-bichangemeasures-thinfieldlistcancel";f.innerHTML=PPSMA.SR.OlapPropertiesDialog_Cancel;b.appendChild(e);b.appendChild(f);a.appendChild(b)}if(!this.$Q_0)document.body.appendChild(a);else this.$Q_0.appendChild(a);this.$4X_0(g);return j},$4o_0:function(){a:;this.$5V_0();this.$5X_0();var b=$get(this.$0_0.$3_0+"_ULDisplayObjects");if(this.$0_0.$1O_0&&!this.$0_0.$5_0.get_haveData())var e=PPSMA.XmlEx.loadXml(this.$0_0.$1O_0),f=this.$0_0.$5_0.loadMeasuresFromXml(e);if(!this.$0_0.$5_0){alert("Measures is null");return false}this.$0_0.$5_0.setSelectedMeasuresFromResults(this.$0_0.$8_0);this.$0_0.$5_0.writeMeasureGroupComboBoxContents();if(this.$0_0.$5_0.get_displayObjectCount()>0){var a=$get(this.$0_0.$3_0+"_ThinFieldListDiv"),c=$get(this.$0_0.$3_0+"MeasureGroupsDropDownSelectWrapperDiv");if(!this.$Q_0)b.style.height=202-c.offsetHeight+"px";if(!a)return false;if(!this.$Q_0){a.style.width=210+"px";a.style.height=202+"px";a.style.left="0px";a.style.top="0px"}else a.style.display="block";!this.$Q_0&&this.$4Z_0(a,202+c.offsetHeight);this.$0_0.$5_0.writeDivOutputHtml(b,this.$$d_$4y_0);this.$4m_0(b);if(!this.$Q_0)if(this.$0_0.$5_0.$1I_0>210){a.style.width=this.$0_0.$5_0.$1I_0+"px";var d=$get("MeasureGroupsDropDownSelect");if(d)d.style.width=this.$0_0.$5_0.$1I_0+c.offsetWidth+"px"}}else return false;this.$1j_0=true;return true},$4m_0:function(d){for(var b=d.getElementsByTagName("a"),a=0;a<b.length;a++){var c=b[a];c.className==="ms-bichangemeasures-expandcollapseanchor"&&$addHandler(c,"click",this.$0_0.$5_0.$$d_handleExpandCollapseClick)}},$4Z_0:function(g,h){var a=PPSMA.SizeEx.getAbsoluteTop(this.$1h_0),b=PPSMA.SizeEx.getAbsoluteLeft(this.$1h_0),i=this.$1h_0.offsetWidth,j=this.$1h_0.offsetHeight,k=PPSMA.SizeEx.getClientHeight();if(a+h>k){a-=h;if(a<0)a=0}var d=PPSMA.SizeEx.getClientWidth();if(b+225>d){b=d-225;if(b<0)b=0}var e=0,f=0,c=$get(this.$0_0.$o_0);if(c){e=c.scrollLeft;f=c.scrollTop}g.style.left=b+i-e-10+"px";g.style.top=a+j-f-10+"px"},$65_0:function(){a:;var a=document.createElement("div");a.id=this.$0_0.$3_0+"_ThinFieldListLoadingDiv";a.className="ms-bichangemeasures-waiting";if(a){a.innerHTML=PPSMA.SR.OlapContextMenu_DynamicLoadText;if(!this.$Q_0){this.$4Z_0(a,202);document.body.appendChild(a)}else this.$Q_0.appendChild(a)}},$5V_0:function(){a:;var a=$get(this.$0_0.$3_0+"_ThinFieldListLoadingDiv");if(a)if(!this.$Q_0)document.body.removeChild(a);else this.$Q_0.removeChild(a)},$4a_0:function(){a:;var a=$get(this.$0_0.$3_0+"_ThinFieldListLoadingDiv");if(a)a.innerHTML=PPSMA.SR.OlapContextMenu_ErrorLoadingMeasures}};PPSMA.BaseMeasureKpi=function(){};PPSMA.BaseMeasureKpi.prototype={_resourcePath:null,_uniqueName:null,_displayCaption:null,_measureGroup:null,_hierarchyName:null,_description:null,_isVisible:false,_order:0,_index:0,$t_0:0,get_resourcePath:function(){a:;return this._resourcePath},set_resourcePath:function(a){a:;this._resourcePath=a;return a},get_visible:function(){a:;return this._isVisible},set_visible:function(a){a:;this._isVisible=a;return a},get_name:function(){a:;return this._uniqueName},set_name:function(a){a:;this._uniqueName=a;return a},get_index:function(){a:;return this._index},set_index:function(a){a:;this._index=a;return a},get_caption:function(){a:;return this._displayCaption},set_caption:function(a){a:;this._displayCaption=a;return a},get_measureGroupName:function(){a:;return this._measureGroup},set_measureGroupName:function(a){a:;this._measureGroup=a;return a},get_description:function(){a:;return this._description},set_description:function(a){a:;this._description=a;return a},get_order:function(){a:;return this._order},set_order:function(a){a:;this._order=a;return a},get_axisHierarchy:function(){a:;return this._hierarchyName},set_axisHierarchy:function(a){a:;this._hierarchyName=a;return a},get_offsetWidth:function(){a:;return this.$t_0},set_offsetWidth:function(a){a:;this.$t_0=a;return a}};PPSMA.Kpi=function(){a:;PPSMA.Kpi.initializeBase(this);this._isVisible=true;this.$e_1=true;this.$1F_1=new Array(4);for(var a=0;a<4;a++)this.$1F_1[a]=false};PPSMA.Kpi.prototype={$2C_1:null,$24_1:null,$29_1:null,$2A_1:null,$e_1:false,$1F_1:null,get_selected:function(){a:;for(var a=0;a<4;a++)if(this.$1F_1[a])return true;return false},set_selected:function(b){a:;if(!b)for(var a=0;a<4;a++)this.$1F_1[a]=false;return b},get_expanded:function(){a:;return this.$e_1},set_expanded:function(a){a:;this.$e_1=a;return a},get_uniqueId:function(){a:;return "_kli_K"+this._index.toString()},get_value:function(){a:;return this.$2C_1},set_value:function(a){a:;this.$2C_1=a;return a},get_goal:function(){a:;return this.$24_1},set_goal:function(a){a:;this.$24_1=a;return a},get_status:function(){a:;return this.$29_1},set_status:function(a){a:;this.$29_1=a;return a},get_trend:function(){a:;return this.$2A_1},set_trend:function(a){a:;this.$2A_1=a;return a},isComponentSelected:function(b){a:;var a=this.$47_1(b);if(a<0||a>=4)return false;return this.$1F_1[a]},writeDivOutputHtml:function(c,k,f,j,i,e){a:;var d=PPSMA.Measures.getKpiUniqueID(this,c)+"_F"+j.toString(),a=document.createElement("li"),g=document.createElement("a"),h=document.createElement("img");a.id=d;a.className="ms-bichangemeasures-thinfieldlistitems";a.style.listStyleType="none";g.setAttribute("href","#");$addHandler(g,"mouseup",i);h.setAttribute("alt",PPSMA.SR.OlapChangeMeasure_CollapseKpi);h.setAttribute("src",this._resourcePath+"pps_minus_stoplight.gif");h.setAttribute("border","0px");g.appendChild(h);a.appendChild(g);var l=window.document.createTextNode(this._displayCaption);a.appendChild(l);k.appendChild(a);this.$t_0=a.offsetWidth;var b=document.createElement("ul");this.$24_1&&this.$2Y_1(c,b,d,"Goal",PPSMA.SR.OlapChangeMeasure_KpiGoal,f,e);this.$2C_1&&this.$2Y_1(c,b,d,"Value",PPSMA.SR.OlapChangeMeasure_KpiValue,f,e);this.$29_1&&this.$2Y_1(c,b,d,"Status",PPSMA.SR.OlapChangeMeasure_KpiStatus,f,e);this.$2A_1&&this.$2Y_1(c,b,d,"Trend",PPSMA.SR.OlapChangeMeasure_KpiTrend,f,e);b.style.display="block";a.appendChild(b);return true},setVisibility:function(b,c){a:;var d=PPSMA.Measures.getKpiUniqueID(this,b)+"_F"+c.toString(),a=$get(d);if(!a)return false;if(!this._isVisible){a.style.display="none";return false}else{a.style.display="block";return true}},expandCollapse:function(a){a:;this.$4S_1(a,!this.$e_1)},setInputElemCheckValue:function(j,f,k,d,c){a:;var l=PPSMA.Measures.getKpiUniqueID(this,j)+"_F"+k.toString(),g=$get(l);if(g){var e=g.getElementsByTagName("input"),a=-1;if(d!==""){a=this.$47_1(d);if(a<0||a>=4)return;var h=e[a];if(h!==f)h.checked=c;this.$1F_1[a]=c}if(c||!c&&d==="")for(var b=0;b<e.length;b++){var i=e[b];if(b!==a&&i!==f){i.checked=false;this.$1F_1[b]=false}}}},$47_1:function(a){if(a==="Goal")return 0;else if(a==="Value")return 1;else if(a==="Status")return 2;else if(a==="Trend")return 3;else return -1},$2Y_1:function(n,i,j,f,k,l,g){var m=l.toString()+"px",c=this._displayCaption;if(this._description&&this._description.length>0){c+=" (";c+=this._description;c+=")"}var h=j+"_"+f,b=document.createElement("li"),a=document.createElement("input"),d=document.createElement("label");b.id=h;b.className="chgMeasTflListItem";b.style.listStyleType="none";b.setAttribute("title",c);a.setAttribute("type","checkbox");a.className="chgMeasTflListCheckBox";a.setAttribute("title",c);a.setAttribute("title",c);a.style.cursor="hand";a.setAttribute("value",f);$addHandler(a,"click",g);d.style.cursor="hand";$addHandler(d,"mouseup",g);var e=window.document.createTextNode(k);b.appendChild(a);b.appendChild(d);d.appendChild(e);i.appendChild(b);this.$t_0=e.offsetWidth},$4S_1:function(d,e){var f=d.getElementsByTagName("ul"),a=f[0];if(!a)return;if(!e){a.style.display="none";var g=d.getElementsByTagName("img"),b=g[0];if(b){b.setAttribute("alt",PPSMA.SR.OlapChangeMeasure_ExpandKpi);b.setAttribute("src",this._resourcePath+"pps_plus_stoplight.gif")}}else{a.style.display="block";var h=d.getElementsByTagName("img"),c=h[0];if(c){c.setAttribute("alt",PPSMA.SR.OlapChangeMeasure_CollapseKpi);c.setAttribute("src",this._resourcePath+"pps_minus_stoplight.gif")}}this.$e_1=e}};PPSMA.Measure=function(){a:;PPSMA.Measure.initializeBase(this);this._isVisible=true;this.$1e_1=false;this._order=-1};PPSMA.Measure.prototype={$1e_1:false,get_uniqueId:function(){a:;return "_mli_M"+this._index.toString()},get_selected:function(){a:;return this.$1e_1},set_selected:function(a){a:;this.$1e_1=a;return a},writeDivOutputHtml:function(h,e,l,i,k,f){a:;var j=PPSMA.Measures.getMeasureUniqueID(this,h)+"_F"+i.toString();if(!e.id.endsWith("_ULDisplayObjects"))e.style.paddingLeft="20px";else e.style.paddingLeft="0px";var d=this._displayCaption;if(this._description&&this._description.length>0){d+=" (";d+=this._description;d+=")"}var b=document.createElement("li"),a=document.createElement("input"),c=document.createElement("label");b.setAttribute("id",j);b.className="chgMeasTflListItem";b.style.listStyleType="none";b.setAttribute("title",d);a.setAttribute("title",d);a.setAttribute("type","checkbox");a.className="chgMeasTflListCheckBox";a.setAttribute("title",d);a.style.cursor="hand";a.setAttribute("value",this._uniqueName);$addHandler(a,"click",f);c.style.cursor="hand";$addHandler(c,"mouseup",f);var g=window.document.createTextNode(this._displayCaption);b.appendChild(a);b.appendChild(c);c.appendChild(g);c.style.paddingTop="2px";c.style.paddingLeft="4px";c.style.position="absolute";e.appendChild(b);if(this.$1e_1)a.checked=true;this.$t_0=g.offsetWidth;return true},setVisibility:function(b,c){a:;var d=PPSMA.Measures.getMeasureUniqueID(this,b)+"_F"+c.toString(),a=$get(d);if(!a)return false;if(!this._isVisible){a.style.display="none";return false}else{a.style.display="block";return true}},setInputElemCheckValue:function(d,e,f,i,a){a:;var g=PPSMA.Measures.getMeasureUniqueID(this,d)+"_F"+f.toString(),b=$get(g);if(b){var h=b.getElementsByTagName("input"),c=h[0];if(c!==e)c.checked=a}this.$1e_1=a}};PPSMA.Folder=function(c,b,a){a:;this.$e_0=true;this.$3e_0=b;this.$I_0=c;this.$1D_0=a;this.$F_0=[];this.$D_0=[]};PPSMA.Folder.addFolders=function(j,c,d,k,h,i){a:;if(!c||!c.length)return null;var b=null,e=[],l=c.split(";");if(l.length>1){for(var m=0;m<l.length;m++){b=PPSMA.Folder.addFolders(j,l[m],d,k,h,i);if(b)for(var n=0;n<b.length;n++)Array.add(e,b[n])}return e}var f=c.split("\\");if(!f.length)return null;var a=PPSMA.Folder.getChildFolder(j,f[0],-1);if(!a){a=new PPSMA.Folder(f[0],k,++PPSMA.Measures.folderCount);a.$U_0=h;a.$W_0=i;Array.add(j,a)}Array.add(e,a);if(f.length===1){var o=Object.getType(d);if(o.getName()==="PPSMA.Measure")a.addMeasure(d);else o.getName()==="PPSMA.Kpi"&&a.addKpi(d);return e}var p=c.indexOf("\\"),q=c.substring(p+1,c.length);b=PPSMA.Folder.addFolders(a.$F_0,q,d,k+1,h,i);if(b)for(var g=0;g<b.length;g++)!PPSMA.Folder.folderIsAlreadyInDisplay(a.$F_0,b[g])&&Array.add(a.$F_0,b[g]);return e};PPSMA.Folder.getChildFolder=function(a,f,c){a:;for(var d=0;d<a.length;d++){var b=a[d];if(c===-1){if(b.$I_0===f)return b}else if(b.$1D_0===c)return b}for(var e=0;e<a.length;e++){var h=a[e],g=PPSMA.Folder.getChildFolder(h.$F_0,f,c);if(g)return g}return null};PPSMA.Folder.folderIsAlreadyInDisplay=function(b,d){a:;for(var a=0;a<b.length;a++){var c=b[a],e=Object.getType(c);if(e.getName()==="PPSMA.Folder"){var f=c;if(f.$I_0===d.$I_0)return true}}return false};PPSMA.Folder.prototype={$F_0:null,$D_0:null,$I_0:null,$3e_0:0,$t_0:0,$e_0:false,$1D_0:0,$U_0:null,$W_0:null,get_resourcePath:function(){a:;return this.$U_0},set_resourcePath:function(a){a:;this.$U_0=a;return a},get_imagesPath:function(){a:;return this.$W_0},set_imagesPath:function(a){a:;this.$W_0=a;return a},get_expanded:function(){a:;return this.$e_0},set_expanded:function(a){a:;this.$e_0=a;return a},get_index:function(){a:;return this.$1D_0},set_index:function(a){a:;this.$1D_0=a;return a},get_uniqueId:function(){a:;return "_fli_F"+this.$1D_0},get_offsetWidth:function(){a:;return this.$t_0},set_offsetWidth:function(a){a:;this.$t_0=a;return a},get_childrenFolders:function(){a:;return this.$F_0},get_name:function(){a:;return this.$I_0},get_level:function(){a:;return this.$3e_0},expandCollapse:function(a){a:;this.$4S_0(a,!this.$e_0)},writeDivOutputHtml:function(i,f,n,m,l){a:;var p=PPSMA.Measures.getFolderUniqueID(this,i),a=document.createElement("li"),g=document.createElement("a"),c=document.createElement("img"),j=document.createElement("img");j.setAttribute("src",this.$W_0+"folder.gif");a.setAttribute("id",p);a.className="chgMeasTflListItem";a.style.listStyleType="none";a.style.paddingTop="3px";g.setAttribute("href","#");g.className="ms-bichangemeasures-expandcollapseanchor";c.className="ms-bichangemeasures-expandcollapseimage";j.className="ms-bichangemeasures-expandcollapsefolderimage";g.appendChild(c);a.appendChild(g);a.appendChild(j);var b=document.createElement("span");b.style.textIndent="0px";b.style.position="absolute";b.style.paddingTop="1px";b.style.paddingRight="2px";b.style.paddingBottom="2px";b.style.paddingLeft="5px";a.appendChild(b);f.appendChild(a);if(!f.id.endsWith("_ULDisplayObjects"))f.style.paddingLeft="20px";else f.style.paddingLeft="0px";this.$t_0=a.offsetWidth;for(var h=false,d=document.createElement("ul"),e=0;e<this.$D_0.length;e++)if(Object.getType(this.$D_0[e]).getName()!=="PPSMA.Folder"){this.$D_0[e].writeDivOutputHtml(i,d,n,this.$1D_0,m,l);if(this.$D_0[e].get_selected())h=true}for(var k=0;k<this.$F_0.length;k++){var q=this.$F_0[k];if(q.writeDivOutputHtml(i,d,n,m,l))h=true}a.appendChild(d);if(h){var o=document.createElement("B");b.appendChild(o);var r=window.document.createTextNode(this.$I_0);o.appendChild(r);c.setAttribute("alt",String.format(PPSMA.SR.OlapChangeMeasure_CollapseFolder,this.$I_0));c.setAttribute("title",String.format(PPSMA.SR.OlapChangeMeasure_CollapseFolder,this.$I_0));c.setAttribute("src",this.$W_0+"MDNExpanded.png");d.style.display="block";this.$e_0=true}else{var s=window.document.createTextNode(this.$I_0);b.appendChild(s);c.setAttribute("alt",String.format(PPSMA.SR.OlapChangeMeasure_ExpandFolder,this.$I_0));c.setAttribute("title",String.format(PPSMA.SR.OlapChangeMeasure_ExpandFolder,this.$I_0));c.setAttribute("src",this.$W_0+"MDNCollapsed.png");d.style.display="none";this.$e_0=false}return h},addMeasure:function(a){a:;!Array.contains(this.$D_0,a)&&Array.add(this.$D_0,a)},addKpi:function(a){a:;!Array.contains(this.$D_0,a)&&Array.add(this.$D_0,a)},sortDisplayObjects:function(){a:;for(var a=0;a<this.$D_0.length;a++)for(var b=0;b<this.$D_0.length;b++){var e=this.$D_0[a],f=this.$D_0[b];if(e._displayCaption.localeCompare(f._displayCaption)<0){var g=this.$D_0[b];this.$D_0[b]=this.$D_0[a];this.$D_0[a]=g;this.$D_0[b]._index=e._index;this.$D_0[a]._index=f._index}}for(var c=0;c<this.$F_0.length;c++)for(var d=0;d<this.$F_0.length;d++){var h=this.$F_0[c],i=this.$F_0[d];if(h.$I_0.localeCompare(i.$I_0)<0){var j=this.$F_0[d];this.$F_0[d]=this.$F_0[c];this.$F_0[c]=j}}},setMeasuresVisibility:function(b){a:;for(var a=false,c=0;c<this.$D_0.length;c++){var e=this.$D_0[c];if(e.setVisibility(b,this.$1D_0))a=true}for(var d=0;d<this.$F_0.length;d++){var f=this.$F_0[d];if(f.setMeasuresVisibility(b))a=true}this.$63_0(b,a);return a},$60_0:function(h,i){var c=PPSMA.Measures.getFolderUniqueID(this,h),d=$get(c),e=d.getElementsByTagName("span"),a=e[0];if(a){while(a.childNodes.length>0)a.removeChild(a.childNodes[0]);if(i){var b=document.createElement("B");a.appendChild(b);var f=window.document.createTextNode(this.$I_0);b.appendChild(f)}else{var g=window.document.createTextNode(this.$I_0);a.appendChild(g)}}},setInputElemCheckValue:function(c,e,a,d,f){a:;Array.contains(this.$D_0,c)&&c.setInputElemCheckValue(a,e,this.$1D_0,d,f);for(var b=0;b<this.$F_0.length;b++)this.$F_0[b].setInputElemCheckValue(c,e,a,d,f);this.checkForSelectedMeasuresAndKpis(a)},checkForSelectedMeasuresAndKpis:function(d){a:;for(var a=false,b=0;b<this.$D_0.length;b++){var e=this.$D_0[b];if(e.get_selected())a=true}for(var c=0;c<this.$F_0.length;c++){var f=this.$F_0[c];if(f.checkForSelectedMeasuresAndKpis(d))a=true}this.$60_0(d,a);return a},$4S_0:function(c,d){var e=c.getElementsByTagName("ul"),b=e[0];if(!b)return;var f=c.getElementsByTagName("img"),a=f[0];if(a){if(!b.id.endsWith("_ULDisplayObjects"))b.style.paddingLeft="20px";else b.style.paddingLeft="0px";if(!d){b.style.display="none";a.setAttribute("alt",String.format(PPSMA.SR.OlapChangeMeasure_ExpandFolder,this.$I_0));a.setAttribute("title",String.format(PPSMA.SR.OlapChangeMeasure_ExpandFolder,this.$I_0));a.setAttribute("src",this.$W_0+"MDNCollapsed.png")}else{b.style.display="block";a.setAttribute("alt",String.format(PPSMA.SR.OlapChangeMeasure_CollapseFolder,this.$I_0));a.setAttribute("title",String.format(PPSMA.SR.OlapChangeMeasure_CollapseFolder,this.$I_0));a.setAttribute("src",this.$W_0+"MDNExpanded.png")}}this.$e_0=d},$63_0:function(c,d){var b=PPSMA.Measures.getFolderUniqueID(this,c),a=$get(b);if(!a)return false;if(!d){a.style.display="none";return false}else{a.style.display="block";return true}}};PPSMA.Measures=function(){a:;this.$$d_$5e_0=Function.createDelegate(this,this.$5e_0);this.$$d_measureGroupComboBoxClick=Function.createDelegate(this,this.measureGroupComboBoxClick);this.$$d_handleExpandCollapseClick=Function.createDelegate(this,this.handleExpandCollapseClick);this.$1k_0=null;this.$N_0="none";this.$1J_0=0;this.$M_0=0;this.$1H_0=0;this.$1G_0=[];this.$1S_0=[];this.$4_0=[];this.$c_0=false;this.$X_0=true};PPSMA.Measures.getMeasureUniqueID=function(a,b){a:;if(!a)return "";return b+a.get_uniqueId()};PPSMA.Measures.getKpiUniqueID=function(a,b){a:;if(!a)return "";return b+a.get_uniqueId()};PPSMA.Measures.getFolderUniqueID=function(a,b){a:;if(!a)return "";return b+a.get_uniqueId()};PPSMA.Measures.prototype={$6_0:null,$9_0:null,$1J_0:0,$M_0:0,$1H_0:0,$N_0:null,$1G_0:null,$1S_0:null,$4_0:null,$1I_0:0,$S_0:null,$X_0:false,$c_0:false,$1k_0:null,$k_0:null,$T_0:null,$U_0:null,$W_0:null,$r_0:null,get_imagesPath:function(){a:;return this.$W_0},set_imagesPath:function(a){a:;this.$W_0=a;return a},get_resourcePath:function(){a:;return this.$U_0},set_resourcePath:function(a){a:;this.$U_0=a;return a},get_ctrlProxyId:function(){a:;return this.$S_0},set_ctrlProxyId:function(a){a:;this.$S_0=a;return a},get_multiSelectEnabled:function(){a:;return this.$X_0},set_multiSelectEnabled:function(a){a:;this.$X_0=a;return a},get_displayKpis:function(){a:;return this.$c_0},set_displayKpis:function(a){a:;this.$c_0=a;return a},get_selectedCount:function(){a:;return this.$M_0},set_selectedCount:function(a){a:;this.$M_0=a;return a},get_measureCount:function(){a:;return this.$1J_0},get_haveData:function(){a:;if(this.$1J_0>0||this.$1H_0>0)return true;else return false},get_kpiCount:function(){a:;return this.$1H_0},get_measureGroupName:function(){a:;if(this.$r_0&&this.$r_0!=="_ALL_")return this.$r_0;else return ""},set_measureGroupName:function(a){a:;this.$r_0=a;return a},get_axis:function(){a:;return this.$N_0},get_displayObjectCount:function(){a:;return this.$4_0.length},get_hierarchyCount:function(){a:;return this.$1G_0.length},get_labelOffsetWidth:function(){a:;return this.$1I_0},measureGroupDrowDownComboBoxID:null,getDisplayObject:function(a){a:;if(a>=0&&a<this.$4_0.length)return this.$4_0[a];return null},findMeasureOrKpiByID:function(b){a:;var a=this.findMeasureByID(b);if(a)return a;a=this.findKpiByID(b);if(a)return a;return null},findMeasureByID:function(b){a:;if(!this.$6_0)return null;for(var c=b.indexOf("_F"),d=b.substr(0,c),a=0;a<this.$6_0.length;a++){var e=this.$S_0+this.$6_0[a].get_uniqueId();if(e===d)return this.$6_0[a]}return null},findKpiComponentID:function(a){a:;if(!this.$c_0)return "";var b=a.indexOf("_F"),d=a.substr(0,b),c=a.indexOf("_",b+2);return a.substr(c+1,a.length)},findKpiByID:function(b){a:;if(!this.$c_0||!this.$9_0)return null;for(var c=b.indexOf("_F"),d=b.substr(0,c),a=0;a<this.$9_0.length;a++){var e=this.$S_0+this.$9_0[a].get_uniqueId();if(e===d)return this.$9_0[a]}return null},findFolderByID:function(a){a:;var b=a.indexOf("_F"),c=a.substring(b+2,a.length),d=parseInt(c);return PPSMA.Folder.getChildFolder(this.$1S_0,"",d)},setQueryOrder:function(a,b){a:;if(!this.$6_0)return false;if(!a)return false;if(!a.get_selected())return false;if(a._order===b)return false;if(a._order<b)for(var c=a._order+1;c<=b;c++){var e=this.getSelectedMeasureOrKpiByOrder(c);if(e)e._order=c-1}else for(var d=a._order-1;d>=b;d--){var f=this.getSelectedMeasureOrKpiByOrder(d);if(f)f._order=d+1}a._order=b;return true},getSelectedMeasureOrKpiByOrder:function(b){a:;var a=this.getSelectedMeasureByOrder(b);if(a)return a;a=this.getSelectedKpiByOrder(b);if(a)return a;return null},getSelectedMeasureByOrder:function(b){a:;for(var a=0;a<this.$6_0.length;a++)if(this.$6_0[a].get_selected()&&this.$6_0[a]._order===b)return this.$6_0[a];return null},getSelectedKpiByOrder:function(b){a:;if(!this.$c_0||!this.$9_0)return null;for(var a=0;a<this.$9_0.length;a++)if(this.$9_0[a].get_selected()&&this.$9_0[a]._order===b)return this.$9_0[a];return null},getObjectByName:function(a){a:;if(!this.$6_0)return null;var b=this.getMeasureByName(a);if(b)return b;var c=this.getKpiByName(a);if(c)return c;return null},getMeasureByName:function(b){a:;for(var a=0;a<this.$6_0.length;a++)if(this.$6_0[a]._uniqueName===b)return this.$6_0[a];return null},getKpiByName:function(b){a:;if(!this.$c_0||!this.$9_0)return null;for(var a=0;a<this.$9_0.length;a++)if(this.$9_0[a]._uniqueName===b)return this.$9_0[a];return null},getMeasure:function(b){a:;if(!this.$1J_0)return null;for(var a=0;a<this.$6_0.length;a++)if(this.$6_0[a]._index===b)return this.$6_0[a];return null},getKpi:function(b){a:;if(!this.$1H_0)return null;for(var a=0;a<this.$9_0.length;a++)if(this.$9_0[a]._index===b)return this.$9_0[a];return null},getHierarchyName:function(a){a:;if(a<0||a>=this.$1G_0.length)return "";return this.$1G_0[a].toString()},measureGroupComboBoxClick:function(f){a:;var a=PPSMA.EventsEx.getCurrentElement(f.rawEvent);if(!a)return;for(var e=a.getElementsByTagName("option"),c=0;c<e.length;++c){var d=e[c];if(d.selected){var b=d.id.substring(3,d.id.length);if(b!=="_ALL_")a.title=b;else a.title=PPSMA.SR.OlapChangeMeasure_AllMeasureGroups;this.$4Y_0(b);this.$r_0=b;break}}},resize:function(b){a:;var a=$get(this.$S_0+"MeasureGroupsDropDownSelect");if(a)a.style.width=b.toString()+"px"},getMeasureGroupComboBoxHtml:function(){a:;var a=document.createElement("select");a.id=this.$S_0+"MeasureGroupsDropDownSelect";a.className="ms-bichangemeasures-selectgroup";$addHandler(a,"change",this.$$d_measureGroupComboBoxClick);var b=document.createElement("option");b.id="mg__ALL_";b.selected=true;b.innerHTML=PPSMA.SR.OlapChangeMeasure_AllMeasureGroups;a.title=PPSMA.SR.OlapChangeMeasure_AllMeasureGroups;a.appendChild(b);return a},writeMeasureGroupComboBoxContents:function(){a:;if(!this.$k_0)return;if(this.$k_0.length>0){var c=$get(this.$S_0+"MeasureGroupsDropDownSelect");if(c)for(var a=0;a<this.$k_0.length;a++){var b=document.createElement("option");b.id="mg_"+this.$k_0[a];b.innerHTML=this.$T_0[a];c.appendChild(b);if(this.$r_0===this.$k_0[a]){b.selected=true;c.title=this.$T_0[a]}}}},writeDivOutputHtml:function(d,c){a:;if(this.$c_0)if(!this.$1k_0)this.$1k_0=this.$$d_$5e_0;this.$66_0();this.$1I_0=0;for(var a=0;a<this.$4_0.length;a++){var b=0;if(Object.getType(this.$4_0[a]).getName()!=="PPSMA.Folder"){this.$4_0[a].writeDivOutputHtml(this.$S_0,d,0,0,this.$1k_0,c);b=this.$4_0[a].$t_0}else{var e=this.$4_0[a];e.writeDivOutputHtml(this.$S_0,d,0,this.$1k_0,c);b=e.$t_0}if(b>this.$1I_0)this.$1I_0=b}this.$r_0&&this.$r_0!==""&&this.$4Y_0(this.$r_0)},loadMeasuresFromXml:function(e){a:;if(!e)return 0;this.$5f_0(e);this.$67_0();this.$1J_0=0;this.$1H_0=0;if(e.documentElement)this.$r_0=e.documentElement.getAttribute("LastMeasureGroupName");PPSMA.Measures.folderCount=0;var d=e.getElementsByTagName("Measure");if(d.length>0){Array.clear(this.$1G_0);this.$6_0=new Array(d.length);if(d.length>0)for(var b=0;b<d.length;b++){this.$6_0[b]=new PPSMA.Measure;this.$6_0[b]._uniqueName=d[b].getAttribute("uniqueName");this.$6_0[b]._displayCaption=d[b].getAttribute("caption");this.$6_0[b]._index=b;this.$6_0[b]._resourcePath=this.$U_0;var f=PPSMA.Folder.addFolders(this.$1S_0,this.$4I_0(d[b].getAttribute("displayFolder")),this.$6_0[b],1,this.$U_0,this.$W_0);if(f)for(var g=0;g<f.length;g++)!PPSMA.Folder.folderIsAlreadyInDisplay(this.$4_0,f[g])&&Array.add(this.$4_0,f[g]);else Array.add(this.$4_0,this.$6_0[b]);this.$6_0[b]._description=d[b].getAttribute("description");this.$6_0[b]._measureGroup=d[b].getAttribute("measureGroup");this.$5x_0(this.$6_0[b],d[b].getAttribute("hierarchyName"))}this.$1J_0=d.length;if(this.$c_0){var c=e.getElementsByTagName("Kpi");if(c.length>0){this.$9_0=new Array(c.length);for(var a=0;a<c.length;a++){this.$9_0[a]=new PPSMA.Kpi;this.$9_0[a]._uniqueName=c[a].getAttribute("uniqueName");this.$9_0[a]._displayCaption=c[a].getAttribute("caption");this.$9_0[a]._index=a;this.$9_0[a]._resourcePath=this.$U_0;var h=PPSMA.Folder.addFolders(this.$1S_0,this.$4I_0(c[a].getAttribute("displayFolder")),this.$9_0[a],1,this.$U_0,this.$W_0);if(h)for(var i=0;i<h.length;i++)!PPSMA.Folder.folderIsAlreadyInDisplay(this.$4_0,h[i])&&Array.add(this.$4_0,h[i]);else Array.add(this.$4_0,this.$9_0[a]);this.$9_0[a].$2C_1=c[a].getAttribute("value");this.$9_0[a].$24_1=c[a].getAttribute("goal");this.$9_0[a].$29_1=c[a].getAttribute("status");this.$9_0[a].$2A_1=c[a].getAttribute("trend");this.$9_0[a]._description=c[a].getAttribute("description");this.$9_0[a]._measureGroup=c[a].getAttribute("measureGroup")}}this.$1H_0=c.length}}return this.$1J_0+this.$1H_0},setSelectedMeasuresFromResults:function(a){a:;if(!this.$6_0)return;for(var f=0;f<this.$6_0.length;f++){this.$6_0[f].set_selected(false);this.$6_0[f]._order=-1}var b=false;this.$M_0=0;for(var j=0;j<a.$E_0.length;j++)for(var c=0;c<this.$6_0.length;c++){var k=a.$w_0;if(k)for(var g=0;g<k.length;g++)if(this.$6_0[c]._uniqueName===k[g][j].$1_0){++this.$M_0;this.$6_0[c].set_selected(true);this.$6_0[c]._order=g;b=true;this.$N_0="Rows";if(!this.$X_0)return;else break}}if(b)return;for(var l=0;l<a.$m_0.length;l++)for(var d=0;d<this.$6_0.length;d++){var m=a.$u_0;if(m)for(var h=0;h<m.length;h++)if(this.$6_0[d]._uniqueName===m[h][l].$1_0){++this.$M_0;this.$6_0[d].set_selected(true);this.$6_0[d]._order=h;b=true;this.$N_0="Columns";if(!this.$X_0)return;else break}}if(b)return;if(0===a.$E_0.length||0===a.$m_0.length)return;for(var e=0;e<this.$6_0.length;e++){var n=a.$15_0;if(n)for(var i=0;i<n.length;i++)if(this.$6_0[e]._uniqueName===n[i].$1_0){++this.$M_0;this.$6_0[e].set_selected(true);this.$6_0[e]._order=i;b=true;this.$N_0="Filter";if(!this.$X_0)return;else break}}},componentClicked:function(a,e,i,f){a:;var b;if(!f){a._order=-1;b=this.$M_0-1}else{a._order=this.$M_0;b=this.$M_0+1}if(!this.$X_0&&f){for(var g=0;g<this.$6_0.length;g++){var c=this.$6_0[g];if(c===a)continue;if(c.get_selected()){c._order=-1;this.$2W_0(c,e,"",false);break}}for(var h=0;h<this.$9_0.length;h++){var d=this.$9_0[h];if(d===a)continue;if(d.get_selected()){d._order=-1;this.$2W_0(d,e,"",false);break}}b=1;a._order=0}this.$2W_0(a,e,i,f);this.$M_0=b;return a.get_selected()},deSelectObject:function(a){a:;if(!this.$6_0)return false;if(!a)return false;if(!a.get_selected())return false;a._order=-1;this.$2W_0(a,null,"",false);return true},$4Y_0:function(d){for(var e=0;e<this.$6_0.length;e++){var b=this.$6_0[e];if(d==="_ALL_")b._isVisible=true;else if(b._measureGroup===d)b._isVisible=true;else b._isVisible=false}if(this.$c_0&&this.$9_0)for(var f=0;f<this.$9_0.length;f++){var c=this.$9_0[f];if(d==="_ALL_")c._isVisible=true;else if(c._measureGroup===d)c._isVisible=true;else c._isVisible=false}for(var a=0;a<this.$4_0.length;a++)if(Object.getType(this.$4_0[a]).getName()!=="PPSMA.Folder")this.$4_0[a].setVisibility(this.$S_0,0);else{var g=this.$4_0[a];g&&g.setMeasuresVisibility(this.$S_0)}},$5f_0:function(c){var a=c.getElementsByTagName("MeasureGroup");if(a.length>0){this.$k_0=new Array(a.length);this.$T_0=new Array(a.length);for(var b=0;b<a.length;b++){this.$k_0[b]=a[b].getAttribute("name");this.$T_0[b]=a[b].getAttribute("caption")}}},$67_0:function(){a:;if(!this.$T_0)return;if(this.$T_0.length>1)for(var a=0;a<this.$T_0.length;a++)for(var b=a+1;b<this.$T_0.length;b++)if(this.$T_0[a].localeCompare(this.$T_0[b])>=0){var c=this.$T_0[b],d=this.$k_0[b];this.$T_0[b]=this.$T_0[a];this.$k_0[b]=this.$k_0[a];this.$T_0[a]=c;this.$k_0[a]=d}},$4I_0:function(b){var a=b.split("\\");if(a.length<5)return b;else{var c=a[0]+"\\"+a[1]+"\\"+a[2]+"\\"+a[3]+"\\"+a[4];return c}},handleExpandCollapseClick:function(c){a:;var e=PPSMA.EventsEx.getEvent(c.rawEvent);e.cancelBubble=true;c.preventDefault();c.stopPropagation();var b=c.target,a=null;if(PPSMA.DomElementEx.tagsMatch(b.tagName,"img")&&Sys.UI.DomElement.containsCssClass(b,"ms-bichangemeasures-expandcollapseimage"))a=b.parentNode.parentNode;else if(PPSMA.DomElementEx.tagsMatch(b.tagName,"a")&&Sys.UI.DomElement.containsCssClass(b,"ms-bichangemeasures-expandcollapseanchor"))a=b.parentNode;else PPSMA.ReportsCommon.logErrorCondition("couldn't find the folderElem");if(a&&PPSMA.DomElementEx.tagsMatch(a.tagName,"li")&&Sys.UI.DomElement.containsCssClass(a,"chgMeasTflListItem")&&!isNullUndefinedOrEmpty(a.id)){var d=this.findFolderByID(a.id);d&&d.expandCollapse(a)}else PPSMA.ReportsCommon.logErrorCondition("couldn't find the folderElem")},$5e_0:function(a){var e=PPSMA.EventsEx.getEvent(a.rawEvent);e.cancelBubble=true;a.preventDefault();a.stopPropagation();var b=PPSMA.EventsEx.getCurrentElement(a.rawEvent);if(!b)return;var c=b.parentNode.parentNode,d=this.findKpiByID(c.id);d&&d.expandCollapse(c)},$66_0:function(){a:;for(var c=0;c<this.$4_0.length;c++){var n=Object.getType(this.$4_0[c]);if(n.getName()==="PPSMA.Folder")for(var f=c+1;f<this.$4_0.length;f++){var o=Object.getType(this.$4_0[f]),h=o.getName();if(h==="PPSMA.Measure"||h==="PPSMA.Kpi"){var p=this.$4_0[f];this.$4_0[f]=this.$4_0[c];this.$4_0[c]=p;break}}}for(var a=0;a<this.$4_0.length;a++){var q=Object.getType(this.$4_0[a]);if(q.getName()==="PPSMA.Folder")break;for(var b=0;b<this.$4_0.length;b++){var r=Object.getType(this.$4_0[b]);if(r.getName()==="PPSMA.Folder")break;var i=this.$4_0[a],j=this.$4_0[b];if(i._displayCaption.localeCompare(j._displayCaption)<0){var s=this.$4_0[b];this.$4_0[b]=this.$4_0[a];this.$4_0[a]=s;this.$4_0[b]._index=i._index;this.$4_0[a]._index=j._index}}}for(var d=0;d<this.$4_0.length;d++){var k=Object.getType(this.$4_0[d]).getName();if(k==="PPSMA.Measure"||k==="PPSMA.Kpi")continue;for(var e=0;e<this.$4_0.length;e++){var l=Object.getType(this.$4_0[e]).getName();if(l==="PPSMA.Measure"||l==="PPSMA.Kpi")continue;var t=this.$4_0[d],u=this.$4_0[e];if(t.$I_0.localeCompare(u.$I_0)<0){var v=this.$4_0[e];this.$4_0[e]=this.$4_0[d];this.$4_0[d]=v}}}for(var g=0;g<this.$4_0.length;g++){var m=Object.getType(this.$4_0[g]).getName();if(m==="PPSMA.Measure"||m==="PPSMA.Kpi")continue;var w=this.$4_0[g];w.sortDisplayObjects()}},$5x_0:function(b,a){b._hierarchyName=a;!Array.contains(this.$1G_0,a)&&Array.add(this.$1G_0,a)},$2W_0:function(c,d,e,f){for(var a=0;a<this.$4_0.length;a++)if(Object.getType(this.$4_0[a]).getName()!=="PPSMA.Folder")this.$4_0[a]._uniqueName===c._uniqueName&&c.setInputElemCheckValue(this.$S_0,d,0,e,f);for(var b=0;b<this.$1S_0.length;b++){var g=this.$1S_0[b];g.setInputElemCheckValue(c,d,this.$S_0,e,f)}}};PPSMA.DetailsHelper=function(b,c,e,d,a){a:;this.$0_0=b;this.$4e_0=c;this.$2n_0=e;this.$2a_0=d;this.$3g_0=a};PPSMA.DetailsHelper.prototype={$0_0:null,$4e_0:null,$2n_0:0,$2a_0:0,$3g_0:null,showDetails:function(){a:;PPSMA.NewWindow.popupShowDetails(this.$0_0.$a_0,this.$0_0.$3_0,this.getCellTupleXml(),this.$3g_0,this.$0_0.$2x_0,this.$0_0.$C_0,false)},getCellTupleXml:function(){a:;var b=this.$0_0.$8_0,c=b.$w_0,d=b.$u_0,e=b.$15_0,a=PPSMA.XmlEx.loadXml("<_dd />"),l=a.createElement("RowMembers"),m=a.createElement("ColumnMembers"),n=a.createElement("BackgroundMembers");a.documentElement.appendChild(l);a.documentElement.appendChild(m);a.documentElement.appendChild(n);if(c)for(var f=0;f<c[this.$2n_0].length;f++){var o=c[this.$2n_0][f],g=a.createElement("Row");g.setAttribute("name",o.$1_0);g.setAttribute("caption",o.$B_0);l.appendChild(g)}if(d)for(var h=0;h<d[this.$2a_0].length;h++){var p=d[this.$2a_0][h],i=a.createElement("Column");i.setAttribute("name",p.$1_0);i.setAttribute("caption",p.$B_0);m.appendChild(i)}if(e)for(var j=0;j<e.length;j++){var q=e[j],k=a.createElement("Filter");k.setAttribute("name",q.$1_0);k.setAttribute("caption",q.$B_0);n.appendChild(k)}return PPSMA.XmlEx.getXml(a.documentElement)}};PPSMA.DrillDownToHelper=function(c,a,b,d){a:;this.$21_0=c;this.$20_0=a;this.$2c_0=b;this.$0_0=d};PPSMA.DrillDownToHelper.$5O=function(c,d){var a=0,b=null;if(c&&c.length>0)for(var e=0;e<c.length;e++){var g=c[e],h=g.$v_0;if(h.length>1){a+=h.length-1;b=g}}if(a<=1)if(d&&d.length>0)for(var f=0;f<d.length;f++){var i=d[f],j=i.$v_0;if(j.length>1){a+=j.length-1;b=i}}if(a>1)b=null;return b};PPSMA.DrillDownToHelper.$3n=function(f,g,b,j){if(!b.length)return g;var d=g,a=0,e=false,c="";if(b.length>0&&b[0])c=b[a].caption;while(a<b.length&&b[a]&&compareStrings(c,j)){if(d){PPSMA.ContextMenu.addMenuSeparator(f);d=false}var h=b[a].fn,i=b[a].imgRes;c=b[a].caption;PPSMA.ContextMenu.addMenuOption(f,c,h,i,null,false,false);b[a]=null;e=true;a++}if(e)for(a=0;a<b.length;a++)if(b[a]){Array.removeAt(b,a);a--}return d};PPSMA.DrillDownToHelper.$4p=function(c,d,e){var a=e+"('"+escape(d.$1_0);a+="', '', '');";var b=PPSMA.SR.OlapContextMenu_MultipleSelections;PPSMA.ContextMenu.addMenuOption(c,b,a,null,null,false,true)};PPSMA.DrillDownToHelper.$64=function(b){var a=false;if(b)if(b.$16_0!==2){var c=b.$1z_0;if(c)for(var d=0;d<c.length;d++){var g=c[d];if(PPSMA.DrillDownToHelper.$1w(g)){a=true;break}}if(!a){var e=b.$1r_0;if(e)for(var f=0;f<e.length;f++){var h=e[f];if(PPSMA.DrillDownToHelper.$1w(h)){a=true;break}}}}return a};PPSMA.DrillDownToHelper.$1w=function(a){return !PPSMA.DrillDownToHelper.$5c(a)};PPSMA.DrillDownToHelper.$5c=function(c){var a=true;if(c){var b=c.$v_0;if(b&&b.length>1)a=false}return a};PPSMA.DrillDownToHelper.prototype={$21_0:null,$20_0:null,$2c_0:null,$0_0:null,populateSubMenuItems:function(g,f){a:;var b=this.$0_0.$2u_0;if(b)for(var c=0;c<b.length;c++){var a=b[c];if(PPSMA.DrillDownToHelper.$64(a)){var d=a.$1z_0,e=a.$1r_0;if(this.$3p_0(d)||this.$3p_0(e))this.$3j_0(g,a,d,e,f,true);else this.$3j_0(g,a,d,e,f,false)}}},$3j_0:function(d,a,e,h,b,i){var c=this.$5M_0(a);if(i){var f=PPSMA.DrillDownToHelper.$5O(e,h);if(f)this.$4q_0(d,f,a,b,c,i);else{var g=PPSMA.ContextMenu.addSubMenu(d,a.$B_0,c,false),j=this.$4u_0(g,a,e,b),k=this.$5E_0(e,a,b);this.$4i_0(g,h,a,b,j,k)}}else PPSMA.ContextMenu.addDisabledMenuOption(d,a.$B_0,"",c,false)},$4u_0:function(f,v,j,k){var l=false;if(j)for(var g=0;g<j.length;g++){var a=j[g];if(PPSMA.DrillDownToHelper.$1w(a)){var o=this.$5a_0(a),p=this.$3A_0(a)||this.$5b_0(a),c;if(a.$1_0===this.$20_0.$1_0)c=this.$21_0.$3D_0;else{var m=this.$41_0(a);if(!m)c=0;else c=m.$2E_0}var b=a.$v_0;if(b&&b.length>2){if(v.$1_0===this.$20_0.$2F_0)for(var h=this.$21_0.$3C_0,q=h.lastIndexOf("."),r=h.substring(q+1,h.length),d=1;d<b.length;d++){var s=b[d],i=s.$1_0,t=i.lastIndexOf("."),u=i.substring(t+1,i.length);if(u===r)c=d}PPSMA.ContextMenu.addDisabledMenuOption(f,a.$B_0,null,null,false);if(o)PPSMA.DrillDownToHelper.$4p(f,a,k);else for(var e=1;e<b.length;e++){var n=b[e];if(p||e<=c)this.$3l_0(f,n,a,k,false);else this.$3l_0(f,n,a,k,true)}l=true}}}return l},$5E_0:function(f,k,i){var g=[];if(f)for(var j=this.$46_0(k),c=0;c<f.length;c++){var a=f[c];if(PPSMA.DrillDownToHelper.$1w(a)){var d=a.$v_0;if(d&&d.length===2){var h=this.$2K_0(a),e;if(h!=="")e=i+"('"+escape(a.$1_0)+"', '"+escape(h)+"', '"+escape(d[1].$1_0)+"');";else e=i+"('"+escape(a.$1_0)+"', '', '');";var b={};b.caption=a.$B_0;b.fn=e;b.imgRes=j;Array.add(g,b)}}}return g},$4i_0:function(c,f,n,k,o,l){var b=o;if(f)for(var g=this.$46_0(n),d=0;d<f.length;d++){var a=f[d];if(PPSMA.DrillDownToHelper.$1w(a)){var h=a.$v_0;if(h.length>1){b=PPSMA.DrillDownToHelper.$3n(c,b,l,a.$B_0);if(b){PPSMA.ContextMenu.addMenuSeparator(c);b=false}var i=this.$2K_0(a),e;if(i!=="")e=k+"('"+escape(a.$1_0)+"', '"+escape(i)+"', '"+escape(h[1].$1_0)+"');";else e=k+"('"+escape(a.$1_0)+"', '', '');";var j=this.$41_0(a),m=this.$3A_0(a);if(m||j&&j.$2E_0>0)PPSMA.ContextMenu.addDisabledMenuOption(c,a.$B_0,"",g,false);else PPSMA.ContextMenu.addMenuOption(c,a.$B_0,e,g,null,false,false)}}}PPSMA.DrillDownToHelper.$3n(c,b,l,"")},$4q_0:function(d,a,e,f,g,i){var c=this.$2K_0(a),b;if(c!==""){var h=a.$v_0[1];b=f+"('"+escape(a.$1_0)+"', '"+escape(c)+"', '"+escape(h.$1_0)+"');"}else b=f+"('"+escape(a.$1_0)+"', '', '');";if(i)PPSMA.ContextMenu.addMenuOption(d,e.$B_0,b,g,null,false,false);else PPSMA.ContextMenu.addDisabledMenuOption(d,e.$B_0,null,g,false)},$3l_0:function(b,a,c,f,g){var d=this.$2K_0(c),e=f+"('"+escape(c.$1_0)+"', '"+escape(d)+"', '"+escape(a.$1_0)+"');";if(g)PPSMA.ContextMenu.addMenuOption(b,a.$B_0,e,null,null,false,true);else PPSMA.ContextMenu.addDisabledMenuOption(b,a.$B_0,null,null,true)},$2K_0:function(d){var a;if(d.$1_0===this.$20_0.$1_0)a=this.$21_0.$1_0;else{a=d.$1_0+".DefaultMember";var e=this.$0_0.$8_0.$15_0,c=this.$0_0.$8_0.$14_0;if(e&&c)for(var b=0;b<c.length;b++){var f=c[b];if(f.$1_0===d.$1_0){a=!f.$1a_0?e[b].$1_0:"";break}}}return a},$3p_0:function(b){var c=false;if(b)for(var a=0;a<b.length;a++){var d=b[a];if(!this.$3A_0(d)){c=true;break}}return c},$3A_0:function(b){var a=false;if(b)if(this.$2c_0==="C")a=!!this.$43_0(b);else if(this.$2c_0==="R")a=!!this.$42_0(b);return a},$5b_0:function(c){var a=false;if(c){var b=this.$30_0(c);if(b&&b.$2O_0)a=true}return a},$5a_0:function(c){var a=false;if(c){var b=this.$30_0(c);if(b)a=b.$1a_0}return a},$43_0:function(e){var b=null;if(this.$0_0)for(var c=this.$0_0.$8_0.$E_0,a=0;a<c.length;a++){var d=c[a];if(d.$1_0===e.$1_0){b=d;break}}return b},$42_0:function(e){var b=null;if(this.$0_0)for(var c=this.$0_0.$8_0.$m_0,a=0;a<c.length;a++){var d=c[a];if(d.$1_0===e.$1_0){b=d;break}}return b},$30_0:function(e){var b=null;if(this.$0_0)for(var c=this.$0_0.$8_0.$14_0,a=0;a<c.length;a++){var d=c[a];if(d.$1_0===e.$1_0){b=d;break}}return b},$41_0:function(b){var a=this.$5G_0(b);if(!a)a=this.$30_0(b);return a},$5G_0:function(b){var a=null;if(this.$0_0){a=this.$43_0(b);if(!a)a=this.$42_0(b)}return a},$46_0:function(b){var a;if(b.$16_0===1)a=this.$0_0.$C_0+"AttributeTime.gif";else a=this.$0_0.$C_0+"Attribute.gif";return a},$5M_0:function(b){var a;if(b.$16_0===1)a=this.$0_0.$C_0+"DimensionTime.gif";else a=this.$0_0.$C_0+"Dimension.gif";return a}};PPSMA.AnalyzeInDecompHelper=function(){};PPSMA.AnalyzeInDecompHelper.getDefaultQueryParameters=function(){a:;var a=new PPSMA.DecompQueryParameters;if(a){a.ClientState="";a.SortType="descending"}return a};PPSMA.AnalyzeInDecompHelper.$5K=function(l,h,i){var b=l.$8_0,c=b.$w_0,d=b.$u_0,j=b.$15_0,k=b.$14_0,a=new PPSMA.DecompTupleRecord;if(c){a.RowSelections=new Array(c[h].length);for(var e=0;e<c[h].length;e++){var m=c[h][e];a.RowSelections[e]=m.$1_0}}if(d){a.ColumnSelections=new Array(d[i].length);for(var f=0;f<d[i].length;f++){var n=d[i][f];a.ColumnSelections[f]=n.$1_0}}if(j)for(var g=0;g<k.length;g++){if(k[g].$1_0!==l.$1P_0)continue;var o=j[g];a.BackgroundMeasureName=o.$1_0;break}return a};PPSMA.AnalyzeInDecompHelper.$5L=function(g){var a=new PPSMA.DecompTupleRecord,f=PPSMA.XmlEx.loadXml(g),b=f.getElementsByTagName("Row");if(b.length>0){a.RowSelections=new Array(b.length);for(var d=0;d<b.length;d++)a.RowSelections[d]=b[d].getAttribute("name")}var c=f.getElementsByTagName("Column");if(c.length>0){a.ColumnSelections=new Array(c.length);for(var e=0;e<c.length;e++)a.ColumnSelections[e]=c[e].getAttribute("name")}return a};PPSMA.AnalyzeInDecompHelper.prototype={$18_0:null,$17_0:null,launchAnalyzeRequest:function(a,f,c,b){a:;this.$18_0=PPSMA.NewWindow.openPopUpWindow(1e3,600,"DecompWindow"+(new Date).getTime(),",resizable=yes,scrollbars=no,toolbar=no");if(!this.$18_0)return;if(!this.$18_0.document)return;this.$17_0=this.$18_0.document;PPSMA.NewWindow.applyDefaults(this.$17_0,a.$3_0);var d=PPSMA.AnalyzeInDecompHelper.getDefaultQueryParameters();this.$17_0.title=PPSMA.SR.OlapContextMenu_AnalyzeInDecomp;var e=PPSMA.AnalyzeInDecompHelper.$5K(a,c,b);PPSMA.NewWindow.createDecompForm(this.$17_0,a.$a_0,Sys.Serialization.JavaScriptSerializer.serialize(e),Sys.Serialization.JavaScriptSerializer.serialize(d),"",a.$2w_0)},launchAnalyzeRequestFromScorecard:function(a,d,b,c){a:;this.$18_0=PPSMA.NewWindow.openPopUpWindow(1e3,600,"DecompWindow"+(new Date).getTime(),",resizable=yes,scrollbars=no,toolbar=no");if(!this.$18_0)return;if(!this.$18_0.document)return;this.$17_0=this.$18_0.document;PPSMA.NewWindow.applyDefaults(this.$17_0,a);var e=PPSMA.AnalyzeInDecompHelper.getDefaultQueryParameters();this.$17_0.title=PPSMA.SR.OlapContextMenu_AnalyzeInDecomp;var f=PPSMA.AnalyzeInDecompHelper.$5L(d);PPSMA.NewWindow.createDecompForm(this.$17_0,a,Sys.Serialization.JavaScriptSerializer.serialize(f),Sys.Serialization.JavaScriptSerializer.serialize(e),b,c)}};PPSMA.MenuOptionHelper=function(d,c,b,a){a:;this.$1T_0=d;this.$1B_0=c;this.$b_0=b;this.$0_0=a};PPSMA.MenuOptionHelper.$5P=function(a){var b=20;if(a.length>b)a=a.substr(0,b-3)+"...";return String.format(PPSMA.SR.OlapContextMenu_SwitchToType,a)};PPSMA.MenuOptionHelper.$3m=function(a){PPSMA.ContextMenu.addMenuOption(a,PPSMA.SR.OlapContextMenu_DynamicLoadText,null,null,null,false,false)};PPSMA.MenuOptionHelper.prototype={$1T_0:null,$1B_0:null,$b_0:false,$0_0:null,$G_0:0,get_optionsAdded:function(){a:;return this.$G_0},showHideInfo:function(b,c,d){a:;this.$G_0>0&&PPSMA.ContextMenu.addMenuSeparator(b);var a;if(this.$0_0.$1M_0)a=PPSMA.SR.OlapContextMenu_HideInfo;else a=PPSMA.SR.OlapContextMenu_ShowInfo;PPSMA.ContextMenu.addMenuOption(b,a,c,getResFolder()+"info16by16.gif",null,false,d);this.$G_0++},drillDown:function(c,d,a){a:;if(this.$b_0){var b=PPSMA.SR.OlapContextMenu_DrillDown;if(this.$1T_0.$1t_0)PPSMA.ContextMenu.addMenuOption(c,b,d,this.$0_0.$C_0+"DrillDown.gif",null,false,a);else PPSMA.ContextMenu.addDisabledMenuOption(c,b,null,this.$0_0.$C_0+"DrillDownD.gif",a);this.$G_0++}},drillUp:function(c,d,a){a:;if(this.$b_0){var b=PPSMA.SR.OlapContextMenu_DrillUp;if(this.$1T_0.$36_0)PPSMA.ContextMenu.addMenuOption(c,b,d,this.$0_0.$C_0+"DrillUp.gif",null,false,a);else PPSMA.ContextMenu.addDisabledMenuOption(c,b,null,this.$0_0.$C_0+"DrillUpD.gif",a);this.$G_0++}},expandCollapse:function(c,e,d,b){a:;if(this.$b_0){var a;if(this.$1T_0.$2H_0){a=PPSMA.SR.OlapContextMenu_Collapse;if(this.$1T_0.$1t_0)PPSMA.ContextMenu.addMenuOption(c,a,d,null,null,false,b);else PPSMA.ContextMenu.addDisabledMenuOption(c,a,null,null,b);this.$G_0++}else{a=PPSMA.SR.OlapContextMenu_Expand;if(this.$1T_0.$1t_0)PPSMA.ContextMenu.addMenuOption(c,a,e,null,null,false,b);else PPSMA.ContextMenu.addDisabledMenuOption(c,a,null,null,b);this.$G_0++}}},showOnly:function(c,d,a){a:;if(this.$b_0){var b=PPSMA.SR.OlapContextMenu_ShowOnly;if(!this.$1B_0.$2Q_0)PPSMA.ContextMenu.addMenuOption(c,b,d,null,null,false,a);else PPSMA.ContextMenu.addDisabledMenuOption(c,b,null,null,a);this.$G_0++}},remove:function(c,d,a){a:;if(this.$b_0){var b=PPSMA.SR.OlapContextMenu_Remove;if(!this.$1B_0.$2Q_0)PPSMA.ContextMenu.addMenuOption(c,b,d,null,null,false,a);else PPSMA.ContextMenu.addDisabledMenuOption(c,b,null,null,a);this.$G_0++}},pivot:function(d,a,b){a:;if(this.$b_0){var c=PPSMA.SR.OlapContextMenu_Pivot;PPSMA.ContextMenu.addMenuOption(d,c,a,null,null,false,b);this.$G_0++}},showProperties:function(d,a,b,e){a:;var c=PPSMA.SR.OlapContextMenu_ShowProperties;if(e)PPSMA.ContextMenu.addMenuOption(d,c,a,null,null,false,b);else PPSMA.ContextMenu.addDisabledMenuOption(d,c,a,null,b);this.$G_0++},hideProperty:function(e,b,a,c){a:;var d=b;PPSMA.ContextMenu.addMenuOption(e,d,a,null,null,false,c);this.$G_0++},showChangeMeasure:function(e,a,b,c){a:;if(!b){var d=PPSMA.SR.OlapChangeMeasure_ContextMenuLabel;PPSMA.ContextMenu.addMenuOption(e,d,a,null,null,false,c);this.$G_0++}},selectItems:function(d,a,b){a:;if(this.$b_0){var c=PPSMA.SR.OlapContextMenu_SelectItems;PPSMA.ContextMenu.addMenuOption(d,c,a,null,null,false,b);this.$G_0++}},hasAggregatedBackGroundHierarchies:function(){a:;var c=this.$0_0.$8_0;if(c.$3S_0)return true;var a=c.$14_0;if(a)for(var b=0;b<a.length;b++){var d=a[b];if(d.$1a_0)return true}return false},isSilverlightInstalled:function(){a:;return isSilverlightInstalled("3.0.40624")},decompositionTree:function(f,a,d,b,c){a:;if(c)return;if(!this.isSilverlightInstalled()||!this.$b_0||!b)return;var e=PPSMA.SR.OlapContextMenu_AnalyzeInDecomp;PPSMA.ContextMenu.addMenuOption(f,e,a,this.$0_0.$C_0+"DecompositionTree.png",null,false,d);this.$G_0++},showDetails:function(d,a,b,e){a:;var c=PPSMA.SR.OlapContextMenu_ShowDetails;if(e)PPSMA.ContextMenu.addMenuOption(d,c,a,null,null,false,b);else PPSMA.ContextMenu.addDisabledMenuOption(d,c,a,null,b);this.$G_0++},switchToOption:function(d,e,c,a){a:;if(this.$b_0){var b=PPSMA.MenuOptionHelper.$5P(e);PPSMA.ContextMenu.addMenuOption(d,b,c,null,null,false,a);this.$G_0++}},addDisabledOption:function(b,c,a){a:;PPSMA.ContextMenu.addDisabledMenuOption(b,c,null,null,a);this.$G_0++},drillDownTo:function(g,d,c,b,e){a:;if(this.$b_0){var f=PPSMA.SR.OlapContextMenu_DrillDownTo,a=PPSMA.ContextMenu.addDynamicSubMenu(g,f,d,c,b,e);PPSMA.MenuOptionHelper.$3m(a);this.$G_0++;return a}return null},additionalActions:function(d,g,f,e,b,h){a:;var c=PPSMA.SR.OlapContextMenu_AdditionalActions,a=null;if(h){a=PPSMA.ContextMenu.addDynamicSubMenu(d,c,g,f,e,b);PPSMA.MenuOptionHelper.$3m(a)}else PPSMA.ContextMenu.addDisabledMenuOption(d,c,null,null,b);this.$G_0++;return a},reportTypeSubMenu:function(d,b,a){a:;if(this.$b_0){var c=PPSMA.ContextMenu.addSubMenu(d,PPSMA.SR.OlapContextMenu_ReportType,this.$0_0.$C_0+"BarChart.png",false);PPSMA.ContextMenu.addMenuOption(c,PPSMA.SR.OlapContextMenu_ReportType_Grid,b+".switchToGrid()",this.$0_0.$C_0+"Grid.png",null,!a,false);PPSMA.ContextMenu.addMenuOption(c,PPSMA.SR.OlapContextMenu_ReportType_ColumnChart,b+".switchToColumnChart()",this.$0_0.$C_0+"BarChart.png",null,a===1,false);PPSMA.ContextMenu.addMenuOption(c,PPSMA.SR.OlapContextMenu_ReportType_ColumnChartStacked,b+".switchToColumnChartStacked()",this.$0_0.$C_0+"BarChartStacked.png",null,a===2,false);PPSMA.ContextMenu.addMenuOption(c,PPSMA.SR.OlapContextMenu_ReportType_ColumnChartStacked100,b+".switchToColumnChartStacked100()",this.$0_0.$C_0+"BarChartStacked100.png",null,a===3,false);PPSMA.ContextMenu.addMenuOption(c,PPSMA.SR.OlapContextMenu_ReportType_LineChart,b+".switchToLineChart()",this.$0_0.$C_0+"LineChartNoMarker.png",null,a===4,false);PPSMA.ContextMenu.addMenuOption(c,PPSMA.SR.OlapContextMenu_ReportType_LineChartWithMarkers,b+".switchToLineChartWithMarkers()",this.$0_0.$C_0+"LineChart.png",null,a===5,false);PPSMA.ContextMenu.addMenuOption(c,PPSMA.SR.OlapContextMenu_ReportType_PieChart,b+".switchToPieChart()",this.$0_0.$C_0+"PieChart.png",null,a===6,false);this.$G_0++}},formatReportSubMenu:function(c,a){a:;var b=PPSMA.SR.OlapContextMenu_FormatReport;this.$G_0++;return PPSMA.ContextMenu.addSubMenu(c,b,this.$0_0.$C_0+"FormatReport.gif",a)}};PPSMA.SubMenu=function(a,b){a:;this.$3f_0=a;this.$2m_0=b};PPSMA.SubMenu.prototype={$3b_0:false,$2m_0:0,$3f_0:null,$3d_0:false,get_hoverOn:function(){a:;return this.$3b_0},set_hoverOn:function(a){a:;this.$3b_0=a;return a},get_menuType:function(){a:;return this.$2m_0},set_menuType:function(a){a:;this.$2m_0=a;return a},get_isPopulated:function(){a:;return this.$3d_0},set_isPopulated:function(a){a:;this.$3d_0=a;return a},get_menu:function(){a:;return this.$3f_0}};PPSMA.OlapViewContext=function(d,c,b,j,a,h,i,f,g,e){a:;this.$$d_$5k_0=Function.createDelegate(this,this.$5k_0);this.$$d_$5l_0=Function.createDelegate(this,this.$5l_0);this.$$d_$5p_0=Function.createDelegate(this,this.$5p_0);this.$$d_$5j_0=Function.createDelegate(this,this.$5j_0);this.$$d_$5o_0=Function.createDelegate(this,this.$5o_0);this.$2G_0={};this.$5_0=new PPSMA.Measures;this.$2y_0='<div class="ms-bireport-error ms-error"><div>'+PPSMA.SR.Dashboard_Render_UnexpectedError+"</div></div>";this.$2t_0=d;this.$4J_0=c;this.$3_0=b;this.$K_0=j;this.$1R_0=a;this.$C_0=h;this.$39_0=i;this.$2w_0=g;this.$2x_0=e;this.$69_0="OTB"+this.$o_0;this.$4G_0=f;PPSMA.OlapViewContext.$1x("OlapViewContext"+this.$K_0);PPSMA.OlapViewContext.$1x("OlapViewContext"+this.$3_0);PPSMA.OlapViewContext.$1x("OlapViewContext"+this.$1R_0);PPSMA.OlapViewContext.$1x("OlapViewContext"+this.$a_0);if(!isNullOrEmpty(a)){this.$2X_0=PPSMA.ClientConnectionManager.get_instance().findClientWebPart(a);this.$2X_0&&this.$2X_0.registerDisposableView(this)}PPSMA.OlapViewContext.globalIds[b]=this};PPSMA.OlapViewContext.$35=function(){a:;var a=new Sys.UI.Point(0,0);if(window.self.innerWidth){a.x=window.self.innerWidth;a.y=window.self.innerHeight}else{a.x=PPSMA.SizeEx.getClientWidth();a.y=PPSMA.SizeEx.getClientHeight()}return a};PPSMA.OlapViewContext.$5N=function(a){var b=new Sys.UI.Point(0,0);if(!a)b=PPSMA.OlapViewContext.$35();else{var c=getStyle(a,"width"),d=getStyle(a,"height");if(c!=="auto"||d!=="auto"){b.x=a.clientWidth;b.y=a.clientHeight}}return b};PPSMA.OlapViewContext.getViewInfoDiv=function(a){a:;while(a){if(PPSMA.DomElementEx.tagsMatch(a.tagName,"div")&&a.id==="_viewInfoId")return a;a=a.parentNode}return null};PPSMA.OlapViewContext.overTbItem=function(b){a:;var a=PPSMA.EventsEx.getCurrentElement(b);while(a&&a.tagName.toLowerCase()!=="td")a=a.parentNode;if(a)a.className="bsm-toolbarCellSelected"};PPSMA.OlapViewContext.outTbItem=function(c,b){a:;var a=PPSMA.EventsEx.getCurrentElement(c);while(a&&a.tagName.toLowerCase()!=="td")a=a.parentNode;if(a)a.className=b};PPSMA.OlapViewContext.overLiItem=function(c,b){a:;var a=PPSMA.EventsEx.getCurrentElement(c);while(a&&a.tagName.toLowerCase()!=="li")a=a.parentNode;if(a)a.className=b};PPSMA.OlapViewContext.outLiItem=function(c,b){a:;var a=PPSMA.EventsEx.getCurrentElement(c);while(a&&a.tagName.toLowerCase()!=="li")a=a.parentNode;if(a)a.className=b};PPSMA.OlapViewContext.$1x=function(){};PPSMA.OlapViewContext.prototype={$2t_0:null,$4J_0:null,$3_0:null,$1R_0:null,$K_0:null,$C_0:null,$39_0:null,$4G_0:null,$2w_0:null,$2x_0:null,$2X_0:null,$o_0:null,$a_0:null,$p_0:null,$1L_0:0,$8_0:null,$1P_0:null,$44_0:null,$H_0:null,$1O_0:null,$1Y_0:null,$2r_0:null,$2u_0:null,$1M_0:true,$2N_0:false,$1u_0:false,$1N_0:false,$3O_0:false,$P_0:1,$3N_0:",",$2v_0:".",$n_0:null,$2P_0:false,$3G_0:null,$1q_0:null,$2L_0:null,$2J_0:null,$5d_0:true,$4F_0:0,$4E_0:0,$4b_0:null,$69_0:null,$5l_0:function(g,e){if(!isNullOrEmpty(e.$23_1)){var a=e.$23_1.split("|"),f=a[0],b=a[1];if(f===this.$3_0)if(b!=="null"&&b!=="error"){this.$a_0=b;var c=1;if(a.length>2&&a[2].length>0)c=Number.parseInvariant(a[2]);this.$P_0=c;this.$2P_0=true;this.$p_0=a[4];this.setPage(c)}else if(null!==this.$K_0){var d=$get(this.$K_0);if(null!==d){d.style.position="static";d.innerHTML=this.$2y_0}}}},get_toolbar:function(){a:;return this.$4b_0},set_toolbar:function(a){a:;this.$4b_0=a;return a},get_reportId:function(){a:;return this.$a_0},set_reportId:function(a){a:;this.$a_0=a;return a},get_targetType:function(){a:;return this.$p_0},set_targetType:function(a){a:;this.$p_0=a;return a},get_innerTargetId:function(){a:;return this.$o_0},set_innerTargetId:function(a){a:;this.$o_0=a;return a},get_outerTargetId:function(){a:;return this.$K_0},get_webPartTargetId:function(){a:;return this.$1R_0},get_results:function(){a:;return this.$8_0},set_results:function(a){a:;this.$8_0=a;return a},get_measureHierarchyName:function(){a:;return this.$1P_0},set_measureHierarchyName:function(a){a:;this.$1P_0=a;return a},get_formatDimHierarchyName:function(){a:;return this.$44_0},set_formatDimHierarchyName:function(a){a:;this.$44_0=a;return a},get_measureData:function(){a:;return this.$1O_0},set_measureData:function(a){a:;this.$1O_0=a;return a},get_dimensionData:function(){a:;return this.$1Y_0},set_dimensionData:function(a){a:;this.$1Y_0=a;return a},get_cellActionData:function(){a:;return this.$2r_0},set_cellActionData:function(a){a:;this.$2r_0=a;return a},get_resourcePath:function(){a:;return this.$C_0},get_imagesPath:function(){a:;return this.$39_0},get_decompTreePage:function(){a:;return this.$2w_0},get_drillThroughPage:function(){a:;return this.$2x_0},get_cubeMetadata:function(){a:;return this.$2u_0},set_cubeMetadata:function(a){a:;this.$2u_0=a;return a},get_webPartProxy:function(){a:;return this.$2X_0},get_infoBarVisible:function(){a:;return this.$1M_0},set_infoBarVisible:function(a){a:;this.$1M_0=a;return a},get_toolbarVisible:function(){a:;return this.$3O_0},set_toolbarVisible:function(a){a:;this.$3O_0=a;return a},get_historyButtonsVisible:function(){a:;return this.$2N_0},set_historyButtonsVisible:function(a){a:;this.$2N_0=a;return a},get_isSingleView:function(){a:;return this.$1u_0},set_isSingleView:function(a){a:;this.$1u_0=a;return a},get_isDesigner:function(){a:;return this.$1N_0},set_isDesigner:function(a){a:;this.$1N_0=a;return a},get_currentDataPage:function(){a:;return this.$P_0},set_currentDataPage:function(a){a:;this.$P_0=a;return a},get_thousandSeparator:function(){a:;return this.$3N_0},set_thousandSeparator:function(a){a:;this.$3N_0=a;return a},get_decimalPoint:function(){a:;return this.$2v_0},set_decimalPoint:function(a){a:;this.$2v_0=a;return a},get_ctrlProxyId:function(){a:;return this.$3_0},get_reportContext:function(){a:;return this.$3G_0},set_reportContext:function(a){a:;this.$3G_0=a;return a},applyMeasureSelectorChanges:function(){a:;var a=this.$J_0(),b='<Action type="ApplyMeasureSelectorChanges">'+this.get_$5h_0()+"</Action>";this.makeNavigationRequest(b,a.y,a.x)},applyDimensionProperties:function(){a:;var a=this.$J_0(),b='<Action type="ApplyDimensionProperties"><DimensionProperties>'+this.get_$5D_0()+"</DimensionProperties></Action>";this.makeNavigationRequest(b,a.y,a.x)},execute:function(a,b){a:;var c=this.$J_0();if(!b)b=c.x;if(!a)a=c.y;this.makeNavigationRequest("",a,b)},changeViewSize:function(b){a:;if(!isNullOrEmpty(this.$o_0)){var a=$get(this.$o_0);if(a)a.style.height=a.offsetHeight+b+"px"}},setOuterTagAttribute:function(c,b){a:;if(!isNullOrEmpty(this.$K_0)){var a=$get(this.$K_0);a&&a.setAttribute(c,b)}},getOuterTagAttribute:function(c){a:;var a="";if(!isNullOrEmpty(this.$K_0)){var b=$get(this.$K_0);if(b)a=b.getAttribute(c)}return a},toggleViewInfoBar:function(){a:;this.changeViewConfiguration("ShowInformationBar",(!this.$1M_0).toString())},drillUp:function(b,c){a:;var a=this.$J_0(),d='<Action type="DrillUp"><Member>'+PPSMA.EncodeEx.xmlEncode(c)+"</Member><Hierarchy>"+PPSMA.EncodeEx.xmlEncode(b)+"</Hierarchy><Page>"+this.$P_0+"</Page></Action>";this.makeNavigationRequest(d,a.y,a.x)},drillDown:function(b,c){a:;var a=this.$J_0(),d='<Action type="DrillDown"><Member>'+PPSMA.EncodeEx.xmlEncode(c)+"</Member><Hierarchy>"+PPSMA.EncodeEx.xmlEncode(b)+"</Hierarchy><Page>"+this.$P_0+"</Page></Action>";this.makeNavigationRequest(d,a.y,a.x)},get_$5h_0:function(){a:;var a;if(this.$5_0.$N_0==="none")if(this.$5_0.$M_0===1)a='<Measures Axis="Filter" ';else a='<Measures Axis="Columns" ';else if(!this.$5_0.$M_0)a='<Measures Axis="Filter" ';else if(this.$5_0.$N_0==="Filter"&&this.$5_0.$M_0>1)if(this.$p_0==="AnalyticChart")a='<Measures Axis="Rows" Moved="yes" ';else a='<Measures Axis="Columns" Moved="yes" ';else a='<Measures Axis="'+this.$5_0.$N_0+'" ';a+='MeasureGroupName="';a+=this.$5_0.get_measureGroupName();a+='">';for(var b=0;b<this.$5_0.get_hierarchyCount();b++){var e=this.$5_0.getHierarchyName(b);a+='<Hierarchy name="';a+=e;a+='">';for(var c=0;c<this.$5_0.$M_0;c++){var d=this.$5_0.getSelectedMeasureByOrder(c);if(!d)continue;if(d._hierarchyName!==e)continue;a+='<Measure name="';a+=d._uniqueName;a+='"/>'}a+="</Hierarchy>"}a+="</Measures>";return a},get_$5D_0:function(){a:;var a="";if(!this.$8_0||!this.$8_0.$E_0)return a;for(var f=0;f<this.$8_0.$E_0.length;f++){var g=this.$8_0.$E_0[f].$1_0,b=this.getDimensionPropertiesList(g);if(b){if(b.get_enabledCount()>0){a+='<Hierarchy name="'+b.$1o_0+'" PropertyCount="'+b.get_enabledCount()+'">';for(var d=0;d<b.$A_0;d++)if(b.$Y_0[d])a+='<DimProperty name="'+b.$L_0[d]+'" caption="'+b.$z_0[d]+'"/>';a+="</Hierarchy>"}delete this.$2G_0[g]}else{var c=this.$8_0.$E_0[f].$1Q_0,h=c.$A_0-c.get_numPropertiesHidden();if(h>0){a+='<Hierarchy name="'+g+'" PropertyCount="'+h+'">';for(var e=0;e<c.$A_0;e++)if(!c.isPropertyHidden(c.$L_0[e]))a+='<DimProperty name="'+c.$L_0[e]+'" caption="'+c.$z_0[e]+'"/>';a+="</Hierarchy>"}}}return a},getPageHeadersHeight:function(){a:;var a=0;if(this.$3O_0)a+=30;if(this.$1M_0)a+=23;return a},setPage:function(c){a:;var a=this.$J_0(),b=true;if(this.$8_0)b=this.$8_0.$1s_0;var d='<Action type="Execute"><Page>'+c+"</Page><Nav>"+b+"</Nav></Action>";this.makeNavigationRequest(d,a.y,a.x)},setPage2:function(a,c){a:;var b=c.keyCode;b===13&&this.setPage(a)},setAllPageWithMessage:function(e){a:;var a;a=confirm(e);if(a){var b=this.$J_0(),c=true;if(this.$8_0)c=this.$8_0.$1s_0;var d='<Action type="Execute"><Page>0</Page><Nav>'+c+"</Nav></Action>";this.makeNavigationRequest(d,b.y,b.x)}},setAllPageWithMessage2:function(b,c){a:;var a=c.keyCode;a===13&&this.setAllPageWithMessage(b)},expand:function(b,c){a:;var a=this.$J_0(),d='<Action type="Expand"><Member>'+PPSMA.EncodeEx.xmlEncode(c)+"</Member><Hierarchy>"+PPSMA.EncodeEx.xmlEncode(b)+"</Hierarchy><Page>"+this.$P_0+"</Page></Action>";this.makeNavigationRequest(d,a.y,a.x)},collapse:function(b,c){a:;var a=this.$J_0(),d='<Action type="Collapse"><Member>'+PPSMA.EncodeEx.xmlEncode(c)+"</Member><Hierarchy>"+PPSMA.EncodeEx.xmlEncode(b)+"</Hierarchy><Page>"+this.$P_0+"</Page></Action>";this.makeNavigationRequest(d,a.y,a.x)},showOnly:function(b,c){a:;var a=this.$J_0(),d='<Action type="ShowOnly"><Member>'+PPSMA.EncodeEx.xmlEncode(c)+"</Member><Hierarchy>"+PPSMA.EncodeEx.xmlEncode(b)+"</Hierarchy><Page>"+this.$P_0+"</Page></Action>";this.makeNavigationRequest(d,a.y,a.x)},hide:function(b,c){a:;var a=this.$J_0(),d='<Action type="Hide"><Member>'+PPSMA.EncodeEx.xmlEncode(c)+"</Member><Hierarchy>"+PPSMA.EncodeEx.xmlEncode(b)+"</Hierarchy><Page>"+this.$P_0+"</Page></Action>";this.makeNavigationRequest(d,a.y,a.x)},crossDrill:function(e,f,b,c,d){a:;var a=this.$J_0(),g='<Action type="CrossDrill"><Member>'+PPSMA.EncodeEx.xmlEncode(f)+"</Member><Hierarchy>"+PPSMA.EncodeEx.xmlEncode(e)+"</Hierarchy><Page>"+this.$P_0+"</Page><DrillToMember>"+PPSMA.EncodeEx.xmlEncode(c)+"</DrillToMember><DrillToLevel>"+PPSMA.EncodeEx.xmlEncode(d)+"</DrillToLevel><DrillToHierarchy>"+PPSMA.EncodeEx.xmlEncode(b)+"</DrillToHierarchy></Action>";this.makeNavigationRequest(g,a.y,a.x)},pivot:function(){a:;var a=this.$J_0(),b='<Action type="Pivot"></Action>';this.makeNavigationRequest(b,a.y,a.x)},switchOlapReportType:function(b,d){a:;var c=this.$J_0(),e='<Action type="SwitchReportType"><Page>'+b+"</Page></Action>",a;if(!b)a="OLAPGrid";else a="AnalyticChart";this.$1q_0=d;this.$4H_0(e,c.y,c.x,a)},changeViewConfiguration:function(a,c){a:;var b=this.$J_0(),d='<Action type="ChangeViewConfiguration"><'+a+">"+c+"</"+a+"><Page>"+this.$P_0+"</Page></Action>";this.makeNavigationRequest(d,b.y,b.x)},changeViewConfigurationWithCallback:function(b,a,c){a:;this.$1q_0=c;this.changeViewConfiguration(b,a)},filterEmpty:function(d,b){a:;var a=this.$J_0(),c='<Action type="FilterEmpty"><Axis>'+PPSMA.EncodeEx.xmlEncode(d)+"</Axis><Filter>"+b+"</Filter><Page>"+this.$P_0+"</Page></Action>";this.makeNavigationRequest(c,a.y,a.x)},clearFilter:function(e,c){a:;var b=this.$J_0(),a=this.$P_0;if(!a&&c)a=1;var d='<Action type="Filter"><Hierarchy></Hierarchy><TupleXML></TupleXML><Axis>'+PPSMA.EncodeEx.xmlEncode(e)+"</Axis><FilterType>"+PPSMA.EncodeEx.xmlEncode("0")+"</FilterType><Level></Level><Value1></Value1><Value2></Value2><Page>"+a+"</Page></Action>";this.makeNavigationRequest(d,b.y,b.x)},filter:function(b,c,d,i,g,e,f){a:;var a=this.$J_0(),h='<Action type="Filter"><Hierarchy>'+PPSMA.EncodeEx.xmlEncode(c)+"</Hierarchy><TupleXML>"+d+"</TupleXML><Axis>"+PPSMA.EncodeEx.xmlEncode(i)+"</Axis><FilterType>"+PPSMA.EncodeEx.xmlEncode(b)+"</FilterType><Level>"+PPSMA.EncodeEx.xmlEncode(g)+"</Level><Value1>"+PPSMA.EncodeEx.xmlEncode(e)+"</Value1><Value2>"+PPSMA.EncodeEx.xmlEncode(f)+"</Value2><Page>"+this.$P_0+"</Page></Action>";this.makeNavigationRequest(h,a.y,a.x)},sort:function(f,d,c,b){a:;var a=this.$J_0(),e='<Action type="Sort"><Axis>'+PPSMA.EncodeEx.xmlEncode(f)+"</Axis><TupleXML>"+d+"</TupleXML><SortType>"+PPSMA.EncodeEx.xmlEncode(c)+"</SortType><PreservePeerGroup>"+PPSMA.EncodeEx.xmlEncode(b)+"</PreservePeerGroup><Page>"+this.$P_0+"</Page></Action>";this.makeNavigationRequest(e,a.y,a.x)},loadCubeMetadata:function(a){a:;var b='<Action type="GetCubeMetadata"></Action>';this.makeCubeMetadataRequest(b,a)},getCellLevelActions:function(a){a:;var b='<Action type="CellLevelActions"><Tuple>'+a+"</Tuple></Action>";this.$3E_0(b,1)},getDimensionProperties:function(a,b){a:;this.$2J_0=b;var c='<Action type="DimensionProperties"><Member>'+a+"</Member></Action>";this.$3E_0(c,3)},getMeasureGroups:function(a){a:;this.$2L_0=a;var b='<Action type="MeasureGroups"><RetrieveKpis>'+this.$5_0.$c_0+"</RetrieveKpis></Action>";this.$3E_0(b,2)},$3E_0:function(c,b){var d="InfoBar:"+this.$1M_0+",History:"+this.$2N_0+",SingleView:"+this.$1u_0+",IsDesigner:"+this.$1N_0+",ActionXML:"+c.replace(":",""),e=new PPSMA.AjaxOlapRenderRequestRecord(this.$K_0,"OLAPGrid",this.$3_0,0,0,this.$a_0,"",c,d),f={requestRecord:e},a=new Sys.Net.WebRequest;a.get_headers()["Content-Type"]="application/json; charset=utf-8";a.get_headers()["MenuMetadata-Type"]=b===1?"CellActions":b===3?"DimensionData":b===2?"MeasureData":"None";a.set_url(this.$2t_0);a.set_body(Sys.Serialization.JavaScriptSerializer.serialize(f));a.set_httpVerb("POST");a.add_completed(this.$$d_$5o_0);a.invoke()},$5o_0:function(a){var e=0,d="";if(a.get_webRequest()){d=a.get_webRequest().get_headers()["MenuMetadata-Type"];e=d==="CellActions"?1:d==="DimensionData"?3:d==="MeasureData"?2:0}else this.$2S_0("The request was destroyed");if(a.get_responseAvailable()&&a.get_statusCode()===200){var f=PPSMA.WebRequestExecuterEx.simpleResult(a,"AjaxRenderResultRecord"),c=f.Html;if(!isNullOrUndefined(c)){var b;if(e===2){b=c.startsWith("<MeasureGroups");this.$1O_0=b?c:null;if(this.$2L_0){this.$2L_0(b);this.$2L_0=null}}else if(e===3){b=c.startsWith("<DimensionProperties");this.$1Y_0=b?c:null;if(this.$2J_0){this.$2J_0(b);this.$2J_0=null}}else if(e===1){b=c.startsWith("<AdditionalActions");this.$2r_0=b?c:null}else this.$2S_0("Unrecognized return type "+d)}else this.$2S_0("Response is blank")}else this.$2S_0("Menu metadata response "+(a.get_responseAvailable()?"available, ":"not available, ")+"StatusCode="+a.get_statusCode());a&&!a.get_aborted()&&a.abort()},notifyBrowserOfAsyncUpdate:function(a){a:;if(PPSMA.NewWindow.isInMoreAccessibleMode())if(a)notifyBrowserOfAsyncUpdate(a);else PPSMA.ReportsCommon.logErrorCondition("Couldn't notify browser of an asynchronous update.")},$2S_0:function(){},$5j_0:function(){a:;if(this.$H_0){this.$H_0.dispose();this.$H_0=null}},$4H_0:function(f,g,h,i){if(this.$H_0){this.$H_0.dispose();this.$H_0=null}var a=null;if(!isNullOrEmpty(this.$1R_0)&&!this.$1N_0)a=$get(this.$1R_0);else a=$get(PPSMA.Dashboard.contentBox);!a&&PPSMA.OlapViewContext.$1x("Waiting indicator target container item not found!!!!!!!");this.$H_0=new PPSMA.OlapWebRequest(a,this.$$d_$5j_0,this.$4G_0);a&&this.$H_0.show();this.$1L_0++;var b="InfoBar:"+this.$1M_0+",History:"+this.$2N_0+",SingleView:"+this.$1u_0+",IsDesigner:"+this.$1N_0,c=new PPSMA.AjaxOlapRenderRequestRecord(this.$K_0,i||"OLAPGrid",this.$3_0,g,h,this.$a_0,"",f,b),d={requestRecord:c},e=new PPSMA.WebRequestDetails(this.$2t_0,Sys.Serialization.JavaScriptSerializer.serialize(d),"POST","application/json; charset=utf-8",this.$$d_$5p_0);this.$H_0.submit(e)},makeNavigationRequest:function(a,b,c){a:;this.$4H_0(a,b,c,this.$p_0)},$4D_0:function(a){if(this.$1q_0){this.$1q_0(a);this.$1q_0=null}},$5p_0:function(a){if(a.get_aborted()){this.$4D_0(false);return}else this.$4D_0(true);this.$H_0.dispose();this.$H_0=null;if(this.$1u_0&&!this.$n_0){var e=$get(this.$K_0);this.$n_0=AjaxFX.HistoryManager.createHistory(e,this.$C_0+"plus.gif?"+this.$3_0+"|"+this.$a_0+"|1|"+this.$1L_0+"|"+this.$p_0);Sys.Browser.agent===Sys.Browser.Firefox&&this.$n_0.addEntry(this.$3_0+"|"+this.$a_0+"|1|"+this.$1L_0+"|"+this.$p_0);this.$n_0.add_navigated(this.$$d_$5l_0)}if(a.get_responseAvailable()&&a.get_statusCode()===200){var b;b=PPSMA.WebRequestExecuterEx.simpleResult(a,"AjaxRenderResultRecord");var d=false;if(!isNullOrUndefined(b))d=this.renderResult(b);if(this.$n_0&&!this.$2P_0)if(d&&!isNullOrEmpty(this.$a_0))this.$n_0.addEntry(this.$3_0+"|"+this.$a_0+"|"+this.$P_0+"|"+this.$1L_0+"|"+this.$p_0);else this.$n_0.addEntry(this.$3_0+"|error|1|"+this.$1L_0+"|"+this.$p_0)}else{if(null!==this.$K_0){var c=$get(this.$K_0);if(null!==c){c.style.position="static";c.innerHTML=this.$2y_0}}this.$n_0&&!this.$2P_0&&this.$n_0.addEntry(this.$3_0+"|error|1|"+this.$1L_0+"|"+this.$p_0)}this.$2P_0=false;this.notifyBrowserOfAsyncUpdate($get(this.$K_0))},makeCubeMetadataRequest:function(b,a){a:;if(this.$H_0){this.$H_0.dispose();this.$H_0=null}this.$H_0=new PPSMA.OlapWebRequest(null,null,"");this.$1L_0++;var c=new PPSMA.AjaxOlapMetadataRequestRecord(this.$K_0,"OlapMetadata",this.$3_0,a,this.$a_0,b),d={requestRecord:c},e=new PPSMA.WebRequestDetails(this.$4J_0,Sys.Serialization.JavaScriptSerializer.serialize(d),"POST","application/json; charset=utf-8",this.$$d_$5k_0);this.$H_0.submit(e)},$5k_0:function(b){if(this.$H_0){this.$H_0.dispose();this.$H_0=null}if(b.get_responseAvailable()&&b.get_statusCode()===200){var a;a=PPSMA.WebRequestExecuterEx.simpleResult(b,"AjaxRenderResultRecord");!isNullOrUndefined(a)&&this.renderMetadataResult(a)}},renderResult:function(record){a:;var $v_0=$get(this.$K_0);if(isNullOrUndefined($v_0))return false;if(!isNullUndefinedOrEmpty(record.Html))$v_0.innerHTML=record.Html;if(!isNullUndefinedOrEmpty(record.Script))try{eval(record.Script)}catch($v_1){alert($v_1.message)}else $v_0.style.position="static";return true},renderMetadataResult:function(record){a:;var $v_0=record.Script;if(!isNullOrEmpty($v_0))try{eval($v_0)}catch($v_1){alert($v_1.message)}},renderUpdate:function(){a:;var a=$get(this.$K_0);if(a){var b=PPSMA.OlapViewContext.$35();this.$4E_0=b.y;this.$4F_0=b.x;if(!isNullOrEmpty(this.$o_0)){var c=$get(this.$o_0);if(c){this.$5d_0=false;if(this.$p_0!=="OLAPDrillThrough")c.style.overflow="auto";var d=a.parentNode.style.overflow;a.parentNode.style.overflow="hidden";a.parentNode.style.overflow=d}}}},resize:function(){a:;if(PPSMA.SizeEx.getClientHeight()<=30)return;var a=$get(this.$K_0);if(a&&!isNullOrEmpty(this.$o_0)){var b=$get(this.$o_0);if(b){var c=PPSMA.OlapViewContext.$35();if(c.y!==this.$4E_0)b.style.height=a.offsetParent.offsetHeight-this.getPageHeadersHeight()-4+"px";if(c.x!==this.$4F_0)b.style.width=a.offsetParent.offsetWidth+"px"}}},$J_0:function(){a:;var a=null;if(!isNullOrEmpty(this.$1R_0))a=$get(this.$1R_0);return PPSMA.OlapViewContext.$5N(a)},dispose:function(){a:;this.$n_0&&this.$n_0.dispose();if(this.$H_0){this.$H_0.dispose();this.$H_0=null}delete PPSMA.OlapViewContext.globalIds[this.$3_0]},get_measures:function(){a:;return this.$5_0},getDimensionPropertiesList:function(a){a:;return this.$2G_0[a]},addDimensionPropertiesList:function(b,c,d){a:;var a=this.getDimensionPropertiesList(b);if(a)return a;a=new PPSMA.DimensionProperties(b,c,d);this.$2G_0[b]=a;return a}};PPSMA.ChangeMeasure=function(a){a:;this.$$d_handleRemoveMeasureLinkClick=Function.createDelegate(this,this.handleRemoveMeasureLinkClick);this.$$d_handleMoveDownLinkClick=Function.createDelegate(this,this.handleMoveDownLinkClick);this.$$d_handleMoveUpLinkClick=Function.createDelegate(this,this.handleMoveUpLinkClick);this.$$d_blurMeasureListOnTabToFieldList=Function.createDelegate(this,this.blurMeasureListOnTabToFieldList);this.$$d_handleMeasureNameLinkFocus=Function.createDelegate(this,this.handleMeasureNameLinkFocus);this.$$d_handleMeasureNameLinkClick=Function.createDelegate(this,this.handleMeasureNameLinkClick);this.$$d_handleMeasureNameDivClick=Function.createDelegate(this,this.handleMeasureNameDivClick);this.$$d_handleMeasureNameDivKeydown=Function.createDelegate(this,this.handleMeasureNameDivKeydown);this.$$d_handleMeasureNameDivKeyup=Function.createDelegate(this,this.handleMeasureNameDivKeyup);this.$$d_$2s_0=Function.createDelegate(this,this.$2s_0);this.$$d_closeChangeMeasureDialog=Function.createDelegate(this,this.closeChangeMeasureDialog);this.$$d_handleOKButtonFocus=Function.createDelegate(this,this.handleOKButtonFocus);this.$$d_applyNewMeasureSelection=Function.createDelegate(this,this.applyNewMeasureSelection);this.$$d_handleTabMoverLinkKeydown=Function.createDelegate(this,this.handleTabMoverLinkKeydown);this.$$d_$5T_0=Function.createDelegate(this,this.$5T_0);this.$$d_setInitialFocus=Function.createDelegate(this,this.setInitialFocus);this.$$d_handleThinFieldListItemSelected=Function.createDelegate(this,this.handleThinFieldListItemSelected);this.$1b_0=[];this.$0_0=a;this.$10_0=new PPSMA.ThinFieldList(this.$0_0,true,false);this.$10_0.add_itemSelected(this.$$d_handleThinFieldListItemSelected);this.$19_0=this.$0_0.$3_0+"_DragContainer";this.$3a_0=this.$0_0.$3_0+"_CmId";this.$26_0=this.$0_0.$3_0+"MeasureGroupsDropDownSelect"};PPSMA.ChangeMeasure.prototype={$0_0:null,$10_0:null,$1E_0:null,$x_0:null,$1W_0:null,$f_0:null,$19_0:null,$3a_0:null,$26_0:null,$5C_0:null,setCallbackMethod:function(a){a:;this.$x_0=a},get_selectedButton:function(){a:;return this.$f_0},show:function(){a:;this.initializeChangeMeasureDiv();this.$10_0.showInChangeMeasure();window.setTimeout(this.$$d_setInitialFocus,500);this.$4j_0()},$4j_0:function(){a:;var a=$get("tabMoverLinkId");if(a){$addHandler(a,"click",this.$$d_$5T_0);$addHandler(a,"keydown",this.$$d_handleTabMoverLinkKeydown)}var b=$get("okLinkId");if(b){$addHandler(b,"click",this.$$d_applyNewMeasureSelection);$addHandler(b,"focus",this.$$d_handleOKButtonFocus)}var c=$get("cancelLinkId");c&&$addHandler(c,"click",this.$$d_closeChangeMeasureDialog)},$5r_0:function(){a:;!PPSMA.DialogsCommon.removeWindowResizeEventHandler(this.$1W_0)&&PPSMA.ReportsCommon.logErrorCondition("ChangeMeasure: couldn't remove the resize event handlers");this.$1W_0=null},setInitialFocus:function(){a:;if(!PPSMA.NewWindow.isInMoreAccessibleMode())this.skipToMeasureList();else this.showAndActivateSkipToLink()},showAndActivateSkipToLink:function(){a:;var a=$get("tabMoverDivId");if(a){a.style.display="block";var b=$get("tabMoverLinkId");if(b)b.focus();else PPSMA.ReportsCommon.logErrorCondition("SetInitialFocus: couldn't find anchor tabMoverLinkId to focus on it.")}else PPSMA.ReportsCommon.logErrorCondition("SetInitialFocus: couldn't find div tabMoverDivId to make it visible.")},initializeChangeMeasureDiv:function(){a:;var a=document.createElement("div");a.id=this.$3a_0;a.className="ms-bichangemeasures-main";a.title=PPSMA.SR.OlapChangeMeasure_DialogAltText;a.setAttribute("alt",PPSMA.SR.OlapChangeMeasure_DialogAltText);document.body.appendChild(a);var h=document.createElement("div");h.className="ms-bichangemeasures-tabmover";h.id="tabMoverDivId";a.appendChild(h);var e=document.createElement("a");e.href="javascript:;";e.id="tabMoverLinkId";e.title=PPSMA.SR.OlapChangeMeasure_SkipToMeasureList;e.className="ms-bichangemeasures-tabmoverlink";PPSMA.DomElementEx.setInnerText(e,PPSMA.SR.OlapChangeMeasure_SkipToMeasureList);h.appendChild(e);var f=document.createElement("div");f.id="aboveFooterLayoutDivId";f.className="ms-bichangemeasures-content";a.appendChild(f);var k=document.createElement("div");k.id="flId";k.className="ms-bichangemeasures-fieldlist";f.appendChild(k);var i=document.createElement("div");i.id="mlId";i.className="ms-bichangemeasures-measurelist";f.appendChild(i);var l=document.createElement("div");l.id=this.$19_0;l.className="ms-bichangemeasures-dragcontainer";i.appendChild(l);var g=document.createElement("div");g.id="cmfId";g.className="ms-bichangemeasures-thinfieldlistfooter";a.appendChild(g);var c=document.createElement("input");c.type="button";c.id="okLinkId";c.value=PPSMA.SR.OlapChangeMeasure_Ok;c.title=PPSMA.SR.OlapChangeMeasure_Ok;c.setAttribute("alt",PPSMA.SR.OlapChangeMeasure_Ok);c.className="ms-bichangemeasures-thinfieldlistapply";g.appendChild(c);var d=document.createElement("input");d.type="button";d.id="cancelLinkId";d.value=PPSMA.SR.OlapChangeMeasure_Cancel;d.title=PPSMA.SR.OlapChangeMeasure_Cancel;d.setAttribute("alt",PPSMA.SR.OlapChangeMeasure_Cancel);d.className="ms-bichangemeasures-thinfieldlistcancel";g.appendChild(d);var j=document.createElement("div");j.className="ms-bichangemeasures-positioningparent";j.appendChild(a);var m=PPSMA.SizeEx.getCenterXandY(PPSMA.ScriptConstants.defaultDialogWidth,PPSMA.ScriptConstants.defaultDialogHeight),b=new SP.UI.DialogOptions;b.height=PPSMA.ScriptConstants.defaultDialogHeight;b.width=PPSMA.ScriptConstants.defaultDialogWidth;b.allowMaximize=true;b.title=PPSMA.SR.OlapChangeMeasure_DialogTitle;b.html=j;b.html.innerHTML=j.innerHTML;PPSMA.DomElementEx.removeElement(a);b.x=m.x;b.y=m.y;b.dialogReturnValueCallback=this.$$d_$2s_0;this.$1E_0=SP.UI.ModalDialog.showModalDialog(b)},handleOKButtonFocus:function(){a:;this.focusOnlyMeasure("deadbeefdeadbeefdeadbeef")},deleteUpDownRemove:function(){a:;var a=$get("udrControlButtonsDiv");a&&a.parentNode.removeChild(a)},handleThinFieldListItemSelected:function(f,a){a:;if(f){var d=$get(this.$19_0);if(a.itemIsSelected){if(!Array.contains(this.$1b_0,a.itemUniqueName))if(d){var b=document.createElement("div");d.appendChild(b);b.id=a.itemUniqueName;b.className="ms-bichangemeasures-dragboxitems";b.title=a.itemCaption;$addHandler(b,"keyup",this.$$d_handleMeasureNameDivKeyup);$addHandler(b,"keydown",this.$$d_handleMeasureNameDivKeydown);$addHandler(b,"click",this.$$d_handleMeasureNameDivClick);var c=document.createElement("a");b.appendChild(c);c.id="msNameId"+a.itemUniqueName;c.setAttribute("href","#");c.className="ms-bichangemeasures-dragboxitemslink";PPSMA.DomElementEx.setInnerText(c,a.itemCaption);$addHandler(c,"click",this.$$d_handleMeasureNameLinkClick);$addHandler(c,"focus",this.$$d_handleMeasureNameLinkFocus);$addHandler(c,"keydown",this.$$d_blurMeasureListOnTabToFieldList);Array.add(this.$1b_0,a.itemUniqueName);this.focusOnlyMeasure(a.itemUniqueName)}else PPSMA.ReportsCommon.logErrorCondition("can't add measures to the drag container div "+this.$19_0+" because it couldn't be found")}else{var e=$get(a.itemUniqueName),g=e.parentNode;g.removeChild(e);Array.remove(this.$1b_0,a.itemUniqueName)}}else PPSMA.ReportsCommon.logErrorCondition("HandleThinFieldListItemSelected sender was NULL!")},$2s_0:function(a){this.$5r_0();this.$f_0="2";if(a===1){this.$f_0="1";this.$0_0.setOuterTagAttribute("MeasureGroupName",this.$0_0.$5_0.get_measureGroupName());this.$0_0.applyMeasureSelectorChanges()}Array.clear(this.$1b_0);this.$x_0&&this.$x_0()},closeChangeMeasureDialog:function(){a:;this.$1E_0.close(0)},applyNewMeasureSelection:function(){a:;this.defineMeasureOrder();this.$1E_0.close(1)},defineMeasureOrder:function(){a:;for(var b=$get(this.$19_0),a=0;a<b.childNodes.length;a++){var c=b.childNodes[a];if(c){var d=c.id;this.$10_0.reOrderItem(d,a)}}},handleMeasureNameLinkClick:function(){},handleMeasureNameLinkFocus:function(a){a:;this.focusOnlyMeasure(a.target.parentNode.id)},blurMeasureListOnTabToFieldList:function(b){a:;var a=b.target.parentNode;if(a)if(!Sys.UI.DomElement.containsCssClass(a,"ms-bichangemeasures-dragboxitems"))PPSMA.ReportsCommon.logErrorCondition("BlurMeasureListOnTabToFieldList: i'm not so sure we have a valid measure, we have tag="+a.tagName+", ID="+a.id+", className="+a.className);else b.keyCode===9&&b.shiftKey&&a.id===a.parentNode.firstChild.id&&this.focusOnlyMeasure("deadbeefdeadbeefdeadbeef");else PPSMA.ReportsCommon.logErrorCondition("BlurMeasureListOnTabToFieldList: couldn't get a measure dragbox from event target "+b.target.id)},moveMeasureUp:function(a){a:;var b=a.parentNode,c=a.id;if(a.previousSibling){b.insertBefore(a,a.previousSibling);this.focusMeasureAndMeasureNameLink(c)}},moveMeasureDown:function(a){a:;var b=a.parentNode,c=a.id;if(a.nextSibling){b.insertBefore(a.nextSibling,a);this.focusMeasureAndMeasureNameLink(c)}},removeMeasureFromList:function(a){a:;var b=a.id;if(this.$10_0.deSelectItem(b)){a.parentNode.removeChild(a);Array.remove(this.$1b_0,b)}},handleRemoveMeasureLinkClick:function(c){a:;if(this.$10_0)if(!this.$10_0.$s_0)return;var b=null,a=null;if(PPSMA.DomElementEx.tagsMatch(c.target.tagName,"img"))b=c.target.parentNode.parentNode.parentNode;else if(PPSMA.DomElementEx.tagsMatch(c.target.tagName,"a"))b=c.target.parentNode.parentNode;else PPSMA.ReportsCommon.logErrorCondition("HandleRemoveMeasureLinkClick: unidentified tag="+c.target.tagName+" id="+c.target.id);if(b){if(b.nextSibling)a=b.nextSibling;else if(b.previousSibling)a=b.previousSibling;else{a=$get("_ScrollList");if(a){var d=a.getElementsByTagName("input");a=d&&d.length>0?d[0]:null}}this.removeMeasureFromList(b);if(a&&Sys.UI.DomElement.containsCssClass(a,"ms-bichangemeasures-dragboxitems"))this.focusMeasureAndMeasureNameLink(a.id);else if(a&&a.className==="chgMeasTflListCheckBox")try{a.focus()}catch(f){try{var e=$get(this.$26_0);if(e)e.focus();else PPSMA.ReportsCommon.logErrorCondition("HandleRemoveMeasureLinkClick: couldn't find ID='"+this.$26_0+"' to focus.")}catch(g){PPSMA.ReportsCommon.logErrorCondition("HandleRemoveMeasureLinkClick: couldn't focus ID='"+this.$26_0+"' to focus.")}}else PPSMA.ReportsCommon.logErrorCondition("HandleRemoveMeasureLinkClick: couldn't find anything to focus.")}else PPSMA.ReportsCommon.logErrorCondition("HandleRemoveMeasureLinkClick: couldn't find anything to delete.")},focusOnlyMeasure:function(c){a:;var a=$get(this.$19_0);if(!a){PPSMA.ReportsCommon.logErrorCondition("FocusOnlyMeasure: can't find div "+this.$19_0);return}for(var b=0;b<a.childNodes.length;b++)if(c===a.childNodes[b].id)this.focusMeasure(a.childNodes[b]);else this.blurMeasure(a.childNodes[b])},focusMeasureAndMeasureNameLink:function(a){a:;this.focusOnlyMeasure(a);var b=$get(a);if(b&&b.firstChild)b.firstChild.focus();else PPSMA.ReportsCommon.logErrorCondition("FocusMeasureAndMeasureNameLink: couldn't focus measure and its first child for "+a)},handleMeasureNameDivKeydown:function(a){a:;var b=a.keyCode;if(b===38||b===40){a.stopPropagation();a.preventDefault()}},handleMeasureNameDivKeyup:function(a){a:;var c=a.keyCode;if(c===38||c===40){var b=null;if(PPSMA.DomElementEx.tagsMatch(a.target.tagName,"a")&&a.target.id.startsWith("msNameId"))b=a.target.parentNode;else if(PPSMA.DomElementEx.tagsMatch(a.target.tagName,"a")&&(a.target.id==="removelinkId"||a.target.id==="downLinkId"||a.target.id==="upLinkId"))b=a.target.parentNode.parentNode;else if(PPSMA.DomElementEx.tagsMatch(a.target.tagName,"img"))b=a.target.parentNode.parentNode.parentNode;if(c===38&&b&&b.previousSibling)this.focusMeasureAndMeasureNameLink(b.previousSibling.id);else c===40&&b&&b.nextSibling&&this.focusMeasureAndMeasureNameLink(b.nextSibling.id);a.stopPropagation();a.preventDefault()}},handleMoveUpLinkClick:function(a){a:;if(PPSMA.DomElementEx.tagsMatch(a.target.tagName,"img"))this.moveMeasureUp(a.target.parentNode.parentNode.parentNode);else if(PPSMA.DomElementEx.tagsMatch(a.target.tagName,"a"))this.moveMeasureUp(a.target.parentNode.parentNode);else PPSMA.ReportsCommon.logErrorCondition("HandleMoveUpLinkClick: unidentified tag="+a.target.tagName+" id="+a.target.id)},handleMoveDownLinkClick:function(a){a:;if(PPSMA.DomElementEx.tagsMatch(a.target.tagName,"img"))this.moveMeasureDown(a.target.parentNode.parentNode.parentNode);else if(PPSMA.DomElementEx.tagsMatch(a.target.tagName,"a"))this.moveMeasureDown(a.target.parentNode.parentNode);else PPSMA.ReportsCommon.logErrorCondition("HandleMoveDownLinkClick: unidentified tag="+a.target.tagName+" id="+a.target.id)},skipToMeasureList:function(){a:;this.$37_0();var a=$get(this.$19_0);if(a&&a.hasChildNodes()&&a.firstChild.hasChildNodes()){getBrowserIs().ie55up&&this.focusMeasure(a.firstChild);a.firstChild.firstChild.focus();getBrowserIs().ie55up&&a.firstChild.firstChild.setActive()}else PPSMA.ReportsCommon.logErrorCondition("SkipToMeasureList: couldn't find the drag container or it doesn't have any measure children divs.")},$5T_0:function(){this.$37_0();this.skipToMeasureList()},handleTabMoverLinkKeydown:function(a){a:;a.keyCode===9&&this.$37_0()},$37_0:function(){a:;var a=$get("tabMoverDivId");if(a)a.style.display="none";else PPSMA.ReportsCommon.logErrorCondition("coudln't find div tabMoverDivId so that we could hide it")},handleMeasureNameDivClick:function(a){a:;var b;if(PPSMA.DomElementEx.tagsMatch(a.target.tagName,"a")||PPSMA.DomElementEx.tagsMatch(a.target.tagName,"img"))if(a.target.id==="upLinkId"||a.target.id==="muLinkImage"||a.target.id==="downLinkId"||a.target.id==="mdLinkImage"||a.target.id==="removelinkId"||a.target.id==="rmLinkImage")return;if(PPSMA.DomElementEx.tagsMatch(a.target.tagName,"div")&&a.target.id==="udrControlButtonsDiv")b=a.target.parentNode;else if(PPSMA.DomElementEx.tagsMatch(a.target.tagName,"a")&&Sys.UI.DomElement.containsCssClass(a.target,"ms-bichangemeasures-dragboxitemslink"))b=a.target.parentNode;else b=a.target;if(b&&Sys.UI.DomElement.containsCssClass(b,"ms-bichangemeasures-dragboxitems"))this.focusOnlyMeasure(b.id);else PPSMA.ReportsCommon.logErrorCondition("couldn't find measure div")},focusMeasure:function(f){a:;this.$5C_0=f;this.deleteUpDownRemove();!Sys.UI.DomElement.containsCssClass(f,"ms-bichangemeasures-dragboxselecteditem")&&Sys.UI.DomElement.addCssClass(f,"ms-bichangemeasures-dragboxselecteditem");var b=document.createElement("div");b.id="udrControlButtonsDiv";b.className="ms-bichangemeasures-dragboxitemsbuttonbar";var g=document.createElement("a");g.href="#";g.id="upLinkId";b.appendChild(g);$addHandler(g,"click",this.$$d_handleMoveUpLinkClick);var c=document.createElement("img");c.id="muLinkImage";c.src=this.$0_0.$C_0+"pps_moveup.gif";c.title=PPSMA.SR.OlapChangeMeasure_MoveUp;c.alt=PPSMA.SR.OlapChangeMeasure_MoveUp;c.className="ms-bichangemeasures-dragboxitemimageup";g.appendChild(c);var h=document.createElement("a");h.href="#";h.id="downLinkId";b.appendChild(h);$addHandler(h,"click",this.$$d_handleMoveDownLinkClick);var d=document.createElement("img");d.src=this.$0_0.$C_0+"pps_movedown.gif";d.id="mdLinkImage";d.title=PPSMA.SR.OlapChangeMeasure_MoveDown;d.alt=PPSMA.SR.OlapChangeMeasure_MoveDown;d.className="ms-bichangemeasures-dragboxitemimagedown";h.appendChild(d);var e=document.createElement("a");e.href="#";e.id="removelinkId";b.appendChild(e);$addHandler(e,"click",this.$$d_handleRemoveMeasureLinkClick);e.disabled=!this.$10_0.$s_0;var a=document.createElement("img");a.src=this.$0_0.$C_0+"pps_remove.gif";a.id="rmLinkImage";a.title=PPSMA.SR.OlapChangeMeasure_Remove;a.alt=PPSMA.SR.OlapChangeMeasure_Remove;a.className="ms-bichangemeasures-dragboxitemimagedelete";a.disabled=!this.$10_0.$s_0;e.appendChild(a);f.appendChild(b);f.firstChild.focus()},blurMeasure:function(a){a:;if(a){Sys.UI.DomElement.removeCssClass(a,"ms-bichangemeasures-dragboxselecteditem");while(a.childNodes.length>1)a.removeChild(a.lastChild)}}};PPSMA.FilterDialogConstants=function(){};PPSMA.ValueFilterDialogConstants=function(){};PPSMA.TopFilterDialogConstants=function(){};PPSMA.FilterDialog=function(a,b){a:;this.$$d_wrapFocus=Function.createDelegate(this,this.wrapFocus);this.$$d_handleClearFilterKeyEvent=Function.createDelegate(this,this.handleClearFilterKeyEvent);this.$$d_$6A_0=Function.createDelegate(this,this.$6A_0);this.$$d_$3T_0=Function.createDelegate(this,this.$3T_0);this.$$d_$45_0=Function.createDelegate(this,this.$45_0);this.$$d_$6B_0=Function.createDelegate(this,this.$6B_0);this.$$d_$3U_0=Function.createDelegate(this,this.$3U_0);this.$$d_$5J_0=Function.createDelegate(this,this.$5J_0);this.$$d_$4d_0=Function.createDelegate(this,this.$4d_0);this.$$d_$5I_0=Function.createDelegate(this,this.$5I_0);this.$$d_cancel=Function.createDelegate(this,this.cancel);this.$$d_apply=Function.createDelegate(this,this.apply);this.$$d_clear=Function.createDelegate(this,this.clear);this.$$d_$2s_0=Function.createDelegate(this,this.$2s_0);this.$0_0=a;this.$1f_0=null;this.$25_0=b;if(a){this.$2_0=this.$0_0.$3_0;this.$U_0=a.$C_0;this.$2j_0=a.$o_0}this.$f_0="0";this.$1U_0=false};PPSMA.FilterDialog.$g=function(b){if(!b)return "";var c=b,a=c.value;if(!a)a="";return a};PPSMA.FilterDialog.$5y=function(a,c){if(!a)return;var b=a;b.value=c};PPSMA.FilterDialog.$4N=function(a,e){var b=a;if(a.length>1&&a.endsWith("%")){a=a.substring(0,a.length-1);b=a;if(!e)try{var c=parseFloat(a);c=c/100;b=c.toString()}catch(d){b=a}}return b};PPSMA.FilterDialog.$3k=function(c,d,b,e,f){var a=document.createElement("span");if(b)a.id=b;a.className=e?"ms-bifilter-itemhidden":f;a.innerHTML=d;c.appendChild(a)};PPSMA.FilterDialog.$5s=function(a){a.click=""};PPSMA.FilterDialog.prototype={toP_FILTER:1,bottoM_FILTER:4,valuE_EQUALS:7,valuE_NOT_EQUAL:8,valuE_GREATER_THAN:9,valuE_GREATER_THAN_OR_EQUAL:10,valuE_LESS_THAN:11,valuE_LESS_THAN_OR_EQUAL:12,valuE_BETWEEN:13,valuE_NOT_BETWEEN:14,$7_0:0,$12_0:null,$1p_0:0,$Z_0:null,$2B_0:100,$l_0:0,$2o_0:null,$1B_0:null,$N_0:null,$O_0:null,$x_0:null,$y_0:null,$3Z_0:null,$f_0:null,$1U_0:false,$1f_0:null,$2T_0:null,$11_0:null,$U_0:null,$2j_0:null,$q_0:null,$0_0:null,$25_0:null,get_thousandSeparator:function(){a:;var a=this.$0_0.$3N_0;return a},get_decimalPoint:function(){a:;var a=this.$0_0.$2v_0;return a},$2_0:null,$2l_0:null,$4g_0:null,get_currentCell:function(){a:;return this.$1f_0},set_currentCell:function(a){a:;this.$1f_0=a;return a},get_filterType:function(){a:;return this.$7_0},set_filterType:function(a){a:;this.$7_0=a;return a},get_value1:function(){a:;return this.$12_0},set_value1:function(a){a:;this.$1p_0=this.$1y_0(a);this.$12_0=a;return a},get_value2:function(){a:;return this.$Z_0},set_value2:function(a){a:;this.$2B_0=this.$1y_0(a);this.$Z_0=a;return a},get_tupleIndex:function(){a:;return this.$l_0},set_tupleIndex:function(a){a:;this.$l_0=a;return a},get_tupleXML:function(){a:;return this.$2o_0},set_tupleXML:function(a){a:;this.$2o_0=a;return a},get_hierarchyName:function(){a:;return this.$1B_0},set_hierarchyName:function(a){a:;this.$1B_0=a;return a},get_axis:function(){a:;return this.$N_0},set_axis:function(a){a:;this.$N_0=a;return a},get_levelName:function(){a:;return this.$O_0},set_levelName:function(a){a:;this.$O_0=a;return a},setCallbackMethod:function(a){a:;this.$x_0=a},get_dimensionName:function(){a:;return this.$y_0},set_dimensionName:function(a){a:;this.$y_0=a;return a},get_callback:function(){a:;return this.$3Z_0},set_callback:function(a){a:;this.$3Z_0=a;return a},get_selectedButton:function(){a:;return this.$f_0},set_selectedButton:function(a){a:;this.$f_0=a;return a},get_showClearOption:function(){a:;return this.$1U_0},set_showClearOption:function(a){a:;this.$1U_0=a;return a},get_tupleOptionList:function(){a:;return this.$11_0},set_tupleOptionList:function(a){a:;this.$11_0=a;return a},get_proxyID:function(){a:;return this.$2_0},set_proxyID:function(a){a:;this.$2_0=a;return a},get_resourcePath:function(){a:;return this.$U_0},set_resourcePath:function(a){a:;this.$U_0=a;return a},get_innerTargetID:function(){a:;return this.$2j_0},set_innerTargetID:function(a){a:;this.$2j_0=a;return a},$3x_0:function(e,f,g,c,d){var b=PPSMA.SizeEx.getCenterXandY(c,d),a=new SP.UI.DialogOptions;a.height=d;a.width=c;a.title=f;a.showMaximized=false;a.allowMaximize=false;a.html=g;a.x=b.x;a.y=b.y;a.dialogReturnValueCallback=this.$$d_$2s_0;this.$2T_0=SP.UI.ModalDialog.showModalDialog(a);this.focusFirstElement();this.$4n_0(e)},focusFirstElement:function(){a:;var a=$get(this.$2_0+(this.$7_0<7?"IDTopFilterOptionsDropdown":"IDValueFilterTupleDropdown"));a&&a.focus()},$2s_0:function(a){if(a===1)this.$x_0&&this.$x_0()},$4n_0:function(a){var e=$get(this.$2_0+"IDClearFilterBtn"+a);$addHandler(e,"click",this.$$d_clear);var f=$get(this.$2_0+"IDFilterApply"+a);$addHandler(f,"click",this.$$d_apply);var g=$get(this.$2_0+"IDFilterCancel"+a);$addHandler(g,"click",this.$$d_cancel);var h=a==="IDValueFilterDialog"?1:2;switch(h){case 1:var b=$get(this.$2_0+"IDValueFilterInput1");$addHandler(b,"change",this.$$d_$5I_0);$addHandler(b,"keyup",this.$$d_$4d_0);var c=$get(this.$2_0+"IDValueFilterInput2");$addHandler(c,"change",this.$$d_$5J_0);$addHandler(c,"keyup",this.$$d_$3U_0);var i=$get(this.$2_0+"IDValueFilterOptionsDropdown");$addHandler(i,"change",this.$$d_$6B_0);break;case 2:var d=$get(this.$2_0+"IDTopFilterInput");$addHandler(d,"change",this.$$d_$45_0);$addHandler(d,"keyup",this.$$d_$3T_0);var j=$get(this.$2_0+"IDTopVarOptionsDropdown");$addHandler(j,"change",this.$$d_$6A_0)}},showValueFilterDlg:function(){a:;this.$2l_0=this.$Z_0;if(!this.$O_0||this.$O_0==="")this.$O_0=this.$33_0();this.$q_0=this.$5R_0();if(!this.$q_0)this.$q_0=this.$5A_0();this.$q_0.style.visibility="visible";var a=document.createElement("div");a.className="ms-bifilter-main";a.appendChild(this.$q_0);var b=PPSMA.SR.OlapFilter_ValueFilterHeader+" "+this.$O_0;this.$3x_0("IDValueFilterDialog",b,a,PPSMA.ScriptConstants.analyticReportsValueFilterDialogWidth,PPSMA.ScriptConstants.analyticReportsValueFilterDialogHeight)},showTopFilterDlg:function(){a:;if(!this.$O_0||this.$O_0==="")this.$O_0=this.$33_0();this.$q_0=this.$5Q_0();if(!this.$q_0)this.$q_0=this.$57_0();this.$q_0.style.visibility="visible";var a=document.createElement("div");a.className="ms-bifilter-main";a.appendChild(this.$q_0);var b=PPSMA.SR.OlapFilter_TopFilterHeader+" "+this.$O_0;this.$3x_0("IDTopFilterDialog",b,a,PPSMA.ScriptConstants.analyticReportsTopFilterDialogWidth,PPSMA.ScriptConstants.analyticReportsTopFilterDialogHeight)},$1y_0:function(a){if(a.indexOf(this.get_thousandSeparator())>=0&&a.indexOf(this.get_decimalPoint())>=0){a=a.split(this.get_thousandSeparator()).join("");a=a.split(this.get_decimalPoint()).join(".")}else if(a.indexOf(this.get_thousandSeparator())>=0&&!(a.indexOf(this.get_decimalPoint())>=0))a=a.split(this.get_thousandSeparator()).join("");else if(!(a.indexOf(this.get_thousandSeparator())>=0)&&a.indexOf(this.get_decimalPoint())>=0)a=a.split(this.get_decimalPoint()).join(".");var b=Number.parseInvariant(a);if(!isNaN(b))return b;else return 0},loadFilterDialog:function(f,d,i,g,b,c,h,m){a:;this.$7_0=parseInt(f);var j=this.$7_0<7?false:true;this.$1B_0=g;this.$1f_0=h;this.$O_0=i;this.$N_0=m;this.$12_0=b;this.$1p_0=this.$1y_0(b);this.$Z_0=c;this.$2B_0=this.$1y_0(c);this.$1U_0=true;var k=this.$31_0();this.$4g_0=d;var e=this.$34_0();this.$l_0=0;for(var a=0;a<e.length;a++){var l=e[a]+k;if(!l.indexOf(d)){this.$l_0=a;break}}if(j)this.showValueFilterDlg();else this.showTopFilterDlg()},$5R_0:function(){a:;var a=$get(this.$2_0+"IDValueFilterDialog");if(!a)return null;this.$4T_0(PPSMA.SR.OlapFilter_ValueFilterHeader+"&nbsp;"+this.$O_0);this.$4U_0("IDValueFilterOptionsDropdown");this.$4W_0("IDValueFilterTupleDropdown");this.$4V_0("IDValueFilterInput1");this.$5v_0("IDValueFilterAndLabel");this.$5z_0("IDValueFilterInput2");this.$4Q_0("IDValueFilterDialog");return a},$5A_0:function(){a:;var a=this.$59_0(PPSMA.SR.OlapFilter_ValueFilterText),b=this.$3t_0("IDValueFilterDialog",a,PPSMA.ScriptConstants.analyticReportsValueFilterDialogWidth,PPSMA.ScriptConstants.analyticReportsValueFilterDialogHeight);return b},$59_0:function(b){var a=this.$3s_0(b);a.appendChild(this.$5B_0());a.appendChild(this.$3y_0("IDValueFilterDialog","ms-bifilter-numericvalidationwarningdiv"));return a},$5B_0:function(){a:;var d=this.$2_0+"IDValueFilterInputDiv",b=$get(d);if(!b){b=document.createElement("div");b.id=d;b.className="ms-bivfilter-inputsdiv";var e=document.createElement("div");this.$3o_0(e,this.$2_0+"IDValueFilterTupleDropdown",this.$l_0,PPSMA.ValueFilterDialogConstants.tupleOptionsTI);b.appendChild(e);var c=document.createElement("div");c.className="ms-bifilter-valuefilterinputparent";this.$4v_0(c,PPSMA.ValueFilterDialogConstants.filterOptionsTI);var a=$get(this.$2_0+"IDValueFilterInputsAndLabelWrapper");if(isNullOrEmpty(a)){a=document.createElement("div");a.id=this.$2_0+"IDValueFilterInputsAndLabelWrapper";a.className="ms-bifilter-valuefilterinputsizer";c.appendChild(a)}this.$2q_0(a,this.$7_0,this.$1p_0,this.$2_0+"IDValueFilterInput1",this.$7_0<this.valuE_BETWEEN?"ms-bifilter-valuefilterinput":"ms-bifilter-inputforbetween",true,PPSMA.ValueFilterDialogConstants.input1TI);PPSMA.FilterDialog.$3k(a,PPSMA.SR.OlapFilter_AndLabel,this.$2_0+"IDValueFilterAndLabel",this.$7_0<this.valuE_BETWEEN?true:false,"ms-bifilter-labelforbetween");this.$2q_0(a,this.$7_0,this.$2B_0,this.$2_0+"IDValueFilterInput2","ms-bifilter-inputforbetween ms-bifilter-inputforbetween2",this.$7_0<this.valuE_BETWEEN?false:true,PPSMA.ValueFilterDialogConstants.input2TI);b.appendChild(c)}return b},$4d_0:function(){if(this.$2R_0()){this.$1d_0(false);return}var d=$get(this.$2_0+"IDValueFilterInput1"),a=this.$2U_0(d,1,true,true,this.get_thousandSeparator(),this.get_decimalPoint(),0,0,false,String.format(PPSMA.SR.OlapFilter_Number,"0"),"IDValueFilterDialog");if(a){var b=$get(this.$2_0+"IDValueFilterInput2"),c="";if(b)c=PPSMA.FilterDialog.$g(b);var e=this.$3B_0(c,true,true,this.get_thousandSeparator());if(e>0)a=false}this.$1d_0(a)},$3U_0:function(){if(this.$2R_0()){this.$1d_0(false);return}var b=$get(this.$2_0+"IDValueFilterInput2"),a=this.$2U_0(b,2,true,true,this.get_thousandSeparator(),this.get_decimalPoint(),0,0,false,String.format(PPSMA.SR.OlapFilter_Number,"0"),"IDValueFilterDialog");if(a){this.$2l_0=PPSMA.FilterDialog.$g(b);var c=$get(this.$2_0+"IDValueFilterInput1"),d="";if(c)d=PPSMA.FilterDialog.$g(c);var e=this.$3B_0(d,true,true,this.get_thousandSeparator());if(e>0)a=false}this.$1d_0(a)},$5I_0:function(a){this.$4d_0(a);this.$3R_0($get(this.$2_0+"IDValueFilterInput1"),false)},$5J_0:function(a){this.$3U_0(a);this.$3R_0($get(this.$2_0+"IDValueFilterInput2"),false)},$3R_0:function(a,d){if(!a)return;var c=a.value,b=this.$1y_0(c);if(!isNaN(b))a.value=this.getFormattedStringFromInvariantNumber(b,d)},$4v_0:function(m,c){var a=document.createElement("select"),d=this.$2_0+"IDValueFilterOptionsDropdown";a.id=d;c!==-1&&a.setAttribute("tabindex",c);a.className="ms-bifilter-valueoptionsdropdown";var b=false;if(this.$7_0<7||this.$7_0>14)b=true;var e=this.$R_0(this.valuE_EQUALS.toString(),PPSMA.SR.OlapFilter_Equals,this.$7_0===this.valuE_EQUALS);a.appendChild(e);var f=this.$R_0(this.valuE_NOT_EQUAL.toString(),PPSMA.SR.OlapFilter_NotEqual,this.$7_0===this.valuE_NOT_EQUAL);a.appendChild(f);var g=this.$R_0(this.valuE_GREATER_THAN.toString(),PPSMA.SR.OlapFilter_GreaterThan,b||this.$7_0===this.valuE_GREATER_THAN);a.appendChild(g);var h=this.$R_0(this.valuE_GREATER_THAN_OR_EQUAL.toString(),PPSMA.SR.OlapFilter_GreaterThanOrEqual,this.$7_0===this.valuE_GREATER_THAN_OR_EQUAL);a.appendChild(h);var i=this.$R_0(this.valuE_LESS_THAN.toString(),PPSMA.SR.OlapFilter_LessThan,this.$7_0===this.valuE_LESS_THAN);a.appendChild(i);var j=this.$R_0(this.valuE_LESS_THAN_OR_EQUAL.toString(),PPSMA.SR.OlapFilter_LessThanOrEqual,this.$7_0===this.valuE_LESS_THAN_OR_EQUAL);a.appendChild(j);var k=this.$R_0(this.valuE_BETWEEN.toString(),PPSMA.SR.OlapFilter_Between,this.$7_0===this.valuE_BETWEEN);a.appendChild(k);var l=this.$R_0(this.valuE_NOT_BETWEEN.toString(),PPSMA.SR.OlapFilter_NotBetween,this.$7_0===this.valuE_NOT_BETWEEN);a.appendChild(l);m.appendChild(a)},$6B_0:function(){var b=$get(this.$2_0+"IDValueFilterOptionsDropdown");if(b){var f=b,g=b.getElementsByTagName("option"),h=PPSMA.FilterDialog.$g(g[f.selectedIndex]),c=parseInt(h),d=$get(this.$2_0+"IDValueFilterInput1"),a=$get(this.$2_0+"IDValueFilterInput2"),e=$get(this.$2_0+"IDValueFilterAndLabel");if(c===this.valuE_BETWEEN||c===this.valuE_NOT_BETWEEN){d.className="ms-bifilter-inputforbetween";e.className="ms-bifilter-labelforbetween";a.className="ms-bifilter-inputforbetween ms-bifilter-inputforbetween2"}else{d.className="ms-bifilter-valuefilterinput";e.className="ms-bifilter-itemhidden";a.className="ms-bifilter-itemhidden";var i=this.$2U_0(a,2,true,true,this.get_thousandSeparator(),this.get_decimalPoint(),0,0,false,String.format(PPSMA.SR.OlapFilter_Number,"0"),"IDValueFilterDialog");if(!i){this.$Z_0=this.$2l_0;PPSMA.FilterDialog.$5y(a,this.$Z_0);this.$3U_0(null)}}}},$3t_0:function(b,d,e,f){var a=this.$55_0(b,e,f);a.appendChild(d);var c=this.$50_0(b);a.appendChild(c);document.body.appendChild(a);return a},$3s_0:function(d){var a=document.createElement("div");a.id=this.$2_0+"IDFilterDialogContents";a.className="ms-bifilter-dialogcontents";var b=document.createElement("div");b.className="ms-bifilter-labeldiv";var c=document.createElement("span");c.className="ms-bifilter-label";c.innerHTML=d;b.appendChild(c);a.appendChild(b);return a},$55_0:function(b,c,d){var a=document.createElement("div");a.id=this.$2_0+b;a.className="ms-bifilter-parentborder";a.style.height=d+"px";a.style.width=c+"px";a.style.overflow="hidden";return a},$2R_0:function(){a:;if(this.$11_0&&this.$11_0!=="")return false;var a=false,b=this.$0_0.$8_0,c=this.$N_0==="1"?b.$w_0:b.$u_0;if(!c||!c.length)a=true;return a},handleClearFilterKeyEvent:function(a){a:;var b=a.keyCode,c=13;switch(b){case c:this.clear(a)}},$50_0:function(i){var b=document.createElement("div");b.id=this.$2_0+"IDFilterFooter";b.className="ms-bifilter-footer";var f=document.createElement("span");f.id=this.$2_0+"IDClearFilterBtn"+i;f.className=this.$1U_0?"ms-bifilter-clear":"ms-bifilter-itemhidden";var d=document.createElement("a");d.setAttribute("tabindex",PPSMA.FilterDialogConstants.clearButtonTI);d.setAttribute("href","javascript:;");$addHandler(d,"keyup",this.$$d_handleClearFilterKeyEvent);var g=document.createElement("img");g.id=this.$2_0+"IDClearFilterBtnImage";g.className="ms-bifilter-clearimage";g.setAttribute("src",this.$U_0+"ClearFilter.gif");d.appendChild(g);var h=document.createElement("span");h.id=this.$2_0+"IDClearFilterText";h.innerHTML=PPSMA.SR.OlapFilter_Clear;d.appendChild(h);f.appendChild(d);b.appendChild(f);var a=document.createElement("input");a.id=this.$2_0+"IDFilterApply"+i;Sys.UI.DomElement.addCssClass(a,"ms-bifilter-apply");a.setAttribute("type","button");a.setAttribute("value",PPSMA.SR.OlapChangeMeasure_Ok);a.setAttribute("tabindex",PPSMA.FilterDialogConstants.applyButtonTI);if(this.$2R_0())a.disabled=true;else a.disabled=false;b.appendChild(a);var c=document.createElement("input");c.id=this.$2_0+"IDFilterCancel"+i;Sys.UI.DomElement.addCssClass(c,"ms-bifilter-cancel");c.setAttribute("type","button");c.setAttribute("value",PPSMA.SR.OlapChangeMeasure_Cancel);c.setAttribute("onkeydown",this.$25_0+"._valueFilter.handleTabEvent(event)");c.setAttribute("tabindex",PPSMA.FilterDialogConstants.cancelButtonTI);b.appendChild(c);var e=document.createElement("a");e.setAttribute("href","javascript:;");e.setAttribute("tabindex",PPSMA.FilterDialogConstants.wrapFocusTI);Sys.UI.DomElement.addCssClass(e,"ms-bifilter-wrapfocus");$addHandler(e,"focus",this.$$d_wrapFocus);b.appendChild(e);return b},wrapFocus:function(){a:;this.focusFirstElement()},$33_0:function(){a:;if(!this.$0_0)return "";var b=this.$N_0==="1"?this.$0_0.$8_0.$m_0:this.$0_0.$8_0.$E_0,d=b.length-1,c=b[d];this.$y_0=c.$2F_0;this.$y_0=this.$y_0.replace("[","");this.$y_0=this.$y_0.replace("]","");var a=c.$38_0;a=a.substring(a.lastIndexOf(".")+1,a.length);a=a.replace("[","");a=a.replace("]","");if(a.toLowerCase().indexOf(this.$y_0.toLowerCase())<0)a=this.$y_0+" "+a;return a},$R_0:function(c,b,d){var a=document.createElement("option");a.setAttribute("value",c);d&&a.setAttribute("selected","selected");a.setAttribute("title",b);a.innerHTML=b;return a},getFormattedStringFromInvariantNumber:function(g,f){a:;var c=g.toString(),b=c.split("."),a="0",d="0";if(b.length>0){a=b[0];if(b.length>1)d=b[1]}var e=new RegExp("(\\d+)(\\d{3})");while(e.test(a))a=a.replace(e,"$1"+this.get_thousandSeparator()+"$2");c=a+(f?"":this.get_decimalPoint()+d);return c},$4U_0:function(f){var c=$get(this.$2_0+f);c.setAttribute("tabindex",PPSMA.ValueFilterDialogConstants.filterOptionsTI);if(c)for(var b=c.getElementsByTagName("option"),a=0;a<b.length;a++){var d=PPSMA.FilterDialog.$g(b[a]),e=parseInt(d);if(e===this.$7_0)b[a].setAttribute("selected","selected");else b[a].setAttribute("selected","")}},$62_0:function(g){if(this.$7_0>6)return;var d=$get(this.$2_0+g);if(d){var b=d.getElementsByTagName("option"),c=0;if(this.$7_0===2||this.$7_0===5)c=1;else if(this.$7_0===3||this.$7_0===6)c=2;for(var a=0;a<b.length;a++){var e=PPSMA.FilterDialog.$g(b[a]),f=parseInt(e);if(f===c)b[a].setAttribute("selected","selected");else b[a].setAttribute("selected","")}}},$5v_0:function(b){if(!this.$2_0)return;var a=$get(this.$2_0+b);if(!a)return;if(this.$7_0>=this.valuE_EQUALS&&this.$7_0<=this.valuE_LESS_THAN_OR_EQUAL)a.className="ms-bifilter-itemhidden";else if(this.$7_0>this.valuE_LESS_THAN_OR_EQUAL)a.className="ms-bifilter-labelforbetween"},$31_0:function(){a:;var a="";if(this.$0_0.$8_0){var b=this.$0_0.$8_0.$15_0;if(b)for(var c=0;c<b.length;c++){var d=b[c];if(d.$1_0.startsWith("[Measures]"))a=a+", "+d.$B_0}}return a},$4W_0:function(j){var b=$get(this.$2_0+j);b.setAttribute("tabindex",PPSMA.ValueFilterDialogConstants.tupleOptionsTI);if(b){var d="";if(!this.$11_0||this.$11_0===""){var f=b.getElementsByTagName("option");while(true){if(!f.length)break;b.removeChild(f[0])}d=this.$31_0()}for(var c=this.$34_0(),e=new Array(c.length),a=0;a<c.length;a++){var h=c[a],g=false;if(a===this.$l_0)g=true;var i=a.toString();e[a]=this.$R_0(i,h+d,g);b.appendChild(e[a])}}},$4V_0:function(b){var a=$get(this.$2_0+b);if(this.$7_0>=this.valuE_EQUALS&&this.$7_0<=this.valuE_LESS_THAN_OR_EQUAL)a.className="ms-bifilter-valuefilterinput";else if(this.$7_0>this.valuE_LESS_THAN_OR_EQUAL)a.className="ms-bifilter-inputforbetween";a.value=this.getFormattedStringFromInvariantNumber(this.$1p_0,this.$7_0===this.toP_FILTER||this.$7_0===this.bottoM_FILTER)},$4T_0:function(b){var a=$get(this.$2_0+"IDFilterByLevelDisplay");if(a)a.innerHTML=b},$5z_0:function(b){var a=$get(this.$2_0+b);if(this.$7_0>=this.valuE_EQUALS&&this.$7_0<=this.valuE_LESS_THAN_OR_EQUAL)a.className="ms-bifilter-itemhidden";else if(this.$7_0>this.valuE_LESS_THAN_OR_EQUAL)a.className="ms-bifilter-inputforbetween ms-bifilter-inputforbetween2";a.value=this.getFormattedStringFromInvariantNumber(this.$2B_0,false)},$4Q_0:function(b){var a=$get(this.$2_0+"IDClearFilterBtn"+b);if(a)if(this.$1U_0)a.className="ms-bifilter-clear";else a.className="ms-bifilter-itemhidden"},$2q_0:function(d,b,e,f,g,h,c){var a=document.createElement("input");a.id=f;a.className=h?g:"ms-bifilter-itemhidden";a.type="text";a.setAttribute("maxlength",100);a.value=this.getFormattedStringFromInvariantNumber(e,b===1||b===4);c!==-1&&a.setAttribute("tabindex",c);d.appendChild(a)},$3y_0:function(g,h){var e=this.$2_0+"IDNumericValidationWarning"+g,a=$get(e);if(a)return a;a=document.createElement("div");a.id=e;a.className=h;var b=document.createElement("div");Sys.UI.DomElement.addCssClass(b,"ms-bifilter-warninglabeldiv1");Sys.UI.DomElement.addCssClass(b,"ms-bifilter-warnoff");var c=document.createElement("span");Sys.UI.DomElement.addCssClass(c,"ms-formvalidation");Sys.UI.DomElement.addCssClass(c,"ms-bifilter-warninglabel");b.appendChild(c);a.appendChild(b);var f=document.createElement("div");Sys.UI.DomElement.addCssClass(b,"ms-bifilter-warninglabeldiv2");Sys.UI.DomElement.addCssClass(b,"ms-bifilter-warnoff");var d=document.createElement("span");Sys.UI.DomElement.addCssClass(d,"ms-formvalidation");Sys.UI.DomElement.addCssClass(d,"ms-bifilter-warninglabel");f.appendChild(d);a.appendChild(f);return a},$5g_0:function(b){var a=b.toUpperCase().replace(this.get_decimalPoint(),"");if(b.toUpperCase().indexOf("+")>0||b.toUpperCase().indexOf("-")>0)a=a.replace("E+","").replace("E-","");else a=a.replace("E","");return a},$3B_0:function(a,f,g,d){if(a.indexOf("e")!==-1)return 1;if(a.indexOf("E")!==-1)return 1;while(a.indexOf(d)>=0)a=a.replace(d,"");if(g&&!a.trim().indexOf("-"))a=a.replace("-","");if(a===""||!a)return 4;if(f&&!a.trim().indexOf(".")){var e=a.replace(".","");if(e===""||!e)return 4}var h=new RegExp("^[0]+");a=a.replace(h,"");if(!a||a==="")a="0";var c=0,b;while(a.indexOf(d)>=0)a=a.replace(d,"");var i=a.split(this.get_decimalPoint()),j=f?2:1;b=i.length<=j;if(!b)c=3;if(b){a=this.$5g_0(a);var k=new RegExp("(\\D+)");b=!k.test(a);if(!b)c=1}if(b&&!g){b=a.indexOf("-")<0;if(!b)c=2}return c},$4O_0:function(c){var a=false;if(this.$7_0===this.toP_FILTER||this.$7_0===this.bottoM_FILTER){var b=this.$49_0();if(b===1)a=true}return PPSMA.FilterDialog.$4N(c,a)},$2U_0:function(i,q,j,r,e,u,g,f,s,t,k){if(!i)return true;var d=true,a=PPSMA.FilterDialog.$g(i);a=a.trimStart().trimEnd();var c;if(a.search(new RegExp("[eE]+"))>0||g!==f&&(parseFloat(a)<g||parseFloat(a)>f))c=5;else if(!a||a==="")c=4;else{var o=new RegExp("^[0]+");a=a.replace(o,"");if(!a||a==="")a="0";a=PPSMA.FilterDialog.$4N(a,s);c=this.$3B_0(a,r,j,e)}if(c>0)d=false;else{while(a.indexOf(e)>=0)a=a.replace(e,"");var h=parseInt(a.replace(e,""));if(!j&&h<g||f>0&&h>f)d=false}var l=$get(this.$2_0+"IDNumericValidationWarning"+k),m=l.getElementsByTagName("div"),b=m[q-1],n=c===4||c===3;if(!d&&!n){Sys.UI.DomElement.removeCssClass(b,"ms-bifilter-warnoff");Sys.UI.DomElement.addCssClass(b,"ms-bifilter-warnon");b.setAttribute("role","alert");var p=b.firstChild;p.innerHTML=t}else{Sys.UI.DomElement.removeCssClass(b,"ms-bifilter-warnon");Sys.UI.DomElement.addCssClass(b,"ms-bifilter-warnoff");b.removeAttribute("role")}return d},$1d_0:function(d){var b=this.$7_0>6,c=b?"IDValueFilterDialog":"IDTopFilterDialog",a=$get(this.$2_0+"IDFilterApply"+c);if(a)if(d){a.disabled=false;this.$4k_0(a,"apply")}else{a.disabled=true;PPSMA.FilterDialog.$5s(a)}},$3o_0:function(g,d,k,h){var a=document.createElement("select");h!==-1&&a.setAttribute("tabindex",h);a.id=d;a.className=d.indexOf("IDTopFilterTupleDropdown")>=0?"ms-bifilter-topfiltertupledropdown":"ms-bifilter-tupledropdown";a.name=d;g.appendChild(a);for(var i=this.$31_0(),c=this.$34_0(),e=new Array(c.length),b=0;b<c.length;b++){var j=c[b],f=false;if(b===k)f=true;e[b]=this.$R_0(b.toString(),j+i,f);a.appendChild(e[b])}g.appendChild(a)},$5F_0:function(){a:;var a=this.$0_0.$8_0.$E_0;if(a&&a.length>0)return a[a.length-1];return null},$34_0:function(){a:;var d=[];if(this.$11_0&&this.$11_0!==""){for(var h=this.$11_0.split(":"),f=0;f<h.length;f++)Array.add(d,h[f]);return d}var g=this.$0_0.$8_0,a=this.$N_0==="1"?g.$w_0:g.$u_0;if(a)for(var i=a.length,b=0;b<i;b++){for(var c="",e=0;e<a[b].length;e++){var j=a[b][e];c=c+j.$B_0;if(e<a[b].length-1)c=c+", "}Array.add(d,c)}return d},$4k_0:function($p0,$p1){var $v_0=PPSMA.EncodeEx.jsQuoteEncode(this.$25_0);$p0.click=eval("new Function('"+$v_0+"._valueFilter."+$p1+"(event);');")},$5Q_0:function(){a:;var a=$get(this.$2_0+"IDTopFilterDialog");if(!a)return null;this.$4T_0(PPSMA.SR.OlapFilter_TopFilterHeader+"&nbsp;"+this.$O_0);this.$4U_0("IDTopFilterOptionsDropdown");this.$4W_0("IDTopFilterTupleDropdown");this.$62_0("IDTopVarOptionsDropdown");this.$4V_0("IDTopFilterInput");this.$4Q_0("IDTopFilterDialog");return a},$57_0:function(){a:;var a=this.$56_0(PPSMA.SR.OlapFilter_TopFilterText),b=this.$3t_0("IDTopFilterDialog",a,PPSMA.ScriptConstants.analyticReportsTopFilterDialogWidth,PPSMA.ScriptConstants.analyticReportsTopFilterDialogHeight);return b},$56_0:function(b){var a=this.$3s_0(b);a.appendChild(this.$58_0());return a},$58_0:function(){a:;var f=this.$2_0+"IDTopFilterInputDiv",a=$get(f);if(!a){a=document.createElement("div");a.id=f;a.className="ms-bitfilter-inputsdiv";this.$4s_0(a,this.$7_0,PPSMA.TopFilterDialogConstants.filterOptionsTI);var c=document.createElement("div");c.className="ms-bitfilter-inputsizer";a.appendChild(c);this.$2q_0(c,this.$7_0,this.$1p_0,this.$2_0+"IDTopFilterInput","ms-bitfilter-input",true,PPSMA.TopFilterDialogConstants.inputTI);this.$4t_0(a,this.$7_0,PPSMA.TopFilterDialogConstants.varOptionsTI);var b=document.createElement("div");b.className="ms-bitfilter-labelwrndiv";var d=document.createElement("div");d.className="ms-bifilter-labelforbysizer";PPSMA.FilterDialog.$3k(d,PPSMA.SR.OlapFilter_ByLabel,null,false,"ms-bifilter-labelforby");b.appendChild(d);b.appendChild(this.$3y_0("IDTopFilterDialog","ms-bitfilter-numericvalidationwarningdiv"));a.appendChild(b);var e=document.createElement("div");e.className="ms-bifilter-topfiltertupledropdownsizer";this.$3o_0(e,this.$2_0+"IDTopFilterTupleDropdown",this.$l_0,PPSMA.TopFilterDialogConstants.tupleOptionsTI);a.appendChild(e)}return a},$49_0:function(){a:;var a=0,b=$get(this.$2_0+"IDTopVarOptionsDropdown");if(b){var c=b;a=c.selectedIndex}return a},$3T_0:function(){if(this.$2R_0()){this.$1d_0(false);return}var e=$get(this.$2_0+"IDTopFilterInput"),f=this.$49_0(),a=0,b=0,d=false,c="";switch(f){case 0:a=1;b=2e9;c=String.format(PPSMA.SR.OlapFilter_NumberOnly);break;case 1:b=100;d=true;c=String.format(PPSMA.SR.OlapFilter_NumberLimit,a.toString(),b.toString());break;case 2:c=String.format(PPSMA.SR.OlapFilter_NumberGreaterThanZero,a.toString())}var g=this.$2U_0(e,1,false,true,this.get_thousandSeparator(),this.get_decimalPoint(),a,b,d,c,"IDTopFilterDialog");this.$1d_0(g)},$45_0:function(e){this.$3T_0(e);var c=$get(this.$2_0+"IDTopFilterInput"),a=$get(this.$2_0+"IDTopVarOptionsDropdown"),b=false;if(a){var d=a;if(!d.selectedIndex)b=true}this.$3R_0(c,b)},$4s_0:function(g,h,d){var b=document.createElement("div");b.className="ms-bifilter-topoptionsdropdownsizer";var a=document.createElement("select");a.id=this.$2_0+"IDTopFilterOptionsDropdown";a.className="ms-bifilter-topoptionsdropdown";a.setAttribute("name","IDTopFilterOptionsDropdown");d!==-1&&a.setAttribute("tabindex",d);var c=h>3?4:1,e=this.$R_0("1",PPSMA.SR.OlapFilter_Top,c===1);a.appendChild(e);var f=this.$R_0("4",PPSMA.SR.OlapFilter_Bottom,c===4);a.appendChild(f);b.appendChild(a);g.appendChild(b)},$6A_0:function(a){this.$3T_0(a)},$4t_0:function(h,i,d){var b=(i-1)%3,a=document.createElement("select");a.id=this.$2_0+"IDTopVarOptionsDropdown";a.className="ms-bifilter-topvardropdown";a.setAttribute("name","IDTopVarOptionsDropdown");d!==-1&&a.setAttribute("tabindex",d);var e=this.$R_0("0",PPSMA.SR.OlapFilter_Count,!b);a.appendChild(e);var f=this.$R_0("1",PPSMA.SR.OlapFilter_Percent,b===1);a.appendChild(f);var g=this.$R_0("2",PPSMA.SR.OlapFilter_Sum,b===2);a.appendChild(g);var c=document.createElement("div");c.className="ms-bifilter-topvardropdownsizer";c.appendChild(a);h.appendChild(c)},apply:function(){a:;this.$5w_0();this.$f_0="1";this.$2T_0.close(1)},$5w_0:function(){a:;var e=this.$1B_0;if(isNullUndefinedOrEmpty(e)){var d=null;if(!this.$1f_0&&this.$0_0.$8_0.$E_0&&this.$0_0.$8_0.$E_0.length>0)d=this.$0_0.$8_0.$E_0[0];else d=this.$5F_0();if(d)e=d.$1_0}var b=true;if(this.$7_0<7)b=false;this.$1B_0=e;var i=$get(this.$2_0+(b?"IDValueFilterOptionsDropdown":"IDTopFilterOptionsDropdown")),f=$get(this.$2_0+(b?"IDValueFilterInput1":"IDTopFilterInput"));f&&f.setAttribute("tabindex",PPSMA.ValueFilterDialogConstants.input1TI);var c=$get(this.$2_0+"IDValueFilterInput2");c&&c.setAttribute("tabindex",PPSMA.ValueFilterDialogConstants.input2TI);var g=$get(this.$2_0+(b?"IDValueFilterTupleDropdown":"IDTopFilterTupleDropdown"));if(!this.$O_0||this.$O_0==="")this.$O_0=this.$33_0();var h=g.children;if(!h)h=g.childNodes;var m=g,n=PPSMA.FilterDialog.$g(h[m.selectedIndex]);try{this.$l_0=parseInt(n)}catch(k){this.$l_0=0}if(this.$0_0){var r=new PPSMA.DetailsHelper(this.$0_0,this.$25_0,this.$N_0==="1"?this.$l_0:0,this.$N_0==="1"?0:this.$l_0,"");this.$2o_0=r.getCellTupleXml()}this.$12_0=PPSMA.FilterDialog.$g(f);this.$12_0=this.$4O_0(this.$12_0);if(c){this.$Z_0=PPSMA.FilterDialog.$g(c);this.$Z_0=this.$4O_0(this.$Z_0)}else this.$Z_0="0";var o=i.getElementsByTagName("option"),p=i,q=PPSMA.FilterDialog.$g(o[p.selectedIndex]),a;try{a=parseInt(q)}catch(l){a=1}if(a<6){this.$45_0(null);var j=$get(this.$2_0+"IDTopVarOptionsDropdown"),s=j.getElementsByTagName("option"),t=j,u=PPSMA.FilterDialog.$g(s[t.selectedIndex]),v=parseInt(u);a=a+v}this.$7_0=a;(this.$7_0===this.valuE_BETWEEN||this.$7_0===this.valuE_NOT_BETWEEN)&&this.$68_0()},$68_0:function(){a:;var a=this.$12_0,b=this.$Z_0;while(a.indexOf(this.get_thousandSeparator())>=0)a=a.replace(this.get_thousandSeparator(),"");while(b.indexOf(this.get_thousandSeparator())>=0)b=b.replace(this.get_thousandSeparator(),"");var c=parseInt(a),d=parseInt(b);if(c>d){var e=this.$12_0;this.$12_0=this.$Z_0;this.$Z_0=e}},cancel:function(){a:;this.$f_0="2";this.$2T_0.close(1)},clear:function(){a:;this.$f_0="3";this.$2T_0.close(1)},handleTabEvent:function(c){a:;var d=9,a=PPSMA.EventsEx.getEvent(c),e=a.keyCode;if(e!==d)return;if(a.shiftKey)return;var f=PPSMA.EventsEx.getCurrentElement(c),b=f.getAttribute("id");if(b===this.$2_0+"IDFilterCancelIDValueFilterDialog"){var g=$get(this.$2_0+"IDValueFilterInputDiv");g.focus()}else if(b===this.$2_0+"IDFilterCancelIDTopFilterDialog"){var h=$get(this.$2_0+"IDTopFilterInputDiv");h.focus()}}};PPSMA.Toolbar=function(b,a){a:;this.$0_0=b;this.$4f_0=a};PPSMA.Toolbar.prototype={$0_0:null,$4f_0:null,handleSkipToReportLinkClick:function(){a:;this.$0_0.$3G_0.assignFocus()}};PPSMA.OlapWebRequest=function(a,b,c){a:;this.$$d_$4w_0=Function.createDelegate(this,this.$4w_0);if(isNullOrUndefined(a))return;this.$h_0=new PPSMA.CancellableWebRequest(a,PPSMA.RenderWebRequest.msgtypE_LOADING,c,a.id,2);this.$h_0.add_onCancelled(this.$$d_$4w_0);this.$2Z_0=b};PPSMA.OlapWebRequest.prototype={$h_0:null,$V_0:null,$2Z_0:null,dispose:function(){a:;if(this.$h_0){this.$h_0.dispose();this.$h_0=null}if(this.$V_0){!isNullOrUndefined(this.$V_0.get_executor())&&!this.$V_0.get_executor().get_aborted()&&this.$V_0.get_executor().abort();this.$V_0=null}},$4w_0:function(){this.$2Z_0&&this.$2Z_0()},show:function(){a:;this.$h_0&&this.$h_0.show()},hide:function(){a:;this.$h_0&&this.$h_0.hide()},submit:function(a){a:;if(this.$h_0)this.$h_0.submit(a);else{this.$V_0&&this.$V_0.get_executor().abort();this.$V_0=new Sys.Net.WebRequest;this.$V_0.set_url(a.url);this.$V_0.set_body(a.body);this.$V_0.set_httpVerb(a.httpVerb);this.$V_0.get_headers()["Content-Type"]=a.contentType;this.$V_0.add_completed(a.completedCallback);this.$V_0.invoke()}}};Type.registerNamespace("AjaxFX");AjaxFX.HistoryEventArgs=function(a){AjaxFX.HistoryEventArgs.initializeBase(this);this.$23_1=a};AjaxFX.HistoryEventArgs.prototype={$23_1:null,get_entryName:function(){a:;return this.$23_1}};AjaxFX.HistoryManager=function(a,b){this.$$d_$5n_0=Function.createDelegate(this,this.$5n_0);this.$$d_$5m_0=Function.createDelegate(this,this.$5m_0);this.$$d_$5i_0=Function.createDelegate(this,this.$5i_0);this.$1A_0=new Sys.EventHandlerList;this.$22_0=a;this.$d_0=b;this.$2f_0=500};AjaxFX.HistoryManager.createHistory=function(c,b){a:;AjaxFX.HistoryManager.$1C&&AjaxFX.HistoryManager.$1C.dispose();AjaxFX.HistoryManager.$1C=null;if(Sys.Browser.agent!==Sys.Browser.InternetExplorer&&Sys.Browser.agent!==Sys.Browser.Firefox&&Sys.Browser.agent!==Sys.Browser.Safari)AjaxFX.HistoryManager.$1C=new AjaxFX.HistoryManager(false,null);else{var a=null;if(Sys.Browser.name==="Microsoft Internet Explorer"){AjaxFX.HistoryManager.$51(c,b);a=$get("_historyFrame")}AjaxFX.HistoryManager.$1C=new AjaxFX.HistoryManager(true,a)}AjaxFX.HistoryManager.$1C.$5W_0();return AjaxFX.HistoryManager.$1C};AjaxFX.HistoryManager.$51=function(b,c){if(b){var a=document.createElement("iframe");a.id="_historyFrame";a.style.display="none";a.src=c;b.parentNode.insertBefore(a,b)}};AjaxFX.HistoryManager.prototype={$22_0:false,$d_0:null,$2d_0:null,$3c_0:null,$2k_0:false,$2i_0:false,$2h_0:false,$1g_0:null,$2e_0:null,$2f_0:0,$1i_0:0,$2g_0:null,get_isEnabled:function(){a:;return this.$22_0},add_navigated:function(a){a:;this.$1A_0.addHandler(AjaxFX.HistoryManager.$2I,a)},remove_navigated:function(a){a:;this.$1A_0.removeHandler(AjaxFX.HistoryManager.$2I,a)},addEntry:function(a){a:;if(!this.$22_0)return;this.$2i_0=true;if(this.$d_0&&!this.$2k_0){this.$2h_0=true;this.$d_0.src=this.$2d_0+a;if(Sys.Browser.name==="Microsoft Internet Explorer")if(window.navigator.userAgent.search(new RegExp("Trident"))>=0||Sys.Browser.version===8)this.$2k_0=true}else this.$4R_0(a)},dispose:function(){a:;if(this.$d_0){$clearHandlers(this.$d_0);this.$d_0=null}this.$1i_0&&window.clearTimeout(this.$1i_0)},$32_0:function(){a:;var a=window.location.hash;if(a.length&&a.charAt(0)==="#")a=a.substr(1);return a},goBack:function(){a:;window.history.back()},goForward:function(){a:;window.history.forward()},$5W_0:function(){a:;if(!this.$22_0)return;this.$2e_0=this.$$d_$5i_0;this.$2g_0=this.$$d_$5m_0;this.$1i_0=window.setTimeout(this.$2g_0,this.$2f_0);if(this.$d_0){var a=this.$d_0.src.indexOf("?");if(a>0)this.$2d_0=this.$d_0.src.substr(0,a)+"?";else this.$2d_0=this.$d_0.src+"?";this.$3c_0=this.$$d_$5n_0;$addHandler(this.$d_0,"load",this.$3c_0)}this.$1g_0=this.$32_0();this.$3F_0(this.$1g_0);Sys.Application.registerDisposableObject(this)},$5m_0:function(){a:;this.$1i_0=0;if(this.$2e_0){this.$2e_0(this,Sys.EventArgs.Empty);this.$1i_0=window.setTimeout(this.$2g_0,this.$2f_0)}},$5i_0:function(){var a=this.$32_0();if(a!==this.$1g_0){if(this.$2i_0)return;this.$1g_0=a;this.$3F_0(a)}else this.$2i_0=false},$5n_0:function(){var a=this.$d_0.contentWindow.location.search;if(a.length&&a.charAt(0)==="?")a=a.substr(1);this.$4R_0(a);if(this.$2h_0){this.$2h_0=false;return}this.$3F_0(a);if(Sys.Browser.name==="Microsoft Internet Explorer")if(window.navigator.userAgent.search(new RegExp("Trident"))>=0||Sys.Browser.version===8)this.$2k_0=false},$3F_0:function(b){var a=this.$1A_0.getHandler(AjaxFX.HistoryManager.$2I);a&&a(this,new AjaxFX.HistoryEventArgs(b))},$4R_0:function(a){window.location.hash=a;this.$1g_0=this.$32_0()}};PPSMA.AjaxOlapRenderRequestRecord.registerClass("PPSMA.AjaxOlapRenderRequestRecord");PPSMA.AjaxOlapMetadataRequestRecord.registerClass("PPSMA.AjaxOlapMetadataRequestRecord");PPSMA.Dimension.registerClass("PPSMA.Dimension");PPSMA.DimensionProperties.registerClass("PPSMA.DimensionProperties");PPSMA.Hierarchy.registerClass("PPSMA.Hierarchy");PPSMA.Level.registerClass("PPSMA.Level");PPSMA.ResultHierarchy.registerClass("PPSMA.ResultHierarchy");PPSMA.ResultMemberProperties.registerClass("PPSMA.ResultMemberProperties");PPSMA.Results.registerClass("PPSMA.Results");PPSMA.Member.registerClass("PPSMA.Member");PPSMA.ReportsCommon.registerClass("PPSMA.ReportsCommon");PPSMA.DialogsCommon.registerClass("PPSMA.DialogsCommon");PPSMA.ContextMenu.registerClass("PPSMA.ContextMenu");PPSMA.ShowProperties.registerClass("PPSMA.ShowProperties");PPSMA.ThinFieldListItemSelectedEventArgs.registerClass("PPSMA.ThinFieldListItemSelectedEventArgs",Sys.EventArgs);PPSMA.ThinFieldList.registerClass("PPSMA.ThinFieldList");PPSMA.BaseMeasureKpi.registerClass("PPSMA.BaseMeasureKpi");PPSMA.Kpi.registerClass("PPSMA.Kpi",PPSMA.BaseMeasureKpi);PPSMA.Measure.registerClass("PPSMA.Measure",PPSMA.BaseMeasureKpi);PPSMA.Folder.registerClass("PPSMA.Folder");PPSMA.Measures.registerClass("PPSMA.Measures");PPSMA.DetailsHelper.registerClass("PPSMA.DetailsHelper");PPSMA.DrillDownToHelper.registerClass("PPSMA.DrillDownToHelper");PPSMA.AnalyzeInDecompHelper.registerClass("PPSMA.AnalyzeInDecompHelper");PPSMA.MenuOptionHelper.registerClass("PPSMA.MenuOptionHelper");PPSMA.SubMenu.registerClass("PPSMA.SubMenu");PPSMA.OlapViewContext.registerClass("PPSMA.OlapViewContext",null,Sys.IDisposable);PPSMA.ChangeMeasure.registerClass("PPSMA.ChangeMeasure");PPSMA.FilterDialogConstants.registerClass("PPSMA.FilterDialogConstants");PPSMA.ValueFilterDialogConstants.registerClass("PPSMA.ValueFilterDialogConstants");PPSMA.TopFilterDialogConstants.registerClass("PPSMA.TopFilterDialogConstants");PPSMA.FilterDialog.registerClass("PPSMA.FilterDialog");PPSMA.Toolbar.registerClass("PPSMA.Toolbar");PPSMA.OlapWebRequest.registerClass("PPSMA.OlapWebRequest");AjaxFX.HistoryEventArgs.registerClass("AjaxFX.HistoryEventArgs",Sys.EventArgs);AjaxFX.HistoryManager.registerClass("AjaxFX.HistoryManager",null,Sys.IDisposable);PPSMA.ContextMenu.$i=null;PPSMA.ContextMenu.$j=null;PPSMA.ContextMenu.$4c="olap_toolbar";PPSMA.ThinFieldList.divIDListContainer="_ScrollList";PPSMA.ThinFieldList.ulidDisplayObjectParent="_ULDisplayObjects";PPSMA.ThinFieldList.divIDThinFieldListMain="_ThinFieldListDiv";PPSMA.Kpi.classThinFieldListLI="ms-bichangemeasures-thinfieldlistitems";PPSMA.Kpi.classThinFieldListCheckBox="ms-bichangemeasures-thinfieldlistcheckbox";PPSMA.Kpi.listElemID="_kli";PPSMA.Kpi.kpiComponentSize=4;PPSMA.Kpi.kpI_GOAL_INDEX=0;PPSMA.Kpi.kpI_VALUE_INDEX=1;PPSMA.Kpi.kpI_STATUS_INDEX=2;PPSMA.Kpi.kpI_TREND_INDEX=3;PPSMA.Measure.classThinFieldListLI="chgMeasTflListItem";PPSMA.Measure.classThinFieldListCheckBox="chgMeasTflListCheckBox";PPSMA.Measure.listElemID="_mli";PPSMA.Folder.classExCoA="ms-bichangemeasures-expandcollapseanchor";PPSMA.Folder.classExCoImg="ms-bichangemeasures-expandcollapseimage";PPSMA.Folder.classFolderImg="ms-bichangemeasures-expandcollapsefolderimage";PPSMA.Folder.listElemID="_fli_";PPSMA.Folder.parentChildDelimitor="\\";PPSMA.Folder.multipleFoldersDelimitor=";";PPSMA.Measures.noAxisSelected="none";PPSMA.Measures.measureGroupID="mg_";PPSMA.Measures.measureGroupALLID="_ALL_";PPSMA.Measures.measureGroupDropDownComboxBoxID="MeasureGroupsDropDownSelect";PPSMA.Measures.measureGroupDropDownComboxBoxWrapperDivID="MeasureGroupsDropDownSelectWrapperDiv";PPSMA.Measures.folderCount=0;PPSMA.OlapViewContext.globalIds={};PPSMA.OlapViewContext.menU_METADATA_HEADER_TYPE="MenuMetadata-Type";PPSMA.ChangeMeasure.idFieldList="flId";PPSMA.FilterDialogConstants.clearButtonTI=1750;PPSMA.FilterDialogConstants.applyButtonTI=2e3;PPSMA.FilterDialogConstants.cancelButtonTI=2500;PPSMA.FilterDialogConstants.wrapFocusTI=3e3;PPSMA.ValueFilterDialogConstants.tupleOptionsTI=100;PPSMA.ValueFilterDialogConstants.filterOptionsTI=500;PPSMA.ValueFilterDialogConstants.input1TI=1e3;PPSMA.ValueFilterDialogConstants.input2TI=1500;PPSMA.TopFilterDialogConstants.filterOptionsTI=100;PPSMA.TopFilterDialogConstants.inputTI=500;PPSMA.TopFilterDialogConstants.varOptionsTI=1e3;PPSMA.TopFilterDialogConstants.tupleOptionsTI=1500;PPSMA.FilterDialog.margiN_LEFT=15;PPSMA.FilterDialog.classFilterMain="ms-bifilter-main";PPSMA.FilterDialog.classFilterParentBorder="ms-bifilter-parentborder";PPSMA.FilterDialog.classFilterDialogContents="ms-bifilter-dialogcontents";PPSMA.FilterDialog.classFilterLabelDiv="ms-bifilter-labeldiv";PPSMA.FilterDialog.classTopFilterLabelAndWarningDiv="ms-bitfilter-labelwrndiv";PPSMA.FilterDialog.classFilterLabel="ms-bifilter-label";PPSMA.FilterDialog.classFilterLabelForByDiv="ms-bifilter-labelforbysizer";PPSMA.FilterDialog.classFilterLabelForBy="ms-bifilter-labelforby";PPSMA.FilterDialog.classFilterLabelForBetween="ms-bifilter-labelforbetween";PPSMA.FilterDialog.classTFilterInputDiv="ms-bitfilter-inputsdiv";PPSMA.FilterDialog.classVFilterInputDiv="ms-bivfilter-inputsdiv";PPSMA.FilterDialog.classFilterClear="ms-bifilter-clear";PPSMA.FilterDialog.classFilterApplyCustom="ms-bifilter-apply";PPSMA.FilterDialog.classFilterCancelCustom="ms-bifilter-cancel";PPSMA.FilterDialog.classFilterWrapFocusLink="ms-bifilter-wrapfocus";PPSMA.FilterDialog.classFilterFooter="ms-bifilter-footer";PPSMA.FilterDialog.classFilterTupleDropdown="ms-bifilter-tupledropdown";PPSMA.FilterDialog.classTopFilterTupleDropdown="ms-bifilter-topfiltertupledropdown";PPSMA.FilterDialog.classTopFilterTupleDropdownDiv="ms-bifilter-topfiltertupledropdownsizer";PPSMA.FilterDialog.classFilterTopOptionsDropdown="ms-bifilter-topoptionsdropdown";PPSMA.FilterDialog.classFilterTopOptionsDropdownDiv="ms-bifilter-topoptionsdropdownsizer";PPSMA.FilterDialog.classFilterTopVarDropdown="ms-bifilter-topvardropdown";PPSMA.FilterDialog.classFilterTopVarDropdownDiv="ms-bifilter-topvardropdownsizer";PPSMA.FilterDialog.classFilterValueOptionsDropdown="ms-bifilter-valueoptionsdropdown";PPSMA.FilterDialog.classFilterValueAndOrDropdown="ms-bifilter-valueandordropdown";PPSMA.FilterDialog.classNumericValidationWarningDiv="ms-bifilter-numericvalidationwarningdiv";PPSMA.FilterDialog.classTopNumericValidationWarningDiv="ms-bitfilter-numericvalidationwarningdiv";PPSMA.FilterDialog.classFilterItemHidden="ms-bifilter-itemhidden";PPSMA.FilterDialog.classTopFilterInput="ms-bitfilter-input";PPSMA.FilterDialog.classTopFilterInputDiv="ms-bitfilter-inputsizer";PPSMA.FilterDialog.classValueFilterInput="ms-bifilter-valuefilterinput";PPSMA.FilterDialog.classValueFilterInputParent="ms-bifilter-valuefilterinputparent";PPSMA.FilterDialog.classValueFilterInputSizer="ms-bifilter-valuefilterinputsizer";PPSMA.FilterDialog.classFilterInputForBetween="ms-bifilter-inputforbetween";PPSMA.FilterDialog.classFilterInputForBetween2="ms-bifilter-inputforbetween2";PPSMA.FilterDialog.classFilterWarningOn="ms-bifilter-warnon";PPSMA.FilterDialog.classFilterWarningOff="ms-bifilter-warnoff";PPSMA.FilterDialog.classFilterWarningLabel="ms-bifilter-warninglabel";PPSMA.FilterDialog.classFilterWarningLabelDiv1="ms-bifilter-warninglabeldiv1";PPSMA.FilterDialog.classFilterWarningLabelDiv2="ms-bifilter-warninglabeldiv2";PPSMA.FilterDialog.classClearFilterImage="ms-bifilter-clearimage";PPSMA.FilterDialog.msFormValidation="ms-formvalidation";PPSMA.FilterDialog.idValueFilterDialog="IDValueFilterDialog";PPSMA.FilterDialog.idTopFilterDialog="IDTopFilterDialog";PPSMA.FilterDialog.idFilterDialogContents="IDFilterDialogContents";PPSMA.FilterDialog.idFilterApply="IDFilterApply";PPSMA.FilterDialog.idFilterCancel="IDFilterCancel";PPSMA.FilterDialog.idFilterFooter="IDFilterFooter";PPSMA.FilterDialog.idTopFilterTupleDropdown="IDTopFilterTupleDropdown";PPSMA.FilterDialog.idValueFilterTupleDropdown="IDValueFilterTupleDropdown";PPSMA.FilterDialog.idValueFilterOptionsDropdown="IDValueFilterOptionsDropdown";PPSMA.FilterDialog.idTopFilterOptionsDropdown="IDTopFilterOptionsDropdown";PPSMA.FilterDialog.idTopVarOptionsDropdown="IDTopVarOptionsDropdown";PPSMA.FilterDialog.idNumericValidationWarning="IDNumericValidationWarning";PPSMA.FilterDialog.idValueFilterInputsAndLabelWrapper="IDValueFilterInputsAndLabelWrapper";PPSMA.FilterDialog.idValueFilterInput1="IDValueFilterInput1";PPSMA.FilterDialog.idValueFilterInput2="IDValueFilterInput2";PPSMA.FilterDialog.idValueFilterAndLabel="IDValueFilterAndLabel";PPSMA.FilterDialog.idTopFilterInput="IDTopFilterInput";PPSMA.FilterDialog.idTopFilterInputDiv="IDTopFilterInputDiv";PPSMA.FilterDialog.idValueFilterInputDiv="IDValueFilterInputDiv";PPSMA.FilterDialog.idClearFilterBtn="IDClearFilterBtn";PPSMA.FilterDialog.idClearFilterBtnImage="IDClearFilterBtnImage";PPSMA.FilterDialog.idClearFilterText="IDClearFilterText";PPSMA.FilterDialog.idFilterByLevelDisplay="IDFilterByLevelDisplay";AjaxFX.HistoryManager.$1C=null;AjaxFX.HistoryManager.$2I="Navigated";function getResFolder(){a:;return g_resFolder}function _ovc(a){a:;return PPSMA.OlapViewContext.globalIds[a]}function _ovrc(a){a:;return PPSMA.OlapViewContext.globalIds[a].get_reportContext()}function _ovtc(a){a:;return PPSMA.OlapViewContext.globalIds[a].get_toolbar()}function isValidBrowser(){a:;return browseris.ie55up||browseris.nav6up||browseris.safari125up}function touchEnabled(){a:;return "ontouchstart" in window||window.navigator.msPointerEnabled}function isSilverlightInstalled(a){a:;return Silverlight.isInstalled(a)}function byid(a){a:;return document.getElementById(a)}function newE(a){a:;return document.createElement(a)}function wpf(){a:;return document.forms[MSOWebPartPageFormName]}function startReplacement(){}Type.registerNamespace("PPSMA");PPSMA.Menu=function(){};PPSMA.Menu.AttachEvent=function(c,b,a){a:;if(!a)a=window;if(c=="domLoad")c=a.addEventListener&&browseris.nav?"DOMContentLoaded":"load";if(typeof b=="string")b=new Function(b);if(a.addEventListener)a.addEventListener(c,b,false);else a.attachEvent("on"+c,b)};PPSMA.Menu.CancelEvent=function(a){a:;a.cancelBubble=true;a.returnValue=false};PPSMA.Menu.GetEventSrcElement=function(a){a:;return a.srcElement};PPSMA.Menu.GetEventKeyCode=function(a){a:;return a.keyCode};PPSMA.Menu.GetInnerText=function(a){a:;return a.innerText};var kfnDisableEvent=new Function("return false");PPSMA.Menu.g_lastMenu=null;PPSMA.Menu.g_uniqueNumber=0;PPSMA.Menu.g_bIgnoreTouchUp=false;PPSMA.Menu.IsAccessibilityFeatureEnabledProxy=function(){a:;if(typeof IsAccessibilityFeatureEnabled!="undefined")return IsAccessibilityFeatureEnabled();return false};PPSMA.Menu.GetType=function(a){a:;if(!a)return "menu";else return a._menuType};PPSMA.Menu.Show=function(oMaster,oParent,fForceRefresh,fFlipTop,xOffset,yOffset){a:;if("ontouchstart" in window)PPSMA.Menu.g_bIgnoreTouchUp=true;if(!(browseris.ie55up||browseris.nav6up||browseris.safari125up))return false;PPSMA.Menu.Hide();PPSMA.Menu.Init(oMaster);oMaster._oParent=oParent;oMaster._fIsRtL=PPSMA.Menu.IsElementRtl(oMaster._oParent);if((browseris.ie||browseris.nav)&&PPSMA.Menu.IsAccessibilityFeatureEnabledProxy()){var menu=null;if(oParent.foa){menu=byid(oParent.foa);if(!menu)menu=eval(oParent.foa)}menu&&menu.onblur&&menu.onblur();PPSMA.Menu.RenderAccessibleMenu(oMaster,fForceRefresh);PPSMA.Menu.g_lastMenu=oMaster}else{PPSMA.Menu.SetBodyEventHandlers(null,false);PPSMA.Menu.SetBodyTouchEndEventHandler(null);PPSMA.Menu.RemoveBodyMouseScrollEventHandlers(PPSMA.Menu.HandleDocumentBodyScroll,false);PPSMA.Menu.AssureId(oParent);var result=PPSMA.Menu.ShowRoot(oMaster,oParent,fForceRefresh,fFlipTop,xOffset,yOffset);PPSMA.Menu.g_lastMenu=oMaster;PPSMA.Menu.NavigateToMenu(oMaster);PPSMA.Menu.SetBodyEventHandlers(PPSMA.Menu.HandleDocumentBodyClick,PPSMA.Menu.GetType(oMaster)=="tooltip");PPSMA.Menu.SetBodyTouchEndEventHandler(PPSMA.Menu.HandleDocumentBodyTouchEnd);PPSMA.Menu.SetBodyMouseScrollEventHandlers(PPSMA.Menu.HandleDocumentBodyScroll,PPSMA.Menu.GetType(oMaster)=="tooltip")}if(browseris.ie)if(window.event)window.event.cancelBubble=true;return false};PPSMA.Menu.Hide=function(){a:;PPSMA.Menu.ClearTimeoutToHideMenu();var a=PPSMA.Menu.g_lastMenu;if(a)if(a._accessibleMenu)PPSMA.Menu.CloseAccessibleMenu(a);else PPSMA.Menu.HideMenu(a);PPSMA.Menu.g_lastMenu=null};PPSMA.Menu.IsOpen=function(a){a:;if(!a||!a._initialized)return false;var b=PPSMA.Menu.IsOpenInternal(a);return b};PPSMA.Menu.Item=function(a,c,b){a:;PPSMA.Menu.Init(a);var d=PPSMA.Menu.GetItem(a,c,b);return d};PPSMA.Menu.TrapMenuClick=function(a){a:;a&&PPSMA.Menu.CancelEvent(a);return false};PPSMA.Menu.SetBodyEventHandlers=function(a){a:;if("ontouchstart" in window)document.ontouchstart=a;else document.onmousedown=a};PPSMA.Menu.SetBodyMouseScrollEventHandlers=function(a){a:;window.addEventListener&&window.addEventListener("DOMMouseScroll",a,false);window.onmousewheel=document.onmousewheel=a};PPSMA.Menu.RemoveBodyMouseScrollEventHandlers=function(a){a:;window.removeEventListener&&window.removeEventListener("DOMMouseScroll",a,false);window.onmousewheel=document.onmousewheel=null};PPSMA.Menu.SetBodyTouchEndEventHandler=function(a){a:;if("ontouchend" in window)document.ontouchend=a};PPSMA.Menu.HandleDocumentBodyTouchEnd=function(){a:;return};PPSMA.Menu.HandleDocumentBodyClick=function(a){a:;var b=PPSMA.EventsEx.getEvent(a);PPSMA.Menu.g_lastMenu&&PPSMA.Menu.HideMenu(PPSMA.Menu.g_lastMenu);return false};PPSMA.Menu.HandleDocumentBodyScroll=function(a){a:;var b=PPSMA.EventsEx.getEvent(a);PPSMA.Menu.g_lastMenu&&PPSMA.Menu.HideMenu(PPSMA.Menu.g_lastMenu);return false};PPSMA.Menu.GetEventPopup=function(b){a:;var a=PPSMA.Menu.GetEventSrcElement(b);while(a){if(a.master)return a;a=a.parentNode}return null};PPSMA.Menu.GetUniqueNumber=function(){a:;PPSMA.Menu.g_uniqueNumber++;return PPSMA.Menu.g_uniqueNumber};PPSMA.Menu.Init=function(a){a:;if(a._initialized)return;a._initialized=true;a._wzPrefixID="mp"+PPSMA.Menu.GetUniqueNumber();if(!a.id)a.id=a._wzPrefixID+"_id";a._nLevel=0;a._arrPopup=[];a._arrSelected=[];if(typeof a._onDestroy=="undefined")a._onDestroy=null;a._fLargeIconMode=false;a._fCompactItemsWithoutIcons=false};PPSMA.Menu.PrepContents=function(a){a:;a._fLargeIconMode=a.getAttribute("largeIconMode")=="true";a._fCompactItemsWithoutIcons=a.getAttribute("CompactMode")=="true";if(!browseris.safari){a._oContents=document.createElement("span");a._oContents.style.display="none";a._oContents.innerHTML=a.innerHTML}else{a._oContents=a.cloneNode(true);a._oContents.style.display="none"}if(PPSMA.Menu.GetType(a)=="tooltip")a._wzMenuStyle="bsm-ToolTipUI";else if(a._fLargeIconMode)if(a._fIsRtL)a._wzMenuStyle="bsm-MenuUILargeRtL";else a._wzMenuStyle="bsm-MenuUILarge";else if(a._fIsRtL)a._wzMenuStyle="bsm-MenuUIRtL";else a._wzMenuStyle="bsm-MenuUI";a._wzChkMrkPath=g_resFolder+"ChkMrk.gif";a._wzMArrPath=g_resFolder+"MArr.gif";a._wzMArrPathRtL=g_resFolder+"MArrRtL.gif"};PPSMA.Menu.FixUpMenuStructure=function(h){a:;for(var f=h._oRoot.childNodes,e=null,b=null,c=0;c<f.length;c++){var a=f[c];if(a.nodeType!=1)continue;var d=false,i=a.style&&a.style.display==="none",j=PPSMA.Menu.FIsHidden(a);if(i||j)d=true;else if(PPSMA.Menu.FIsIType(a,"separator"))if(b||c==0)d=true;else b=a;else{var g=a.getAttribute("menuGroupId");if(g!=e&&!b&&c!=0){var b=document.createElement("ie:menuitem");b.setAttribute("type","separator");h._oRoot.insertBefore(b,a)}else b=null;e=g}if(d){a.parentNode.removeChild(a);c--}}b&&b.parentNode.removeChild(b)};PPSMA.Menu.IsElementRtl=function(a){a:;while(a&&a.tagName){var b=a.getAttribute("dir");if((b||b==="")&&a.style)b=a.style.direction;if(b=="rtl")return true;else if(b=="ltr")return false;a=a.parentNode}return false};PPSMA.Menu.AdjustScrollPosition=function(c,d,b){a:;var a=c;while(a&&a!=d&&a!=c.offsetParent&&a.tagName&&a.tagName.toLowerCase()!="body"&&a.tagName.toLowerCase()!="html"){if(a.scrollWidth>a.clientWidth&&a.offsetWidth>=a.clientWidth&&a.clientWidth!=0)if(!PPSMA.Menu.IsElementRtl(a)){if(a.scrollLeft>0)b.x-=a.scrollLeft}else b.x+=a.scrollWidth-a.offsetWidth-a.scrollLeft;if(a.scrollTop>0)b.y-=a.scrollTop;a=a.parentNode}};PPSMA.Menu.GetElementPosition=function(c,f){a:;var b={};b.x=0;b.y=0;b.width=0;b.height=0;if(c.offsetParent){var a=c;while(a&&a!=f){b.x+=a.offsetLeft;b.y+=a.offsetTop;PPSMA.Menu.AdjustScrollPosition(a,f,b);var e=a.tagName.toLowerCase();if(e!="table"&&e!="body"&&e!="html"&&e!="div"&&a.clientTop&&a.clientLeft){b.x+=a.clientLeft;b.y+=a.clientTop}if(browseris.ie&&e=="td"){if(a.runtimeStyle.borderTopStyle!="none"||a.currentStyle.borderTopStyle!="none"){var d;if(a.runtimeStyle.borderTopWidth!="")d=parseInt(a.runtimeStyle.borderTopWidth);else d=parseInt(a.currentStyle.borderTopWidth);if(!isNaN(d))b.y+=d}if(a.runtimeStyle.borderLeftStyle!="none"||a.currentStyle.borderLeftStyle!="none"){var d;if(a.runtimeStyle.borderLeftWidth!="")d=parseInt(a.runtimeStyle.borderLeftWidth);else d=parseInt(a.currentStyle.borderLeftWidth);if(!isNaN(d))b.x+=d}}a=a.offsetParent}}else if(c.left&&c.top){b.x=c.left;b.y=c.top}else{if(c.x)b.x=c.x;if(c.y)b.y=c.y}if(c.offsetWidth&&c.offsetHeight){b.width=c.offsetWidth;b.height=c.offsetHeight}else if(c.style&&c.style.pixelWidth&&c.style.pixelHeight){b.width=c.style.pixelWidth;b.height=c.style.pixelHeight}return b};PPSMA.Menu.InternalShow=function(b,c,s,t,j){a:;var a=b._arrPopup[b._nLevel],i,h,f;!b._oContents&&PPSMA.Menu.PrepContents(b);if(!b._oContents||PPSMA.Menu.IsOpenInternal(b))return;if(!a&&!b._oRoot){b._nLevel=0;b._oRoot=b._oContents}h=b._nLevel==0;j=j&&h;if(!a){b._arrPopup[b._nLevel]=document.createElement("DIV");a=b._arrPopup[b._nLevel];a.isMenu=true;a.master=b;a.level=b._nLevel;f=document.createElement("DIV");var g=document.createElement("table"),n=document.createElement("tbody");f.isInner=true;a.style.position="absolute";f.style.overflow="visible";g.appendChild(n);f.appendChild(g);a.appendChild(f);if(b._fIsRtL)a.setAttribute("dir","rtl");else a.setAttribute("dir","ltr");document.body.appendChild(a);PPSMA.Menu.FixUpMenuStructure(b);var q=0,r=b._oRoot.childNodes.length;for(i=0;i<r;i++){var k=b._oRoot.childNodes[i];if(k.nodeType!=1)continue;if(!PPSMA.Menu.FIsIType(k,"label")){var o=PPSMA.Menu.CreateMenuItem(b,k,PPSMA.Menu.MakeID(b,b._nLevel,q));o&&n.appendChild(o);q++}}if(PPSMA.Menu.GetType(b)=="tooltip")a.className="bsm-TooltipUIPopupBody";else a.className="bsm-MenuUIPopupBody ms-core-menu-box";g.className=b._wzMenuStyle;g.cellSpacing=0;g.cellPadding=0;a.oncontextmenu=kfnDisableEvent;a.ondragstart=kfnDisableEvent;a.onselectstart=kfnDisableEvent;if(!c._onmouseover)c._onmouseover=c.onmouseover;if(!c._onmouseout)c._onmouseout=c.onmouseout;if(!c._onmouseup)c._onmouseup=c.onmouseup;if(!c._onclick)c._onclick=c.onclick;if(!c._oncontextmenu)c._oncontextmenu=c.oncontextmenu;if(browseris.nav){a.onkeypress=function(){a:;return false};a.onkeyup=function(){a:;return false};a.onmousedown=function(a){a:;PPSMA.Menu.TrapMenuClick(a);return false};a.onmouseover=function(a){a:;PPSMA.Menu.PopupMouseOver(a);return false};a.onmouseout=function(a){a:;PPSMA.Menu.PopupMouseLeave(a);return false};if("ontouchstart" in window){a.ontouchstart=function(a){a:;PPSMA.Menu.g_bIgnoreTouchUp=false;a.cancelBubble=true;return true};a.ontouchend=function(a){a:;a.cancelBubble=true;return true}}if(PPSMA.Menu.GetType(b)!="tooltip"){a.onkeydown=function(a){a:;PPSMA.Menu.PopupKeyDown(a);return false};a.onclick=function(a){a:;PPSMA.Menu.PopupMouseClick(a);PPSMA.Menu.TrapMenuClick(a);return false};c.onmouseup=function(a){a:;PPSMA.Menu.TrapMenuClick(a);return false};c.onclick=function(a){a:;PPSMA.Menu.TrapMenuClick(a);return false};c.oncontextmenu=function(a){a:;PPSMA.Menu.TrapMenuClick(a);return false}}else a.onclick=function(a){a:;PPSMA.Menu.TrapMenuClick(a);return false};c.onmouseover=function(a){a:;PPSMA.Menu.PopupMouseOverParent(a);return false};c.onmouseout=function(a){a:;PPSMA.Menu.PopupMouseLeaveParent(a);return false}}else{a.onmousedown=new Function("PPSMA.Menu.TrapMenuClick(event); return false;");a.onmouseover=new Function("PPSMA.Menu.PopupMouseOver(event); return false;");a.onmouseout=new Function("PPSMA.Menu.PopupMouseLeave(event); return false;");if("ontouchstart" in window)a.ontouchstart=function(a){a:;a.cancelBubble=true;return true};if(PPSMA.Menu.GetType(b)!="tooltip"){a.onkeydown=new Function("PPSMA.Menu.PopupKeyDown(event); return false;");a.onclick=new Function("PPSMA.Menu.PopupMouseClick(event); PPSMA.Menu.TrapMenuClick(event); return false;");c.onmouseup=new Function("PPSMA.Menu.TrapMenuClick(event); return false;");c.onclick=new Function("PPSMA.Menu.TrapMenuClick(event); return false;");c.oncontextmenu=new Function("PPSMA.Menu.TrapMenuClick(event); return false;")}else a.onclick=new Function("PPSMA.Menu.TrapMenuClick(event); return false;");c.onmouseover=new Function("PPSMA.Menu.PopupMouseOverParent(event); return false;");c.onmouseout=new Function("PPSMA.Menu.PopupMouseLeaveParent(event); return false;")}if(h){var m=b.getAttribute("onunloadtext");if(m)a.onunload=new Function(m)}}else{var p=b._arrSelected[b._nLevel];p&&PPSMA.Menu.UnselectItem(p)}b._arrSelected[b._nLevel]=null;var d,e;if(browseris.ie){var l=PPSMA.SizeEx.getScrollLeft();d=document.createElement("iframe");PPSMA.Menu.AssureId(d);d.style.position="absolute";d.style.display="none";d.scrolling="no";d.frameBorder="0";document.body.appendChild(d);a.style.zIndex=103;a._backgroundFrameId=d.id;e=document.createElement("div");PPSMA.Menu.AssureId(e);e.style.position="absolute";e.style.display="none";document.body.appendChild(e);a._backgroundDivId=e.id;l!=PPSMA.SizeEx.getScrollLeft()&&PPSMA.SizeEx.setScrollLeft(l)}else a.style.zIndex=103;PPSMA.Menu.SetMenuPosition(b,c,a,f,s,t,j,h);if(browseris.ie){PPSMA.Menu.SetBackFrameSize(null,a);a.onresize=new Function("PPSMA.Menu.SetBackFrameSize(event, null);");d.style.display="block";d.style.zIndex=101;e.style.display="block";e.style.zIndex=102}};PPSMA.Menu.SetMenuPosition=function(F,J,b,e,G,H,E,C){a:;var g=window.screen.width,i=window.screen.height;if(self.innerHeight){g=self.innerWidth;i=self.innerHeight}else if(document.documentElement&&document.documentElement.clientHeight){g=document.documentElement.clientWidth;i=document.documentElement.clientHeight}else if(document.body){g=document.body.clientWidth;i=document.body.clientHeight}var a=b.scrollWidth+b.offsetWidth-b.clientWidth,d=b.scrollHeight+b.offsetHeight-b.clientHeight,B=false,t=false;if(F._fCompactItemsWithoutIcons&&d>=375){t=true;d=375}if(d>=i-10){t=true;d=i-10;a+=16}if(a>g-10){B=true;a=g-10}if(!B&&!t)e.style.overflow="visible";else if(browseris.ie){if(B){b.style.width=a+"px";e.style.width=a+"px";e.style.overflowX="scroll"}else{e.style.width=a+"px";e.style.overflowX="visible"}if(t){b.style.height=d+"px";e.style.height=d+"px";e.style.overflowY="scroll"}else{e.style.height=d+"px";e.style.overflowY="visible"}}else{b.style.height=d+"px";e.style.height=d+"px";b.style.width=a+"px";e.style.width=a+"px";e.style.overflow="auto"}a=b.scrollWidth+b.offsetWidth-b.clientWidth;d=b.scrollHeight+b.offsetHeight-b.clientHeight;var v=0,u=g,c=0,M=0,n=0,f,o=J;if(browseris.safari)if(o.tagName=="TR"&&o.childNodes.length>0)o=o.childNodes[0];var p=PPSMA.Menu.GetElementPosition(o);c=p.x;n=p.y;if(C)if(G==-1&&H==-1){f=p.width;n+=p.height-1}else{c+=G;n+=H;f=-4}else f=p.width+1;var I=!E&&!document.body.getAttribute("flipped"),s,A,w,x;if(!F._fIsRtL){var q,l;if(C){w=c;q=c+a;l=c+f-a}else{w=c+f;q=c+f+a;l=c-a}x=l;s=q>u&&l>v;A=!(l<v&&q<u)}else{var k,r;if(C){k=c+f-a;r=c+a;x=c}else{k=c-a;r=c+f+a;x=c+f}w=k;s=k<v&&r<u;A=!(r>u&&k>v)}var D=I?s:A,y=D?x:w,h,j;if(window.pageXOffset!==undefined){h=window.pageXOffset;j=window.pageYOffset}else{var m=document.body.parentElement;if(!PPSMA.Menu.IsElementRtl(document.body)){h=document.body.scrollLeft;h+=m.scrollLeft}else{h=-document.body.scrollWidth+document.body.offsetWidth+document.body.scrollLeft;h+=-m.scrollWidth+m.offsetWidth+m.scrollLeft}j=document.body.scrollTop;j+=m.scrollTop}if(a>=g)y=h;else if(y-h+a>=g)y=h+g-a;var z;if(d>=i)z=j;else if(n+d-j>=i)z=j+i-d;else z=n;b.setAttribute("flipped",E?D&&s:D);var K=Math.max(y,h),L=Math.max(z,j);b.style.left=K+"px";b.style.top=L+"px"};PPSMA.Menu.SetBackFrameSize=function(f,a){a:;if(!a)a=PPSMA.Menu.GetEventSrcElement(f);var e=a.scrollWidth+a.offsetWidth-a.clientWidth,d=a.scrollHeight+a.offsetHeight-a.clientHeight,b=document.getElementById(a._backgroundFrameId);b.style.left=a.offsetLeft+"px";b.style.top=a.offsetTop+"px";b.style.width=e+"px";b.style.height=d+"px";var c=document.getElementById(a._backgroundDivId);c.style.left=a.offsetLeft+"px";c.style.top=a.offsetTop+"px";c.style.width=e+"px";c.style.height=d+"px"};PPSMA.Menu.HideMenu=function(a,c){a:;PPSMA.Menu.ClearTimeoutToHideMenu();if(!c)c=0;if(c==2){if(a._onDestroy){a._onDestroy();a._onDestroy=null}return}if(PPSMA.Menu.IsOpenInternal(a)&&!PPSMA.Menu.IsAccessibilityFeatureEnabledProxy()){if(a._oParent){a._oParent.onclick=a._oParent._onclick;a._oParent.onmouseover=a._oParent._onmouseover;a._oParent.onmouseout=a._oParent._onmouseout;a._oParent.onmouseup=a._oParent._onmouseup;a._oParent.oncontextmenu=a._oParent._oncontextmenu}PPSMA.Menu.SetBodyEventHandlers(null,false);PPSMA.Menu.SetBodyTouchEndEventHandler(null);PPSMA.Menu.RemoveBodyMouseScrollEventHandlers(PPSMA.Menu.HandleDocumentBodyScroll,false);PPSMA.Menu.UpdateLevel(a,0);var b=a._arrPopup[0];if(b){var d=document.getElementById(b._backgroundFrameId);d&&d.parentNode.removeChild(d);b.parentNode.removeChild(b);var e=document.getElementById(b._backgroundDivId);e&&e.parentNode.removeChild(e);a._arrPopup[0]=null;if(c==0)if(a._onDestroy){a._onDestroy();a._onDestroy=null}}PPSMA.Menu.g_lastMenu=null}};PPSMA.Menu.IsOpenInternal=function(a){a:;if(a._accessibleMenu&&!a._accessibleMenu.closed)return true;if(!a._arrPopup)return false;var b=a._arrPopup[a._nLevel];return b?true:false};PPSMA.Menu.FindLabel=function(d){a:;var a=d?d.childNodes:null;if(a)for(var b=0;b<a.length;b++){var c=a[b];if(c.nodeType!=1)continue;if(PPSMA.Menu.FIsIType(c,"label"))return c}return null};PPSMA.Menu.ShowRoot=function(a,d,c,b,e,f){a:;if(c){a._oContents=null;a._oRoot=null;a._nLevel=0;a._arrPopup=[];a._arrSelected=[]}else a._oRoot=a._oContents;PPSMA.Menu.UpdateLevel(a,0);b=b!=false;PPSMA.Menu.InternalShow(a,d,e,f,b)};PPSMA.Menu.ShowSubMenu=function(a,c,b){a:;if(!b)return;if(b.submenuRoot==null)return;PPSMA.Menu.UpdateLevel(a,c);a._oRoot=b.submenuRoot;a._nLevel=a._nLevel+1;PPSMA.Menu.InternalShow(a,b,0,0,false);PPSMA.Menu.SetSubMenuCallbacks(a)};PPSMA.Menu.ShowSubMenuEvnt=function(c){a:;var a=document.getElementById(c),b=a._arrPopup[a._nLevel];if(b){b.removeAttribute("timeoutID");PPSMA.Menu.ShowSubMenu(a,a._nLevel,a._arrSelected[a._nLevel])}};function ClearTimeOut(a){a:;var b=document.body.getAttribute(a);b&&window.clearTimeout(b);document.body.removeAttribute(a)}PPSMA.Menu.ClearShowSubMenuEvnt=function(){a:;ClearTimeOut("timeoutID")};PPSMA.Menu.GetEventSrcItem=function(b,c){a:;for(var a=c;a&&!PPSMA.Menu.FIStringEquals(a.tagName,"BODY");a=a.parentNode)if(PPSMA.Menu.FIStringEquals(a.tagName,"TR")&&a.id.substring(0,b._wzPrefixID.length)==b._wzPrefixID)return a;return null};PPSMA.Menu.UpdateLevel=function(a,e){a:;var b;while(a._nLevel>e){b=a._arrPopup[a._nLevel];if(b){PPSMA.Menu.ClearShowSubMenuEvnt(b);var c=document.getElementById(b._backgroundFrameId);c&&c.parentNode.removeChild(c);var d=document.getElementById(b._backgroundDivId);d&&d.parentNode.removeChild(d);b.parentNode.removeChild(b)}a._arrPopup[a._nLevel]=null;a._arrSelected[a._nLevel]=null;a._oRoot=a._oRoot.parentNode;a._nLevel--}b=a._arrPopup[a._nLevel];b&&PPSMA.Menu.ClearShowSubMenuEvnt(b)};PPSMA.Menu.PopupMouseOver=function(e){a:;var d=PPSMA.Menu.GetEventPopup(e);if(d){var b=d.master,c=d.level;if(c<0)return;var a=PPSMA.Menu.GetEventSrcItem(b,PPSMA.Menu.GetEventSrcElement(e));if(a)if(a!=b._arrSelected[c]){if(PPSMA.Menu.FIsIType(a,"separator")||PPSMA.Menu.FIsIType(a,"valtooltip")||PPSMA.Menu.FIsIType(a,"desctooltip")||PPSMA.Menu.FIsIType(a,"normaltooltip")||PPSMA.Menu.FIsIType(a,"descvaltooltip")||PPSMA.Menu.FIsIType(a,"ttpheader")){PPSMA.Menu.ClearTimeoutToHideMenu();return}PPSMA.Menu.ToggleMenuItem(b,c,a);PPSMA.Menu.FIsIType(a,"submenu")&&PPSMA.Menu.EngageSelection(b,true,true,false)}else c<b._nLevel&&PPSMA.Menu.UnselectCurrentOption(b);PPSMA.Menu.ClearTimeoutToHideMenu()}};PPSMA.Menu.PopupMouseLeave=function(b){a:;var a;a=PPSMA.Menu.GetEventPopup(b);if(a){PPSMA.Menu.UnselectCurrentOption(a.master);PPSMA.Menu.SetTimeoutToHideMenu()}return false};PPSMA.Menu.PopupMouseOverParent=function(){a:;if(PPSMA.Menu.g_lastMenu){PPSMA.Menu.ClearTimeoutToHideMenu();PPSMA.Menu.g_lastMenu._oParent&&PPSMA.Menu.g_lastMenu._oParent._onmouseover&&PPSMA.Menu.g_lastMenu._oParent._onmouseover()}};PPSMA.Menu.PopupMouseLeaveParent=function(){a:;if(PPSMA.Menu.g_lastMenu){PPSMA.Menu.g_lastMenu._oParent&&PPSMA.Menu.g_lastMenu._oParent._onmouseout&&PPSMA.Menu.g_lastMenu._oParent._onmouseout();PPSMA.Menu.SetTimeoutToHideMenu()}};PPSMA.Menu.ClearTimeoutToHideMenu=function(){a:;document.body.getAttribute("HideMenuTimeOut")&&ClearTimeOut("HideMenuTimeOut")};PPSMA.Menu.SetTimeoutToHideMenu=function(){a:;ClearTimeOut("HideMenuTimeOut");document.body.setAttribute("HideMenuTimeOut",window.setTimeout(PPSMA.Menu.Hide,1.8e5))};PPSMA.Menu.PopupMouseClick=function(a){a:;if("ontouchstart" in window&&PPSMA.Menu.g_bIgnoreTouchUp==true)return;var f=PPSMA.Menu.GetEventPopup(a),b=f.master,c=f.level;if(c<0)return;if(b&&!b._arrSelected[c])b._arrSelected[c]=PPSMA.Menu.GetEventSrcItem(b,PPSMA.Menu.GetEventSrcElement(a));var g=b._arrSelected[c];PPSMA.Menu.UpdateLevel(b,c);var d,e;if(browseris.nav){e=a&&a.target&&a.target.className=="hierarchy";d=a&&a.target&&a.target.getAttribute("onExpand")}else{e=a&&a.srcElement&&a.srcElement.className=="hierarchy";d=a&&a.srcElement&&a.srcElement.getAttribute("onExpand")}PPSMA.Menu.EngageSelection(b,true,false,false,e,d)};PPSMA.Menu.PopupKeyDown=function(c){a:;var d=PPSMA.Menu.GetEventPopup(c),b=d.master,f=d.level;if(f<0)return;var a=PPSMA.Menu.GetEventKeyCode(c),e=c.shiftKey;if(b._fIsRtL)if(a==37)a=39;else if(a==39)a=37;if(a==9)a=!e?40:38;PPSMA.Menu.ClearShowSubMenuEvnt(d);switch(a){case 38:PPSMA.Menu.MoveMenuSelection(b,-1);break;case 40:PPSMA.Menu.MoveMenuSelection(b,1);break;case 37:case 27:PPSMA.Menu.CloseCurrentLevel(b,a==27);break;case 39:case 13:PPSMA.Menu.EngageSelection(b,a==13,false,true)}c.returnValue=false};PPSMA.Menu.AssureId=function(a){a:;if(!a.id||a.id==="")a.id="msomenuid"+PPSMA.Menu.GetUniqueNumber();return a.id};PPSMA.Menu.NavigateToMenu=function(c){a:;var b=c._arrPopup[c._nLevel].firstChild;b.tagName!="DIV"&&alert("Internal Error at PPSMA.Menu.NavigateToMenu");PPSMA.Menu.AssureId(b);try{var a=b.firstChild.firstChild.firstChild;a.tabIndex=0;if(a.setActive)a.setActive();else a.focus&&a.focus()}catch(d){}};PPSMA.Menu.ExecuteOnClick=function(fnOnClick,oMaster){a:;try{if(browseris.safari)if(PPSMA.Menu.FIStringEquals(typeof fnOnClick,"string"))eval("var document=window.document; {"+fnOnClick+"}");else fnOnClick();else{if(PPSMA.Menu.FIStringEquals(typeof fnOnClick,"string"))fnOnClick=new Function("event","var document=window.document; {"+fnOnClick+"}");var oTemp=window.document.body.appendChild(window.document.createElement("span"));oTemp.master=oMaster;oTemp.onclick=fnOnClick;var evt,ctx=null;if(typeof currentCtx!="undefined"&&currentCtx)ctx=currentCtx;else if(typeof ctxFilter!="undefined"&&ctxFilter)ctx=ctxFilter;if(browseris.ie)evt={srcElement:oTemp,fakeEvent:1,currentCtx:ctx};else evt={target:oTemp,fakeEvent:1,currentCtx:ctx};oTemp.onclick(evt);oTemp.parentNode.removeChild(oTemp)}}catch(e){}};PPSMA.Menu.EngageSelection=function(oMaster,fDoSelection,fDelayExpandSM,fEnterSM,fExpand,fCommand){a:;var oItem=oMaster._arrSelected[oMaster._nLevel];if(!oItem||oItem.optionDisabled)return;if(PPSMA.Menu.FIsIType(oItem,"submenu"))if(fDelayExpandSM)PPSMA.Menu.SetTimeoutOnParentWindow(oMaster,"PPSMA.Menu.ShowSubMenuEvnt");else{PPSMA.Menu.ShowSubMenu(oMaster,oMaster._nLevel,oItem);fEnterSM&&PPSMA.Menu.MoveMenuSelection(oMaster,1)}else if(fDoSelection){var fEnabled=oItem.getAttribute("enabled");if(fEnabled!="false")if(!fExpand){var fnOnClick=oItem.getAttribute("onMenuClick");if(fnOnClick){PPSMA.Menu.HideMenu(oMaster,1);PPSMA.Menu.ExecuteOnClick(fnOnClick,oMaster);PPSMA.Menu.HideMenu(oMaster,2)}}else eval(fCommand)}};PPSMA.Menu.CloseCurrentLevel=function(oMaster,fAllowHideRoot){a:;if(oMaster._nLevel>0){PPSMA.Menu.UpdateLevel(oMaster,oMaster._nLevel-1);var obj=oMaster._arrSelected[oMaster._nLevel];if(obj)if(browseris.nav){obj=obj.firstChild.firstChild.firstChild.firstChild.firstChild.nextSibling.firstChild.firstChild;obj.focus&&obj.focus()}else obj.focus&&obj.focus()}else if(fAllowHideRoot){PPSMA.Menu.HideMenu(oMaster);var oParent=oMaster._oParent;while(oParent&&oParent.tagName=="SPAN"&&oParent.getAttribute("contentEditable"))oParent=oParent.parentElement;if(oParent){var focusElement=oParent;if(oParent.foa){var foa=null;foa=eval(oParent.foa);if(!foa)foa=byid(oParent.foa);if(foa)focusElement=foa}if(focusElement.setActive)focusElement.setActive();else focusElement.focus&&focusElement.focus()}}};PPSMA.Menu.UnselectCurrentOption=function(a){a:;if(a._nLevel>=0){var b=a._arrSelected[a._nLevel];if(PPSMA.Menu.FIsIType(b,"option")){PPSMA.Menu.UnselectItem(b);a._arrSelected[a._nLevel]=null}}};PPSMA.Menu.MakeID=function(a,c,b){a:;return a._wzPrefixID+"_"+c+"_"+b};PPSMA.Menu.GetItem=function(a,b,c){a:;var d=a._arrPopup[b];return d?document.getElementById(PPSMA.Menu.MakeID(a,b,c)):null};PPSMA.Menu.MoveMenuSelection=function(b,g){a:;var a=-1,d=b._oRoot.childNodes.length,f=b._arrSelected[b._nLevel];if(f){var e=f?f.id:null;if(e){var i=parseInt(e.substring(e.lastIndexOf("_")+1,e.length));a=(i+d+g)%d}}if(a<0)a=g>0?0:d-1;var c,h=a;do{c=PPSMA.Menu.GetItem(b,b._nLevel,a);a=(a+d+g)%d}while(a!=h&&(!c||c.style.display=="none"||!(PPSMA.Menu.FIsIType(c,"option")||PPSMA.Menu.FIsIType(c,"submenu"))));PPSMA.Menu.ToggleMenuItem(b,b._nLevel,c)};PPSMA.Menu.ToggleMenuItem=function(oMaster,nLevel,oItem){a:;var oOld=oMaster._arrSelected[nLevel];if(!oItem||oOld&&oItem.id==oOld.id)return;if(oOld){PPSMA.Menu.UnselectItem(oOld);oOld.onkeydown=null;oOld.onmousedown=null;oOld.onmouseover=null;oOld.onmouseout=null;oOld.oncontextmenu=null;if("ontouchstart" in window){oOld.ontouchstart=null;oOld.ontouchend=null}if(PPSMA.Menu.FIsIType(oOld,"submenu")){PPSMA.Menu.ClearSubMenuInterval(oMaster);var hoverOff=PPSMA.Menu.GetISubMenuOnHoverOff(oOld);if(hoverOff&&hoverOff!="")eval(hoverOff)}}PPSMA.Menu.UpdateLevel(oMaster,nLevel);PPSMA.Menu.SelectItem(oItem);oMaster._arrSelected[nLevel]=oItem;oItem.tabIndex=0;if(oItem.setActive)!browseris.ie9standardUp&&oItem.setActive();else oItem.focus&&oItem.focus();var oPopup=oMaster._arrPopup[nLevel],oDiv=oPopup.childNodes[0],posPopup=PPSMA.Menu.GetElementPosition(oItem,oDiv);if(posPopup.y+posPopup.height-oDiv.scrollTop>oDiv.offsetHeight)oDiv.scrollTop=posPopup.y+posPopup.height-oDiv.offsetHeight;else if(posPopup.y<oDiv.scrollTop)oDiv.scrollTop=posPopup.y};PPSMA.Menu.SelectItem=function(b){a:;if(!b)return;var a=b.firstChild,c=a.firstChild;if(a.className=="bsm-MenuUIItemTableCellCompact")a.className="bsm-MenuUIItemTableCellCompactHover";else a.className="bsm-MenuUIItemTableCellHover";c.className="bsm-MenuUIItemTableHover"};PPSMA.Menu.UnselectItem=function(b){a:;if(!b)return;var a=b.firstChild,c=a.firstChild;if(a.className=="bsm-MenuUIItemTableCellCompactHover")a.className="bsm-MenuUIItemTableCellCompact";else a.className="bsm-MenuUIItemTableCell";c.className="bsm-MenuUIItemTable"};PPSMA.Menu.SetImageSize=function(c,b,a){a:;if(!a)if(c._fLargeIconMode)a=32;else a=16;b.width=a;b.height=a};PPSMA.Menu.CreateMenuOption=function(c,i,a,A,s){a:;var f=document.createElement("td"),g=document.createElement("td"),n=document.createElement("td"),r=document.createElement("td");i.appendChild(f);i.appendChild(g);i.appendChild(n);i.appendChild(r);if(c._fLargeIconMode)f.className=!c._fIsRtL?"bsm-MenuUIIconLarge":"bsm-MenuUIIconRtlLarge";else if(a.getAttribute("selected")=="true")f.className=!c._fIsRtL?"bsm-MenuUIIconSelected":"bsm-MenuUIIconSelectedRtL";else f.className=!c._fIsRtL?"bsm-MenuUIIcon":"bsm-MenuUIIconRtL";f.align="center";var j="bsm-MenuUILabel";if(c._fCompactItemsWithoutIcons&&!a.getAttribute("iconSrc"))j+="Compact";else if(a.getAttribute("selected")=="true")j+="Selected";if(a.getAttribute("indent")=="true")j+="Indent";if(c._fIsRtL)j+="RtL";g.className=j;n.className="bsm-MenuUIAccessKey";r.className="bsm-MenuUISubmenuArrow";if(!c._fLargeIconMode)g.noWrap=true;f.noWrap=true;n.noWrap=true;r.noWrap=true;g.id=a.id;if(!s)s=a.innerHTML;if(a.getAttribute("enabled")=="false"){i.disabled=true;g.className+=" bsm-MenuUIItemTableCellDisabled"}var l=null,q=null;if(a.getAttribute("checked")=="true"){l=c._wzChkMrkPath;q="*"}else{l=PPSMA.Menu.EvalAttributeValue(a,"iconSrc","iconScript");q=a.getAttribute("iconAltText")}var B=s,o=PPSMA.Menu.EvalAttributeValue(a,"text","textScript"),t=PPSMA.Menu.EvalAttributeValue(a,"description","descriptionScript"),d=document.createElement("div");if(t&&c._fLargeIconMode){var z=document.createElement("B"),e=document.createElement("SPAN"),v=document.createTextNode(o),D=document.createElement("BR"),p=document.createElement("SPAN"),C=document.createTextNode(t);e.setAttribute("style","white-space: nowrap;");p.className="bsm-menuitemdescription";d.appendChild(z);z.appendChild(e);e.appendChild(v);d.appendChild(D);d.appendChild(p);p.appendChild(C)}else if(o){var e=document.createElement("SPAN"),u=a.getAttribute("hierarchy");if(u){var k=document.createElement("SPAN");k.setAttribute("style","white-space: nowrap;");var y=a.getAttribute("onExpand");y&&k.setAttribute("onExpand",y);k.className="hierarchy";d.appendChild(k);k.innerHTML=u;e.setAttribute("style","white-space: nowrap;");d.appendChild(e);e.innerHTML=o}else{var v=document.createTextNode(o);e.setAttribute("style","white-space: nowrap;");d.appendChild(e);e.appendChild(v)}}var w=document.createElement("SPAN");w.innerHTML=B;d.appendChild(w);if(l){var b=document.createElement("IMG");PPSMA.Menu.SetImageSize(c,b);var h=document.createElement("LABEL");f.appendChild(b);g.appendChild(h);var m=A+"_ICON";b.id=m;b.src=l;if(q){b.alt="";b.title=""}h.htmlFor=m;h.appendChild(d)}else{var b=document.createElement("IMG");PPSMA.Menu.SetImageSize(c,b);var h=document.createElement("LABEL");f.appendChild(b);g.appendChild(h);var m=A+"_ICON";b.id=m;b.src=g_resFolder+"blank.gif";b.alt="";b.title="";h.htmlFor=m;h.appendChild(d);if(c._fLargeIconMode){b.width=32;b.height=16}else b.width=16}var x=a.getAttribute("accessKeyText");if(x)n.innerHTML=x;PPSMA.Menu.SetIType(i,"option")};PPSMA.Menu.CreateTooltip=function(f,e,c){a:;var b="",a=document.createElement("td");e.appendChild(a);a.className="bsm-Tooltipcell";a.noWrap=false;a.id=c.id;if(!b)b=c.ttpdesc;var d=null;if(PPSMA.Menu.FIsIType(c,"desctooltip")){d=PPSMA.Menu.FCLabelText(g_descriptionTag);a.innerHTML=d+PPSMA.Menu.ConvertIntoMultiLine(b);PPSMA.Menu.SetIType(e,"desctooltip")}else if(PPSMA.Menu.FIsIType(c,"valtooltip")){d=PPSMA.Menu.FCLabelText(g_valueTag);a.innerHTML=d+PPSMA.Menu.ConvertIntoMultiLine(b);PPSMA.Menu.SetIType(e,"valtooltip")}else if(PPSMA.Menu.FIsIType(c,"normaltooltip")){a.innerHTML=PPSMA.Menu.ConvertIntoMultiLine(b);PPSMA.Menu.SetIType(e,"normaltooltip")}};PPSMA.Menu.CreateDescValTooltip=function(e,d,c){a:;var b="",a=document.createElement("td");d.appendChild(a);a.className="bsm-Tooltipcell";a.noWrap=false;a.id=c.id;if(c.ttpdesc){lblText=PPSMA.Menu.FCLabelText(g_descriptionTag);if(!b)b=c.ttpdesc}else if(c.ttpval){lblText=PPSMA.Menu.FCLabelText(g_valueTag);if(!b)b=c.ttpval}a.innerHTML=lblText+PPSMA.Menu.ConvertIntoMultiLine(b);PPSMA.Menu.SetIType(d,"descvaltooltip")};PPSMA.Menu.CreateMenuSeparator=function(d,b){a:;var a=document.createElement("td");a.setAttribute("colspan","2");var c=document.createElement("hr");b.appendChild(a);a.appendChild(c);PPSMA.Menu.SetIType(b,"separator")};PPSMA.Menu.CreateHeader=function(f,e){a:;var c=document.createElement("td");c.className="bsm-ttpHdrCell";e.appendChild(c);var d=document.createElement("div");c.appendChild(d);var b=document.createElement("div");d.appendChild(b);b.className="bsm-tooltiphdr";var a=document.createElement("IMG");b.appendChild(a);a.alt="Close";a.src=g_resFolder+"CloseWindow.gif";a.onclick=PPSMA.Menu.Hide;PPSMA.Menu.SetIType(e,"ttpheader")};PPSMA.Menu.CreateSubmenu=function(b,a,c,g){a:;var e=PPSMA.Menu.FindLabel(c);PPSMA.Menu.CreateMenuOption(b,a,c,g,e?e.innerHTML:null);var f=a.childNodes[3],d=document.createElement("IMG");PPSMA.Menu.SetImageSize(b,d,16);f.appendChild(d);d.src=!b._fIsRtL?b._wzMArrPath:b._wzMArrPathRtL;d.alt=!b._fIsRtL?">":"<";d.title="";PPSMA.Menu.SetIType(a,"submenu");PPSMA.Menu.SetISubMenuOnFetch(a,PPSMA.Menu.GetISubMenuOnFetch(c));PPSMA.Menu.SetISubMenuOnPopulate(a,PPSMA.Menu.GetISubMenuOnPopulate(c));PPSMA.Menu.SetISubMenuOnHoverOff(a,PPSMA.Menu.GetISubMenuOnHoverOff(c));a.submenuRoot=c};PPSMA.Menu.MergeAttributes=function(c,b){a:;for(var e=b.attributes,d=0;d<e.length;d++){var a=e[d];a&&a.specified&&a.nodeName.toLowerCase()!="id"&&a.nodeName.toLowerCase()!="name"&&c.setAttribute(a.nodeName,a.nodeValue)}b.getAttribute("type")!=null&&c.setAttribute("type",b.getAttribute("type"));if(b.submenuRoot!=null)c.submenuRoot=b.submenuRoot};PPSMA.Menu.CreateMenuItem=function(c,b,g,j){a:;if(PPSMA.Menu.FIsIType(b,"label"))return;var a=document.createElement("tr");PPSMA.Menu.MergeAttributes(a,b);PPSMA.Menu.GetType(c)!="tooltip"&&a.setAttribute("onMenuClick",b.getAttribute("onMenuClick"));if(PPSMA.Menu.FIsIType(b,"separator")){PPSMA.Menu.CreateMenuSeparator(c,a);return a}!PPSMA.Menu.GetIType(b)&&PPSMA.Menu.SetIType(b,"option");var f=document.createElement("tr"),e=document.createElement("td"),d=document.createElement("table"),i=document.createElement("tbody");f.appendChild(e);e.appendChild(d);d.appendChild(i);i.appendChild(a);if(PPSMA.Menu.GetType(c)!="tooltip"){if(c._fCompactItemsWithoutIcons&&!b.getAttribute("iconSrc"))e.className="bsm-MenuUIItemTableCellCompact";else e.className="bsm-MenuUIItemTableCell";d.className="bsm-MenuUIItemTable"}else{e.className="bsm-TooltipUIItemTableCell";d.className="bsm-TooltipUIItemTable"}d.width="100%";d.cellSpacing=0;d.cellPadding=0;if(PPSMA.Menu.FIsIType(b,"submenu"))PPSMA.Menu.CreateSubmenu(c,a,b,g);else if(PPSMA.Menu.FIsIType(b,"option"))PPSMA.Menu.CreateMenuOption(c,a,b,g,j);else if(PPSMA.Menu.FIsIType(b,"valtooltip")||PPSMA.Menu.FIsIType(b,"desctooltip")||PPSMA.Menu.FIsIType(b,"normaltooltip"))PPSMA.Menu.CreateTooltip(c,a,b,g);else if(PPSMA.Menu.FIsIType(b,"descvaltooltip"))PPSMA.Menu.CreateDescValTooltip(c,a,b,g);else PPSMA.Menu.FIsIType(b,"ttpheader")&&PPSMA.Menu.CreateHeader(c,a,b);if(a.disabled||a.getAttribute("enabled")=="false"){a.disabled=false;a.className="bsm-MenuUIDisabled";a.disabled=false;for(var h=0;h<a.childNodes.length;h++){if(a.childNodes[h].nodeType!=1)continue;a.childNodes[h].disabled=true;e.className+=" bsm-MenuUIItemTableCellDisabled"}a.optionDisabled=true}PPSMA.Menu.MergeAttributes(f,a);if(a.optionDisabled)f.optionDisabled=a.optionDisabled;f.id=g;PPSMA.Menu.SetIType(f,PPSMA.Menu.GetIType(a));return f};PPSMA.Menu.GetISubMenuOnFetch=function(a){a:;return a?a.getAttribute("onfetch"):null};PPSMA.Menu.SetISubMenuOnFetch=function(a,b){a:;a&&a.setAttribute("onfetch",b)};PPSMA.Menu.GetISubMenuOnPopulate=function(a){a:;return a?a.getAttribute("onpopulate"):null};PPSMA.Menu.SetISubMenuOnPopulate=function(a,b){a:;a&&a.setAttribute("onpopulate",b)};PPSMA.Menu.GetISubMenuOnHoverOff=function(a){a:;return a?a.getAttribute("onhoveroff"):null};PPSMA.Menu.SetISubMenuOnHoverOff=function(a,b){a:;a&&a.setAttribute("onhoveroff",b)};PPSMA.Menu.GetIType=function(a){a:;return a?a.getAttribute("type"):null};PPSMA.Menu.FIsIType=function(b,a){a:;return PPSMA.Menu.FIStringEquals(PPSMA.Menu.GetIType(b),a)};PPSMA.Menu.SetIType=function(a,b){a:;a&&a.setAttribute("type",b)};PPSMA.Menu.FIStringEquals=function(a,b){a:;return a&&b&&a.toLowerCase()==b.toLowerCase()};PPSMA.Menu.RenderAccessibleMenu=function(a,c){a:;if(c){a._oContents=null;a._oRoot=null;a._nLevel=0;a._arrPopup=[];a._arrSelected=[]}else a._oRoot=a._oContents;!a._oContents&&PPSMA.Menu.PrepContents(a);if(!a._oContents)return;if(!a._oRoot){a._nLevel=0;a._oRoot=a._oContents}PPSMA.Menu.FixUpMenuStructure(a);var d=a._fIsRtL?"rtl":"ltr";PPSMA.Menu.g_html="<html dir='"+d+"'><head><title>"+Strings.STS.L_AccessibleMenu_Text+"</title></head><body><ul id='root'>";PPSMA.Menu.RenderMenuLevel(a,a._oRoot,true);PPSMA.Menu.g_html=PPSMA.Menu.g_html+"</ul></body></html>";var b=window.open("","_blank","status=no,toolbar=no,menubar=no,location=no");a._accessibleMenu=b;b.document.write(PPSMA.Menu.g_html);b.document.close();b.focus()};PPSMA.Menu.RenderAccessibleDynamicMenu=function(a,c){a:;a._oContents=c;a._oRoot=c;a._nLevel=0;a._arrPopup=[];a._arrSelected=[];PPSMA.Menu.FixUpMenuStructure(a);var d=a._fIsRtL?"rtl":"ltr";PPSMA.Menu.g_html="<html dir='"+d+"'><head><title>"+Strings.STS.L_AccessibleMenu_Text+"</title></head><body><ul id='root'>";PPSMA.Menu.RenderMenuLevel(a,a._oRoot,true);PPSMA.Menu.g_html=PPSMA.Menu.g_html+"</ul></body></html>";var b=window.open("","_blank","status=no,toolbar=no,menubar=no,location=no");a._accessibleMenu=b;b.document.write(PPSMA.Menu.g_html);b.document.close();b.focus()};PPSMA.Menu.CloseAccessibleMenu=function(a,b){a:;if(!b)b=0;if(a){if(b==0||b==1)if(a._accessibleMenu){a._accessibleMenu.close();a._accessibleMenu=null}if(b==0||b==2)if(a._onDestroy){a._onDestroy();a._onDestroy=null}}};PPSMA.Menu.GetMenuItemText=function(d,b,a){a:;if(a==""){a=PPSMA.Menu.EvalAttributeValue(b,"text","textScript");var c=PPSMA.Menu.EvalAttributeValue(b,"description","descriptionScript");if(c&&c!=""&&d._fLargeIconMode){if(a!="")a=a+": ";a=a+c}}if(b.getAttribute("checked")=="true")a="* "+a;if(b.title&&b.title!="")a=a+": "+b.title;return a};PPSMA.Menu.GetMenuItemEnabled=function(a,b){a:;if(!b)return false;if(a.getAttribute("enabled")=="false")return false;if(a.getAttribute("disabled")&&a.getAttribute("disabled")!="")return false;return true};PPSMA.Menu.g_html="";PPSMA.Menu.RenderMenuLevel=function(e,i,h){a:;for(var f=0;f<i.childNodes.length;f++){var a=i.childNodes[f];if(a.nodeType!=1)continue;if(a.style.display=="none")continue;if(PPSMA.Menu.FIsIType(a,"option")){var b=PPSMA.Menu.GetMenuItemText(e,a,a.innerHTML);if(!PPSMA.Menu.GetMenuItemEnabled(a,h))PPSMA.Menu.g_html=PPSMA.Menu.g_html+'<li><span id="'+a.id+'">'+b+"</span></li>";else PPSMA.Menu.g_html=PPSMA.Menu.g_html+'<li><a href="#" id="'+a.id+'" onMenuClick="'+a.getAttribute("onMenuClick")+'" onclick="javascript:opener.PPSMA.Menu.ExecuteOnAccessibleClick(this.getAttribute(\'onMenuClick\')); return false;" >'+b+"</a></li>"}else if(PPSMA.Menu.FIsIType(a,"submenu")){for(var b=PPSMA.Menu.GetMenuItemText(e,a,""),g=0;g<a.childNodes.length;g++){var c=a.childNodes[g];if(c.nodeType!=1)continue;if(c.style.display=="none")continue;if(PPSMA.Menu.FIsIType(c,"label")){b+=" "+c.innerHTML;break}}var d=PPSMA.Menu.GetISubMenuOnFetch(a);if(d&&d!=""){var j=PPSMA.Menu.GetISubMenuOnPopulate(a);PPSMA.Menu.g_html=PPSMA.Menu.g_html+'<li><a href="#" id="'+a.id+'" onfetch="'+d+'" onpopulate="'+j+'" onclick="javascript:opener.PPSMA.Menu.ExecuteOnAccessibleFetch(this); return false;" >'+b+"</a></li>"}else{PPSMA.Menu.g_html=PPSMA.Menu.g_html+'<li><span id="'+a.id+'">'+b;PPSMA.Menu.g_html=PPSMA.Menu.g_html+"</span><ul>";PPSMA.Menu.RenderMenuLevel(e,a,PPSMA.Menu.GetMenuItemEnabled(a,h));PPSMA.Menu.g_html=PPSMA.Menu.g_html+"</ul></li>"}}}};PPSMA.Menu.ExecuteOnAccessibleClick=function(b){a:;var a=PPSMA.Menu.g_lastMenu;if(a){PPSMA.Menu.CloseAccessibleMenu(a,1);window.focus();PPSMA.Menu.ExecuteOnClick(b,a);PPSMA.Menu.CloseAccessibleMenu(a,2)}};PPSMA.Menu.ExecuteOnAccessibleFetch=function(oItem){a:;var oMaster=PPSMA.Menu.g_lastMenu;if(oMaster&&oMaster._accessibleMenu){var fetchCB=PPSMA.Menu.GetISubMenuOnFetch(oItem),populateCB=PPSMA.Menu.GetISubMenuOnPopulate(oItem);if(fetchCB&&fetchCB!=""&&populateCB&&populateCB!=""){oMaster._accessibleMenu.onpopulate=populateCB;oMaster._accessibleMenu.intervalID=oMaster._accessibleMenu.setInterval("opener.PPSMA.Menu.CheckPopulateAccessibleCallback('"+oMaster.id+"');",300);eval(fetchCB)}}};PPSMA.Menu.FIsHidden=function(oItem){a:;if(oItem){var hiddenFunc=oItem.getAttribute("hidden");if(!hiddenFunc)return false;return eval(hiddenFunc)}else return false};PPSMA.Menu.EvalAttributeValue=function(oNode,sAttribute1,sAttribute2){a:;var result=oNode.getAttribute(sAttribute2);if(result&&result.toLowerCase().indexOf("javascript:")==0){result=eval(result.substring(11));if(result&&result!="")return result}var result=oNode.getAttribute(sAttribute1);if(!result)return "";return result};PPSMA.Menu.FCLabelText=function(a){a:;a='<b class = "bsm-TooltipLabel">'+a+"</b><br/>";return a};PPSMA.Menu.ConvertIntoMultiLine=function(f){a:;var d=f,a=d.length,b=120,c=0,e="";while(a-b>=0){var h=d.substr(c,b);e=e+h+"<br/>";c=c+b;a=a-b}var g=e+d.substr(c,a)+"<br/>";return g};PPSMA.Menu.Refresh=function(a,b,c){a:;PPSMA.Menu.ClearSubMenuInterval(a);if(c)if(a._accessibleMenu){PPSMA.Menu.CloseAccessibleMenu(a,0);PPSMA.Menu.RenderAccessibleDynamicMenu(a,b)}else{PPSMA.Menu.CloseCurrentLevel(a,false);oParent=a._arrSelected[a._nLevel];oParent.submenuRoot=b;PPSMA.Menu.SetTimeoutOnParentWindow(a,"PPSMA.Menu.ShowNewSubMenuEvnt")}};PPSMA.Menu.ClearSubMenuInterval=function(b){a:;var a=b._arrPopup[b._nLevel];if(a){var c=a.getAttribute("intervalID");typeof c=="number"&&window.clearInterval(c);a.removeAttribute("intervalID")}};PPSMA.Menu.SetTimeoutOnParentWindow=function(a,c){a:;var b=a._arrPopup[a._nLevel];b&&b.setAttribute("timeoutID",window.setTimeout(new Function(c+"('"+a.id+"');"),100))};PPSMA.Menu.ShowNewSubMenuEvnt=function(c){a:;var a=document.getElementById(c),b=a._arrPopup[a._nLevel];if(b){b.removeAttribute("timeoutID");PPSMA.Menu.ShowNewSubMenu(a,a._nLevel,a._arrSelected[a._nLevel])}};PPSMA.Menu.ShowNewSubMenu=function(a,c,b){a:;if(!b)return;if(!b.submenuRoot)return;PPSMA.Menu.UpdateLevel(a,c);a._oRoot=b.submenuRoot;a._nLevel=a._nLevel+1;PPSMA.Menu.InternalShow(a,b,0,0,false);PPSMA.Menu.MoveMenuSelection(a,1)};PPSMA.Menu.SetSubMenuCallbacks=function(oMaster){a:;var oPopup=oMaster._arrPopup[oMaster._nLevel];if(oPopup){var oItem=oMaster._arrSelected[oMaster._nLevel-1];if(!oItem)oItem=oMaster._arrSelected[oMaster._nLevel];var fetchCB=PPSMA.Menu.GetISubMenuOnFetch(oItem);if(fetchCB&&fetchCB!=""){oPopup.setAttribute("intervalID",window.setInterval(new Function("PPSMA.Menu.CheckPopulateCallback('"+oMaster.id+"');"),300));eval(fetchCB)}}};PPSMA.Menu.CheckPopulateCallback=function(id){a:;var oMaster=document.getElementById(id),oItem=oMaster._arrSelected[oMaster._nLevel-1],populateCB=PPSMA.Menu.GetISubMenuOnPopulate(oItem);if(populateCB&&populateCB!="")eval(populateCB)};PPSMA.Menu.CheckPopulateAccessibleCallback=function(id){a:;var oMaster=document.getElementById(id);if(oMaster._accessibleMenu){var populateCB=oMaster._accessibleMenu.onpopulate;if(populateCB&&populateCB!="")eval(populateCB)}};typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs!="undefined"&&NotifyScriptLoadedAndExecuteWaitingJobs("analyticreports.js")