function ULSNVe(){var o=new Object;o.ULSTeamName="Microsoft SharePoint Foundation";o.ULSFileName="SP.UI.Rte.js";return o;}
Type.registerNamespace("CUI");Type.registerNamespace("CUI.Page");if(typeof CUI.Page.PageComponent=="undefined"){CUI.Page.ICommandHandler=function(){};CUI.Page.ICommandHandler.registerInterface("CUI.Page.ICommandHandler");CUI.Page.PageComponent=function(){};CUI.Page.PageComponent.prototype={init:function(){},getGlobalCommands:function(){ULSNVe:;return null},getFocusedCommands:function(){ULSNVe:;return null},handleCommand:function(){ULSNVe:;return false},canHandleCommand:function(){ULSNVe:;return false},isFocusable:function(){ULSNVe:;return false},receiveFocus:function(){ULSNVe:;return false},yieldFocus:function(){ULSNVe:;return true},getId:function(){ULSNVe:;return"PageComponent"}};CUI.Page.PageComponent.registerClass("CUI.Page.PageComponent",null,CUI.Page.ICommandHandler)}Type.registerNamespace("RTE");RTE.Rectangle=function(){};RTE.Alignment=function(){};RTE.Alignment.prototype={left:0,right:1,center:2,justify:3};RTE.Alignment.registerEnum("RTE.Alignment",false);RTE.ApplyType=function(){};RTE.ApplyType.prototype={tag:0,className:1,style:2,attribute:3};RTE.ApplyType.registerEnum("RTE.ApplyType",false);RTE.ApplyRestrictions=function(){};RTE.ApplyRestrictions.prototype={none:0,nonBlock:1};RTE.ApplyRestrictions.registerEnum("RTE.ApplyRestrictions",false);RTE.EmbeddingInsertArgs=function(){ULSNVe:;this.$5g_0=false;this.$BR_0=null;this.$7Z_0=0};RTE.FontSizeInfo=function(){};RTE.FontFamilyInfo=function(){};RTE.IAutocomplete=function(){};RTE.IAutocomplete.registerInterface("RTE.IAutocomplete");RTE.ICommandProcessor=function(){};RTE.ICommandProcessor.registerInterface("RTE.ICommandProcessor");RTE.InsertTableCommandType=function(){};RTE.InsertTableCommandType.prototype={insert:0,preview:1,revertPreview:2};RTE.InsertTableCommandType.registerEnum("RTE.InsertTableCommandType",false);RTE.InsertTableOptions=function(){};RTE.InsertLinkDialogArguments=function(){};RTE.RangeEndPointOption=function(){};RTE.RangeEndPointOption.prototype={startToEnd:0,startToStart:1,endToStart:2,endToEnd:3};RTE.RangeEndPointOption.registerEnum("RTE.RangeEndPointOption",false);RTE.GalleryData=function(){ULSNVe:;this.ribbonButtons=new Array(0)};RTE.StyleButton=function(){};RTE.CommandType=function(){};RTE.CommandType.prototype={command:0,preview:1,previewRevert:2};RTE.CommandType.registerEnum("RTE.CommandType",false);RTE.TableCellInfo=function(){};RTE.TableColumnInfo=function(){};RTE.TableGrid=function(){};RTE.CircularArray=function(a){ULSNVe:;this.$2f_0=new Array(a)};RTE.CircularArray.prototype={$2f_0:null,$2i_0:0,$13_0:0,push:function(a){ULSNVe:;this.$2f_0[this.$2i_0]=a;this.$2i_0++;if(this.$2i_0>=this.$2f_0.length)this.$2i_0=0;if(this.$13_0<this.$2f_0.length)this.$13_0++},pop:function(){ULSNVe:;if(this.$13_0<=0)return null;this.$2i_0--;this.$13_0--;var a=this.$2f_0[this.$2i_0];this.$2f_0[this.$2i_0]=null;return a},get_length:function(){ULSNVe:;return this.$13_0},getItemAt:function(b){ULSNVe:;if(b>=this.$13_0)return null;var a=this.$2i_0-this.$13_0+b;if(a<0)a+=this.$2f_0.length;return this.$2f_0[a]}};RTE.HtmlTagName=function(){};RTE.SelectionNodesProcessor=function(){};RTE.SelectionNodesProcessor.prototype={$N_0:null,$5C_0:null,setSelectionSettings:function(a){ULSNVe:;this.$N_0=a;this.$5C_0=null},get_parentElement:function(){ULSNVe:;return this.$N_0.parentElement()},get_range:function(){ULSNVe:;return this.$N_0},get_innerNodes:function(){ULSNVe:;if(!this.$5C_0){var a=this.$N_0.isEmpty();this.$5C_0=this.$N_0.getReducedInnerNodes(!a);RTE.RteUtility.$Kk(this.$5C_0)}return this.$5C_0}};RTE.ApplyOnSelectionProcessor=function(){ULSNVe:;this.$$d_$F0_1=Function.createDelegate(this,this.$F0_1);this.$$d_$F2_1=Function.createDelegate(this,this.$F2_1);this.$$d_$F8_1=Function.createDelegate(this,this.$F8_1);this.$21_1=new RTE.NodeDictionaryCache;RTE.ApplyOnSelectionProcessor.initializeBase(this)};RTE.ApplyOnSelectionProcessor.$F9=function(a,c){ULSNVe:;if(RTE.ApplyOnSelectionProcessor.$5b(a)){var b=a.ownerDocument.createElement(c.$3L_1[0]);SP.UI.UIUtility.insertBefore(b,a);b.appendChild(a)}};RTE.ApplyOnSelectionProcessor.$F3=function(c,a){ULSNVe:;var b=RTE.ApplyOnSelectionProcessor.$F7(c,a.$D_1);a.$5l_1(b)};RTE.ApplyOnSelectionProcessor.$AY=function(c,a){ULSNVe:;var b=RTE.ApplyOnSelectionProcessor.$AW(c,a.$U_1,a.$D_1);a.$5l_1(b)};RTE.ApplyOnSelectionProcessor.$F7=function(a,c){ULSNVe:;if(RTE.ApplyOnSelectionProcessor.$5b(a)){var b=a.ownerDocument.createElement("SPAN");SP.UI.UIUtility.insertBefore(b,a);b.appendChild(a);b.className=c;return b}return a};RTE.ApplyOnSelectionProcessor.$AW=function(a,c,d){ULSNVe:;if(RTE.ApplyOnSelectionProcessor.$5b(a)){var b=a.ownerDocument.createElement("SPAN");SP.UI.UIUtility.insertBefore(b,a);b.appendChild(a);b.style[c]=d;return b}return a};RTE.ApplyOnSelectionProcessor.$F1=function(a,c){ULSNVe:;if(RTE.ApplyOnSelectionProcessor.$5b(a)){var b=a.ownerDocument.createElement("SPAN");SP.UI.UIUtility.insertBefore(b,a);b.appendChild(a);b[c.$U_1]=c.$D_1}};RTE.ApplyOnSelectionProcessor.$5b=function(a){ULSNVe:;var b=RTE.RteUtility.$1x(a,true)&&(!a.previousSibling||RTE.RteUtility.$Q(a.previousSibling)||RTE.RteUtility.$1P(a.previousSibling))&&(!a.nextSibling||RTE.RteUtility.$Q(a.nextSibling)||RTE.RteUtility.$1P(a.nextSibling));return!b};RTE.ApplyOnSelectionProcessor.$Hd=function(){};RTE.ApplyOnSelectionProcessor.prototype={$3L_1:null,$2H_1:null,$6k_1:null,$3K_1:null,$12_1:0,$U_1:null,$D_1:null,$45_1:null,$D7_1:0,$3c_1:null,$2Y_1:null,setSettings:function(a,h,i,c,j,k,l,d,e,m){ULSNVe:;RTE.SelectionNodesProcessor.prototype.setSelectionSettings.call(this,a);this.$12_1=h;this.$3L_1=i;this.$2H_1=c;this.$6k_1=m;this.$U_1=j;this.$D_1=k;this.$45_1=l;this.$D7_1=!RTE.SU.$7(e)?e:0;this.$3K_1=!RTE.SU.$7(d)?d:new Array(0);if(!RTE.SU.$2(this.$U_1))this.$3K_1[this.$3K_1.length]=this.$U_1;this.$21_1=new RTE.NodeDictionaryCache;if(!this.$3L_1)this.$3L_1=[];if(!c)this.$2H_1=[];if(!this.$12_1){this.$3c_1=RTE.ApplyOnSelectionProcessor.$F9;this.$2Y_1=RTE.ApplyOnSelectionProcessor.$Hd}else if(this.$12_1===1){var f=a.getEditableRegion(),g=RTE.Canvas.getCachedRestriction(f,"UseInlineStyle",false);if(g){this.$12_1=2;this.$3c_1=RTE.ApplyOnSelectionProcessor.$AY;this.$2Y_1=this.$$d_$F8_1;var b=a.$3_0;this.$D_1=RTE.RteUtility.$I6(b.ownerDocument,b,this.$D_1,this.$U_1)}else{this.$3c_1=RTE.ApplyOnSelectionProcessor.$F3;this.$2Y_1=this.$$d_$F2_1}}else if(this.$12_1===2){this.$3c_1=RTE.ApplyOnSelectionProcessor.$AY;this.$2Y_1=this.$$d_$F8_1}else if(this.$12_1===3){this.$3c_1=RTE.ApplyOnSelectionProcessor.$F1;this.$2Y_1=this.$$d_$F0_1}},$EL_1:function(){ULSNVe:;var a=this.$N_0.getCurrentStateNode();return!this.$6u_1(a)},$DP_1:function(a){ULSNVe:;return RTE.RteUtility.$53(a.tagName,this.$3L_1)},$DN_1:function(b){ULSNVe:;if(this.$12_1===1){var c=b.className;if(this.$4C_1){for(var a=0;a<this.$2H_1.length;a++)if(c.indexOf(this.$2H_1[a])!==-1)return true}else return RTE.RteUtility.$6M(b,this.$D_1)}return false},$DO_1:function(b){ULSNVe:;var a=b.style[this.$U_1];return a===this.$D_1||this.$4C_1&&!RTE.SU.$2(a)?true:false},$DM_1:function(b){ULSNVe:;var a=b.getAttribute(this.$U_1);return a===this.$D_1?true:false},$DC_1:function(a){ULSNVe:;if(a.nodeType===1)if(this.$4C_1){var b=this.$DP_1(a),c=this.$DN_1(a);if(this.$U_1){var d=this.$DO_1(a),e=this.$DM_1(a);return b||c||d||e}return b||c}else if(this.$12_1===1)return this.$DN_1(a);else if(!this.$12_1)return this.$DP_1(a);else if(this.$12_1===3)return this.$DM_1(a);else if(this.$12_1===2)return this.$DO_1(a);return false},$Bz_1:function(b){ULSNVe:;var a=b;while(a&&!RTE.Canvas.$i(a)){if(this.$DC_1(a))return a;a=a.parentNode}return null},$6u_1:function(a){ULSNVe:;var b=false,d=this.$21_1.getEntry(a);if(!RTE.SU.$7(d))return d;if((this.$D_1||this.$45_1)&&this.$U_1&&this.$U_1.toLowerCase()!=="textdecoration"){var f=RTE.RteUtility.$1c(a);if(f){var c=f[this.$U_1];if(this.$D_1&&c===this.$D_1){this.$5z_1(a,true);return true}if(this.$45_1&&c===this.$45_1){this.$5z_1(a,false);return false}if(this.$U_1==="fontWeight"&&this.$D_1==="bold"&&typeof c==="number"){b=c>400;this.$5z_1(a,b);return b}}}var e=this.$Bz_1(a);if(e&&e.parentNode)b=true;this.$5z_1(a,b);return b},$5z_1:function(a,b){ULSNVe:;!RTE.RteUtility.$1P(a)&&this.$21_1.addEntry(a,b)},queryApply:function(){ULSNVe:;this.$21_1=new RTE.NodeDictionaryCache;var a=new RTE.CommandState;a.$C_0=true;a.$1I_0=!this.$EL_1();return a},process:function(){ULSNVe:;if(this.$EL_1())this.apply();else this.remove()},apply:function(){ULSNVe:;this.$21_1=new RTE.NodeDictionaryCache;var c=this.$N_0.isEmpty(),d=!c?this.get_innerNodes():[];if(!d.length){var b=this.$N_0.$3_0.ownerDocument,a=null;switch(this.$12_1){case 0:a=b.createElement(this.$3L_1[0]);break;case 2:a=b.createElement("SPAN");a.style[this.$U_1]=this.$D_1;break;case 3:a=b.createElement("SPAN");a.setAttribute(this.$U_1,this.$D_1);break;case 1:a=b.createElement("SPAN");a.className=this.$D_1}this.$5l_1(a);this.$Da_1();SP.UI.UIUtility.insertBefore(a,this.$N_0.$3_0);this.$N_0.moveToStartOfNode(a);this.$7r_1(a);RTE.RteUtility.$3y(a)&&RTE.RteUtility.removeNodeAndKeepChildNodes(a)}else this.$AU_1(d);!c&&this.$N_0.normalize();this.$N_0.resetCacheRange()},$F2_1:function(a,b){ULSNVe:;if(RTE.RteUtility.$1P(a)||this.$52_1(a))return;RTE.RteUtility.$25(a,b.$D_1,b.$2H_1);b.$5l_1(a)},$F8_1:function(a,b){ULSNVe:;if(RTE.RteUtility.$1P(a)||this.$52_1(a))return;if(a.style){RTE.SnapshotManager.setCurrentRegionDirtyIf(a.style[b.$U_1]!==b.$D_1);a.style[b.$U_1]=b.$D_1}b.$5l_1(a)},$5l_1:function(b){ULSNVe:;if(this.$U_1==="color"&&b.nodeType===1){var d=RTE.Canvas.getEditableRegion(b),a=b;while(a&&a!==d){var c=RTE.RteUtility.$1c(a);if(c&&c.textDecoration!=="none"){b.style.textDecoration=c.textDecoration;return}a=a.parentNode}}},$F0_1:function(a,b){ULSNVe:;if(RTE.RteUtility.$1P(a)||this.$52_1(a))return;RTE.SnapshotManager.setCurrentRegionDirtyIf(a.getAttribute(b.$U_1)!==b.$D_1);a.setAttribute(b.$U_1,b.$D_1)},$AU_1:function(g){ULSNVe:;for(var e=null,h=this.$N_0.parentElement(),f=[],b=[],c=0;c<g.length;c++){var a=g[c];this.$5R_1(a);if(!RTE.RteUtility.$b(a,e,h)){if(a.nodeType===3)this.$3c_1(a,this);else{this.$21_1.clearEntry(a);this.$2Y_1(a,this)}if(this.$6u_1(a))e=a}if(Array.indexOf(f,a.parentNode)===-1){Array.add(f,a.parentNode);Array.add(b,a)}}for(var d=0;d<b.length;d++)this.$7r_1(b[d])},$7r_1:function(h){ULSNVe:;if(!this.$12_1)return;if(this.$4C_1)return;var a=h.parentNode;if(!RTE.Canvas.isEditable(a)||RTE.Canvas.$i(a))return;if(this.$52_1(a)&&RTE.RteUtility.$1w(a,true)===RTE.RteUtility.$1e(a,true))return;for(var g=a.childNodes,i=RTE.RteUtility.$Q(a),j=g.length,c=0;c<j;c++){var b=g[c];if(SP.UI.UIUtility.isTextNode(b)&&(b.nodeValue.replace(RTE.RteUtility.$2O,"")===""||i&&(!b.nextSibling||!b.previousSibling)&&RTE.RteUtility.$6U(b.nodeValue,false)))continue;if(b.nodeType===3&&!RTE.ApplyOnSelectionProcessor.$5b(b))continue;if(this.$DC_1(b))continue;if(this.$6u_1(b))continue;if(!RTE.RteUtility.$3y(b)||b.childNodes.length>0)return}for(var d=0;d<a.childNodes.length;d++){var e=a.childNodes[d];(this.$12_1===1&&e.className===this.$D_1||this.$12_1!==1&&RTE.SU.$2(e.className))&&this.$5R_1(e)}RTE.RteUtility.$Dy(a);if(this.$52_1(a)){var f=document.createElement("SPAN");RTE.RteUtility.$k(a,f);a.appendChild(f);this.$2Y_1(f,this)}else{this.$21_1.clearEntry(h);this.$2Y_1(a,this);this.$7r_1(a)}},$52_1:function(a){ULSNVe:;if(this.$D7_1===1&&a.nodeType===1){if(RTE.RteUtility.$Q(a)||a.tagName==="A")return true;if(this.$6k_1&&a.className)for(var b=0;b<this.$6k_1.length;b++)if(a.className.indexOf(this.$6k_1[b])!==-1)return true}return false},$Kq_1:function(a){ULSNVe:;if(RTE.RteUtility.$53(a.tagName,this.$3L_1)){var c=!RTE.SU.$2(a.style.cssText),d=!RTE.SU.$2(a.className);if(c||d){var b=document.createElement("SPAN");if(c)b.style.cssText=a.style.cssText;if(d)b.className=a.className;RTE.RteUtility.$k(a,b);a.parentNode.replaceChild(b,a)}else RTE.RteUtility.removeNodeAndKeepChildNodes(a);return true}return false},$Kg_1:function(a){ULSNVe:;var c=a.className;RTE.RteUtility.$9T(a,RTE.ApplyOnSelectionProcessor.$22.$2H_1);var b=a.className;RTE.SnapshotManager.setCurrentRegionDirtyIf(c!==b);if(b===""){a.removeAttribute("class");a.removeAttribute("className")}return c!==b},$Kp_1:function(a){ULSNVe:;var b=false;if(a.style)for(var c=0;c<this.$3K_1.length;c++){var d=this.$3K_1[c],g=a.style[d];if(!RTE.SU.$2(g)){RTE.SnapshotManager.setCurrentRegionDirty();if(a.style.removeAttribute){a.style.removeAttribute(d);b=true}else{a.style[d]="";b=true}}}if(a.nodeType===1&&a.tagName==="FONT")for(var e=0;e<this.$3K_1.length;e++){var f=RTE.ApplyOnSelectionProcessor.$Bf[this.$3K_1[e]];if(!RTE.SU.$2(f)){a.removeAttribute(f);b=true}}return b},$Ke_1:function(a){ULSNVe:;var b=a.getAttribute(this.$U_1);if(!RTE.SU.$2(b)){a.removeAttribute(this.$U_1);RTE.SnapshotManager.setCurrentRegionDirty();return true}return false},$5R_1:function(a){ULSNVe:;this.$21_1.clearEntry(a);if(!SP.UI.UIUtility.isTextNode(a)){var b=this.$Kg_1(a),c=this.$Kp_1(a),d=this.$Ke_1(a),e=this.$Kq_1(a);return b||c||d||e}return false},$Kd_1:function(f,i){ULSNVe:;var c=[],a=this.$Bz_1(f);if(a){var d=new RTE.CanvasRange("parent");d.moveToNode(a);var g=d.getReducedInnerNodes(true);d.dispose();this.$5R_1(a);var h=this.$D_1;if(this.$2H_1&&this.$2H_1.length>0&&this.$12_1===1)this.$D_1=RTE.RteUtility.$I8(a,this.$2H_1);for(var e=0;e<g.length;e++){var b=g[e];!Array.contains(i,b)&&!Array.contains(c,b)&&!RTE.RteUtility.$b(this.$N_0.$3_0,b,a)&&!RTE.RteUtility.$b(this.$N_0.$4_0,b,a)&&Array.add(c,b)}this.$AU_1(c);this.$D_1=h}else if(this.$45_1){this.$21_1.clearEntry(f);RTE.ApplyOnSelectionProcessor.$AW(f,this.$U_1,this.$45_1)}},$4C_1:false,remove:function(){ULSNVe:;var c=this.$N_0.isEmpty();this.$4C_1=true;var a=!c?this.get_innerNodes():[];if(!a.length)this.$5R_1(this.$N_0.$3_0);else for(var b=0;b<a.length;b++){var d=a[b];this.$5R_1(d);RTE.RteUtility.$Kj(d)}this.$Dz_1(this.$N_0.$3_0,a);this.$Dz_1(this.$N_0.$4_0,a);RTE.RteUtility.$Dy(this.$N_0.$3_0.parentNode);this.$4C_1=false;if(!c)this.$N_0.normalize();else this.$Da_1();this.$N_0.resetCacheRange()},$Da_1:function(){ULSNVe:;if(RTE.RteUtility.isInternetExplorer()){var a=this.$N_0.$3_0.parentNode;if(a&&a===this.$N_0.$4_0.parentNode&&a.childNodes.length===2&&a.tagName==="P"){var b=a.cloneNode(false);RTE.RteUtility.$k(a,b);a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a)}}},$Dz_1:function(a,b){ULSNVe:;this.$6u_1(a)&&this.$Kd_1(a,b)}};RTE.Autocomplete=function(c,b,a){ULSNVe:;this.$$d_$Jw_0=Function.createDelegate(this,this.$Jw_0);this.$$d_$KA_0=Function.createDelegate(this,this.$KA_0);this.$$d_$KE_0=Function.createDelegate(this,this.$KE_0);this.$Cy_0=c;this.$S_0=b;this.$46_0=a;a.m_autocomplete=this};RTE.Autocomplete.prototype={$Cy_0:null,$S_0:null,$F_0:null,$3J_0:null,$3H_0:null,$19_0:null,$46_0:null,$1L_0:null,$1K_0:null,$Y_0:null,$1M_0:0,$10_0:false,$95_0:25,get_maxResults:function(){ULSNVe:;return this.$95_0},set_maxResults:function(a){ULSNVe:;this.$95_0=a;return a},$20_0:false,get_isStarted:function(){ULSNVe:;return this.$20_0},get_selectedResult:function(){ULSNVe:;return RTE.SU.$7(this.$Y_0)?null:this.$46_0.complete(this.$1M_0,this.$10_0,false)},get_visible:function(){ULSNVe:;return!this.$20_0?false:this.$F_0.style.visibility==="visible"},set_visible:function(e){ULSNVe:;if(!this.$20_0)return e;if(e){this.$F_0.style.width="250px";this.$F_0.style.left="-500px";this.$F_0.style.zIndex=100;this.$F_0.style.visibility="visible";var a,b,f,g,h=RTE.Cursor.get_range(),k=RTE.RteUtility.$8W(h.$4_0);a=k.x;b=k.y;f=h.$4_0.offsetWidth;g=h.$4_0.offsetHeight;var l,m;m=RTE.RteUtility.$6J(window.self);l=RTE.RteUtility.$6K(window.self);var c=RTE.RteUtility.$I3(this.$F_0),d=$get("s4-workspace");if(!d)d=document.body;var i=-d.scrollLeft,j=-d.scrollTop;if(a+f+c.width>l)i+=a-c.width-11;else i+=a+f+11;if(b+g+c.height>m)j+=b-c.height-11;else j+=b+g+11;this.$F_0.style.top=j.toString()+"px";this.$F_0.style.left=i.toString()+"px"}else this.$F_0.style.visibility="hidden";return e},$K7_0:function(a){ULSNVe:;var b=false;if(this.$20_0){if(!a.ctrlKey&&!a.altKey)switch(a.keyCode){case 27:this.stop();b=true;break;case 13:case 9:if(null!==this.$Y_0)this.$Ay_0(13===a.keyCode?"]]":null,true);else if(13===a.keyCode){RTE.Cursor.get_range().insertTextBefore("]]");RTE.Cursor.update()}b=true;break;case 38:if(null!==this.$Y_0){Sys.UI.DomElement.removeCssClass(this.$Y_0,"ms-rte-autocomplete-selected");this.$Y_0.removeAttribute("role");this.$1M_0--;if(this.$1M_0<0){this.$EW_0();this.$1M_0=(this.$10_0?this.$1K_0:this.$1L_0).length-1}this.$Y_0=(this.$10_0?this.$1K_0:this.$1L_0)[this.$1M_0];Sys.UI.DomElement.addCssClass(this.$Y_0,"ms-rte-autocomplete-selected");this.$Y_0.setAttribute("role","alert");b=true}break;case 40:if(null!==this.$Y_0){Sys.UI.DomElement.removeCssClass(this.$Y_0,"ms-rte-autocomplete-selected");this.$Y_0.removeAttribute("role");this.$1M_0++;if(this.$1M_0>=(this.$10_0?this.$1K_0:this.$1L_0).length){this.$EW_0();this.$1M_0=0}this.$Y_0=(this.$10_0?this.$1K_0:this.$1L_0)[this.$1M_0];Sys.UI.DomElement.addCssClass(this.$Y_0,"ms-rte-autocomplete-selected");this.$Y_0.setAttribute("role","alert");b=true}break;case 37:case 39:this.stop()}else if(a.ctrlKey&&32===a.keyCode){this.$46_0.invalidateCache();this.start();this.$9J_0()}}else if(a.ctrlKey&&32===a.keyCode){var c=this.$7p_0();if(null!==c){this.start();this.set_visible(true);this.$9J_0();b=true}}return b},$D9_0:0,$9J_0:function(){ULSNVe:;if(this.$20_0){window.clearTimeout(this.$D9_0);this.$D9_0=window.setTimeout(this.$$d_$KE_0,0)}},$KE_0:function(){ULSNVe:;if(this.$20_0){var a=this.$7p_0();if(a){this.set_visible(true);this.$KL_0(a.$96_0)&&RTE.Cursor.$A2()}else this.stop()}},$KA_0:function(a){ULSNVe:;a.preventDefault();a.stopPropagation()},$Jw_0:function(d){ULSNVe:;var e=d.target,c=false;if(null!==this.$1L_0)for(var f=this.$1L_0.length,a=0;a<f;a++)if(e===this.$1L_0[a]){this.$1M_0=a;this.$10_0=false;c=true;break}if(null!==this.$1K_0)for(var g=this.$1K_0.length,b=0;b<g;b++)if(e===this.$1K_0[b]){this.$1M_0=b;this.$10_0=true;c=true;break}if(c){this.$Ay_0(null,true);d.preventDefault();d.stopPropagation()}},start:function(){ULSNVe:;if(null===this.$F_0){this.$F_0=this.$S_0.createElement("div");this.$F_0.id=this.$Cy_0;this.$F_0.className="ms-rte-autocomplete";this.$F_0.setAttribute("unselectable","on");this.$F_0.title=SP.Res.autocompleteAccessibleMenuName;this.$F_0.setAttribute("aria-live","assertive");this.$F_0.setAttribute("aria-relevant","all");this.$F_0.setAttribute("role","menu");this.$F_0.style.visibility="hidden";$addHandler(this.$F_0,"mousedown",this.$$d_$KA_0);$addHandler(this.$F_0,"mouseup",this.$$d_$KA_0);$addHandler(this.$F_0,"click",this.$$d_$Jw_0);this.$S_0.body.appendChild(this.$F_0)}if(null===this.$3J_0){this.$3J_0=this.$S_0.createElement("div");this.$3J_0.className="ms-rte-autocomplete-results";this.$3J_0.setAttribute("unselectable","on")}if(null===this.$3H_0){this.$3H_0=this.$S_0.createElement("div");this.$3H_0.className="ms-rte-autocomplete-modes";this.$3H_0.setAttribute("unselectable","on")}if(null===this.$19_0){this.$19_0=this.$S_0.createElement("div");this.$19_0.className="ms-rte-autocomplete-info";this.$19_0.setAttribute("unselectable","on");this.$19_0.setAttribute("role","alert")}this.$F_0.setAttribute("aria-busy","true");RTE.RteUtility.removeChildNodes(this.$F_0);SP.UI.UIUtility.setInnerText(this.$19_0,SP.Res.autocompleteLoading);this.$F_0.appendChild(this.$19_0);this.$F_0.removeAttribute("aria-busy");RTE.Canvas.changeKeyTimeout(true);this.$20_0=true},$6e_0:null,$KL_0:function(a){ULSNVe:;if(this.$6e_0&&this.$6e_0===a&&this.get_visible())return false;this.$6e_0=a;this.$F_0.setAttribute("aria-busy","true");RTE.RteUtility.removeChildNodes(this.$F_0);SP.UI.UIUtility.setInnerText(this.$19_0,SP.Res.autocompleteLoading);this.$F_0.appendChild(this.$19_0);this.$F_0.removeAttribute("aria-busy");this.$46_0.process(a,this.$95_0);return true},$9u_0:function(k,l,f,i,j){ULSNVe:;window.IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(7710);this.$F_0.setAttribute("aria-busy","true");this.$Y_0=null;if(k){this.$1L_0=null;this.$1K_0=null;RTE.RteUtility.removeChildNodes(this.$F_0);SP.UI.UIUtility.setInnerText(this.$19_0,SP.Res.autocompleteTooManyResults);this.$F_0.appendChild(this.$19_0)}else if(0===f.length&&0===i.length){this.$1L_0=null;this.$1K_0=null;RTE.RteUtility.removeChildNodes(this.$F_0);SP.UI.UIUtility.setInnerText(this.$19_0,SP.Res.autocompleteNoResults);this.$F_0.appendChild(this.$19_0)}else{RTE.RteUtility.removeChildNodes(this.$F_0);var g=f.length;if(g>0){this.$1L_0=[];this.$3J_0.innerHTML="";for(var e=null,d=0;d<g;d++){e=f[d].toString();var a=this.$S_0.createElement("div");a.title=e;a.setAttribute("unselectable","on");if(null===this.$Y_0){this.$Y_0=a;this.$10_0=false;this.$1M_0=d}this.$1L_0[d]=a;SP.UI.UIUtility.setInnerText(a,e);this.$3J_0.appendChild(a)}this.$F_0.appendChild(this.$3J_0)}else this.$1L_0=null;var h=i.length;if(h>0){this.$1K_0=[];this.$3H_0.innerHTML="";for(var b=0;b<h;b++){var c=this.$S_0.createElement("div");c.title=j[b].toString();c.setAttribute("unselectable","on");if(null===this.$Y_0){this.$Y_0=c;this.$10_0=true;this.$1M_0=b}this.$1K_0[b]=c;c.innerHTML=j[b].toString();this.$3H_0.appendChild(c)}this.$F_0.appendChild(this.$3H_0)}else this.$1K_0=null;if(null!==this.$Y_0){Sys.UI.DomElement.addCssClass(this.$Y_0,"ms-rte-autocomplete-selected");this.$Y_0.setAttribute("role","alert")}}this.set_visible(true);this.$46_0.isAutocompleteFinished()&&this.stop();this.$F_0.removeAttribute("aria-busy");window.IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(7711)},$EC_0:function(a){ULSNVe:;this.$1L_0=null;this.$1K_0=null;this.$F_0.setAttribute("aria-busy","true");RTE.RteUtility.removeChildNodes(this.$F_0);SP.UI.UIUtility.setInnerText(this.$19_0,a);this.$F_0.appendChild(this.$19_0);this.$F_0.removeAttribute("aria-busy")},$Ay_0:function(c,d){ULSNVe:;var a=this.$46_0.complete(this.$1M_0,this.$10_0,d);if(!RTE.SU.$2(c))a+=c;var b=this.$7p_0();if(b){b.replaceWith(this.$S_0.createTextNode("[["+a));RTE.Cursor.update();RTE.Cursor.$9W()}},stop:function(){ULSNVe:;if(null!==this.$F_0)this.$F_0.style.visibility="hidden";RTE.Canvas.changeKeyTimeout(false);this.$20_0=false;this.$6e_0=null},$EW_0:function(){ULSNVe:;var a=null!==this.$1L_0,b=null!==this.$1K_0;if(!a&&!b)return;this.$10_0=!this.$10_0;if(this.$10_0&&!b)this.$10_0=false;else if(!this.$10_0&&!a)this.$10_0=true},$7p_0:function(){ULSNVe:;return RTE.AutocompleteParseData.parseCurrent("[[")},$7J_0:0,$K8_0:function(a){ULSNVe:;if(this.$20_0)if(93===a.charCode){this.$7J_0++;if(2===this.$7J_0){this.stop();this.$7J_0=0}}else this.$7J_0=0;else 91===a.charCode&&this.start();return false}};RTE.AutocompleteParseData=function(a,b){ULSNVe:;this.$9B_0=a;this.$96_0=b};RTE.AutocompleteParseData.parseCurrent=function(e){ULSNVe:;if(RTE.SU.$7(RTE.Canvas.currentEditableRegion()))return null;if(!e||e.length!==2)return null;var j=RTE.Cursor.get_range();if(!j.isValid())return null;var h=e.charAt(0),i=e.charAt(1),f=h===" ",b="",a=new RTE.DOMTreePosition(j.$3_0,0);while(true){if(SP.UI.UIUtility.isTextNode(a.$1_0)){var g=a.$1_0.data,c=a.$H_0,d=g.substring(0,c).lastIndexOf(e);if(d===-1&&f)d=g.substring(0,c).lastIndexOf(RTE.RteUtility.$3U+i);if(d>=0){if(f)d++;b=g.substring(d,c)+b;a.setOffset(d);return new RTE.AutocompleteParseData(a,b)}var k=g.substring(0,c);if(c>0&&(k.endsWith(h)||f&&k.endsWith(RTE.RteUtility.$3U))&&b.startsWith(i)){if(!f){b=h+b;a.setOffset(c-1)}else{a.moveToNextElement();a.setOffset(0)}return new RTE.AutocompleteParseData(a,b)}b=g.substring(0,c).replace(String.fromCharCode(8203),"")+b}else if(f&&b.startsWith(i)){a.moveToNextElement();a.setOffset(0);return new RTE.AutocompleteParseData(a,b)}if(!RTE.RteUtility.$4z(a.$1_0)||Sys.UI.DomElement.containsCssClass(a.$1_0.parentNode,"ms-rtestate-read")||!a.moveToPreviousElement())break}return null};RTE.AutocompleteParseData.prototype={$9B_0:null,$96_0:null,get_treePosition:function(){ULSNVe:;return this.$9B_0},get_parsedText:function(){ULSNVe:;return this.$96_0},replaceWith:function(g){ULSNVe:;var c=RTE.Cursor.get_range(),d=c.$3_0,b=c.$4_0,e=document.createElement("SPAN"),a=document.createElement("SPAN");d.parentNode.insertBefore(e,d);c.insertBefore(g);b.parentNode.insertBefore(a,b.nextSibling);var f=this.$9B_0;SP.UI.UIUtility.isTextNode(f.$1_0)&&f.moveCount(true,0);f.insertMarker(d);b.parentNode.removeChild(b);e.parentNode.replaceChild(b,e);c.deleteContent();a.parentNode.insertBefore(d,a);a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a)}};RTE.WikiLinkAutoComplete=function(a){ULSNVe:;this.$31_0=a};RTE.WikiLinkAutoComplete.prototype={$31_0:null,get_isStarted:function(){ULSNVe:;return!this.$5c_0()?false:this.$31_0.$20_0},onKeyDown:function(a){ULSNVe:;return!this.$5c_0()?false:this.$31_0.$K7_0(a)},onKeyUp:function(){ULSNVe:;return false},onKeyPress:function(a){ULSNVe:;return!this.$5c_0()?false:this.$31_0.$K8_0(a)},stop:function(){ULSNVe:;if(!this.$5c_0())return;this.$31_0.stop()},onTextChanged:function(){ULSNVe:;if(!this.$5c_0())return;this.$31_0.$9J_0()},isSuggestionNode:function(){ULSNVe:;return false},$5c_0:function(){ULSNVe:;return!!this.$31_0&&RTE.Canvas.currentRegionWikilinkEnabled()}};RTE.AutocompleteResultSource=function(){};RTE.AutocompleteResultSource.prototype={m_autocomplete:null,get_autocomplete:function(){ULSNVe:;return this.m_autocomplete},set_autocomplete:function(a){ULSNVe:;this.m_autocomplete=a;return a},complete:function(){ULSNVe:;return""},isAutocompleteFinished:function(){ULSNVe:;return false},invalidateCache:function(){}};RTE.AutocompleteWikiLinkSource=function(){ULSNVe:;this.$$d_$Lm_1=Function.createDelegate(this,this.$Lm_1);this.$$d_$Jc_1=Function.createDelegate(this,this.$Jc_1);this.$$d_$Jb_1=Function.createDelegate(this,this.$Jb_1);this.$$d_$Ev_1=Function.createDelegate(this,this.$Ev_1);this.$$d_$Eu_1=Function.createDelegate(this,this.$Eu_1);this.$$d_$Jd_1=Function.createDelegate(this,this.$Jd_1);this.$$d_$LY_1=Function.createDelegate(this,this.$LY_1);this.$1C_1="";this.$3I_1=-1;RTE.AutocompleteWikiLinkSource.initializeBase(this);this.$58_1=[];this.$6j_1=[];this.$58_1[0]="List:";this.$6j_1[0]=SP.Res.autocompleteList;this.$58_1[1]="View:";this.$6j_1[1]=SP.Res.autocompleteView;this.$B4_1()};RTE.AutocompleteWikiLinkSource.prototype={$v_1:0,$D4_1:null,$3G_1:null,$n_1:null,$2J_1:null,$d_1:null,$2K_1:0,$99_1:null,$93_1:null,$6o_1:null,$42_1:null,$94_1:null,$6m_1:null,$f_1:0,$c_1:null,$o_1:null,$1A_1:null,$1k_1:null,$1z_1:null,$5K_1:null,$97_1:null,$2G_1:null,$Z_1:null,$5I_1:null,$6q_1:null,$5D_1:null,$5A_1:null,$5J_1:null,$58_1:null,$6j_1:null,$B4_1:function(){ULSNVe:;this.$93_1={};this.$6o_1={};this.$42_1=null;this.$94_1={};this.$6m_1={}},invalidateCache:function(){ULSNVe:;RTE.AutocompleteResultSource.prototype.invalidateCache.call(this);this.$B4_1()},process:function(d,t){ULSNVe:;var b=this.$6o_1[d];if(!RTE.SU.$7(b)){this.$1C_1=b.$1C_0;this.$v_1=b.$v_0;this.$f_1=b.$f_0;this.$c_1=b.$c_0;this.$o_1=b.$o_0;this.$1A_1=b.$1A_0;this.$1k_1=b.$1k_0;this.m_autocomplete.$9u_0(b.$DA_0,this.$f_1,this.$c_1,this.$o_1,this.$1A_1);return}this.$D4_1=d;this.$c_1=[];this.$o_1=[];this.$1k_1=[];this.$3G_1=null;this.$n_1=null;this.$2J_1=null;this.$d_1=null;this.$f_1=0;this.$2G_1=null;this.$Z_1=null;this.$2K_1=t;if(!d.startsWith("[[")){this.$v_1=0;this.m_autocomplete.$9u_0(false,0,this.$c_1,this.$o_1,this.$1A_1)}else{var a=d.substr(2),c=a.indexOf(":"),r=a.indexOf("|");this.$1C_1="[[";if(r>=0){this.$v_1=5;this.$1C_1=d}else if(d.indexOf("]]")>=0){this.$v_1=6;this.$1C_1=d}else if(c>=0){this.$3G_1=a.substring(0,c);this.$1C_1+=this.$3G_1+":";if(this.$3G_1.toLowerCase()==="list"||this.$3G_1.toLowerCase()==="view"){var e=-1,g=this.$6o_1[this.$1C_1];if(g)for(var s=g.$f_0,h=0;h<s;h++){var i=g.$c_0[h],n=a.indexOf(i);if(n!==-1&&i.endsWith("/"))e=n+i.length-1}if(e===-1)e=a.indexOf("/",c);if(e>c){this.$n_1=a.substring(c+1,e);this.$d_1=a.substr(e+1);this.$1C_1+=this.$n_1+"/";if(this.$3G_1.toLowerCase()==="view")this.$v_1=4;else{this.$v_1=3;var j=this.$d_1.lastIndexOf("/");if(j>=0){this.$2J_1=this.$d_1.substring(0,j);this.$d_1=this.$d_1.substr(j+1);this.$1C_1+=this.$2J_1+"/"}}}else{this.$v_1=2;this.$d_1=a.substr(c+1)}}else{this.$v_1=3;this.$n_1=this.$3G_1;this.$d_1=a.substr(c+1);var k=this.$d_1.lastIndexOf("/");if(k>=0){this.$2J_1=this.$d_1.substring(0,k);this.$d_1=this.$d_1.substr(k+1);this.$1C_1+=this.$2J_1+"/"}}}else{var l=a.lastIndexOf("/");if(l>=0){this.$v_1=3;this.$2J_1=a.substring(0,l);this.$d_1=a.substr(l+1);this.$1C_1+=this.$2J_1+"/"}else{this.$v_1=1;this.$d_1=a;for(var o=[],p=[],m=0,f=0;f<this.$58_1.length;f++){var q=this.$58_1[f].toString();if(q.toLowerCase().startsWith(this.$d_1.toLowerCase())){o[m]=q;p[m]=this.$6j_1[f];m++}}this.$o_1=o;this.$1A_1=p}}this.$Cx_1(true)}},$Cx_1:function(d){ULSNVe:;if(RTE.SU.$7(this.$1z_1)){this.$1z_1=new SP.ClientContext;this.$5K_1=this.$1z_1.get_web()}switch(this.$v_1){case 2:this.$BW_1();break;case 1:case 3:if(null===this.$n_1&&null!==this.$99_1)this.$n_1=this.$99_1;var a=this.$93_1[this.$n_1];if(!RTE.SU.$7(a)&&this.$3I_1>=0){this.$Z_1=a.$D5_0;this.$Ae_1(a.$D8_0,a.$D1_0);return}if(null===this.$n_1){var c=RTE.Canvas.getRTEFieldRegion(),b=RTE.RteUtility.getAttribute(c,"ListId");if(!RTE.SU.$2(b))this.$Z_1=this.$5K_1.get_lists().getById(new SP.Guid(b));else{this.$1o_1(false,0,this.$c_1,this.$o_1,this.$1A_1,null);return}}else this.$Z_1=this.$5K_1.get_lists().getByTitle(this.$n_1);this.$97_1=this.$1z_1.get_site();this.$97_1.retrieve(SP.SitePropertyNames.maxItemsPerThrottledOperation);this.$Z_1.retrieve(SP.ListPropertyNames.title,SP.ListPropertyNames.baseType,SP.ListPropertyNames.baseTemplate,SP.ListPropertyNames.itemCount);this.$5I_1=this.$Z_1.get_rootFolder();this.$5I_1.retrieve(SP.FolderPropertyNames.serverRelativeUrl);if(d){this.$6q_1=this.$Z_1.get_fields().getByInternalNameOrTitle("Title");this.$1z_1.load(this.$6q_1)}this.$1z_1.executeQueryAsync(this.$$d_$LY_1,this.$$d_$Jd_1);break;case 4:this.$BX_1();break;case 0:case 5:case 6:default:this.$1o_1(false,0,this.$c_1,this.$o_1,this.$1A_1,null)}},$BW_1:function(){ULSNVe:;if(this.$42_1){for(var c=[],e=this.$42_1.length,a=0,b=0;b<e;b++){var d=this.$42_1[b].toString();if(d.toLowerCase().startsWith(this.$d_1.toLowerCase())){c[a]=d+"/";a++}}this.$f_1=a;if(this.$f_1<=this.$2K_1)this.$c_1=c;this.$1o_1(this.$f_1>this.$2K_1,this.$f_1,this.$c_1,this.$o_1,this.$1A_1,null)}else{this.$2G_1=this.$5K_1.get_lists();var f=this.$2G_1.retrieveItems();f.retrieve(SP.ListPropertyNames.title,SP.ListPropertyNames.dataSource,SP.ListPropertyNames.hidden);this.$1z_1.get_pendingRequest().get_webRequest().get_headers()[SP.ClientConstants.useWebLanguageHeader]=SP.ClientConstants.useWebLanguageHeaderValue;this.$1z_1.executeQueryAsync(this.$$d_$Eu_1,this.$$d_$Ev_1)}},$Eu_1:function(){ULSNVe:;if(null!==this.$2G_1){this.$42_1=[];for(var b=this.$2G_1.get_count(),a=0;a<b;a++)RTE.SU.$7(this.$2G_1.itemAt(a).get_dataSource())&&!RTE.SU.$2(this.$2G_1.itemAt(a).get_title())&&!this.$2G_1.itemAt(a).get_hidden()&&Array.add(this.$42_1,this.$2G_1.itemAt(a).get_title());this.$BW_1()}},$Ev_1:function(){ULSNVe:;this.$1o_1(true,this.$2K_1+1,null,null,null,null)},$LY_1:function(){ULSNVe:;if(null!==this.$Z_1){var b=!!this.$6q_1,a;if(null!==this.$5I_1&&!RTE.SU.$2(this.$5I_1.get_serverRelativeUrl()))a=this.$5I_1.get_serverRelativeUrl();else a="";if(1===this.$v_1){this.$n_1=this.$Z_1.get_title();this.$99_1=this.$n_1}this.$93_1[this.$n_1]=new RTE.AutocompleteListCacheObject(this.$Z_1,a,b);if(this.$3I_1<0)this.$3I_1=Math.min(2e3,this.$97_1.get_maxItemsPerThrottledOperation());this.$Ae_1(a,b)}else this.$1o_1(false,0,this.$c_1,this.$o_1,this.$1A_1,null)},$Ae_1:function(l,i){ULSNVe:;if(null!==this.$Z_1){var e=l;if(!RTE.SU.$2(this.$2J_1))e+="/"+this.$2J_1;this.$5D_1=e+"/";if(!RTE.SU.$2(this.$d_1))this.$5D_1+=this.$d_1;var j=this.$6m_1[this.$n_1],c=null;if(!RTE.SU.$7(j)){var a=this.$5D_1;while(a.length>0){c=j[a];if(!RTE.SU.$7(c)||a.endsWith("/"))break;a=a.substring(0,a.length-1)}}if(!RTE.SU.$7(c))this.$BV_1(c);else{var f=new SP.CamlQuery;f.set_folderServerRelativeUrl(e);var b,d;if(1===this.$Z_1.get_baseType()){b="FileRef";d=this.$5D_1.substr(1)}else if(i){if(this.$Z_1.get_itemCount()>this.$3I_1){this.m_autocomplete.$EC_0(SP.Res.autocompleteListTooLarge);return}b="Title";d=this.$d_1}else{this.$1o_1(false,0,this.$c_1,this.$o_1,this.$1A_1,null);return}if(!RTE.SU.$2(b)&&!RTE.SU.$2(d)){var g;if("FileRef"===b)g='<FieldRef Name="FileDirRef"/><FieldRef Name="FileLeafRef"/>';else g='<FieldRef Name="'+b+'"/>';var h;if(i)h='<ViewFields><FieldRef Name="ID" /><FieldRef Name="FileLeafRef" /><FieldRef Name="FSObjType" /><FieldRef Name="Title" /></ViewFields>';else h='<ViewFields><FieldRef Name="ID" /><FieldRef Name="FileLeafRef" /><FieldRef Name="FSObjType" /></ViewFields>';f.set_viewXml("\r\n<View>"+h+'\r\n    <Query>\r\n        <Where>\r\n            <BeginsWith>\r\n                <FieldRef Name="'+b+'" />\r\n                <Value Type="Text">'+RTE.RteUtility.htmlEncode(d)+'</Value>\r\n            </BeginsWith>\r\n        </Where>\r\n        <OrderBy Override="TRUE">'+g+"</OrderBy>\r\n    </Query>\r\n    <RowLimit>"+this.$3I_1.toString()+"</RowLimit>\r\n</View>\r\n")}this.$5A_1=this.$Z_1.getItems(f);var k=this.$5A_1.retrieveItems();if(i)k.retrieve(SP.ListItemPropertyNames.id,SP.ListItemPropertyNames.fileSystemObjectType,"FileLeafRef","Title");else k.retrieve(SP.ListItemPropertyNames.id,SP.ListItemPropertyNames.fileSystemObjectType,"FileLeafRef");this.$1z_1.executeQueryAsync(this.$$d_$Jb_1,this.$$d_$Jc_1)}}else this.$1o_1(false,0,this.$c_1,this.$o_1,this.$1A_1,null)},$BV_1:function(s){ULSNVe:;if(null!==this.$Z_1){var e,f,g,h=false,o=false,p=false,i=false;if(1===this.$Z_1.get_baseType()){e=false;f=false;g=false;if(119===this.$Z_1.get_baseTemplate())o=true;else p=true}else{e=true;f=true;g=true;if(108===this.$Z_1.get_baseTemplate()){h=false;i=true}else h=true}for(var t=s.length,j=0,q=[],k=0;k<t;k++){var l=s[k],d;if(e)d=l.$9A_0;else d=l.$6l_0;if(!RTE.SU.$2(d)&&d.toLowerCase().startsWith(this.$d_1.toLowerCase())){q[j]=l;j++}}this.$f_1=j;if(this.$f_1>0&&this.$f_1<=this.$2K_1)for(var b=0;b<this.$f_1;b++){var c=q[b],a;if(f)a=c.$9A_0;else a=c.$6l_0;if(c.$92_0&&!i)a=a+"/";else if(o){var r=a.lastIndexOf(".");if(r>0)a=a.substring(0,r)}else if(p){var m=a.lastIndexOf(".");if(m>0)if(a.substring(m,a.length).toLowerCase()===".aspx")a=a.substring(0,m)}this.$c_1[b]=a;if(c.$92_0&&!i)this.$1k_1[b]=a;else if(g){var n;if(h)n=c.$D2_0.toString();else n=c.$6l_0;this.$1k_1[b]=n}else this.$1k_1[b]=a}this.$1o_1(this.$f_1>this.$2K_1,this.$f_1,this.$c_1,this.$o_1,this.$1A_1,this.$1k_1)}else this.$1o_1(false,0,this.$c_1,this.$o_1,this.$1A_1,null)},$Jb_1:function(){ULSNVe:;if(null!==this.$Z_1&&null!==this.$5A_1){var a=[],e=0;try{e=this.$5A_1.get_count()}catch(l){}for(var b=0;b<e;b++){var c=this.$5A_1.itemAt(b),h=c.get_id(),f=c.get_fieldValues().FileLeafRef,i=RTE.SU.$7(f)?"":f.toString(),j=1===c.get_fileSystemObjectType(),g=c.get_fieldValues().Title,k=RTE.SU.$7(g)?null:g.toString();a[b]=new RTE.AutocompleteListItemCacheObject(h,k,i,j)}if(a.length<=.5*this.$3I_1){var d=this.$6m_1[this.$n_1];if(RTE.SU.$7(d))this.$6m_1[this.$n_1]=d={};d[this.$5D_1]=a}this.$BV_1(a)}},$Jc_1:function(){ULSNVe:;this.$1o_1(true,this.$2K_1+1,null,null,null,null)},$BX_1:function(){ULSNVe:;var a=this.$94_1[this.$n_1];if(!RTE.SU.$7(a)){for(var d=[],f=a.length,b=0,c=0;c<f;c++){var e=a[c].toString();if(e.toLowerCase().startsWith(this.$d_1.toLowerCase())){d[b]=e;b++}}this.$f_1=b;if(this.$f_1<=this.$2K_1)this.$c_1=d;this.$1o_1(this.$f_1>this.$2K_1,this.$f_1,this.$c_1,this.$o_1,this.$1A_1,null)}else{this.$Z_1=this.$5K_1.get_lists().getByTitle(this.$n_1);this.$5J_1=this.$Z_1.get_views();var g=this.$5J_1.retrieveItems();g.retrieve(SP.ViewPropertyNames.title,SP.ViewPropertyNames.hidden);this.$1z_1.executeQueryAsync(this.$$d_$Lm_1,this.$$d_$Jd_1)}},$Lm_1:function(){ULSNVe:;if(null!==this.$Z_1&&null!==this.$5J_1){for(var b=[],e=this.$5J_1.get_count(),c=0,a=0;a<e;a++){var d=this.$5J_1.itemAt(a);if(d.get_hidden())continue;b[c]=d.get_title();c++}this.$94_1[this.$n_1]=b;this.$BX_1()}},$Jd_1:function(d,c){ULSNVe:;var a=c.get_errorCode()===-2147024809;if(a){this.$6q_1=null;this.$Cx_1(false);return}var b=SP.Res.autocompleteListNotFound;this.m_autocomplete.$EC_0(b)},$1o_1:function(c,d,a,e,f,b){ULSNVe:;if(RTE.SU.$7(b)){b=a;this.$1k_1=this.$c_1}this.$6o_1[this.$D4_1]=new RTE.AutocompleteCacheObject(this.$1C_1,this.$v_1,c,d,a,e,f,b);this.m_autocomplete.$9u_0(c,d,a,e,f)},isAutocompleteFinished:function(){ULSNVe:;return 5===this.$v_1||6===this.$v_1},complete:function(b,g,h){ULSNVe:;var a=this.$1C_1;if(g){if(RTE.SU.$7(this.$o_1))return"";a+=this.$o_1[b]}else{if(RTE.SU.$7(this.$1k_1))return"";var c=this.$1k_1[b],d=RTE.SU.$7(c)?"":c.toString();a+=d;if(h){var e=this.$c_1[b],f=RTE.SU.$7(e)?"":e.toString();if(f!==d)a+="|"+f}}return a.substr(2)}};RTE.AutocompleteListCacheObject=function(a,b,c){ULSNVe:;this.$D5_0=a;this.$D8_0=b;this.$D1_0=c};RTE.AutocompleteListCacheObject.prototype={$D5_0:null,$D8_0:null,$D1_0:false};RTE.AutocompleteListItemCacheObject=function(a,b,c,d){ULSNVe:;this.$D2_0=a;this.$9A_0=b;this.$6l_0=c;this.$92_0=d};RTE.AutocompleteListItemCacheObject.prototype={$D2_0:0,$9A_0:null,$6l_0:null,$92_0:false};RTE.AutocompleteCacheObject=function(a,b,c,d,e,f,g,h){ULSNVe:;this.$1C_0=a;this.$v_0=b;this.$DA_0=c;this.$f_0=d;this.$c_0=e;this.$o_0=f;this.$1A_0=g;this.$1k_0=h};RTE.AutocompleteCacheObject.prototype={$1C_0:null,$v_0:0,$DA_0:false,$f_0:0,$c_0:null,$o_0:null,$1A_0:null,$1k_0:null};RTE.RTFieldFlags=function(){};RTE.Canvas=function(){};RTE.Canvas.$LJ=function(){ULSNVe:;return!RTE.Canvas.$6W||RTE.Canvas.initialFocusOnRichText()};RTE.Canvas.initialFocusOnRichText=function(){ULSNVe:;try{if(!RTE.SU.$7(_ribbon)){var a=_ribbon.initialTabId;if(!RTE.SU.$2(a))return a==="Ribbon.EditingTools.CPEditTab"}}catch(b){}return true};RTE.Canvas.setIgnoreClear=function(a){ULSNVe:;RTE.Canvas.$8g=a};RTE.Canvas.getIgnoreClear=function(){ULSNVe:;return RTE.Canvas.$8g};RTE.Canvas.setIgnoreUpDownArrows=function(a){ULSNVe:;RTE.Canvas.$8j=a};RTE.Canvas.getIgnoreUpDownArrows=function(){ULSNVe:;return RTE.Canvas.$8j};RTE.Canvas.$35=function(d){ULSNVe:;var b=d,a=d;while(a){var c=a.className;if(!RTE.SU.$2(c)&&c.indexOf("ms-rtestate-field")!==-1){b=a;break}a=a.parentNode}return b};RTE.Canvas.getEditableRegion=function(a){ULSNVe:;return RTE.Canvas.$By(RTE.Canvas.$i,a)};RTE.Canvas.getRegion=function(a){ULSNVe:;return RTE.Canvas.$By(RTE.Canvas.$8m,a)};RTE.Canvas.$By=function(b,a){ULSNVe:;a=RTE.Canvas.$1v(a);while(a){if(b(a))return a;a=RTE.Canvas.$1v(a.parentNode)}return null};RTE.Canvas.getNonEditableRegion=function(a){ULSNVe:;var b=null;a=RTE.Canvas.$1v(a);while(a){if(RTE.Canvas.$1Q(a))b=a;else if(b)return b;a=RTE.Canvas.$1v(a.parentNode)}return b};RTE.Canvas.getDirectAtomicParent=function(a){ULSNVe:;var b=null;a=RTE.Canvas.$1v(a);while(a){if(RTE.Canvas.$i(a))break;else if(RTE.Canvas.$1Q(a))b=a;else if(b)return b;a=RTE.Canvas.$1v(a.parentNode)}return b};RTE.Canvas.isEditable=function(b){ULSNVe:;var a=RTE.Canvas.$1v(b);if(a&&RTE.Canvas.$8q===a)return true;while(a){if(RTE.Canvas.$i(a)){RTE.Canvas.$8q=a;return true}else if(RTE.Canvas.$1Q(a))return false;a=RTE.Canvas.$1v(a.parentNode)}return false};RTE.Canvas.isInEditable=function(b){ULSNVe:;var a=RTE.Canvas.$1v(b);while(a){if(RTE.Canvas.$i(a))return true;a=RTE.Canvas.$1v(a.parentNode)}return false};RTE.Canvas.$1v=function(a){ULSNVe:;while(a){if(RTE.Canvas.$Jm(a))return a;a=a.parentNode}return null};RTE.Canvas.isInRedirect=function(a){ULSNVe:;a=RTE.Canvas.$Bt(a);return!!a};RTE.Canvas.getRedirectEditableRegion=function(a){ULSNVe:;a=RTE.Canvas.$Bt(a);if(!a)return null;var b=RTE.RteUtility.getAttribute(a,"RteRedirect");if(b){var c=b;return $get(c)}return null};RTE.Canvas.$Bt=function(a){ULSNVe:;while(a&&a.nodeType!==11&&a.nodeType!==9){var b=RTE.RteUtility.getAttribute(a,"RteRedirect");if(b)return a;a=a.parentNode}return null};RTE.Canvas.$i=function(b){ULSNVe:;var a=b.className;return!RTE.SU.$2(a)&&a.indexOf("ms-rtestate-write")>=0};RTE.Canvas.$8m=function(b){ULSNVe:;var a=b.className;return!RTE.SU.$2(a)&&a.indexOf("ms-rtestate-field")>=0};RTE.Canvas.$1Q=function(b){ULSNVe:;var a=b.className;return!RTE.SU.$2(a)&&a.indexOf("ms-rtestate-read")>=0};RTE.Canvas.$Jm=function(b){ULSNVe:;var a=b.className;return!RTE.SU.$2(a)&&a.indexOf("ms-rtestate-")>=0};RTE.Canvas.load=function(){ULSNVe:;if(RTE.Canvas.$6g)return;else RTE.Canvas.$6g=true;RTE.Canvas.$6W=true;if(document.body){RTE.RteUtility.$s("mouseup",RTE.Canvas.onMouseUp);RTE.RteUtility.$s("mousedown",RTE.Canvas.onMouseDown);RTE.RteUtility.$s("keypress",RTE.Cursor.onKeyPress);RTE.RteUtility.$s("keydown",RTE.Cursor.onKeyDown);RTE.RteUtility.$s("keyup",RTE.Cursor.onKeyUp);RTE.RteUtility.$s("paste",RTE.Cursor.$KC);RTE.RteUtility.$s("cut",RTE.Cursor.$Jy);RTE.RteUtility.$s("copy",RTE.Cursor.$Jx);RTE.RteUtility.$s("beforepaste",RTE.Cursor.$Js);RTE.RteUtility.$s("drop",RTE.Cursor.$DW);RTE.RteUtility.$s("deactivate",RTE.Canvas.onDeactivate);if(navigator&&navigator.msPointerEnabled){document.addEventListener("MSPointerDown",RTE.Canvas.onMSPointerDown,false);document.addEventListener("MSPointerUp",RTE.Canvas.onMSPointerUp,false);document.addEventListener("selectionchange",RTE.Canvas.onSelectionChange,false)}else{RTE.RteUtility.$s("touchstart",RTE.Canvas.onTouchStart);RTE.RteUtility.$s("touchend",RTE.Canvas.onTouchEnd)}$addHandler(document.body,"dragstart",RTE.Cursor.$DV);$addHandler(document.body,"draggesture",RTE.Cursor.$DV);$addHandler(document.body,"dragend",RTE.Cursor.$K0);RTE.RteUtility.$s("dragover",RTE.Cursor.$K1);document.body.setAttribute("spellcheck",false);$addHandler(window.self.self,"beforeunload",RTE.Canvas.onBeforeUnload);if(RTE.RteUtility.isInternetExplorer())$addHandler(document.body,"deactivate",RTE.Canvas.onElementFocusChanged);else if(document.addEventListener){document.addEventListener("blur",RTE.Canvas.onElementFocusChanged,true);document.addEventListener("drop",RTE.Cursor.$DW,true)}RTE.RteUtility.isFirefox()&&RTE.RteUtility.$s("DOMNodeInserted",RTE.Canvas.$Jz)}try{window.document.execCommand("EnableInlineTableEditing",false,false)}catch(d){}window.setTimeout(RTE.RteUtility.$84,18e5);RTE.CanvasEvents.registerListener("EditableRegionBlur",RTE.CanvasEvents.onEditableRegionBlur);RTE.CanvasEvents.registerListener("EditableRegionFocus",RTE.CanvasEvents.onEditableRegionFocus);RTE.CanvasEvents.registerListener("ImageFocus",RTE.CanvasEvents.onImageSelected);RTE.CanvasEvents.registerListener("ImageBlur",RTE.CanvasEvents.onImageDeselected);RTE.CanvasEvents.registerListener("AtomicFocus",RTE.CanvasEvents.onAtomicSelected);RTE.CanvasEvents.registerListener("AtomicBlur",RTE.CanvasEvents.onAtomicDeselected);RTE.CanvasEvents.registerListener("LinkBlur",RTE.CanvasEvents.onLinkDeselected);RTE.CanvasEvents.registerListener("TableBlur",RTE.CanvasEvents.onTableDeselected);RTE.CanvasEvents.registerListener("ElementAdded",RTE.EmbeddingCommands.$He);var a=window._spRteFieldEditableRegionIds;if(!RTE.SU.$7(a))for(var b=0;b<a.length;b++){var c=a[b];RTE.Canvas.fixRegion(c,true)}RTE.DirtyBitManager.start();RTE.Canvas.setInitialFocus();RTE.Canvas.$6W=false};RTE.Canvas.loadPageComponent=function(){ULSNVe:;RTE.Imports.ExecuteOrDelayUntilScriptLoaded(RTE.RichTextEditorComponent.$Eb,"sp.ribbon.js")};RTE.Canvas.restoreViewHtml=function(b){ULSNVe:;var c=b.id;if(!RTE.SU.$2(c)){for(var d=0;d<RTE.Canvas.$5S.length;d++)if(c===RTE.Canvas.$5S[d])return;RTE.Canvas.$5S[RTE.Canvas.$5S.length]=c}var e=RTE.RteUtility.getAttribute(b,"InputFieldId");if(e){var f=$get(e);if(f){var a=new RTE.Snapshot;a.$P_0=b;a.$8P_0=true;a.set_$8e_0(f.value);a.$E6_0(false)}}};RTE.Canvas.storeViewHtml=function(a){ULSNVe:;var b=RTE.RteUtility.getAttribute(a,"InputFieldId");if(b){var c=$get(b);if(c)c.value=a.innerHTML}};RTE.Canvas.$8a=function(b){ULSNVe:;var c=b;if(!Sys.UI.DomElement.containsCssClass(b,"ms-inputBox")){var a=b.parentNode;while(a&&(a.tagName==="DIV"||a.tagName==="SPAN")){if(Sys.UI.DomElement.containsCssClass(a,"ms-rtestate-field")){c=a;break}a=a.parentNode}}return c};RTE.Canvas.$F5=function(c){ULSNVe:;var b=RTE.Canvas.$8a(c),a=b;do{if(Sys.UI.DomElement.containsCssClass(a,"ms-inputBox"))break;if(Sys.UI.DomElement.containsCssClass(a,"ms-formbody")){Sys.UI.DomElement.addCssClass(b,"ms-inputBox");b.style.display="";break}a=a.parentNode}while(a&&a!==document.body)};RTE.Canvas.$L4=function(b){ULSNVe:;var a=RTE.Canvas.$8a(b);if(!Sys.UI.DomElement.containsCssClass(a,"ms-inputBox"))return;Sys.UI.DomElement.addCssClass(a,"ms-inputBoxActive")};RTE.Canvas.$LD=function(b){ULSNVe:;var a=RTE.Canvas.$8a(b);if(!Sys.UI.DomElement.containsCssClass(a,"ms-inputBox"))return;Sys.UI.DomElement.removeCssClass(a,"ms-inputBoxActive")};RTE.Canvas.$L3=function(){ULSNVe:;if(RTE.RteUtility.isFirefox()){if(RTE.Canvas.$26>0){window.clearTimeout(RTE.Canvas.$26);RTE.Canvas.$26=0}RTE.Canvas.$E9()}else RTE.Canvas.$O()};RTE.Canvas.$O=function(){ULSNVe:;if(RTE.Canvas.$26<=0)RTE.Canvas.$26=window.setTimeout(RTE.Canvas.$E9,0)};RTE.Canvas.$E9=function(){ULSNVe:;RTE.Canvas.$26=0;RTE.Imports.ExecuteOrDelayUntilScriptLoaded(RTE.Canvas.$Lg,"sp.ribbon.js")};RTE.Canvas.$Lg=function(){ULSNVe:;var a=RTE.RichTextEditorComponent.$4s();a&&a.get_commandDispatcher().executeCommand(Commands.CommandIds.ApplicationStateChanged,null)};RTE.Canvas.fixRegion=function(c,e){ULSNVe:;!RTE.Canvas.$6g&&RTE.Canvas.load();if(arguments.length===1)e=true;if(!RTE.Canvas.$1N){RTE.Canvas.$1N=[];RTE.Canvas.$2n={}}var d;if(RTE.SU.$7(RTE.Canvas.$2n[c]))d=RTE.Canvas.$1N.length;else d=RTE.Canvas.$2n[c];var a=$get(c);if(a){RTE.Canvas.$F5(a);if(e)RTE.Canvas.restoreViewHtml(a);else RTE.Canvas.$4n(a);for(var b=a.parentNode,f=0;f<3&&b;f++){if(b.tagName==="TD"&&Sys.UI.DomElement.containsCssClass(b,"ms-formbody")){b.RteRedirect=c;break}b=b.parentNode}var g=RTE.Canvas.$IE(a);if(0!==(g&RTE.RTFieldFlags.$Dt))RTE.Canvas.$1h=a;(RTE.SU.$2(a.className)||!Sys.UI.DomElement.containsCssClass(a,"ms-rtestate-field"))&&Sys.UI.DomElement.addCssClass(a,"ms-rtestate-field");if(RTE.Canvas.$8o(a))RTE.LayoutsEditor.create(a);else{RTE.Canvas.makeRegionEditable(a);RTE.Canvas.$9G(a)}RTE.Canvas.$1N[d]=a;RTE.Canvas.$2n[c]=d}};RTE.Canvas.$4n=function(a){ULSNVe:;RTE.RteUtility.forEachChildWithTagAndClass(a,null,"ms-rtestate-notify",function(b){ULSNVe:;var a={};a.node=b;RTE.CanvasEvents.dispatchEvent("ElementAdded","restore",a)})};RTE.Canvas.$Kl=function(d){ULSNVe:;if(!RTE.Canvas.$1N)return;var a=RTE.Canvas.$2n[d];if(RTE.SU.$7(a))return;var b=RTE.Canvas.$1N.length,c=RTE.Canvas.$1N[b-1];RTE.Canvas.$1N[a]=c;RTE.Canvas.$2n[c.id]=a;Array.removeAt(RTE.Canvas.$1N,b-1);delete RTE.Canvas.$2n[d]};RTE.Canvas.revertWikiRegion=function(b){ULSNVe:;RTE.Canvas.$4H&&RTE.Canvas.$4H.stop();RTE.Canvas.$Kl(b);var a=RTE.Cursor.get_range();a&&a.clear();try{document.body.focus()}catch(c){}RTE.Canvas.$1D=false;RTE.Cursor.update()};RTE.Canvas.$9G=function(a){ULSNVe:;if(!RTE.RteUtility.$4c(a)){var b=document.createElement("P");b.appendChild(RTE.RteUtility.createTextNode(a.ownerDocument,RTE.RteUtility.$2O));a.appendChild(b)}};RTE.Canvas.$6B=function(a){ULSNVe:;window.document.execCommand(a,false,null)};RTE.Canvas.$8M=function(a){ULSNVe:;RTE.Cursor.s_range.$62_0();RTE.Canvas.$6B(a);RTE.Cursor.updateRangeToCurrentSelection();RTE.Cursor.update()};RTE.Canvas.$BS=function(b){ULSNVe:;var a=new RTE.CommandState;if(RTE.Canvas.$6C(b)){a.$C_0=true;try{if(window.document.queryCommandState(b))a.$1I_0=true}catch(c){}}return a};RTE.Canvas.$6C=function(b){ULSNVe:;try{RTE.Cursor.ignoreBeforePasteOrDrop=true;var a=window.document.queryCommandEnabled(b);RTE.Cursor.ignoreBeforePasteOrDrop=false;return a}catch(c){RTE.Cursor.ignoreBeforePasteOrDrop=false;return false}};RTE.Canvas.$6H=function(a){ULSNVe:;while(a&&RTE.Canvas.$1Q(a.parentNode))a=a.parentNode;return a};RTE.Canvas.$5Z=function(b){ULSNVe:;var d=RTE.Canvas.$2P?Sys.UI.DomElement.containsCssClass(RTE.Canvas.$2P,"ms-rte-wpbox"):false,c=b?Sys.UI.DomElement.containsCssClass(b,"ms-rte-wpbox"):false;RTE.Canvas.set_$R(b);if(!!(d^c))if(c){var a=null;RTE.RteUtility.forEachChildWithTagAndClass(b,"TD","s4-wpcell",function(b){ULSNVe:;if(!a&&!RTE.SU.$2(b.id)&&b.id.startsWith("MSOZoneCell"))a=b});if(a)window.SelectWp&&window.SelectWp(a)}else window.DeselectWpWz&&window.DeselectWpWz()};RTE.Canvas.get_$R=function(){ULSNVe:;return RTE.Canvas.$2P};RTE.Canvas.set_$R=function(a){ULSNVe:;RTE.Canvas.$2P=RTE.Canvas.$6H(a);return a};RTE.Canvas.onMouseDown=function(c){ULSNVe:;var a=c.target;RTE.Canvas.$EV();RTE.Canvas.$3j=true;if(!RTE.RteUtility.$2b(a))return;RTE.Canvas.$3N=null;RTE.Canvas.set_$R(null);RTE.Canvas.$2u=null;if(RTE.Canvas.isInEditable(a)){var e=RTE.RteUtility.$I0(a);e&&c.ctrlKey&&!c.shiftKey&&window.open(e.href);if(RTE.RteUtility.isSafari()&&a&&a.tagName==="IMG"){RTE.Cursor.get_range().moveToNode(a);RTE.Cursor.select()}var d;if(RTE.RteUtility.isFirefox()&&null!==(d=RTE.RteUtility.$2d(a,["TD","TH"]))&&RTE.Canvas.isInEditable(d))RTE.Canvas.$2u=d;var g=RTE.Canvas.getEditableRegion(a);if(a===g){var b=RTE.RteUtility.$1e(a,true);if(b&&b.nodeType===1&&b.offsetParent===a.offsetParent&&c.offsetY>b.offsetTop-a.offsetTop+b.clientHeight&&(b.tagName==="TABLE"||RTE.Canvas.$1Q(b))){var f=RTE.RteUtility.$4d(a.ownerDocument);a.appendChild(f);RTE.Cursor.get_range().moveToStartOfNode(f);RTE.Cursor.update();SP.UI.UIUtility.cancelEvent(c);return}}if(!RTE.Canvas.isEditable(a)){RTE.Canvas.set_$R(RTE.Cursor.$Ib(a));if(RTE.Canvas.get_$R()){var h=a.tagName;if(!RTE.Canvas.$3v(h)){if(!RTE.Canvas.$5N){RTE.Canvas.$55=null;RTE.RteUtility.$s("mousemove",RTE.Canvas.$9I);RTE.Canvas.$5N=true}RTE.Canvas.$68=true;RTE.Canvas.$9m=RTE.Canvas.$2P.style.cssText;RTE.RteUtility.getAttribute(RTE.Canvas.get_$R(),"unselectable")!=="on"&&RTE.Canvas.$DB(RTE.Canvas.get_$R());RTE.Cursor.s_range.moveToNode(RTE.Canvas.get_$R());RTE.Cursor.select()}}}}else RTE.Canvas.$3N=a;RTE.PasteFlyout.get_isVisible()&&window.setTimeout(RTE.PasteFlyout.collapseOptions,0);!RTE.PasteFlyout.get_isVisible()&&RTE.SnapshotManager.$1y(RTE.Canvas.currentEditableRegion())&&RTE.SnapshotManager.takeSnapshot()};RTE.Canvas.$3v=function(a){ULSNVe:;return a==="TEXTAREA"||a==="INPUT"||a==="IFRAME"||a==="OBJECT"||a==="EMBED"};RTE.Canvas.$Ch=function(a){ULSNVe:;return a==="SELECT"||a==="OPTION"||a==="INPUT"};RTE.Canvas.$DB=function(c){ULSNVe:;c.setAttribute("unselectable","on");for(var d=c.getElementsByTagName("*"),e=RTE.Canvas.getEditableRegion(c),b=0;b<d.length;b++){var a=d[b];!RTE.Canvas.$3v(a.tagName)&&!SP.UI.UIUtility.isTextNode(a)&&!SP.UI.UIUtility.isSvgNode(a)&&e===RTE.Canvas.getEditableRegion(a)&&a.setAttribute("unselectable","on")}};RTE.Canvas.$Dv=function(){ULSNVe:;if(RTE.Canvas.$3z){RTE.Canvas.$3z.style.cursor=RTE.Canvas.$9K;RTE.Canvas.$3z=null}};RTE.Canvas.onMouseMove=function(a){ULSNVe:;RTE.Canvas.$2P&&RTE.Canvas.$DG(a)};RTE.Canvas.$DG=function(d){ULSNVe:;try{var b=RTE.RteUtility.$HX(d.rawEvent);if(b){var c=b.commonAncestorContainer||b.parentElement(),a=RTE.Canvas.getEditableRegion(c);if(a!==RTE.Canvas.$3z&&a){RTE.Canvas.$Dv();RTE.Canvas.$9K=a.style.cursor;a.style.cursor="move";RTE.Canvas.$3z=a}if(RTE.Canvas.isEditable(c))RTE.Canvas.$55=b}RTE.Canvas.$55&&window.setTimeout(function(){ULSNVe:;RTE.Range.$9n(RTE.Canvas.$55)},0)}catch(e){}};RTE.Canvas.onMSPointerDown=function(b){ULSNVe:;var a=b.pointerType;if(typeof a!=="undefined"&&a===2)RTE.Canvas.onMouseDown(b)};RTE.Canvas.onMSPointerUp=function(b){ULSNVe:;var a=b.pointerType;if(typeof a!=="undefined"&&a===2)RTE.Canvas.onMouseUp(b)};RTE.Canvas.onSelectionChange=function(b){ULSNVe:;try{if(RTE.Canvas.$3j||RTE.Cursor.$37||!RTE.RteUtility.$2b(b.target)||SP.UI.ModalDialog.get_childDialog())return;var e=RTE.Canvas.currentEditableRegion();if(!e||!b.target||b.target.ownerDocument&&e.ownerDocument!==b.target.ownerDocument||b.target!==e.ownerDocument)return}catch(h){return}var a=RTE.QuickRange.$3p();if(a&&a.get_$3w_0()){var c=a.get_$9Y_0(),d=a.get_$9X_0();if(RTE.Cursor.s_range.isValid()){var f=c===RTE.Cursor.s_range.$3_0||c.previousSibling===RTE.Cursor.s_range.$3_0||c.nextSibling===RTE.Cursor.s_range.$3_0,g=d===RTE.Cursor.s_range.$4_0||d.previousSibling===RTE.Cursor.s_range.$4_0||d.nextSibling===RTE.Cursor.s_range.$4_0;if(RTE.Cursor.s_range.isEmpty()&&c===d&&a.$2r_0===a.$2E_0&&(f||g)||f&&g)return}RTE.Cursor.waitAndUpdateRangeToCurrentSelection(false,RTE.Canvas.$EZ)}};RTE.Canvas.onTouchStart=function(a){ULSNVe:;RTE.Canvas.onMouseDown(a)};RTE.Canvas.onTouchEnd=function(a){ULSNVe:;if(!RTE.RteUtility.$2b(a.target))return;RTE.Cursor.cursorRangeIsNowOutdated();RTE.Canvas.$BL(a);RTE.CanvasEvents.onImageResize(a)};RTE.Canvas.onMouseUp=function(a){ULSNVe:;RTE.Canvas.$3j=false;if(RTE.RteUtility.isInternetExplorer()&&RTE.Canvas.$3N&&RTE.Canvas.$3N===a.target&&!RTE.Canvas.$Ch(a.target.tagName)){var b=RTE.Cursor.getSelectedImage();if(b&&b!==RTE.Canvas.$3N){var c=RTE.RteUtility.$IY(b),e=a.clientX,f=a.clientY;e>=c.x&&e<=c.x+b.offsetWidth&&f>=c.y&&f<=c.y+b.offsetHeight&&RTE.Canvas.$3N.click()}}if(RTE.RteUtility.isFirefox()&&RTE.Canvas.$2u){var d=RTE.RteUtility.$2d(a.target,["TD","TH"]);if(d&&RTE.Canvas.$2u!==d)if(RTE.RteUtility.$G(RTE.Canvas.$2u,"TABLE")===RTE.RteUtility.$G(d,"TABLE")){RTE.Canvas.$2u.insertBefore(RTE.Cursor.s_range.$3_0,RTE.Canvas.$2u.firstChild);d.appendChild(RTE.Cursor.s_range.$4_0);RTE.Cursor.update()}}RTE.Canvas.$Lf(a);RTE.Canvas.$BL(a);RTE.CanvasEvents.onImageResize(a);RTE.Cursor.$23&&RTE.Cursor.s_range.clear()};RTE.Canvas.$BL=function(c){ULSNVe:;if(RTE.Canvas.$2P&&RTE.Canvas.$68){var a=RTE.Canvas.$2P,d=RTE.Canvas.getNonEditableRegion(c.target);if(!d){RTE.Canvas.set_$R(null);RTE.Canvas.$DG(c);RTE.Cursor.updateRangeToCurrentSelection();var b=RTE.Cursor.get_range();RTE.Canvas.set_$R(a);if(b.isValid()){b.insertNode(a);b.moveToNode(a);window.setTimeout(RTE.Cursor.update,0)}}a.style.cssText=RTE.Canvas.$9m;RTE.Canvas.$EV()}};RTE.Canvas.$EV=function(){ULSNVe:;if(RTE.Canvas.$5N){RTE.RteUtility.$BF("mousemove",RTE.Canvas.$9I);RTE.Canvas.$5N=false}RTE.Canvas.$68=false;RTE.Canvas.$Dv()};RTE.Canvas.onElementFocusChanged=function(b){ULSNVe:;if(b.target&&RTE.Cursor.$23){var a=RTE.Canvas.getEditableRegion(b.target);a&&RTE.CanvasEvents.dispatchChangedOnEditableRegion(a)}};RTE.Canvas.onDeactivate=function(b){ULSNVe:;var a=b.rawEvent.toElement;a&&a.ownerDocument!==window.document&&RTE.Canvas.$Ee(a,b)};RTE.Canvas.$Lf=function(a){ULSNVe:;RTE.Canvas.$Ee(a.target,a)};RTE.Canvas.$Ee=function(a,c){ULSNVe:;if(a&&a.parentNode&&RTE.RteUtility.$2b(a)){RTE.Canvas.get_activeAutocomplete()&&RTE.Canvas.get_activeAutocomplete().stop();var b=RTE.Canvas.getRedirectEditableRegion(a);if(b&&RTE.Canvas.$JH(b)){RTE.Canvas.moveToRedirect(a,b);c.preventDefault();return}RTE.Cursor.$51=true;if(RTE.Canvas.$Ch(a.tagName))RTE.Cursor.$4a();else RTE.Cursor.waitAndUpdateRangeToCurrentSelection(false,300)}};RTE.Canvas.setRedirectOnNode=function(b,a){ULSNVe:;b.RteRedirect=a};RTE.Canvas.moveToRedirectIfItExist=function(b){ULSNVe:;var a=RTE.Canvas.getRedirectEditableRegion(b);if(a)if(RTE.Canvas.moveToRedirect(b,a)){window.event&&SP.UI.UIUtility.cancelEvent(new Sys.UI.DomEvent(window.event));return true}return false};RTE.Canvas.moveToRedirect=function(c,a){ULSNVe:;var b=RTE.Canvas.getEditableRegion(c);if(!b||a!==b){if(a.innerHTML==="")a.innerText=RTE.RteUtility.$2O;window.setTimeout(RTE.Canvas.$Lh,2e3);RTE.Cursor.get_range().moveToEndOfNode(a);if(RTE.RteUtility.isFirefox()){RTE.CanvasEvents.$8H();RTE.Cursor.select();a.focus()}else{RTE.RteUtility.focusNoFail(a);RTE.Cursor.update()}return true}return false};RTE.Canvas.$Lh=function(){ULSNVe:;if(!RTE.Cursor.$3s){RTE.Cursor.$A2();RTE.Cursor.$37=true;document.body.focus();RTE.Cursor.select();RTE.Cursor.$37=false}};RTE.Canvas.$Lc=function(a){ULSNVe:;RTE.Canvas.$4y(a)&&RTE.Canvas.showEmptyPanel(a)};RTE.Canvas.showEmptyPanel=function(a){ULSNVe:;RTE.Canvas.$EN(a,"","none")};RTE.Canvas.hideEmptyPanel=function(a){ULSNVe:;RTE.Canvas.$EN(a,"none","")};RTE.Canvas.$Jz=function(l){ULSNVe:;var a=l.target;if(!SP.UI.UIUtility.isTextNode(a)&&a.tagName!=="BR")return;if(RTE.Cursor.$14)return;var b=a;if(!b)return;var e=false,f=null;while(b){var i=b.className;if(i&&i.indexOf("ms-rtestate-write")!==-1){e=true;f=b;if(!RTE.Canvas.getCachedRestriction(b,"AllowMultiLines",true))return;break}if(RTE.RteUtility.$Q(b))return;b=b.parentNode}if(!e)return;for(var g=f.childNodes,j=g.length,c=0;c<j;c++){var d=g[c];if(d!==a&&(!d.id||d.id.indexOf("ms-rterangecursor")===-1))return}if(SP.UI.UIUtility.isTextNode(a)){var k=a.nodeValue;if(k.replace(RTE.Canvas.$El,"")==="")return}var h=document.createElement("P");a.parentNode.insertBefore(h,a);h.appendChild(a);if(a.tagName==="BR"){RTE.Canvas.$5v=a;window.setTimeout(RTE.Canvas.$Kf,0)}RTE.Cursor.get_range().$62_0();RTE.Cursor.cursorRangeIsNowOutdated()};RTE.Canvas.$Kf=function(){ULSNVe:;if(!RTE.Canvas.$5v)return;RTE.RteUtility.$J(RTE.Canvas.$5v)};RTE.Canvas.$4y=function(b){ULSNVe:;if(b.childNodes.length<10){var a=b.innerHTML;a=RTE.RteUtility.$4B(a,false,true);a=a.replace(RTE.RteUtility.$2O,"");a=a.toLowerCase();if(a===""||a==="<br>"||a==="<p></p>"||a==="<p><br></p>"||a==="<p><br/></p>"||a==="<p>&nbsp;</p>")return true}return false};RTE.Canvas.$JH=function(c){ULSNVe:;var a=RTE.Canvas.getProperty(c,"EmptyPanelId");if(!RTE.SU.$2(a)){var b=$get(a);if(b)return b.style.display!=="none"}return false};RTE.Canvas.$EN=function(d,h,b){ULSNVe:;var e=RTE.Canvas.getProperty(d,"EmptyPanelId");if(!RTE.SU.$2(e)){var g=$get(e);g.style.display=h;var f=RTE.Canvas.getProperty(d,"DisplayPanelId"),a=d;if(!RTE.SU.$2(f))a=$get(f);if(a.style.display!==b){a.style.display=b;if(b!=="none"&&!RTE.Cursor.get_range().isValid()){RTE.Cursor.get_range().moveToEndOfNode(a);RTE.Cursor.update()}}var c=a.nextSibling;if(c&&c.className==="ms-rteclear"&&c.style.display!==b)c.style.display=b}};RTE.Canvas.getEditableRegionHtml=function(a,d){ULSNVe:;if(!a)return null;var b=RTE.RteUtility.getAttribute(a,"dir"),c=RTE.RteUtility.$IA(a,d);return RTE.Canvas.$4y(a)?"":!RTE.SU.$2(b)?'<div class="ms-rtedir" dir="'+b+'">'+c+"</div>":c};RTE.Canvas.currentEditableRegion=function(){ULSNVe:;return RTE.CanvasEvents.$2D};RTE.Canvas.getRTEFieldRegion=function(){ULSNVe:;if(!RTE.Canvas.$1N)return null;var c=RTE.Canvas.$1N.length;if(1===c)return RTE.Canvas.$1N[0];else for(var d=RTE.Canvas.currentEditableRegion(),a=0;a<c;a++){var b=RTE.Canvas.$1N[a];if(d===b||RTE.RteUtility.$b(d,b,null))return b}return null};RTE.Canvas.currentRegionWikilinkEnabled=function(){ULSNVe:;var a=RTE.Canvas.getRTEFieldRegion();if(!a)return false;var b=RTE.Canvas.getProperty(a,"WikiLinking");return!RTE.SU.$2(b)&&"on"===b.toLowerCase()};RTE.Canvas.get_activeAutocomplete=function(){ULSNVe:;if(RTE.Canvas.$4E&&!RTE.Canvas.$4E.get_isStarted())RTE.Canvas.$4E=null;return RTE.Canvas.$4E};RTE.Canvas.get_autocompleteHandlers=function(){ULSNVe:;if(!RTE.Canvas.$7H){RTE.Canvas.$7H=new Array(0);RTE.Canvas.registerAutocomplete(new RTE.WikiLinkAutoComplete(RTE.Canvas.getWikiLinkAutocomplete()))}return RTE.Canvas.$7H};RTE.Canvas.invokeInAutoComplete=function(d){ULSNVe:;var e=RTE.Canvas.get_activeAutocomplete();if(e)return d(e);for(var a=false,f=RTE.Canvas.get_autocompleteHandlers(),b=0;b<f.length;b++){var c=f[b];a=a||d(c);if(c.get_isStarted()){RTE.Canvas.$4E=c;break}}return a};RTE.Canvas.registerAutocomplete=function(a){ULSNVe:;Array.add(RTE.Canvas.get_autocompleteHandlers(),a)};RTE.Canvas.getWikiLinkAutocomplete=function(){ULSNVe:;if(!RTE.Canvas.$4H)RTE.Canvas.$4H=new RTE.Autocomplete("SPRTEWikiAutocomplete",window.document,new RTE.AutocompleteWikiLinkSource);return RTE.Canvas.$4H};RTE.Canvas.isMultiline=function(a){ULSNVe:;return RTE.Canvas.getCachedRestriction(a,"AllowMultiLines",true)};RTE.Canvas.getCachedRestriction=function(a,c,d){ULSNVe:;if(!a)return d;if(RTE.Canvas.$7z!==a){RTE.Canvas.resetCacheRestriction();RTE.Canvas.$7z=a}var b=RTE.Canvas.$5y[c];if(typeof b==="undefined"){b=RTE.Canvas.getRestriction(a,c,d);RTE.Canvas.$5y[c]=b}return b};RTE.Canvas.resetCacheRestriction=function(){ULSNVe:;RTE.Canvas.$5y={}};RTE.Canvas.getRestriction=function(b,a,c){ULSNVe:;return RTE.Canvas.getStringRestriction(b,a,c?"True":"False")==="True"};RTE.Canvas.getStringRestriction=function(a,d,b){ULSNVe:;if(!a)return b;var c=RTE.RteUtility.getAttribute(a,d);if(!c){if(a.className.indexOf("ms-rtestate-field")!==-1)return b;var e=RTE.Canvas.getRegion(a);if(!e)return b;c=RTE.RteUtility.getAttribute(e,d);if(!c)return b}return c};RTE.Canvas.setRestriction=function(b,a,c){ULSNVe:;var d=c?"True":"false";b.setAttribute(a,d)};RTE.Canvas.getProperty=function(a,b){ULSNVe:;return RTE.RteUtility.getAttribute(a,b)};RTE.Canvas.getBooleanProperty=function(a,b){ULSNVe:;var c=RTE.RteUtility.getAttribute(a,b);return c==="True"};RTE.Canvas.makeRegionEditable=function(a){ULSNVe:;a.setAttribute("contentEditable",true);a.setAttribute("role","textbox");a.setAttribute("aria-autocomplete","both");a.setAttribute("aria-haspopup",true);a.setAttribute("aria-multiline",true);Sys.UI.DomElement.addCssClass(a,"ms-rtestate-write");Sys.UI.DomElement.removeCssClass(a,"ms-rtestate-read");Array.add(RTE.Canvas.$33,a)};RTE.Canvas.makeRegionUnEditable=function(a){ULSNVe:;a.setAttribute("contentEditable",false);a.removeAttribute("role");a.removeAttribute("aria-autocomplete");a.removeAttribute("aria-haspopup");a.removeAttribute("aria-multiline");Sys.UI.DomElement.removeCssClass(a,"ms-rtestate-write");Sys.UI.DomElement.addCssClass(a,"ms-rtestate-read");Array.remove(RTE.Canvas.$33,a)};RTE.Canvas.getCurrentStyleSheetPrefix=function(){ULSNVe:;var a=RTE.Canvas.currentEditableRegion();if(a){var b=RTE.Canvas.getProperty(a,"PrefixStyleSheet");if(!RTE.SU.$2(b))return b}return"ms-rte"};RTE.Canvas.setInitialFocus=function(){ULSNVe:;var a=RTE.SnapshotManager.getMarkers();if(!RTE.Canvas.$1h&&a.length===2&&a[0]&&a[1])RTE.Canvas.$1h=RTE.Canvas.getEditableRegion(a[0]);if(null!==RTE.Canvas.$1h&&RTE.Canvas.$1h.parentNode){var c=RTE.Cursor.get_range();if(a.length===2&&a[0]&&a[1]&&RTE.RteUtility.$b(a[0],RTE.Canvas.$1h,null)&&RTE.RteUtility.$b(a[1],RTE.Canvas.$1h,null)){c.moveToMarkersCollection(a);a[0]!==c.$3_0&&RTE.RteUtility.removeNodeAndKeepChildNodes(a[0]);a[1]!==c.$4_0&&RTE.RteUtility.removeNodeAndKeepChildNodes(a[1])}else{var b;if(RTE.Canvas.$8o(RTE.Canvas.$1h))b=RTE.LayoutsEditor.getLayoutsEditorForRegion(RTE.Canvas.$1h).$Bq_0();else b=RTE.Canvas.$1h;var d=RTE.Canvas.getEditableRegion(b);d&&RTE.RteUtility.focusNoFail(d);RTE.Cursor.get_range().moveToStartOfNode(b)}RTE.Canvas.$1D=true;RTE.Cursor.update()}else window.setTimeout(RTE.Canvas.checkCurrentFocus,0)};RTE.Canvas.checkCurrentFocus=function(){ULSNVe:;var a=RTE.Selection.getSelectionRange();if(a){var b=a.parentElement();if(RTE.Canvas.isInEditable(b)&&!RTE.Cursor.get_range().isValid()){RTE.Cursor.updateRangeToCurrentSelection();RTE.Cursor.update()}}};RTE.Canvas.getVisibleHtml=function(c){ULSNVe:;var b=c.cloneNode(false),d,a;RTE.RteUtility.$2p(b,c.innerHTML);a=b.firstChild;while(null!==a){d=a.nextSibling;!RTE.RteUtility.$4c(a)&&b.removeChild(a);a=d}var e=b.innerHTML;b=null;return e};RTE.Canvas.canHandleInsertWebPart=function(){ULSNVe:;if(!RTE.Canvas.$1D)return false;var b=RTE.Canvas.currentEditableRegion();if(!RTE.Canvas.getCachedRestriction(b,"AllowWebParts",false))return false;if(RTE.RteUtility.isInWebpartBox(b))return false;var a=window.WPAdder;!a&&window.LoadWPAdderOnDemand();a=window.WPAdder;return!a?typeof loadWPAdderCallback==="function":true};RTE.Canvas.$8o=function(b){ULSNVe:;var a=RTE.RteUtility.getAttribute(b,"isWiki");return!RTE.SU.$7(a)&&a};RTE.Canvas.$IE=function(d){ULSNVe:;var a="ms-rteflags-",b=d.className.indexOf(a),c=0;if(-1!==b){var e=d.className.substr(b+a.length).split(" ")[0];c=e}return c};RTE.Canvas.onBeforeUnload=function(){ULSNVe:;for(var a=0;a<RTE.Canvas.$33.length;a++)RTE.Canvas.storeViewHtml(RTE.Canvas.$33[a])};RTE.Canvas.changeKeyTimeout=function(a){ULSNVe:;RTE.Canvas.$3i=a?0:500};RTE.Canvas.isSkipNode=function(a){ULSNVe:;if(a.nodeType===1&&Sys.UI.DomElement.containsCssClass(a,"ms-rtegenerate-skip"))return true;while(a){if(a.nodeType===1&&Sys.UI.DomElement.containsCssClass(a,"ms-rtegenerate-allskip"))return true;a=a.parentNode}return false};RTE.CanvasEvents=function(){};RTE.CanvasEvents.registerListener=function(a,b){ULSNVe:;RTE.CanvasEvents.$6f.addHandler(a,b);if(!RTE.CanvasEvents.$2L[a])RTE.CanvasEvents.$2L[a]=0;RTE.CanvasEvents.$2L[a]=RTE.CanvasEvents.$2L[a]+1;return true};RTE.CanvasEvents.unRegisterListener=function(a,b){ULSNVe:;RTE.CanvasEvents.$6f.removeHandler(a,b);RTE.CanvasEvents.$2L[a]=RTE.CanvasEvents.$2L[a]-1;return true};RTE.CanvasEvents.dispatchEvent=function(a,c,d){ULSNVe:;RTE.Canvas.get_activeAutocomplete()&&RTE.Canvas.get_activeAutocomplete().onTextChanged();if(RTE.CanvasEvents.$2L[a]>0){var b=RTE.CanvasEvents.$6f.getHandler(a);if(b)try{b(c,d)}catch(e){}}};RTE.CanvasEvents.dispatchChanged=function(){ULSNVe:;if(RTE.CanvasEvents.$2L.EditableRegionChanged>0){var a=RTE.CanvasEvents.$2D;if(a)RTE.SnapshotManager.$3F(RTE.SnapshotManager.$1U,a)&&RTE.SnapshotManager.$1y(a)&&RTE.CanvasEvents.dispatchChangedOnEditableRegion(a)}};RTE.CanvasEvents.dispatchChangedOnEditableRegion=function(b){ULSNVe:;var a={};a.editableRegion=b;RTE.CanvasEvents.dispatchEvent("EditableRegionChanged",null,a)};RTE.CanvasEvents.$Hb=function(){ULSNVe:;var a={};a.editableRegion=RTE.CanvasEvents.$2D;RTE.CanvasEvents.dispatchEvent("EditableRegionSelection",null,a)};RTE.CanvasEvents.$BI=function(a,c){ULSNVe:;if(a&&(!RTE.CanvasEvents.$2D||!RTE.RteUtility.$b(RTE.CanvasEvents.$2D,a,null))){var b={};b.oldEditableRegion=a;b.newEditableRegion=c;RTE.CanvasEvents.dispatchEvent("EditableRegionBlur",null,b);RTE.CanvasEvents.$BI(RTE.Canvas.getEditableRegion(a.parentNode),c)}};RTE.CanvasEvents.dispatchFocus=function(a){ULSNVe:;if(a===RTE.CanvasEvents.$2D)return;var c=RTE.CanvasEvents.$2D;RTE.CanvasEvents.$2D=a;RTE.CanvasEvents.$BI(c,a);if(a){!RTE.SnapshotManager.$3F(RTE.SnapshotManager.$1U,a)&&RTE.SnapshotManager.takeEditableRegionSnapshot(a);var b={};b.oldEditableRegion=c;b.newEditableRegion=a;RTE.CanvasEvents.dispatchEvent("EditableRegionFocus",null,b);!Array.contains(RTE.Canvas.$33,a)&&Array.add(RTE.Canvas.$33,a)}};RTE.CanvasEvents.getNodeFromEvent=function(b){ULSNVe:;var a=RTE.CanvasEvents.$3m[b];return RTE.SU.$1R(a)?null:a};RTE.CanvasEvents.dispatchNodeEvents=function(a,b){ULSNVe:;if(!b)RTE.CanvasEvents.$BJ(a,null);else RTE.CanvasEvents.$Ha(a,b)};RTE.CanvasEvents.$BJ=function(a,d){ULSNVe:;var c=RTE.CanvasEvents.$3m[a];if(c){var b={};b["old"+a]=c;b["new"+a]=d;RTE.CanvasEvents.$3m[a]=null;RTE.CanvasEvents.dispatchEvent(a+"Blur",null,b)}};RTE.CanvasEvents.$Ha=function(a,b){ULSNVe:;var c=RTE.CanvasEvents.$3m[a];if(!b||b===c)return;RTE.CanvasEvents.$BJ(a,c);RTE.CanvasEvents.$3m[a]=b;var d={};d["old"+a]=c;d["new"+a]=b;RTE.CanvasEvents.dispatchEvent(a+"Focus",null,d)};RTE.CanvasEvents.$8H=function(){ULSNVe:;if(RTE.CanvasEvents.$4h)return;if(RTE.PreviewManager.get_instance().get_hasPreview())return;var a=RTE.Cursor.s_range;RTE.Canvas.$1D=a.isValid();var f=RTE.Canvas.currentEditableRegion(),b=a.getEditableRegion();if(!f&&!b)return;RTE.CanvasEvents.$4h=true;try{RTE.CanvasEvents.dispatchFocus(b);RTE.CanvasEvents.$Hb();var g=RTE.Cursor.getSelectedTable();RTE.CanvasEvents.dispatchNodeEvents("Table",g);var c=RTE.Cursor.getSelectedAtomic();RTE.CanvasEvents.dispatchNodeEvents("Atomic",c);var d=null,e=null;if(!c){d=RTE.Cursor.getSelectedLink();e=RTE.Cursor.getSelectedImage()}RTE.CanvasEvents.dispatchNodeEvents("Link",d);RTE.CanvasEvents.dispatchNodeEvents("Image",e);RTE.Canvas.get_activeAutocomplete()&&RTE.Canvas.get_activeAutocomplete().onTextChanged();RTE.CanvasEvents.dispatchChanged()}catch(h){RTE.CanvasEvents.$4h=false}finally{RTE.CanvasEvents.$4h=false}};RTE.CanvasEvents.onEditableRegionBlur=function(c,b){ULSNVe:;var a=b.oldEditableRegion;RTE.SnapshotManager.$1y(a)&&RTE.SnapshotManager.takeEditableRegionSnapshot(a);RTE.Canvas.$LD(a);RTE.Canvas.$Lc(a);RTE.Canvas.$O()};RTE.CanvasEvents.onEditableRegionFocus=function(d,c){ULSNVe:;var b=c.oldEditableRegion,a=c.newEditableRegion;(!b||RTE.Canvas.getCachedRestriction(b,"DisableRibbonCommands",false))&&!RTE.Canvas.getCachedRestriction(a,"DisableRibbonCommands",false)&&RTE.RteUtility.$LO("Ribbon.EditingTools.CPEditTab");RTE.SnapshotManager.$1y(a)&&RTE.SnapshotManager.takeEditableRegionSnapshot(a);RTE.Canvas.hideEmptyPanel(a);RTE.Canvas.$L4(a);RTE.Canvas.$O()};RTE.CanvasEvents.onLinkDeselected=function(c,b){ULSNVe:;var a=b.newLink;!a&&RTE.RteUtility.showNextBestTabIfSelectedRibbonTabIs(["LinkTab"])};RTE.CanvasEvents.onTableDeselected=function(c,b){ULSNVe:;var a=b.newTable;!a&&RTE.RteUtility.showNextBestTabIfSelectedRibbonTabIs(["TableLayoutTab","TableDesignTab"])};RTE.CanvasEvents.onImageSelected=function(b,a){ULSNVe:;var c=a.newImage;RTE.CanvasEvents.waitAndSetImageSize()};RTE.CanvasEvents.onImageDeselected=function(c,b){ULSNVe:;var a=b.newImage;!a&&RTE.RteUtility.showNextBestTabIfSelectedRibbonTabIs(["ImageTab"])};RTE.CanvasEvents.resetImageSizes=function(a){ULSNVe:;a.removeAttribute("setHeight");a.removeAttribute("setWidth");a.removeAttribute("hasHeight")};RTE.CanvasEvents.onImageResize=function(m){ULSNVe:;var a=RTE.CanvasEvents.getNodeFromEvent("Image");if(!a)return;var i=RTE.RichTextEditor.isRatioLocked(a),h=RTE.RteUtility.getAttribute(a,"setHeight"),j=RTE.RteUtility.getAttribute(a,"setWidth"),k=RTE.RteUtility.getAttribute(a,"hasHeight");if(!RTE.SU.$7(h)){var b=Number.parseInvariant(h),e=Number.parseInvariant(j),g=Boolean.parse(k),f=RTE.RichTextEditor.$5s(),c=f?a.height:b,d=f?a.width:e;if(f&&(i||m.shiftKey)){if(d!==e||c!==b){if(Math.abs(c-b)>Math.abs(d-e))d=Math.round(c*e/b);else c=Math.round(d*b/e);if(!isNaN(d))a.style.width=d+"px";if(g&&!isNaN(c))a.style.height=c+"px"}if(!g)a.style.height=""}else{a.style.width=d+"px";a.style.height=f||g?c+"px":""}a.removeAttribute("height");a.removeAttribute("width");var l=f&&(b!==-1&&b!==a.height||e!==a.width);if(l){RTE.SnapshotManager.setCurrentRegionDirty();RTE.Canvas.$O()}}RTE.CanvasEvents.waitAndSetImageSize()};RTE.CanvasEvents.waitAndSetImageSize=function(){ULSNVe:;RTE.CanvasEvents.$7e>0&&window.clearTimeout(RTE.CanvasEvents.$7e);RTE.CanvasEvents.$7e=window.setTimeout(RTE.CanvasEvents.$EH,100)};RTE.CanvasEvents.setImageSize=function(){ULSNVe:;var a=RTE.Cursor.getSelectedImage();if(!a)return;if(a.complete||a.readyState==="complete"){var b=a.height,c=a.width,d=RTE.RteUtility.getAttribute(a,"setHeight"),e=RTE.RteUtility.getAttribute(a,"setWidth"),f=RTE.RteUtility.getAttribute(a,"hasHeight");a.setAttribute("setHeight",b);a.setAttribute("setWidth",c);a.setAttribute("hasHeight",!RTE.SU.$2(a.style.height));var g=a.getAttribute("setHeight")!==d||a.getAttribute("setWidth")!==e||a.getAttribute("hasHeight")!==f;g&&RTE.Canvas.$O()}else{RTE.CanvasEvents.waitAndSetImageSize();return}RTE.SnapshotManager.$1y(RTE.Canvas.currentEditableRegion())&&RTE.SnapshotManager.takeSnapshotIfNotInPreview()};RTE.CanvasEvents.onAtomicSelected=function(c,b){ULSNVe:;var a=b.newAtomic;a.className.indexOf("ms-rte-wpbox")===-1&&Sys.UI.DomElement.addCssClass(a,"s4-wpActive");$addHandler(a,"resizestart",RTE.CanvasEvents.$7n)};RTE.CanvasEvents.onAtomicDeselected=function(c,b){ULSNVe:;var a=b.oldAtomic;Sys.UI.DomElement.removeCssClass(a,"s4-wpActive");if(a.parentNode&&a.parentNode.parentNode)try{$removeHandler(a,"resizestart",RTE.CanvasEvents.$7n)}catch(d){}};RTE.CanvasEvents.onAtomicResize=function(a){ULSNVe:;a.preventDefault();a.rawEvent.returnValue=false;a.rawEvent.cancelBubble=true;a.stopPropagation()};RTE.CanvasRange=function(a){ULSNVe:;this.$$d_$LS_0=Function.createDelegate(this,this.$LS_0);this.$3_0=document.createElement("SPAN");this.$4_0=document.createElement("SPAN");this.$3_0.id="ms-rterange"+a+"-start";this.$4_0.id="ms-rterange"+a+"-end"};RTE.CanvasRange.$Du=function(b){ULSNVe:;var a;while(null!==(a=$get(b)))RTE.RteUtility.removeNodeAndKeepChildNodes(a)};RTE.CanvasRange.$EM=function(b){ULSNVe:;if(RTE.RteUtility.$Q(b))return true;if(b.nodeType===1){var a=b.tagName;return a==="SPAN"||a==="STRONG"||a==="B"||a==="I"||a==="U"||a==="EM"||a==="CENTER"||a==="FONT"||a==="S"||a==="STRIKE"||a==="SUB"||a==="SUP"}return false};RTE.CanvasRange.$89=function(b){ULSNVe:;var a=null;if(b)a=b===b.ownerDocument.body?new Array(0):RTE.CanvasRange.$89(b.parentNode);if(a)a[a.length]=b;return a};RTE.CanvasRange.$Cd=function(a){ULSNVe:;var b=a.offsetTop,e=a.offsetHeight,c=a.offsetParent;a=a.parentNode;while(a!==document.documentElement){if(a===c)b+=a.offsetTop;if(a.scrollHeight!==a.clientHeight){var d=b-a.offsetTop-a.scrollTop;if(a.scrollHeight!==a.clientHeight){if(a.scrollTop>0&&d<0)if(RTE.RteUtility.$Cn(a))return-1;if(a.clientHeight>0&&d>Math.max(0,a.clientHeight-e))if(RTE.RteUtility.$Cn(a))return 1}}b-=a.scrollTop;c=a.offsetParent;a=a.parentNode}return 0};RTE.CanvasRange.prototype={$7x_0:null,$7y_0:false,$1a_0:null,$5x_0:false,$CM_0:function(){ULSNVe:;if(!this.$1a_0)this.$1a_0=RTE.Range.createRange()},resetCacheRange:function(){ULSNVe:;this.$5x_0=false;this.$7y_0=false;this.$80_0=false;this.$7w_0=false},duplicate:function(b){ULSNVe:;var a=new RTE.CanvasRange(b);a.moveToMarkersCollection(this.getMarkers());return a},normalize:function(){ULSNVe:;if(!this.isValid())return;var a=new RTE.DOMTreePosition(this.$3_0,0);a.setLocationAtEnd();a.moveCount(false,0);a.insertMarker(this.$3_0);var b=new RTE.DOMTreePosition(this.$4_0,0);b.moveCount(true,0);b.insertMarker(this.$4_0);this.fixMarkers();this.resetCacheRange()},moveToRange:function(e){ULSNVe:;RTE.RteUtility.assertNotNull("range",e);var b=document.createElement("SPAN"),a=document.createElement("SPAN");a.id="ms-rterangenew-start";b.id="ms-rterangenew-end";var i=true,j=true,c=null,d=null;try{var p=e.$B_0.item;if(p){var m=e.$B_0.item(0);SP.UI.UIUtility.insertBefore(a,m);SP.UI.UIUtility.insertAfter(b,m)}else{var h=e.$B_0.startContainer;if(!h)h=e.$B_0.parentElement();if(!h||window.document!==h.ownerDocument)return false;var n=e.duplicate(),o=e.duplicate();n.collapse(false);i=n.$CR_0(b,true,RTE.Cursor.$51);o.collapse(true);j=o.$CR_0(a,false,RTE.Cursor.$51)}c=RTE.Canvas.getEditableRegion(a);if(!c){var k=new RTE.DOMTreePosition(a,0);k.normalizeRight();if(k.$1_0!==a){k.insertMarker(a);c=RTE.Canvas.getEditableRegion(a)}if(!c&&a.nextSibling)c=RTE.Canvas.getEditableRegion(a.nextSibling);c&&c.insertBefore(a,c.firstChild)}d=RTE.Canvas.getEditableRegion(b);if(!d){var l=new RTE.DOMTreePosition(b,0);l.normalizeLeft();if(l.$1_0!==b){l.insertMarker(b);d=RTE.Canvas.getEditableRegion(b)}if(!d&&b.previousSibling)d=RTE.Canvas.getEditableRegion(b.previousSibling);d&&d.appendChild(b)}}catch(r){i=false;j=false}var f=b.parentNode,g=a.parentNode;if(i&&j&&c&&d){RTE.RteUtility.$4N(this.$3_0);RTE.RteUtility.$5h(this.$4_0);RTE.RteUtility.assertNotNull("endMarkerLoc.ParentNode",f);RTE.RteUtility.assertNotNull("startMarkerLoc.ParentNode",g);b.nextSibling===a&&SP.UI.UIUtility.insertBefore(a,b);f.replaceChild(this.$4_0,b);g.replaceChild(this.$3_0,a);this.$Ar_0();this.resetCacheRange();this.$6t_0(this.$4_0);this.$6t_0(this.$3_0);this.$Ba_0();return true}else{var q=RTE.Canvas.moveToRedirectIfItExist(a);f&&f.removeChild(b);g&&g.removeChild(a);return q}},makeSafe:function(){ULSNVe:;this.fixMarkers();var c=this.parentElement(),a=new RTE.DOMTreePosition(this.$3_0,0);a.setLocationAtEnd();a.moveToNextElement();while(true){var b=a.$1_0;a.setLocationAtEnd();a.moveToNextElement();if(RTE.RteUtility.$b(this.$4_0,b,c)){RTE.SafeHtml.$9V(b,true,true,false);break}else RTE.SafeHtml.$9V(b,true,true,false)}this.resetCacheRange()},$Ar_0:function(){ULSNVe:;if(RTE.CanvasRange.$66)return;var a=this.$3_0.id,b=this.$4_0.id;this.$3_0.id="";this.$4_0.id="";RTE.CanvasRange.$Du(a);RTE.CanvasRange.$Du(b);this.$3_0.id=a;this.$4_0.id=b;RTE.RteUtility.$4N(this.$3_0);RTE.RteUtility.$5h(this.$4_0)},$1d_0:function(){ULSNVe:;if(!this.$5x_0){this.$CM_0();this.$Ba_0();var a=this.isEmpty();if(this.get_$6Y_0()){if(!a){this.$1a_0.$B_0.setStartAfter(this.$3_0);this.$1a_0.$B_0.setEndBefore(this.$4_0)}else{this.$1a_0.$B_0.setEndAfter(this.$4_0);this.$1a_0.$B_0.setStartAfter(this.$4_0);this.$1a_0.collapse(true)}this.$5x_0=true}else{this.$1a_0.moveToMarkers(this.$3_0,this.$4_0,this.isEmpty());this.$5x_0=true}}return this.$1a_0},get_$6Y_0:function(){ULSNVe:;this.$CM_0();return!!this.$1a_0.$B_0.setEndBefore},$Ba_0:function(){ULSNVe:;var a=this.$4_0.parentNode;if(a.tagName==="LI"){var e=a.lastChild;if(a.childNodes.length===3){for(var b=null,d=0;d<a.childNodes.length;d++){var c=a.childNodes[d];if(c===this.$3_0||c===this.$4_0)continue;if(!b&&c.nodeType===1&&c.tagName==="BR"){b=c;continue}b=null;break}b&&a.removeChild(b)}}},getMarkers:function(){ULSNVe:;var a=[];a[0]=this.$3_0;a[1]=this.$4_0;return a},get_endMarker:function(){ULSNVe:;return this.$4_0},get_startMarker:function(){ULSNVe:;return this.$3_0},setMarkersCollection:function(a){ULSNVe:;RTE.RteUtility.assertNotNull("markers",a);a.length===2&&this.setMarkers(a[0],a[1])},setMarkers:function(a,b){ULSNVe:;this.$3_0!==a&&RTE.RteUtility.$J(this.$3_0);this.$4_0!==b&&RTE.RteUtility.$J(this.$4_0);this.$3_0=a;this.$4_0=b;this.$Ar_0();this.resetCacheRange()},moveToMarkersCollection:function(a){ULSNVe:;RTE.RteUtility.assertNotNull("markers",a);a.length===2&&this.moveToMarkers(a[0],a[1])},moveToMarkers:function(a,b){ULSNVe:;SP.UI.UIUtility.insertBefore(this.$3_0,a);SP.UI.UIUtility.insertBefore(this.$4_0,b);this.resetCacheRange()},$2s_0:null,$3k_0:null,isValid:function(){ULSNVe:;var a=this.$3_0.parentNode,b=this.$4_0.parentNode;return!!a&&!!b&&a.nodeType!==11&&b.nodeType!==11&&a!==RTE.CanvasRange.$1f&&b!==RTE.CanvasRange.$1f},$BU_0:function(){ULSNVe:;this.$2s_0=[];this.$3k_0=[];if(!this.isValid())return;var a=this.$3_0;if(a.nextSibling&&a.nextSibling.firstChild&&RTE.Canvas.isEditable(a.nextSibling)){a=a.nextSibling;while(a.firstChild&&!SP.UI.UIUtility.isTextNode(a.firstChild))a=a.firstChild}while(a&&!RTE.Canvas.$8m(a)){this.$2s_0.push(a);a=a.parentNode}a&&this.$2s_0.push(a);var b=this.$4_0;if(b.previousSibling&&b.previousSibling.lastChild&&RTE.Canvas.isEditable(b.previousSibling)){b=b.previousSibling;while(b.lastChild&&!SP.UI.UIUtility.isTextNode(b.lastChild))b=b.lastChild}while(b&&!RTE.Canvas.$8m(b)){this.$3k_0.push(b);b=b.parentNode}b&&this.$3k_0.push(b)},parentElement:function(){ULSNVe:;var a=this.getParentChain();return a.length>0?a[0]:null},fixMarkers:function(){ULSNVe:;this.$BU_0();if(!this.$2s_0.length)return;var a=null,c=null;while(this.$2s_0.length>0){a=this.$2s_0.pop();c=this.$3k_0.pop();if(a!==c)break}for(var e=a.parentNode,f=false,d=0;d<e.childNodes.length;d++){var g=e.childNodes[d];if(f&&g===a){var b=document.createElement("SPAN");SP.UI.UIUtility.insertBefore(b,this.$3_0);SP.UI.UIUtility.insertBefore(this.$3_0,this.$4_0);SP.UI.UIUtility.insertBefore(this.$4_0,b);b.parentNode.removeChild(b);return}else if(g===c)f=true}},inRange:function(b){ULSNVe:;var a=this.$1d_0();return a.inRange(b)},inCanvasRange:function(a){ULSNVe:;RTE.RteUtility.assertNotNull("r",a);var b=a.$1d_0();return this.inRange(b)},collapse:function(a){ULSNVe:;if(a)SP.UI.UIUtility.insertAfter(this.$4_0,this.$3_0);else SP.UI.UIUtility.insertBefore(this.$3_0,this.$4_0);this.resetCacheRange()},get_text:function(){ULSNVe:;var a=this.$1d_0();return a.get_innerText()},wrapRange:function(c){ULSNVe:;var b=this.parentElement(),a=this.$3_0;while(a&&a.parentNode!==b)a=a.parentNode;if(!a){while(this.$3_0.parentNode!==b)b=b.parentNode;a=this.$3_0}var d=new RTE.ExtractChildNodesProcessor(b,this.$3_0,this.$4_0,c,false);d.process();SP.UI.UIUtility.insertAfter(c,a);SP.UI.UIUtility.insertBefore(this.$3_0,c);SP.UI.UIUtility.insertAfter(this.$4_0,c)},getEditableRegion:function(){ULSNVe:;var a=this.parentElement();return RTE.Canvas.getEditableRegion(a)},getNonEditableRegion:function(){ULSNVe:;var a=this.parentElement();return RTE.Canvas.getNonEditableRegion(a)},get_isInEditableRegion:function(){ULSNVe:;var a=this.getEditableRegion();return!!a},get_isInNonEditableRegion:function(){ULSNVe:;var a=this.getNonEditableRegion();return!!a},get_isEditableRegion:function(){ULSNVe:;var a=this.parentElement();return RTE.Canvas.$i(a)?!this.$3_0.previousSibling&&this.$3_0.parentNode===a&&!this.$4_0.nextSibling&&this.$4_0.parentNode===a:false},get_isNonEditableRegion:function(){ULSNVe:;var a=this.parentElement();if(RTE.Canvas.$1Q(a)){var b=RTE.Range.createRange();b.moveToElementText(a);return this.inRange(b)}return false},get_isEditable:function(){ULSNVe:;var a=this.parentElement();if(a&&a.previousSibling===this.$3_0&&a.nextSibling===this.$4_0)a=a.parentNode;return RTE.Canvas.isEditable(a)},expandInNonEditableRegion:function(){ULSNVe:;if(this.get_isInEditableRegion()&&!RTE.Canvas.isEditable(this.parentElement())){var a=this.getNonEditableRegion();this.moveToNode(a);return a}return null},getParentBlockNode:function(){ULSNVe:;var a=this.parentElement();while(a&&!RTE.RteUtility.$Q(a))a=a.parentNode;return a},expandToBlock:function(){ULSNVe:;var a=this.getParentBlockNode();a&&this.moveToNode(a)},$Hh_0:function(){ULSNVe:;var b=new RTE.DOMTreePosition(this.$3_0,0),d=null,c=this.$3_0;while(b.moveToPreviousElement()&&b.atStart()&&!RTE.Canvas.$i(b.$1_0)&&c.parentNode===b.$1_0){if(!SP.UI.UIUtility.isNodeOfType(b.$1_0,RTE.CanvasRange.$9g))d=b.$1_0;c=b.$1_0}d&&SP.UI.UIUtility.insertBefore(this.$3_0,d);var a=new RTE.DOMTreePosition(this.$4_0,0);a.setLocationAtEnd();var e=null;c=this.$4_0;while(a.moveToNextElement()&&a.atEnd()&&!RTE.Canvas.$i(a.$1_0)&&c.parentNode===a.$1_0){if(!SP.UI.UIUtility.isNodeOfType(a.$1_0,RTE.CanvasRange.$9g))e=a.$1_0;c=a.$1_0}e&&SP.UI.UIUtility.insertAfter(this.$4_0,e);this.resetCacheRange()},moveToNode:function(a){ULSNVe:;if(SP.UI.UIUtility.isNodeOfType(a,RTE.CanvasRange.$7K))this.moveToChildren(a);else{SP.UI.UIUtility.insertBefore(this.$3_0,a);SP.UI.UIUtility.insertAfter(this.$4_0,a)}this.resetCacheRange();return true},moveToChildren:function(a){ULSNVe:;RTE.RteUtility.assertNotNull("node",a);if(a.tagName==="TR"||a.tagName==="TBODY"||a.tagName==="TABLE"){var b=a;while(b&&b.tagName!=="TD"&&b.tagName!=="TH")b=RTE.RteUtility.$1w(b,true);var c=a;while(c&&c.tagName!=="TD"&&c.tagName!=="TH")c=RTE.RteUtility.$1e(c,true);if(b&&c){if(RTE.RteUtility.$2O!==b.innerHTML)b.insertBefore(this.$3_0,RTE.RteUtility.$1w(b,true));else b.appendChild(this.$3_0);c.appendChild(this.$4_0)}}else{var d=RTE.Canvas.getEditableRegion(a);if(d===a&&RTE.Canvas.$4y(d)&&RTE.Canvas.isMultiline(d)){var e=d.ownerDocument.createElement("P");a.appendChild(e);return this.moveToStartOfNode(e)}a.insertBefore(this.$3_0,RTE.RteUtility.$1w(a,false));a.appendChild(this.$4_0)}this.resetCacheRange();return true},moveToStartOfNode:function(a){ULSNVe:;this.$4l_0();RTE.RteUtility.assertNotNull("node",a);try{if(RTE.Canvas.$1Q(a)){var e=this.moveToNode(a);RTE.Canvas.$5Z(a);return e}var c=RTE.RteUtility.$1w(a,true);if(c&&RTE.CanvasRange.$EM(c))return this.moveToStartOfNode(c);var b=RTE.Canvas.getEditableRegion(a);if(b===a&&!b.firstChild&&RTE.Canvas.isMultiline(b)){var d=RTE.RteUtility.$4d(b.ownerDocument);b.appendChild(d);return this.moveToStartOfNode(d)}a.insertBefore(this.$4_0,a.firstChild);SP.UI.UIUtility.insertBefore(this.$3_0,this.$4_0);this.resetCacheRange()}catch(f){}return true},$Jl_0:function(b){ULSNVe:;var c=null;if(b.firstChild){var a=new RTE.DOMTreePosition(b.firstChild,0);while(a.$1_0!==b){if(RTE.Canvas.$1Q(a.$1_0))c=a.$1_0;else if(SP.UI.UIUtility.isTextNode(a.$1_0)&&!RTE.SU.$2(a.$1_0.nodeValue)||a.$1_0.tagName==="A"&&a.$1_0.innerHTML!==""||a.$1_0.tagName==="IMG"){c=a.$1_0;break}if(!a.moveToNextElement())break}}if(c)SP.UI.UIUtility.insertBefore(this.$4_0,c);else if(!b.firstChild)b.appendChild(this.$4_0);else SP.UI.UIUtility.insertBefore(this.$4_0,b.firstChild);SP.UI.UIUtility.insertBefore(this.$3_0,this.$4_0);this.resetCacheRange()},moveToEndOfNode:function(a){ULSNVe:;this.$4l_0();RTE.RteUtility.assertNotNull("node",a);if(RTE.Canvas.$1Q(a)){var e=this.moveToNode(a);RTE.Canvas.$5Z(a);return e}var b=RTE.RteUtility.$1e(a,true);if(b&&RTE.CanvasRange.$EM(b))return this.moveToEndOfNode(b);if(a.tagName==="P")if(a.innerHTML==="&nbsp;"){a.insertBefore(this.$4_0,a.firstChild);a.insertBefore(this.$3_0,this.$4_0)}else if(b&&b.tagName==="BR"){a.insertBefore(this.$4_0,b);a.insertBefore(this.$3_0,this.$4_0)}else{a.appendChild(this.$3_0);a.appendChild(this.$4_0)}else{var c=RTE.Canvas.getEditableRegion(a);if(c===a&&!c.firstChild&&RTE.Canvas.isMultiline(c)){var d=RTE.RteUtility.$4d(c.ownerDocument);c.appendChild(d);return this.moveToStartOfNode(d)}a.appendChild(this.$3_0);a.appendChild(this.$4_0)}this.resetCacheRange();return true},moveToMarkersPlaceholders:function(a,d){ULSNVe:;var e=false;if(a&&a.ownerDocument){var b=a.ownerDocument.getElementById(d+"-start"),c=a.ownerDocument.getElementById(d+"-end");if(b&&c){SP.UI.UIUtility.insertAfter(this.$3_0,b);SP.UI.UIUtility.insertAfter(this.$4_0,c);this.$6t_0(this.$4_0);this.$6t_0(this.$3_0);this.resetCacheRange();e=true}this.$Dx_0(b);this.$Dx_0(c);this.$Lj_0()}return e?true:this.moveToEndOfNode(a)},$Dx_0:function(b){ULSNVe:;if(b){var a=b.parentNode;SP.UI.UIUtility.removeNode(b);RTE.SU.$2(a.tagName)&&!a.childNodes.length&&SP.UI.UIUtility.removeNode(a)}},$6t_0:function(a){ULSNVe:;while(a&&a.parentNode){var b=a.parentNode,c=null;do{c=b.tagName;b=b.parentNode}while(b&&RTE.SU.$2(c));switch(c){case"TABLE":case"TBODY":case"THEAD":case"TR":this.$DJ_0(a,["TD","TH"],"TABLE");break;case"OL":case"UL":this.$DJ_0(a,["LI"],c);break;default:return}}},$Lj_0:function(){ULSNVe:;if(this.$3_0.parentNode!==this.$4_0.parentNode){var b=this.$4_0.parentNode;if(b.tagName==="TD"||b.tagName==="TH")if(b.firstChild===this.$4_0){var a=RTE.RteUtility.$Dm(b);if(!a){var c=RTE.RteUtility.$Dm(b.parentNode);if(c)a=c.children[c.children.length-1]}a&&a.nodeType===1&&(a.tagName==="TD"||a.tagName==="TH")&&a.insertBefore(this.$4_0,null)}}},$DJ_0:function(b,d,e){ULSNVe:;var c=RTE.RteUtility.$G(b,e),a=new RTE.DOMTreePosition(b,0);while(a.moveToNextElement()){if(SP.UI.UIUtility.isNodeOfType(a.$1_0,d)){a.$1_0.insertBefore(b,a.$1_0.firstChild);return}if(a.$1_0===c&&a.atEnd()){SP.UI.UIUtility.insertAfter(b,c);return}}},moveBeforeNode:function(a){ULSNVe:;this.$4l_0();var c=RTE.RteUtility.$m(a,true);if(c&&RTE.RteUtility.$Q(c))return this.moveToEndOfNode(c);if(SP.UI.UIUtility.isNodeOfType(a,RTE.CanvasRange.$7K))return this.moveBeforeNode(a.parentNode);var b=RTE.Canvas.getEditableRegion(a);if(b&&b.firstChild===a&&RTE.Canvas.isMultiline(b)){var d=RTE.RteUtility.$4d(b.ownerDocument);SP.UI.UIUtility.insertBefore(d,a);return this.moveToStartOfNode(d)}SP.UI.UIUtility.insertBefore(this.$4_0,a);SP.UI.UIUtility.insertBefore(this.$3_0,this.$4_0);this.resetCacheRange();return true},moveAfterNode:function(a){ULSNVe:;this.$4l_0();var c=RTE.RteUtility.$t(a,true);if(c&&RTE.RteUtility.$Q(c))return this.moveToStartOfNode(c);if(SP.UI.UIUtility.isNodeOfType(a,RTE.CanvasRange.$7K))return this.moveAfterNode(a.parentNode);var b=RTE.Canvas.getEditableRegion(a);if(b&&b.lastChild===a&&RTE.Canvas.isMultiline(b)){var d=RTE.RteUtility.$4d(b.ownerDocument);SP.UI.UIUtility.insertAfter(d,a);return this.moveToStartOfNode(d)}SP.UI.UIUtility.insertAfter(this.$4_0,a);SP.UI.UIUtility.insertBefore(this.$3_0,this.$4_0);this.resetCacheRange();return true},$4l_0:function(){ULSNVe:;this.$3_0.parentNode&&this.$3_0.parentNode.removeChild(this.$3_0);this.$4_0.parentNode&&this.$4_0.parentNode.removeChild(this.$4_0)},dispose:function(){ULSNVe:;RTE.RteUtility.$J(this.$3_0);RTE.RteUtility.$J(this.$4_0)},clear:function(){ULSNVe:;return this.$62_0()},$62_0:function(){ULSNVe:;if(!RTE.Canvas.currentEditableRegion()||!RTE.Canvas.getIgnoreClear()){RTE.RteUtility.$4N(this.$3_0);RTE.RteUtility.$5h(this.$4_0);if(RTE.RteUtility.isFirefox()){if(RTE.SU.$7(RTE.CanvasRange.$1f)){RTE.CanvasRange.$1f=document.createElement("DIV");RTE.CanvasRange.$1f.style.display="none";document.body.appendChild(RTE.CanvasRange.$1f)}RTE.CanvasRange.$1f.appendChild(this.$3_0);RTE.CanvasRange.$1f.appendChild(this.$4_0)}else this.$4l_0();this.resetCacheRange()}return true},selectAll:function(){ULSNVe:;return this.$Hi_0()},$Hi_0:function(){ULSNVe:;var a=this.getEditableRegion();return a?this.moveToChildren(a):false},isVisible:function(){ULSNVe:;return!this.isEmpty()},insertNode:function(a){ULSNVe:;RTE.RteUtility.$CQ(a,this.$4_0);this.resetCacheRange()},insertBefore:function(a){ULSNVe:;RTE.RteUtility.$CQ(a,this.$3_0);this.resetCacheRange()},insertAfter:function(a){ULSNVe:;RTE.RteUtility.$6S(a,this.$4_0);this.resetCacheRange()},insertText:function(a){ULSNVe:;RTE.DomHelper.insertAdjacentText(this.$4_0,"beforeBegin",a);this.resetCacheRange()},insertTextBefore:function(a){ULSNVe:;RTE.DomHelper.insertAdjacentText(this.$3_0,"beforeBegin",a);this.resetCacheRange()},isEmpty:function(){ULSNVe:;var a=this.$3_0.nextSibling;while(a&&a!==this.$4_0&&(a.nodeValue===""||a.tagName==="SPAN"&&!a.childNodes.length))a=a.nextSibling;return a===this.$4_0},deleteContent:function(){ULSNVe:;if(this.get_isEditable()&&!this.isEmpty()&&this.canDeleteContent()){var i=this.get_isEditableRegion(),e=this.getEditableRegion();RTE.ClientWebPartManager.updateRendererNodes();var f=false;if(i){RTE.ClientWebPartManager.$4m(e);f=true;e.innerHTML="";this.moveToChildren(e)}else{var h=RTE.CanvasRange.$89(this.$3_0),g=RTE.CanvasRange.$89(this.$4_0),c=h.length-1;RTE.RteUtility.assertNotNull("DeleteContent: startMarker parent chain is null",h);RTE.RteUtility.assertNotNull("DeleteContent: endMarker parent chain is null",g);var a=this.$3_0.nextSibling,d=this.$3_0.parentNode;while(a!==this.$4_0){while(!a||c+1<g.length&&a===g[c]){if(a){c++;d=a;a=a.firstChild}else{c--;a=d.nextSibling;d=d.parentNode}if(c<0)return}d=a.parentNode;if(a!==this.$4_0){var b=a;a=a.nextSibling;RTE.ClientWebPartManager.$4m(b);f=true;if(b.nodeType===1&&!Sys.UI.DomElement.containsCssClass(b,"ms-rte-wpbox"))if(typeof b.innerHTML!=="undefined")try{b.innerHTML=""}catch(j){}b.parentNode.removeChild(b)}}RTE.RteUtility.assertNotNull("DeleteContent: Last element is null",a)}f&&RTE.ClientWebPartManager.replaceRenderNodesToCurrent()}},canDeleteContent:function(){ULSNVe:;if(!this.isValid())return false;this.fixMarkers();var c=this.parentElement(),a=new RTE.DOMTreePosition(this.$3_0,0);a.setLocationAtEnd();while(a.$1_0!==this.$4_0){var b=a.$1_0.tagName;if(b==="TABLE"){if(RTE.RteUtility.$b(this.$4_0,a.$1_0,c))return false;a.setLocationAtEnd()}else if(b==="TD"||b==="TH"||b==="TR")return false;if(!a.moveToNextElement())return true}return true},getInnerNodes:function(a){ULSNVe:;return this.$Bu_0(false,a)},$4K_0:null,$80_0:false,getSingleElement:function(){ULSNVe:;if(this.$80_0)return this.$4K_0;this.$80_0=true;var c=this.parentElement(),a=new RTE.DOMTreePosition(this.$3_0,0);a.setLocationAtEnd();a.moveToNextElement();while(a.atEnd()&&!a.atStart())if(!a.moveToNextElement()){this.$4K_0=null;return null}this.$DK_0(a);var b=a.$1_0;if(RTE.RteUtility.$b(this.$4_0,b,c)){this.$4K_0=b;return b}a.setLocationAtEnd();a.moveToNextElement();this.$DK_0(a);while(a.atStart()){if(a.$1_0===this.$4_0){this.$4K_0=b;return b}if(!a.moveToNextElement()){this.$4K_0=null;return null}}this.$4K_0=null;return null},$DK_0:function(b){ULSNVe:;var a=b.$1_0;if(SP.UI.UIUtility.isTextNode(a)&&a.nodeValue===RTE.RteUtility.$2O){b.moveToNextElement();a=b.$1_0}},getReducedInnerNodes:function(a){ULSNVe:;return this.$Bu_0(true,a)},$JY_0:function(f,g,d,e){ULSNVe:;g&&this.$Hh_0();var c=this.getEditableRegion();if(this.$3_0.parentNode===this.$4_0.parentNode&&!RTE.RteUtility.$m(this.$3_0,false)&&!RTE.RteUtility.$t(this.$4_0,false)&&!RTE.Canvas.$i(this.$3_0.parentNode))if(!d(this.$3_0.parentNode,e))return;var b=new RTE.DOMTreePosition(this.$3_0,0);b.setLocationAtEnd();b.moveToNextElement();b.$8h_0=false;while(b.$1_0!==this.$4_0){var a=b.$1_0;if(f)if(a.nextSibling&&SP.UI.UIUtility.isTextNode(a)&&SP.UI.UIUtility.isTextNode(a.nextSibling)){b.moveToNextElement();RTE.RteUtility.$Jh(a,a.nextSibling,false);continue}if(b.atStart()&&(SP.UI.UIUtility.isTextNode(a)||a.nodeType===1&&!RTE.RteUtility.$b(this.$3_0,a,c)&&!RTE.RteUtility.$b(this.$4_0,a,c)&&!RTE.RteUtility.$1P(a)))if(!d(b.$1_0,e))return;b.moveToNextElement()}},$LS_0:function(a,b){ULSNVe:;Array.add(b.nodes,a);return true},$Bu_0:function(b,c){ULSNVe:;if(!this.isValid())return[];var a={};a.nodes=[];this.$JY_0(b,c,this.$$d_$LS_0,a);return a.nodes},getParentChain:function(){ULSNVe:;if(!this.$7y_0){this.$HW_0();this.$7y_0=true}return this.$7x_0},$HW_0:function(){ULSNVe:;this.$7x_0=[];var e=[],a=0;this.$BU_0();var d=false;while(this.$2s_0.length>0&&this.$3k_0.length>0){var b=this.$2s_0.pop(),f=this.$3k_0.pop();if(b===f){if(RTE.Canvas.$i(b))d=true;if(d){e[a]=b;a++}if(RTE.Canvas.$1Q(b))d=false}else break}a--;for(var c=0;c<=a;c++){var g=e[a-c];this.$7x_0[c]=g}},replaceWithChildren:function(a){ULSNVe:;this.deleteContent();var b=RTE.RteUtility.$6L(a);if(!!(b^RTE.RteUtility.$Q(a))){var c=document.createElement(b?"DIV":"SPAN");RTE.RteUtility.$k(a,c);RTE.RteUtility.$J(a);a=c}this.insertNode(a);RTE.Canvas.$4n(a);RTE.RteUtility.removeNodeAndKeepChildNodes(a)},replaceHtml:function(b){ULSNVe:;var a=document.createElement("SPAN");RTE.RteUtility.$2p(a,b);this.replaceWithChildren(a)},convertToText:function(){ULSNVe:;var a=this.get_text();this.deleteContent();this.insertText(a)},convertToStrip:function(){ULSNVe:;var a=RTE.RemoveStyleOnSelectionProcessor.$22;a.setSettings(this,true);a.process()},getFirstTextNode:function(){ULSNVe:;var a=new RTE.DOMTreePosition(this.$3_0,0);a.setLocationAtEnd();var b=null;while(a.moveToNextElement()&&a.$1_0!==this.$4_0)if(RTE.Canvas.$1Q(a.$1_0))a.setLocationAtEnd();else if(SP.UI.UIUtility.isTextNode(a.$1_0)){if(!RTE.RteUtility.$1x(a.$1_0,true))return a.$1_0;b=a.$1_0}return b},$BA_0:null,$7w_0:false,getCurrentStateNode:function(){ULSNVe:;if(this.$7w_0)return this.$BA_0;this.$7w_0=true;var a=this.getFirstTextNode();if(!a)a=this.$3_0;this.$BA_0=a;return a},$L0_0:function(){ULSNVe:;if(!this.$3_0||!this.$3_0.parentNode||this.$3_0.parentNode===RTE.CanvasRange.$1f||!this.$4_0||!this.$4_0.parentNode||this.$4_0.parentNode===RTE.CanvasRange.$1f)return;var b=RTE.Canvas.getEditableRegion(this.$3_0);if(!b||!RTE.Canvas.getCachedRestriction(b,"AllowMultiLines",true))return;var c=this.$1a_0||RTE.Range.createRange();if(c.$B_0.select)return;var a=RTE.CanvasRange.$Cd(this.$3_0),d=RTE.CanvasRange.$Cd(this.$4_0);if(a&&a===d)if(a===-1)this.$3_0.scrollIntoView(true);else this.$4_0.scrollIntoView(false)}};RTE.QuickRange=function(a,b,c,d,e){ULSNVe:;this.$1E_0=a;this.$2r_0=b;this.$l_0=c;this.$2E_0=d;this.$8J_0=e};RTE.QuickRange.$3p=function(){ULSNVe:;var b,d=-1,c,e=-1,a=RTE.Selection.getSelectionRange();if(a&&a.$B_0&&a.$B_0.startContainer){b=a.$B_0.startContainer;d=a.$B_0.startOffset;c=a.$B_0.endContainer;e=a.$B_0.endOffset}else{var g=RTE.Cursor.get_range();b=g.$3_0;c=g.$4_0}if(!b||!c)return null;var f=RTE.Canvas.getEditableRegion(b);return!f?null:new RTE.QuickRange(b,d,c,e,f)};RTE.QuickRange.$Co=function(a){ULSNVe:;return a===RTE.Cursor.s_range.$3_0||a===RTE.Cursor.s_range.$4_0||RTE.RteUtility.$1x(a,true)};RTE.QuickRange.$E5=function(a,b){ULSNVe:;return a.nodeType!==1||b<0||!a.childNodes.length?a:a.childNodes.length<=b?a.lastChild:a.childNodes[b]};RTE.QuickRange.prototype={$1E_0:null,$2r_0:0,$l_0:null,$2E_0:0,$8J_0:null,get_$3w_0:function(){ULSNVe:;return RTE.Canvas.isEditable(this.$1E_0)&&RTE.Canvas.isEditable(this.$l_0)},get_$4y_0:function(){ULSNVe:;var a=this.get_$9Y_0(),b=this.get_$9X_0();return a===b||a===b.previousSibling},get_$9Y_0:function(){ULSNVe:;return RTE.QuickRange.$E5(this.$1E_0,this.$2r_0)},get_$ES_0:function(){ULSNVe:;if(this.$1E_0.nodeType===1&&this.$1E_0===this.$l_0&&this.$2r_0>=0&&this.$2r_0===this.$2E_0-1)return this.get_$9Y_0();if(RTE.RteUtility.$1P(this.$1E_0)&&RTE.RteUtility.$1P(this.$l_0)&&this.$1E_0.parentNode===this.$l_0.parentNode){var a=this.$1E_0.nextSibling;if(a&&a===this.$l_0.previousSibling)return a}return null},get_$9X_0:function(){ULSNVe:;return RTE.QuickRange.$E5(this.$l_0,this.$2E_0)},get_$JQ_0:function(){ULSNVe:;if(this.$2r_0<=0)return true;if(this.$1E_0.nodeType===1){for(var a=this.$2r_0-1;a>=0;a--){var b=this.$1E_0.childNodes[a];if(!RTE.QuickRange.$Co(b))return false}return true}if(this.$1E_0.nodeType===3)if(this.$2r_0===1&&this.$1E_0.nodeValue.length<=1&&RTE.RteUtility.$1x(this.$1E_0,true))return true;return false},get_$Cg_0:function(){ULSNVe:;if(this.$2E_0===-1)return true;if(this.$l_0.nodeType===1){var c=this.$l_0.childNodes.length;if(this.$2E_0===c)return true;for(var d=RTE.RteUtility.$Q(this.$l_0),e=RTE.RteUtility.$1e(this.$l_0,false),b=this.$2E_0;b<c;b++){var a=this.$l_0.childNodes[b];if(d&&e===a&&a.nodeType===1&&a.tagName==="BR")return true;if(!RTE.QuickRange.$Co(a))return false}return true}if(this.$l_0.nodeType===3){if(this.$2E_0>=this.$l_0.nodeValue.length)return true;if(this.$2E_0+1===this.$l_0.nodeValue.length&&RTE.RteUtility.$6U(this.$l_0.nodeValue.substr(this.$l_0.nodeValue.length-1),true))return true}return false}};RTE.ClientWebPartManager=function(){};RTE.ClientWebPartManager.$4r=function(){ULSNVe:;return window.vwpcm};RTE.ClientWebPartManager.init=function(){ULSNVe:;if(!RTE.ClientWebPartManager.$9e){RTE.CanvasEvents.registerListener("ElementAdded",RTE.ClientWebPartManager.$K2);RTE.CanvasEvents.registerListener("ElementGenerateTag",RTE.ClientWebPartManager.$K5);RTE.ClientWebPartManager.$9e=true}};RTE.ClientWebPartManager.$K2=function(f,e){ULSNVe:;if(!e)return;var a=e.node;if(!a)return;var c=RTE.ClientWebPartManager.$4r();if(!c||!c.rgparts)return;var d=RTE.RteUtility.$6F(a);if(!RTE.SU.$2(d)){var b=c.rgparts[d];!RTE.SU.$7(b)&&b.render&&a!==b.render&&a.parentNode.replaceChild(b.render,a)}};RTE.ClientWebPartManager.$K5=function(h,d){ULSNVe:;if(!d)return;var a=d.node,e=d.html;if(!a||!e)return;var f=RTE.ClientWebPartManager.$4r();if(!f||!f.rgparts)return;var g=RTE.RteUtility.$6F(a);if(!RTE.SU.$2(g)){var b=[],c=a.className;if(c)a.className=c.replace("ms-rtegenerate-notify","");RTE.RteUtility.$34(b,a);RTE.RteUtility.$6E(b,a.tagName.toLowerCase());a.className=c;e.append(b.join(""))}};RTE.ClientWebPartManager.$KY=function(){ULSNVe:;eval("if (typeof(refreshAllWebParts) != 'undefined' && refreshAllWebParts) { refreshAllWebParts(); }")};RTE.ClientWebPartManager.$4m=function(a){ULSNVe:;a&&a.nodeType===1&&RTE.RteUtility.forEachChildWithTagAndClass(a,"DIV","ms-rte-wpbox",function(b){ULSNVe:;if(b.childNodes.length>0){var a=b.childNodes[0],c=0;while(SP.UI.UIUtility.isTextNode(a)&&c<b.childNodes.length-1){c++;a=b.childNodes[c]}if(!SP.UI.UIUtility.isTextNode(a)&&a.id.length===40&&RTE.RteUtility.$6V(a)){var d=a.cloneNode(false);b.replaceChild(d,a)}}})};RTE.ClientWebPartManager.updateRendererNodes=function(){ULSNVe:;var b=RTE.ClientWebPartManager.$4r();if(!b||!b.rgparts)return;var d=b.rgparts;for(var e in d){var f={key:e,value:d[e]},g=f.key,c=f.value;if(!RTE.RteUtility.$Cc(c.render)){var a=$get("div_"+g);if(a&&a!==c.render&&a.firstChild)c.render=a}}};RTE.ClientWebPartManager.replaceRenderNodesToCurrent=function(){ULSNVe:;var b=RTE.ClientWebPartManager.$4r();if(!b||!b.rgparts)return;var d=b.rgparts;for(var e in d){var f={key:e,value:d[e]},g=f.key,c=f.value,a=$get("div_"+g);a&&a!==c.render&&!RTE.RteUtility.$Cc(c.render)&&a.parentNode.replaceChild(c.render,a)}RTE.ClientWebPartManager.$KY()};RTE.RibbonCommandNames=function(){};RTE.CommandNames=function(){};RTE.Cursor=function(){};RTE.Cursor.cursorRangeIsNowOutdated=function(){ULSNVe:;RTE.Cursor.$23=true};RTE.Cursor.get_isRangeOutdatedFromCurrentSelection=function(){ULSNVe:;return RTE.Cursor.$23};RTE.Cursor.get_range=function(){ULSNVe:;RTE.Cursor.$23&&!RTE.Cursor.$3s&&RTE.Cursor.$A1(RTE.Cursor.$4O);return RTE.Cursor.s_range};RTE.Cursor.onKeyPress=function(a){ULSNVe:;if(!RTE.RteUtility.$2b(a.target))return;if(RTE.Cursor.$7I){SP.UI.UIUtility.cancelEvent(a);return}RTE.Canvas.invokeInAutoComplete(function(b){ULSNVe:;return b.onKeyPress(a)});var e=true,h=RTE.Canvas.currentEditableRegion(),f=RTE.Canvas.getCachedRestriction(h,"AllowMultiLines",true);if(!a.altKey&&!a.ctrlKey&&a.charCode===13)if(RTE.Canvas.moveToRedirectIfItExist(a.target)||!f)SP.UI.UIUtility.cancelEvent(a);else{var d=RTE.QuickRange.$3p();e=false;if(d&&d.get_$3w_0()){var c=RTE.RteUtility.$8T(d.$1E_0),b=c?c.tagName.toUpperCase():null;if(c&&!RTE.SU.$2(b)&&(b==="H1"||b==="H2"||b==="H3"||b==="H4"||b==="H5"||b==="H6")&&!RTE.RteUtility.$JK(c,true)&&RTE.Canvas.isEditable(c)){var g=c.parentNode;window.setTimeout(function(){ULSNVe:;var d=RTE.Cursor.get_range(),b=RTE.RteUtility.$8T(d.parentElement());if(b){if(b.parentNode===g){var f=b.innerText||b.textContent;if(!RTE.RteUtility.$6U(f,true))return}else if(b===g){var c=d.$3_0;while(c.previousSibling&&c.previousSibling.tagName.toUpperCase()==="BR")c.parentNode.removeChild(c.previousSibling)}else return;RTE.FontCommands.$B6("P","");if(RTE.RteUtility.isFirefox()){var a=RTE.RteUtility.$8T(d.parentElement());if(a&&a.tagName==="P"&&a.childNodes.length<=2){var e=a.lastChild;if(!e||e.nodeType!==1||e.tagName!=="BR"){var h=a.ownerDocument.createElement("BR");a.appendChild(h)}}}}},0)}}}if(f)RTE.Cursor.waitAndUpdateRangeToCurrentSelection(e,RTE.Canvas.$3i);else RTE.Cursor.waitAndUpdateRangeToCurrentSelection(true,200)};RTE.Cursor.onKeyUp=function(a){ULSNVe:;RTE.Canvas.$3j=false;var b=RTE.RteUtility.$2b(a.target);if(!b)return;if(RTE.Cursor.$3s)a.keyCode===13&&RTE.CanvasEvents.dispatchChanged();else(a.keyCode===16||a.keyCode===17)&&RTE.Cursor.waitAndUpdateRangeToCurrentSelection(false,RTE.Canvas.$3i);RTE.Cursor.$7f&&a.keyCode===17&&RTE.PasteFlyout.expandOptions();RTE.Cursor.$7f=false;RTE.Canvas.invokeInAutoComplete(function(b){ULSNVe:;return b.onKeyUp(a)})};RTE.Cursor.$LZ=function(a){ULSNVe:;if(RTE.RteUtility.$JF(a.rawEvent))return;if(a.keyCode===38||a.keyCode===40||a.keyCode===39||a.keyCode===37){if(a.shiftKey||a.ctrlKey||a.altKey)return;var h=RTE.Canvas.get_$R()||RTE.CanvasEvents.getNodeFromEvent("Image");if(!h&&RTE.Selection.isControlRangeSelection()&&RTE.RteUtility.isInternetExplorer()){if(RTE.Cursor.s_range.get_$6Y_0()){var t=RTE.QuickRange.$3p();if(t&&t.get_$3w_0())h=t.get_$ES_0()}if(!h)h=RTE.Cursor.$I7(RTE.Cursor.s_range.$3_0.nextSibling)}if(h){if(a.keyCode===40||a.keyCode===39)RTE.Cursor.get_range().moveAfterNode(h);else RTE.Cursor.get_range().moveBeforeNode(h);SP.UI.UIUtility.cancelEvent(a);RTE.Canvas.$5Z(null);RTE.Cursor.update();return}if(a.keyCode===38||a.keyCode===40){var n=RTE.QuickRange.$3p();if(!n||!n.get_$3w_0())return;var o=n.get_$9X_0(),p=n.get_$Cg_0(),f=RTE.RteUtility.$2d(o,["TD","TH"]);if(f&&RTE.Canvas.isEditable(f)){var j=f.parentNode,d=a.keyCode===40;if(RTE.RteUtility.isSafari()){var G=d?RTE.RteUtility.$1e(j,true):RTE.RteUtility.$1w(j,true);if(G!==f)return}var F=d?RTE.RteUtility.$1e(j.parentNode,true):RTE.RteUtility.$1w(j.parentNode,true);if(F!==j)return;var b=o,z=true;p=p||!d;while(b!==f){if(!p&&b!==f&&(RTE.RteUtility.$Q(b)||b.nodeType===1&&b.tagName==="BR")){z=false;break}p=false;var q=d?b.nextSibling:b.previousSibling;while(!q){b=b.parentNode;if(b===f){q=b;break}q=d?b.nextSibling:b.previousSibling}b=q}if(z){!RTE.Cursor.s_range.isValid()&&!RTE.Cursor.$23&&RTE.Cursor.cursorRangeIsNowOutdated();var u=RTE.Cursor.get_range();if(!u.isValid())return;var c=o.ownerDocument.createElement("SPAN");c.appendChild(o.ownerDocument.createTextNode(RTE.RteUtility.$3U));u.$4_0.parentNode.insertBefore(c,u.$4_0.nextSibling);var A=c.offsetTop+c.clientHeight,g=f;while(true){var w=d?RTE.RteUtility.$1e(g,false):RTE.RteUtility.$1w(g,false);if(!w||!RTE.RteUtility.$Q(w))break;g=w}if(d&&g.lastChild!==c)g.appendChild(c);else!d&&g.firstChild!==c&&g.insertBefore(c,g.firstChild);A-=c.offsetTop+c.clientHeight;c.parentNode.removeChild(c);if(A)return;var v=RTE.RteUtility.$G(j,"TABLE");if(RTE.Canvas.isEditable(v))if(d)RTE.Cursor.get_range().moveAfterNode(v);else RTE.Cursor.get_range().moveBeforeNode(v);SP.UI.UIUtility.cancelEvent(a);RTE.Cursor.update();return}}}}if(a.keyCode===8||a.keyCode===127){var e=RTE.QuickRange.$3p();if(!e||!e.get_$3w_0())return;var r=e.get_$ES_0(),B=r;if(!r)if(e.get_$JQ_0()&&e.get_$Cg_0()){r=e.$1E_0;B=e.$l_0}else return;var C=RTE.RteUtility.$Bo(r,e.$8J_0,true),D=RTE.RteUtility.$Bo(B,e.$8J_0,false);if(!C||!D)return;var l=null,m=null,x,y;RTE.Cursor.$Kx(C,D,x={val:l},y={val:m}),l=x.val,m=y.val;if(l&&m){if(a.keyCode===8)RTE.Cursor.get_range().moveBeforeNode(l);else RTE.Cursor.get_range().moveAfterNode(m);RTE.Cursor.select();var H=m.nextSibling,s=l,k=null,E=false;while(s!==H){var i=s;s=s.nextSibling;if(RTE.Canvas.setTableWidths&&i.tagName==="TR"){if(!k){k=RTE.RteUtility.$G(i,"TABLE");E=RTE.RteUtility.$1w(i.parentNode,true)===i&&RTE.TableCommands.hasHeaderRow(k)}RTE.TableCommands.$CT(i,k,false)}else i.parentNode.removeChild(i)}k&&RTE.TableCommands.$CY(E,k);RTE.Cursor.update();SP.UI.UIUtility.cancelEvent(a);return}}};RTE.Cursor.$I7=function(a){ULSNVe:;if(a&&a.nodeType===1){var b=a.tagName;if(b==="TBODY"||b==="THEAD"||b==="TH"||b==="TR"||b==="TD")return RTE.RteUtility.$G(a,"TABLE")||a}return a};RTE.Cursor.$Kx=function(e,f,d,g){ULSNVe:;d.val=null;g.val=null;for(var h=Math.min(e.length,f.length),c=1;c<h;c++){var a=e[c],b=f[c];if(a&&b&&a.parentNode===b.parentNode)if(!d.val&&RTE.Cursor.$C9(a)&&RTE.Cursor.$C9(b)||d.val&&a===b&&RTE.Cursor.$Ij(a)){d.val=a;g.val=b}}};RTE.Cursor.$Ij=function(b){ULSNVe:;if(b.nodeType===1){var a=b.tagName;return a==="HR"||a==="IMG"}return false};RTE.Cursor.$C9=function(b){ULSNVe:;if(b.nodeType===1){var a=b.tagName;return a==="TABLE"||a==="TR"||a==="P"||a==="H1"||a==="H2"||a==="H3"||a==="H4"||a==="H5"||a==="H6"||a==="DIV"||a==="OL"||a==="UL"||a==="HR"||a==="IMG"}return false};RTE.Cursor.onKeyDown=function(a){ULSNVe:;RTE.Cursor.$7I=false;RTE.Canvas.$3j=true;var b=a.target,g=RTE.RteUtility.$2b(b);if(!g||!RTE.Canvas.isInEditable(b)){if(a.keyCode===8&&!RTE.Canvas.$3v(b.tagName)&&!RTE.RteUtility.$JE(b))SP.UI.UIUtility.cancelEvent(a);else a.keyCode===9&&g&&RTE.Cursor.waitAndUpdateRangeToCurrentSelection(false,RTE.Canvas.$3i);return}if(a.keyCode!==8&&a.keyCode!==127)RTE.Cursor.$4L=true;RTE.Canvas.invokeInAutoComplete(function(b){ULSNVe:;if(b.onKeyDown(a)){SP.UI.UIUtility.cancelEvent(a);RTE.Cursor.$7I=true;return true}return false});RTE.ShortcutKeys.initializeDictionary();RTE.MovementKeys.initializeDictionary();RTE.SelectionClearingKeys.initializeDictionary();var c=RTE.MovementKeys.isMovementKey(a);if(c){if((a.keyCode===38||a.keyCode===40)&&RTE.Canvas.getIgnoreUpDownArrows()){SP.UI.UIUtility.cancelEvent(a);return}if(9===a.keyCode)RTE.Cursor.onKeyDownTabKey(a);else{if(RTE.RteUtility.isSafari()&&(a.keyCode===37||a.keyCode===39))RTE.Cursor.$9W();else if(a.keyCode===8||a.keyCode===127){if(RTE.Cursor.$4L){RTE.SnapshotManager.takeSnapshot();RTE.Cursor.$4L=false}RTE.Cursor.$4a();if(!RTE.Canvas.$3v(a.target.tagName))if(RTE.Canvas.get_$R()){RTE.SnapshotManager.$1y(RTE.Canvas.currentEditableRegion())&&RTE.SnapshotManager.takeSnapshot();if(a.keyCode===8)RTE.Cursor.get_range().moveBeforeNode(RTE.Canvas.get_$R());else RTE.Cursor.get_range().moveAfterNode(RTE.Canvas.get_$R());RTE.RteUtility.$J(RTE.Canvas.get_$R());RTE.Cursor.update();SP.UI.UIUtility.cancelEvent(a)}else if(RTE.RteUtility.isInternetExplorer()){var f=RTE.QuickRange.$3p();if(f&&f.get_$3w_0()&&!f.get_$4y_0()){var i=RTE.Cursor.get_range();if(i.isValid()){var j=i.parentElement();if(j){RTE.ClientWebPartManager.updateRendererNodes();RTE.ClientWebPartManager.$4m(j);window.setTimeout(RTE.ClientWebPartManager.replaceRenderNodesToCurrent,0)}}}}}RTE.Cursor.s_range.isValid()&&RTE.Cursor.s_range.isEmpty()&&RTE.Cursor.s_range.$62_0()}}var h=RTE.SelectionClearingKeys.isSelectionClearKey(a),d=h;if(RTE.Cursor.$4L&&h&&RTE.Selection.get_hasSelection()){RTE.SnapshotManager.takeSnapshot();RTE.Cursor.$4L=false}RTE.Cursor.$LZ(a);RTE.Cursor.$3s=false;if(a.keyCode===229){RTE.Cursor.$3s=true;RTE.Cursor.$4a()}else if(a.keyCode===16||a.keyCode===17||c&&(a.ctrlKey||a.shiftKey)&&a.keyCode!==9||a.ctrlKey)RTE.Cursor.$4a();else RTE.Cursor.waitAndUpdateRangeToCurrentSelection(!c,RTE.Canvas.$3i);var e=RTE.ShortcutKeys.getShortcut(a);if(!RTE.SU.$7(e)){d=false;if(RTE.RichTextEditorComponentProvider.get_latestProvider().canHandleCommand(e))if(RTE.RichTextEditorComponentProvider.get_latestProvider().handleCommand(e,null,0)){SP.UI.UIUtility.cancelEvent(a);RTE.Canvas.$L3()}}RTE.Cursor.$7f=a.keyCode===17;RTE.PasteFlyout.collapseOptions();(d&&a.keyCode!==9||a.keyCode===27)&&RTE.PasteFlyout.hide();if(d){RTE.SnapshotManager.setRegionDirty(RTE.Canvas.currentEditableRegion());RTE.DirtyBitManager.$BG()}else c&&!RTE.PasteFlyout.get_isVisible()&&RTE.SnapshotManager.$1y(RTE.Canvas.currentEditableRegion())&&RTE.SnapshotManager.takeSnapshot()};RTE.Cursor.onKeyDownTabKey=function(d){ULSNVe:;RTE.RteUtility.assertNotNull("evt",d);var b=false,e=!d.shiftKey,c=null,a=RTE.Cursor.$1G(["TD","TH","LI"]);if(a&&RTE.Canvas.isInEditable(a)){if(a.tagName==="TD"||a.tagName==="TH")c=new RTE.TableKeyTabProcessor(e);else if(a.tagName==="LI"){if(e)RTE.RichTextEditor.increaseIndent();else RTE.RichTextEditor.decreaseIndent();b=true}a=a.parentNode}if(c)b=c.process();b&&SP.UI.UIUtility.cancelEvent(d);return b};RTE.Cursor.cut=function(){ULSNVe:;RTE.Cursor.select();try{RTE.Canvas.$6B("cut");RTE.Cursor.waitAndUpdateRangeToCurrentSelection(true,0)}catch(a){alert(SP.Res.errorClipboard)}};RTE.Cursor.copy=function(){ULSNVe:;RTE.Cursor.select();try{RTE.Canvas.$6B("copy")}catch(a){alert(SP.Res.errorClipboard)}};RTE.Cursor.get_pasteInProgress=function(){ULSNVe:;return RTE.Cursor.$14};RTE.Cursor.paste=function(a){ULSNVe:;RTE.Cursor.$48=a;try{var b=RTE.Selection.getSelectionRange(),c=b.parentElement();if(!RTE.Canvas.isEditable(c))RTE.Canvas.$6B("paste");else RTE.Cursor.$CI()}catch(d){alert(SP.Res.errorClipboard);RTE.Cursor.$1g();return}};RTE.Cursor.$DV=function(a){ULSNVe:;RTE.RteUtility.isSafari()&&!RTE.Cursor.allowSafariDragAndDrop&&SP.UI.UIUtility.cancelEvent(a);RTE.Cursor.$69=RTE.Canvas.getEditableRegion(a.target);if(RTE.Cursor.$69){RTE.Cursor.updateRangeToCurrentSelection();RTE.Cursor.$4I=true;RTE.SnapshotManager.takeEditableRegionSnapshot(RTE.Cursor.$69);var b=RTE.RteUtility.$G(a.target,"A");if(b){a.rawEvent.dataTransfer.dropEffect="None";a.rawEvent.dataTransfer.effectAllowed="None"}}};RTE.Cursor.$K0=function(b){ULSNVe:;RTE.Cursor.$4I=false;var a=RTE.Canvas.getEditableRegion(b.target);if(!a)return;if(!RTE.RteUtility.isInternetExplorer()){RTE.SnapshotManager.setRegionDirty(a);RTE.SnapshotManager.takePartialSnapshot(a)}RTE.Canvas.onMouseUp(b)};RTE.Cursor.$DW=function(a){ULSNVe:;var b=RTE.Canvas.getEditableRegion(a.target);if(!b)return;RTE.Cursor.cursorRangeIsNowOutdated();if(RTE.Cursor.$4I){!RTE.RteUtility.isInternetExplorer()&&RTE.Cursor.$7o();window.setTimeout(RTE.Cursor.$DS,0)}else if(RTE.RteUtility.isInternetExplorer())SP.UI.UIUtility.cancelEvent(a);else RTE.Cursor.$DY(a,true)};RTE.Cursor.$KC=function(a){ULSNVe:;if(!RTE.Canvas.isEditable(a.target))return;RTE.Cursor.$4X=false;try{if(RTE.RteUtility.isInternetExplorer()){RTE.Cursor.$CI();SP.UI.UIUtility.cancelEvent(a)}else RTE.Cursor.$DY(a,false)}catch(b){RTE.Cursor.$14=false;RTE.Cursor.$1V=0;SP.UI.UIUtility.cancelEvent(a);RTE.Cursor.$1g()}};RTE.Cursor.$Jx=function(a){ULSNVe:;if(!SP.UI.UIUtility.focusValidOnThisNode(a.target))return;RTE.Cursor.updateRangeToCurrentSelection()};RTE.Cursor.$Jy=function(c){ULSNVe:;if(!SP.UI.UIUtility.focusValidOnThisNode(c.target))return;RTE.Cursor.updateRangeToCurrentSelection();var b=RTE.Cursor.get_range();if(!b.isEmpty()){var a=RTE.Canvas.currentEditableRegion();RTE.SnapshotManager.$1y(a)&&RTE.SnapshotManager.takeSnapshot();if(RTE.RteUtility.isInternetExplorer()){RTE.ClientWebPartManager.updateRendererNodes();RTE.ClientWebPartManager.$4m(a);RTE.Cursor.select()}window.setTimeout(function(){ULSNVe:;RTE.Cursor.updateRangeToCurrentSelection();RTE.RteUtility.isInternetExplorer()&&RTE.ClientWebPartManager.replaceRenderNodesToCurrent();RTE.SnapshotManager.takeSnapshot()},0)}};RTE.Cursor.$DY=function(b,a){ULSNVe:;try{if(!a&&RTE.Cursor.$14){SP.UI.UIUtility.cancelEvent(b);return}RTE.Cursor.$9w();RTE.Cursor.$DU(b,a);RTE.Cursor.$14=true;RTE.Cursor.$7o();if(a)window.setTimeout(RTE.Cursor.$DS,0);else window.setTimeout(RTE.Cursor.$KG,0)}catch(c){RTE.Cursor.$1g();throw c;}};RTE.Cursor.$KG=function(){ULSNVe:;SP.UI.UIUtility.insertAfter(RTE.Cursor.$K,RTE.Cursor.$L.$3_0);RTE.Cursor.$L.resetCacheRange();RTE.Cursor.s_range.moveAfterNode(RTE.Cursor.$K);RTE.ScrollPosition.$7k(RTE.Cursor.$70);RTE.Cursor.$70=null;RTE.RteUtility.forEachChildWithTagAndClass(RTE.Cursor.$K,"div","ms-rte-pasteremove",function(a){ULSNVe:;if(a!==RTE.Cursor.$K){RTE.Cursor.$9U(a.lastChild);do{var b=a.parentNode;b=b.firstChild===b.lastChild?b:null;RTE.RteUtility.removeNodeAndKeepChildNodes(a);a=b}while(a&&a!==RTE.Cursor.$K&&RTE.RteUtility.$JN(a))}});RTE.Cursor.$9U(RTE.Cursor.$K.firstChild);RTE.Cursor.$9U(RTE.Cursor.$K.lastChild);RTE.Cursor.$Bc(RTE.Cursor.$K);var a=RTE.Cursor.$48;RTE.Cursor.$48=null;RTE.Cursor.s_range.moveAfterNode(RTE.Cursor.$K);RTE.RtePasteManager.$9N(RTE.Cursor.$K,false,a,function(){ULSNVe:;SP.UI.UIUtility.insertBefore(RTE.Cursor.s_range.$3_0,RTE.Cursor.$K);if(!RTE.RteUtility.$6L(RTE.Cursor.$K)){var a=document.createElement("SPAN");RTE.RteUtility.$k(RTE.Cursor.$K,a);RTE.RteUtility.$J(RTE.Cursor.$K);RTE.RteUtility.$6S(a,RTE.Cursor.s_range.$3_0);RTE.Cursor.$K=a}else{RTE.Cursor.$K.parentNode.removeChild(RTE.Cursor.$K);RTE.RteUtility.$6S(RTE.Cursor.$K,RTE.Cursor.s_range.$3_0)}SP.UI.UIUtility.insertBefore(RTE.Cursor.$L.$3_0,RTE.Cursor.$K);SP.UI.UIUtility.insertAfter(RTE.Cursor.$L.$4_0,RTE.Cursor.$K);RTE.Cursor.$L.resetCacheRange();RTE.Canvas.$4n(RTE.Cursor.$K);RTE.RteUtility.removeNodeAndKeepChildNodes(RTE.Cursor.$K);RTE.Cursor.$K=null;RTE.Cursor.$DT()})};RTE.Cursor.$Bc=function(a){ULSNVe:;RTE.RteUtility.forEachChildWithTagAndClass(a,"LI",null,function(b){ULSNVe:;if(b.parentNode===a){var c=b.parentNode.tagName;if(c!=="OL"&&c!=="UL"){var d=a.ownerDocument.createElement("UL"),e=b.parentNode;RTE.RteUtility.$k(e,d);e.appendChild(d)}}else b.parentNode.tagName==="SPAN"&&(b.parentNode.parentNode.tagName==="OL"||b.parentNode.parentNode.tagName==="UL")&&RTE.RteUtility.removeNodeAndKeepChildNodes(b.parentNode)})};RTE.Cursor.$9U=function(a){ULSNVe:;if(a&&a.nodeType===3){var b=a.nodeValue;(b===RTE.RteUtility.$3U||b===String.fromCharCode(8203))&&RTE.RteUtility.$J(a)}};RTE.Cursor.$EP=function(a){ULSNVe:;if(!RTE.Cursor.$3X)if(RTE.RteUtility.isClassAvailable("SP.UI.ModalDialog"))RTE.Cursor.$3X=SP.UI.ModalDialog.showWaitScreenWithNoClose(a)};RTE.Cursor.$CE=function(){ULSNVe:;if(RTE.Cursor.$3X){RTE.Cursor.$3X.close(1);RTE.Cursor.$3X=null}};RTE.Cursor.$9w=function(){ULSNVe:;RTE.Cursor.$EP(SP.Res.pasteWaitScreenText);RTE.Cursor.$4X=false};RTE.Cursor.$1g=function(){ULSNVe:;!RTE.Cursor.$1V&&RTE.Cursor.$CE()};RTE.Cursor.onPasteWaitingScreenCallback=function(a){ULSNVe:;if(!a){RTE.Cursor.$4X=true;RTE.Cursor.$3X=null;RTE.Cursor.$14=false;RTE.Cursor.$1V=0;RTE.RtePasteManager.cancelCurrentPaste()}};RTE.Cursor.$9O=function(a){ULSNVe:;if(!RTE.Cursor.$X){RTE.Cursor.$X=document.createElement("IFRAME");RTE.Cursor.$X.src=SP.Utilities.Utility.get_layoutsLatestVersionUrl()+"blank.htm";RTE.Cursor.$X.style.display="none";RTE.Cursor.$X.style.width="1px";RTE.Cursor.$X.style.height="1px";RTE.Cursor.$X.style.position="absolute";RTE.Cursor.$X.style.zIndex=-100;document.body.appendChild(RTE.Cursor.$X)}RTE.Cursor.$7E(a)};RTE.Cursor.$7E=function(i){ULSNVe:;RTE.Cursor.$X.contentWindow.document.designMode="On";RTE.Cursor.$X.contentWindow.document.open("text/html","replace");RTE.Cursor.$X.contentWindow.document.write('<DIV id="pasteDiv">'+String.fromCharCode(8203)+"</DIV>");RTE.Cursor.$X.contentWindow.document.close("");if(i){var c=RTE.Cursor.$X.contentDocument||RTE.Cursor.$X.contentWindow.document,d=c?c.getElementsByTagName("head"):null;if(d&&d.length>0)for(var g=d[0],f=document.styleSheets,h=f.length,e=0;e<h;e++){var a=f[e];if(a&&!RTE.SU.$2(a.href)){var b=c.createElement("LINK");b.type=a.type;b.rel="stylesheet";b.href=a.href;g.appendChild(b)}}}};RTE.Cursor.$CI=function(){ULSNVe:;if(!RTE.RteUtility.isInternetExplorer()&&RTE.Cursor.$3P&&!RTE.Cursor.$49)throw Error.invalidOperation("Can't access clipboard");if(RTE.Cursor.$14){RTE.Cursor.$1V++;return}var a=RTE.Cursor.get_range();if(a.isValid()){var b=true,c=window.self.clipboardData;if(!RTE.SU.$7(c)){var d=c.getData("Text");if(!RTE.SU.$7(d))if(d.length<3e3)b=false}b&&RTE.Cursor.$9w();RTE.Cursor.$1V++;RTE.Cursor.$14=true;if(RTE.RteUtility.isInternetExplorer()||RTE.Cursor.$3P&&RTE.Cursor.$49){a.deleteContent();window.setTimeout(RTE.Cursor.$9Q,10)}else RTE.Cursor.$9Q()}};RTE.Cursor.$9Q=function(){ULSNVe:;try{if(RTE.Cursor.$4X)return;RTE.Cursor.$1V--;RTE.Cursor.$14=true;RTE.Cursor.$9O(true);RTE.Cursor.$X.style.display="";var a=RTE.Cursor.$X.contentWindow.document,d=a.body,e=RTE.DomHelper.createRange(a),b=new RTE.Range(e);b.moveToElementText(d);b.select();a.execCommand("paste",false,null);RTE.Cursor.updateRangeToCurrentSelectionWithOptions(true);var c=RTE.Cursor.get_range(),f=c.$1d_0();c.deleteContent();f.select();RTE.Cursor.$X.style.display="none";RTE.Cursor.$49=true;RTE.Cursor.$3P=true;RTE.Cursor.$KN()}catch(g){RTE.Cursor.$3P&&RTE.Cursor.$49&&RTE.Cursor.$1g();RTE.Cursor.$X.style.display="none";RTE.Cursor.$7E(true);if(!RTE.Cursor.$3P){RTE.Cursor.$3P=true;RTE.Cursor.$49=false}RTE.Cursor.$14=false;RTE.Cursor.$1V=0;throw g;}};RTE.Cursor.$KN=function(){ULSNVe:;try{var b=RTE.Cursor.$X.contentWindow.document.body,c=b.childNodes,a;if(c.length===1&&c[0].id==="pasteDiv")a=c[0];else{a=b.ownerDocument.createElement("DIV");RTE.RteUtility.$k(b,a);b.appendChild(a)}var d=RTE.Cursor.$48;RTE.Cursor.$48=null;RTE.Cursor.$Bc(a);RTE.RtePasteManager.$9N(a,false,d,function(){ULSNVe:;try{RTE.RteUtility.removeNodeAndKeepChildNodes(a);RTE.Cursor.$KO();RTE.Cursor.$8O();RTE.Cursor.$9O(true);window.setTimeout(function(){ULSNVe:;RTE.Cursor.$DT();if(RTE.Cursor.$1V>0){RTE.PasteFlyout.hide();RTE.Cursor.$Di();RTE.Cursor.$9Q()}},0)}catch(b){RTE.Cursor.$7E(false);RTE.Cursor.$14=false;RTE.Cursor.$1V=0;RTE.Cursor.$1g();throw b;}})}catch(e){RTE.Cursor.$7E(false);RTE.Cursor.$14=false;RTE.Cursor.$1V=0;RTE.Cursor.$1g();throw e;}};RTE.Cursor.$KO=function(){ULSNVe:;var b=RTE.Cursor.$X.contentWindow.document.body,a=RTE.Cursor.get_range();a.replaceHtml(RTE.RteUtility.$4B(b.innerHTML,false,false));SP.UI.UIUtility.insertAfter(RTE.Cursor.$L.$3_0,a.$3_0);SP.UI.UIUtility.insertBefore(RTE.Cursor.$L.$4_0,a.$4_0);RTE.Cursor.$L.resetCacheRange();a.collapse(false);RTE.Cursor.select()};RTE.Cursor.$Js=function(a){ULSNVe:;RTE.RteUtility.isInternetExplorer()&&RTE.Cursor.$DU(a,false)};RTE.Cursor.$DU=function(a,d){ULSNVe:;if(!RTE.Canvas.isEditable(a.target)||RTE.Cursor.ignoreBeforePasteOrDrop){a.rawEvent.returnValue=true;return}if(RTE.Cursor.$14){SP.UI.UIUtility.cancelEvent(a);a.rawEvent.returnValue=false}var b=a.rawEvent.rangeParent,c=a.rawEvent.rangeOffset;if(b&&c){var e=new RTE.DOMTreePosition(b,c);e.insertMarker(RTE.Cursor.get_range().$3_0);RTE.Cursor.get_range().collapse(true)}else RTE.Cursor.updateRangeToCurrentSelectionWithOptions(true);if(RTE.Cursor.get_range().isValid()){(d||!RTE.PasteFlyout.get_isVisible())&&RTE.SnapshotManager.takeSnapshot();RTE.Cursor.$8O();RTE.Cursor.$L.resetCacheRange();RTE.Cursor.$81();if(d||RTE.RteUtility.isInternetExplorer())RTE.Cursor.$Di();else RTE.Cursor.$KK();a.rawEvent.returnValue=true}else{SP.UI.UIUtility.cancelEvent(a);a.rawEvent.returnValue=false}};RTE.Cursor.$KK=function(){ULSNVe:;var a=RTE.Cursor.get_range();a.deleteContent();var b=a.getEditableRegion();RTE.Cursor.$70=RTE.ScrollPosition.$7t(b);RTE.Cursor.$K=document.createElement("DIV");RTE.Cursor.$K.setAttribute("contentEditable","true");RTE.Cursor.$K.className="ms-rte-pasteremove";RTE.Cursor.$K.style.width="1px";RTE.Cursor.$K.style.height="1px";RTE.Cursor.$K.style.overflow="hidden";SP.UI.UIUtility.insertAfter(RTE.Cursor.$L.$4_0,a.$4_0);SP.UI.UIUtility.insertAfter(RTE.Cursor.$L.$3_0,a.$4_0);if(RTE.RteUtility.isFirefox())b.appendChild(RTE.Cursor.$K);else SP.UI.UIUtility.insertAfter(RTE.Cursor.$K,b);var c=RTE.Range.createRange();c.moveToElementText(RTE.Cursor.$K);RTE.Range.$9n(c.$B_0)};RTE.Cursor.$Di=function(){ULSNVe:;var a=RTE.Cursor.get_range();a.insertBefore(RTE.Cursor.$L.$3_0);document.body.appendChild(RTE.Cursor.$L.$4_0)};RTE.Cursor.$K6=function(d){ULSNVe:;var a=d.target;if(!d.target)return;if(RTE.Cursor.$4I){var b=a.id;if(b&&b.indexOf("ms-rterangecursor")!==-1){var c=RTE.Cursor.get_range();a!==c.$3_0&&a!==c.$4_0&&RTE.RteUtility.removeNodeAndKeepChildNodes(a)}}};RTE.Cursor.$7o=function(){ULSNVe:;if(!RTE.Cursor.$4v){RTE.Cursor.$4v=true;RTE.RteUtility.$s("DOMNodeInserted",RTE.Cursor.$8l)}};RTE.Cursor.$BE=function(){ULSNVe:;if(RTE.Cursor.$4v){RTE.RteUtility.$BF("DOMNodeInserted",RTE.Cursor.$8l);RTE.Cursor.$4v=false}};RTE.Cursor.$K1=function(a){ULSNVe:;if(!RTE.Canvas.isInEditable(a.target))return;if(!RTE.Cursor.$4I)if(RTE.RteUtility.isInternetExplorer()){SP.UI.UIUtility.cancelEvent(a);a.rawEvent.dataTransfer.dropEffect="None"}else{RTE.Cursor.$7o();window.setTimeout(RTE.Cursor.$Fo,200);RTE.Cursor.$67++}};RTE.Cursor.$Fo=function(){ULSNVe:;RTE.Cursor.$67--;RTE.Cursor.$67<=0&&RTE.Cursor.$9H(true)};RTE.Cursor.$DT=function(){ULSNVe:;try{RTE.Cursor.$9H(false);RTE.Cursor.$14=false;RTE.Cursor.$1g()}catch(a){RTE.Cursor.$1g();RTE.Cursor.$14=false;RTE.Cursor.$1V=0;RTE.Cursor.$BE()}};RTE.Cursor.$9H=function(b){ULSNVe:;RTE.Cursor.$BE();var a=RTE.Cursor.get_range();if(b){a.insertBefore(RTE.Cursor.$L.$3_0);a.insertAfter(RTE.Cursor.$L.$4_0);RTE.Cursor.updateRangeToCurrentSelectionWithOptions(true)}else a.moveBeforeNode(RTE.Cursor.$L.$4_0);if(!a.isValid())return;!RTE.Cursor.$L.$3_0.parentNode&&SP.UI.UIUtility.insertBefore(RTE.Cursor.$L.$3_0,a.$3_0);RTE.Cursor.$8O();RTE.Cursor.$Jr(b)};RTE.Cursor.$DS=function(){ULSNVe:;RTE.Cursor.$9H(true);RTE.Cursor.$1g()};RTE.Cursor.$Jr=function(b){ULSNVe:;var a=RTE.Canvas.getCachedRestriction(RTE.Canvas.currentEditableRegion(),"RestrictPasteToText",false);if(a){RTE.Cursor.$L.convertToText();RTE.Cursor.$L.clear()}RTE.Cursor.$Hm();RTE.ClientWebPartManager.replaceRenderNodesToCurrent();RTE.SnapshotManager.setCurrentRegionDirtyIf(!b&&!RTE.Cursor.$L.isEmpty());RTE.SnapshotManager.takeSnapshot();RTE.Cursor.update()};RTE.Cursor.$8O=function(){ULSNVe:;var a=RTE.Cursor.$L;RTE.RteUtility.$4N(a.$3_0);RTE.RteUtility.$5h(a.$4_0);var b=RTE.Cursor.get_range();RTE.RteUtility.$4N(b.$3_0);RTE.RteUtility.$5h(b.$4_0)};RTE.Cursor.$Hm=function(){ULSNVe:;var a=RTE.Cursor.$L.parentElement();RTE.XhtmlProcessor.$Hn(a)};RTE.Cursor.get_pasteRange=function(){ULSNVe:;return RTE.Cursor.$L};RTE.Cursor.update=function(){ULSNVe:;RTE.Cursor.s_range.resetCacheRange();if(!RTE.PreviewManager.get_instance().get_hasPreview()){RTE.Cursor.$A2();RTE.CanvasEvents.$8H();RTE.Cursor.select()}};RTE.Cursor.$A2=function(){ULSNVe:;RTE.Cursor.$23&&RTE.Cursor.updateRangeToCurrentSelectionWithOptions(RTE.Cursor.$4O)};RTE.Cursor.waitAndUpdateRangeToCurrentSelection=function(a,b){ULSNVe:;if(RTE.Cursor.$37)return;if(!a)RTE.Cursor.$4O=false;RTE.Cursor.$4a();RTE.Cursor.$4P=window.setTimeout(RTE.Cursor.$Ed,b)};RTE.Cursor.$81=function(){ULSNVe:;if(RTE.Cursor.$4P>0){window.clearTimeout(RTE.Cursor.$4P);RTE.Cursor.$4P=0}if(RTE.Canvas.$26>0){window.clearTimeout(RTE.Canvas.$26);RTE.Canvas.$26=0}};RTE.Cursor.$4a=function(){ULSNVe:;RTE.Cursor.$81();RTE.Cursor.cursorRangeIsNowOutdated()};RTE.Cursor.$Le=function(){ULSNVe:;RTE.Cursor.$4P=0;RTE.Cursor.$A1(RTE.Cursor.$4O)};RTE.Cursor.updateRangeToCurrentSelectionAndDispatch=function(){ULSNVe:;RTE.Cursor.$A1(false)};RTE.Cursor.$A1=function(a){ULSNVe:;RTE.Cursor.updateRangeToCurrentSelectionWithOptions(a);RTE.Cursor.$4O=true;RTE.Cursor.$51=false;RTE.CanvasEvents.$8H()};RTE.Cursor.updateRangeToCurrentSelection=function(){ULSNVe:;RTE.Cursor.updateRangeToCurrentSelectionWithOptions(false)};RTE.Cursor.updateRangeToCurrentSelectionWithOptions=function(c){ULSNVe:;RTE.Cursor.$6a=false;RTE.Cursor.$6Z=false;RTE.Cursor.$81();if(RTE.PreviewManager.get_instance().get_hasPreview())return;RTE.Cursor.$23=false;var d=RTE.Selection.getSelectionRange(),a=true;if(RTE.Canvas.get_$R()&&RTE.Canvas.get_$R().parentNode&&RTE.Canvas.get_$R().parentNode.parentNode)a=RTE.Cursor.s_range.moveToNode(RTE.Canvas.get_$R());else if(!d)a=false;else a=RTE.Cursor.s_range.moveToRange(d);if(!a&&!c)RTE.Cursor.s_range.clear();else if(a){var b=RTE.Cursor.s_range.expandInNonEditableRegion();if(b&&b!==RTE.Canvas.get_$R()){RTE.Canvas.$5Z(b);RTE.Cursor.s_range.moveToNode(b)}if(!RTE.RteUtility.isInternetExplorer()&&!RTE.Canvas.get_$R()){var e=RTE.Cursor.s_range.$1d_0();e.select()}}!c&&RTE.Canvas.$O()};RTE.Cursor.$Cq=function(){ULSNVe:;if(!RTE.Cursor.$6a&&RTE.Cursor.s_range.isValid()){var a=RTE.Cursor.s_range.$1d_0().get_innerHTML().toLowerCase(),b=new RegExp("<\\/?t[r|h|d|able]");RTE.Cursor.$6Z=a.search(b)!==-1;RTE.Cursor.$6a=true}return RTE.Cursor.$6Z};RTE.Cursor.$9W=function(){ULSNVe:;var a=RTE.Cursor.$5n;if(a){var b=RTE.Selection.getSelectionRange(),d=null,e=-1,f=null,g=-1;if(b){d=b.$B_0.startContainer;e=b.$B_0.startOffset;f=b.$B_0.endContainer;g=b.$B_0.endOffset}var i=a.nodeValue,j=i.replace(String.fromCharCode(8203),"");if(j===""){var c=a.parentNode;if(c){for(var h=0;h<c.childNodes.length;h++)if(c.childNodes[h]===a){if(d===a){d=c;e=h}if(f===a){f=c;g=h}break}c.removeChild(a)}}else{var k=i.indexOf(String.fromCharCode(8203));if(d===a&&e>k)e--;if(f===a&&g>k)g--;a.nodeValue=j}if(b){b.$B_0.setStart(d,e);b.$B_0.setEnd(f,g);b.select()}RTE.Cursor.$5n=null}};RTE.Cursor.select=function(){ULSNVe:;try{RTE.Cursor.$CX()}catch(a){window.setTimeout(RTE.Cursor.$CX,0)}};RTE.Cursor.$CX=function(){ULSNVe:;if(RTE.PreviewManager.get_instance().get_hasPreview())return;RTE.Cursor.$37=true;var a=RTE.Cursor.get_range();if(a.isValid()){RTE.Canvas.$5Z(RTE.Cursor.$Hj());if(!RTE.Canvas.get_$R())if(RTE.RteUtility.isInternetExplorer())if(!a.isEmpty()){var e=a.$1d_0(),f=RTE.Cursor.getSelectedImage();if(f)try{var g=document.body.createControlRange();g.add(f);g.select()}catch(n){e.select()}else e.select()}else if(a.get_$6Y_0()){var i=a.$1d_0();i.select()}else{var b=null,c=null;try{b=document.createElement("SPAN");b.innerHTML=String.fromCharCode(8203);a.insertBefore(b);c=document.createElement("SPAN");c.innerHTML=String.fromCharCode(8203);a.insertAfter(c);var j=a.$1d_0();j.select()}finally{b&&b.parentNode&&b.parentNode.removeChild(b);c&&c.parentNode&&c.parentNode.removeChild(c)}}else{if(RTE.RteUtility.isSafari()){RTE.Cursor.$9W();if(a.isEmpty()){RTE.Cursor.$5n=RTE.RteUtility.createTextNode(a.$3_0.ownerDocument,RTE.RteUtility.$2O);a.insertBefore(RTE.Cursor.$5n)}}var k=a.parentElement(),h=RTE.Canvas.getEditableRegion(k);h&&!RTE.RteUtility.isSafari()&&h.focus();var d=a.$1d_0();(d.$B_0.startContainer!==d.$B_0.endContainer||!RTE.Canvas.$1Q(d.$B_0.startContainer))&&d.select()}else{var l=a.$1d_0();l.select();var m=RTE.Selection.getSelection();m.clear()}!RTE.PreviewManager.get_instance().get_hasPreview()&&a.$L0_0()}RTE.Cursor.$23=false;RTE.Cursor.$37=false};RTE.Cursor.getCurrentElement=function(){ULSNVe:;var a=RTE.Cursor.get_range();return!a?null:!a.isValid()?null:!a.get_isEditable()?null:a.parentElement()};RTE.Cursor.$JG=function(b){ULSNVe:;var a=RTE.Cursor.getCurrentElement();if(a)if(a.tagName===b)return true;return false};RTE.Cursor.$IN=function(){ULSNVe:;var a=RTE.Cursor.getCurrentElement();return RTE.RteUtility.$6G(a,false)};RTE.Cursor.getNearestContainingElementOfType=function(a){ULSNVe:;var b=RTE.Cursor.getCurrentElement();return RTE.RteUtility.$G(b,a)};RTE.Cursor.$1G=function(b){ULSNVe:;var a=RTE.Cursor.getCurrentElement();return RTE.RteUtility.$2d(a,b)};RTE.Cursor.$C3=function(c){ULSNVe:;var a=RTE.Cursor.get_range().getSingleElement();while(a&&RTE.Canvas.isEditable(a)){if(a.tagName===c)return a;var b=RTE.RteUtility.$1w(a,true);if(b&&b===RTE.RteUtility.$1e(a,true)&&b.nodeType===1)a=b;else return null}return null};RTE.Cursor.getSelectedTable=function(){ULSNVe:;return RTE.Cursor.$C2("TABLE")};RTE.Cursor.$C2=function(f){ULSNVe:;var b=RTE.Cursor.get_range();if(!b.isValid())return null;for(var c=b.getParentChain(),a=0;a<c.length;a++){var d=c[a],e=d.tagName;if(e&&e===f)return d}return RTE.Cursor.$C3(f)};RTE.Cursor.getSelectedImage=function(){ULSNVe:;return RTE.Cursor.$C3("IMG")};RTE.Cursor.getSelectedLink=function(){ULSNVe:;return RTE.Cursor.$C2("A")};RTE.Cursor.getSelectedAtomic=function(){ULSNVe:;return RTE.Canvas.get_$R()};RTE.Cursor.$Ib=function(b){ULSNVe:;var a=RTE.Canvas.getDirectAtomicParent(b);return RTE.Canvas.isInEditable(a)?RTE.Canvas.$6H(a):null};RTE.Cursor.$Hj=function(){ULSNVe:;var a=RTE.Cursor.get_range();if(!a.isValid())return null;a.fixMarkers();var d=a.parentElement(),c=RTE.Canvas.getDirectAtomicParent(d);if(c)return RTE.Canvas.$6H(c);var b=RTE.Cursor.get_range().getSingleElement();return b&&RTE.Canvas.$1Q(b)?RTE.Canvas.$6H(b):null};RTE.DirtyBitManager=function(){};RTE.DirtyBitManager.start=function(){ULSNVe:;var a=$get("ms-rtedirtybit");if(a&&a.value==="1")RTE.DirtyBitManager.$5U=true;RTE.DirtyBitManager.$4F=true};RTE.DirtyBitManager.stop=function(){ULSNVe:;RTE.DirtyBitManager.$4F=false};RTE.DirtyBitManager.isDirty=function(){ULSNVe:;if(RTE.DirtyBitManager.$4F)if(RTE.DirtyBitManager.$5U)return typeof rteRegionIsDirty==="boolean"&&rteRegionIsDirty?true:RTE.SnapshotManager.get_undoEnabled();return false};RTE.DirtyBitManager.cleanRTE=function(){ULSNVe:;if(!RTE.DirtyBitManager.$4F)return;RTE.DirtyBitManager.$5U=false};RTE.DirtyBitManager.$BG=function(){ULSNVe:;if(!RTE.DirtyBitManager.$4F)return;RTE.DirtyBitManager.$5U=true};RTE.DOMTreePosition=function(b,a){ULSNVe:;this.$1_0=b;this.$H_0=a};RTE.DOMTreePosition.prototype={$1_0:null,$H_0:0,$4Y_0:null,$8h_0:true,getCurrentNode:function(){ULSNVe:;return this.$1_0},setCurrentNode:function(a){ULSNVe:;this.$1_0=a},atStart:function(){ULSNVe:;return!this.$H_0},atEnd:function(){ULSNVe:;return SP.UI.UIUtility.isTextNode(this.$1_0)?this.$H_0===this.$1_0.nodeValue.length:this.$H_0===this.$1_0.childNodes.length},$FA_0:function(a){ULSNVe:;return SP.UI.UIUtility.isTextNode(this.$1_0)?this.$H_0===this.$1_0.nodeValue.length:this.$H_0===a.length},move:function(a){ULSNVe:;return this.moveCount(a,1)},moveCount:function(c,b){ULSNVe:;var a;if(c)a=this.$DF_0(b);else a=this.$DI_0(b);return!a?false:this.$1_0.parentNode&&RTE.RteUtility.$CZ(this.$1_0)?this.move(c):true},moveRight:function(){ULSNVe:;return this.moveCount(false,1)},moveLeft:function(){ULSNVe:;return this.moveCount(true,1)},$DI_0:function(a){ULSNVe:;var b=false;while(a>=0){if(this.$1_0&&SP.UI.UIUtility.isTextNode(this.$1_0)){b=false;var c=this.$1_0.nodeValue.length-this.$H_0;if(c>0)if(c<=a){this.$H_0+=c;a-=c}else{this.$H_0+=a;a=-1}else if(!this.moveToNextElement())return false}else{if(SP.UI.UIUtility.isNodeOfType(this.$1_0,RTE.HtmlTagName.blockElements)){if(!b){a--;b=true}if(a<0)return this.moveToPreviousElement()}else if(RTE.RteUtility.$3t(this.$1_0)||this.$1_0.className&&this.$1_0.className.indexOf("ms-rtestate-read")!==-1){b=false;a--;if(a<0)return this.moveToPreviousElement()}else b=false;if(!this.moveToNextElement())return false}if(this.$4Y_0&&!this.$1_0.childNodes.length)this.$4Y_0=null}return true},$DF_0:function(a){ULSNVe:;var b=false;while(a>=0){if(this.$1_0&&SP.UI.UIUtility.isTextNode(this.$1_0)&&this.$H_0>0){b=false;if(this.$H_0<=a){a-=this.$H_0;this.$H_0=0}else{this.$H_0-=a;a=-1}}else{if(SP.UI.UIUtility.isNodeOfType(this.$1_0,RTE.HtmlTagName.blockElements)){if(!b){a--;b=true}if(a<0)return this.moveToNextElement()}else if(RTE.RteUtility.$3t(this.$1_0)||this.$1_0.className&&this.$1_0.className.indexOf("ms-rtestate-read")!==-1){b=false;a--;if(a<0)return this.moveToNextElement()}else b=false;if(!this.moveToPreviousElement())return false}if(this.$4Y_0&&!this.$1_0.childNodes.length)this.$4Y_0=null}return true},normalize:function(){ULSNVe:;if(!SP.UI.UIUtility.isTextNode(this.$1_0)){var a=this.$1_0.childNodes,b=a.length;if(b>0){if(b===this.$H_0&&this.$H_0>0){this.$1_0=a[this.$H_0-1];this.setLocationAtEnd();this.normalize()}else{this.$1_0=a[this.$H_0];this.setLocationAtStart();this.normalize()}this.$4Y_0=null}}},normalizeLeft:function(){ULSNVe:;var a=this.$1_0;while(a){if(a.style&&a.style.display==="none"){this.$1_0=a;this.setLocationAtStart()}a=a.parentNode}this.$DF_0(0)},normalizeRight:function(){ULSNVe:;var a=this.$1_0;while(a){if(a.style&&a.style.display==="none"){this.$1_0=a;this.setLocationAtEnd()}a=a.parentNode}this.$DI_0(0)},moveToPreviousElement:function(){ULSNVe:;var d=this.$1_0;if(!d)return false;if(this.atStart()){var c=d.parentNode;if(!c)c=this.$1_0.parentElement;if(!c)return false;var a=d.previousSibling;if(RTE.RteUtility.isInternetExplorer()){var g=c.uniqueID;if(!a||a.parentNode&&a.parentNode.uniqueID!==g){var e=c.childNodes;if(e[0]!==this.$1_0)for(var h=e.length,b=h-1;b>=0;b--){var i=e[b];if(i===d){b--;if(b>=0)a=e[b];else a=null;while(a&&a.parentNode&&a.parentNode.uniqueID===g){b--;if(b>=0)a=e[b];else a=null}break}}else a=null}}if(a){this.$1_0=a;this.setLocationAtEnd()}else{this.$1_0=c;this.setLocationAtStart()}}else{var f=d.childNodes;if(f&&f.length>0){this.$1_0=f[f.length-1];this.setLocationAtEnd()}else{this.setLocationAtStart();return this.moveToPreviousElement()}}return this.$8h_0&&SP.UI.UIUtility.isTextNode(this.$1_0)&&!this.$1_0.nodeValue.length?this.moveToPreviousElement():!!this.$1_0},moveToNextElement:function(){ULSNVe:;var e=this.$1_0;if(!e)return false;var f=e.childNodes;if(this.$FA_0(f)){var c=e.parentNode;if(!c)c=this.$1_0.parentElement;if(!c)return false;var a=e.nextSibling;if(RTE.RteUtility.isInternetExplorer()){var i=!!a,h=c.uniqueID;if(!a||a.parentNode&&a.parentNode.uniqueID!==h){a=null;var d=c.childNodes,g=d.length;if(d[g-1]!==this.$1_0)for(var b=0;b<g;b++){var j=d[b];if(j===this.$1_0){b++;if(g>b)a=d[b];else a=null;while(a&&a.parentNode&&a.parentNode.uniqueID!==h){b++;if(g>b)a=d[b];else a=null}break}}else a=null;if(!!(i^!!a))RTE.RteUtility.$7a=false}}if(a){this.$1_0=a;this.setLocationAtStart()}else{this.$1_0=c;this.setLocationAtEnd()}}else if(f&&f[0]){this.$1_0=f[0];this.setLocationAtStart()}else{this.setLocationAtEnd();return this.moveToNextElement()}return this.$8h_0&&SP.UI.UIUtility.isTextNode(this.$1_0)&&!this.$1_0.nodeValue.length?this.moveToNextElement():!!this.$1_0},setLocationAtEnd:function(){ULSNVe:;if(SP.UI.UIUtility.isTextNode(this.$1_0))this.$H_0=this.$1_0.nodeValue.length;else this.$H_0=this.$1_0.childNodes.length},setLocationAtStart:function(){ULSNVe:;this.$H_0=0},setLocation:function(a){ULSNVe:;if(a)this.setLocationAtStart();else this.setLocationAtEnd()},setOffset:function(a){ULSNVe:;this.$H_0=a},getOffset:function(){ULSNVe:;return this.$H_0},insertMarker:function(a){ULSNVe:;if(a===this.$1_0)return;this.removeNode(a);var b=this.$1_0.nodeType===1?this.$1_0:this.$1_0.parentNode;if(RTE.Canvas.$3v(b.tagName))return;if(!SP.UI.UIUtility.isTextNode(this.$1_0))if(RTE.RteUtility.$3t(this.$1_0))this.$1_0.parentNode.insertBefore(a,this.$1_0);else if(this.$H_0===this.$1_0.childNodes.length)try{this.$1_0.appendChild(a);this.$H_0=this.$1_0.childNodes.length}catch(e){this.$1_0.parentNode.insertBefore(a,this.$1_0)}else if(!this.$H_0)SP.UI.UIUtility.insertBefore(a,this.$1_0.childNodes[this.$H_0]);else{SP.UI.UIUtility.insertBefore(a,this.$1_0.childNodes[this.$H_0]);this.$1_0=a;this.$H_0=0;this.moveToNextElement()}else if(this.$1_0.nodeValue.length===this.$H_0)SP.UI.UIUtility.insertAfter(a,this.$1_0);else if(this.$H_0){var c=this.$1_0.nodeValue.substr(this.$H_0);this.$1_0.nodeValue=this.$1_0.nodeValue.substr(0,this.$H_0);SP.UI.UIUtility.insertAfter(a,this.$1_0);var d=RTE.RteUtility.createTextNode(window.document,c);SP.UI.UIUtility.insertAfter(d,a)}else SP.UI.UIUtility.insertBefore(a,this.$1_0)},removeNode:function(a){ULSNVe:;if(this.$1_0===a){this.moveToPreviousElement();RTE.RteUtility.$J(a)}else if(!SP.UI.UIUtility.isTextNode(this.$1_0))if(this.$H_0===this.$1_0.childNodes.length){RTE.RteUtility.$J(a);this.$H_0=this.$1_0.childNodes.length}else if(this.$H_0){var c=this.$1_0.childNodes[this.$H_0],e=this.$1_0.childNodes.length;RTE.RteUtility.$J(a);var d=this.$1_0.childNodes.length;if(c!==a&&e!==d)for(var b=0;b<d;b++)if(this.$1_0.childNodes[b]===c)this.$H_0=b}else RTE.RteUtility.$J(a);else RTE.RteUtility.$J(a)},clone:function(){ULSNVe:;return new RTE.DOMTreePosition(this.$1_0,this.$H_0)}};RTE.EmbeddingCommands=function(){};RTE.EmbeddingCommands.canUserEmbedIframes=function(){ULSNVe:;var a=RTE.Canvas.currentEditableRegion();return a?RTE.Canvas.getCachedRestriction(a,"AllowEmbedding",false):false};RTE.EmbeddingCommands.canUserEmbedWebPart=function(){ULSNVe:;if(!RTE.Canvas.canHandleInsertWebPart())return false;var a=RTE.Canvas.currentEditableRegion();return!a||!RTE.Canvas.getCachedRestriction(a,"AllowScriptWebParts",false)?false:!RTE.SU.$2(RTE.EmbeddingCommands.getEmbeddingWebPartId())};RTE.EmbeddingCommands.canHandleInsertEmbeddingButton=function(){ULSNVe:;if(RTE.Canvas.get_$R()&&RTE.RteUtility.containsCssClass(RTE.Canvas.get_$R(),"ms-rte-wpbox"))if(RTE.EmbeddingCommands.$Bn(RTE.Canvas.get_$R()))return RTE.EmbeddingCommands.canUserEmbedWebPart();return RTE.EmbeddingCommands.canHandleInsertEmbedding()};RTE.EmbeddingCommands.canHandleInsertEmbedding=function(){ULSNVe:;return RTE.EmbeddingCommands.canUserEmbedIframes()||RTE.EmbeddingCommands.canUserEmbedWebPart()};RTE.EmbeddingCommands.getEmbeddingWebPartId=function(){ULSNVe:;return RTE.Canvas.getStringRestriction(RTE.Canvas.currentEditableRegion(),"EmbeddingWPId",null)};RTE.EmbeddingCommands.$BY=function(a){ULSNVe:;var b=null;while(a&&a!==document.body){if(RTE.RteUtility.containsCssClass(a,"ms-rte-embedcode")){b=a;break}a=a.parentNode}return b};RTE.EmbeddingCommands.launchEmbedDialog=function(g){ULSNVe:;var b="",a=RTE.EmbeddingCommands.$BY(g)||RTE.Canvas.get_$R();if(a&&RTE.RteUtility.containsCssClass(a,"ms-rte-wpbox"))a=RTE.EmbeddingCommands.$Bn(a);if(a)if(RTE.RteUtility.containsCssClass(a,"ms-rte-embedwp")){var d=a.getAttribute("InputField");if(!RTE.SU.$2(d)){var c=$get(d);if(c){b=c.value;var f=new RTE.WebPartEmbeddingDialog(a,c);f.show(b);return}}}else if(RTE.RteUtility.containsCssClass(a,"ms-rte-embedcode")&&a.firstChild)b=RTE.EmbeddingCommands.$IB(a);var e=new RTE.RteEmbeddingDialog(a);e.show(b)};RTE.EmbeddingCommands.$Bn=function(b){ULSNVe:;var a=null;RTE.RteUtility.forEachChildWithTagAndClass(b,"DIV","ms-rte-embedcode",function(b){ULSNVe:;if(!a)a=b});return a};RTE.EmbeddingCommands.$IB=function(c){ULSNVe:;var a=c;if(a.firstChild&&a.firstChild.nodeType===1&&RTE.RteUtility.containsCssClass(a.firstChild,"ms-rte-embedcode-title"))a=a.firstChild.nextSibling;while(a.firstChild&&a.firstChild.nodeType===1&&RTE.RteUtility.containsCssClass(a.firstChild,"ms-rtegenerate-skip"))a=a.firstChild;var b=a.innerHTML;return RTE.RteUtility.$4B(b,false,false)};RTE.EmbeddingCommands.$B5=function(){ULSNVe:;var a=document.createElement("DIV");a.className="ms-rtestate-read ms-rte-embedcode ms-rte-embedil ms-rtestate-notify";return a};RTE.EmbeddingCommands.moveEmbeddingBoxIntoEditMode=function(a){ULSNVe:;if(!a)return;a.firstChild&&a.firstChild.nodeType===1&&RTE.RteUtility.containsCssClass(a.firstChild,"ms-rte-embedcode-title")&&a.removeChild(a.firstChild);while(a.firstChild&&a.firstChild.nodeType===1&&RTE.RteUtility.containsCssClass(a.firstChild,"ms-rtegenerate-skip"))RTE.RteUtility.removeNodeAndKeepChildNodes(a.firstChild);a.lastChild&&a.lastChild.nodeType===1&&RTE.RteUtility.containsCssClass(a.lastChild,"ms-rte-embedcode-link")&&a.removeChild(a.lastChild);var h=RTE.RteUtility.containsCssClass(a,"ms-rte-embedwp");a.setAttribute("contentEditable","false");var f=document.createElement("DIV");Sys.UI.DomElement.addCssClass(f,"ms-rte-embedholder");Sys.UI.DomElement.addCssClass(f,"ms-rtegenerate-skip");RTE.RteUtility.$k(a,f);if(!h){var d=document.createElement("DIV");Sys.UI.DomElement.addCssClass(d,"ms-rte-embedcode-title");Sys.UI.DomElement.addCssClass(d,"ms-rtegenerate-allskip");a.appendChild(d);var c=document.createElement("A");Sys.UI.DomElement.addCssClass(c,"ms-rte-embedcode-delete");c.title=SP.Res.deleteText;c.innerHTML=String.format("<img src='/_layouts/images/DelItem.gif' alt='{0}' style='border-style: none' />",RTE.RteUtility.htmlEncode(SP.Res.deleteText));c.href="javascript:;";$addHandler(c,"click",function(b){ULSNVe:;var a=RTE.EmbeddingCommands.$BY(b.target);if(a){RTE.SnapshotManager.takeSnapshot();RTE.Cursor.s_range.moveBeforeNode(a);a.parentNode.removeChild(a);RTE.SnapshotManager.setCurrentRegionDirty();RTE.Cursor.update();RTE.SnapshotManager.takeSnapshot();RTE.Canvas.set_$R(null)}SP.UI.UIUtility.cancelEvent(b);return false});d.appendChild(c);var i=document.createElement("H2");Sys.UI.DomElement.addCssClass(i,"ms-webpart-titleText");d.appendChild(i);var l=document.createElement("SPAN");i.appendChild(l);l.appendChild(document.createTextNode(SP.Res.embeddingEditTitle));var g=document.createElement("DIV");Sys.UI.DomElement.addCssClass(g,"ms-WPBorder");Sys.UI.DomElement.addCssClass(g,"ms-rtegenerate-skip");a.appendChild(g);a=g}a.appendChild(f);var b=document.createElement("DIV");Sys.UI.DomElement.addCssClass(b,"ms-rtegenerate-allskip");Sys.UI.DomElement.addCssClass(b,"ms-rte-embedcode-link");var k=h?a.getAttribute("EditEnabled"):null;if(h&&!RTE.SU.$2(k)&&k==="False"){Sys.UI.DomElement.addCssClass(b,"ms-metadata");b.appendChild(document.createTextNode(SP.Res.embeddingWebPartNoPermissions))}else{Sys.UI.DomElement.addCssClass(b,"ms-rte-embedcode-linkedit");var e=document.createElement("A");e.title=SP.Res.embeddingEditLinkText;e.href="javascript:;";$addHandler(e,"click",function(a){ULSNVe:;RTE.EmbeddingCommands.launchEmbedDialog(a.target);SP.UI.UIUtility.cancelEvent(a);return false});b.appendChild(e);var j=document.createElement("SPAN");j.className="ms-metadata";j.appendChild(document.createTextNode(SP.Res.embeddingEditLinkText));e.appendChild(j)}a.appendChild(b)};RTE.EmbeddingCommands.$Ks=function(a,c,d){ULSNVe:;var e=!!c&&RTE.Canvas.getCachedRestriction(c,"AllowScripts",false);if(e){d(a,false);return}var b=RTE.RteUtility.$4p(a);RTE.EmbeddingCommands.$7b(b,c,function(f){ULSNVe:;for(var e=false,c=0;c<b.length;c++)if(!f[c]){e=true;a=RTE.RteUtility.$Ki(a,b[c])}d(a,e)})};RTE.EmbeddingCommands.$7b=function(e,m,j){ULSNVe:;var a=new Array(0),f=new Array(0),c=new Array(e.length);if(m)if(RTE.Canvas.getCachedRestriction(m,"AllowScripts",false)){for(var k=0;k<e.length;k++)c[c.length]=true;j(c);return}for(var d=0;d<e.length;d++){var l=RTE.EmbeddingCommands.$9j[e[d]];if(typeof l==="boolean")c[d]=l;else{a[a.length]=e[d];f[f.length]=d}}if(!a.length){j(c);return}var b=new XMLHttpRequest,g=SP.PageContextInfo.get_webServerRelativeUrl();if(!g.startsWith("/"))g="/"+g;b.open("POST",SP.Utilities.UrlBuilder.urlCombine(encodeURI(g),"_vti_bin/sites.asmx"),true);b.onreadystatechange=function(){ULSNVe:;if(b.readyState===4){if(b.status===200&&b.responseXML){var e=RTE.EmbeddingCommands.$KF(b.responseXML);if(e.length===a.length)for(var d=0;d<a.length;d++){RTE.EmbeddingCommands.$9j[a[d]]=e[d];c[f[d]]=e[d]}}else for(var g=0;g<a.length;g++)c[f[g]]=false;j(c)}};b.setRequestHeader("Content-Type","text/xml; charset=utf-8");b.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/IsScriptSafeUrl");for(var h='<?xml version="1.0" encoding="utf-8"?>\r\n                    <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"\r\n                        xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">\r\n                        <soap:Body>\r\n                            <IsScriptSafeUrl xmlns="http://schemas.microsoft.com/sharepoint/soap/">\r\n                                <urls>',i=0;i<a.length;i++)h+="<string>"+RTE.RteUtility.htmlEncode(a[i])+"</string>";h+="</urls>\r\n                            </IsScriptSafeUrl>\r\n                        </soap:Body>\r\n                    </soap:Envelope>";b.send(h)};RTE.EmbeddingCommands.$KF=function(f){ULSNVe:;var b=new Array(0);if(f){var a=f.lastChild;while(a&&a.nodeType===1&&a.nodeName.indexOf("IsScriptSafeUrlResult")===-1)a=a.firstChild;if(a)for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(d.nodeType!==1||!d.childNodes.length)return b;var e=d.childNodes[0].nodeValue;b[b.length]=!RTE.SU.$2(e)&&e.indexOf("true")!==-1}}return b};RTE.EmbeddingCommands.$He=function(c,b){ULSNVe:;if(!b)return;var a=b.node;if(!a||a.tagName!=="DIV"||!a.className||a.className.indexOf("ms-rte-embedcode")===-1)return;RTE.EmbeddingCommands.moveEmbeddingBoxIntoEditMode(a)};RTE.EmbeddingMethods=function(){};RTE.EmbeddingMethods.moveBoxToEdit=function(a){ULSNVe:;if(!RTE.SU.$2(a)){var b=$get(a);b&&RTE.EmbeddingCommands.moveEmbeddingBoxIntoEditMode(b)}};RTE.EmbeddingMethods.canHandleInsertEmbeddingButton=function(){ULSNVe:;return RTE.EmbeddingCommands.canHandleInsertEmbeddingButton()};RTE.EmbeddingMethods.insertEmbedding=function(a,b){ULSNVe:;a=RTE.RteUtility.$BZ(a);RTE.RteEmbeddingDialog.$Ef(a,null,function(a){ULSNVe:;b&&b(a.$5g_0)})};RTE.EmbeddingDialog=function(){ULSNVe:;this.$$d_$FN_0=Function.createDelegate(this,this.$FN_0);this.$$d_$J8_0=Function.createDelegate(this,this.$J8_0);this.$$d_$It_0=Function.createDelegate(this,this.$It_0);this.$$d_$Is_0=Function.createDelegate(this,this.$Is_0);this.$7Y_0=2500};RTE.EmbeddingDialog.$A3=function(c){ULSNVe:;for(var b=RTE.RteUtility.$4p(c),a=0;a<b.length;a++)if(b[a].endsWith("://"))return false;return true};RTE.EmbeddingDialog.prototype={dialogDiv:null,previewArea:null,messageArea:null,insertButton:null,$28_0:null,dialog:null,originalHtml:null,$Ct_0:null,$2v_0:0,$Dj_0:0,$Dk_0:0,$9P_0:0,$Dl_0:0,show:function(d){ULSNVe:;this.originalHtml=d;this.dialogDiv=document.createElement("DIV");this.dialogDiv.className="ms-core-form";var e=document.createElement("P");this.dialogDiv.appendChild(e);e.appendChild(document.createTextNode(SP.Res.embeddingDialogDescription));this.$28_0=document.createElement("TEXTAREA");this.$28_0.value=d;this.$28_0.id="embeddingText";this.$28_0.className="ms-rte-embeddialog-textarea ms-fullWidth";$addHandler(this.$28_0,"keyup",this.$$d_$Is_0);$addHandler(this.$28_0,"beforepaste",this.$$d_$It_0);$addHandler(this.$28_0,"paste",this.$$d_$It_0);this.dialogDiv.appendChild(this.$28_0);var a=document.createElement("DIV");a.className="ms-core-form-bottomButtonBox";this.dialogDiv.appendChild(a);this.insertButton=document.createElement("INPUT");this.insertButton.type="button";this.insertButton.id="embeddingInsertBtn";this.insertButton.className="ms-ButtonHeightWidth";this.insertButton.value=SP.Res.embeddingDialogInsertButtonText;$addHandler(this.insertButton,"click",this.$$d_$J8_0);a.appendChild(this.insertButton);a.appendChild(document.createTextNode(RTE.RteUtility.$7v));var b=document.createElement("INPUT");b.type="button";b.id="embeddingCancelBtn";this.insertButton.className="ms-ButtonHeightWidth";b.value=SP.Res.cancelButtonText;$addHandler(b,"click",this.$$d_$FN_0);a.appendChild(b);this.messageArea=document.createElement("DIV");this.messageArea.className="ms-rte-embeddialog-message";this.dialogDiv.appendChild(this.messageArea);this.previewArea=document.createElement("DIV");this.previewArea.className="ms-rte-embeddialog-preview";this.dialogDiv.appendChild(this.previewArea);var f=document.createElement("DIV");f.appendChild(this.dialogDiv);var c=new SP.UI.DialogOptions;c.html=f;c.title=SP.Res.embeddingDialogTitle;c.autoSize=true;c.allowMaximize=true;this.dialog=SP.UI.ModalDialog.showModalDialog(c);this.$FL_0();this.$28_0.focus();this.$A0_0()},close:function(){ULSNVe:;if(this.dialog){if(this.$2v_0){window.clearTimeout(this.$2v_0);this.$2v_0=0}RTE.RteUtility.removeChildNodes(this.previewArea);RTE.RteUtility.removeChildNodes(this.dialogDiv);this.dialog.close(1);this.previewArea.innerHTML="";this.previewArea=null;this.dialogDiv=null;this.dialog=null;this.messageArea=null}},$Is_0:function(){ULSNVe:;this.$CG_0()},$It_0:function(){ULSNVe:;this.$7Y_0=500;this.$CG_0()},$CG_0:function(){ULSNVe:;if(this.$2v_0){window.clearTimeout(this.$2v_0);this.$2v_0=0}var a=this;this.$2v_0=window.setTimeout(function(){ULSNVe:;a.$7Y_0=2500;a.$2v_0=0;a.$A0_0()},this.$7Y_0)},$J8_0:function(){ULSNVe:;this.$A0_0();if(!this.insertButton.disabled){var a=this.insertClick();a&&this.dialog.close(1)}},$FN_0:function(){ULSNVe:;this.dialog.close(1);RTE.Cursor.update()},$A0_0:function(){ULSNVe:;var a=this.get_htmlContent();if(this.dialog&&this.$Ct_0!==a){this.$Ct_0=a;this.previewArea.innerHTML="";this.messageArea.innerHTML="";if(RTE.SU.$2(a))this.insertButton.disabled=true;else if(RTE.EmbeddingDialog.$A3(a)){this.previewArea.innerHTML=this.$C0_0(a);this.htmlCodeChanged()}else{this.setInsertEnabled(false);this.messageArea.appendChild(document.createTextNode(SP.Res.embeddingDialogWebPartNotAllowed))}this.$FB_0()}},$FB_0:function(){ULSNVe:;this.dialogDiv.style.width="10px";this.previewArea.style.overflow="scroll";this.previewArea.style.maxWidth="";this.previewArea.style.maxHeight="";this.previewArea.style.height="auto";this.previewArea.style.width="auto";var a=this.get_htmlContent(),b=!!a&&a.length>0;this.previewArea.style.display=!b?"none":"";this.previewArea.style.height=this.previewArea.scrollHeight+5+"px";this.previewArea.style.width=this.previewArea.scrollWidth+20+"px";if(this.$9P_0){var c=RTE.RteUtility.$6J(window.top),d=RTE.RteUtility.$6K(window.top),e=this.messageArea.firstChild?this.messageArea.scrollHeight:0;this.previewArea.style.maxWidth=Math.max(0,this.$Dk_0-this.$Dl_0+d)+"px";this.previewArea.style.maxHeight=Math.max(0,this.$Dj_0-e-this.$9P_0+c-10)+"px"}this.dialogDiv.style.width="";this.previewArea.style.overflow="auto";if(!this.dialog.get_isMaximized()){this.dialogDiv.parentNode.style.overflow="scroll";this.dialog.autoSize();this.dialogDiv.parentNode.style.overflow=""}},$C0_0:function(a){ULSNVe:;return a},setInsertEnabled:function(a){ULSNVe:;var b=this.get_htmlContent();if(this.insertButton.disabled===a)this.insertButton.disabled=!a;this.previewArea.innerHTML=a?this.$C0_0(b):""},get_htmlContent:function(){ULSNVe:;var a=this.$28_0.value||"";return RTE.RteUtility.$BZ(a)},htmlCodeChanged:function(){},$FL_0:function(){ULSNVe:;var a=this.dialog.get_dialogElement();if(a){var d=a.offsetHeight,e=a.offsetWidth,f=this.previewArea.offsetWidth,b=RTE.RteUtility.$6J(window.top),c=RTE.RteUtility.$6K(window.top);this.$Dj_0=b-d-20;this.$Dk_0=c-e+f-10;this.$Dl_0=c;this.$9P_0=b}}};RTE.RteEmbeddingDialog=function(a){ULSNVe:;RTE.RteEmbeddingDialog.initializeBase(this);this.$2x_1=a};RTE.RteEmbeddingDialog.$A3=function(d,e,b){ULSNVe:;var g=!!e&&RTE.Canvas.getCachedRestriction(e,"AllowScripts",false);if(g){b(1);return}var h=new RegExp("<\\s*script","ig");if(h.test(d)){b(0);return}RTE.Cursor.$9O(false);var i=RTE.Cursor.$X,f=i.contentWindow.document,a=f.createElement("DIV");a.innerHTML=d;f.body.appendChild(a);var j=a.getElementsByTagName("*").length;RTE.SafeHtml.$Kn(a);var k=a.getElementsByTagName("*").length;if(j!==k){b(0);return}var c=RTE.RteUtility.$4p(d);if(!c||!c.length){b(1);return}RTE.RteEmbeddingDialog.$7b(c,e,b)};RTE.RteEmbeddingDialog.$7b=function(a,b,c){ULSNVe:;RTE.EmbeddingCommands.$7b(a,b,function(e){ULSNVe:;for(var b=true,d=0;d<a.length;d++)b=b&&e[d];c(b?1:0)})};RTE.RteEmbeddingDialog.$Ef=function(a,b,c){ULSNVe:;RTE.RteEmbeddingDialog.$A3(a,RTE.Canvas.getEditableRegion(b)||RTE.Cursor.get_range().getEditableRegion(),function(e){ULSNVe:;var d;switch(e){case 1:d=RTE.RteEmbeddingDialog.$J6(a,b);break;default:d=RTE.RteEmbeddingDialog.$J7(a,b)}c(d)})};RTE.RteEmbeddingDialog.$J6=function(f,b){ULSNVe:;var c=new RTE.EmbeddingInsertArgs;c.$7Z_0=1;var d=RTE.Cursor.get_range(),e=d.parentElement();if(!e&&!b)return c;RTE.SnapshotManager.takeSnapshot();var a=RTE.EmbeddingCommands.$B5();a.innerHTML=f;RTE.EmbeddingCommands.moveEmbeddingBoxIntoEditMode(a);if(!b){d.deleteContent();d.insertNode(a);RTE.SnapshotManager.setCurrentRegionDirty()}else{b.innerHTML="";b.parentNode.replaceChild(a,b);d.moveAfterNode(a)}RTE.Cursor.update();RTE.SnapshotManager.takeSnapshot();c.$5g_0=true;return c};RTE.RteEmbeddingDialog.$J7=function(j,d){ULSNVe:;var a=new RTE.EmbeddingInsertArgs;a.$7Z_0=0;if(!RTE.EmbeddingCommands.canUserEmbedWebPart()){a.$BR_0=SP.Res.embeddingDialogWebPartNotAllowed;return a}var c=RTE.Cursor.get_range(),h=c.parentElement();if(!h)return a;if(d){c.moveToNode(d);RTE.RteUtility.$J(d)}c.deleteContent();var i=RTE.EmbeddingCommands.getEmbeddingWebPartId(),e=SP.Ribbon.WebPartComponent.getWebPartAdder(),f=e._createWebpartPlaceholderInRte(RTE.Cursor.get_range()),b=document.createElement("INPUT");b.type="hidden";b.name=f+"scriptcontent";b.value=j;var g=RTE.RteUtility.$G(RTE.Canvas.currentEditableRegion(),"FORM");g&&g.appendChild(b);e.addItemToPageByItemIdAndZoneId(i,"wpz",0,f);a.$5g_0=true;return a};RTE.RteEmbeddingDialog.prototype={$2x_1:null,insertClick:function(){ULSNVe:;var b=this.get_htmlContent();this.$BH_1();var a=this;RTE.RteEmbeddingDialog.$Ef(b,this.$2x_1,function(c){ULSNVe:;a.$BQ_1();c.$7Z_0===1&&RTE.SnapshotManager.setCurrentRegionDirtyIf(a.originalHtml!==b);c.$5g_0&&a.close()});return false},htmlCodeChanged:function(){ULSNVe:;var b=this.get_htmlContent();this.$BH_1();var a=this;RTE.RteEmbeddingDialog.$A3(b,RTE.Canvas.getEditableRegion(this.$2x_1)||RTE.Cursor.get_range().getEditableRegion(),function(b){ULSNVe:;a.$BQ_1();switch(b){case 1:a.$LG_1();break;default:a.$LH_1()}})},$LH_1:function(){ULSNVe:;var a=RTE.EmbeddingCommands.canUserEmbedWebPart(),b=a?true:RTE.Canvas.canHandleInsertWebPart();this.setInsertEnabled(a);var c=a?SP.Res.embeddingDialogWebPartInsert:b?SP.Res.embeddingDialogCannotInsert:SP.Res.embeddingDialogWebPartNotAllowed;this.messageArea.appendChild(document.createTextNode(c))},$LG_1:function(){ULSNVe:;this.setInsertEnabled(RTE.EmbeddingCommands.canUserEmbedIframes())},$BH_1:function(){ULSNVe:;this.insertButton.disabled=true;this.insertButton.value=SP.Res.embeddingDialogWaitText},$BQ_1:function(){ULSNVe:;this.insertButton.value=SP.Res.embeddingDialogInsertButtonText}};RTE.WebPartEmbeddingDialog=function(a,b){ULSNVe:;RTE.WebPartEmbeddingDialog.initializeBase(this);this.$2x_1=a;this.$AA_1=b};RTE.WebPartEmbeddingDialog.prototype={$2x_1:null,$AA_1:null,htmlCodeChanged:function(){ULSNVe:;this.setInsertEnabled(true)},insertClick:function(){ULSNVe:;var a=this.get_htmlContent();this.$2x_1.innerHTML="";this.$2x_1.innerHTML=a;RTE.RteUtility.setInputValue(this.$AA_1,a);RTE.EmbeddingCommands.moveEmbeddingBoxIntoEditMode(this.$2x_1);return true}};RTE.ExtractChildNodesProcessor=function(a,b,c,d,e){ULSNVe:;this.$5B_0=a;this.$6p_0=b;this.$2I_0=c;this.$47_0=d;this.$D3_0=e};RTE.ExtractChildNodesProcessor.prototype={$6i_0:false,$8z_0:false,$6h_0:false,$5B_0:null,$6p_0:null,$2I_0:null,$47_0:null,$44_0:null,$D3_0:false,$6n_0:null,process:function(){ULSNVe:;this.$6i_0=false;this.$8z_0=false;this.$6h_0=false;this.$44_0=[];while(this.$2I_0&&this.$2I_0.parentNode.firstChild===this.$2I_0&&this.$2I_0.parentNode!==this.$5B_0)this.$2I_0=this.$2I_0.parentNode;this.$6n_0=[];var a=this.$6p_0;while(a!==this.$5B_0){this.$6n_0.push(a);a=a.parentNode}this.$Al_0(this.$5B_0);for(var b=0;b<this.$44_0.length;b++){var c=this.$44_0[b];if(c)this.$47_0.appendChild(c);else this.$47_0=this.$47_0.parentNode}},$Al_0:function(d){ULSNVe:;if(this.$6i_0){if(!this.$6h_0){var e=[],a=d.parentNode;while(a!==this.$5B_0){e.push(a);a=a.parentNode}while(e.length>0){a=e.pop();var b;if(a.tagName==="A")b=a.ownerDocument.createElement("SPAN");else b=a.cloneNode(false);this.$47_0.appendChild(b);this.$47_0=b}this.$6h_0=true}Array.add(this.$44_0,d)}else{for(var g=this.$6n_0.length>0?this.$6n_0.pop():null,f=0;f<d.childNodes.length;f++){var c=d.childNodes[f];if(c===this.$6p_0){this.$6i_0=true;this.$D3_0&&Array.add(this.$44_0,this.$6p_0)}else if(this.$2I_0&&c===this.$2I_0){this.$8z_0=true;return}else if(this.$6i_0||!g||g===c){this.$Al_0(c);if(this.$8z_0)return}}this.$6h_0&&Array.add(this.$44_0,null)}}};RTE.FontCommands=function(){};RTE.FontCommands.$FD=function(){ULSNVe:;RTE.FontCommands.$3d(0,["STRONG","B"],null,"fontWeight","bold","normal")};RTE.FontCommands.$KS=function(){ULSNVe:;return RTE.FontCommands.$4A(0,["STRONG","B"],null,"fontWeight","bold","normal")};RTE.FontCommands.$JX=function(){ULSNVe:;RTE.FontCommands.$3d(0,["EM","I"],null,"fontStyle","italic","normal")};RTE.FontCommands.$KT=function(){ULSNVe:;return RTE.FontCommands.$4A(0,["EM","I"],null,"fontStyle","italic","normal")};RTE.FontCommands.$LT=function(){ULSNVe:;RTE.FontCommands.$3d(2,null,null,"textDecoration","line-through","none");RTE.Canvas.$O()};RTE.FontCommands.$KU=function(){ULSNVe:;return RTE.FontCommands.$4A(2,null,null,"textDecoration","line-through","none")};RTE.FontCommands.$LV=function(){ULSNVe:;RTE.FontCommands.$15(0,["SUP"],null,null);RTE.FontCommands.$3d(0,["SUB"],null,null,null,null);RTE.Canvas.$O()};RTE.FontCommands.$KV=function(){ULSNVe:;return RTE.FontCommands.$4A(0,["SUB"],null,null,null,null)};RTE.FontCommands.$LW=function(){ULSNVe:;RTE.FontCommands.$15(0,["SUB"],null,null);RTE.FontCommands.$3d(0,["SUP"],null,null,null,null);RTE.Canvas.$O()};RTE.FontCommands.$KW=function(){ULSNVe:;return RTE.FontCommands.$4A(0,["SUP"],null,null,null,null)};RTE.FontCommands.$La=function(){ULSNVe:;RTE.FontCommands.$3d(2,null,null,"textDecoration","underline","none");RTE.Canvas.$O()};RTE.FontCommands.$KX=function(){ULSNVe:;return RTE.FontCommands.$4A(2,null,null,"textDecoration","underline","none")};RTE.FontCommands.$LE=function(a){ULSNVe:;RTE.FontCommands.$AS(3,null,null,"xml:lang",a,null);RTE.FontCommands.$AS(3,null,null,"lang",a,null)};RTE.FontCommands.$IK=function(){ULSNVe:;var c=RTE.Cursor.get_range();if(!c.isValid())return"";var b="",g=c.getCurrentStateNode(),a=g;while(a&&!RTE.Canvas.$i(a)){if(a.getAttribute){var d=a.getAttribute("lang");if(d){b=d;break}}a=a.parentNode}if(RTE.FontCommands.$91){RTE.FontCommands.$91=false;return b}if(b){var e=RTE.Canvas.getCurrentStyleSheetPrefix(),f=RTE.StyleRuleUtility.getStyleRules(e+RTE.RichTextEditor.$6c+"-"+b,e,false);if(f.length>0)return RTE.StyleRuleUtility.$2F(f[0],null,null)}return b};RTE.FontCommands.get_$6N=function(){ULSNVe:;var a=RTE.Canvas.getCurrentStyleSheetPrefix();return[a+"Style-"]};RTE.FontCommands.$5W=function(b,c){ULSNVe:;var a=2;if(c)a=1;RTE.FontCommands.$3b(a,null,["ForeColor","ThemeForeColor"],"color",b,"",null,RTE.FontCommands.get_$6N(),1)};RTE.FontCommands.$L6=function(b,c){ULSNVe:;var a=2;if(c)a=1;RTE.FontCommands.$3b(a,null,["BackColor","ThemeBackColor"],"backgroundColor",b,"",null,RTE.FontCommands.get_$6N(),1)};RTE.FontCommands.$LF=function(b,c){ULSNVe:;if(!RTE.SU.$2(b)){var a=RTE.Canvas.getCurrentStyleSheetPrefix();if(c||RTE.SU.$1R(c)){var d=a+"Style-"+b;RTE.FontCommands.$3b(1,null,[a+"Style-",a+"BackColor-",a+"ForeColor-",a+"ThemeBackColor-",a+"ThemeForeColor-"],null,d,"",["color","backgroundColor"],null,1)}else RTE.FontCommands.$15(1,null,[a+"Style-"],null)}};RTE.FontCommands.$If=function(){ULSNVe:;var b=RTE.Cursor.get_range(),c=RTE.Canvas.currentEditableRegion(),a=b.parentElement();if(!a||a.nodeType!==1)return null;var d=a.tagName.toUpperCase();while(a&&a.nodeType===1&&RTE.RteUtility.getCssClassName(a).indexOf("Element")===-1&&!RTE.HtmlTagName.$7q[d]&&a.parentNode!==c)a=a.parentNode;return a&&a.nodeType===1?a:null};RTE.FontCommands.$Ii=function(){ULSNVe:;return RTE.FontCommands.$IP("Style")};RTE.FontCommands.$IP=function(c){ULSNVe:;var b=RTE.Cursor.get_range(),a=b.parentElement();while(a&&!a.className&&a.className.indexOf(c)===-1&&a.tagName.toUpperCase()==="SPAN")a=a.parentNode;return a};RTE.FontCommands.$B6=function(i,m){ULSNVe:;var d=RTE.Cursor.get_range(),h=d.getEditableRegion(),f="";if(!RTE.Canvas.getCachedRestriction(h,"UseInlineStyle",false))f=m;var j=d.$3_0,c=d.$4_0,e=RTE.RteUtility.$m(c,false);e&&e.nodeType===1&&e.tagName==="BR"&&e.parentNode.insertBefore(c,e);var a=new RTE.DOMTreePosition(j,0);a.moveToNextElement();if(a.$1_0!==c)while(a.$1_0!==c){var b=a.$1_0;if(!RTE.RteUtility.$Q(b)&&!RTE.RteUtility.$53(b.parentNode.tagName.toUpperCase(),RTE.FontCommands.$DQ)&&RTE.Canvas.isEditable(b)&&!SP.UI.UIUtility.isSvgNode(b)&&!RTE.RteUtility.$3y(b)&&!RTE.RteUtility.$3u(b,false)){var k=RTE.RteUtility.$Bx(b,c,true),g=RTE.FontCommands.$AX(k,i,f);if(RTE.RteUtility.$b(c,g,h)||g.tagName==="HR")break;a.setCurrentNode(g);a.setLocationAtEnd()}a.moveToNextElement()}else{var l=RTE.RteUtility.$6G(d.$3_0,true);RTE.FontCommands.$AX(l,i,f)}d.resetCacheRange();RTE.Cursor.update()};RTE.FontCommands.$AX=function(a,h,e){ULSNVe:;var c=document.createElement(h);if(!RTE.SU.$2(e))c.className=e;var d=a.tagName.toUpperCase();RTE.SnapshotManager.setCurrentRegionDirtyIf(h!==a.tagName||!RTE.SU.$2(e)&&(RTE.SU.$2(a.className)||a.className.indexOf(e)===-1));if(d==="TR"||d==="THEAD"||d==="TBODY"||d==="TFOOT")a=RTE.RteUtility.$G(a,"TABLE");var f=RTE.Cursor.get_range();if(h.toUpperCase()==="HR"){f.deleteContent();f.insertNode(c);f.moveAfterNode(c)}else{var b=null;if(d==="H1"||d==="H2"||d==="H3"||d==="H4"||d==="H5"||d==="H6"||d==="P"){b=document.createElement("DIV");a.parentNode.insertBefore(b,a);b.appendChild(a)}var g=new RTE.CanvasRange("block");g.moveToChildren(a);var i=RTE.RemoveStyleOnSelectionProcessor.$22;i.setSettings(g,false);i.process();g.dispose();if(b)if(b.firstChild&&b.firstChild===b.lastChild&&RTE.RteUtility.$Q(b.firstChild)&&RTE.SU.$2(b.className)&&RTE.SU.$2(b.style.cssText)){a=b.childNodes[0];RTE.RteUtility.$4N(b);b.parentNode.removeChild(b)}else a=b;if(RTE.Canvas.$i(a)){RTE.RteUtility.$k(a,c);a.appendChild(c)}else if(a.tagName==="LI"||a.tagName==="TD"||a.tagName==="TH"){RTE.RteUtility.$k(a,c);a.appendChild(c)}else if(a.tagName==="UL"||a.tagName==="OL"||a.tagName==="MENU"||a.tagName==="DIR"||a.tagName==="TABLE"){a.parentNode.insertBefore(c,a);c.appendChild(a)}else{a.parentNode.insertBefore(c,a);RTE.RteUtility.$k(a,c);RTE.RteUtility.$J(a)}}return c};RTE.FontCommands.$9r=function(b,c){ULSNVe:;var a=2;if(c)a=1;RTE.FontCommands.$3b(a,null,["FontSize"],"fontSize",b,"",null,RTE.FontCommands.get_$6N(),1)};RTE.FontCommands.$LA=function(b,c){ULSNVe:;var a=2;if(c)a=1;RTE.FontCommands.$3b(a,null,["FontFace","ThemeFontFace"],"fontFamily",b,"",null,RTE.FontCommands.get_$6N(),1)};RTE.FontCommands.$15=function(c,d,e,f){ULSNVe:;var a=RTE.Cursor.get_range();if(!a.get_isInEditableRegion())return;var b=RTE.ApplyOnSelectionProcessor.$22;b.setSettings(a,c,d,e,f,null,null);b.remove();RTE.Cursor.update()};RTE.FontCommands.$3d=function(c,d,e,f,g,h){ULSNVe:;var a=RTE.Cursor.get_range();if(!a.get_isInEditableRegion())return;var b=RTE.ApplyOnSelectionProcessor.$22;b.setSettings(a,c,d,e,f,g,h);b.process();RTE.Cursor.update()};RTE.FontCommands.$AS=function(a,b,c,d,e,f){ULSNVe:;RTE.FontCommands.$3b(a,b,c,d,e,f,null,null,0)};RTE.FontCommands.$3b=function(c,d,e,f,g,h,i,j,k){ULSNVe:;var a=RTE.Cursor.get_range();if(!a.get_isInEditableRegion())return;var b=RTE.ApplyOnSelectionProcessor.$22;b.setSettings(a,c,d,e,f,g,h,i,k,j);b.apply();RTE.Cursor.update()};RTE.FontCommands.$4A=function(d,e,f,g,h,i){ULSNVe:;var c=new RTE.CommandState,a=RTE.Cursor.get_range();if(!a.isValid()||!a.get_isInEditableRegion())return c;var b=RTE.ApplyOnSelectionProcessor.$22;b.setSettings(a,d,e,f,g,h,i);return b.queryApply()};RTE.FontCommands.$E3=function(){ULSNVe:;var a=RTE.Cursor.get_range();if(!a.get_isInEditableRegion())return;if(!a.isVisible())return;var b=RTE.RemoveStyleOnSelectionProcessor.$22;b.setSettings(a,true);b.process();RTE.Cursor.get_range().resetCacheRange();RTE.Cursor.update();RTE.Canvas.$O()};RTE.FontCommands.$IH=function(){ULSNVe:;for(var n=RTE.Canvas.getCurrentStyleSheetPrefix(),o=RTE.StyleRuleUtility.getStyleRules(n+"FontSize",n,false),c=[],g=[],h=[],i=[],j=[],k=[],l=[],m=0;m<o.length;m++){var p=o[m],q=RTE.StyleRuleUtility.$2c(p.rule.selectorText);if(RTE.SU.$2(q))continue;var a=p.rule.style.fontSize;if(RTE.SU.$2(a))continue;var d=1,r=0,b=null;if(a.toLowerCase().endsWith("pt")){d=0;b=g}else if(a.toLowerCase().endsWith("em")){d=2;b=h}else if(a.toLowerCase().endsWith("px")){d=1;b=i}else if(a.toLowerCase().endsWith("in")){d=4;b=j}else if(a.toLowerCase().endsWith("cm")){d=3;b=k}else if(a.toLowerCase().endsWith("mm")){d=5;b=l}if(b){r=parseFloat(a);var f=new RTE.FontSizeInfo;f.className=q;f.size=r;f.unit=d;Array.add(b,f)}}var e=RTE.FontCommands.$Ht;k.sort(e);h.sort(e);j.sort(e);l.sort(e);g.sort(e);i.sort(e);Array.add(c,g);Array.add(c,i);Array.add(c,h);Array.add(c,k);Array.add(c,j);Array.add(c,l);return c};RTE.FontCommands.$Ht=function(c,d){ULSNVe:;var a=c,b=d;return a.size<b.size?-1:a.size===b.size?0:1};RTE.FontCommands.initFontSizeDropDownMenu=function(){ULSNVe:;RTE.RteUtility.classMustExist("CUI.JsonXmlElement");return RTE.FontCommands.$KJ()};RTE.FontCommands.$KJ=function(){ULSNVe:;for(var h=RTE.FontCommands.$IH(),e=[SP.Res.fontSizeUnitPt,SP.Res.fontSizeUnitPx,SP.Res.fontSizeUnitEm,SP.Res.fontSizeUnitIn,SP.Res.fontSizeUnitMm],f=new CUI.JsonXmlElement("Menu",{Id:"Ribbon.EditingTools.CPEditTab.Font.FontSize.Menu"}),g=null,a=0;a<e.length;a++){var b=h[a];if(!b||!b.length)continue;for(var i=f.appendChild("MenuSection",{Id:"msFontSize-"+a.toString(),Title:e[a],Description:"",Scrollable:"false"}).appendChild("Controls",null),c=0;c<b.length;c++){var d=b[c];if(!g)g=d;i.appendChild("Button",{Id:"fseaFontSize-"+a.toString()+"-"+c.toString(),LabelText:d.size.toString(),LabelStyle:"ms-ribbon-FontSizea",CommandValueId:d.className,Command:"FontSizeCssClass",CommandPreview:"FontSizeCssClassPreview",CommandRevert:"FontSizeCssClassPreviewRevert"})}}return f};RTE.FontCommands.$E7=function(d,b){ULSNVe:;var k=RTE.Cursor.get_range();if(!k.isValid())return"";var l=k.getCurrentStateNode(),e=null,c=null,a=l;while(a){if(a.style&&!RTE.SU.$2(a.style[b]))break;else if(a.className&&RTE.RteUtility.$3C(d,RTE.RteUtility.getCssClassName(a)))for(var n=a.className.split(" "),u=n.length,f=0;f<u;f++)for(var g=n[f],v=d.length,h=0;h<v;h++){var o=g.indexOf(d[h]);if(o!==-1){e=g;c=g.substr(0,o);a=null;break}}if(a)a=a.parentNode}if(e){var p=RTE.StyleRuleUtility.getStyleRules(e,c,true);if(p.length>0)return RTE.StyleRuleUtility.$2F(p[0],null,b)}if(RTE.SU.$2(b))return"";var s=RTE.RteUtility.$1c(l),m=RTE.StyleRuleUtility.$8E(s,b);c=RTE.Canvas.getCurrentStyleSheetPrefix();for(var t=d.length,i=0;i<t;i++)for(var q=RTE.StyleRuleUtility.getStyleRules(c+d[i],c,true),w=q.length,j=0;j<w;j++){var r=q[j],x=RTE.StyleRuleUtility.$8E(r.rule.style,b);if(x.toUpperCase()===m.toUpperCase())return RTE.StyleRuleUtility.$2F(r,null,b)}return m};RTE.FontCommands.$IG=function(){ULSNVe:;var a=RTE.FontCommands.$E7(["FontSize"],"fontSize");if(RTE.FontCommands.$8u!==a){RTE.FontCommands.$8u=a;var b=RTE.RteUtility.parseUnitValue(a);if(b&&!RTE.SU.$2(b.unit))RTE.FontCommands.$8v=b.unit}return a};RTE.FontCommands.initFontFamilyDropDownMenu=function(){ULSNVe:;RTE.RteUtility.classMustExist("CUI.JsonXmlElement");return RTE.FontCommands.$KI()};RTE.FontCommands.$KI=function(){ULSNVe:;for(var c=RTE.Canvas.getCurrentStyleSheetPrefix(),d=[c+"ThemeFontFace",c+"FontFace"],m=RTE.StyleRuleUtility.getStyleRules(d[1],c,false),n=RTE.StyleRuleUtility.getStyleRules(d[0],c,false),f=null,o=RTE.FontCommands.$B2(m,d[1]),p=RTE.FontCommands.$B2(n,d[0]),g=[SP.Res.themeFonts,SP.Res.fonts],q=["FontFamilyThemeClass","FontFamilyCssClass"],r=["FontFamilyThemeClassPreview","FontFamilyCssClassPreview"],s=["FontFamilyThemeClassPreviewRevert","FontFamilyCssClassPreviewRevert"],h=new CUI.JsonXmlElement("Menu",{Id:"Ribbon.EditingTools.CPEditTab.Font.FontSize.Menu"}),a=0;a<g.length;a++){var b;if(!a)b=p;else b=o;if(!b||!b.length)continue;for(var t=h.appendChild("MenuSection",{Id:"msFontFamily-"+a.toString(),Title:g[a],Description:"",Scrollable:"false"}).appendChild("Controls",null),e=0;e<b.length;e++){var i=b[e],j=i.$3r_0,u=j.rule.selectorText,v=RTE.StyleRuleUtility.$2c(u),k=i.$8I_0;if(!f)f=k;var l=j.rule.style.fontFamily,w=RTE.SU.$2(l)?"":"font-family:"+l;t.appendChild("Button",{Id:"fseaFont-"+a.toString()+"-"+e.toString(),LabelText:k,LabelCss:w,CommandValueId:v,Command:q[a],CommandPreview:r[a],CommandRevert:s[a]})}}return h};RTE.FontCommands.$IF=function(){ULSNVe:;return RTE.FontCommands.$E7(["ThemeFontFace","FontFace"],"fontFamily")};RTE.FontCommands.$B2=function(d,f){ULSNVe:;for(var c=new Array(d.length),b=0;b<d.length;b++){var a=new RTE.FontFamilyInfo;a.$3r_0=d[b];var e=RTE.StyleRuleUtility.$36(a.$3r_0.rule.selectorText,f+"-");a.$8I_0=RTE.StyleRuleUtility.$2F(a.$3r_0,e,"fontFamily");a.$8y_0=a.$8I_0.toLowerCase();c[b]=a}c.sort(RTE.FontCommands.$Hs);return c};RTE.FontCommands.$Hs=function(c,d){ULSNVe:;var a=c,b=d;return a.$8y_0.localeCompare(b.$8y_0)};RTE.FontCommands.initFontColorMenu=function(){ULSNVe:;RTE.RteUtility.classMustExist("CUI.JsonXmlElement");return RTE.FontCommands.$CL("Ribbon.EditingTools.CPEditTab.Font.FontColor.Menu","ForeColor","ThemeForeColor","color","ColorCssClass","ColorCssClassPreview","ColorCssClassPreviewRevert","ColorThemeClass","ColorThemeClassPreview","ColorThemeClassPreviewRevert","ColorCustom")};RTE.FontCommands.initFontBackgroundColorMenu=function(){ULSNVe:;return RTE.FontCommands.$CL("Ribbon.EditingTools.CPEditTab.Font.FontBackgroundColor.Menu","BackColor","ThemeBackColor","backgroundColor","BackgroundColorCssClass","BackgroundColorCssClassPreview","BackgroundColorCssClassPreviewRevert","BackgroundColorThemeClass","BackgroundColorThemeClassPreview","BackgroundColorThemeClassPreviewRevert","BackgroundColorCustom")};RTE.FontCommands.$CL=function(a,i,j,d,k,l,m,n,o,p,e){ULSNVe:;var c=RTE.Canvas.getCurrentStyleSheetPrefix(),b=new CUI.JsonXmlElement("Menu",{Id:a}),f=b.appendChild("MenuSection",{Id:a+".MsTheme",Title:SP.Res.colorPickerThemeHeaderText}).appendChild("Controls",{Id:a+".MsTheme.Controls"});RTE.FontCommands.$Ab(f,a+"themeColor",c+j,d,n,o,p);var g=b.appendChild("MenuSection",{Id:a+".Ms",Title:SP.Res.colorPickerStandardHeaderText}).appendChild("Controls",{Id:a+".Ms.Controls"});RTE.FontCommands.$Ab(g,a+"standardColor",c+i,d,k,l,m);var h=b.appendChild("MenuSection",{Id:a+".MsCustom"}).appendChild("Controls",{Id:a+".MsCustom.Controls"});h.appendChild("Button",{Id:a+"customColor",LabelText:SP.Res.colorPickerMoreColorsText,Image16by16:"/_layouts/images/customcolors.png",CommandType:"General",Command:e});return b};RTE.FontCommands.$Ab=function(n,o,j,e,p,q,r){ULSNVe:;for(var k=n.appendChild("ColorPicker",{Id:o,Command:p,CommandPreview:q,CommandRevert:r}).appendChild("Colors",null),l=RTE.Canvas.getCurrentStyleSheetPrefix(),b=RTE.StyleRuleUtility.getStyleRules(j,l,false),a=0;a<b.length;a++){var c=b[a],f=c.rule.selectorText,m=RTE.StyleRuleUtility.$2c(f),g=RTE.StyleRuleUtility.$36(f,j+"-"),h=b[a].rule.style[e],d=RTE.StyleRuleUtility.$IU(c,g,e),i=RTE.StyleRuleUtility.$2F(c,g,e);if(!RTE.SU.$2(i))d=d+", "+i;k.appendChild("Color",{Title:d,Style:m,DisplayColor:h,Color:h})}};RTE.HtmlFormat=function(){};RTE.HtmlFormat.formatHtml=function(b){ULSNVe:;var d=new RTE.HtmlAndSelection;try{b=RTE.RteUtility.$Kh(b);var g=new Sys.StringBuilder,a=0,h=null,e=[],p=b.search(RTE.HtmlFormat.$BD),q=b.search(RTE.HtmlFormat.$BB),m=-1,n=-1,r=false,i=false,f=-1;do{var c=b.indexOf("<"+(h?"/"+h:""),a),v=p!==-1&&c===p||q!==-1&&c===q;if(c!==a){var w=c!==-1?c:b.length,j=b.substring(a,w);j=!h&&f===-1?RTE.HtmlFormat.$Kr(j):j;r=RTE.HtmlFormat.$Ey(g,j);if(c===-1)break;a=c;if(f===-1&&j.trim().length>0||f!==-1&&j.length>0)i=false}if(v){if(p===c)m=g.toString().length;if(q===c)n=g.toString().length;a=b.indexOf("</span>",a);if(a===-1)break;a+=7}else if(b.indexOf("/",a)===a+1){h=null;a++;var s=b.indexOf(">",c),o=b.substring(a+1,s);if(RTE.HtmlFormat.$JS(e,o))while(e.length>0&&e.pop()!==o);if(f>e.length)f=-1;RTE.HtmlFormat.$Ew(g,e.length,o,i);a=s+1;i=RTE.RteUtility.$4w(o)}else{h=null;var k=b.indexOf(">",c),x=b.indexOf("/",k-1)===k-1,t=b.substring(a+1,k).replace(RTE.HtmlFormat.$9S,"");RTE.HtmlFormat.$Ex(g,e.length,t,r||i);if(!x){i=false;var u=b.indexOf(" ",c),l=b.substring(a+1,u!==-1?Math.min(k,u):k);if(!RTE.HtmlFormat.$JJ(l)){h=RTE.HtmlFormat.$JP(l)?l:null;e.push(l);i=RTE.RteUtility.$4w(l);if(f===-1)if(l.toUpperCase()==="PRE"||RTE.HtmlFormat.$Ek.test(t))f=e.length}}a=k+1}}while(a!==-1&&a<b.length);d.html=g.toString();if(m!==-1&&n!==-1&&(m!==n||m!==d.html.length)){d.selectionStart=m;d.selectionEnd=n}}catch(y){d.html=RTE.RteUtility.$4B(b,false,false);d.selectionStart=0;d.selectionEnd=0}return d};RTE.HtmlFormat.$JS=function(c,d){ULSNVe:;for(var b=c,a=b.length-1;a>=0;a--)if(b[a]===d)return true;return false};RTE.HtmlFormat.$JP=function(a){ULSNVe:;if(!RTE.HtmlFormat.$2q){RTE.HtmlFormat.$2q={};RTE.HtmlFormat.$2q.SCRIPT=null;RTE.HtmlFormat.$2q.XML=null;RTE.HtmlFormat.$2q.STYLE=null}return!RTE.SU.$1R(RTE.HtmlFormat.$2q[a.toUpperCase()])};RTE.HtmlFormat.getSkipTags=function(){ULSNVe:;var a=new Array(0),b=RTE.HtmlFormat.$2q.getEnumerator();while(b.moveNext()){var c=b.get_current();a[a.length]=c}return a};RTE.HtmlFormat.$JJ=function(a){ULSNVe:;if(!RTE.HtmlFormat.$39){RTE.HtmlFormat.$39={};RTE.HtmlFormat.$39.BR=null;RTE.HtmlFormat.$39.IMG=null;RTE.HtmlFormat.$39.HR=null}return!RTE.SU.$1R(RTE.HtmlFormat.$39[a.toUpperCase()])};RTE.HtmlFormat.$Ey=function(b,a){ULSNVe:;if(!RTE.SU.$2(a)){b.append(a);return a.endsWith(" ")}return false};RTE.HtmlFormat.$Ex=function(a,d,b,e){ULSNVe:;var c=b.split(" ")[0];if(e||RTE.RteUtility.$4w(c)&&!a.isEmpty()){a.append("\n");RTE.HtmlFormat.$Bj(a,d)}a.append("<"+b+">")};RTE.HtmlFormat.$Ew=function(a,c,b,d){ULSNVe:;if(d&&RTE.RteUtility.$4w(b)){a.append("\n");RTE.HtmlFormat.$Bj(a,c)}a.append("</"+b.trim()+">")};RTE.HtmlFormat.$Bj=function(b,c){ULSNVe:;for(var a=0;a<c;a++)b.append("   ")};RTE.HtmlFormat.$Kr=function(f){ULSNVe:;for(var c=f.split(RTE.HtmlFormat.$9S),b=0;b<c.length;b++){var a=c[b],d=!b,e=b===c.length-1;if(!d&&!e)a=a.trim();else if(d&&!e)a=a.trimEnd();else if(!d)a=a.trimStart();if(a.length>0&&!e)a=a+" ";c[b]=a}var g=f.startsWith("\n")?" ":"",h=c.join("");return g+h};RTE.HtmlAndSelection=function(){};RTE.HtmlAndSelection.prototype={html:null,selectionStart:0,selectionEnd:0};RTE.HtmlSourceCommands=function(){};RTE.HtmlSourceCommands.editSource=function(){ULSNVe:;var a=RTE.Canvas.currentEditableRegion();if(!a)return;var b=new RTE.EditHtmlSourceDialog(a);b.show()};RTE.EditHtmlSourceDialog=function(a){ULSNVe:;this.$$d_$E4_0=Function.createDelegate(this,this.$E4_0);this.$$d_$Kw_0=Function.createDelegate(this,this.$Kw_0);this.$$d_$Jt_0=Function.createDelegate(this,this.$Jt_0);this.$$d_$KB_0=Function.createDelegate(this,this.$KB_0);this.$$d_$7U_0=Function.createDelegate(this,this.$7U_0);this.$$d_$JZ_0=Function.createDelegate(this,this.$JZ_0);this.$z_0=a};RTE.EditHtmlSourceDialog.$DH=function(b,a,i){ULSNVe:;if(i){var e=b.lastIndexOf("<",a-1),g=b.lastIndexOf(">",a-1);if(e!==-1&&(g===-1||g<e))a=e}else{var h=b.indexOf("<",a),f=b.indexOf(">",a);if(f!==-1&&(h===-1||f<h))a=f+1}var d=b.lastIndexOf("&",a-1),c=b.lastIndexOf(";",a-1);if(d!==-1&&(c===-1||c<d)){c=b.indexOf(";",a);if(a-15<d&&c!==-1&&c<a+15)a=d}a=RTE.EditHtmlSourceDialog.$Jj("TABLE",["TD","TH"],b,a);a=RTE.EditHtmlSourceDialog.$9C("TEXTAREA",b,a);a=RTE.EditHtmlSourceDialog.$9C("IFRAME",b,a);a=RTE.EditHtmlSourceDialog.$9C("INPUT",b,a);return a};RTE.EditHtmlSourceDialog.$Jj=function(k,l,b,a){ULSNVe:;var g=RTE.RteUtility.$3R(b,RTE.EditHtmlSourceDialog.$3e(k,true),a),f=RTE.RteUtility.$3R(b,RTE.EditHtmlSourceDialog.$3e(k,false),a);if(f!==-1&&(g===-1||f<g)){for(var c=-1,d=0;d<l.length;d++){var h=l[d],e=RTE.RteUtility.$3R(b,RTE.EditHtmlSourceDialog.$3e(h,true),a),i=RTE.RteUtility.$3R(b,RTE.EditHtmlSourceDialog.$3e(h,false),a);if(i!==-1&&(e===-1||e>i))return a;if(e!==-1){var j=b.indexOf(">",e+1)+1;c=!d?j:Math.min(c,j)}}a=c!==-1?c:b.indexOf(">",f+1)+1}return a};RTE.EditHtmlSourceDialog.$9C=function(e,c,a){ULSNVe:;var f=RTE.EditHtmlSourceDialog.$3e(e,true),g=RTE.EditHtmlSourceDialog.$3e(e,false),d=RTE.RteUtility.$3R(c,f,a),b=RTE.RteUtility.$3R(c,g,a);if(b!==-1&&(d===-1||b<d))a=c.indexOf(">",b+1)+1;return a};RTE.EditHtmlSourceDialog.$3e=function(a,b){ULSNVe:;return b?new RegExp("<\\s*"+a+"[^>]*>","gi"):new RegExp("<\\s*/\\s*"+a+"[^>]*>","gi")};RTE.EditHtmlSourceDialog.prototype={$z_0:null,$2g_0:null,$M_0:null,$g_0:null,show:function(){ULSNVe:;RTE.RteUtility.classMustExist("SP.UI.ModalDialog");RTE.RteUtility.classMustExist("SP.PageContextInfo");RTE.PasteFlyout.hide();var b=RTE.Canvas.getEditableRegionHtml(this.$z_0,true);this.$g_0=RTE.HtmlFormat.formatHtml(b);var a=new SP.UI.DialogOptions;a.html=this.$FG_0();a.width=750;a.height=550;a.title=SP.Res.editHtmlSourceTitle;a.showMaximized=true;a.allowMaximize=true;this.$2g_0=SP.UI.ModalDialog.showModalDialog(a);this.$KD_0()},$LB_0:function(c){ULSNVe:;if(c===1){RTE.Cursor.$EP(SP.Res.dialogLoading15);var b=this.$IJ_0(),a=this;RTE.EmbeddingCommands.$Ks(b,this.$z_0,function(b,c){ULSNVe:;RTE.RteUtility.$9t(a.$z_0,b);var d=RTE.SafeHtml.$Km(a.$z_0);(c||d)&&RTE.RteUtility.isClassAvailable("SP.UI.Notify")&&SP.UI.Notify.addNotification("<b>"+SP.Res.htmlSourceChangedTitle+":</b> "+SP.Res.htmlSourceChangedText15,false);RTE.Cursor.get_range().moveToMarkersPlaceholders(a.$z_0,"ms-rterangeselectionplaceholder");RTE.Cursor.$CE();a.$ED_0()})}else this.$ED_0()},$ED_0:function(){ULSNVe:;if(RTE.RteUtility.isSafari()){var a=RTE.ScrollPosition.$7t(this.$z_0);this.$z_0.focus();RTE.ScrollPosition.$7k(a)}RTE.Cursor.update()},$FG_0:function(){ULSNVe:;var e=document.createElement("DIV");$addHandler(e,"keypress",this.$$d_$JZ_0);var c=document.createElement("DIV");c.className="ms-input-divAroundTextArea ms-fullWidth";c.style.height="100%";c.style.marginBottom="24px";e.appendChild(c);this.$M_0=document.createElement("TEXTAREA");this.$M_0.style.width="100%";this.$M_0.style.height="100%";this.$M_0.style.margin="0px";this.$M_0.style.border="transparent";this.$M_0.className="ms-rte-srcdialog-text ms-fullWidth";this.$M_0.id="PropertyEditor";this.$M_0.dir=this.$z_0.dir;this.$M_0.value=this.$g_0.html;$addHandler(this.$M_0,"keyup",this.$$d_$7U_0);$addHandler(this.$M_0,"mousedown",this.$$d_$7U_0);$addHandler(this.$M_0,"mouseup",this.$$d_$7U_0);c.appendChild(this.$M_0);var d=document.createElement("DIV");d.className="ms-core-form-bottomButtonBox";e.appendChild(d);var a=document.createElement("INPUT");a.type="button";$addHandler(a,"click",this.$$d_$KB_0);a.value=SP.Res.okButtonText;a.className="ms-ButtonHeightWidth";a.id="sourcedialog_okbutton";d.appendChild(a);d.appendChild(document.createTextNode(RTE.RteUtility.$7v));var b=document.createElement("INPUT");b.type="button";$addHandler(b,"click",this.$$d_$Jt_0);b.value=SP.Res.cancelButtonText;b.id="sourcedialog_cancelbutton";b.className="ms-ButtonHeightWidth";d.appendChild(b);return e},$KB_0:function(){ULSNVe:;if(this.$2g_0){this.$g_0.html=this.$M_0.value;this.$87_0(1)}},$Jt_0:function(){ULSNVe:;this.$87_0(0)},$KD_0:function(){ULSNVe:;try{$addHandler(this.$2g_0.get_dialogElement(),"click",this.$$d_$Kw_0);$addHandler(this.$2g_0.get_dialogElement(),"dblclick",this.$$d_$Kw_0);$addHandler(window,"resize",this.$$d_$Kw_0);this.$E4_0();this.$EI_0(this.$M_0,this.$g_0.selectionStart,this.$g_0.selectionEnd,true);var a=this;window.setTimeout(function(){ULSNVe:;a.$M_0.focus();a.$7U_0(null)},0)}catch(b){}},$Kw_0:function(){ULSNVe:;window.setTimeout(this.$$d_$E4_0,0)},$E4_0:function(){ULSNVe:;var a=this.$2g_0.get_html().parentNode.clientHeight;this.$M_0.parentNode.style.height=a-80+"px"},$7U_0:function(){ULSNVe:;if(this.$M_0)if(typeof this.$M_0.selectionStart!=="undefined"&&!RTE.RteUtility.isInternetExplorer()){this.$g_0.selectionStart=this.$M_0.selectionStart;this.$g_0.selectionEnd=this.$M_0.selectionEnd}else if(document.selection){var a=document.selection.createRange(),b=a.duplicate();b.moveToElementText(this.$M_0);b.setEndPoint("EndToEnd",a);var d=b.text.length,c=a.text.length;this.$g_0.selectionStart=d-c;this.$g_0.selectionEnd=this.$g_0.selectionStart+c}},$JZ_0:function(a){ULSNVe:;if(a.charCode===27){a.target===this.$M_0&&this.$7U_0(null);this.$87_0(0)}else a.target===this.$M_0&&a.charCode===13&&this.$Ep_0(a)},$Ep_0:function(f){ULSNVe:;this.$7U_0(null);var b=this.$M_0.value,d=b.lastIndexOf("\n",this.$g_0.selectionStart-1);if(d>=0){var c="";while(b.charAt(d+1)===" "){c+=" ";d++}if(c.length>0)if(document.selection){var e=document.selection.createRange();e.text="\r\n"+c;e.collapse(false);e.select();SP.UI.UIUtility.cancelEvent(f)}else{var a=this;window.setTimeout(function(){ULSNVe:;var d=a.$M_0.scrollTop;b=b.substring(0,a.$g_0.selectionStart)+"\n"+c+b.substring(a.$g_0.selectionEnd,b.length);a.$M_0.value=b;a.$M_0.scrollTop=d;a.$EI_0(a.$M_0,a.$g_0.selectionStart+c.length+1,a.$g_0.selectionStart+c.length+1,false)},0)}}},$EI_0:function(a,c,d,e){ULSNVe:;if(a.createTextRange){var b=a.createTextRange();b.collapse(true);b.moveEnd("character",d);b.moveStart("character",c);b.select()}else if(a.setSelectionRange){a.setSelectionRange(c,d);e&&this.$L1_0(a,c,d)}this.$g_0.selectionStart=c;this.$g_0.selectionEnd=d},$L1_0:function(a,b,d){ULSNVe:;if(!b){a.scrollTop=0;return}var c=document.createEvent("KeyboardEvent");if(c.initKeyEvent){a.setSelectionRange(b,d);c.initKeyEvent("keypress",true,true,window,false,false,false,false,0,32);a.dispatchEvent(c);c=document.createEvent("KeyboardEvent");c.initKeyEvent("keypress",true,true,window,false,false,false,false,8,0);a.dispatchEvent(c);a.setSelectionRange(b,d)}else{a.setSelectionRange(b,b);a.blur();a.focus();if(b!==d){var e=this;window.setTimeout(function(){ULSNVe:;a.setSelectionRange(b,d)},0)}}},$87_0:function(a){ULSNVe:;if(this.$2g_0){$removeHandler(window,"resize",this.$$d_$Kw_0);this.$2g_0.close(1);this.$2g_0=null;this.$M_0=null;this.$LB_0(a)}},$IJ_0:function(){ULSNVe:;var a=this.$g_0.html,b=this.$g_0.selectionStart,c=this.$g_0.selectionEnd,d=RTE.Canvas.getCachedRestriction(this.$z_0,"AllowScripts",false);if(!d&&!RTE.SU.$2(a)&&!RTE.SU.$7(b)&&!RTE.SU.$7(c)){b=RTE.EditHtmlSourceDialog.$DH(a,b,true);c=RTE.EditHtmlSourceDialog.$DH(a,c,false);a=a.substring(0,b)+"<span id='ms-rterangeselectionplaceholder-start'></span>"+a.substring(b,c)+"<span id='ms-rterangeselectionplaceholder-end'></span>"+a.substring(c,a.length)}return a}};RTE.ShortcutKeys=function(){};RTE.ShortcutKeys.initializeDictionary=function(){ULSNVe:;if(!RTE.SU.$7(RTE.ShortcutKeys.$u))return;RTE.ShortcutKeys.$u={};var a;a=SP.Res.keyboardShortcutUndo_Ctrl+SP.Res.keyboardShortcutUndo_Alt+SP.Res.keyboardShortcutUndo_Shift+SP.Res.keyboardShortcutUndo_AccessKey;RTE.ShortcutKeys.$u[a]="Undo";a=SP.Res.keyboardShortcutRedo_Ctrl+SP.Res.keyboardShortcutRedo_Alt+SP.Res.keyboardShortcutRedo_Shift+SP.Res.keyboardShortcutRedo_AccessKey;RTE.ShortcutKeys.$u[a]="Redo";a=SP.Res.keyboardShortcutSelectAll_Ctrl+SP.Res.keyboardShortcutSelectAll_Alt+SP.Res.keyboardShortcutSelectAll_Shift+SP.Res.keyboardShortcutSelectAll_AccessKey;RTE.ShortcutKeys.$u[a]="SelectAll";a=SP.Res.keyboardShortcutClearFormatting_Ctrl+SP.Res.keyboardShortcutClearFormatting_Alt+SP.Res.keyboardShortcutClearFormatting_Shift+SP.Res.keyboardShortcutClearFormatting_AccessKey;RTE.ShortcutKeys.$u[a]="ClearFormatting";a=SP.Res.keyboardShortcutBold_Ctrl+SP.Res.keyboardShortcutBold_Alt+SP.Res.keyboardShortcutBold_Shift+SP.Res.keyboardShortcutBold_AccessKey;RTE.ShortcutKeys.$u[a]="Bold";a=SP.Res.keyboardShortcutItalic_Ctrl+SP.Res.keyboardShortcutItalic_Alt+SP.Res.keyboardShortcutItalic_Shift+SP.Res.keyboardShortcutItalic_AccessKey;RTE.ShortcutKeys.$u[a]="Italics";a=SP.Res.keyboardShortcutUnderline_Ctrl+SP.Res.keyboardShortcutUnderline_Alt+SP.Res.keyboardShortcutUnderline_Shift+SP.Res.keyboardShortcutUnderline_AccessKey;RTE.ShortcutKeys.$u[a]="Underline";a=SP.Res.keyboardShortcutIndent_Ctrl+SP.Res.keyboardShortcutIndent_Alt+SP.Res.keyboardShortcutIndent_Shift+SP.Res.keyboardShortcutIndent_AccessKey;RTE.ShortcutKeys.$u[a]="IncreaseIndent";a=SP.Res.keyboardShortcutOutdent_Ctrl+SP.Res.keyboardShortcutOutdent_Alt+SP.Res.keyboardShortcutOutdent_Shift+SP.Res.keyboardShortcutOutdent_AccessKey;RTE.ShortcutKeys.$u[a]="DecreaseIndent";a=SP.Res.keyboardShortcutLeftAlign_Ctrl+SP.Res.keyboardShortcutLeftAlign_Alt+SP.Res.keyboardShortcutLeftAlign_Shift+SP.Res.keyboardShortcutLeftAlign_AccessKey;RTE.ShortcutKeys.$u[a]="AlignLeft";a=SP.Res.keyboardShortcutCenterAlign_Ctrl+SP.Res.keyboardShortcutCenterAlign_Alt+SP.Res.keyboardShortcutCenterAlign_Shift+SP.Res.keyboardShortcutCenterAlign_AccessKey;RTE.ShortcutKeys.$u[a]="AlignCenter";a=SP.Res.keyboardShortcutRightAlign_Ctrl+SP.Res.keyboardShortcutRightAlign_Alt+SP.Res.keyboardShortcutRightAlign_Shift+SP.Res.keyboardShortcutRightAlign_AccessKey;RTE.ShortcutKeys.$u[a]="AlignRight";a=SP.Res.keyboardShortcutMakeHyperlink_Ctrl+SP.Res.keyboardShortcutMakeHyperlink_Alt+SP.Res.keyboardShortcutMakeHyperlink_Shift+SP.Res.keyboardShortcutMakeHyperlink_AccessKey;RTE.ShortcutKeys.$u[a]="InsertLink"};RTE.ShortcutKeys.getShortcut=function(b){ULSNVe:;var a=b.ctrlKey?"t":"f";a+=b.altKey?"t":"f";a+=b.shiftKey?"t":"f";a+=String.fromCharCode(b.keyCode);return RTE.ShortcutKeys.$u[a]};RTE.MovementKeys=function(){};RTE.MovementKeys.initializeDictionary=function(){ULSNVe:;if(!RTE.SU.$7(RTE.MovementKeys.$1B))return;RTE.MovementKeys.$1B={};RTE.MovementKeys.$1B[String.fromCharCode(9)]=null;RTE.MovementKeys.$1B[String.fromCharCode(37)]=null;RTE.MovementKeys.$1B[String.fromCharCode(39)]=null;RTE.MovementKeys.$1B[String.fromCharCode(38)]=null;RTE.MovementKeys.$1B[String.fromCharCode(40)]=null;RTE.MovementKeys.$1B[String.fromCharCode(36)]=null;RTE.MovementKeys.$1B[String.fromCharCode(35)]=null;RTE.MovementKeys.$1B[String.fromCharCode(34)]=null;RTE.MovementKeys.$1B[String.fromCharCode(33)]=null;RTE.MovementKeys.$1B[String.fromCharCode(127)]=null;RTE.MovementKeys.$1B[String.fromCharCode(8)]=null};RTE.MovementKeys.isMovementKey=function(a){ULSNVe:;return!RTE.SU.$1R(RTE.MovementKeys.$1B[String.fromCharCode(a.keyCode)])};RTE.SelectionClearingKeys=function(){};RTE.SelectionClearingKeys.initializeDictionary=function(){ULSNVe:;if(!RTE.SU.$7(RTE.SelectionClearingKeys.$11))return;RTE.SelectionClearingKeys.$11={};RTE.SelectionClearingKeys.$11[String.fromCharCode(37)]=null;RTE.SelectionClearingKeys.$11[String.fromCharCode(39)]=null;RTE.SelectionClearingKeys.$11[String.fromCharCode(38)]=null;RTE.SelectionClearingKeys.$11[String.fromCharCode(40)]=null;RTE.SelectionClearingKeys.$11[String.fromCharCode(36)]=null;RTE.SelectionClearingKeys.$11[String.fromCharCode(35)]=null;RTE.SelectionClearingKeys.$11[String.fromCharCode(34)]=null;RTE.SelectionClearingKeys.$11[String.fromCharCode(33)]=null;RTE.SelectionClearingKeys.$11[String.fromCharCode(27)]=null;RTE.SelectionClearingKeys.$11[String.fromCharCode(16)]=null;RTE.SelectionClearingKeys.$11[String.fromCharCode(17)]=null;RTE.SelectionClearingKeys.$11[String.fromCharCode(18)]=null};RTE.SelectionClearingKeys.isSelectionClearKey=function(a){ULSNVe:;return!a.ctrlKey&&!a.altKey&&RTE.SU.$1R(RTE.SelectionClearingKeys.$11[String.fromCharCode(a.keyCode)])};RTE.LayoutsEditor=function(a){ULSNVe:;this.$z_0=a;this.$5E_0=a.id;this.$S_0=a.ownerDocument;this.$y_0=[]};RTE.LayoutsEditor.create=function(b){ULSNVe:;if(null===RTE.LayoutsEditor.$2l)RTE.LayoutsEditor.$2l={};var a=null;if(null!==b){a=new RTE.LayoutsEditor(b);a.$Ix_0();RTE.LayoutsEditor.$2l[b.id]=a}return a};RTE.LayoutsEditor.getLayoutsEditorForRegion=function(a){ULSNVe:;return RTE.SU.$7(a)||RTE.SU.$7(RTE.LayoutsEditor.$2l)?null:RTE.LayoutsEditor.$2l[a.id]};RTE.LayoutsEditor.relayoutRegion=function(a,c,e,d,f){ULSNVe:;if(!RTE.SU.$7(a))if(RTE.LayoutsEditor.$2l){var b=RTE.LayoutsEditor.$2l[a.id];if(!RTE.SU.$7(b))b.$Kc_0(c,e,d,f);else alert(SP.Res.layoutsNotSupported)}else alert(SP.Res.layoutsNotSupported)};RTE.LayoutsEditor.prototype={$5E_0:null,$z_0:null,$S_0:null,$1Y_0:null,$j_0:null,$1J_0:false,$1S_0:false,$I_0:0,$1j_0:null,$1i_0:null,$y_0:null,$Ix_0:function(){ULSNVe:;this.$1Y_0=$get(this.$5E_0+"_layoutsData");this.$j_0=$get(this.$5E_0+"_layoutsTable");if(null===this.$1Y_0||null===this.$j_0||this.$j_0.tagName!=="TABLE"){this.$1Y_0&&SP.UI.UIUtility.removeNode(this.$1Y_0);this.$j_0&&this.$Bb_0(this.$j_0);this.$1J_0=false;this.$1S_0=false;this.$I_0=1;var a=RTE.LayoutsZone.$5L(this.$S_0);RTE.RteUtility.$k(this.$z_0,a.$h_0);a.$EB_0();this.$y_0[0]=a;this.$7u_0();this.$1Y_0=this.$S_0.createElement("SPAN");this.$1Y_0.id=this.$5E_0+"_layoutsData";this.$1Y_0.style.display="none";SP.UI.UIUtility.setInnerText(this.$1Y_0,"false,false,1");this.$z_0.appendChild(this.$j_0);this.$z_0.appendChild(this.$1Y_0);!RTE.SU.$2(this.$z_0.style.minHeight)&&a.set_$Ji_0(this.$z_0.style.minHeight)}else this.validateLayouts()},$7u_0:function(){ULSNVe:;this.$j_0=this.$S_0.createElement("TABLE");this.$j_0.style.width="100%";this.$j_0.id=this.$5E_0+"_layoutsTable";var b=this.$S_0.createElement("TBODY");this.$j_0.appendChild(b);var a;if(this.$1J_0){a=this.$S_0.createElement("TR");b.appendChild(a);this.$1j_0.$1l_0.colSpan=this.$I_0;a.style.verticalAlign="top";a.appendChild(this.$1j_0.$1l_0)}a=this.$S_0.createElement("TR");a.style.verticalAlign="top";b.appendChild(a);for(var c=0;c<this.$I_0;c++)a.appendChild(this.$y_0[c].$1l_0);if(this.$1S_0){a=this.$S_0.createElement("TR");b.appendChild(a);this.$1i_0.$1l_0.colSpan=this.$I_0;a.style.verticalAlign="top";a.appendChild(this.$1i_0.$1l_0)}},validateLayouts:function(){ULSNVe:;var b=this.$1Y_0.innerHTML,a=b.split(",");this.$1J_0="true"===a[0].trim().toLowerCase();this.$1S_0="true"===a[1].trim().toLowerCase();this.$I_0=parseInt(a[2].trim());if(isNaN(this.$I_0)||this.$I_0<1)this.$I_0=1;if(this.$I_0>3)this.$I_0=3;this.$Lk_0()},$Bb_0:function(a){ULSNVe:;var d=a.childNodes;if(d.length){var c=d[0];while(c)c=this.$Bb_0(c)}var b=a;if(a.id&&(a.id.indexOf("layoutsTable")>=0||a.id.indexOf("layoutsData")>=0)||a.className&&(a.className.indexOf("ms-rtestate-write")>=0||a.className.indexOf("ms-rte-layoutszone-inner-editable")>=0||a.className.indexOf("ms-rte-layoutszone-inner")>=0||a.className.indexOf("ms-rte-layoutszone-outer")>=0)){b=a.lastChild;RTE.RteUtility.removeNodeAndKeepChildNodes(a)}b=b.nextSibling;return b},$Lk_0:function(){ULSNVe:;var a,b=0;if(this.$1J_0){a=this.$j_0.rows[b++];this.$1j_0=RTE.LayoutsZone.$6y(a.cells[0]);if(!this.$1j_0)this.$1J_0=false}a=this.$j_0.rows[b];if(a.cells.length===this.$I_0){this.$y_0=[];for(var c=0,e=0;e<a.cells.length;e++){this.$y_0[c]=RTE.LayoutsZone.$6y(a.cells[e]);if(!this.$y_0[c]){c--;this.$I_0--}c++}}else{if(a.cells.length<this.$I_0)this.$I_0=a.cells.length;else if(a.cells.length>=3)this.$I_0=3;else this.$I_0=a.cells.length;for(var f=0,d=0;d<this.$I_0;d++){this.$y_0[d]=RTE.LayoutsZone.$6y(a.cells[d]);if(!this.$y_0[f]){f--;this.$I_0--}f++}}if(this.$I_0<1){this.$I_0=1;this.$y_0[0]=RTE.LayoutsZone.$5L(this.$j_0.ownerDocument)}b++;if(this.$1S_0){a=this.$j_0.rows[b++];this.$1i_0=RTE.LayoutsZone.$6y(a.cells[0]);if(!this.$1i_0)this.$1S_0=false}var g=this.$j_0;this.$7u_0();g.parentNode.replaceChild(this.$j_0,g);SP.UI.UIUtility.setInnerText(this.$1Y_0,this.$1J_0+","+this.$1S_0+","+this.$I_0.toString())},get_parentLayoutsContainer:function(){ULSNVe:;return this.$j_0},$Kc_0:function(n,w,x,o){ULSNVe:;if(n<0||n>3)throw Error.argumentOutOfRange("newNumColumns");var y=this.$1J_0,z=this.$1S_0,u=this.$I_0,A=this.$1j_0,B=this.$1i_0,C=this.$y_0,p=this.$j_0,f=[];if(this.$1J_0)f[0]=this.$1j_0;for(var j=0;j<this.$I_0;j++)f[1+j]=this.$y_0[j];if(this.$1S_0)f[4]=this.$1i_0;this.$1J_0=w;this.$1S_0=x;this.$I_0=n;if(isNaN(this.$I_0)||this.$I_0<1)this.$I_0=u;var c=[];if(this.$1J_0){this.$1j_0=RTE.LayoutsZone.$5L(this.$S_0);c[0]=this.$1j_0}for(var g=0;g<this.$I_0;g++){this.$y_0[g]=RTE.LayoutsZone.$5L(this.$S_0);c[g+1]=this.$y_0[g]}if(this.$1S_0){this.$1i_0=RTE.LayoutsZone.$5L(this.$S_0);c[4]=this.$1i_0}for(var k=0;k<5;k++){var q=f[k],r=c[k];!RTE.SU.$7(q)&&!RTE.SU.$7(r)&&q.$5O_0(r,true)}for(var b=0;b<5;b++){var h=f[b],v=c[b];if(!RTE.SU.$7(h)&&RTE.SU.$7(v)){for(var d=null,l=0,e=null,i=0,l=0;b-l>=0;l++){d=c[b-l];if(!RTE.SU.$7(d))break}for(i=0;b+i<5;i++){e=c[b+i];if(!RTE.SU.$7(e))break}if(d&&e)if(l<=i)h.$5O_0(d,true);else h.$5O_0(e,false);else if(d)h.$5O_0(d,true);else e&&h.$5O_0(e,false)}}var a=null;if(this.$1J_0){a=this.$1j_0;this.$1j_0.$1l_0.colSpan=this.$I_0}if(!this.$1J_0&&!this.$1S_0&&1===this.$I_0){var s=this.$y_0[0];s.$EB_0();if(!a)a=s}else{o=o&&2===this.$I_0;for(var m=0;m<this.$I_0;m++){var t=this.$y_0[m];t.$L5_0(m,this.$I_0,o);if(!a)a=t}}if(this.$1S_0){this.$1i_0.$1l_0.colSpan=this.$I_0;if(!a)a=this.$1i_0}this.$7u_0();p.parentNode.replaceChild(this.$j_0,p);SP.UI.UIUtility.setInnerText(this.$1Y_0,this.$1J_0+","+this.$1S_0+","+this.$I_0.toString());if(a){RTE.Cursor.get_range().$Jl_0(a.$h_0);RTE.Cursor.update()}},$Bq_0:function(){ULSNVe:;var a;if(this.$1J_0)a=this.$1j_0.$h_0;else if(this.$I_0>0)a=this.$y_0[0].$h_0;else a=this.$1i_0.$h_0;return a}};RTE.LayoutsZone=function(b,c,d,a){ULSNVe:;this.$S_0=b;this.$1l_0=c;this.$D6_0=d;this.$h_0=a;Sys.UI.DomElement.addCssClass(a,"ms-rtestate-write");RTE.Canvas.makeRegionEditable(a);this.$D6_0.style.width="100%"};RTE.LayoutsZone.$5L=function(b){ULSNVe:;var d=b.createElement("TD"),a=b.createElement("DIV"),c=b.createElement("DIV");a.appendChild(c);Sys.UI.DomElement.addCssClass(c,"ms-rte-layoutszone-inner-editable");Sys.UI.DomElement.addCssClass(a,"ms-rte-layoutszone-outer");d.appendChild(a);var e=new RTE.LayoutsZone(b,d,a,c);return e};RTE.LayoutsZone.$6y=function(b){ULSNVe:;if(!b)return null;if(b.tagName!=="TD")return null;var c=b;b=c.firstChild;var a=document.createElement("DIV");Sys.UI.DomElement.addCssClass(a,"ms-rte-layoutszone-outer");var d=document.createElement("DIV");Sys.UI.DomElement.addCssClass(d,"ms-rte-layoutszone-inner-editable");if(!b){c.appendChild(a);a.appendChild(d);return new RTE.LayoutsZone(window.document,c,a,d)}else{b=RTE.LayoutsZone.$Db(c.childNodes,a);c.appendChild(b)}if(!b.firstChild){c.appendChild(a);a.appendChild(d);return new RTE.LayoutsZone(b.ownerDocument,c,a,d)}else a.appendChild(RTE.LayoutsZone.$Db(a.childNodes,d));var e=new RTE.LayoutsZone(b.ownerDocument,c,a,d);return e};RTE.LayoutsZone.$Db=function(c,b){ULSNVe:;var a=c[0];while(a){if(!RTE.LayoutsZone.$JW(a))if("DIV"===a.tagName&&a.className&&(Sys.UI.DomElement.containsCssClass(a,"ms-rte-layoutszone-inner")||Sys.UI.DomElement.containsCssClass(a,"ms-rte-layoutszone-inner-editable")||Sys.UI.DomElement.containsCssClass(a,"ms-rte-layoutszone-outer"))){RTE.RteUtility.$k(a,b);RTE.RteUtility.$J(a)}else b.appendChild(a);else RTE.RteUtility.$J(a);a=c[0]}return b};RTE.LayoutsZone.$JW=function(a){ULSNVe:;return SP.UI.UIUtility.isTextNode(a)&&(RTE.SU.$7(a.nodeValue)||RTE.SU.$2(a.nodeValue.trim()))};RTE.LayoutsZone.prototype={$S_0:null,$1l_0:null,$D6_0:null,$h_0:null,$5O_0:function(a,c){ULSNVe:;var b=!a.$h_0.childNodes.length;if(c){if(!b){a.$7j_0(this.$S_0.createElement("BR"));a.$7j_0(this.$S_0.createElement("BR"))}while(this.$h_0.childNodes.length>0)a.$7j_0(this.$h_0.childNodes[0])}else{if(!b){a.$h_0.insertBefore(this.$S_0.createElement("BR"),a.$h_0.firstChild);a.$h_0.insertBefore(this.$S_0.createElement("BR"),a.$h_0.firstChild)}while(this.$h_0.childNodes.length>0)a.$h_0.insertBefore(this.$h_0.lastChild,a.$h_0.firstChild)}},get_$Ji_0:function(){ULSNVe:;return this.$h_0.style.minHeight},set_$Ji_0:function(a){ULSNVe:;this.$h_0.style.minHeight=a;return a},$7j_0:function(a){ULSNVe:;this.$h_0.appendChild(a)},$EB_0:function(){ULSNVe:;this.$1l_0.style.width="100%"},$L5_0:function(b,d,c){ULSNVe:;var a;if(c&&0===b)a=66.6;else if(c&&1===b)a=33.3;else a=99.9/d;this.$1l_0.style.width=a.toString()+"%";if(b>0)this.$1l_0.className="ms-wiki-columnSpacing"}};RTE.NodeDictionaryCache=function(){ULSNVe:;this.$7c_0={}};RTE.NodeDictionaryCache.prototype={addEntry:function(a,c){ULSNVe:;if(RTE.RteUtility.isValidRteNodeId(a)){var b=RTE.RteUtility.getRteNodeId(a);this.$7c_0[b]=c}},getEntry:function(a){ULSNVe:;if(RTE.RteUtility.isValidRteNodeId(a)){var b=RTE.RteUtility.getRteNodeId(a);return this.$7c_0[b]}return null},clearEntry:function(a){ULSNVe:;if(RTE.RteUtility.isValidRteNodeId(a)){var b=RTE.RteUtility.getRteNodeId(a);delete this.$7c_0[b]}}};RTE.DialogUtility=function(){};RTE.DialogUtility.$Cu=function(b,c,d,e,f,a,g,h,i){ULSNVe:;if(!a)a={};a.Dialog=c;if(!d)a.FirstLine="false";RTE.DialogUtility.$Cv(b,e,f,a,g,h,i)};RTE.DialogUtility.$Cv=function(i,j,k,e,l,m,f){ULSNVe:;RTE.RteUtility.classMustExist("SP.UI.ModalDialog");RTE.RteUtility.classMustExist("SP.PageContextInfo");var a=new SP.UI.DialogOptions;if(f>0)a.autoSizeStartWidth=f;a.autoSize=true;a.showMaximized=m;var g=SP.PageContextInfo.get_currentLanguage();a.url=SP.Utilities.Utility.get_layoutsLatestVersionUrl()+i+"?UseDivDialog=true&LCID="+g.toString();if(!RTE.SU.$7(e)){var b=e;for(var c in b){var d={key:c,value:b[c]},h="&"+SP.Utilities.HttpUtility.urlKeyValueEncode(d.key)+"="+SP.Utilities.HttpUtility.urlKeyValueEncode(d.value.toString());a.url=a.url+h}}if(!j)a.url=a.url+"&seed="+Math.random().toString();a.args=k;a.dialogReturnValueCallback=l;if(RTE.SU.$2(RTE.DialogUtility.$2m)){RTE.DialogUtility.$2m=SP.PageContextInfo.get_webServerRelativeUrl();if(RTE.DialogUtility.$2m.endsWith("/"))RTE.DialogUtility.$2m=RTE.DialogUtility.$2m.substring(0,RTE.DialogUtility.$2m.length-1)}a.url=RTE.DialogUtility.$2m+a.url;SP.UI.ModalDialog.showModalDialog(a)};RTE.InsertLinkDialog=function(){ULSNVe:;this.$$d_$JB_0=Function.createDelegate(this,this.$JB_0)};RTE.InsertLinkDialog.prototype={show:function(){ULSNVe:;var a=new RTE.InsertLinkDialogArguments;a.allowRelativeLinks=false;a.text=RTE.Cursor.get_range().get_text();RTE.DialogUtility.$Cu("RteDialog.aspx","CreateLink",true,true,a,null,this.$$d_$JB_0,false,300)},$JB_0:function(g,h){ULSNVe:;if(g===1){var e=h,c=e[0],d=e[1];if(RTE.RteUtility.$Cl(d,false)){var a=RTE.Cursor.get_range(),f=a.parentElement();if(!f)return;var b=f.ownerDocument.createElement("A");b.href=d;if(a.isEmpty()){SP.UI.UIUtility.setInnerText(b,c.trim()!==""?c:d);a.insertBefore(b)}else{if(RTE.Cursor.getSelectedImage())b.title=c;else c.trim()!==""&&a.replaceHtml(c);a.wrapRange(b)}a.moveToEndOfNode(b);RTE.Cursor.update();RTE.RteUtility.showRibbonTab("Ribbon.Link","LinkTab")}}}};RTE.InsertHtmlDialog=function(b,a,c){ULSNVe:;this.$$d_$J9_0=Function.createDelegate(this,this.$J9_0);this.$90_0=b;this.$59_0=a;this.$Jf_0=c;this.$5F_0="UploadImage"===a?true:false};RTE.InsertHtmlDialog.prototype={$90_0:null,$59_0:null,$Jf_0:false,$5F_0:false,show:function(){ULSNVe:;var a={};a.Source=unescapeProperly(GetSource());a.AssetPageFolder="true";var b=300;if(this.$59_0==="UploadImage"){a.Title=SP.Res.imageUploadTitle;a.DefaultList="Asset"}if(this.$90_0==="Upload.aspx")b=0;RTE.DialogUtility.$Cv(this.$90_0,false,null,a,this.$$d_$J9_0,false,b)},$J9_0:function(d,e){ULSNVe:;if(d===1){var b=e,a=RTE.CanvasEvents.getNodeFromEvent("Image");if(this.$5F_0&&a&&a.parentNode&&a.parentNode){a.src=b.newFileUrl;RTE.Cursor.get_range().moveToNode(a);RTE.Cursor.update()}else{var c=document.createElement("SPAN");c.appendChild(this.$FJ_0(b));RTE.Cursor.get_range().replaceWithChildren(c);if(this.$59_0==="UploadImage"){a=RTE.Cursor.getSelectedImage();a&&RTE.RteUtility.initImage(a);RTE.Cursor.update()}else RTE.Cursor.get_range().collapse(false)}"UploadImage"===this.$59_0&&RTE.RteUtility.showRibbonTab("Ribbon.Image","ImageTab")}},$FJ_0:function(a){ULSNVe:;switch(this.$59_0){case"UploadImage":var c=document.createElement("IMG");c.src=a.newFileUrl;c.alt=this.$Bp_0(a.newFileUrl);return c;case"UploadDocument":var b=document.createElement("A");b.href=a.newFileUrl;if(!RTE.SU.$2(a.newFileIcon)){var d=document.createElement("IMG");d.className="ms-asset-icon ms-rtePosition-4";d.src=SP.Utilities.Utility.getImageUrl(a.newFileIcon);b.appendChild(d)}b.appendChild(document.createTextNode(this.$Bp_0(a.newFileUrl)));return b}throw Error.invalidOperation("Not supported");},$Bp_0:function(a){ULSNVe:;var b=a.lastIndexOf("/");if(b>0)a=a.substr(b+1);return a}};RTE.InsertImageDialog=function(a){ULSNVe:;this.$$d_$JA_0=Function.createDelegate(this,this.$JA_0);this.$5F_0=a};RTE.InsertImageDialog.prototype={$5F_0:false,show:function(){ULSNVe:;var b=RTE.CanvasEvents.getNodeFromEvent("Image"),c=this.$5F_0&&null!==b,a=null;if(c){a={};a.Param1=b.src;a.Param2=b.alt}RTE.DialogUtility.$Cu("RteDialog.aspx","InsertImage",true,true,null,c?a:null,this.$$d_$JA_0,false,300)},$JA_0:function(g,h){ULSNVe:;if(g===1){var d=h,b=d[0],e=d[1];if(RTE.RteUtility.$Cl(b,false)){var a=RTE.CanvasEvents.getNodeFromEvent("Image");if(this.$5F_0&&null!==a){a.src=b;a.alt=e}else{var c=RTE.Cursor.get_range();c.deleteContent();var f=c.parentElement();if(!f)return;a=f.ownerDocument.createElement("IMG");RTE.RteUtility.initImage(a);a.src=b;a.alt=e;c.insertNode(a)}if(a){RTE.Cursor.get_range().moveToNode(a);RTE.RteUtility.showRibbonTab("Ribbon.Image","ImageTab");RTE.Cursor.update()}}RTE.Canvas.$O()}}};RTE.ObjectCommands=function(){};RTE.ObjectCommands.insertHtmlFromDialog=function(c,d,e){ULSNVe:;var a=RTE.Cursor.get_range();if(!a.get_isEditable())return;if(!a.canDeleteContent())return;var b=new RTE.InsertHtmlDialog(c,d,e);b.show()};RTE.ObjectCommands.insertImage=function(c){ULSNVe:;var a=RTE.Cursor.get_range();if(!a.get_isEditable())return;if(!a.canDeleteContent())return;var b=new RTE.InsertImageDialog(c);b.show()};RTE.ObjectCommands.insertLink=function(){ULSNVe:;var a=RTE.Cursor.get_range();if(!a.get_isEditable())return;var b=new RTE.InsertLinkDialog;b.show()};RTE.ParagraphCommands=function(){};RTE.ParagraphCommands.$JD=function(b,a){ULSNVe:;switch(b){case 2:return a==="center"||a==="-moz-center";case 3:return a==="justify";case 0:return a==="left"||a==="-moz-left";case 1:return a==="right"||a==="-moz-right"}return false};RTE.ParagraphCommands.queryAlign=function(d){ULSNVe:;var a=new RTE.CommandState,b=RTE.Cursor.getCurrentElement();if(b){a.$C_0=true;var c=RTE.RteUtility.$1c(RTE.Cursor.get_range().$3_0).textAlign;a.$1I_0=RTE.ParagraphCommands.$JD(d,c)}return a};RTE.ParagraphCommands.setDirection=function(a){ULSNVe:;var b=a?"ltr":"rtl";RTE.ParagraphCommands.$9o("direction",b,"dir",true);var c=a?"left":"right";RTE.ParagraphCommands.$9o("textAlign",c,"align",false)};RTE.ParagraphCommands.$9o=function(h,i,j,g){ULSNVe:;var k=RTE.Cursor.get_range();if(!k.get_isEditable())return false;var b=RTE.Cursor.$IN();if(!RTE.Canvas.isEditable(b))return false;var d=g?j:h;if(k.isEmpty()){b=RTE.RteUtility.$6G(k.$3_0,true);h==="direction"&&RTE.ParagraphCommands.$9y(b);RTE.ParagraphCommands.$7i(b,d,i,g)}else{var l=RTE.Cursor.get_range().$3_0,c=RTE.Cursor.get_range().$4_0,f=RTE.RteUtility.$m(c,false);f&&f.nodeType===1&&f.tagName==="BR"&&f.parentNode.insertBefore(c,f);var a=new RTE.DOMTreePosition(l,0);while(a.$1_0){var e=RTE.RteUtility.$6G(a.$1_0,true);RTE.ParagraphCommands.$85(e,h,j,true);h==="direction"&&RTE.ParagraphCommands.$9y(e);RTE.ParagraphCommands.$7i(e,d,i,g);RTE.ParagraphCommands.$7s(e.parentNode,d,i,j,d,g);a.setCurrentNode(e);a.setLocationAtEnd();if(RTE.RteUtility.$b(c,e,b))break;while(a.atEnd()&&!RTE.RteUtility.$b(c,a.$1_0,b)&&a.$1_0!==c)a.moveToNextElement();if(a.$1_0.firstChild===c||a.$1_0===c)break;a.normalize()}}RTE.ParagraphCommands.$7s(b,d,i,j,d,g);RTE.Cursor.get_range().resetCacheRange();RTE.Cursor.update();return true};RTE.ParagraphCommands.$9y=function(b){ULSNVe:;if(b.style&&b.style.cssText){var a=b.style.cssText.toLowerCase();if(a.indexOf("right")!==-1||a.indexOf("left")!==-1||a.indexOf("rtl")!==-1||a.indexOf("ltr")!==-1){a=a.replace("right","ms-oldright");a=a.replace("left","right");a=a.replace("ms-oldright","left");a=a.replace("rtl","ms-oldrtl");a=a.replace("ltr","rtl");a=a.replace("ms-oldrtl","ltr");b.style.cssText=a;RTE.SnapshotManager.setCurrentRegionDirty()}}for(var c=0;c<b.childNodes.length;c++)RTE.ParagraphCommands.$9y(b.childNodes[c])};RTE.ParagraphCommands.$7i=function(b,c,d,f){ULSNVe:;var a=f?b:b.style,e=a[c];a[c]=d;RTE.SnapshotManager.setCurrentRegionDirtyIf(e!==d)};RTE.ParagraphCommands.$Et=function(c,g,d,h,i){ULSNVe:;for(var b=0;b<c.childNodes.length;b++){var a=c.childNodes[b];if(i){var e=a[h];if(e!==d)return false}else{if(!a.style)a=a.parentNode;var f=a.style[g];if(f!==d)return false}}return true};RTE.ParagraphCommands.$7s=function(a,d,e,b,g,f){ULSNVe:;if(!RTE.Canvas.isEditable(a.parentNode))return;var h=RTE.ParagraphCommands.$Et(a,d,e,b,f);if(!h&&(b!=="direction"||b==="direction"&&a.tagName!=="OL"&&a.tagName!=="UL"))return;for(var c=0;c<a.childNodes.length;c++){var i=a.childNodes[c];RTE.ParagraphCommands.$85(i,d,b,false)}RTE.ParagraphCommands.$7i(a,g,e,f);RTE.ParagraphCommands.$7s(a.parentNode,d,e,b,g,f)};RTE.ParagraphCommands.$85=function(a,d,b,e){ULSNVe:;if(a.nodeType===1){if(e&&a.childNodes.length>0)for(var c=0;c<a.childNodes.length;c++)RTE.ParagraphCommands.$85(a.childNodes[c],d,b,e);if(!RTE.SU.$2(a.style[d]))a.style[d]="";!RTE.SU.$2(b)&&a.getAttribute(b)&&a.removeAttribute(b)}};RTE.ParagraphCommands.queryDirection=function(d){ULSNVe:;var a=new RTE.CommandState,c=RTE.Cursor.getCurrentElement();if(!c)return a;a.$C_0=true;var b=RTE.RteUtility.$1c(RTE.Cursor.get_range().$3_0);if(d)a.$1I_0=b.direction==="ltr";else a.$1I_0=b.direction==="rtl";return a};RTE.ParagraphCommands.queryBulletedList=function(){ULSNVe:;return RTE.Canvas.$BS("InsertUnorderedList")};RTE.ParagraphCommands.bulletedList=function(){ULSNVe:;RTE.ParagraphCommands.$Bg("UL","InsertUnorderedList")};RTE.ParagraphCommands.queryNumberedList=function(){ULSNVe:;return RTE.Canvas.$BS("InsertOrderedList")};RTE.ParagraphCommands.numberedList=function(){ULSNVe:;RTE.ParagraphCommands.$Bg("OL","InsertOrderedList")};RTE.ParagraphCommands.$Bg=function(c,d){ULSNVe:;if(!RTE.ParagraphCommands.$Ik(c)){var a=null;try{if(RTE.RteUtility.isFirefox()){var b=RTE.Canvas.currentEditableRegion();if(b){a=document.createElement("DIV");a.style.height="0px";a.style.width="0px";b.insertBefore(a,b.firstChild)}}RTE.Canvas.$8M(d)}finally{a&&a.parentNode&&a.parentNode.removeChild(a)}RTE.ParagraphCommands.$Ho()}RTE.Canvas.$O()};RTE.ParagraphCommands.$Ho=function(){ULSNVe:;var a=RTE.RteUtility.$2d(RTE.Cursor.s_range.$3_0,["UL","OL"]);if(a&&RTE.Canvas.isEditable(a)){while(a.parentNode.tagName==="UL"||a.parentNode.tagName==="OL")a=a.parentNode;var b=a.parentNode;if(b.firstChild===a&&b.lastChild===a&&RTE.HtmlTagName.allowedElementStyleTags[b.tagName.toUpperCase()]){if(!a.dir)a.dir=b.dir;if(!a.className)a.className=b.className;if(!a.style.cssText)a.style.cssText=b.style.cssText;RTE.RteUtility.removeNodeAndKeepChildNodes(b);RTE.Cursor.update()}}};RTE.ParagraphCommands.$Ik=function(h){ULSNVe:;if(RTE.Cursor.get_range().isValid()){var e=RTE.RteUtility.$G(RTE.Cursor.s_range.$3_0,"LI"),f=RTE.RteUtility.$G(RTE.Cursor.s_range.$4_0,"LI");if(e&&f&&RTE.Canvas.isInEditable(e)&&RTE.Canvas.isInEditable(f)){var a=e.parentNode,c=f.parentNode;while(a.parentNode.tagName===h)a=a.parentNode;while(c.parentNode.tagName===h)c=c.parentNode;if(a.tagName===h&&a===c){for(var g=0;g<a.childNodes.length;g++){var b=a.childNodes[g];if(b.tagName==="LI"){var i=b.ownerDocument.createElement("P");RTE.RteUtility.$k(b,i);b=i;var d=RTE.RteUtility.$1e(b,false);d&&d.nodeType===1&&d.tagName==="BR"&&b.removeChild(d)}!RTE.RteUtility.$3u(b,true)&&SP.UI.UIUtility.insertBefore(b,a)}a.parentNode.removeChild(a);RTE.Cursor.update();return true}}}return false};RTE.ParagraphCommands.indent=function(a){ULSNVe:;if(a)RTE.Canvas.$8M("Indent");else RTE.Canvas.$8M("Outdent")};RTE.ParagraphCommands.align=function(b){ULSNVe:;var a=null;if(b===2)a="center";else if(b===3)a="justify";else if(!b)a="left";else if(b===1)a="right";if(RTE.SU.$2(a))return;RTE.ParagraphCommands.$9o("textAlign",a,"align",false);RTE.Canvas.$O()};RTE.PasteFlyout=function(a,b){ULSNVe:;this.$$d_$Hr_0=Function.createDelegate(this,this.$Hr_0);this.$2y_0=a;this.$AC_0=b};RTE.PasteFlyout.$LL=function(a,b){ULSNVe:;RTE.PasteFlyout.$W&&RTE.PasteFlyout.$W.$CD_0(true);RTE.PasteFlyout.$W=new RTE.PasteFlyout(a,b);RTE.PasteFlyout.$W.$LM_0()};RTE.PasteFlyout.expandOptions=function(){ULSNVe:;RTE.PasteFlyout.$W&&RTE.PasteFlyout.$W.$BT_0()};RTE.PasteFlyout.collapseOptions=function(){ULSNVe:;RTE.PasteFlyout.$W&&RTE.PasteFlyout.$W.$88_0(false)};RTE.PasteFlyout.hide=function(){ULSNVe:;RTE.PasteFlyout.$CF(false)};RTE.PasteFlyout.$CF=function(a){ULSNVe:;if(RTE.PasteFlyout.$W){RTE.PasteFlyout.$W.$CD_0(a);RTE.PasteFlyout.$W=null}};RTE.PasteFlyout.get_isVisible=function(){ULSNVe:;return!!RTE.PasteFlyout.$W};RTE.PasteFlyout.$JI=function(a){ULSNVe:;return RTE.PasteFlyout.$W?RTE.PasteFlyout.$W.$HS_0(a):false};RTE.PasteFlyout.$JV=function(a){ULSNVe:;if(a.nodeType===1){var b=a.tagName.toUpperCase();if(b==="TABLE")return true;if(b==="FONT")return false;if(RTE.RteUtility.$Q(a))return false;if(RTE.RteUtility.$6L(a))return false}return!RTE.RteUtility.$3u(a,true)};RTE.PasteFlyout.prototype={$2y_0:null,$AC_0:null,$16_0:null,$q_0:null,$1p_0:null,$e_0:null,$17_0:null,$5p_0:null,$A8_0:null,$AD_0:null,$LM_0:function(){ULSNVe:;this.$17_0=RTE.Canvas.$35(RTE.Canvas.currentEditableRegion());if(!this.$16_0&&this.$17_0){this.$16_0=this.$17_0.ownerDocument.createElement("DIV");this.$16_0.style.position="relative";this.$16_0.style.width="0px";this.$16_0.style.height="0px";var j=RTE.RteUtility.$1c(this.$17_0.parentNode),g=!!j&&j.direction==="rtl";if(g)this.$16_0.style.right=this.$17_0.offsetWidth+"px";var n=this;$addHandler(this.$16_0,"mousedown",function(a){ULSNVe:;SP.UI.UIUtility.cancelEvent(a);return false});this.$17_0.parentNode.insertBefore(this.$16_0,this.$17_0);this.$FH_0();this.$FI_0();var b=this.$IM_0(),c=null;if(!RTE.RteUtility.$Q(b)){c=document.createElement("SPAN");c.className="ms-rtegenerate-skip";SP.UI.UIUtility.insertAfter(c,b);c.appendChild(b);b=c}var k=RTE.RteUtility.$8W(b),d=RTE.RteUtility.$8W(this.$17_0),a=k.x-d.x+(!g?10+b.offsetWidth:-10),e=k.y+b.offsetHeight-d.y,m=this.$q_0.clientHeight+this.$e_0.clientHeight,l=Math.max(Math.max(this.$q_0.clientWidth,this.$q_0.scrollWidth),Math.max(this.$e_0.clientWidth,this.$e_0.scrollWidth));c&&RTE.RteUtility.removeNodeAndKeepChildNodes(c);var f=RTE.RteUtility.$IZ(this.$16_0),h=RTE.RteUtility.$6K(window.self),i=RTE.RteUtility.$6J(window.self);h=Math.min(h,d.x+this.$17_0.offsetWidth-f.x);i=Math.min(i,d.y+this.$17_0.offsetHeight-f.y);a=Math.min(a,f.x+h-30-d.x+(!g?-l:0));a=Math.max(a,f.x+10+(!g?0:l));e=Math.min(e,f.y+i-m-10-d.y);e=Math.max(e,f.y+10-d.y);this.$q_0.style.top=e+"px";this.$e_0.style.top=e+this.$q_0.clientHeight+"px";if(!g){this.$q_0.style.left=a+"px";this.$e_0.style.left=a+"px"}else{this.$q_0.style.right=-a+"px";this.$e_0.style.right=-a+"px"}this.$88_0(false)}},$CD_0:function(a){ULSNVe:;if(this.$16_0){if(this.$q_0){RTE.RteUtility.$J(this.$q_0);this.$q_0=null}if(this.$e_0){RTE.RteUtility.$J(this.$e_0);this.$e_0=null}RTE.RteUtility.$J(this.$16_0);this.$16_0=null;this.$1p_0=null;if(!a){RTE.SnapshotManager.$1y(this.$17_0)&&RTE.SnapshotManager.takeEditableRegionSnapshot(this.$17_0);RTE.Cursor.$L.clear()}}},$BT_0:function(){ULSNVe:;if(this.$e_0){this.$e_0.style.display="";RTE.Cursor.updateRangeToCurrentSelectionWithOptions(true);this.$5p_0&&this.$5p_0.focus()}},$88_0:function(a){ULSNVe:;if(this.$e_0){this.$e_0.style.display="none";a&&RTE.Cursor.select()}},$HS_0:function(a){ULSNVe:;if(this.$16_0)while(a){if(a===this.$16_0)return true;a=a.parentNode}return false},$FH_0:function(){ULSNVe:;this.$q_0=this.$17_0.ownerDocument.createElement("DIV");this.$q_0.id="rtePasteFlyout";this.$q_0.className="ms-cui-menu ms-noWrap";this.$q_0.style.position="absolute";var a=document.createElement("DIV");a.className="ms-cui-menusection";this.$q_0.appendChild(a);this.$1p_0=document.createElement("A");this.$1p_0.id="rtePasteFlyoutLink";this.$1p_0.className="ms-cui-ctl";this.$1p_0.href="javascript:;";a.appendChild(this.$1p_0);var e=this;$addHandler(this.$1p_0,"click",function(a){ULSNVe:;e.$BT_0();SP.UI.UIUtility.cancelEvent(a);return false});var b=RTE.RibbonReferences.$4b(RTE.RibbonReferences.$9L,"-199","-235",16,16);b.id="rtePasteFlyoutImg";b.className="ms-cui-img-16by16 ms-cui-img-cont-float";this.$1p_0.appendChild(b);var c=document.createElement("SPAN");c.id="rtePasteFlyoutText";c.appendChild(document.createTextNode(SP.Res.pasteFlyoutExpand));this.$1p_0.appendChild(c);var d=RTE.RibbonReferences.$4b(RTE.RibbonReferences.$BK,"-27","-35",5,3);d.id="rtePasteFlyoutArrow";d.className="ms-cui-img-5by3 ms-cui-img-cont-float";this.$1p_0.appendChild(d);this.$16_0.appendChild(this.$q_0)},$FI_0:function(){ULSNVe:;this.$e_0=document.createElement("DIV");this.$e_0.id="rtePasteFlyoutOptions";this.$e_0.className="ms-cui-menu ms-noWrap";this.$e_0.style.position="absolute";$addHandler(this.$e_0,"keydown",this.$$d_$Hr_0);var f=document.createElement("DIV");f.className="ms-cui-smenu-inner";this.$e_0.appendChild(f);var e=document.createElement("DIV");e.className="ms-cui-menusection";f.appendChild(e);var g=document.createElement("DIV");g.className="ms-cui-menusection-title";g.appendChild(document.createTextNode(SP.Res.pasteFlyoutPasteOptions));e.appendChild(g);for(var h=RTE.RtePasteManager.get_pasteModes(),c=0;c<h.length;c++){var d=h[c],j=this.$AC_0===d.id,a=document.createElement("A");a.title=d.flyoutTooltip||d.displayName;a.id="rtePasteFlyoutOption"+c;a.className="ms-cui-ctl ms-rtePasteFlyout-option"+(j?" ms-cui-ctl-on":"");a.href="javascript:;";a.setAttribute("PasteModeId",d.id);e.appendChild(a);var i=d.flyoutIcon.cloneNode(true);i.className="ms-cui-img-cont-float";var b=i;while(b&&b.nodeType===1&&b.tagName.toUpperCase()!=="IMG")b=b.firstChild;if(b&&b.nodeType===1&&b.tagName.toUpperCase()==="IMG")b.alt=a.title;a.appendChild(i);var k=this;$addHandler(a,"click",function(a){ULSNVe:;var b=RTE.RteUtility.$G(a.target,"A");if(b){var c=b.getAttribute("PasteModeId");!RTE.SU.$2(c)&&k.$AV_0(c)}SP.UI.UIUtility.cancelEvent(a);return false});if(j||!this.$5p_0)this.$5p_0=a;if(!c)this.$A8_0=a;if(c===h.length-1)this.$AD_0=a}SP.UI.UIUtility.insertAfter(this.$e_0,this.$q_0)},$Hr_0:function(a){ULSNVe:;if(a.keyCode===39||a.keyCode===37){var h=a.keyCode===39,c=a.target;if(c&&c.nodeType===1&&c.tagName.toUpperCase()==="A"){var b=c;do b=h?RTE.RteUtility.$t(b,false):RTE.RteUtility.$m(b,false);while(b&&(b.nodeType!==1||b.tagName.toUpperCase()!=="A"));if(!b)b=h?this.$A8_0:this.$AD_0;if(b){b.focus();SP.UI.UIUtility.cancelEvent(a)}}return}if(a.keyCode===27){this.$88_0(true);SP.UI.UIUtility.cancelEvent(a);return}var f=String.fromCharCode(a.keyCode).toUpperCase();if(a.ctrlKey&&f==="A"){SP.UI.UIUtility.cancelEvent(a);return}for(var g=RTE.RtePasteManager.get_pasteModes(),e=0;e<g.length;e++){var d=g[e];if(d&&!RTE.SU.$2(d.flyoutShortcutKey)&&d.flyoutShortcutKey.toUpperCase()===f){SP.UI.UIUtility.cancelEvent(a);this.$AV_0(d.id);return}}},$AV_0:function(b){ULSNVe:;this.$2y_0.style.width="1px";this.$2y_0.style.height="1px";this.$2y_0.style.overflow="hidden";document.body.appendChild(this.$2y_0);var a=this;RTE.RtePasteManager.$9N(this.$2y_0,true,b,function(){ULSNVe:;RTE.Cursor.s_range.clear();RTE.Cursor.$L.replaceWithChildren(a.$2y_0);RTE.Cursor.s_range.moveBeforeNode(RTE.Cursor.$L.$4_0);RTE.Cursor.update();RTE.ClientWebPartManager.replaceRenderNodesToCurrent()})},$IM_0:function(){ULSNVe:;var a=RTE.Cursor.$L.$4_0;do a=a.lastChild||RTE.RteUtility.$m(a,false)||RTE.RteUtility.$m(a.parentNode,false);while(a&&a!==this.$17_0&&!RTE.PasteFlyout.$JV(a));if(!a||a===this.$17_0||a===RTE.Cursor.$L.$3_0)a=RTE.Cursor.$L.$4_0;return a}};RTE.RtePasteManager=function(){};RTE.RtePasteManager.registerPasteMode=function(a){ULSNVe:;RTE.RtePasteManager.$6A();RTE.RtePasteManager.$32[a.id]=a};RTE.RtePasteManager.removePasteMode=function(a){ULSNVe:;RTE.RtePasteManager.$6A();delete RTE.RtePasteManager.$32[a]};RTE.RtePasteManager.get_pasteModes=function(){ULSNVe:;RTE.RtePasteManager.$6A();var c=new Array(0),a=RTE.RtePasteManager.$32;for(var b in a){var d={key:b,value:a[b]};Array.add(c,d.value)}return c};RTE.RtePasteManager.getPasteMode=function(a){ULSNVe:;RTE.RtePasteManager.$6A();return!RTE.SU.$2(a)?RTE.RtePasteManager.$32[a]||null:null};RTE.RtePasteManager.cancelCurrentPaste=function(){ULSNVe:;RTE.RtePasteManager.$2C&&RTE.RtePasteManager.$2C.cancel();if(RTE.RtePasteManager.$3h){RTE.RteUtility.removeChildNodes(RTE.RtePasteManager.$3h);RTE.RtePasteManager.$3h=null}RTE.Cursor.$1g()};RTE.RtePasteManager.pasteModeResolver=function(a){ULSNVe:;if(a.getElementsByTagName("o:p").length>0)return"PasteClean";if(a.querySelectorAll)for(var c=a.querySelectorAll("p, h1, h2, h3, b, i, u, table"),b=0;b<c.length;b++){var e=c[b],d=e.getAttribute("style");if(!RTE.SU.$7(d)&&d.indexOf("mso-")>-1)return"PasteClean"}return"PasteAsIs"};RTE.RtePasteManager.$9N=function(a,j,m,d){ULSNVe:;RTE.PasteFlyout.$CF(true);var c=RTE.Canvas.currentEditableRegion(),e=RTE.Canvas.getCachedRestriction(c,"RestrictPasteToText",false)||RTE.Canvas.getCachedRestriction(c,"DisableRibbonCommands",false);RTE.RtePasteManager.$2C=!e?RTE.RtePasteManager.$IQ(m,a):null;if(!j)try{RTE.RtePasteManager.$E1(a)}catch(n){RTE.RteUtility.removeChildNodes(a)}if(e){RTE.Canvas.$4n(a);d&&d();return}RTE.RtePasteManager.$3h=a;var f=document.createElement("DIV");f.innerHTML=a.innerHTML;var g=!a.firstChild||a.firstChild===a.lastChild&&RTE.RteUtility.$3u(a.firstChild,false),k=!g&&a.firstChild===a.lastChild&&SP.UI.UIUtility.isTextNode(a.firstChild),l=RTE.RtePasteManager.$2C?RTE.RtePasteManager.$2C.id:null,b=new RTE.PasteOperationArgs;b.showFlyoutAfterOperation=!g&&RTE.RtePasteManager.get_pasteModes().length>1&&(!k||RTE.RtePasteManager.$Iq(a));b.isFlyoutOperation=j;b.container=a;b.editableRegion=c;var h=false,i=function(){ULSNVe:;h=true;RTE.RteUtility.removeRteNodeId(RTE.Cursor.s_range.$3_0);RTE.RteUtility.removeRteNodeId(RTE.Cursor.s_range.$4_0);RTE.RtePasteManager.$Fq(a);d&&d();RTE.RteUtility.forEachChildWithTagAndClass(c,"TABLE","ms-rte-paste-settablesizes",function(a){ULSNVe:;Sys.UI.DomElement.removeCssClass(a,"ms-rte-paste-settablesizes");RTE.Canvas.setTableWidths&&RTE.TableCommands.$EJ(a)});RTE.RteUtility.forEachChildWithTagAndClass(c,"IMG","ms-rte-paste-setimagesize",function(a){ULSNVe:;Sys.UI.DomElement.removeCssClass(a,"ms-rte-paste-setimagesize");var b=a;RTE.RteUtility.initImage(a);var c=a.style.height,d=b.getAttribute("height");if(!RTE.SU.$2(c)||!RTE.SU.$2(d)){var e=b.width+"px",f=b.height;a.removeAttribute("height");a.style.height="";if(Math.abs(f-b.height)<=2){a.removeAttribute("width");a.style.width=e}else{!RTE.SU.$2(d)&&a.setAttribute("height",d);if(!RTE.SU.$2(c))a.style.height=c}}});RTE.RtePasteManager.$2C=null;RTE.RtePasteManager.$3h=null;RTE.Cursor.$1g();b.showFlyoutAfterOperation&&window.setTimeout(function(){ULSNVe:;RTE.PasteFlyout.$LL(f,l)},0)};if(!RTE.SU.$7(RTE.RtePasteManager.$2C))RTE.RtePasteManager.$2C.execute(b,i);else i();!h&&RTE.Cursor.$9w()};RTE.RtePasteManager.$IQ=function(a,d){ULSNVe:;var b=RTE.RtePasteManager.getPasteMode(a);if(!RTE.SU.$7(b))return b;var c=RTE.Canvas.getStringRestriction(RTE.Canvas.currentEditableRegion(),"DefaultPasteModeResolver",null);a=RTE.RtePasteManager.$JC(c,d);return RTE.RtePasteManager.getPasteMode(a)};RTE.RtePasteManager.$JC=function($p0,$p1){var $v_0=RTE.RtePasteManager.getPasteMode($p0);if(!RTE.SU.$7($v_0))return $v_0.id;try{var $v_2;try{$v_2=!RTE.SU.$2($p0)?eval($p0):null}catch($$e_4){$v_2=null}if(!$v_2||typeof $v_2!=="function")$v_2=RTE.RtePasteManager.pasteModeResolver;var $v_3=$v_2($p1);if(typeof $v_3==="string")if(!RTE.SU.$7(RTE.RtePasteManager.getPasteMode($v_3)))return $v_3}catch($$e_6){}var $v_1=RTE.RtePasteManager.get_pasteModes();return $v_1.length>0?$v_1[0].id:null};RTE.RtePasteManager.$E1=function(a){ULSNVe:;RTE.RteUtility.forEachChildWithTagAndClass(a,"o:p",null,function(b){ULSNVe:;do{var c=b.parentNode;RTE.RteUtility.removeNodeAndKeepChildNodes(b);b=c}while(!b.firstChild&&b!==a)});RTE.RteUtility.forEachChildWithTagAndClass(a,null,"ms-rtegenerate-allskip",RTE.RteUtility.$J);RTE.RteUtility.forEachChildWithTagAndClass(a,null,"ms-rtegenerate-skip",RTE.RteUtility.removeNodeAndKeepChildNodes);RTE.RteUtility.forEachChildWithTagAndClass(a,null,"ms-rtestate-write",function(c){ULSNVe:;var b=c.parentNode;while(b&&b!==a){if(Sys.UI.DomElement.containsCssClass(b,"ms-rte-wpbox"))return;if(Sys.UI.DomElement.containsCssClass(b,"ms-rtestate-write"))break;b=b.parentNode}Sys.UI.DomElement.removeCssClass(c,"ms-rtestate-write")});RTE.SafeHtml.$Ko(a)};RTE.RtePasteManager.$Iq=function(c){ULSNVe:;for(var b=RTE.RtePasteManager.get_pasteModes(),a=0;a<b.length;a++)if(b[a].changesTextOnly(c))return true;return false};RTE.RtePasteManager.$6A=function(){ULSNVe:;if(!RTE.RtePasteManager.$32){RTE.RtePasteManager.$32={};RTE.RtePasteManager.registerPasteMode(new RTE.AsIsPasteMode);RTE.RtePasteManager.registerPasteMode(new RTE.CleanPasteMode);RTE.RtePasteManager.registerPasteMode(new RTE.PlainTextPasteMode)}};RTE.RtePasteManager.$Fq=function(h){ULSNVe:;if(h.querySelectorAll)for(var e=h.querySelectorAll("p, h1, h2, h3, b, i, u, table"),b=0;b<e.length;b++){var f=e[b],c=f.getAttribute("style");if(!RTE.SU.$7(c)&&c.indexOf("mso-")>-1){for(var d=c.split(";"),g="",a=0;a<d.length;a++)if(d[a].indexOf("mso-")===-1)g+=d[a]+";";f.setAttribute("style",g)}}};RTE.PasteOperationArgs=function(){};RTE.PasteOperationArgs.prototype={container:null,isFlyoutOperation:false,showFlyoutAfterOperation:false,editableRegion:null};RTE.PasteMode=function(){};RTE.PasteMode.$E0=function(a){ULSNVe:;RTE.PasteMode.$7A(a.lastChild);RTE.PasteMode.$7A(a.firstChild);var b=a.firstChild;if(b&&b===a.lastChild)if(b.nodeType===1&&b.tagName.toUpperCase()==="P"){RTE.RteUtility.removeNodeAndKeepChildNodes(b);RTE.PasteMode.$7A(a.lastChild);RTE.PasteMode.$7A(a.firstChild)}};RTE.PasteMode.$7A=function(a){ULSNVe:;if(a&&a.nodeType===1)if(a.tagName.toUpperCase()==="P"){var b=a.firstChild,c=!b;if(!c&&b===a.lastChild&&b.nodeType===1){var d=b.tagName.toUpperCase();if(d==="BR"||d==="DIV"&&!b.firstChild)c=true}c&&RTE.RteUtility.$J(a)}else a.tagName.toUpperCase()==="BR"&&RTE.RteUtility.$J(a)};RTE.PasteMode.prototype={id:null,displayName:null,displayTooltipTitle:null,displayTooltipDescription:null,ribbonImage:null,ribbonImageLeft:null,ribbonImageTop:null,flyoutIcon:null,flyoutShortcutKey:null,flyoutTooltip:null,cancel:function(){},changesTextOnly:function(){ULSNVe:;return false},appendRibbonButtonProperties:function(a){ULSNVe:;a.LabelText=this.displayName;a.ToolTipTitle=this.displayTooltipTitle||this.displayName;a.ToolTipDescription=this.displayTooltipDescription||this.displayName;if(!RTE.SU.$2(this.ribbonImage)){a.Image16by16=this.ribbonImage;if(!RTE.SU.$2(this.ribbonImageLeft))a.Image16by16Left=this.ribbonImageLeft;if(!RTE.SU.$2(this.ribbonImageTop))a.Image16by16Top=this.ribbonImageTop}}};RTE.WordConverterPasteMode=function(){ULSNVe:;this.$$d_$Er_1=Function.createDelegate(this,this.$Er_1);this.$$d_$KH_1=Function.createDelegate(this,this.$KH_1);RTE.WordConverterPasteMode.initializeBase(this)};RTE.WordConverterPasteMode.prototype={$5m_1:null,$2j_1:null,arguments:null,doneCallback:null,convertWordLists:true,execute:function(c,b){ULSNVe:;this.arguments=c;var a=this;this.doneCallback=function(){ULSNVe:;if(!a.arguments.isFlyoutOperation&&a.$5m_1&&a.$5m_1.$7g_0>0)RTE.RteUtility.isClassAvailable("SP.UI.Notify")&&SP.UI.Notify.addNotification("<b>"+SP.Res.pasteListConvertedTitle+":</b> "+SP.Res.pasteListConvertedText,false);b&&b()};this.$2j_1=new RTE.PasteCommon.SimpleOperation(null,this.$$d_$KH_1,null);this.$2j_1.$9c_1()},$KH_1:function(a){ULSNVe:;this.$5m_1=null;if(this.convertWordLists){this.$5m_1=new RTE.HtmlImport.WordConverter;this.$5m_1.process(this.arguments.container,a)}a.$60_1(this.$$d_$Er_1);return true},cancel:function(){ULSNVe:;this.$2j_1&&this.$2j_1.$FM_1();this.$2j_1=null;this.arguments=null;this.doneCallback=null}};RTE.AsIsPasteMode=function(){ULSNVe:;this.$$d_$AT_2=Function.createDelegate(this,this.$AT_2);RTE.AsIsPasteMode.initializeBase(this);this.id="PasteAsIs";this.displayName=SP.Res.pasteAsIsLabel;this.displayTooltipTitle=SP.Res.pasteAsIsTooltipTitle;this.displayTooltipDescription=SP.Res.pasteAsIsTooltipDescription;this.ribbonImage=RTE.RibbonReferences.$9L;this.ribbonImageLeft="-199";this.ribbonImageTop="-235";this.flyoutIcon=RTE.RibbonReferences.$4b(RTE.RibbonReferences.$Dd,"-1","-35",24,24);this.flyoutShortcutKey=SP.Res.pasteAsIsShortcut;this.flyoutTooltip=SP.Res.pasteAsIsLabelFlyout};RTE.AsIsPasteMode.$Cj=function(d){ULSNVe:;for(var c=d.childNodes.length,b=0;b<c;b++){var a=d.childNodes[b];if(SP.UI.UIUtility.isTextNode(a))continue;if(a.nodeType===1&&a.tagName==="A")if(a.firstChild&&a.firstChild===a.lastChild&&SP.UI.UIUtility.isTextNode(a.firstChild)){var e=a.firstChild.nodeValue,f=a.href;if(e===f)continue}return false}return c>0};RTE.AsIsPasteMode.replaceTag=function(c,f,e,g,b,d){ULSNVe:;var a=null;RTE.RteUtility.forEachChildWithTagAndClass(c,f,e,function(e){ULSNVe:;if(!a){a=c.ownerDocument.createElement(g);if(!RTE.SU.$2(b))a.className=b;if(!RTE.SU.$2(d))a.style.cssText=d}var f=a.cloneNode(false);RTE.RteUtility.$k(e,f);e.parentNode.replaceChild(f,e)})};RTE.AsIsPasteMode.prototype={convertIframes:true,$Er_1:function(e){ULSNVe:;var a=this.arguments.container;if(this.convertIframes&&RTE.AsIsPasteMode.$Cj(a)){var b;if(typeof a.innerText==="string")b=a.innerText;else b=a.textContent;var c=RTE.RteUtility.$4p(b);if(c&&c.length>0)try{var d=this;RTE.EmbeddingCommands.$7b(c,this.arguments.editableRegion,function(h){ULSNVe:;try{for(var f=true,g=0;g<c.length;g++)f=f&&h[g];if(f){var e=RTE.EmbeddingCommands.$B5();e.innerHTML=b;RTE.RtePasteManager.$E1(e);RTE.RteUtility.removeChildNodes(a);a.appendChild(e);RTE.EmbeddingCommands.moveEmbeddingBoxIntoEditMode(e);d.arguments.showFlyoutAfterOperation=true}}catch(i){}d.$Ao_2()});return false}catch(f){}}e.$60_1(this.$$d_$AT_2);return true},$AT_2:function(){ULSNVe:;this.$Ao_2();return false},$Ao_2:function(){ULSNVe:;var a=this.arguments.container;RTE.AsIsPasteMode.replaceTag(a,"B",null,"STRONG",null,null);RTE.AsIsPasteMode.replaceTag(a,"I",null,"EM",null,null);RTE.AsIsPasteMode.replaceTag(a,"U",null,"SPAN",null,"text-decoration: underline;");RTE.PasteMode.$E0(a);var b=this;RTE.RteUtility.forEachChildWithTagAndClass(a,"IMG",null,function(a){ULSNVe:;if(!RTE.Canvas.isSkipNode(a)){var b=a;if(RTE.SU.$2(b.src))RTE.RteUtility.$J(a);else Sys.UI.DomElement.addCssClass(a,"ms-rte-paste-setimagesize")}});this.$2j_1=null;this.doneCallback&&this.doneCallback()},changesTextOnly:function(a){ULSNVe:;if(RTE.AsIsPasteMode.$Cj(a)){var b;if(typeof a.innerText==="string")b=a.innerText;else b=a.textContent;var c=RTE.RteUtility.$4p(b);if(c&&c.length>0)return true}return RTE.PasteMode.prototype.changesTextOnly.call(this,a)}};RTE.CleanPasteMode=function(){ULSNVe:;this.$$d_$AT_2=Function.createDelegate(this,this.$AT_2);RTE.CleanPasteMode.initializeBase(this);this.id="PasteClean";this.displayName=SP.Res.pasteCleanLabel;this.displayTooltipTitle=SP.Res.pasteCleanTooltipTitle;this.displayTooltipDescription=SP.Res.pasteCleanTooltipDescription;this.ribbonImage=RTE.RibbonReferences.$Df;this.ribbonImageLeft="-217";this.ribbonImageTop="-235";this.flyoutIcon=RTE.RibbonReferences.$4b(RTE.RibbonReferences.$De,"-35","-27",24,24);this.flyoutShortcutKey=SP.Res.pasteCleanShortcut;this.flyoutTooltip=SP.Res.pasteCleanLabelFlyout};RTE.CleanPasteMode.$$cctor=function(){ULSNVe:;RTE.CleanPasteMode.passThroughClasses[RTE.CleanPasteMode.passThroughClasses.length]="ms-rte-wpbox";RTE.CleanPasteMode.passThroughClasses[RTE.CleanPasteMode.passThroughClasses.length]="ms-rte-embedcode"};RTE.CleanPasteMode.prototype={$4f_2:null,convertWordQuotes:true,execute:function(a,b){ULSNVe:;var c=this;RTE.RteUtility.forEachChildWithTagAndClass(a.container,"STYLE",null,function(a){ULSNVe:;a.parentNode.removeChild(a)});RTE.WordConverterPasteMode.prototype.execute.call(this,a,b)},$Er_1:function(e){ULSNVe:;var a=this.arguments.container;this.$4f_2=a.ownerDocument.createElement("DIV");var b=new RTE.RteHtmlPasteSteward(this.$4f_2);b.$B1_1=this.convertWordQuotes;var f=new RTE.RteHtmlNormalizer(b),c=new RTE.RteHtmlTranslator(f);c.$4T_2=RTE.CleanPasteMode.passThroughClasses;var d=new RTE.HtmlImport.HtmlProcessor(c);d.registerNewTag("SPAN");var g=new RTE.PasteCommon.HtmlProcessorPercentage;e.set_$73_1(g.$$d_$Lb_0);d.process(a,this.$2j_1);e.$60_1(this.$$d_$AT_2);return true},$AT_2:function(b){ULSNVe:;var a=this.arguments.container;b.set_$73_1(null);this.$2j_1=null;RTE.RteUtility.removeChildNodes(a);RTE.RteUtility.$k(this.$4f_2,a);RTE.PasteMode.$E0(a);this.doneCallback&&this.doneCallback();this.arguments=null;this.$4f_2=null;return false},cancel:function(){ULSNVe:;RTE.WordConverterPasteMode.prototype.cancel.call(this);this.$4f_2=null}};RTE.PlainTextPasteMode=function(){ULSNVe:;RTE.PlainTextPasteMode.initializeBase(this);this.id="PastePlain";this.displayName=SP.Res.pastePlainLabel;this.displayTooltipTitle=SP.Res.pastePlainTooltipTitle;this.displayTooltipDescription=SP.Res.pastePlainTooltipDescription;this.ribbonImage=RTE.RibbonReferences.$Dh;this.ribbonImageLeft="-249";this.ribbonImageTop="-1";this.flyoutIcon=RTE.RibbonReferences.$4b(RTE.RibbonReferences.$Dg,"-35","-1",24,24);this.flyoutShortcutKey=SP.Res.pastePlainShortcut;this.flyoutTooltip=SP.Res.pastePlainLabelFlyout};RTE.PlainTextPasteMode.prototype={execute:function(e,d){ULSNVe:;var b=e.container;RTE.ClientWebPartManager.$4m(b);var a;try{if(typeof b.innerText==="string")a=b.innerText;else a=b.textContent}catch(f){var c=RTE.Range.createRange();c.moveToElementText(b);a=c.get_innerText()}a=RTE.RteUtility.htmlEncode(a);a=a.replace(RTE.PlainTextPasteMode.$AG,"").replace(RTE.PlainTextPasteMode.$AH,"\n").replace(RTE.PlainTextPasteMode.$AI,"<br/>");a=a.replace(RTE.PlainTextPasteMode.$AJ," ");RTE.RteUtility.removeChildNodes(b);b.innerHTML=a;d&&d()}};RTE.PreviewManager=function(){ULSNVe:;this.$6Q_0=new RTE.ElementPlaceholderReplacer};RTE.PreviewManager.get_instance=function(){ULSNVe:;if(!RTE.PreviewManager.$W)RTE.PreviewManager.$W=new RTE.PreviewManager;return RTE.PreviewManager.$W};RTE.PreviewManager.prototype={$1m_0:null,$8N_0:false,$7M_0:null,beginPreview:function(){ULSNVe:;if(this.$1m_0)return;var c=RTE.Selection.getSelectionRange();if(c){var b=c.parentElement();b&&RTE.RteUtility.$2b(b)&&RTE.Canvas.isEditable(b)&&RTE.Cursor.cursorRangeIsNowOutdated()}if(!RTE.Cursor.get_range().get_isInEditableRegion())return;var a=RTE.Cursor.get_range().getEditableRegion();if(!a)return;RTE.SnapshotManager.takeSnapshot();this.$6Q_0.$Kt_0(a,"IFRAME",null,"ms-rteIframePlaceholder");this.$1m_0=RTE.Snapshot.$ID(a);this.$1H_0=null;this.$8N_0=true;this.$7M_0=RTE.ScrollPosition.$7t(a)},$1H_0:null,endPreview:function(){ULSNVe:;if(!this.$1m_0)return;var a=this.$1m_0;this.$1m_0=null;this.$7M_0=null;a.$9Z_0();this.$6Q_0.$9a_0();RTE.SnapshotManager.$5Y(a.$P_0,a.$1T_0);this.$1H_0=null},restoreBeginState:function(){ULSNVe:;if(!this.$1m_0)return;if(this.$8N_0){this.$8N_0=false;if(RTE.RteUtility.isInternetExplorer()){var a=RTE.Selection.getSelectionRange();if(a){a.collapse(true);a.select()}}RTE.Cursor.s_range.get_$6Y_0()&&RTE.Selection.getSelection().clear()}this.$1m_0.$9Z_0();RTE.SnapshotManager.$5Y(this.$1m_0.$P_0,this.$1m_0.$1T_0);this.$1H_0=null},commitCommandOrAfterPreview:function(a){ULSNVe:;if(!RTE.SPRichTextEditorComponentProvider.$3g(a)){this.commitPreview();return true}else RTE.SPRichTextEditorComponentProvider.$3g(a)===1&&RTE.ScrollPosition.$7k(this.$7M_0);return false},commitPreview:function(){ULSNVe:;this.$6Q_0.$9a_0();this.$1m_0=null;this.$1H_0=null;this.$7M_0=null;RTE.SnapshotManager.takeSnapshot()},get_hasPreview:function(){ULSNVe:;return!!this.$1m_0}};RTE.ScrollPosition=function(){};RTE.ScrollPosition.$7t=function(a){ULSNVe:;var c=new Array(0);while(a){var e=a.scrollTop,f=a.scrollLeft,d=!!e||!!f;if(!d){var g=a.scrollHeight,h=a.scrollWidth;d=!!g&&!!h&&g!==a.clientHeight||h!==a.clientWidth}if(d){var b=new RTE.ScrollPosition;b.$4o_0=a;b.$9l_0=e;b.$9k_0=f;c[c.length]=b}a=a.parentNode}return c};RTE.ScrollPosition.$7k=function(a){ULSNVe:;if(a&&a.length>0)for(var b=0;b<a.length;b++)a[b].$Ez_0()};RTE.ScrollPosition.prototype={$4o_0:null,$9l_0:0,$9k_0:0,$Ez_0:function(){ULSNVe:;if(this.$4o_0.scrollTop!==this.$9l_0)this.$4o_0.scrollTop=this.$9l_0;if(this.$4o_0.scrollLeft!==this.$9k_0)this.$4o_0.scrollLeft=this.$9k_0}};RTE.ElementPlaceholderReplacer=function(){ULSNVe:;this.$1b_0={}};RTE.ElementPlaceholderReplacer.prototype={$Kt_0:function(c,d,e,a){ULSNVe:;this.$9a_0();var b=this;RTE.RteUtility.forEachChildWithTagAndClass(c,d,e,function(c){ULSNVe:;var e="hold"+SP.Guid.newGuid(),d=c.ownerDocument.createElement("DIV");d.style.width=c.clientWidth+"px";d.style.height=c.clientHeight+"px";d.id=e;if(!RTE.SU.$2(a))d.className=a;b.$1b_0[e]=c;c.parentNode.replaceChild(d,c)})},$9a_0:function(){ULSNVe:;var b=this.$1b_0;for(var c in b){var d={key:c,value:b[c]},a=$get(d.key);a&&a.parentNode&&a.parentNode.replaceChild(d.value,a)}this.$1b_0={}}};RTE.Range=function(a){ULSNVe:;this.$B_0=a};RTE.Range.createRange=function(){ULSNVe:;var a=RTE.DomHelper.createRange(window.document);return a?new RTE.Range(a):null};RTE.Range.$9n=function(a){ULSNVe:;if(a.select){a.select();return}var b=null,c=null;if(RTE.RteUtility.isSafari()){if(a.startContainer&&a.startContainer.nodeType===1){b=a.startContainer.style.display;if(!a.startOffset&&a.startContainer.nodeName==="SPAN"&&a.startContainer.innerHTML==="")a.startContainer.style.display="none"}if(a.endContainer&&a.endContainer.nodeType===1){c=a.endContainer.style.display;if(!a.endOffset&&a.endContainer.nodeName==="SPAN"&&a.endContainer.innerHTML==="")a.endContainer.style.display="none"}}var d=RTE.Selection.getSelection();d.$2h_0.removeAllRanges();d.$2h_0.addRange(a);if(RTE.RteUtility.isSafari()){if(a.startContainer&&a.startContainer.nodeType===1){a.startContainer.style.display=b;RTE.RteUtility.$E2(a.startContainer)}if(a.endContainer&&a.endContainer.nodeType===1){a.endContainer.style.display=c;RTE.RteUtility.$E2(a.endContainer)}}};RTE.Range.prototype={$B_0:null,duplicate:function(){ULSNVe:;var a=RTE.DomHelper.duplicateRange(this.$B_0);return new RTE.Range(a)},collapse:function(a){ULSNVe:;this.$B_0.collapse&&this.$B_0.collapse(a)},moveToElementText:function(a){ULSNVe:;if(this.$B_0.moveToElementText){this.$B_0.moveToElementText(a);return}this.$B_0.selectNodeContents&&this.$B_0.selectNodeContents(a)},pasteHtml:function(a){ULSNVe:;RTE.DomHelper.pasteHtmlIntoRange(this.$B_0,a)},get_innerText:function(){ULSNVe:;var a=this.$B_0.text;if(RTE.SU.$7(a))a=this.$B_0.toString();return a},get_innerHTML:function(){ULSNVe:;if(!RTE.SU.$1R(this.$B_0.htmlText))return this.$B_0.htmlText;else{var b=this.$B_0.cloneContents(),a=document.createElement("DIV");a.appendChild(b);return a.innerHTML}},compareEndPoints:function(a,b){ULSNVe:;var c=RTE.Range.$9h[a];return RTE.DomHelper.compareRangeEndPoints(this.$B_0,c,b.$B_0)},$5X_0:function(b,c){ULSNVe:;var a=RTE.Range.$9h[b];RTE.DomHelper.setRangeEndPoint(this.$B_0,a,c.$B_0)},inRange:function(a){ULSNVe:;return RTE.DomHelper.isRangeInRange(this.$B_0,a.$B_0)},isVisible:function(){ULSNVe:;return RTE.DomHelper.isRangeVisible(this.$B_0)},parentElement:function(){ULSNVe:;var b=this.$B_0;if(b.parentElement){var a=b.parentElement(),c=RTE.DomHelper.createRange(window.document);if(a)try{c.moveToElementText(a)}catch(h){}while(a&&!c.inRange(b)){a=a.parentNode;try{c.moveToElementText(a)}catch(i){}}if(a){var e=true;while(e){e=false;for(var g=a.childNodes.length,d=0;d<g;d++)if(!SP.UI.UIUtility.isTextNode(a.childNodes[d])){c.moveToElementText(a.childNodes[d]);if(c.inRange(b)){a=a.childNodes[d];e=true;break}}}}return a}var f=b.commonAncestorContainer;return f?f:null},$9G_0:function(c){ULSNVe:;var a=this.$B_0.startContainer;if(!RTE.SU.$7(a)&&RTE.RteUtility.$Q(a)&&a.childNodes.length>0){var b=null;if(this.$B_0.startOffset!==a.childNodes.length){b=a.childNodes[this.$B_0.startOffset];this.$B_0.setStart(b,0)}b&&b.childNodes.length>0&&this.$9G_0(c)}},$CR_0:function(a,g,q){ULSNVe:;this.$9G_0(g);var e=this.$B_0,b=e.startContainer,n=g?RTE.Cursor.s_range.$4_0.parentNode:RTE.Cursor.s_range.$3_0.parentNode,h=false;if(!RTE.SU.$7(b)){h=true;if(RTE.RteUtility.$CZ(b))h=false;else if(RTE.Canvas.$3v(b.tagName))return false;else if(SP.UI.UIUtility.isSvgNode(b)){while(SP.UI.UIUtility.isSvgNode(b.parentNode))b=b.parentNode;SP.UI.UIUtility.insertBefore(a,b)}else if(!e.startOffset)if(SP.UI.UIUtility.isTextNode(b)||RTE.RteUtility.$3t(b))SP.UI.UIUtility.insertBefore(a,b);else if(!b.firstChild)b.appendChild(a);else b.insertBefore(a,b.firstChild);else if(SP.UI.UIUtility.isTextNode(b)&&e.startOffset===b.nodeValue.length)SP.UI.UIUtility.insertAfter(a,b);else if(!g&&SP.UI.UIUtility.isTextNode(b)){var l=e.startOffset,r=b.nodeValue.substr(0,l),u=b.nodeValue.substr(l),s=RTE.RteUtility.createTextNode(b.ownerDocument,r),o=b.parentNode;o.insertBefore(s,b);o.insertBefore(a,b);var k=RTE.DomHelper.createRange(window.document);k.setStart(b,0);k.setEnd(b,l);k.deleteContents();k.detach()}else h=false}if(!h)if(!RTE.SU.$7(e.insertNode))e.insertNode(a);else{var d=null;try{var p="rangePosition"+SP.Guid.newGuid().toString();this.pasteHtml("<span id='"+p+"'></span>");var m=$get(p);d=m.parentNode;if(RTE.RteUtility.$3t(d))if(d.tagName==="IMG")if(g)SP.UI.UIUtility.insertAfter(a,d);else SP.UI.UIUtility.insertBefore(a,d);else SP.UI.UIUtility.insertBefore(a,d);else m.parentNode.replaceChild(a,m)}catch(t){if(!d){d=this.parentElement();if(!d)return false}SP.UI.UIUtility.insertBefore(a,d)}}var f=a.parentNode;while(f&&f.id.indexOf("range")!==-1){f.parentNode.insertBefore(a,f);f=f.parentNode}var i=a.nextSibling,j=a.previousSibling,c=a.parentNode;if(c){if(c.tagName==="BR"){if(!g)SP.UI.UIUtility.insertAfter(a,c);else SP.UI.UIUtility.insertBefore(a,c);i=a.nextSibling;j=a.previousSibling;c=a.parentNode}if((n!==c||q)&&c.tagName==="A"){if(!i)SP.UI.UIUtility.insertAfter(a,c);else!j&&SP.UI.UIUtility.insertBefore(a,c);i=a.nextSibling;j=a.previousSibling;c=a.parentNode}if((n!==c||q)&&Sys.UI.DomElement.containsCssClass(c,"ms-rtestate-read"))if(!i)SP.UI.UIUtility.insertAfter(a,c);else!j&&SP.UI.UIUtility.insertBefore(a,c)}return true},moveToMarkers:function(c,d,e){ULSNVe:;var a=RTE.Range.createRange();a.moveToElementText(c);if(e){this.$5X_0(2,a);this.$5X_0(1,a);this.collapse(true)}else{this.$5X_0(3,a);this.$5X_0(0,a);var b=RTE.Range.createRange();b.moveToElementText(d);this.$5X_0(2,b)}},select:function(){ULSNVe:;RTE.Range.$9n(this.$B_0)}};RTE.RemoveStyleOnSelectionProcessor=function(){ULSNVe:;RTE.RemoveStyleOnSelectionProcessor.initializeBase(this)};RTE.RemoveStyleOnSelectionProcessor.prototype={$83_1:false,setSettings:function(a,b){ULSNVe:;this.$83_1=b;RTE.SelectionNodesProcessor.prototype.setSelectionSettings.call(this,a)},process:function(){ULSNVe:;this.$15_1()},$Ei_1:function(d,e,c){ULSNVe:;var a=null;if(c)a=this.$N_0.$3_0;else a=this.$N_0.$4_0;var b=a.parentNode;while(a&&b){if(b===d)return a;else(c&&!a.previousSibling||!c&&!a.nextSibling)&&RTE.Canvas.isEditable(b)&&!RTE.Canvas.$i(b)&&e.push(b);a=b;b=a.parentNode}return null},$Ln_1:function(c){ULSNVe:;var a=this.get_parentElement();if(RTE.Canvas.$i(a))return;var d=this.$Ei_1(a,c,true),e=this.$Ei_1(a,c,false);if(d&&e&&d===a.firstChild&&e===a.lastChild){c.push(a);var b=a.parentNode;while(b&&b.childNodes.length===1&&!RTE.Canvas.$i(b)){c.push(b);b=b.parentNode}}},$15_1:function(){ULSNVe:;var c=this.get_innerNodes(),f=0;this.$Ln_1(c);for(var d=0;d<c.length;d++){var h=false,a=c[d];if(!a)continue;if(SP.UI.UIUtility.isTextNode(a))continue;if(!RTE.Canvas.isEditable(a)||RTE.Canvas.$i(a))continue;var m=a.className;if(m.indexOf("ms-rteKeepStyles")!==-1)continue;var b=a.tagName;if(b==="STRONG"||b==="B"||b==="U"||b==="EM"||b==="SUP"||b==="SUB"||b==="I"||b==="FONT"){RTE.RteUtility.removeNodeAndKeepChildNodes(a);c[d]=null;f++;continue}else if(b==="H1"||b==="H2"||b==="H3"||b==="H4"||b==="H5"||b==="H6"||b==="P"){if(RTE.RteUtility.$b(this.$N_0.$3_0,a,a)||RTE.RteUtility.$b(this.$N_0.$4_0,a,a)){if(b!=="DIV"){var n=a.ownerDocument.createElement("DIV");a.parentNode.insertBefore(n,a);RTE.RteUtility.$k(a,n);RTE.RteUtility.$J(a)}}else{if(RTE.RteUtility.$t(a,false)){a.parentNode.insertBefore(a.ownerDocument.createElement("BR"),a.nextSibling);b==="P"&&a.parentNode.insertBefore(a.ownerDocument.createElement("BR"),a.nextSibling)}RTE.RteUtility.removeNodeAndKeepChildNodes(a)}c[d]=null;f++;continue}if(!this.$83_1&&b==="IMG")continue;if(!this.$83_1&&(b==="TH"||b==="TD"||b==="TR"||b==="HR"||b==="TABLE"||b==="TBODY"||b==="THEAD")){a.style.backgroundColor="";a.style.color="";a.style.fontFamily="";a.style.fontSize="";a.style.fontStyle="";a.style.fontWeight="";continue}var i="",j="",e=a.style;if(b==="TABLE"||b==="IMG"){i=e.width;j=e.height;e.width="";e.height=""}if(a.style.cssText!==""){a.removeAttribute("style");h=true}if(i!=="")e.width=i;if(j!=="")e.height=j;for(var o=m.split(" "),k="",p=o.length,l=0;l<p;l++){var g=o[l];if(g!=="")if(RTE.RteUtility.get_ignoreClasses()[g]||g.startsWith("ms-rterange"))k+=g+" ";else h=true}if(k===""){a.removeAttribute("className");a.removeAttribute("class")}else a.className=k;if(RTE.RteUtility.$6T(a)){RTE.RteUtility.removeNodeAndKeepChildNodes(a);c[d]=null;f++;continue}if(h)f++}RTE.SnapshotManager.setCurrentRegionDirtyIf(f>0)}};RTE.RibbonIds=function(){};RTE.CommandState=function(){};RTE.CommandState.prototype={$C_0:false,get_enabled:function(){ULSNVe:;return this.$C_0},set_enabled:function(a){ULSNVe:;this.$C_0=a;return a},$1I_0:false,get_applied:function(){ULSNVe:;return this.$1I_0},set_applied:function(a){ULSNVe:;this.$1I_0=a;return a},get_commandOn:function(){ULSNVe:;return this.$C_0&&this.$1I_0},$D_0:null,get_value:function(){ULSNVe:;return this.$D_0},set_value:function(a){ULSNVe:;this.$D_0=a;return a}};RTE.RichTextEditor=function(){};RTE.RichTextEditor.align=function(a){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.ParagraphCommands.align(a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.bold=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.FontCommands.$FD();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.removeStyles=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.FontCommands.$E3();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.bulletedList=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.ParagraphCommands.bulletedList();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.clearFormatting=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.FontCommands.$E3();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.copy=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.Cursor.copy();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.cut=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.Cursor.cut();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.decreaseIndent=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.ParagraphCommands.indent(false);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.deleteCell=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.deleteCell();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.deleteRow=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.deleteRow();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.deleteTable=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.deleteTable();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.deleteColumn=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.deleteColumn();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.editSource=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.HtmlSourceCommands.editSource();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.makeXhtml=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.XhtmlProcessor.xhtmlify();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.increaseIndent=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.ParagraphCommands.indent(true);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.insertLink=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.ObjectCommands.insertLink();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.insertImage=function(a){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.ObjectCommands.insertImage(a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.insertTable=function(a){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.insertTable(a);RTE.RteUtility.showRibbonTab("Ribbon.Table","TableLayoutTab");RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.insertRowAbove=function(){ULSNVe:;RTE.RichTextEditor.insertRow(true)};RTE.RichTextEditor.insertRowBelow=function(){ULSNVe:;RTE.RichTextEditor.insertRow(false)};RTE.RichTextEditor.insertRow=function(a){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.insertRow(a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.insertColumnLeft=function(){ULSNVe:;RTE.RichTextEditor.insertColumn(true)};RTE.RichTextEditor.insertColumnRight=function(){ULSNVe:;RTE.RichTextEditor.insertColumn(false)};RTE.RichTextEditor.insertColumn=function(a){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.insertColumn(a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.insertHtmlFromDialog=function(a,b,c){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.ObjectCommands.insertHtmlFromDialog(a,b,c);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.insertNewList=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.WebPartCommands.insertNewList();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.italic=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.FontCommands.$JX();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.mergeCells=function(){ULSNVe:;RTE.TableCommands.mergeCells()};RTE.RichTextEditor.mergeAbove=function(){ULSNVe:;RTE.TableCommands.mergeWithAbove()};RTE.RichTextEditor.mergeBellow=function(){ULSNVe:;RTE.TableCommands.mergeWithBelow()};RTE.RichTextEditor.mergeLeft=function(){ULSNVe:;RTE.TableCommands.mergeWithLeft()};RTE.RichTextEditor.mergeRight=function(){ULSNVe:;RTE.TableCommands.mergeWithRight()};RTE.RichTextEditor.numberedList=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.ParagraphCommands.numberedList();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.queryBold=function(){ULSNVe:;return RTE.FontCommands.$KS()};RTE.RichTextEditor.queryImageContextualGroup=function(){ULSNVe:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Image");a.$C_0=RTE.Canvas.$1D&&!!b;return a};RTE.RichTextEditor.queryItalic=function(){ULSNVe:;return RTE.FontCommands.$KT()};RTE.RichTextEditor.queryLinkContextualGroup=function(){ULSNVe:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Link");a.$C_0=RTE.Canvas.$1D&&!!b;return a};RTE.RichTextEditor.queryStrikeThrough=function(){ULSNVe:;return RTE.FontCommands.$KU()};RTE.RichTextEditor.querySubscript=function(){ULSNVe:;return RTE.FontCommands.$KV()};RTE.RichTextEditor.querySuperscript=function(){ULSNVe:;return RTE.FontCommands.$KW()};RTE.RichTextEditor.queryTableContextualGroup=function(){ULSNVe:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Table");a.$C_0=RTE.Canvas.$1D&&!!b;return a};RTE.RichTextEditor.queryUnderline=function(){ULSNVe:;return RTE.FontCommands.$KX()};RTE.RichTextEditor.relayout=function(a,d,c,b){ULSNVe:;RTE.SnapshotManager.takeSnapshot();var e=RTE.Canvas.getRTEFieldRegion();RTE.Cursor.get_range().collapse(true);RTE.LayoutsEditor.relayoutRegion(e,a,d,c,b);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.showCustomColorDialog=function(d,b,c){ULSNVe:;var e=310;RTE.RteUtility.classMustExist("SP.UI.ModalDialog");RTE.RteUtility.classMustExist("SP.Utilities.Utility");var a=new SP.UI.DialogOptions;a.args=b;var f=SP.Utilities.Utility.getLayoutsPageUrl("morecolors.aspx");a.url=f;a.title=d;a.dialogReturnValueCallback=c;a.autoSizeStartWidth=e;a.autoSize=true;SP.UI.ModalDialog.showModalDialog(a)};RTE.RichTextEditor.selectAll=function(){ULSNVe:;RTE.Cursor.get_range().selectAll();RTE.Cursor.update()};RTE.RichTextEditor.setLanguage=function(a){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.FontCommands.$LE(a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.$1c=function(d,e){ULSNVe:;var a=RTE.Cursor.get_range();if(a.isValid()){var b=a.getCurrentStateNode();if(b){var c=RTE.RteUtility.$1c(b);return c[d]}}return e};RTE.RichTextEditor.setColorCustom=function(){ULSNVe:;var a=RTE.RichTextEditor.$1c("color","#000000"),b=SP.Res.customColorTitle;RTE.RichTextEditor.showCustomColorDialog(b,a,RTE.RichTextEditor.$L8)};RTE.RichTextEditor.$L8=function(a,b){ULSNVe:;a===1&&RTE.RichTextEditor.$5W(false,b,false)};RTE.RichTextEditor.setBackgroundColorCustom=function(){ULSNVe:;var a=RTE.RichTextEditor.$1c("backgroundColor","#FFFFFF"),b=SP.Res.customBackgroundColorTitle;RTE.RichTextEditor.showCustomColorDialog(b,a,RTE.RichTextEditor.$L7)};RTE.RichTextEditor.$L7=function(a,b){ULSNVe:;a===1&&RTE.RichTextEditor.$5W(true,b,false)};RTE.RichTextEditor.setBackgroundColorCssClass=function(a){ULSNVe:;RTE.RichTextEditor.$5W(true,a,true)};RTE.RichTextEditor.setColorCssClass=function(a){ULSNVe:;RTE.RichTextEditor.$5W(false,a,true)};RTE.RichTextEditor.$5W=function(c,a,b){ULSNVe:;if(c)RTE.FontCommands.$L6(a,b);else RTE.FontCommands.$5W(a,b)};RTE.RichTextEditor.setDirection=function(a){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.ParagraphCommands.setDirection(a);RTE.Canvas.$O();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.setFontFamilyCssClass=function(a){ULSNVe:;RTE.RichTextEditor.setFontFamily(a,true)};RTE.RichTextEditor.setFontFamilyStyleValue=function(a){ULSNVe:;RTE.RichTextEditor.setFontFamily(a,false)};RTE.RichTextEditor.setFontFamily=function(a,b){ULSNVe:;RTE.FontCommands.$LA(a,b)};RTE.RichTextEditor.setFontSizeCssClass=function(a){ULSNVe:;RTE.RichTextEditor.$9r(a,true)};RTE.RichTextEditor.setFontSizeStyleValue=function(b){ULSNVe:;var a=RTE.RteUtility.parseUnitValue(b);if(!a)return;if(RTE.SU.$2(a.unit))a.unit=RTE.FontCommands.$8v;var c=""+a.value+a.unit;RTE.RichTextEditor.$9r(c,false)};RTE.RichTextEditor.$9r=function(a,b){ULSNVe:;RTE.FontCommands.$9r(a,b)};RTE.RichTextEditor.setTableWidth=function(a){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.setTableWidth(a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.setTableHeight=function(a){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.setTableHeight(a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.setTableColumnWidth=function(a){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.setTableColumnWidth(a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.setTableRowHeight=function(a){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.setTableRowHeight(a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.setTableStyle=function(b,a){ULSNVe:;if(a||RTE.SU.$1R(a)){var c=RTE.Cursor.getSelectedTable();RTE.TableCommands.setTableStyle(c,b,true)}else RTE.RichTextEditor.clearTableStyle()};RTE.RichTextEditor.setTableSummary=function(a){ULSNVe:;RTE.SnapshotManager.takeSnapshot();var b=RTE.CanvasEvents.getNodeFromEvent("Table");b.setAttribute("summary",a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.queryTableSummary=function(){ULSNVe:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Table");if(!b)return a;a.$C_0=true;var c=RTE.RteUtility.getAttribute(b,"summary");a.$D_0=RTE.SU.$7(c)?"":c;return a};RTE.RichTextEditor.setTableFirstColumn=function(a){ULSNVe:;RTE.SnapshotManager.takeSnapshot();var b=RTE.CanvasEvents.getNodeFromEvent("Table");RTE.TableCommands.setFirstColumn(b,a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.setTableLastColumn=function(a){ULSNVe:;RTE.SnapshotManager.takeSnapshot();var b=RTE.CanvasEvents.getNodeFromEvent("Table");RTE.TableCommands.setLastColumn(b,a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.setTableHeaderRow=function(a){ULSNVe:;RTE.SnapshotManager.takeSnapshot();var b=RTE.CanvasEvents.getNodeFromEvent("Table");RTE.TableCommands.setHeaderRow(b,a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.setTableFooterRow=function(a){ULSNVe:;RTE.SnapshotManager.takeSnapshot();var b=RTE.CanvasEvents.getNodeFromEvent("Table");RTE.TableCommands.setFooterRow(b,a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.clearTableStyle=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.clearTableStyle();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.setTableGridLines=function(a){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.setTableGridLines(a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.setLinkUrl=function(b){ULSNVe:;var a=RTE.CanvasEvents.getNodeFromEvent("Link");if(!a)return;RTE.SnapshotManager.takeSnapshot();RTE.SnapshotManager.setCurrentRegionDirtyIf(a.href!==b);a.href=b;RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.queryLinkUrl=function(){ULSNVe:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Link");if(!b)return a;a.$C_0=true;var c=RTE.RteUtility.getAttribute(b,"href");a.$D_0=RTE.RteUtility.$7D(c);return a};RTE.RichTextEditor.setLinkOpenInNewWindow=function(c){ULSNVe:;var a=RTE.CanvasEvents.getNodeFromEvent("Link");if(!a)return;RTE.SnapshotManager.takeSnapshot();var b=RTE.RteUtility.getAttribute(a,"target");if(c){a.setAttribute("target","_blank");RTE.SnapshotManager.setCurrentRegionDirtyIf(!b||b.toLowerCase()!=="_blank")}else{a.removeAttribute("target");RTE.SnapshotManager.setCurrentRegionDirtyIf(!RTE.SU.$2(b))}RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.queryLinkOpenInNewWindow=function(){ULSNVe:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Link");if(!b)return a;a.$C_0=true;var c=RTE.RteUtility.getAttribute(b,"target");if(c&&c.toLowerCase()==="_blank")a.$1I_0=true;else a.$1I_0=false;return a};RTE.RichTextEditor.setLinkTitle=function(b){ULSNVe:;var a=RTE.CanvasEvents.getNodeFromEvent("Link");if(!a)return;RTE.SnapshotManager.takeSnapshot();RTE.SnapshotManager.setCurrentRegionDirtyIf(a.title!==b);a.title=b;RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.queryLinkTitle=function(){ULSNVe:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Link");if(!b)return a;a.$C_0=true;a.$D_0=b.title;return a};RTE.RichTextEditor.removeLink=function(){ULSNVe:;var a=RTE.CanvasEvents.getNodeFromEvent("Link");if(!a)return;RTE.SnapshotManager.takeSnapshot();RTE.RichTextEditor.setLinkDisplayIcon(false);if(RTE.Canvas.isEditable(a)){if(RTE.Canvas.isEditable(a.parentNode))RTE.RteUtility.removeNodeAndKeepChildNodes(a);else{RTE.RteUtility.removeChildNodes(a);a.href="";a.title="";RTE.Cursor.get_range().clear()}RTE.Cursor.update()}RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.getAssetIcon=function(d){ULSNVe:;for(var c=null,a=0;a<d.childNodes.length;a++){var b=d.childNodes[a];if(b.tagName==="IMG"&&Sys.UI.DomElement.containsCssClass(b,"ms-asset-icon"))c=b}return c};RTE.RichTextEditor.queryLinkDisplayIcon=function(){ULSNVe:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Link");if(b){a.$C_0=true;var c=RTE.RichTextEditor.getAssetIcon(b);if(c)a.$1I_0=true;else a.$1I_0=false}return a};RTE.RichTextEditor.setLinkDisplayIcon=function(e){ULSNVe:;RTE.SnapshotManager.takeSnapshot();var b=RTE.CanvasEvents.getNodeFromEvent("Link");if(!b)return;var a=RTE.RichTextEditor.getAssetIcon(b);if(e){if(!a){a=document.createElement("IMG");a.className="ms-asset-icon ms-rtePosition-4";a.alt="";a.src="/_layouts/images/icgen.gif";b.insertBefore(a,b.firstChild)}var f=RTE.RteUtility.getAttribute(b,"href");if(RTE.RteUtility.isClassAvailable("SP.ClientContext")&&RTE.RteUtility.isClassAvailable("SP.Utilities.IconSize")){var c=SP.ClientContext.get_current(),g=c.get_web(),d=g.mapToIcon(f,"",0);c.executeQueryAsync(function(){ULSNVe:;RTE.RichTextEditor.$EF(a,d.get_value())},function(c,b){ULSNVe:;alert(b.get_message());RTE.RichTextEditor.$EF(a,d.get_value())})}}else a&&b.removeChild(a);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.$EF=function(c,a){ULSNVe:;var b=!RTE.SU.$2(a)&&a!=="0"?"/_layouts/images/"+a:"/_layouts/images/icgen.gif";RTE.SnapshotManager.setCurrentRegionDirtyIf(b!==c.src);c.src=b};RTE.RichTextEditor.setImageSrc=function(b){ULSNVe:;var a=RTE.CanvasEvents.getNodeFromEvent("Image");if(!a)return;RTE.SnapshotManager.takeSnapshot();RTE.SnapshotManager.setCurrentRegionDirtyIf(a.src!==b);a.src=b;RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.queryImageSrc=function(){ULSNVe:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Image");if(!b)return a;a.$C_0=true;var c=b.src;a.$D_0=RTE.RteUtility.$7D(c);return a};RTE.RichTextEditor.setImageAlt=function(b){ULSNVe:;var a=RTE.CanvasEvents.getNodeFromEvent("Image");if(!a)return;RTE.SnapshotManager.takeSnapshot();RTE.SnapshotManager.setCurrentRegionDirtyIf(a.alt!==b);a.alt=b;RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.queryImageAlt=function(){ULSNVe:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Image");if(!b)return a;a.$C_0=true;a.$D_0=b.alt;return a};RTE.RichTextEditor.setImageHeight=function(d,j){ULSNVe:;var a=RTE.CanvasEvents.getNodeFromEvent("Image");if(!a)return;if(!RTE.RichTextEditor.$5s())return;RTE.SnapshotManager.takeSnapshot();var e=!RTE.RichTextEditor.isRatioLocked(a),b=d+j;RTE.SnapshotManager.setCurrentRegionDirtyIf(a.style.height!==b);if(!e){var f=a.height,g=a.width,h=!RTE.SU.$2(a.style.height);a.style.height=b;var i=a.height,c=Math.round(i*g/f);if(!isNaN(c)){a.style.width=c.toString()+"px";if(!h)a.style.height=""}RTE.CanvasEvents.waitAndSetImageSize()}else a.style.height=b;RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.queryImageHeight=function(){ULSNVe:;var b=new RTE.CommandState,c=RTE.CanvasEvents.getNodeFromEvent("Image");if(!c)return b;b.$C_0=true;var a=c.style.height;if(RTE.SU.$2(a))a=RTE.RteUtility.getAttribute(c,"height");if(RTE.SU.$2(a)||!RTE.RteUtility.$3C(RTE.RichTextEditor.$A4,a))a=c.height.toString()+"px";b.$D_0=a;return b};RTE.RichTextEditor.setImageWidth=function(d,i){ULSNVe:;var a=RTE.CanvasEvents.getNodeFromEvent("Image");if(!a)return;if(!RTE.RichTextEditor.$5s())return;RTE.SnapshotManager.takeSnapshot();var e=!RTE.RichTextEditor.isRatioLocked(a),b=d+i;RTE.SnapshotManager.setCurrentRegionDirtyIf(a.style.height!==b);if(!e){var f=a.height,g=a.width;a.style.width=b;var h=a.width,c=Math.round(h*f/g);if(!isNaN(c))a.style.height=c.toString()+"px";RTE.CanvasEvents.waitAndSetImageSize()}else a.style.width=b;RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.$5s=function(){ULSNVe:;return RTE.Canvas.getCachedRestriction(RTE.Canvas.currentEditableRegion(),"AllowImageResize",true)};RTE.RichTextEditor.queryImageWidth=function(){ULSNVe:;var b=new RTE.CommandState,c=RTE.CanvasEvents.getNodeFromEvent("Image");if(!c)return b;b.$C_0=true;var a=c.style.width;if(RTE.SU.$2(a))a=RTE.RteUtility.getAttribute(c,"width");if(RTE.SU.$2(a)||!RTE.RteUtility.$3C(RTE.RichTextEditor.$A4,a))a=c.width.toString()+"px";b.$D_0=a;return b};RTE.RichTextEditor.setImageLockRatio=function(b){ULSNVe:;var a=RTE.CanvasEvents.getNodeFromEvent("Image");if(!a)return;a.setAttribute("unlockratio",!b)};RTE.RichTextEditor.queryImageLockRatio=function(){ULSNVe:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Image");if(!b)return a;a.$C_0=true;a.$1I_0=RTE.RichTextEditor.isRatioLocked(b);return a};RTE.RichTextEditor.isRatioLocked=function(b){ULSNVe:;var a=RTE.RteUtility.getAttribute(b,"unlockratio");return a==="false"?true:a==="true"?false:!a};RTE.RichTextEditor.setImagePosition=function(a,b){ULSNVe:;RTE.RichTextEditor.$EG(a,RTE.RichTextEditor.$5Q,b)};RTE.RichTextEditor.setImageStyle=function(a,b){ULSNVe:;RTE.RichTextEditor.$EG(a,RTE.RichTextEditor.$38,b)};RTE.RichTextEditor.$EG=function(g,c,h){ULSNVe:;if(!RTE.SU.$2(g)){var b=RTE.Canvas.getCurrentStyleSheetPrefix(),a=RTE.Cursor.getSelectedImage(),d=RTE.Canvas.getEditableRegion(a);if(h||RTE.SU.$1R(h)){var e=b+c+"-"+g;a.style.styleFloat="";a.style.textAlign="";RTE.RteUtility.$25(a,e,[b+c]);if(RTE.Canvas.getCachedRestriction(d,"UseInlineStyle",false)){var f=RTE.RteUtility.$1c(a);a.style.styleFloat=f.styleFloat;a.style.verticalAlign=f.verticalAlign;RTE.RteUtility.$9T(a,[b+c,e])}}else if(!RTE.Canvas.getCachedRestriction(d,"UseInlineStyle",false))RTE.RteUtility.$25(a,"",[b+RTE.RichTextEditor.$38]);else{RTE.RteUtility.$9T(a,[b+c]);a.style.styleFloat="";a.style.verticalAlign=""}}};RTE.RichTextEditor.clearImageStyle=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();var a=RTE.CanvasEvents.getNodeFromEvent("Image"),b=RTE.Canvas.getCurrentStyleSheetPrefix();RTE.RteUtility.$25(a,"",[b+RTE.RichTextEditor.$38]);RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.splitVertical=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.splitVertical();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.splitHorizontal=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.TableCommands.splitHorizontal();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.showInsertTableDialog=function(){ULSNVe:;RTE.TableCommands.showInsertTableDialog()};RTE.RichTextEditor.paste=function(a){ULSNVe:;RTE.Cursor.paste(a)};RTE.RichTextEditor.strikeThrough=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.FontCommands.$LT();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.subscript=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.FontCommands.$LV();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.superscript=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.FontCommands.$LW();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.redo=function(){ULSNVe:;RTE.SnapshotManager.redo()};RTE.RichTextEditor.underline=function(){ULSNVe:;RTE.SnapshotManager.takeSnapshot();RTE.FontCommands.$La();RTE.SnapshotManager.takeSnapshot()};RTE.RichTextEditor.undo=function(){ULSNVe:;RTE.SnapshotManager.undo()};RTE.RichTextEditor.transferContentsToInputField=function(c,a){ULSNVe:;if(arguments.length===1)a=false;var b=$get(c);if(!b)return;RTE.RichTextEditor.transferContentsToInputFieldNode(b,a)};RTE.RichTextEditor.transferContentsToInputFieldNode=function(a,b){ULSNVe:;if(arguments.length===1)b=false;var c=RTE.RteUtility.getAttribute(a,"InputFieldId");if(!c)return;var d={};d.editableRegion=a;RTE.CanvasEvents.dispatchEvent("Transfer",null,d);RTE.SelectionManager.$7C();RTE.TableCommands.setTableGridLines(false);RTE.PreviewManager.get_instance().endPreview();var e=b&&RTE.Canvas.$1D&&RTE.RteUtility.$b(RTE.Cursor.get_range().$3_0,a,null)&&RTE.RteUtility.$b(RTE.Cursor.get_range().$4_0,a,null),f=$get(c);if(f){var i=RTE.Canvas.getEditableRegionHtml(a,e);RTE.RteUtility.setInputValue(f,i)}var g=$get("ms-rtefocuselementid");if(g&&e)g.value=a.id;var h=$get("ms-rtedirtybit");if(h)h.value=RTE.DirtyBitManager.isDirty()?"1":"0"};RTE.RichTextEditor.getNotAvailableStyleGalleryButtonHtml=function(){ULSNVe:;return RTE.RteRibbonBuilder.$Bv()};RTE.WebPartCommands=function(){};RTE.WebPartCommands.insertWebPart=function(d){ULSNVe:;var e=RTE.Canvas.currentEditableRegion();if(!RTE.Canvas.getCachedRestriction(e,"AllowWebParts",false))return;var a=window.WPAdder;if(!a){window.LoadWPAdderOnDemand();return}a=window.WPAdder;var b=RTE.WebPartCommands.$IS(a,d);if(a){var c=true;if(b){var f=b;a.selectCategoryByTitle(f);c=false}a._showCategoryColumn(c);a.show()}};RTE.WebPartCommands.$IS=function(c,d){ULSNVe:;var a=null;if(c){var b=c._ribbonMap;if(b)a=b[d]}return a};RTE.WebPartCommands.insertNewList=function(){ULSNVe:;RTE.RteUtility.classMustExist("SP.UI.ModalDialog");RTE.RteUtility.classMustExist("SP.Utilities.Utility");var c=RTE.Canvas.currentEditableRegion();if(!RTE.Canvas.getCachedRestriction(c,"AllowWebParts",false))return;var a=new SP.UI.DialogOptions,b=SP.Utilities.Utility.getLayoutsPageUrl("CreateListPickerPage.aspx");b=b+"?UseDivDialog=true&seed="+Math.random().toString();a.url=b;a.width=780;var d=RTE.Cursor.get_range();a.dialogReturnValueCallback=function(c,e){ULSNVe:;if(c===1){var a=window.WPAdder,b=a._createWebpartPlaceholderInRte(d);if(!RTE.SU.$2(b)){RTE.RteUtility.isClassAvailable("SP.UI.ModalDialog")&&SP.UI.ModalDialog.showWaitScreenWithNoClose(SP.Res.dialogLoading15);var f=e;a.addItemToPageByItemIdAndZoneId(f,"wpz",0,b)}}};SP.UI.ModalDialog.showModalDialog(a)};RTE.RichTextEditorComponent=function(){ULSNVe:;RTE.RichTextEditorComponent.initializeBase(this)};RTE.RichTextEditorComponent.get_instance=function(){ULSNVe:;if(!RTE.RichTextEditorComponent.$W)RTE.RichTextEditorComponent.$W=new RTE.RichTextEditorComponent;return RTE.RichTextEditorComponent.$W};RTE.RichTextEditorComponent.$Eb=function(){ULSNVe:;if(RTE.RichTextEditorComponentProvider.$2N&&RTE.RichTextEditorComponentProvider.$2N===RTE.RichTextEditorComponentProvider.$4G)return;var a=RTE.RichTextEditorComponent.$4s();if(a){RTE.RichTextEditorComponentProvider.$2N&&a.removePageComponent(RTE.RichTextEditorComponent.get_instance());RTE.RichTextEditorComponentProvider.$2N=RTE.RichTextEditorComponentProvider.$4G;a.addPageComponent(RTE.RichTextEditorComponent.get_instance());a.get_focusManager().requestFocusForComponent(RTE.RichTextEditorComponent.get_instance())}};RTE.RichTextEditorComponent.$4s=function(){ULSNVe:;var a=null;if(window.SP&&window.SP.Ribbon)a=window.SP.Ribbon.PageManager.get_instance();return a};RTE.RichTextEditorComponent.prototype={init:function(){},getFocusedCommands:function(){ULSNVe:;return RTE.RichTextEditorComponentProvider.get_$2k().getFocusedCommands()},getGlobalCommands:function(){ULSNVe:;return RTE.RichTextEditorComponentProvider.get_$2k().getGlobalCommands()},canHandleCommand:function(a){ULSNVe:;return RTE.RichTextEditorComponentProvider.get_$2k().canHandleCommand(a)},handleCommand:function(a,c,d){ULSNVe:;RTE.RteUtility.assertNotNull("commandId",a);var b=RTE.RichTextEditorComponentProvider.get_$2k().handleCommand(a,c,d);return b},isFocusable:function(){ULSNVe:;return RTE.RichTextEditorComponentProvider.get_$2k().isFocusable()},receiveFocus:function(){ULSNVe:;return RTE.RichTextEditorComponentProvider.get_$2k().receiveFocus()},yieldFocus:function(){ULSNVe:;return RTE.RichTextEditorComponentProvider.get_$2k().yieldFocus()},getId:function(){ULSNVe:;return"RichTextEditorComponent"}};RTE.RichTextEditorComponentProvider=function(){};RTE.RichTextEditorComponentProvider.get_$2k=function(){ULSNVe:;if(!RTE.RichTextEditorComponentProvider.$2N){RTE.RichTextEditorComponentProvider.$2N=new RTE.SPRichTextEditorComponentProvider;RTE.RichTextEditorComponentProvider.$2N.init(null)}return RTE.RichTextEditorComponentProvider.$2N};RTE.RichTextEditorComponentProvider.get_latestProvider=function(){ULSNVe:;return!RTE.RichTextEditorComponentProvider.$4G?RTE.RichTextEditorComponentProvider.get_$2k():RTE.RichTextEditorComponentProvider.$4G};RTE.RichTextEditorComponentProvider.register=function(a){ULSNVe:;if(!a)return;a.init(RTE.RichTextEditorComponentProvider.get_latestProvider());RTE.RichTextEditorComponentProvider.$4G=a;RTE.Imports.ExecuteOrDelayUntilScriptLoaded(RTE.RichTextEditorComponent.$Eb,"sp.ribbon.js")};RTE.RichTextEditorComponentProvider.prototype={init:function(){},getFocusedCommands:function(){ULSNVe:;return null},getGlobalCommands:function(){ULSNVe:;return null},canHandleCommand:function(){ULSNVe:;return false},handleCommand:function(){ULSNVe:;return false},isFocusable:function(){ULSNVe:;return true},receiveFocus:function(){ULSNVe:;return true},yieldFocus:function(){ULSNVe:;return true}};RTE.RteHtmlPasteSteward=function(a){ULSNVe:;this.$7h_1=RTE.Canvas.getCurrentStyleSheetPrefix();this.$AN_1=new RegExp("(\u201c|\u201d)","g");this.$AO_1=new RegExp("(\u2018|\u2019)","g");RTE.RteHtmlPasteSteward.initializeBase(this,[a.ownerDocument]);this.$A9_1=a;this.$5q_1=this.get_defaultFormatting();RTE.RteHtmlPasteSteward.$18[RTE.RteHtmlPasteSteward.$1X(2)]="disc";RTE.RteHtmlPasteSteward.$18[RTE.RteHtmlPasteSteward.$1X(6)]="decimal";RTE.RteHtmlPasteSteward.$18[RTE.RteHtmlPasteSteward.$1X(0)]="";RTE.RteHtmlPasteSteward.$18[RTE.RteHtmlPasteSteward.$1X(1)]="none";RTE.RteHtmlPasteSteward.$18[RTE.RteHtmlPasteSteward.$1X(3)]="disc";RTE.RteHtmlPasteSteward.$18[RTE.RteHtmlPasteSteward.$1X(4)]="circle";RTE.RteHtmlPasteSteward.$18[RTE.RteHtmlPasteSteward.$1X(5)]="square";RTE.RteHtmlPasteSteward.$18[RTE.RteHtmlPasteSteward.$1X(7)]="decimal";RTE.RteHtmlPasteSteward.$18[RTE.RteHtmlPasteSteward.$1X(10)]="upper-alpha";RTE.RteHtmlPasteSteward.$18[RTE.RteHtmlPasteSteward.$1X(8)]="lower-alpha";RTE.RteHtmlPasteSteward.$18[RTE.RteHtmlPasteSteward.$1X(11)]="upper-roman";RTE.RteHtmlPasteSteward.$18[RTE.RteHtmlPasteSteward.$1X(9)]="lower-roman"};RTE.RteHtmlPasteSteward.$1X=function(a){ULSNVe:;return RTE.HtmlImport.ListStyleType.toString(a)};RTE.RteHtmlPasteSteward.prototype={$5q_1:null,$A9_1:null,$Em_1:false,$B1_1:true,$2t_1:function(){ULSNVe:;RTE.PasteCommon.Debug.assertString(!!this.generatedHtmlLocation.parentNode,"There's no parent DOMElement to move to!");var a=this.generatedHtmlLocation.firstChild;if(a&&a===this.generatedHtmlLocation.lastChild)a.nodeType===1&&a.tagName==="P"&&RTE.RteUtility.removeNodeAndKeepChildNodes(a);this.generatedHtmlLocation=this.generatedHtmlLocation.parentNode},reset:function(){ULSNVe:;this.generatedHtmlLocation=this.$A9_1},get_defaultFormatting:function(){ULSNVe:;return new RTE.RteHtmlPasteSteward.FormattingSteward(this.ownerDocument)},onText:function(a){ULSNVe:;if(RTE.SU.$2(a))return;if(this.$B1_1){a=a.replace(this.$AN_1,'"');a=a.replace(this.$AO_1,"'")}var b=this.$5q_1.$LU_0(this.ownerDocument.createTextNode(a));this.generatedHtmlLocation.appendChild(b)},onLineBreak:function(){ULSNVe:;this.generatedHtmlLocation.appendChild(this.ownerDocument.createElement("BR"))},onImage:function(b){ULSNVe:;if(RTE.SU.$2(b.src)){this.$Em_1=true;return}var a=this.ownerDocument.createElement("IMG");a.src=b.src;a.alt=b.alt;if(b.width)a.style.width=b.width+"px";Sys.UI.DomElement.addCssClass(a,"ms-rte-paste-setimagesize");this.generatedHtmlLocation.appendChild(a)},onFormattingChange:function(a){ULSNVe:;this.$5q_1=a},onAnchorStart:function(b){ULSNVe:;var a=this.ownerDocument.createElement("A");a.href=b;this.generatedHtmlLocation.appendChild(a);this.generatedHtmlLocation=a},onAnchorEnd:function(){ULSNVe:;RTE.PasteCommon.Debug.assertString(RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName)==="A","Expected Tag:  A\nActual Tag:  "+RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName));this.$2t_1()},onParagraphStart:function(){ULSNVe:;var a=this.$5q_1.$Hy_0();this.generatedHtmlLocation.appendChild(a);this.generatedHtmlLocation=a},onParagraphEnd:function(){ULSNVe:;RTE.PasteCommon.Debug.assertString(RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName)==="P"||this.generatedHtmlLocation.tagName.length===2&&!RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName).indexOf("H"),"Expected Tag:  P or H_\nActual Tag:  "+RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName));this.$2t_1()},onListStart:function(a){ULSNVe:;var c=RTE.HtmlImport.ListStyleType.toString(a.get_listStyleType()),b=this.ownerDocument.createElement(a.get_isListNumbered()?"OL":"UL");if(a.get_isListStyleSpecified())b.style.listStyleType=RTE.RteHtmlPasteSteward.$18[c];if(a.get_isListNumbered()&&!a.$2W_0)b.start=a.$3a_0;this.generatedHtmlLocation.appendChild(b);this.generatedHtmlLocation=b},onListEnd:function(){ULSNVe:;RTE.PasteCommon.Debug.assertString(RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName)==="UL"||RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName)==="OL","Expected Tag:  UL or OL\nActual Tag:  "+RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName));this.$2t_1()},onListItemStart:function(a){ULSNVe:;var b=this.ownerDocument.createElement("LI");if(a.get_isListItemStyleSpecified())b.style.listStyleType=RTE.RteHtmlPasteSteward.$18[RTE.HtmlImport.ListStyleType.toString(a.get_listStyleType())];if(a.get_isListNumbered()&&!a.$2W_0)b.value=a.get_currentNumber();this.generatedHtmlLocation.appendChild(b);this.generatedHtmlLocation=b},onListItemEnd:function(){ULSNVe:;RTE.PasteCommon.Debug.assertString(RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName)==="LI","Expected Tag:  LI\nActual Tag:  "+RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName));this.$2t_1()},onTableStart:function(){ULSNVe:;var a=this.ownerDocument.createElement("TABLE");a.setAttribute("cellspacing","0");a.setAttribute("width","100%");a.className=this.$7h_1+"Table-default";if(RTE.Canvas.setTableWidths)a.className+=" ms-rte-paste-settablesizes";this.generatedHtmlLocation.appendChild(a);var b=this.ownerDocument.createElement("TBODY");a.appendChild(b);this.generatedHtmlLocation=b},onTableEnd:function(){ULSNVe:;RTE.PasteCommon.Debug.assertString(RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName)==="TBODY","Expected Tag:  TBODY\nActual Tag:  "+RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName));this.$2t_1();this.$2t_1()},onTableRowStart:function(){ULSNVe:;var a=this.ownerDocument.createElement("TR");this.generatedHtmlLocation.appendChild(a);this.generatedHtmlLocation=a},onTableRowEnd:function(){ULSNVe:;RTE.PasteCommon.Debug.assertString(RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName)==="TR","Expected Tag:  TR\nActual Tag:  "+RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName));this.$2t_1()},onTableCellStart:function(){ULSNVe:;var a=this.ownerDocument.createElement("TD");a.className=this.$7h_1+"Table-default";this.generatedHtmlLocation.appendChild(a);this.generatedHtmlLocation=a},onTableCellEnd:function(){ULSNVe:;RTE.PasteCommon.Debug.assertString(RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName)==="TD","Expected Tag:  TD\nActual Tag:  "+RTE.PasteCommon.StringUtils.toUpper(this.generatedHtmlLocation.tagName));!this.generatedHtmlLocation.firstChild&&RTE.RteUtility.$3A(this.generatedHtmlLocation);this.$2t_1()},onTablePartStart:function(){ULSNVe:;RTE.PasteCommon.Debug.assertNotReachedString("Table Parts Not Used!")},onTablePartEnd:function(){ULSNVe:;RTE.PasteCommon.Debug.assertNotReachedString("Table Parts Not Used!")},$DX_1:function(a){ULSNVe:;this.generatedHtmlLocation.appendChild(a.cloneNode(true))}};RTE.RteHtmlPasteSteward.FormattingSteward=function(b,a){ULSNVe:;this.$A6_0=b;if(a){this.$T_0=a.$T_0.cloneNode(true);this.$2X_0=a.$2X_0.cloneNode(false);this.$2V_0=a.$2V_0;this.$1q_0=a.$1q_0}else{this.$T_0=b.createElement("SPAN");this.$2X_0=b.createElement("P");this.$2V_0=0;this.$1q_0=16}};RTE.RteHtmlPasteSteward.FormattingSteward.$3l=function(c,d,a){ULSNVe:;var b=null;while(a&&a.tagName!==d){b=a;a=a.firstChild}if(c&&!a&&b)b.appendChild(b.ownerDocument.createElement(d));else!c&&a&&RTE.RteUtility.removeNodeAndKeepChildNodes(a)};RTE.RteHtmlPasteSteward.FormattingSteward.prototype={$A6_0:null,$T_0:null,$2X_0:null,$2V_0:0,$1q_0:0,setLang:function(a){ULSNVe:;this.$T_0.lang=a;return true},setTextDir:function(a){ULSNVe:;this.$T_0.dir=a;return true},setBold:function(a){ULSNVe:;RTE.RteHtmlPasteSteward.FormattingSteward.$3l(a,"STRONG",this.$T_0);return true},setItalics:function(a){ULSNVe:;RTE.RteHtmlPasteSteward.FormattingSteward.$3l(a,"EM",this.$T_0);return true},setUnderline:function(b){ULSNVe:;if(RTE.RteUtility.isInternetExplorer())this.$T_0.style.textDecorationUnderline=b;else if(b){var a=this.$T_0.style.textDecoration;if(a.toLowerCase().indexOf("underline")<0)this.$T_0.style.textDecoration=a+" underline"}return true},setStrikethrough:function(b){ULSNVe:;if(RTE.RteUtility.isInternetExplorer())this.$T_0.style.textDecorationLineThrough=b;else if(b){var a=this.$T_0.style.textDecoration;if(a.toLowerCase().indexOf("line-through")<0)this.$T_0.style.textDecoration=a+" line-through"}return true},setSubscript:function(a){ULSNVe:;RTE.RteHtmlPasteSteward.FormattingSteward.$3l(a,"SUB",this.$T_0);RTE.RteHtmlPasteSteward.FormattingSteward.$3l(!a,"SUP",this.$T_0);return true},setSuperscript:function(a){ULSNVe:;RTE.RteHtmlPasteSteward.FormattingSteward.$3l(a,"SUP",this.$T_0);RTE.RteHtmlPasteSteward.FormattingSteward.$3l(!a,"SUB",this.$T_0);return true},setFontsize:function(b){ULSNVe:;if(RTE.SU.$2(b))return false;var a=RTE.RteUtility.parseUnitValue(b);if(a&&a.unit.toLowerCase()==="px")this.$1q_0=a.value;return true},setFontface:function(a){ULSNVe:;return RTE.SU.$2(a)?false:true},growFontsize:function(){ULSNVe:;this.$1q_0=this.$1q_0+4;return true},shrinkFontsize:function(){ULSNVe:;if(this.$1q_0-4>4)this.$1q_0=this.$1q_0-4;else this.$1q_0=4;return true},setFontColor:function(a){ULSNVe:;return RTE.SU.$2(a)?false:true},setFontHighlight:function(a){ULSNVe:;return RTE.SU.$7(a)?false:true},setHeading:function(a){ULSNVe:;if(a<1||6<a)return false;this.$2V_0=a;return true},setTextAlign:function(a){ULSNVe:;if(a==="left"||a==="center"||a==="right"||a==="justify"){this.$2X_0.style.textAlign=a;return true}return false},clearFormatting:function(){ULSNVe:;this.$T_0.removeAttribute("style");this.$T_0.firstChild&&this.$T_0.removeChild(this.$T_0.firstChild);this.$2X_0.removeAttribute("style");return true},clone:function(){ULSNVe:;return new RTE.RteHtmlPasteSteward.FormattingSteward(this.$A6_0,this)},$LU_0:function(c){ULSNVe:;var d=!RTE.SU.$2(this.$T_0.style.cssText);if(d||this.$T_0.firstChild){var b=this.$T_0.cloneNode(true),a=b;while(a.firstChild)a=a.firstChild;a.appendChild(c);c=d?b:b.firstChild}return c},$Hy_0:function(){ULSNVe:;var a;if(!this.$2V_0)a=this.$2X_0.cloneNode(false);else{RTE.PasteCommon.Debug.assert(1<=this.$2V_0&&this.$2V_0<=6);a=this.$2X_0.ownerDocument.createElement("H"+this.$2V_0);a.style.cssText=this.$2X_0.style.cssText}return a}};RTE.RteHtmlTranslator=function(a){ULSNVe:;this.$4T_2=new Array(0);RTE.RteHtmlTranslator.initializeBase(this,[a])};RTE.RteHtmlTranslator.$Ca=function(a){ULSNVe:;return a?a.nodeType===1?RTE.RteHtmlTranslator.$AP.test(a.style.marginBottom):false:true};RTE.RteHtmlTranslator.prototype={onDivOpen:function(a){ULSNVe:;return this.$Dc_2(a)?3:RTE.HtmlImport.DefaultHtmlTranslator.prototype.onDivOpen.call(this,a)},onSpanOpen:function(a){ULSNVe:;return this.$Dc_2(a)?3:2},onPOpen:function(a){ULSNVe:;var d=true,b=RTE.PasteCommon.CustomData.getObject(a,"SpecialProcessing");if(b){if(b==="IgnoreAll")return 3;if(b==="IgnoreOpen")d=false}var e=Sys.UI.DomElement.containsCssClass(a,"MsoTitle"),f=a.getAttribute("align");if(d){if(e){var g=this;this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setHeading(1)})}var h=this;this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setTextAlign(f)});this.normalizer.onParagraphStart()}var c=this;this.registerOnCloseCallback(function(){ULSNVe:;var b=RTE.RteUtility.$t(a,false),d=true;if(b&&b.nodeType===1&&b.tagName.toUpperCase()==="P"){var g=b.getAttribute("align"),h=Sys.UI.DomElement.containsCssClass(b,"MsoTitle");if(f===g&&e===h&&RTE.RteHtmlTranslator.$Ca(a))if(b.firstChild===b.lastChild&&(!b.firstChild||RTE.RteUtility.$3u(b.firstChild,true))&&RTE.RteHtmlTranslator.$Ca(b)){RTE.PasteCommon.CustomData.$4J(b,"SpecialProcessing","IgnoreAll");RTE.RteUtility.removeChildNodes(b)}else{d=false;c.normalizer.onLineBreak();RTE.PasteCommon.CustomData.$4J(b,"SpecialProcessing","IgnoreOpen")}}d&&c.normalizer.onParagraphEnd()});return 1},$Dc_2:function(b){ULSNVe:;if(this.$4T_2)for(var a=0;a<this.$4T_2.length;a++)if(Sys.UI.DomElement.containsCssClass(b,this.$4T_2[a])){this.normalizer.$DX_3(b);return true}return false}};RTE.RteHtmlNormalizer=function(a){ULSNVe:;RTE.RteHtmlNormalizer.initializeBase(this,[a])};RTE.RteHtmlNormalizer.prototype={$DX_3:function(a){ULSNVe:;RTE.RteUtility.$Q(a)&&this.ensureOutsideParagraph();this.steward.$DX_1(a)}};RTE.RteRibbonBuilder=function(){};RTE.RteRibbonBuilder.$Ad=function(e,k,f,l,g,m,n,o,p){ULSNVe:;RTE.RteUtility.classMustExist("CUI.JsonXmlElement");for(var c=new CUI.JsonXmlElement("Menu",{Id:k}),h=c.appendChild("MenuSection",{Id:f}).appendChild("Controls",{Id:f+"controls"}),a=0;a<e.length;a++){var b=e[a],i=b.rule.selectorText,j=RTE.StyleRuleUtility.$36(i,p+"-"),d=RTE.StyleRuleUtility.$2F(b,j,null);d&&h.appendChild("Button",{Id:l+a.toString(),LabelText:d,CommandType:"OptionSelection",MenuItemId:g+a.toString(),CommandValueId:b.rule.selectorText,Command:g,CommandPreview:m,CommandRevert:n,QueryCommand:o})}return c};RTE.RteRibbonBuilder.$FK=function(e,f){ULSNVe:;var b=new RTE.GalleryData,a=new Sys.StringBuilder;a.append("<Menu Id='");a.append("ms-rte-styleGalleryMenu");a.append("'>");var g=RTE.Canvas.getCurrentStyleSheetPrefix(),c=RTE.Canvas.currentEditableRegion(),h=RTE.RteUtility.$8Q(c),j=RTE.RteRibbonBuilder.$I2(c,h),i=RTE.RteRibbonBuilder.$FF(h,j),d=RTE.Canvas.getCachedRestriction(c,"UseInlineStyle",false);f&&f.length>0&&RTE.RteRibbonBuilder.$AQ(a,b,SP.Res.markupStylesMenuTitle,f,"Ribbon.EditingTools.CPEditTab.Paragraph.ElementWithStyle.Menu","Ribbon.EditingTools.CPEditTab.Paragraph.ElementWithStyle.Menu.Styles","ElementWithStyle","ElementWithStyle","ElementWithStylePreview","ElementWithStylePreviewRevert","QueryElementWithStyle",g+"Element",true,i,d);!d&&e&&e.length>0&&RTE.RteRibbonBuilder.$AQ(a,b,SP.Res.textStylesMenuTitle,e,"ms-rte-styleGalleryMenu","Ribbon.EditingTools.CPEditTab.Styles.Styles.Menu.Styles","Ribbon.EditingTools.CPEditTab.Styles.Styles.Menu.Styles.TextStyle","TextStyle","TextStylePreview","TextStylePreviewRevert","QueryTextStyle",g+"Style",false,i,d);a.append("</Menu>");b.gallery=a.toString();return b};RTE.RteRibbonBuilder.$I2=function(b,d){ULSNVe:;var a=RTE.RteUtility.$Az(d.backgroundColor,.6);while(RTE.RteRibbonBuilder.$Cr(a)&&b.parentNode){b=b.parentNode;if(RTE.RteRibbonBuilder.$Cr(a)){var c=RTE.RteUtility.$8Q(b);if(c)a=RTE.RteUtility.$Az(c.backgroundColor,.6)}}return a};RTE.RteRibbonBuilder.$Cr=function(a){ULSNVe:;return!a||!a.length||a==="transparent"||a.startsWith("rgba")};RTE.RteRibbonBuilder.$AQ=function(a,g,q,j,u,k,r,h,s,t,l,m,f,i,n){ULSNVe:;a.append("<MenuSection Id='"+k+"'");a.append(" Title='");a.append(SP.Utilities.HttpUtility.escapeXmlText(q));a.append("'>");a.append("<Gallery Id='"+k+".Gallery' ElementDimensions='SizeCustom' Width='5' Command='");a.append(h);a.append("'>");for(var c=0;c<j.length;c++){var b=j[c],o=b.rule.selectorText,p=RTE.StyleRuleUtility.$36(o,m+"-"),d=RTE.StyleRuleUtility.$2F(b,p,null);if(d&&(!n||RTE.StyleRuleUtility.$Ce(b))){a.append("<GalleryButton");a.append(" id='"+r);a.append(c.toString());a.append("' InnerHTML=\"");a.append(SP.Utilities.HttpUtility.escapeXmlText(RTE.RteRibbonBuilder.$Bh(b,i,d,false)));a.append("\" Alt='");a.append(SP.Utilities.HttpUtility.escapeXmlText(d));a.append("' CommandType='OptionSelection' MenuItemId='");a.append(h+c.toString());a.append("' CommandValueId='");a.append(RTE.StyleRuleUtility.$Ac(b,f));a.append("' Command='");a.append(h);a.append("' CommandPreview='");a.append(s);a.append("' CommandRevert='");a.append(t);a.append("' QueryCommand='");a.append(l);a.append("' />");if(g.ribbonButtons.length<5){var e=new RTE.StyleButton;e.preview=RTE.RteRibbonBuilder.$Bh(b,i,d,true);e.commandValueId=RTE.StyleRuleUtility.$Ac(b,f);e.isElementStyle=f;g.ribbonButtons[g.ribbonButtons.length]=e}}}a.append("</Gallery></MenuSection>")};RTE.RteRibbonBuilder.$Bh=function(e,i,j,k){ULSNVe:;var c=e.rule.selectorText,f=RTE.StyleRuleUtility.$2c(c),a=(RTE.StyleRuleUtility.$6I(c)||"P").toUpperCase(),d=a==="DIV"?" width: 100% !important; overflow: hidden !important;":"";if(a==="DIV"||!RTE.SU.$2(e.rule.style.padding))d+=" padding: 5px !important;";var g=SP.Utilities.HttpUtility.escapeXmlText(SP.Res.styleGalleryPreviewText),b=String.format("<{0} unselectable='on' class='{1}' style='position: static !important; margin: 0px !important;line-height: 100% !important;{2}'>{3}</{0}>",a.toLowerCase(),f,d,g),h=k?"ms-rte-styleRibbonPreview":"ms-rte-styleGalleryPreview";b=String.format("<div unselectable='on' class='ms-rte-stylePreview {0}'>\r\n                            <div unselectable='on' class='ms-rte-stylePreviewBox'>\r\n                                <div unselectable='on' class='ms-rte-stylePreviewBoxInner' style='{1}'>\r\n                                    <div unselectable='on' class='ms-rte-stylePreviewHolder'><span style='white-space:nowrap;'>{2}</span></div>\r\n                                </div>\r\n                            </div>\r\n                            <div unselectable='on' class='ms-rte-stylePreviewTitle ms-cui-ctl-mediumlabel'>{3}</div>\r\n                        </div>",h,i,b,j);return b};RTE.RteRibbonBuilder.$Bv=function(){ULSNVe:;var a=RTE.RteUtility.htmlEncode(SP.Res.styleButtonNotAvailable);return String.format("<div unselectable='on' class='ms-rte-stylePreview ms-rte-styleRibbonPreview ms-cui-disabled'>\r\n                    <div unselectable='on' class='ms-rte-stylePreviewTitleFull ms-cui-ctl-mediumlabel'>{0}</div>\r\n                  </div>",a)};RTE.RteRibbonBuilder.$FF=function(b,c){ULSNVe:;var a="";if(b){a+=RTE.RteRibbonBuilder.$5w(b,"color","color");a+=RTE.RteRibbonBuilder.$5w(b,"fontFamily","font-family");a+=RTE.RteRibbonBuilder.$5w(b,"fontSize","font-size");a+=RTE.RteRibbonBuilder.$5w(b,"fontWeight","font-weight");a+="background-color: "+RTE.RteUtility.htmlAttributeEncode(c)+";"}return a};RTE.RteRibbonBuilder.$5w=function(b,c,d){ULSNVe:;var a=b[c];return a&&a.length>0?d+":"+RTE.RteUtility.htmlAttributeEncode(a)+";":""};RTE.RteRibbonBuilder.parseRibbonStyleButtonIndex=function(a){ULSNVe:;var b=-1;if(a&&a.length>0)b=Number.parseInvariant(a.substr(a.length-1));return b};RTE.UnitValue=function(){};RTE.UnitValue.prototype={value:0,unit:null};RTE.RteUtility=function(){};RTE.RteUtility.get_nonbreakSpace=function(){ULSNVe:;return RTE.RteUtility.$3U};RTE.RteUtility.$Jh=function(a,b,g){ULSNVe:;var e=a.nodeValue,f=b.nodeValue,c=b,d=a;if(g){c=a;d=b}c.nodeValue=e+f;RTE.RteUtility.$J(d)};RTE.RteUtility.$E2=function(a){ULSNVe:;RTE.SU.$2(a.style.cssText)&&a.removeAttribute("style")};RTE.RteUtility.removeQuotes=function(a){ULSNVe:;return a.charAt(0)==='"'&&a.length>1&&a.charAt(a.length-1)==='"'?a.substring(1,a.length-1):a};RTE.RteUtility.removeNodeAndKeepChildNodes=function(a){ULSNVe:;var b=a.parentNode;if(!b)return;while(a.firstChild)b.insertBefore(a.firstChild,a);b.removeChild(a)};RTE.RteUtility.htmlEncode=function(a){ULSNVe:;a=a.replace(new RegExp("&","g"),"&amp;");a=a.replace(new RegExp('"',"g"),"&quot;");a=a.replace(new RegExp("'","g"),"&#39;");a=a.replace(new RegExp("<","g"),"&lt;");a=a.replace(new RegExp(">","g"),"&gt;");a=a.replace(new RegExp(RTE.RteUtility.$3U,"g"),"&#160;");return a};RTE.RteUtility.htmlAttributeEncode=function(a){ULSNVe:;a=a.replace(new RegExp("&","g"),"&amp;");a=a.replace(new RegExp("<","g"),"&lt;");a=a.replace(new RegExp('"',"g"),"&quot;");a=a.replace(new RegExp("'","g"),"&#39;");return a};RTE.RteUtility.urlEncode=function(a){ULSNVe:;return encodeURIComponent(a)};RTE.RteUtility.$3R=function(b,d,c){ULSNVe:;var a=b.substring(c,b.length).search(d);return a!==-1?a+c:a};RTE.RteUtility.$Dm=function(b){ULSNVe:;var a=b.previousSibling;while(a&&SP.UI.UIUtility.isTextNode(a))a=a.previousSibling;return a};RTE.RteUtility.focusNoFail=function(a){ULSNVe:;try{a.focus()}catch(b){}};RTE.RteUtility.getServerRelativeUrl=function(a){ULSNVe:;var b=a.indexOf("://");if(b<0)return a;var c=a.indexOf("/",b+3);return c>0?a.substr(c):""};RTE.RteUtility.$IA=function(b,c){ULSNVe:;var a=null,d=b.innerHTML;if(RTE.RteUtility.$8t===b)if(d===RTE.RteUtility.$8r)a=RTE.RteUtility.$4B(RTE.RteUtility.$8s,c,c);if(RTE.SU.$2(a)){var e=[],f=null;if(RTE.RteUtility.$Li())f=new RTE.Ie8TreeValidator(b);RTE.RteUtility.$8U(e,b,f);a=e.join("");RTE.RteUtility.$8s=a;RTE.RteUtility.$8r=d;RTE.RteUtility.$8t=b;a=RTE.RteUtility.$4B(a,c,c)}return a};RTE.RteUtility.$8T=function(a){ULSNVe:;while(a&&!RTE.RteUtility.$Q(a))a=a.parentNode;return a};RTE.RteUtility.$Bo=function(b,c,d){ULSNVe:;var a=RTE.RteUtility.$CU(b,c,d,true);if(a)a[a.length]=b;return a};RTE.RteUtility.$CU=function(a,d,e,f){ULSNVe:;var c=null;if(f&&a!==d){a=RTE.RteUtility.$LR(a,e);if(null===(e?RTE.RteUtility.$m(a,false):RTE.RteUtility.$t(a,false)))c=a.parentNode}var b;if(a===d)b=new Array(0);else if(a===document.body)b=null;else{b=RTE.RteUtility.$CU(a.parentNode,d,e,!!c);if(b)b[b.length]=c}return b};RTE.RteUtility.$LR=function(a,d){ULSNVe:;var b=RTE.RteUtility.$1e(a.parentNode,false),e=!d&&RTE.RteUtility.$Q(a.parentNode)&&!!b&&b.nodeType===1&&b.tagName==="BR";do{var c=d?RTE.RteUtility.$m(a,false):RTE.RteUtility.$t(a,false);if(!RTE.RteUtility.$1P(c)&&!(e&&c===b))break;a=c}while(a);return a};RTE.RteUtility.$6S=function(b,a){ULSNVe:;RTE.RteUtility.$CV(b,a.nextSibling,a.parentNode)};RTE.RteUtility.$CQ=function(b,a){ULSNVe:;RTE.RteUtility.$CV(b,a,a.parentNode)};RTE.RteUtility.$CV=function(a,c,j){ULSNVe:;if(!j||!a)return;if(!RTE.RteUtility.$Q(a)&&!RTE.RteUtility.$6L(a))if(a.nodeType!==1||!a.getElementsByTagName("DIV").length&&!a.getElementsByTagName("P").length){j.insertBefore(a,c);return}var d=j,b=new Array(0);while(!RTE.RteUtility.$Q(d)&&!RTE.Canvas.$i(d)){Array.add(b,d);d=d.parentNode}RTE.HtmlTagName.allowedElementStyleTags[d.tagName.toUpperCase()]&&Array.add(b,d);if(!b.length){j.insertBefore(a,c);return}for(var e=null,g=0;g<b.length;g++){var h=b[g],i=h.cloneNode(false);e&&i.appendChild(e);while(c){var k=c.nextSibling;!RTE.RteUtility.$6T(c)&&i.appendChild(c);c=k}if(i.firstChild)e=i;c=h.nextSibling;if(g<b.length-1)RTE.RteUtility.$8d(h)&&RTE.RteUtility.removeNodeAndKeepChildNodes(h)}var f=b[b.length-1];if(e){SP.UI.UIUtility.insertAfter(e,f);RTE.RteUtility.$Ap(e)}SP.UI.UIUtility.insertAfter(a,f);RTE.RteUtility.$8d(f)&&RTE.RteUtility.removeNodeAndKeepChildNodes(f)};RTE.RteUtility.$Ap=function(a){ULSNVe:;if(a.nodeType===1&&!RTE.RteUtility.$1P(a)){a.firstChild&&a.firstChild===a.lastChild&&RTE.RteUtility.$Ap(a.firstChild);RTE.RteUtility.$8d(a)&&RTE.RteUtility.removeNodeAndKeepChildNodes(a)}};RTE.RteUtility.$8d=function(b){ULSNVe:;for(var a=0;a<b.childNodes.length;a++)if(!RTE.RteUtility.$3y(b.childNodes[a]))return false;return true};RTE.RteUtility.$6L=function(b){ULSNVe:;if(b.nodeType===1)for(var a=0;a<b.childNodes.length;a++)if(RTE.RteUtility.$Q(b.childNodes[a]))return true;return false};RTE.RteUtility.$8Q=function(c){ULSNVe:;try{var a=c.currentStyle;if(!a){var b=document.defaultView;if(b&&b.getComputedStyle)a=b.getComputedStyle(c,null)}return a}catch(d){return null}};RTE.RteUtility.$Cn=function(b){ULSNVe:;var a=RTE.RteUtility.$8Q(b);return a?RTE.RteUtility.$8p(a.overflow)||RTE.RteUtility.$8p(a.overflowX)||RTE.RteUtility.$8p(a.overflowY):false};RTE.RteUtility.$8p=function(a){ULSNVe:;if(!RTE.SU.$2(a)){a=a.toLowerCase();return a==="auto"||a==="scroll"}return false};RTE.RteUtility.$6X=function(a,b){ULSNVe:;return!RTE.RteUtility.$1x(a,true)&&(!b||!RTE.RteUtility.$1P(a))};RTE.RteUtility.$m=function(b,c){ULSNVe:;var a=b;do a=a.previousSibling;while(a&&!RTE.RteUtility.$6X(a,c));return a};RTE.RteUtility.$Li=function(){ULSNVe:;if(!RTE.RteUtility.isInternetExplorer())return false;var a=true;if(typeof msRichTextEditorEnableIEValidator==="boolean")a=msRichTextEditorEnableIEValidator;return a};RTE.RteUtility.$t=function(b,c){ULSNVe:;var a=b;do a=a.nextSibling;while(a&&!RTE.RteUtility.$6X(a,c));return a};RTE.RteUtility.$1w=function(c,b){ULSNVe:;var a=c.firstChild;if(a&&!RTE.RteUtility.$6X(a,b))a=RTE.RteUtility.$t(a,b);return a};RTE.RteUtility.$1e=function(c,b){ULSNVe:;var a=c.lastChild;if(a&&!RTE.RteUtility.$6X(a,b))a=RTE.RteUtility.$m(a,b);return a};RTE.RteUtility.$II=function(u,a,v){ULSNVe:;var g=null;try{g=a.outerHTML}catch(F){}if(!RTE.SU.$7(g)&&RTE.RteUtility.$7a){var k=RTE.RteUtility.$6O[g];if(!RTE.SU.$7(k)){for(var x=k.length,l=0;l<x;l++){var y=k[l];u.push(y)}return false}}var h=false,b=[],d=a.className,c=a.tagName;if(c)c=c.toUpperCase();if(SP.UI.UIUtility.isTextNode(a)){var z=a.nodeValue;b.push(RTE.RteUtility.htmlEncode(z))}else if(SP.UI.UIUtility.isSvgNode(a)){var A=RTE.RteUtility.$Ig(a);b.push(A)}else if(d&&d.indexOf("ms-rtegenerate-notify")!==-1){var q=new Sys.StringBuilder,m={};m.html=q;m.node=a;RTE.CanvasEvents.dispatchEvent("ElementGenerateTag",null,m);b.push(q.toString())}else if(d&&d.indexOf("ms-rtegenerate-object")!==-1)b.push(a.getAttribute("object"));else if(c==="XML"||c==="SCRIPT"||c==="STYLE"){var B=c.toLowerCase();RTE.RteUtility.$34(b,a);b.push(a.innerHTML);RTE.RteUtility.$6E(b,B)}else if(c==="OBJECT"||c==="EMBED"){var f=[],C=c.toLowerCase();RTE.RteUtility.$34(f,a);if(!a.childNodes.length||!RTE.RteUtility.isInternetExplorer())f.push(a.innerHTML);else{RTE.RteUtility.$8U(f,a,v);f.push(a.altHtml)}RTE.RteUtility.$6E(f,C);var r=RTE.RteUtility.$Dw(f.join(""),false);b.push(r);var i=document.createElement("SPAN");i.className="ms-rtegenerate-object";i.setAttribute("object",r);i.contentEditable=false;a.parentNode.insertBefore(i,a);i.appendChild(a)}else if(!(c&&c.charAt(0)==="/")){var e=false,j=false;if(d&&d.indexOf("ms-rtegenerate-skip")!==-1)e=true;else if(d&&d.indexOf("ms-rtegenerate-allskip")!==-1){e=true;j=true}else if(RTE.RteUtility.$3t(a)){RTE.RteUtility.$Hz(b,a);j=true;e=true}else if(RTE.RteUtility.$Cb(a)){RTE.RteUtility.$Hu(b,a);j=true;e=true}else if(c.indexOf("<")>-1||RTE.SU.$2(c))e=true;if(!e){RTE.RteUtility.$34(b,a);var s=a.id;if(s&&s.indexOf("ms-rterangecursor")!==-1)h=true}if(!j){if(a.childNodes.length>0){var D=RTE.RteUtility.$8U(b,a,v);h=!!(h|D)}else RTE.RteUtility.$Hv(b,a);if((c==="DIV"||c==="P")&&a.innerText===""&&a.offsetHeight&&RTE.SU.$2(a.style.minHeight)&&RTE.SU.$2(a.style.height)&&!RTE.Canvas.$i(a)){var n=a.innerHTML;(!n||n.indexOf("<BR")===-1&&n.indexOf("<IMG")===-1)&&b.push("&#160;")}}if(!e){var E=c.toLowerCase();RTE.RteUtility.$6E(b,E)}}for(var w=b.length,p=0,o=0;o<w;o++){var t=b[o];u.push(t);p+=t.length}if(!RTE.SU.$7(g)&&!h&&RTE.RteUtility.$7a){RTE.RteUtility.$6O[g]=b;RTE.RteUtility.$6P+=p}return h};RTE.RteUtility.$Ig=function(a){ULSNVe:;if(typeof XMLSerializer!=="undefined"){var b=new XMLSerializer;return b.serializeToString(a)}return a.xml||""};RTE.RteUtility.$8U=function(j,e,b){ULSNVe:;for(var f=e.childNodes,g=f.length,c=false,h=e.uniqueID,d=0;d<g;d++){var a=f[d];if(RTE.RteUtility.isInternetExplorer())if(b&&!b.$LK_0(e,a)||!b&&a.parentNode&&a.parentNode.uniqueID!==h)continue;var i=RTE.RteUtility.$II(j,a,b);c=!!(c|i)}return c};RTE.RteUtility.$Fp=function(){ULSNVe:;if(RTE.RteUtility.$6P>1310720&&RTE.RteUtility.$6P<0)RTE.RteUtility.$6O={};if(RTE.RteUtility.$5d>1310720&&RTE.RteUtility.$5d<0){RTE.RteUtility.$7T={};RTE.RteUtility.$5d=0}window.setTimeout(RTE.RteUtility.$84,18e5)};RTE.RteUtility.$C8=function(){ULSNVe:;return!RTE.RteUtility.isFirefox()?document.body:window.self.self};RTE.RteUtility.$s=function(b,c){ULSNVe:;var a=RTE.RteUtility.$C8();$addHandler(a,b,c)};RTE.RteUtility.$BF=function(b,c){ULSNVe:;var a=RTE.RteUtility.$C8();$removeHandler(a,b,c)};RTE.RteUtility.$5h=function(a){ULSNVe:;while(a.childNodes.length>0)SP.UI.UIUtility.insertBefore(a.childNodes[0],a)};RTE.RteUtility.$4N=function(a){ULSNVe:;while(a.childNodes.length>0)SP.UI.UIUtility.insertAfter(a.childNodes[a.childNodes.length-1],a)};RTE.RteUtility.$8W=function(b){ULSNVe:;var a={};a.x=0;a.y=0;RTE.RteUtility.$IR(b,a);return a};RTE.RteUtility.$IR=function(a,b){ULSNVe:;while(a&&a!==document.documentElement){b.x+=a.offsetLeft;b.y+=a.offsetTop;a=a.offsetParent}};RTE.RteUtility.$IZ=function(b){ULSNVe:;var a={};a.x=0;a.y=0;RTE.RteUtility.$Ia(b,a);return a};RTE.RteUtility.$Ia=function(a,b){ULSNVe:;while(a&&a!==document.documentElement){b.x+=a.scrollLeft;b.y+=a.scrollTop;a=a.parentNode}};RTE.RteUtility.$IY=function(b){ULSNVe:;var a={};a.x=0;a.y=0;RTE.RteUtility.$C1(b,a);return a};RTE.RteUtility.$C1=function(a,b){ULSNVe:;if(!a)return;b.x+=a.offsetLeft-a.scrollLeft;b.y+=a.offsetTop-a.scrollTop;RTE.RteUtility.$C1(a.offsetParent,b)};RTE.RteUtility.getOffset=function(b){ULSNVe:;var a={};a.x=0;a.y=0;RTE.RteUtility.$Bw(b,a,false);return a};RTE.RteUtility.$Bw=function(a,b){ULSNVe:;var e=a.cachedOffsetSet;if(e){var f=a.cachedOffsetY,g=a.cachedOffsetX;b.y+=f;b.x+=g;return}a.parentNode&&a.offsetParent&&RTE.RteUtility.$Bw(a.offsetParent,b,true);if(!SP.UI.UIUtility.isTextNode(a)&&a.tagName.toUpperCase()==="TD"&&a.runtimeStyle){if(a.runtimeStyle.borderTopStyle!=="none"){var c=parseInt(a.runtimeStyle.borderTopWidth);if(!isNaN(c))b.y+=c}if(a.runtimeStyle.borderLeftStyle!=="none"){var d=parseInt(a.runtimeStyle.borderLeftWidth);if(!isNaN(d))b.x+=d}}b.y+=a.offsetTop;b.x+=a.offsetLeft};RTE.RteUtility.$I3=function(a){ULSNVe:;var b=null;if(document.getBoxObjectFor)b=RTE.RteUtility.$I4(a);else if(a.tagName==="SPAN"&&a.innerHTML===""&&a.parentNode.tagName!=="TEXTAREA"){var e=null,d=null,c=new RTE.DOMTreePosition(a,0);c.setLocationAtEnd();while(c.moveToNextElement())if(SP.UI.UIUtility.isNodeOfType(c.$1_0,RTE.HtmlTagName.blockElements)){var k=a.style.display;a.style.display="inline-block";b=RTE.RteUtility.getOffset(a);b.width=a.offsetWidth;b.height=a.offsetHeight;a.style.display=k;return b}else if(SP.UI.UIUtility.isTextNode(c.$1_0)&&c.$1_0.nodeValue&&c.$1_0.nodeValue.length>0){e=c.$1_0;d=e.nodeValue;var f=d.indexOf(" ");if(f===-1){a.innerText=d;e.nodeValue=""}else{a.innerText=d.substr(0,f+1);c.$1_0.nodeValue=d.substr(f+1,d.length-f-1)}for(var j=a.getClientRects(),g=-1,h=0;h<j.length;h++){var i=j[h];if(g===-1||i.left!==i.right)g=i.top}b=RTE.RteUtility.getOffset(a);b.y=g;b.width=a.offsetWidth;b.height=a.offsetHeight;a.innerText="";e.nodeValue=d;return b}}else{b=RTE.RteUtility.getOffset(a);b.width=a.offsetWidth;b.height=a.offsetHeight}return b};RTE.RteUtility.$6M=function(c,b){ULSNVe:;var a=RTE.RteUtility.getCssClassName(c);return a.endsWith(b)||a.indexOf(b+" ")!==-1};RTE.RteUtility.$I4=function(b){ULSNVe:;var a=document.getBoxObjectFor(b);return new Sys.UI.Bounds(a.x,a.y,a.width,a.height)};RTE.RteUtility.getCssClassName=function(a){ULSNVe:;return a&&a.nodeType===1&&!SP.UI.UIUtility.isSvgNode(a)&&a.className?a.className:""};RTE.RteUtility.$3t=function(a){ULSNVe:;return RTE.RteUtility.$A7[a.tagName]==="true"};RTE.RteUtility.$Cb=function(a){ULSNVe:;return a.nodeType===8};RTE.RteUtility.$Hw=function(){};RTE.RteUtility.ignoreNodeInOutput=function(a){ULSNVe:;Sys.UI.DomElement.addCssClass(a,"ms-rtegenerate-skip")};RTE.RteUtility.$Hu=function(a,b){ULSNVe:;a.push("<!--");a.push(b.nodeValue);a.push("-->")};RTE.RteUtility.$Hz=function(a,b){ULSNVe:;RTE.RteUtility.$Bi(a,b);a.push("/>")};RTE.RteUtility.$34=function(a,b){ULSNVe:;RTE.RteUtility.$Bi(a,b);a.push(">")};RTE.RteUtility.$Bi=function(s,g){ULSNVe:;var i=g.cloneNode(false),d=null;try{d=i.outerHTML}catch(t){d=null}if(RTE.SU.$7(d))try{RTE.RteUtility.$7S.appendChild(i);d=RTE.RteUtility.$7S.innerHTML;RTE.RteUtility.$7S.removeChild(i)}catch(u){d=null}var e=null;if(d)e=RTE.RteUtility.$7T[d];if(RTE.SU.$7(e)){var m=RTE.RteUtility.htmlEncode,c=[],j=g.tagName;c.push("<");c.push(j.toLowerCase());var k=g.attributes;if(k){for(var n=j==="IMG",o=false,p=k.length,l=0;l<p;l++){var h=k[l],a=h.name;a=a.toLowerCase();if(!h.specified)if(a==="name"){if(h.value==="")continue}else continue;var b=h.value;if(j==="TABLE"&&a==="class")b=b.replace("ms-rteTableGrid","");else if(a==="href"&&b.indexOf("#")){try{var q=g;b=q.href}catch(v){}b=RTE.RteUtility.$7D(b)}else if(a==="src"){try{var r=g;b=r.src}catch(w){}b=RTE.RteUtility.$7D(b)}if(b&&b!==""&&b!=="null"&&b!=="inherit"&&a!=="_events"&&a!=="style"&&a!=="uniqueID"&&a!=="setwidth"&&a!=="setheight"&&a!=="hasheight"&&a!=="complete"&&a!=="readystate"&&(a!=="disabled"||a==="disabled"&&b!=="false")&&(a!=="hidefocus"||a==="hidefocus"&&b!=="false")&&(a!=="tabindex"||a==="tabindex"&&b!=="0")&&(a!=="dir"||a==="dir"&&b!=="none")){if(n&&a==="alt")o=true;c.push(" ");c.push(a);c.push('="');c.push(m(b));c.push('"')}}n&&!o&&c.push(' alt=""')}var f=g.style.cssText;f=f.toLowerCase();if(f!==""){f=RTE.RteUtility.$Hp(f);c.push(' style="');c.push(m(f));c.push('"')}e=c.join("");if(d){RTE.RteUtility.$7T[d]=e;RTE.RteUtility.$5d+=e.length}}s.push(e)};RTE.RteUtility.$JU=function(a){ULSNVe:;var b=new RegExp("[^:]*://"+window.location.hostname+"(:|/)","i"),c=new RegExp("[^:]*://","i");return a.search(c)===-1||a.search(b)!==-1};RTE.RteUtility.$Hp=function(a){ULSNVe:;if(!RTE.SU.$2(a)&&a.indexOf("rgb(")>-1){var d="",c=a.indexOf("rgb("),b=0;while(c!==-1){d+=a.substring(b,c);b=a.indexOf(")",c+1)+1;if(b!==-1)d+=RTE.RteUtility.$HU(a.substring(c,b));c=b!==-1?a.indexOf("rgb(",b):-1}d+=a.substring(b,a.length);return d}return a};RTE.RteUtility.$HU=function(a){ULSNVe:;var c=a.replace("rgb(","").replace(")",""),b=c.split(",");if(b.length===3)a=RTE.RteUtility.$B0(b)||a;return a};RTE.RteUtility.$Az=function(a,e){ULSNVe:;var b=a.trim().toLowerCase();if(b.startsWith("rgba(")&&b.endsWith(")")){b=a.replace("rgba(","").replace(")","");var c=b.split(",");if(c.length===4)try{var d=parseFloat(c[3]);if(d>=e)a=RTE.RteUtility.$B0(c)||a}catch(f){}}return a};RTE.RteUtility.$B0=function(a){ULSNVe:;if(a.length>=3)try{var b=RTE.RteUtility.$8D(a[0].trim()),c=RTE.RteUtility.$8D(a[1].trim()),d=RTE.RteUtility.$8D(a[2].trim());return"#"+b+c+d}catch(e){}return null};RTE.RteUtility.$8D=function(c){ULSNVe:;var b=Number.parseInvariant(c),a=b.toString(16);if(a.length===1)a="0"+a;return a};RTE.RteUtility.$7D=function(e){ULSNVe:;var a=e,d=window.location.protocol,b=d+"//"+window.location.hostname,c=""+window.location.port;if(c==="")if(d==="https:")c="443";else c="80";if(c==="80"&&d==="http:"||c==="443"&&d==="https:")if(a===b)return"/";else if(!a.indexOf(b+"/"))return a.replace(b+"/","/");b+=":"+c;return a===b?"/":!a.indexOf(b+"/")?a.replace(b+"/","/"):a};RTE.RteUtility.$6E=function(a,b){ULSNVe:;if(b){a.push("</");a.push(b);a.push(">")}};RTE.RteUtility.$Hv=function(b,a){ULSNVe:;a.innerText&&b.push(a.innerText)};RTE.RteUtility.getInnerText=function(a){ULSNVe:;if(a.nodeType===3)return a.nodeValue;var b=a.innerText;if(!RTE.SU.$7(b))return b;var c=new Sys.StringBuilder;RTE.RteUtility.$Br(c,a);return c.toString()};RTE.RteUtility.$Br=function(b,a){ULSNVe:;if(a.nodeType===3)b.append(a.nodeValue);else{if(a.attributes){var c=a.attributes.getNamedItem("_moz_editor_bogus_node");!b.isEmpty()&&a.nodeType===1&&(!c||c&&c.value!=="TRUE")&&!RTE.RteUtility.$4z(a)&&b.append(" ")}for(var d=0;d<a.childNodes.length;d++)RTE.RteUtility.$Br(b,a.childNodes[d])}};RTE.RteUtility.createTextNode=function(a,b){ULSNVe:;return a.createTextNode(b)};RTE.RteUtility.$4y=function(a){ULSNVe:;return a.nodeValue===""||a.tagName==="SPAN"&&!a.childNodes.length};RTE.RteUtility.$1P=function(a){ULSNVe:;return a===RTE.Cursor.s_range.$3_0||a===RTE.Cursor.s_range.$4_0||a===RTE.Cursor.$L.$3_0||a===RTE.Cursor.$L.$4_0};RTE.RteUtility.$3y=function(a){ULSNVe:;if(a.nodeType!==1)return false;if(a.tagName.toUpperCase()!=="SPAN")return false;if(RTE.RteUtility.$1P(a))return true;var b=[];RTE.RteUtility.$34(b,a);var d=b.join(""),c=d.match(RTE.RteUtility.$ER);return!!c&&c.length>0};RTE.RteUtility.$Cf=function(a){ULSNVe:;if(a.nodeType!==1)return false;if(a.tagName.toUpperCase()!=="FONT")return false;var b=[];RTE.RteUtility.$34(b,a);var d=b.join(""),c=d.match(RTE.RteUtility.$BO);return!!c&&c.length>0};RTE.RteUtility.$JN=function(a){ULSNVe:;if(a.nodeType!==1)return false;if(a.tagName.toUpperCase()!=="DIV")return false;var b=[];RTE.RteUtility.$34(b,a);var d=b.join(""),c=d.match(RTE.RteUtility.$EQ);return!!c&&c.length>0};RTE.RteUtility.$6T=function(a){ULSNVe:;return RTE.SU.$2(a.id)&&RTE.RteUtility.$3y(a)};RTE.RteUtility.$Dy=function(a){ULSNVe:;RTE.RteUtility.$CW(a,1,0)};RTE.RteUtility.$CW=function(a,c,d){ULSNVe:;if(c>0&&d>c||SP.UI.UIUtility.isTextNode(a))return;for(var b=0;b<a.childNodes.length;b++)RTE.RteUtility.$CW(a.childNodes[b],c,d+1);(RTE.RteUtility.$6T(a)||RTE.RteUtility.$Cf(a))&&RTE.RteUtility.removeNodeAndKeepChildNodes(a)};RTE.RteUtility.$Kj=function(a){ULSNVe:;(RTE.RteUtility.$3y(a)||RTE.RteUtility.$Cf(a))&&RTE.RteUtility.removeNodeAndKeepChildNodes(a)};RTE.RteUtility.$6G=function(a,b){ULSNVe:;return RTE.RteUtility.$Bx(a,null,b)};RTE.RteUtility.$Bx=function(m,n,u){ULSNVe:;if(!m)return null;var a=m,d=null;while(a&&RTE.RteUtility.$4z(a)){d=a;a=a.parentNode}if(!a)return null;var i=!n?d:RTE.RteUtility.$Bl(n,a,a);if(u&&d){var c=RTE.RteUtility.$m(d,false);while(c&&RTE.RteUtility.$4z(c)&&(c.nodeType!==1||c.tagName!=="BR"||!c.previousSibling))c=RTE.RteUtility.$m(c,false);var b=RTE.RteUtility.$t(d,false),j=i?RTE.RteUtility.$t(i,false):null,g=b===j;while(b&&RTE.RteUtility.$4z(b)&&(!g||b.nodeType!==1||b.tagName!=="BR"||!b.nextSibling)){b=RTE.RteUtility.$t(b,false);g=g||b===j}if(c||b){var o=RTE.Canvas.getEditableRegion(a);if(RTE.RteUtility.isSafari()){var q=RTE.Selection.getSelection();q.clear()}var p=a!==o&&RTE.HtmlTagName.allowedElementStyleTags[a.tagName.toUpperCase()];if(p){if(c){var k=a.cloneNode(false),r=c.nextSibling;while(a.firstChild!==r)k.appendChild(a.firstChild);a.parentNode.insertBefore(k,a)}if(b){var l=a.cloneNode(false),f=b;while(f){var s=f.nextSibling;l.appendChild(f);f=s}a.parentNode.insertBefore(l,a.nextSibling)}}else{var e=c?c.nextSibling:a.firstChild;if(e!==a.firstChild||b){var h=a.ownerDocument.createElement("DIV");while(e!==b){var t=e.nextSibling;h.appendChild(e);e=t}a.insertBefore(h,b);a=h}}c&&c.nodeType===1&&c.tagName==="BR"&&c.parentNode.removeChild(c);b&&b.nodeType===1&&b.tagName==="BR"&&b.parentNode.removeChild(b)}}if(a.tagName==="TR"&&a.parentNode&&(a.parentNode.tagName==="TBODY"||a.parentNode.tagName==="THEAD"||a.parentNode.tagName==="TFOOT"))a=a.parentNode;if((a.tagName==="TBODY"||a.tagName==="THEAD"||a.tagName==="TFOOT")&&a.parentNode&&a.parentNode.tagName==="TABLE")a=a.parentNode;return a};RTE.RteUtility.$G=function(a,b){ULSNVe:;return RTE.RteUtility.$2d(a,[b])};RTE.RteUtility.$2d=function(b,e){ULSNVe:;var f=e.length;if(!b)return null;for(var c=0;c<f;c++)if(b.tagName===e[c])return b;var a=b.parentNode;while(a){for(var d=0;d<f;d++)if(a.tagName===e[d])return a;a=a.parentNode}return null};RTE.RteUtility.$I9=function(){ULSNVe:;var b="",c=RTE.Selection.getSelectionRange();if(null===c)return b;var d="|H1|H2|H3|H4|H5|H6|P|PRE|LI|TD|DIV|BLOCKQUOTE|DT|DD|TABLE|HR|IMG|TR|UL|OL|BODY|HTML|",a=c.parentElement();while(a&&(d.indexOf("|"+a.tagName+"|")===-1||a.dir!=="ltr"&&a.dir!=="rtl"))a=a.parentNode;if(a)if(a.dir==="ltr")b="ltr";else if(a.dir==="rtl")b="rtl";return b};RTE.RteUtility.$4z=function(a){ULSNVe:;return SP.UI.UIUtility.isTextNode(a)?true:RTE.SU.$2(a.tagName)?true:a._blockElement?false:RTE.HtmlTagName.$CP[a.tagName]?true:false};RTE.RteUtility.$Q=function(a){ULSNVe:;return a.nodeType!==1?false:RTE.RteUtility.$4w(a.tagName)?true:a._blockElement?true:false};RTE.RteUtility.$4w=function(a){ULSNVe:;return RTE.SU.$2(a)?false:RTE.HtmlTagName.$7q[a.toUpperCase()]};RTE.RteUtility.$1c=function(a){ULSNVe:;if(SP.UI.UIUtility.isTextNode(a))a=a.parentNode;var b=a.currentStyle;if(RTE.SU.$7(b))if(window.getComputedStyle)b=window.getComputedStyle(a,null);return b};RTE.RteUtility.$b=function(a,b,c){ULSNVe:;return!!RTE.RteUtility.$Bl(a,b,c)};RTE.RteUtility.$Bl=function(d,b,e){ULSNVe:;if(!d||!b)return null;var a=d,c=null;while(a&&a!==b&&a!==e){c=a;a=a.parentNode}return a===b?c:null};RTE.RteUtility.$4c=function(a){ULSNVe:;if(SP.UI.UIUtility.isTextNode(a))return a.nodeValue.length>0;switch(a.tagName){case"IMG":case"HR":return true}for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(SP.UI.UIUtility.isTextNode(c))return c.nodeValue.length>0;var d=RTE.RteUtility.$4c(c);if(d)return true}return false};RTE.RteUtility.$JT=function(b){ULSNVe:;var a=b.replace(new RegExp("( |\x0a|\x0c|\x0c|\x09)","g"),"");return""!==a};RTE.RteUtility.$k=function(a,b){ULSNVe:;while(a.childNodes.length>0)b.appendChild(a.childNodes[0])};RTE.RteUtility.$3A=function(a){ULSNVe:;RTE.RteUtility.$2p(a,RTE.RteUtility.$2O)};RTE.RteUtility.$J=function(a){ULSNVe:;if(a.parentNode){if(a.nodeType===1&&!Sys.UI.DomElement.containsCssClass(a,"ms-rte-wpbox")&&typeof a.innerHTML!=="undefined")try{a.innerHTML=""}catch(b){}a.parentNode.removeChild(a)}};RTE.RteUtility.removeChildNodes=function(a){ULSNVe:;while(a.firstChild)a.removeChild(a.firstChild)};RTE.RteUtility.$CZ=function(b){ULSNVe:;var a=b.parentNode;return b.nodeType===8||RTE.SU.$7(a)||b.tagName!=="TD"&&b.tagName!=="TH"&&(a.tagName==="TR"||a.tagName==="TBODY"||a.tagName==="TABLE")||b.tagName!=="LI"&&(a.tagName==="UL"||a.tagName==="OL")};RTE.RteUtility.isFirefox=function(){ULSNVe:;return Sys.Browser.agent===Sys.Browser.Firefox||Sys.Browser.name.toLowerCase().indexOf("firefox")!==-1};RTE.RteUtility.isInternetExplorer=function(){ULSNVe:;return Sys.Browser.agent===Sys.Browser.InternetExplorer};RTE.RteUtility.isSafari=function(){ULSNVe:;return Sys.Browser.agent===Sys.Browser.Safari||Sys.Browser.name.toLowerCase().indexOf("safari")!==-1||Sys.Browser.name.toLowerCase().indexOf("webkit")!==-1};RTE.RteUtility.$HX=function(a){ULSNVe:;if(document.caretRangeFromPoint){var e=a.clientX,f=a.clientY;return document.caretRangeFromPoint(e,f)}var b=document.body.createTextRange?document.body.createTextRange():RTE.DomHelper.createRange(window.document);if(b.moveToPoint)try{var g=a.clientX,h=a.clientY;b.moveToPoint(g,h)}catch(i){return null}else if(a.rangeParent){var c=a.rangeParent,d=a.rangeOffset;b.setStart(c,d);b.setEnd(c,d)}else return null;return b};RTE.RteUtility.$2b=function(a){ULSNVe:;if(RTE.PreviewManager.get_instance().get_hasPreview())return false;while(a&&SP.UI.UIUtility.isSvgNode(a))a=a.parentNode;if(!a)return true;if(RTE.PasteFlyout.$JI(a))return false;for(var c=RTE.Canvas.get_autocompleteHandlers(),d=c.length,b=0;b<d;++b){var e=c[b];if(e.isSuggestionNode(a))return false}return SP.UI.UIUtility.focusValidOnThisNode(a)};RTE.RteUtility.$JF=function(a){ULSNVe:;var b=a.defaultPrevented||a.returnValue===false;if(!b&&a.getPreventDefault)b=a.getPreventDefault();return b};RTE.RteUtility.get_ignoreClasses=function(){ULSNVe:;if(!RTE.RteUtility.$9d){RTE.RteUtility.$5T["ms-rtestate-write"]=true;RTE.RteUtility.$5T["ms-rtestate-read"]=true;RTE.RteUtility.$5T["ms-rtefocus-invalid"]=true;RTE.RteUtility.$9d=true}return RTE.RteUtility.$5T};RTE.RteUtility.setInputValue=function(a,b){ULSNVe:;RTE.RteUtility.assertNotNull("inputNode",a);if(a.tagName==="TEXTAREA")SP.UI.UIUtility.setInnerText(a,b);else a.value=b};RTE.RteUtility.$Dw=function(a,b){ULSNVe:;return b?a.replace(RTE.RteUtility.$BP,""):a.replace(RTE.RteUtility.$BC,"")};RTE.RteUtility.$4B=function(a,b,c){ULSNVe:;a=RTE.RteUtility.$Dw(a,b);if(!c)a=a.replace(RTE.RteUtility.$9b,"");return a};RTE.RteUtility.$Kh=function(a){ULSNVe:;return a.replace(RTE.RteUtility.$Dr,"").replace(RTE.RteUtility.$9b,"")};RTE.RteUtility.$BZ=function(a){ULSNVe:;var c=new RegExp("<\\s*iframe[^>]* src=[\\\"|']([^\\\"|']*)[\\\"|']","gim"),d=0;if(!RTE.SU.$2(a))do{var e=c.exec(a);if(!e||e.length!==2)break;var b=a.indexOf(">",c.lastIndex)+1;if(b>0){var g=new RegExp("<\\s*/\\s*iframe","gim"),f=RTE.RteUtility.$3R(a,g,Math.max(b,d+1));if(f===-1)a=a.substr(0,b)+"</iframe>"+a.substring(b,a.length);else d=f}}while(true);return a};RTE.RteUtility.$Ki=function(b,c){ULSNVe:;var a=new RegExp("<\\s*iframe[^>]* src=[\\\"|']"+RTE.RteUtility.$KZ(c)+"[\\\"|'][^>]*>\\s*(<\\s*/\\s*iframe\\s*>)?","gim");return b.replace(a,"")};RTE.RteUtility.$KZ=function(a){ULSNVe:;return a.replace("\\","\\\\").replace(new RegExp("[\\.\\[\\]\\{\\}\\?\\+\\*\\^\\$\\(\\)\\|]","g"),function(a){ULSNVe:;return"\\"+a})};RTE.RteUtility.$4p=function(c){ULSNVe:;var d=new RegExp("<\\s*iframe[^>]* src=[\\\"|']([^\\\"|']*)[\\\"|']","gim"),a=new Array(0);if(!RTE.SU.$2(c))do{var b=d.exec(c);if(!b||b.length!==2)break;a[a.length]=b[1]}while(true);return a};RTE.RteUtility.assertNotNull=function(a,b){ULSNVe:;if(!b)throw Error.argumentNull(a);};RTE.RteUtility.$Cl=function(a,b){ULSNVe:;return window.IsSafeHrefAlert(a,b)};RTE.RteUtility.createStyleSheet=function(){ULSNVe:;if(document.createStyleSheet)return document.createStyleSheet();else{var a=document.createElement("STYLE");document.body.appendChild(a);return a.styleSheet?a.styleSheet:a.sheet?a.sheet:null}};RTE.RteUtility.getFirstStyleSheet=function(){ULSNVe:;var a=document.styleSheets;return!a.length?RTE.RteUtility.createStyleSheet():a[0]};RTE.RteUtility.addStyleSheetRule=function(a,b,d,c){ULSNVe:;if(!a)return;if(a.addRule)a.addRule(b,d,c);else a.insertRule&&a.insertRule(b+" {"+d+"}",c)};RTE.RteUtility.removeStyleSheetRule=function(a,b){ULSNVe:;if(!a)return;if(a.removeRule)a.removeRule(b);else a.deleteRule&&a.deleteRule(b)};RTE.RteUtility.$I8=function(e,d){ULSNVe:;for(var b=e.className.split(" "),a=0;a<b.length;a++)if(b[a].length>0)for(var c=0;c<d.length;c++)if(b[a].indexOf(d[c])!==-1)return b[a];return null};RTE.RteUtility.$Bm=function(g,f){ULSNVe:;for(var a="",c=g.className.split(" "),b=0;b<c.length;b++)if(c[b].length>0){for(var e=false,d=0;d<f.length;d++)if(c[b].indexOf(f[d])!==-1){e=true;break}if(!e){if(a.length>0)a=a+" ";a=a+c[b]}}return a};RTE.RteUtility.$25=function(b,c,d){ULSNVe:;var a=RTE.RteUtility.$Bm(b,d);if(a.length>0)a=a+" ";a=a+c;RTE.SnapshotManager.setCurrentRegionDirtyIf(b.className!==a);b.className=a};RTE.RteUtility.$9T=function(a,c){ULSNVe:;var b=RTE.RteUtility.$Bm(a,c);a.className=b};RTE.RteUtility.$Cm=function(c){ULSNVe:;var a=c.toLowerCase(),b=false;if(a.indexOf("@")!==-1)b=true;return!a.indexOf("http://")?!b:!a.indexOf("https://")?!b:!a.indexOf("ftp://")?!b:!a.indexOf("gopher:")?false:!a.indexOf("mailto:")?true:!a.indexOf("pnm://")?true:!a.indexOf("mms://")?true:!a.indexOf("news:")?!b:!a.indexOf("file:///")?false:!a.indexOf("file://")?true:!a.indexOf("mhtml:")?false:!a.indexOf("cdi:")?false:!a.indexOf("\\\\")?false:!a.indexOf("//")?false:!a.indexOf("/\\")?false:!a.indexOf("\\/")?false:RTE.RteUtility.$JO(a)?true:false};RTE.RteUtility.$I0=function(a){ULSNVe:;while(a&&a.tagName!=="A")a=a.parentNode;return a};RTE.RteUtility.$JO=function(e){ULSNVe:;var a=e,b=a.indexOf("#");if(b!==-1)a=a.substr(0,b);var c=a.indexOf("?");if(c!==-1)a=a.substr(0,c);var d=a.indexOf(":");return d===-1?true:false};RTE.RteUtility.$Fs=function(b,c){ULSNVe:;var a=b.cloneNode(c);a.id="";return a};RTE.RteUtility.get_$EX=function(){ULSNVe:;if(!RTE.RteUtility.$7X)RTE.RteUtility.$7X={CENTER:SP.Res.selectMenuCENTER,DIR:SP.Res.selectMenuDIR,FONT:SP.Res.selectMenuFONT,PLAINTEXT:SP.Res.selectMenuPLAINTEXT,S:SP.Res.selectMenuS,STRIKE:SP.Res.selectMenuSTRIKE,U:SP.Res.selectMenuU,XMP:SP.Res.selectMenuXMP,RT:SP.Res.selectMenuRT,RUBY:SP.Res.selectMenuRUBY,A:SP.Res.selectMenuA,ABBR:SP.Res.selectMenuABBR,ACRONYM:SP.Res.selectMenuACRONYM,ADDRESS:SP.Res.selectMenuADDRESS,B:SP.Res.selectMenuB,BDO:SP.Res.selectMenuBDO,BIG:SP.Res.selectMenuBIG,BLOCKQUOTE:SP.Res.selectMenuBLOCKQUOTE,CAPTION:SP.Res.selectMenuCAPTION,CITE:SP.Res.selectMenuCITE,CODE:SP.Res.selectMenuCODE,DD:SP.Res.selectMenuDD,DEL:SP.Res.selectMenuDEL,DFN:SP.Res.selectMenuDFN,DIV:SP.Res.selectMenuDIV,DL:SP.Res.selectMenuDL,DT:SP.Res.selectMenuDT,EM:SP.Res.selectMenuEM,FIELDSET:SP.Res.selectMenuFIELDSET,H1:SP.Res.selectMenuH1,H2:SP.Res.selectMenuH2,H3:SP.Res.selectMenuH3,H4:SP.Res.selectMenuH4,H5:SP.Res.selectMenuH5,H6:SP.Res.selectMenuH6,HR:SP.Res.selectMenuHR,I:SP.Res.selectMenuI,IMG:SP.Res.selectMenuIMG,INS:SP.Res.selectMenuINS,LABEL:SP.Res.selectMenuLABEL,LEGEND:SP.Res.selectMenuLEGEND,LI:SP.Res.selectMenuLI,MARQUEE:SP.Res.selectMenuMARQUEE,MENU:SP.Res.selectMenuMENU,NOBR:SP.Res.selectMenuNOBR,OL:SP.Res.selectMenuOL,P:SP.Res.selectMenuP,PRE:SP.Res.selectMenuPRE,Q:SP.Res.selectMenuQ,SAMP:SP.Res.selectMenuSAMP,SMALL:SP.Res.selectMenuSMALL,SPAN:SP.Res.selectMenuSPAN,STRONG:SP.Res.selectMenuSTRONG,SUB:SP.Res.selectMenuSUB,SUP:SP.Res.selectMenuSUP,TABLE:SP.Res.selectMenuTABLE,TBODY:SP.Res.selectMenuTBODY,TD:SP.Res.selectMenuTD,TFOOT:SP.Res.selectMenuTFOOT,TH:SP.Res.selectMenuTH,THEAD:SP.Res.selectMenuTHEAD,TR:SP.Res.selectMenuTR,TT:SP.Res.selectMenuTT,UL:SP.Res.selectMenuUL};return RTE.RteUtility.$7X};RTE.RteUtility.getDisplayNameForTag=function(a){ULSNVe:;return RTE.RteUtility.get_$EX()[a]};RTE.RteUtility.getDisplayNameForTagWithNumber=function(b,c){ULSNVe:;var a=SP.Res.selectMenuItemWithNumber;a=a.replace("{0}",RTE.RteUtility.get_$EX()[b]);a=a.replace("{1}",c.toString());return a};RTE.RteUtility.parseUnitValue=function(b){ULSNVe:;if(RTE.SU.$2(b)||b==="auto")return null;for(var a=new RTE.UnitValue,c=0,c=0;c<b.length;c++){var d=b.charCodeAt(c);if(d===46||d>=48&&d<=57)continue;else break}a.value=parseFloat(b.substr(0,c));if(isNaN(a.value))return null;if(c<b.length){a.unit=b.substr(c).trim();a.unit=a.unit.toLowerCase()}else a.unit="";return!RTE.RteUtility.$53(a.unit,RTE.RteUtility.$Eh)?null:a};RTE.RteUtility.parseStringForSpinnerControl=function(d,a,e,c){ULSNVe:;RTE.RteUtility.classMustExist("CUI.Controls.SpinnerCommandProperties");var b=RTE.RteUtility.parseUnitValue(d);if(b){a[CUI.Controls.SpinnerCommandProperties.Value]=b.value;if(RTE.SU.$2(b.unit))a[CUI.Controls.SpinnerCommandProperties.Unit]=c;else a[CUI.Controls.SpinnerCommandProperties.Unit]=b.unit}else{a[CUI.Controls.SpinnerCommandProperties.Value]=e;a[CUI.Controls.SpinnerCommandProperties.Unit]=c}};RTE.RteUtility.$8b=function(b){ULSNVe:;RTE.RteUtility.classMustExist("CUI.Controls.SpinnerCommandProperties");var a=b[CUI.Controls.SpinnerCommandProperties.Unit];if(RTE.SU.$2(a))a="px";else{a=a.toLowerCase();if(a==="pixel")a="px";else if(a==="centimeter")a="cm";else if(a==="percent")a="%";else if(a==="inch")a="in"}return a};RTE.RteUtility.$8c=function(b){ULSNVe:;RTE.RteUtility.classMustExist("CUI.Controls.SpinnerCommandProperties");var a=b[CUI.Controls.SpinnerCommandProperties.Value];return a};RTE.RteUtility.getStringValueFromSpinnerControlProperties=function(a){ULSNVe:;var b=RTE.RteUtility.$8c(a).toString(),c=RTE.RteUtility.$8b(a);return b+c};RTE.RteUtility.$4d=function(b){ULSNVe:;var a=b.createElement("P");if(RTE.RteUtility.isFirefox()){var c=b.createElement("BR");a.appendChild(c)}return a};RTE.RteUtility.$2p=function(a,c){ULSNVe:;if(RTE.RteUtility.isInternetExplorer()&&a.tagName==="TABLE"){var b=document.createElement("DIV");b.innerHTML="<table>"+c+"</table>";while(a.childNodes.length>0)a.removeChild(a.childNodes[0]);RTE.RteUtility.$k(b.firstChild,a)}else{a.innerHTML="<div>RTE</div>"+c;a.removeChild(a.firstChild)}};RTE.RteUtility.$JE=function(a){ULSNVe:;var b=RTE.RteUtility.getAttribute(a,"ContentEditable");while(a){if(b==="true")return true;a=a.parentNode}return false};RTE.RteUtility.$9t=function(h,u){ULSNVe:;var i=RTE.ClientWebPartManager.$4r();if(!i||!i.rgparts)RTE.RteUtility.$2p(h,u);else{RTE.ClientWebPartManager.updateRendererNodes();var a=[];RTE.RteUtility.forEachChildWithTagAndClass(h,"DIV","ms-rte-wpbox",function(c){ULSNVe:;if(c.childNodes.length>0){var b=c.childNodes[0],d=0;while(SP.UI.UIUtility.isTextNode(b)&&d<c.childNodes.length-1){d++;b=c.childNodes[d]}!SP.UI.UIUtility.isTextNode(b)&&b.id.length===40&&RTE.RteUtility.$6V(b)&&Array.add(a,b)}});var c=a.length,f=document.createElement("DIV");f.style.display="none";document.body.appendChild(f);for(var k=0;k<c;k++){var v=a[k];f.appendChild(v)}RTE.RteUtility.$2p(h,u);a=[];RTE.RteUtility.forEachChildWithTagAndClass(h,"DIV","ms-rte-wpbox",function(c){ULSNVe:;if(c.childNodes.length>0){var b=c.childNodes[0],d=0;while(SP.UI.UIUtility.isTextNode(b)&&d<c.childNodes.length-1){d++;b=c.childNodes[d]}if(!SP.UI.UIUtility.isTextNode(b)&&b.id.length===40)if(RTE.RteUtility.$6V(b))Array.add(a,b);else RTE.RteUtility.$J(c)}});var j=[];c=a.length;for(var l=0;l<c;l++){var d=a[l],w=RTE.RteUtility.$6F(d),e=i.rgparts[w];if(e&&e.render&&d!==e.render){d.parentNode.replaceChild(e.render,d);d.innerHTML="";Array.add(j,e)}}document.body.removeChild(f);c=j.length;for(var m=0;m<c;m++){var b=j[m];if(!b.render.childNodes||!b.render.childNodes.length){var p=document.createElement("TABLE"),q=document.createElement("TBODY"),r=document.createElement("TR"),s=document.createElement("TD");p.appendChild(q);q.appendChild(r);r.appendChild(s);var g=document.createElement("DIV");if(!RTE.SU.$2(b.titleHtml)){var o=document.createElement("DIV");o.className="ms-fakewptitle";o.innerHTML=b.titleHtml;g.appendChild(o);var t=document.createElement("DIV");t.style.height="8px";g.appendChild(t)}var n=document.createElement("DIV");n.className="ms-error ms-fakewpmsg";SP.UI.UIUtility.setInnerText(n,SP.Res.webPartNotDisplay);g.appendChild(n);s.appendChild(g);b.render.appendChild(p);RTE.Canvas.$DB(b.render)}}}};RTE.RteUtility.$Cc=function(a){ULSNVe:;while(a){if(a===a.ownerDocument.body)return true;a=a.parentNode}return false};RTE.RteUtility.$Ea=function(a,b,c){ULSNVe:;try{SP.UI.UIUtility.insertAfter(a,b)}catch(d){if(null===c)b.parentNode.appendChild(a);else SP.UI.UIUtility.insertBefore(a,c)}};RTE.RteUtility.$Kk=function(c){ULSNVe:;for(var a=c.length-1;a>=0;a--){var b=c[a];if(RTE.RteUtility.$JM(b)||SP.UI.UIUtility.isSvgNode(b)){Array.remove(c,b);continue}}};RTE.RteUtility.$JM=function(a){ULSNVe:;while(null!==a){var b=a.className;if(b){if(b.indexOf("ms-rtestate-write")!==-1)return false;if(b.indexOf("ms-rtestate-read")!==-1)return true}a=a.parentNode}return false};RTE.RteUtility.isInWebpartBox=function(a){ULSNVe:;while(null!==a){var b=a.className;if(b&&b.indexOf("ms-rte-wpbox")>=0)return true;a=a.parentNode}return false};RTE.RteUtility.$6V=function(b){ULSNVe:;var a=RTE.RteUtility.$6F(b);return RTE.SU.$2(a)?false:true};RTE.RteUtility.$6F=function(b){ULSNVe:;if(b&&window.vwpcm&&window.vwpcm.rgparts)if(b.tagName==="DIV"){var c=b.id;if(c&&c.length===40&&c.startsWith("div_")){var a=c.substr(4);if(b.className&&b.className.indexOf("ms-rtestate-read")>=0&&b.className.indexOf(a)>=0){var f=window.vwpcm.rgparts;if(f[a])return a;var d=window.WPCM.newWebPartIdElementId;if(!RTE.SU.$2(d)&&$get(d))if(a===$get(d).value)return a;var e=window.WPCM.injectedWebPartIdElementId;if(!RTE.SU.$2(e))if(a===e)return a}}}return null};RTE.RteUtility.$15=function(a,b){ULSNVe:;if(a)if(a.removeAttribute)a.removeAttribute(b);else a[b]=""};RTE.RteUtility.$I6=function(c,d,e,f){ULSNVe:;var a=c.createElement("SPAN");SP.UI.UIUtility.insertBefore(a,d);a.className=e;var b=RTE.RteUtility.$I5(a,f);SP.UI.UIUtility.removeNode(a);return b};RTE.RteUtility.$I5=function(b,c){ULSNVe:;var a=RTE.RteUtility.$1c(b);return a[c]};RTE.RteUtility.$53=function(c,b){ULSNVe:;for(var a=0;a<b.length;a++)if(c===b[a])return true;return false};RTE.RteUtility.$3C=function(b,c){ULSNVe:;for(var a=0;a<b.length;a++)if(c.indexOf(b[a])!==-1)return true;return false};RTE.RteUtility.$BM=function(d){ULSNVe:;for(var b=d.length,c=new Array(b),a=0;a<b;a++)c[a]=d[a];return c};RTE.RteUtility.forEachChildWithTagAndClass=function(c,e,f,i){ULSNVe:;var d=!RTE.SU.$2(f),b=!RTE.SU.$2(e),a;if((b&&e.indexOf(":")===-1||d)&&c.querySelectorAll){var j=(b?e:"")+(d?"."+f:"");a=c.querySelectorAll(j);b=false;d=false}else if(b){a=c.getElementsByTagName(e);a=RTE.RteUtility.$BM(a);b=false}else{a=c.getElementsByTagName("*");a=RTE.RteUtility.$BM(a)}for(var g=0;g<a.length;g++){var h=a[g];(!d||h.className&&h.className.indexOf(f)!==-1)&&i(h)}};RTE.RteUtility.showRibbonTab=function(b,c){ULSNVe:;var a=RTE.Canvas.currentEditableRegion();if(!a||RTE.Canvas.getCachedRestriction(a,"DisableRibbonCommands",false))return;RTE.RteUtility.$7Q=b;RTE.RteUtility.$7R=c;window.setTimeout(RTE.RteUtility.$EO,0)};RTE.RteUtility.$LO=function(c){ULSNVe:;var a=RTE.RichTextEditorComponent.$4s();if(a){var b=a.get_ribbon();if(!b||b.get_selectedTabId()!==c)try{RTE.Imports.SelectRibbonTab(c,true)}catch(d){}}};RTE.RteUtility.$LP=function(){ULSNVe:;if(!RTE.RteUtility.$7Q||!RTE.RteUtility.$7R)return;var b=RTE.RichTextEditorComponent.$4s();if(b){var a=b.get_ribbon();if(a&&!RTE.PreviewManager.get_instance().get_hasPreview()){a.showContextualGroup(RTE.RteUtility.$7Q);a.selectTabByCommand(RTE.RteUtility.$7R)}}};RTE.RteUtility.showNextBestTabIfSelectedRibbonTabIs=function(d){ULSNVe:;var b=RTE.Canvas.currentEditableRegion();if(!b||RTE.Canvas.getCachedRestriction(b,"DisableRibbonCommands",false))return;var c=RTE.RichTextEditorComponent.$4s();if(c){var a=c.get_ribbon();if(a&&!RTE.PreviewManager.get_instance().get_hasPreview())if(RTE.RteUtility.$53(a.get_selectedTabCommand(),d))if(RTE.CanvasEvents.getNodeFromEvent("Image")){a.showContextualGroup("Ribbon.Image");a.selectTabByCommand("ImageTab")}else if(RTE.CanvasEvents.getNodeFromEvent("Link")){a.showContextualGroup("Ribbon.Link");a.selectTabByCommand("LinkTab")}else if(RTE.CanvasEvents.getNodeFromEvent("Table")){a.showContextualGroup("Ribbon.Table");a.selectTabByCommand("TableLayoutTab")}else{a.showContextualGroup("Ribbon.EditingTools");a.selectTabByCommand("CPEditTab")}}};RTE.RteUtility.getAttribute=function(a,c){ULSNVe:;if(!a.getAttribute)return null;var b=a.getAttribute(c);return!RTE.SU.$7(b)?b:a[c]};RTE.RteUtility.isClassAvailable=function(d){ULSNVe:;for(var c=d.split("."),a=window,b=0;b<c.length;b++){a=a[c[b]];if(!a)return false}return true};RTE.RteUtility.classMustExist=function(a){ULSNVe:;!RTE.RteUtility.isClassAvailable(a)};RTE.RteUtility.initImageForce=function(a){ULSNVe:;a.setAttribute(RTE.RteUtility.$4q,"true");RTE.RteUtility.initImage(a)};RTE.RteUtility.initImageSizeForce=function(a){ULSNVe:;a.setAttribute(RTE.RteUtility.$4q,"true");RTE.RteUtility.$CO(a)};RTE.RteUtility.initImage=function(a){ULSNVe:;a.style.margin="5px";RTE.RteUtility.$CO(a)};RTE.RteUtility.$CO=function(a){ULSNVe:;if(!a.style.width&&!a.style.height)if(a.src&&a.src.length>0)RTE.RteUtility.$9s(a);else $addHandler(a,"load",RTE.RteUtility.$8k)};RTE.RteUtility.$LC=function(a){ULSNVe:;RTE.RteUtility.$9s(a.target);$removeHandler(a.target,"load",RTE.RteUtility.$8k)};RTE.RteUtility.$9s=function(a){ULSNVe:;if(a.complete||a.readyState==="complete"){var c=a.getAttribute(RTE.RteUtility.$4q);if(c==="true"||!a.style.width&&!a.style.height){var b=RTE.Canvas.getEditableRegion(a)||RTE.Canvas.currentEditableRegion();if(b)if(b.clientWidth<a.width){a.removeAttribute("width");a.removeAttribute("height");a.style.height="";a.style.width=Math.max(RTE.RteUtility.$CJ,b.clientWidth-RTE.RteUtility.$CK)+"px"}}a.removeAttribute(RTE.RteUtility.$4q)}else a.src&&a.src.length>0&&window.setTimeout(function(){ULSNVe:;RTE.RteUtility.$9s(a)},20)};RTE.RteUtility.$JK=function(c,d){ULSNVe:;for(var b=0;b<c.childNodes.length;b++){var a=c.childNodes[b];if(a!==RTE.Cursor.s_range.$3_0&&a!==RTE.Cursor.s_range.$4_0&&!RTE.RteUtility.$1x(a,d)&&!RTE.RteUtility.$4y(a))return false}return true};RTE.RteUtility.$3u=function(a,c){ULSNVe:;if(RTE.RteUtility.$1x(a,c))return true;if(a.nodeType===1&&a.firstChild===a.lastChild){var b=a.tagName.toUpperCase();if((b==="FONT"||b==="SPAN")&&(!a.firstChild||RTE.RteUtility.$3u(a.firstChild,c)))return true}return false};RTE.RteUtility.$1x=function(a,b){ULSNVe:;return!SP.UI.UIUtility.isTextNode(a)?false:RTE.RteUtility.$6U(a.nodeValue,b)};RTE.RteUtility.$6U=function(a,c){ULSNVe:;if(RTE.SU.$2(a))return true;var b=c?RTE.RteUtility.$ET:RTE.RteUtility.$EU;return b.test(a)};RTE.RteUtility.$6K=function(b){ULSNVe:;var a;a=b.document.documentElement.clientWidth;if(RTE.SU.$7(a)||a<=0)a=b.innerWidth;if(RTE.SU.$7(a)||a<=0)a=b.document.body.clientWidth;return a};RTE.RteUtility.$6J=function(b){ULSNVe:;var a;a=b.document.documentElement.clientHeight;if(RTE.SU.$7(a)||a<=0)a=b.innerHeight;if(RTE.SU.$7(a)||a<=0)a=b.document.body.clientHeight;return a};RTE.RteUtility.getRteNodeId=function(b){ULSNVe:;if(!RTE.RteUtility.isValidRteNodeId(b))throw Error.invalidOperation("this node cannot have id");var a=b.getAttribute("RteNodeId");if(RTE.SU.$7(a)){a=""+RTE.RteUtility.$9E;RTE.RteUtility.$9E++;b.setAttribute("RteNodeId",a)}return a};RTE.RteUtility.isValidRteNodeId=function(a){ULSNVe:;return a.nodeType===1};RTE.RteUtility.removeRteNodeId=function(a){ULSNVe:;RTE.RteUtility.isValidRteNodeId(a)&&a.removeAttribute("RteNodeId")};RTE.RteUtility.containsCssClass=function(a,b){ULSNVe:;return SP.UI.UIUtility.isSvgNode(a)||a.nodeType!==1?false:Sys.UI.DomElement.containsCssClass(a,b)};RTE.SU=function(){};RTE.SU.$2=function(a){ULSNVe:;var b=null;return a===b||typeof a==="undefined"||!a.length};RTE.SU.$7=function(a){ULSNVe:;var b=null;return a===b||typeof a==="undefined"};RTE.SU.$1R=function(a){ULSNVe:;return typeof a==="undefined"};RTE.Ie8TreeValidator=function(a){ULSNVe:;this.$8L_0={};this.$8K_0={};this.$Af_0(a,0)};RTE.Ie8TreeValidator.prototype={$Af_0:function(d,e){ULSNVe:;if(d.nodeType===1)for(var h=d.uniqueID,f=d.childNodes,i=f.length,b=0;b<i;b++){var c=f[b];if(c.nodeType===1){var a=c.uniqueID;if(typeof a!=="undefined"){var g=this.$8K_0[a];if(typeof g==="undefined"||g>e){this.$8K_0[a]=e;this.$8L_0[a]=h}}this.$Af_0(c,e+1)}}},$LK_0:function(d,c){ULSNVe:;if(c.nodeType!==1)return true;var a=c.uniqueID;if(typeof a==="undefined")return true;var b=this.$8L_0[a];return typeof b==="undefined"||b===d.uniqueID}};RTE.SafeHtml=function(){};RTE.SafeHtml.$Iu=function(){ULSNVe:;if(!RTE.SafeHtml.$3V){RTE.SafeHtml.$3V={};RTE.SafeHtml.$9f={};for(var c=RTE.NativeSafeHtml.getSafeHtmlRules(),a=0;a<c.length;a+=2){var b=c[a],d=c[a+1];RTE.SafeHtml.$3V[b]=d;if(!b.startsWith("!--")&&b.indexOf("_")<0)RTE.SafeHtml.$9f[b]=true}RTE.SafeHtml.$3V.BR__moz_editor_bogus_node="A";RTE.SafeHtml.$3V.BR__moz_dirty="A"}};RTE.SafeHtml.get_$9i=function(){ULSNVe:;RTE.SafeHtml.$Iu();return RTE.SafeHtml.$3V};RTE.SafeHtml.$Ih=function(c,d){ULSNVe:;var b=RTE.SafeHtml.get_$9i(),a=b[c];return RTE.SU.$1R(a)?d:a};RTE.SafeHtml.$I1=function(d,b,e){ULSNVe:;if(b==="contenteditable"||b.startsWith("data-")||b.startsWith("aria-"))return"A";var c=d+"_"+b,a=RTE.SafeHtml.get_$9i()[c];if(!RTE.SU.$1R(a))return a;c="!--_"+b;a=RTE.SafeHtml.get_$9i()[c];return!RTE.SU.$1R(a)?a:e};RTE.SafeHtml.$Id=function(e){ULSNVe:;for(var c=[],b=e.attributes,d=b.length,a=0;a<d;a++)b[a].specified&&Array.add(c,b[a]);return c};RTE.SafeHtml.addDisallowedPasteClass=function(a){ULSNVe:;RTE.SafeHtml.$4k.push(a)};RTE.SafeHtml.$Kn=function(a){ULSNVe:;RTE.SafeHtml.$7B(a,true,false,false,false)};RTE.SafeHtml.$Ko=function(a){ULSNVe:;RTE.SafeHtml.$7B(a,true,false,true,false)};RTE.SafeHtml.$Km=function(a){ULSNVe:;return RTE.SafeHtml.$7B(a,true,false,false,true)};RTE.SafeHtml.$9V=function(a,b,c,d){ULSNVe:;RTE.SafeHtml.$7B(a,b,c,d,true)};RTE.SafeHtml.$7B=function(f,Cb,gb,hb,Db){ULSNVe:;var e=false,M=RTE.Canvas.getEditableRegion(f),nb=RTE.Canvas.getCachedRestriction(M,"AllowScripts",false);if(nb)return false;if(!gb&&!f.childNodes.length)return false;var l=[],h=[],w=[],x=[],N=[],b=new RTE.DOMTreePosition(f,0);gb&&b.moveToPreviousElement();var y=new RTE.DOMTreePosition(f,0);y.setLocationAtEnd();y.moveToNextElement();while(true){if(!b.moveToNextElement())break;var a=b.$1_0;if(a===y.$1_0||a===M)break;if(b.$1_0.childNodes.length&&b.atEnd())continue;if(SP.UI.UIUtility.isTextNode(a)){if(RTE.RteUtility.$1x(a,false))if(RTE.RteUtility.$Q(a.parentNode)){var ab=RTE.RteUtility.$m(a,false),bb=RTE.RteUtility.$t(a,false);(!ab||RTE.RteUtility.$Q(ab))&&(!bb||RTE.RteUtility.$Q(bb))&&Array.add(l,a)}continue}if(RTE.RteUtility.$Cb(a)){var i=a.data;if(i&&i.trim().toLowerCase()==="[if !supportlists]"){for(var d=a,D=null,cb=0;cb<4;cb++){d=RTE.RteUtility.$t(d,false);if(!d)break;if(d.nodeType===8){i=d.data;if(i&&i.trim().toLowerCase()==="[endif]"){D=d;break}}}if(D){var F=f.ownerDocument.createElement("SPAN");F.setAttribute("style","mso-list: ignore");d=RTE.RteUtility.$t(a,false);while(d!==D){d=d.nextSibling;F.appendChild(d.previousSibling)}SP.UI.UIUtility.insertAfter(F,a)}}}if(a.scopeName&&a.scopeName!=="HTML"){Array.add(h,a);e=true;continue}if(RTE.RteUtility.$6V(a)){b.setLocationAtEnd();continue}var g="",R=a.tagName;if(!RTE.SU.$7(R)){g=R.toUpperCase();if(g==="SVG"){b.setLocationAtEnd();if(b.$1_0===f)break;continue}}var S=RTE.SafeHtml.$Ih(g,"DT"),z=false,U=false;RTE.RteUtility.removeRteNodeId(a);var m="",W=a.className;if(!RTE.SU.$7(W))m=W;var X=g==="IFRAME"&&!!a.src&&a.src.toLowerCase().startsWith("http")&&RTE.EmbeddingCommands.canUserEmbedIframes();if(!X){var Ab=hb&&a.nodeType===1&&(!!a.style.display&&a.style.display.toLowerCase()==="none"||!!a.style.visibility&&a.style.visibility.toLowerCase()==="hidden");if(S==="DB"||m.indexOf("ms-rtepaste-remove")!==-1||Ab){z=true;U=true}else if(S==="DT"||a.tagUrn&&a.tagUrn!=="")z=true}m.indexOf("ms-rtestate-notify")!==-1&&Array.add(w,a);if(z){e=true;a.src="";if(g==="LINK"&&a.href)for(var n=a.ownerDocument.styleSheets,j=0;j<n.length;j++)if(n[j].href&&n[j].href.toUpperCase()===a.href.toUpperCase())n[j].cssText="";if(!Cb&&g==="SCRIPT"){a.text="";b.setLocationAtEnd();if(b.$1_0===f)break}else if(U){Array.add(l,a);b.setLocationAtEnd();if(b.$1_0===f)break}else Array.add(h,a);continue}var Z=a.getAttribute("style");if(!RTE.SU.$2(Z)){Array.add(x,a);Array.add(N,Z)}a.removeAttribute("style");if(hb){e=e||!!a.id;a.removeAttribute("id")}if(!RTE.SU.$2(m))for(var o=0;o<RTE.SafeHtml.$4k.length;o++)if(Sys.UI.DomElement.containsCssClass(a,RTE.SafeHtml.$4k[o])){e=true;Sys.UI.DomElement.removeCssClass(a,RTE.SafeHtml.$4k[o])}if(!X){var I=RTE.SafeHtml.$Id(a),fb=I.length;if(I&&fb>0){var c={};c.DA=[];c.DANV=[];c.DAURL=[];c.DTURL=[];c.RAV=[];c.A=[];for(var A=0;A<fb;A++){var Y=I[A];if(Y.specified){var B=Y.name,wb=B.toLowerCase();if(!RTE.SU.$2(B)){var xb=RTE.SafeHtml.$I1(g,wb,"DA");Array.add(c[xb],B)}}}for(var O=c.DA,qb=O.length,C=0;C<qb;C++){e=true;var yb=O[C];a.removeAttributeNode(a.getAttributeNode(yb))}for(var P=c.RAV,sb=P.length,E=0;E<sb;E++){var zb=P[E];a.removeAttributeNode(a.getAttributeNode(zb))}for(var Q=c.DANV,tb=Q.length,G=0;G<tb;G++){var db=Q[G],Bb=a.getAttribute(db);if(RTE.SU.$7(Bb)){e=true;a.removeAttributeNode(a.getAttributeNode(db))}}for(var T=c.DAURL,ub=T.length,H=0;H<ub;H++){var eb=T[H],J=a.getAttribute(eb);if(J&&typeof J==="string"){var p=J;p=p.toLowerCase();if(!RTE.RteUtility.$Cm(p)){e=true;a.removeAttributeNode(a.getAttributeNode(eb))}}}for(var V=c.DTURL,vb=V.length,q=0;q<vb;q++){var ib=V[q],r=a.getAttribute(ib);if(r&&typeof r==="string"){var s=r;s=s.toLowerCase();if(!RTE.RteUtility.$Cm(s)){Array.add(h,a);break}}}}}}for(var ob=h.length,t=0;t<ob;t++)RTE.RteUtility.removeNodeAndKeepChildNodes(h[t]);for(var pb=l.length,u=0;u<pb;u++){var K=l[u];try{K.parentNode.removeChild(K)}catch(Eb){}}for(var rb=x.length,k=0;k<rb;k++){var jb=x[k],kb=N[k],lb=RTE.NativeSafeHtml.cleanStyleText(kb);jb.setAttribute("style",lb)}if(Db)for(var mb=w.length,v=0;v<mb;v++){var L={};L.node=w[v];RTE.CanvasEvents.dispatchEvent("ElementAdded","html",L)}return e};RTE.Selection=function(a){ULSNVe:;this.$2h_0=a};RTE.Selection.getSelection=function(){ULSNVe:;var b=window.document,a=null;if(!a){var c=b.defaultView;if(c){var d=b.defaultView.getSelection;if(d)a=b.defaultView.getSelection()}}if(!a){var e=window.self.getSelection;if(e)a=window.self.getSelection()}if(!a)a=b.selection;return new RTE.Selection(a)};RTE.Selection.isControlRangeSelection=function(){ULSNVe:;var a=window.document.selection;return!!a&&!RTE.SU.$2(a.type)&&a.type==="Control"};RTE.Selection.getSelectionRange=function(){ULSNVe:;var a=RTE.Selection.getSelection();return a?a.createRange():null};RTE.Selection.get_hasSelection=function(){ULSNVe:;var a=RTE.Selection.getSelection();if(!a)return false;var b=a.createRange();return!b?false:b.isVisible()};RTE.Selection.prototype={$2h_0:null,createRange:function(){ULSNVe:;var a=RTE.DomHelper.createRangeFromSelection(this.$2h_0);return!a?null:new RTE.Range(a)},clear:function(){ULSNVe:;if(this.$2h_0.removeAllRanges)this.$2h_0.removeAllRanges();else this.$2h_0.empty&&this.$2h_0.empty()}};RTE.SelectionManager=function(){};RTE.SelectionManager.$J1=function(){ULSNVe:;RTE.RteUtility.classMustExist("CUI.JsonXmlElement");var i=new CUI.JsonXmlElement("Menu",{Id:"Ribbon.EditingTools.CPEditTab.Html.Select.Menu"}),j=i.appendChild("MenuSection",{Id:"Ribbon.EditingTools.CPEditTab.Html.Select.Menu.Elements"}).appendChild("Controls",{Id:"Ribbon.EditingTools.CPEditTab.Html.Select.Menu.Elementscontrols"});if(RTE.Cursor.get_range().isValid()&&RTE.SelectionManager.$7O){RTE.SelectionManager.$2o=RTE.Cursor.get_range().getParentChain();for(var c={},f=0;f<RTE.SelectionManager.$2o.length;f++){var d=RTE.SelectionManager.$2o[f].tagName;if(!c[d])c[d]=1;else c[d]=c[d]+1}for(var e={},a=0;a<RTE.SelectionManager.$2o.length;a++){var b=RTE.SelectionManager.$2o[a].tagName,g;if(c[b]>1){var h=1;if(e[b])h=e[b]+1;g=RTE.RteUtility.getDisplayNameForTagWithNumber(b,h);e[b]=h}else g=RTE.RteUtility.getDisplayNameForTag(b);j.appendChild("Button",{Id:"SelectMenuItem"+a.toString(),LabelText:g,CommandType:"General",MenuItemId:"SelectMenuItem"+a.toString(),CommandValueId:a.toString(),Command:"SelectMenuItem",CommandPreview:"SelectMenuItemPreview"})}}return i};RTE.SelectionManager.$7C=function(){ULSNVe:;for(var a=RTE.SelectionManager.$5V.length-1;a>=0;a--){var b=RTE.SelectionManager.$5V[a];if(b&&b.style)b.style.cssText=RTE.SelectionManager.$6w[a]}RTE.SelectionManager.$5V=[];RTE.SelectionManager.$6w=[]};RTE.SelectionManager.$AR=function(a){ULSNVe:;if(SP.UI.UIUtility.isTextNode(a))return;if(a.tagName==="TBODY"||a.tagName==="TR"||a.tagName==="THEAD"||a.tagName==="TFOOT")for(var b=0;b<a.childNodes.length;b++)RTE.SelectionManager.$AR(a.childNodes[b]);else{RTE.SelectionManager.$5V.push(a);RTE.SelectionManager.$6w.push(a.style.cssText);a.style.border="red dashed 2px"}};RTE.SelectionManager.selectParentElement=function(a,b){ULSNVe:;switch(b){case 0:RTE.SelectionManager.$7C();RTE.Cursor.get_range().moveToChildren(RTE.SelectionManager.$2o[a]);RTE.Cursor.update();break;case 1:RTE.SelectionManager.$7O=false;RTE.SelectionManager.$7C();RTE.SelectionManager.$7O=true;RTE.SelectionManager.$AR(RTE.SelectionManager.$2o[a])}};RTE.Snapshot=function(){ULSNVe:;this.$1n_0=-1;this.$1b_0=-1};RTE.Snapshot.$C5=function(a){ULSNVe:;return RTE.Snapshot.$8Z(a,false,true)};RTE.Snapshot.$8Y=function(a){ULSNVe:;return RTE.Snapshot.$8Z(a,false,false)};RTE.Snapshot.$ID=function(b){ULSNVe:;var a=RTE.Snapshot.$8Z(b,true,true),c=a.get_$8e_0();return a};RTE.Snapshot.$8Z=function(a,c,d){ULSNVe:;if(!a||!a.parentNode)return null;a=RTE.Canvas.$35(a);var b=new RTE.Snapshot;b.$P_0=a;b.$1O_0=a.cloneNode(true);b.$8P_0=c;b.$1T_0=d?RTE.SnapshotManager.$8n(a,b,null):false;return b};RTE.Snapshot.prototype={$1O_0:null,$P_0:null,$8P_0:false,$1T_0:false,$6z_0:false,$3B_0:null,$61_0:false,get_$8e_0:function(){ULSNVe:;if(!this.$3B_0&&this.$3B_0!==""){this.$An_0();this.$3B_0=this.$1O_0?this.$1O_0.innerHTML:""}return this.$3B_0},set_$8e_0:function(a){ULSNVe:;this.$3B_0=a||"";return a},get_$DR_0:function(){ULSNVe:;if(this.$1b_0===-1&&this.$1O_0)if(this.$1O_0.querySelectorAll){this.$An_0();this.$1b_0=this.$1O_0.getElementsByTagName("*").length;this.$1b_0-=this.$1O_0.querySelectorAll("#ms-rterangecursor-start, #ms-rterangecursor-end, .ms-rtegenerate-skip").length}return this.$1b_0},$9Z_0:function(){ULSNVe:;this.$E6_0(true)},$E6_0:function(i){ULSNVe:;RTE.CanvasRange.$66=true;RTE.PasteFlyout.hide();RTE.RteUtility.$9t(this.$P_0,this.get_$8e_0());this.$P_0.childNodes.length>0&&RTE.Canvas.$4n(this.$P_0);var c=null;if(RTE.Canvas.$8o(this.$P_0))c=RTE.LayoutsEditor.create(this.$P_0);!RTE.PreviewManager.get_instance().get_hasPreview()&&RTE.CanvasEvents.dispatchChangedOnEditableRegion(this.$P_0);var a=RTE.Cursor.get_range(),d=a.$3_0.id,e=a.$4_0.id;a.$3_0.id="";a.$4_0.id="";var b=RTE.SnapshotManager.getMarkers();if(b.length===2&&b[0]&&b[1])RTE.Cursor.get_range().setMarkersCollection(b);else if(i)if(c){var f=c.$Bq_0();RTE.Cursor.get_range().moveToEndOfNode(f)}else RTE.Cursor.get_range().moveToEndOfNode(this.$P_0);a.$3_0.id=d;a.$4_0.id=e;RTE.CanvasRange.$66=false;if(!this.$8P_0){var g=RTE.Snapshot.$8Y(this.$P_0),h=this.$1T_0;this.$8F_0(g);this.$1T_0=h}RTE.Canvas.$LJ()&&RTE.Cursor.update()},$An_0:function(){ULSNVe:;if(!this.$61_0&&this.$1O_0){if(this.$1O_0.querySelectorAll){for(var c=this.$1O_0.querySelectorAll(".ms-rtegenerate-notify"),a=0;a<c.length;a++)RTE.RteUtility.removeChildNodes(c[a]);for(var d=this.$1O_0.querySelectorAll(".ms-rtegenerate-skip"),b=0;b<d.length;b++)RTE.RteUtility.removeNodeAndKeepChildNodes(d[b])}this.$61_0=true}},$8F_0:function(a){ULSNVe:;this.$1O_0=a.$1O_0;this.$3B_0=a.$3B_0;this.$6z_0=a.$6z_0;this.$1n_0=a.$1n_0;this.$61_0=a.$61_0;this.$1b_0=a.$1b_0;this.$1T_0=a.$1T_0}};RTE.SnapshotManager=function(){};RTE.SnapshotManager.takeSnapshot=function(){ULSNVe:;var b=RTE.Cursor.get_range(),a=b.getEditableRegion();if(!a||!a.parentNode)return;RTE.SnapshotManager.takeEditableRegionSnapshot(a)};RTE.SnapshotManager.takeSnapshotIfNotInPreview=function(){ULSNVe:;!RTE.PreviewManager.get_instance().get_hasPreview()&&RTE.SnapshotManager.takeSnapshot()};RTE.SnapshotManager.takePartialSnapshot=function(b){ULSNVe:;if(!b)return;var a=RTE.Snapshot.$C5(b);a.$6z_0=true;a.$1n_0=RTE.SnapshotManager.$DL++%2+1;a.$1T_0&&RTE.CanvasEvents.dispatchChangedOnEditableRegion(a.$P_0);RTE.SnapshotManager.$1U.push(a);RTE.SnapshotManager.clearRegionDirty(b)};RTE.SnapshotManager.takeEditableRegionSnapshot=function(a){ULSNVe:;a=RTE.Canvas.$35(a);if(!a||!a.parentNode||RTE.PreviewManager.get_instance().get_hasPreview())return;var b=RTE.Snapshot.$C5(a),c=RTE.SnapshotManager.$Ja(RTE.SnapshotManager.$1U);if(c&&c.$6z_0)b.$1n_0=c.$1n_0;var d=b.$1T_0;RTE.SnapshotManager.$7L(true,b,true);RTE.SnapshotManager.clearRegionDirty(a);d&&RTE.PasteFlyout.hide()};RTE.SnapshotManager.$Kb=function(){ULSNVe:;if(!RTE.SnapshotManager.$78){RTE.CanvasEvents.registerListener("EditableRegionChanged",RTE.SnapshotManager.$4j);RTE.SnapshotManager.$78=true}};RTE.SnapshotManager.undo=function(){ULSNVe:;RTE.SnapshotManager.$Kb();RTE.SnapshotManager.$5j(true,-1);RTE.Canvas.$O();RTE.SnapshotManager.$Am()};RTE.SnapshotManager.$Am=function(){ULSNVe:;var a=RTE.SnapshotManager.$3W;RTE.SnapshotManager.$3W=RTE.SnapshotManager.$Im(RTE.SnapshotManager.$1U);RTE.SnapshotManager.$3W!==a&&RTE.Canvas.$O()};RTE.SnapshotManager.redo=function(){ULSNVe:;RTE.SnapshotManager.$5j(false,-1);RTE.Canvas.$O()};RTE.SnapshotManager.$7l=function(a,b,e){ULSNVe:;var c=b?b.$1T_0:true,d=a?a.$1T_0:true;return e?!c:!d};RTE.SnapshotManager.$5j=function(b,e){ULSNVe:;var c=b?RTE.SnapshotManager.$1U:RTE.SnapshotManager.$3Q,f=b?RTE.SnapshotManager.$3Q:RTE.SnapshotManager.$1U;if(!c.$13_0)return;var a=c.pop();if(!a||!a.$P_0||!a.$P_0.parentNode){RTE.SnapshotManager.$5j(b,e);return}if(e!==-1&&a.$1n_0!==e){c.push(a);return}var d=RTE.Snapshot.$8Y(a.$P_0);d.$1T_0=RTE.SnapshotManager.$8n(a.$P_0,d,b?a:null);!RTE.SnapshotManager.$3F(f,a.$P_0)&&RTE.SnapshotManager.$7L(!b,d,false);if(RTE.SnapshotManager.$7l(a,d,b)&&c.$13_0>0){RTE.SnapshotManager.$5Y(a.$P_0,a.$1T_0);RTE.SnapshotManager.$7L(!b,a,false);RTE.SnapshotManager.$5j(b,a.$1n_0);return}RTE.SnapshotManager.clearRegionDirty(a.$P_0);RTE.SnapshotManager.$7L(true,a,false);RTE.CanvasEvents.unRegisterListener("EditableRegionChanged",RTE.SnapshotManager.$4j);a.$9Z_0();RTE.CanvasEvents.registerListener("EditableRegionChanged",RTE.SnapshotManager.$4j);a.$1n_0!==-1&&RTE.SnapshotManager.$5j(b,a.$1n_0)};RTE.SnapshotManager.$Im=function(d){ULSNVe:;for(var b=[],a=d.$13_0-1;a>=0;a--){var c=d.getItemAt(a);if(Array.contains(b,c.$P_0))return true;Array.add(b,c.$P_0)}return false};RTE.SnapshotManager.$Ju=function(){ULSNVe:;RTE.CanvasEvents.unRegisterListener("EditableRegionChanged",RTE.SnapshotManager.$4j);RTE.SnapshotManager.$78=false;RTE.SnapshotManager.clearRedo()};RTE.SnapshotManager.$7L=function(d,a,f){ULSNVe:;var c=d?RTE.SnapshotManager.$1U:RTE.SnapshotManager.$3Q,b=RTE.SnapshotManager.$3F(c,a.$P_0);if(!RTE.SnapshotManager.$7l(b,a,d)){f&&RTE.CanvasEvents.dispatchChangedOnEditableRegion(a.$P_0);c.push(a);RTE.DirtyBitManager.$BG()}else{var e=RTE.SnapshotManager.$L2(c,a.$P_0);if(b&&RTE.SnapshotManager.$7l(e,b,d))b.$8F_0(a);else if(b&&!e&&a.$1n_0===-1)b.$8F_0(a);else c.push(a)}RTE.SnapshotManager.$Am()};RTE.SnapshotManager.get_undoEnabled=function(){ULSNVe:;if(RTE.SnapshotManager.$3W)return true;RTE.SnapshotManager.$3W=RTE.SnapshotManager.$In();if(RTE.SnapshotManager.$3W)return true;RTE.SnapshotManager.$Ka();return false};RTE.SnapshotManager.$In=function(){ULSNVe:;var a=RTE.Canvas.currentEditableRegion();return a?!!RTE.SnapshotManager.$3F(RTE.SnapshotManager.$1U,a)&&RTE.SnapshotManager.$1y(a):false};RTE.SnapshotManager.$Ka=function(){ULSNVe:;if(!RTE.SnapshotManager.$79){RTE.CanvasEvents.registerListener("EditableRegionChanged",RTE.SnapshotManager.$8G);RTE.SnapshotManager.$79=true}};RTE.SnapshotManager.$Jv=function(){ULSNVe:;var a=RTE.SnapshotManager.get_undoEnabled();if(a){RTE.CanvasEvents.unRegisterListener("EditableRegionChanged",RTE.SnapshotManager.$8G);RTE.SnapshotManager.$79=false;RTE.Canvas.$O()}};RTE.SnapshotManager.$3F=function(d,b){ULSNVe:;b=RTE.Canvas.$35(b);for(var a=d.$13_0-1;a>=0;a--){var c=d.getItemAt(a);if(c.$P_0===b)return c}return null};RTE.SnapshotManager.$Ja=function(a){ULSNVe:;return a.$13_0>0?a.getItemAt(a.$13_0-1):null};RTE.SnapshotManager.$L2=function(d,e){ULSNVe:;for(var b=false,a=d.$13_0-1;a>=0;a--){var c=d.getItemAt(a);if(c.$P_0===e)if(!b)b=true;else return c}return null};RTE.SnapshotManager.clearRedo=function(){ULSNVe:;RTE.SnapshotManager.$3Q=new RTE.CircularArray(200);RTE.Canvas.$O()};RTE.SnapshotManager.getMarkers=function(){ULSNVe:;var b=$get("ms-rterangecursor-start"),c=$get("ms-rterangecursor-end"),a=[];a[0]=b;a[1]=c;return a};RTE.SnapshotManager.clear=function(){ULSNVe:;RTE.SnapshotManager.$1U=new RTE.CircularArray(200);RTE.SnapshotManager.clearRedo()};RTE.SnapshotManager.$1y=function(a){ULSNVe:;return RTE.SnapshotManager.$8n(a,null,null)};RTE.SnapshotManager.$8n=function(a,c,d){ULSNVe:;a=RTE.Canvas.$35(a);if(!a)return false;if(RTE.SnapshotManager.$54===a)return true;var b=a.getAttribute("RteDirty")==="true";if(!b){d=d||RTE.SnapshotManager.$3F(RTE.SnapshotManager.$1U,a);if(!d)b=true;else{c=c||RTE.Snapshot.$8Y(a);if(c)b=d.get_$DR_0()!==c.get_$DR_0()}RTE.SnapshotManager.setRegionDirtyIf(b,a)}if(b)RTE.SnapshotManager.$54=a;return b};RTE.SnapshotManager.$5Y=function(a,b){ULSNVe:;a.setAttribute("RteDirty",b?"true":"false");RTE.SnapshotManager.$54=b?a:null};RTE.SnapshotManager.setCurrentRegionDirty=function(){ULSNVe:;RTE.SnapshotManager.setRegionDirty(RTE.Canvas.currentEditableRegion())};RTE.SnapshotManager.setCurrentRegionDirtyIf=function(a){ULSNVe:;RTE.SnapshotManager.setRegionDirtyIf(a,RTE.Canvas.currentEditableRegion())};RTE.SnapshotManager.setRegionDirty=function(a){ULSNVe:;a=RTE.Canvas.$35(a);if(a&&a!==RTE.SnapshotManager.$54){RTE.SnapshotManager.$5Y(a,true);RTE.SnapshotManager.$3Q.$13_0>0&&RTE.SnapshotManager.$3F(RTE.SnapshotManager.$1U,a)&&!RTE.PreviewManager.get_instance().get_hasPreview()&&RTE.SnapshotManager.clearRedo()}};RTE.SnapshotManager.setRegionDirtyIf=function(a,b){ULSNVe:;a&&RTE.SnapshotManager.setRegionDirty(b)};RTE.SnapshotManager.clearRegionDirty=function(a){ULSNVe:;a=RTE.Canvas.$35(a);a&&RTE.SnapshotManager.$5Y(a,false)};RTE.SPRichTextEditorComponentProvider=function(){ULSNVe:;this.$$d_$Fn_1=Function.createDelegate(this,this.$Fn_1);this.$$d_$Fk_1=Function.createDelegate(this,this.$Fk_1);this.$$d_$Fc_1=Function.createDelegate(this,this.$Fc_1);this.$$d_$Fb_1=Function.createDelegate(this,this.$Fb_1);this.$$d_$Fa_1=Function.createDelegate(this,this.$Fa_1);this.$$d_$FZ_1=Function.createDelegate(this,this.$FZ_1);this.$$d_$FY_1=Function.createDelegate(this,this.$FY_1);this.$$d_$Fm_1=Function.createDelegate(this,this.$Fm_1);this.$$d_$Ak_1=Function.createDelegate(this,this.$Ak_1);this.$$d_$Fl_1=Function.createDelegate(this,this.$Fl_1);this.$$d_$Aj_1=Function.createDelegate(this,this.$Aj_1);this.$$d_$FO_1=Function.createDelegate(this,this.$FO_1);this.$$d_$FR_1=Function.createDelegate(this,this.$FR_1);this.$$d_$Fj_1=Function.createDelegate(this,this.$Fj_1);this.$$d_$Ai_1=Function.createDelegate(this,this.$Ai_1);this.$$d_$Fi_1=Function.createDelegate(this,this.$Fi_1);this.$$d_$Fh_1=Function.createDelegate(this,this.$Fh_1);this.$$d_$Fg_1=Function.createDelegate(this,this.$Fg_1);this.$$d_$Ff_1=Function.createDelegate(this,this.$Ff_1);this.$$d_$Fe_1=Function.createDelegate(this,this.$Fe_1);this.$$d_$Fd_1=Function.createDelegate(this,this.$Fd_1);this.$$d_$Ah_1=Function.createDelegate(this,this.$Ah_1);this.$$d_$FX_1=Function.createDelegate(this,this.$FX_1);this.$$d_$FW_1=Function.createDelegate(this,this.$FW_1);this.$$d_$FV_1=Function.createDelegate(this,this.$FV_1);this.$$d_$FU_1=Function.createDelegate(this,this.$FU_1);this.$$d_$FT_1=Function.createDelegate(this,this.$FT_1);this.$$d_$FS_1=Function.createDelegate(this,this.$FS_1);this.$$d_$FQ_1=Function.createDelegate(this,this.$FQ_1);this.$$d_$FP_1=Function.createDelegate(this,this.$FP_1);this.$$d_$H3_1=Function.createDelegate(this,this.$H3_1);this.$$d_$Gu_1=Function.createDelegate(this,this.$Gu_1);this.$$d_$Gt_1=Function.createDelegate(this,this.$Gt_1);this.$$d_$Gq_1=Function.createDelegate(this,this.$Gq_1);this.$$d_$Gp_1=Function.createDelegate(this,this.$Gp_1);this.$$d_$Gr_1=Function.createDelegate(this,this.$Gr_1);this.$$d_$Gl_1=Function.createDelegate(this,this.$Gl_1);this.$$d_$Gk_1=Function.createDelegate(this,this.$Gk_1);this.$$d_$Gj_1=Function.createDelegate(this,this.$Gj_1);this.$$d_$Gn_1=Function.createDelegate(this,this.$Gn_1);this.$$d_$Gs_1=Function.createDelegate(this,this.$Gs_1);this.$$d_$Go_1=Function.createDelegate(this,this.$Go_1);this.$$d_$Gm_1=Function.createDelegate(this,this.$Gm_1);this.$$d_$Gi_1=Function.createDelegate(this,this.$Gi_1);this.$$d_$Gh_1=Function.createDelegate(this,this.$Gh_1);this.$$d_$Gg_1=Function.createDelegate(this,this.$Gg_1);this.$$d_$Gf_1=Function.createDelegate(this,this.$Gf_1);this.$$d_$Ge_1=Function.createDelegate(this,this.$Ge_1);this.$$d_$Gd_1=Function.createDelegate(this,this.$Gd_1);this.$$d_$Gc_1=Function.createDelegate(this,this.$Gc_1);this.$$d_$Gb_1=Function.createDelegate(this,this.$Gb_1);this.$$d_$Ga_1=Function.createDelegate(this,this.$Ga_1);this.$$d_$GY_1=Function.createDelegate(this,this.$GY_1);this.$$d_$GZ_1=Function.createDelegate(this,this.$GZ_1);this.$$d_$GX_1=Function.createDelegate(this,this.$GX_1);this.$$d_$GW_1=Function.createDelegate(this,this.$GW_1);this.$$d_$GV_1=Function.createDelegate(this,this.$GV_1);this.$$d_$GS_1=Function.createDelegate(this,this.$GS_1);this.$$d_$GT_1=Function.createDelegate(this,this.$GT_1);this.$$d_$GU_1=Function.createDelegate(this,this.$GU_1);this.$$d_$GR_1=Function.createDelegate(this,this.$GR_1);this.$$d_$GQ_1=Function.createDelegate(this,this.$GQ_1);this.$$d_$GP_1=Function.createDelegate(this,this.$GP_1);this.$$d_$GO_1=Function.createDelegate(this,this.$GO_1);this.$$d_$GN_1=Function.createDelegate(this,this.$GN_1);this.$$d_$GM_1=Function.createDelegate(this,this.$GM_1);this.$$d_$GL_1=Function.createDelegate(this,this.$GL_1);this.$$d_$GK_1=Function.createDelegate(this,this.$GK_1);this.$$d_$GJ_1=Function.createDelegate(this,this.$GJ_1);this.$$d_$GI_1=Function.createDelegate(this,this.$GI_1);this.$$d_$GH_1=Function.createDelegate(this,this.$GH_1);this.$$d_$GG_1=Function.createDelegate(this,this.$GG_1);this.$$d_$H4_1=Function.createDelegate(this,this.$H4_1);this.$$d_$H2_1=Function.createDelegate(this,this.$H2_1);this.$$d_$H8_1=Function.createDelegate(this,this.$H8_1);this.$$d_$H7_1=Function.createDelegate(this,this.$H7_1);this.$$d_$H6_1=Function.createDelegate(this,this.$H6_1);this.$$d_$H5_1=Function.createDelegate(this,this.$H5_1);this.$$d_$H1_1=Function.createDelegate(this,this.$H1_1);this.$$d_$H0_1=Function.createDelegate(this,this.$H0_1);this.$$d_$Gz_1=Function.createDelegate(this,this.$Gz_1);this.$$d_$Gy_1=Function.createDelegate(this,this.$Gy_1);this.$$d_$Gx_1=Function.createDelegate(this,this.$Gx_1);this.$$d_$HB_1=Function.createDelegate(this,this.$HB_1);this.$$d_$Gw_1=Function.createDelegate(this,this.$Gw_1);this.$$d_$Au_1=Function.createDelegate(this,this.$Au_1);this.$$d_$HG_1=Function.createDelegate(this,this.$HG_1);this.$$d_$H9_1=Function.createDelegate(this,this.$H9_1);this.$$d_$HD_1=Function.createDelegate(this,this.$HD_1);this.$$d_$GC_1=Function.createDelegate(this,this.$GC_1);this.$$d_$HR_1=Function.createDelegate(this,this.$HR_1);this.$$d_$HQ_1=Function.createDelegate(this,this.$HQ_1);this.$$d_$HM_1=Function.createDelegate(this,this.$HM_1);this.$$d_$HL_1=Function.createDelegate(this,this.$HL_1);this.$$d_$HF_1=Function.createDelegate(this,this.$HF_1);this.$$d_$HI_1=Function.createDelegate(this,this.$HI_1);this.$$d_$HP_1=Function.createDelegate(this,this.$HP_1);this.$$d_$HO_1=Function.createDelegate(this,this.$HO_1);this.$$d_$HN_1=Function.createDelegate(this,this.$HN_1);this.$$d_$HE_1=Function.createDelegate(this,this.$HE_1);this.$$d_$HC_1=Function.createDelegate(this,this.$HC_1);this.$$d_$HA_1=Function.createDelegate(this,this.$HA_1);this.$$d_$Gv_1=Function.createDelegate(this,this.$Gv_1);this.$$d_$G5_1=Function.createDelegate(this,this.$G5_1);this.$$d_$HK_1=Function.createDelegate(this,this.$HK_1);this.$$d_$G0_1=Function.createDelegate(this,this.$G0_1);this.$$d_$GE_1=Function.createDelegate(this,this.$GE_1);this.$$d_$GD_1=Function.createDelegate(this,this.$GD_1);this.$$d_$HJ_1=Function.createDelegate(this,this.$HJ_1);this.$$d_$GB_1=Function.createDelegate(this,this.$GB_1);this.$$d_$G9_1=Function.createDelegate(this,this.$G9_1);this.$$d_$G8_1=Function.createDelegate(this,this.$G8_1);this.$$d_$G7_1=Function.createDelegate(this,this.$G7_1);this.$$d_$G4_1=Function.createDelegate(this,this.$G4_1);this.$$d_$G3_1=Function.createDelegate(this,this.$G3_1);this.$$d_$Fv_1=Function.createDelegate(this,this.$Fv_1);this.$$d_$G2_1=Function.createDelegate(this,this.$G2_1);this.$$d_$G1_1=Function.createDelegate(this,this.$G1_1);this.$$d_$G6_1=Function.createDelegate(this,this.$G6_1);this.$$d_$HH_1=Function.createDelegate(this,this.$HH_1);this.$$d_$GA_1=Function.createDelegate(this,this.$GA_1);this.$$d_$Fy_1=Function.createDelegate(this,this.$Fy_1);this.$$d_$Fz_1=Function.createDelegate(this,this.$Fz_1);this.$$d_$GF_1=Function.createDelegate(this,this.$GF_1);this.$$d_$Fx_1=Function.createDelegate(this,this.$Fx_1);this.$$d_$Fw_1=Function.createDelegate(this,this.$Fw_1);this.$$d_$Fu_1=Function.createDelegate(this,this.$Fu_1);this.$6R_1={};this.$74_1={};this.$7W_1={};this.$9z_1={};this.$6d_1={};this.$63_1={};this.$5u_1={};RTE.SPRichTextEditorComponentProvider.initializeBase(this)};RTE.SPRichTextEditorComponentProvider.$Jk=function(a,g){ULSNVe:;for(var f=(g+"P").toLowerCase(),b=null,d=0;d<a.length;d++)if(a[d].$7N_0.endsWith(f)){b=a[d];break}if(!b)return a;var c=new Array(0);c[0]=b;for(var e=0;e<a.length;e++)if(b!==a[e])c[c.length]=a[e];return c};RTE.SPRichTextEditorComponentProvider.$3g=function(a){ULSNVe:;return a.endsWith("Preview")?1:a.endsWith("Revert")?2:0};RTE.SPRichTextEditorComponentProvider.$Dp=function(c){ULSNVe:;var b=RTE.StyleRuleUtility.$C4(c),d=RTE.StyleRuleUtility.$Bs(c);if(!b)return true;var e=RTE.StyleRuleUtility.$2c(b),f=RTE.StyleRuleUtility.$6I(b),a=RTE.FontCommands.$If();return!!a&&a.tagName.toUpperCase()===f.toUpperCase()&&(d&&(!a.className||!a.className.length)||RTE.RteUtility.$6M(a,e))};RTE.SPRichTextEditorComponentProvider.prototype={$9M_1:null,$Cz_1:null,$D0_1:null,$0_1:null,$9_1:null,$57_1:null,init:function(){ULSNVe:;this.$Cz_1=["ClipboardGroup","MarkupGroup","CommandContextChanged","EditingToolsContextualGroup","CPEditTab","EditingGroup","EmbedGroup","ElementWithStyleOptions","ExistingDataGroup","FontGroup","GetFontColorMenuXml","GetFontBackgroundColorMenuXml","GetFontFamilyMenuXml","GetFontSizeMenuXml","GetImageStyleMenuXml","GetPositionMenuXml","GetSelectElementMenuXml","GetTableStyleMenuXml","GetTextStyleMenuXml","GetLanguagesMenuXml","GetPasteMenuXml","HomeTab","ImageAltLabel","ImageArrangeGroup","ImageArrange","ImageContextualGroup","ImageEditGroup","ImageHorizontalLabel","ImagePropertyGroup","ImageSizeGroup","ImageStyleGroup","ImageStyleOptions","ImageTab","ImageUrlLabel","ImageVerticalLabel","InsertDocumentOptions","InsertTab","InsertDocumentMenuClose","InsertDocumentMenuOpen","InsertImageMenuClose","InsertImageMenuOpen","InsertLinkMenuClose","InsertLinkMenuOpen","HtmlMenuOpen","LanguageLabel","HtmlLabel","SelectLabel","LinkAltLabel","LinkBehaviorGroup","LinkContextualGroup","LinkGroup","LinkUrlLabel","LinkPropertyGroup","LinkTab","LinksGroup","MediaGroup","NewListGroup","PageLayoutOptions","ParagraphGroup","PasteOption","PasteClose","PasteOpen","SelectElement","SelectTextStyle","TextStyleGroup","TableCellGroup","TableColumnWidthLabel","TableContextualGroup","TableDesignTab","TableHeightLabel","TableMiscGroup","TableLayoutTab","TableRowColumnGroup","TableRowHeightLabel","TableStyleGroup","TableStyleOptions","TableStyleOptionGroup","TableSummaryLabel","TableSummaryGroup","TableWidthHeightGroup","TableWidthLabel","TableDeleteOptions","TableMergeOptions","TableSplitOptions","TablesGroup","UndoClose","UndoOpen","WebPartsGroup","WikiGroup","SelectTextStyleOpen","SelectTextStyleClose","ElementWithStyleOptionsOpen","ElementWithStyleOptionsClose","SelectElementOpen","SelectElementClose","TableStyleOptionsOpen","TableStyleOptionsClose","ImageStyleOptionsOpen","ImageStyleOptionsClose","ImageArrangeMenuOpen","ImageArrangeMenuClose","FontFamilyStyleOpen","FontFamilyStyleClose","FontSizeStyleOpen","FontSizeStyleClose","SelectBackgroundColorOpen","SelectBackgroundColorClose","SelectFontColorOpen","SelectFontColorClose","AlignLeft","AlignCenter","AlignRight","AlignJustify","BackgroundColorCssClass","BackgroundColorCssClassPreview","BackgroundColorThemeClass","BackgroundColorThemeClassPreview","BackgroundColorCustom","Bold","BulletedList","ClearFormatting","Copy","ColorCssClass","ColorCssClassPreview","ColorThemeClass","ColorThemeClassPreview","ColorCustom","Cut","DecreaseIndent","DeleteCell","DeleteRow","DeleteColumn","DeleteTable","EditSource","EditImage","EditImageUpload","EditImageWeb","ElementWithStyle","ElementWithStylePreview","FontFamilyCssClass","FontFamilyCssClassPreview","FontFamilyThemeClass","FontFamilyThemeClassPreview","FontFamilyStyleValue","FontSizeCssClass","FontSizeCssClassPreview","FontSizeStyleValue","ImageAlt","ImageClearStyle","ImageEdit","ImagePosition","ImagePositionPreview","ImageHeight","ImageLockRatio","ImageSrc","ImageStyle","ImageStylePreview","ImageWidth","IncreaseIndent","InsertEmbedding","InsertLink","InsertLinkWeb","InsertList","InsertNewList","InsertImage","InsertImageUpload","InsertImageWeb","InsertTable","InsertTableMenu","InsertTableDialog","InsertRowAbove","InsertRowBelow","InsertColumnLeft","InsertColumnRight","Italics","LeftToRight","LinkDisplayIcon","LinkEditWeb","LinkInNewTab","LinkTitleChanged","LinkUrlChanged","LinkRemove","LayoutOneColumn","LayoutOneColumnSidebar","LayoutThreeColumn","LayoutThreeColumnHeader","LayoutThreeColumnHeaderFooter","LayoutTwoColumn","LayoutTwoColumnHeader","LayoutTwoColumnHeaderFooter","MakeXhtml","MergeCellAbove","MergeCellBelow","MergeCellLeft","MergeCellRight","MergeCells","NumberedList","Paste","PasteDefault","QueryAlignCenter","QueryAlignJustify","QueryAlignLeft","QueryAlignRight","QueryBold","QueryBulletedList","QueryElementWithStyle","QueryFontFamily","QueryFontSize","QueryImageAlt","QueryImageLockRatio","QueryImageHeight","QueryImageSrc","QueryImageStyle","QueryImageWidth","QueryItalics","QueryLanguage","QueryLeftToRight","QueryLinkBookmark","QueryLinkDisplayIcon","QueryLinkInNewTab","QueryLinkTitle","QueryLinkUrl","QueryNumberedList","QueryRightToLeft","QueryStrikeThrough","QuerySubscript","QuerySuperscript","QueryTableColumnWidth","QueryTableHeight","QueryTableRowHeight","QueryTableWidth","QueryTableFirstColumn","QueryTableFooterRow","QueryTableHeadingRow","QueryTableLastColumn","QueryTableViewGridlines","QueryTableStyle","QueryTableSummary","QueryTextStyle","QueryUnderline","Redo","RemoveStyles","RightToLeft","SelectAll","SelectBackgroundColor","SelectFontColor","SelectFont","SelectFontSize","SelectMenuItem","SelectMenuItemPreview","SetLanguage","SetTableWidth","SetTableHeight","SetTableRowHeight","SetTableColumnWidth","SplitHorizontal","SplitVertical","StrikeThrough","TableFirstColumn","TableFooterRow","TableHeadingRow","TableLastColumn","TableClearFormatting","TableStyle","TableStylePreview","TableSummary","TableViewGridlines","TextStyle","TextStylePreview","Subscript","Superscript","Underline","Undo","UploadDocumentRTE","InsertWebPart","ServerButton","ServerQueryButton","ApplyLiveGalleryStyle","ApplyLiveGalleryStylePreview","ApplyLiveGalleryStylePreviewRevert","QueryLiveGalleryStyle"];this.$D0_1=["CopyPageAddress"]},getFocusedCommands:function(){ULSNVe:;return this.$Cz_1},getGlobalCommands:function(){ULSNVe:;return this.$D0_1},$J2_1:function(){ULSNVe:;return this.$8R_1(false).gallery},$J3_1:function(a){ULSNVe:;var b=null;try{if(a>=0&&a<5){var c=this.$8R_1(true);if(!c)b="<img src='"+SP.Utilities.Utility.get_layoutsLatestVersionUrl()+"/images/loadingcirclests16.gif'/>";else if(c.ribbonButtons.length>a)b=c.ribbonButtons[a].preview}}catch(d){}return b||RTE.RteRibbonBuilder.$Bv()},$JR_1:function(c){ULSNVe:;var b=false,a=this.$C6_1(c);if(a&&a.commandValueId&&a.commandValueId.length>0)if(a.isElementStyle)b=RTE.SPRichTextEditorComponentProvider.$Dp(a.commandValueId);else b=this.$Dq_1(a.commandValueId);return b},$C6_1:function(a){ULSNVe:;try{if(a>=0&&a<5){var b=this.$8R_1(true);if(b.ribbonButtons.length>a)return b.ribbonButtons[a]}}catch(c){}return null},$8R_1:function(f){ULSNVe:;var a=RTE.Canvas.getCurrentStyleSheetPrefix(),d=RTE.Canvas.currentEditableRegion(),b=this.$9z_1[a+d.id];if(!b){var e=a+"Element-",c=RTE.StyleRuleUtility.getStyleRules(e,a,f);if(!f||c.length>0){c=RTE.SPRichTextEditorComponentProvider.$Jk(c,e);var g=RTE.StyleRuleUtility.getStyleRules(a+"Style",a,false),h=RTE.RichTextEditorComponentProvider.get_latestProvider().canHandleCommand("ElementWithStyle"),i=RTE.RichTextEditorComponentProvider.get_latestProvider().canHandleCommand("TextStyle");b=RTE.RteRibbonBuilder.$FK(i?g:null,h?c:null);this.$9z_1[a+d.id]=b}}return b},$Iw_1:function(){ULSNVe:;var a=RTE.Canvas.getCurrentStyleSheetPrefix();if(!this.$63_1[a])this.$63_1[a]=RTE.FontCommands.initFontColorMenu();return this.$63_1[a]},$Iv_1:function(){ULSNVe:;var a=RTE.Canvas.getCurrentStyleSheetPrefix();if(!this.$5u_1[a])this.$5u_1[a]=RTE.FontCommands.initFontBackgroundColorMenu();return this.$5u_1[a]},$Iy_1:function(){ULSNVe:;RTE.RteUtility.classMustExist("CUI.JsonXmlElement");var a=RTE.Canvas.getCurrentStyleSheetPrefix();if(!this.$6R_1[a]){var b=RTE.StyleRuleUtility.getStyleRules(a+RTE.RichTextEditor.$38,a,false);this.$6R_1[a]=RTE.RteRibbonBuilder.$Ad(b,"Ribbon.Image.Image.Styles.ImageStyles.Menu","Ribbon.Image.Image.Styles.ImageStyles.Menu.Styles","ImageStyle","ImageStyle","ImageStylePreview","ImageStylePreviewRevert","QueryImageStyle",a+RTE.RichTextEditor.$38)}return this.$6R_1[a]},$J0_1:function(){ULSNVe:;RTE.RteUtility.classMustExist("CUI.JsonXmlElement");var a=RTE.Canvas.getCurrentStyleSheetPrefix();if(!this.$74_1[a]){for(var f=RTE.StyleRuleUtility.getStyleRules(a+RTE.RichTextEditor.$5Q,a,false),g=false,h=false,c=new CUI.JsonXmlElement("Menu",{Id:"Ribbon.Image.Position.Menu"}),i=new CUI.JsonXmlElement("Controls",{Id:"Ribbon.Image.Position.Menu.Floatcontrols"}),j=new CUI.JsonXmlElement("Controls",{Id:"Ribbon.Image.Position.Menu.Inlinecontrols"}),b=0;b<f.length;b++){var d=f[b],e;if(d.rule.style.styleFloat!==""){g=true;e=i}else{h=true;e=j}var k=d.rule.selectorText,m=RTE.StyleRuleUtility.$36(k,a+RTE.RichTextEditor.$5Q+"-"),l=RTE.StyleRuleUtility.$2F(d,m,null);l&&e.appendChild("Button",{Id:"ImagePosition"+b.toString(),LabelText:l,CommandType:"General",CommandValueId:k,Command:"ImagePosition",CommandPreview:"ImagePositionPreview",CommandRevert:"ImagePositionPreviewRevert"})}g&&c.appendChild("MenuSection",{Id:"Ribbon.Image.Position.Menu.Float",Title:SP.Res.menuArrangeFloatTitle}).appendChildNode(i);h&&c.appendChild("MenuSection",{Id:"Ribbon.Image.Position.Menu.Inline",Title:SP.Res.menuArrangeInlineTitle}).appendChildNode(j);this.$74_1[a]=c}return this.$74_1[a]},$J4_1:function(){ULSNVe:;RTE.RteUtility.classMustExist("CUI.JsonXmlElement");var a=RTE.Canvas.getCurrentStyleSheetPrefix();if(!this.$7W_1[a]){var b=RTE.StyleRuleUtility.getStyleRules(a+"Table-",a,false);this.$7W_1[a]=RTE.RteRibbonBuilder.$Ad(b,"Ribbon.Table.Design.Style.TableStyles.Menu","Ribbon.Table.Design.Styles.TableStyles.Menu.TableStyles","TableStyle","TableStyle","TableStylePreview","TableStylePreviewRevert","QueryTableStyle",a+"Table")}return this.$7W_1[a]},$Iz_1:function(){ULSNVe:;RTE.RteUtility.classMustExist("CUI.JsonXmlElement");var a=RTE.Canvas.getCurrentStyleSheetPrefix();if(!this.$6d_1[a]){for(var c=RTE.StyleRuleUtility.getStyleRules(a+RTE.RichTextEditor.$6c,a,false),d=new CUI.JsonXmlElement("Menu",{Id:"Ribbon.EditingTools.CPEditTab.Html.Languages.Menu"}),h=d.appendChild("MenuSection",{Id:"Ribbon.EditingTools.CPEditTab.Html.Languages.Menu.Languages"}).appendChild("Controls",{Id:"Ribbon.EditingTools.CPEditTab.Html.Languages.Menu.Languagescontrols"}),b=0;b<c.length;b++){var e=c[b],i=e.rule.selectorText,f=RTE.StyleRuleUtility.$36(i,a+RTE.RichTextEditor.$6c+"-"),g=RTE.StyleRuleUtility.$2F(e,f,null);g&&h.appendChild("Button",{Id:"Ribbon.EditingTools.CPEditTab.Html.Languages.Menu.Languages"+b.toString(),LabelText:g,CommandType:"OptionSelection",CommandValueId:f,Command:"SetLanguage",QueryCommand:"QueryLanguage"})}this.$6d_1[a]=d}return this.$6d_1[a]},initPasteMenu:function(){ULSNVe:;RTE.RteUtility.classMustExist("CUI.JsonXmlElement");if(!this.$9M_1){for(var b=new CUI.JsonXmlElement("Menu",{Id:"Ribbon.EditingTools.CPEditTab.Clipboard.Paste.Menu"}),f=b.appendChild("MenuSection",{Id:"Ribbon.EditingTools.CPEditTab.Clipboard.Paste.Menu.PasteModes",DisplayMode:"Menu16"}).appendChild("Controls",{Id:"Ribbon.EditingTools.CPEditTab.Clipboard.Paste.Menu.PasteModescontrols"}),c=RTE.RtePasteManager.get_pasteModes(),a=0;a<c.length;a++){var d=c[a],e={Id:"Ribbon.EditingTools.CPEditTab.Html.Languages.Menu.Languages"+a,CommandValueId:d.id,Command:"Paste"};d.appendRibbonButtonProperties(e);f.appendChild("Button",e)}this.$9M_1=b}return this.$9M_1},canHandleCommand:function(c){ULSNVe:;var a=RTE.Canvas.currentEditableRegion();if(!a)return false;if(RTE.Canvas.getCachedRestriction(a,"DisableRibbonCommands",false))return false;this.initializeCanHandleHandlerDictionary();var b=this.$9_1[c];if(!RTE.SU.$7(b)){var d=b;return d()}return this.$K3_1(c)},$K3_1:function(b){ULSNVe:;this.initializeAllCommandsDictionary();var a=this.$57_1[b];return!RTE.SU.$7(a)},$76_1:0,$75_1:null,$Ag_1:function(){ULSNVe:;if(this.$76_1){this.$75_1=null;window.clearTimeout(this.$76_1)}},handleCommand:function(b,g,h){ULSNVe:;RTE.RteUtility.assertNotNull("commandId",b);var d=RTE.Canvas.currentEditableRegion();if(!d)return false;if(RTE.Canvas.getCachedRestriction(d,"DisableRibbonCommands",false))return false;this.initializeCommandHandlerDictionary();var e=this.$0_1[b];if(!RTE.SU.$7(e)){var f=e;this.$Ag_1();if(RTE.PreviewManager.get_instance().get_hasPreview()&&RTE.SPRichTextEditorComponentProvider.$3g(b)===1){var a=new RTE.RteRibbonCommand;a.$CA_0=f;a.$Ax_0=b;a.$Do_0=g;a.$EA_0=h;this.$75_1=a;var c=this;this.$76_1=window.setTimeout(function(){ULSNVe:;c.$76_1=0;var a=c.$75_1;c.$75_1=null;a&&a.$CA_0(a.$Ax_0,a.$Do_0,a.$EA_0)},100);return true}return f(b,g,h)}return true},isFocusable:function(){ULSNVe:;return true},receiveFocus:function(){ULSNVe:;return true},yieldFocus:function(){ULSNVe:;return true},$Fu_1:function(a){ULSNVe:;switch(a){case"AlignCenter":RTE.RichTextEditor.align(2);break;case"AlignJustify":RTE.RichTextEditor.align(3);break;case"AlignLeft":RTE.RichTextEditor.align(0);break;case"AlignRight":RTE.RichTextEditor.align(1)}return true},$Fw_1:function(a,b,c){ULSNVe:;return this.$As_1(a,b,c,"BackgroundColorCustom",RTE.RichTextEditor.setBackgroundColorCustom,RTE.RichTextEditor.setBackgroundColorCssClass)},$Fz_1:function(a,b,c){ULSNVe:;return this.$As_1(a,b,c,"ColorCustom",RTE.RichTextEditor.setColorCustom,RTE.RichTextEditor.setColorCssClass)},$As_1:function(b,c,g,d,e,f){ULSNVe:;if(b===d)e();else{var a=c.Style;if(a===RTE.PreviewManager.get_instance().$1H_0)return true;RTE.PreviewManager.get_instance().restoreBeginState();RTE.PreviewManager.get_instance().$1H_0=a;f(a);RTE.PreviewManager.get_instance().commitCommandOrAfterPreview(b)}return true},$Fx_1:function(a){ULSNVe:;switch(a){case"Bold":RTE.RichTextEditor.bold();break;case"ClearFormatting":RTE.RichTextEditor.clearFormatting();break;case"Italics":RTE.RichTextEditor.italic();break;case"Subscript":RTE.RichTextEditor.subscript();break;case"Superscript":RTE.RichTextEditor.superscript();break;case"StrikeThrough":RTE.RichTextEditor.strikeThrough();break;case"Underline":RTE.RichTextEditor.underline()}return true},$Fy_1:function(b,c){ULSNVe:;switch(b){case"Copy":RTE.RichTextEditor.copy();break;case"Cut":RTE.RichTextEditor.cut();break;case"Paste":var a=c.CommandValueId;RTE.RichTextEditor.paste(a);break;case"PasteDefault":RTE.RichTextEditor.paste(null)}return true},$G0_1:function(a){ULSNVe:;switch(a){case"LeftToRight":RTE.RichTextEditor.setDirection(true);break;case"RightToLeft":RTE.RichTextEditor.setDirection(false)}return true},$G1_1:function(a){ULSNVe:;switch(a){case"EditImageUpload":RTE.RichTextEditor.insertHtmlFromDialog("Upload.aspx","UploadImage",false);break;case"EditImageWeb":RTE.RichTextEditor.insertImage(true)}return true},$4D_1:0,$8i_1:false,$7F_1:null,$Fv_1:function(c,f){ULSNVe:;var d=f.SourceControlId,e=RTE.RteRibbonBuilder.parseRibbonStyleButtonIndex(d),a=this.$C6_1(e);if(a&&a.commandValueId&&a.commandValueId.length>0){var b=RTE.SPRichTextEditorComponentProvider.$3g(c);if(!RTE.PreviewManager.get_instance().get_hasPreview()&&b===1&&this.$8i_1)return true;if(this.$4D_1>0){window.clearTimeout(this.$4D_1);this.$4D_1=0;this.$7F_1=null}!RTE.PreviewManager.get_instance().get_hasPreview()&&b===1&&RTE.PreviewManager.get_instance().beginPreview();if(a.isElementStyle)this.$BN_1(c,a.commandValueId);else this.$EY_1(c,a.commandValueId);if(!b){RTE.Cursor.update();this.$8i_1=true}}return true},$G2_1:function(b,c){ULSNVe:;var a=c.CommandValueId;return this.$BN_1(b,a)},$BN_1:function(g,e){ULSNVe:;var a=RTE.StyleRuleUtility.$C4(e),f=RTE.StyleRuleUtility.$Bs(e);if(!a)return true;var b=RTE.StyleRuleUtility.$6I(a),c=!f?RTE.StyleRuleUtility.$2c(a):null,d=b+c;if(d!==RTE.PreviewManager.get_instance().$1H_0){RTE.PreviewManager.get_instance().restoreBeginState();RTE.PreviewManager.get_instance().$1H_0=d;RTE.FontCommands.$B6(b,c)}RTE.PreviewManager.get_instance().commitCommandOrAfterPreview(g)&&RTE.Canvas.$O();return true},$G3_1:function(a,b,c){ULSNVe:;return this.$At_1(a,b,c,RTE.RichTextEditor.setFontFamilyCssClass,RTE.RichTextEditor.setFontFamilyStyleValue)},$G4_1:function(a,b,c){ULSNVe:;return this.$At_1(a,b,c,RTE.RichTextEditor.setFontSizeCssClass,RTE.RichTextEditor.setFontSizeStyleValue)},$At_1:function(d,c,g,e,f){ULSNVe:;var a=c.CommandValueId;if(!RTE.SU.$2(a)){if(a===RTE.PreviewManager.get_instance().$1H_0)return true;RTE.PreviewManager.get_instance().restoreBeginState();RTE.PreviewManager.get_instance().$1H_0=a;e(a)}else{var b=c.Value;!RTE.SU.$2(b)&&f(b)}RTE.PreviewManager.get_instance().commitCommandOrAfterPreview(d)&&RTE.Canvas.$O();return true},$G5_1:function(a){ULSNVe:;switch(a){case"Redo":RTE.RichTextEditor.redo();break;case"Undo":RTE.RichTextEditor.undo()}return true},$G6_1:function(a){ULSNVe:;switch(a){case"EditSource":RTE.RichTextEditor.editSource();break;case"MakeXhtml":RTE.RichTextEditor.makeXhtml()}return true},$G7_1:function(e,a){ULSNVe:;switch(e){case"ImageAlt":var b=a.Value;RTE.RichTextEditor.setImageAlt(b);break;case"ImageClearStyle":RTE.RichTextEditor.clearImageStyle();break;case"ImageHeight":RTE.RichTextEditor.setImageHeight(RTE.RteUtility.$8c(a),RTE.RteUtility.$8b(a));break;case"ImageLockRatio":var c=a.On;RTE.RichTextEditor.setImageLockRatio(c);break;case"ImageSrc":var d=a.Value;RTE.RichTextEditor.setImageSrc(d);break;case"ImageWidth":RTE.RichTextEditor.setImageWidth(RTE.RteUtility.$8c(a),RTE.RteUtility.$8b(a))}return true},$G8_1:function(a,b,c){ULSNVe:;return this.$8A_1(a,b,c,RTE.RichTextEditor.$5Q,RTE.RichTextEditor.setImagePosition,true)},$G9_1:function(a,b,c){ULSNVe:;return this.$8A_1(a,b,c,RTE.RichTextEditor.$38,RTE.RichTextEditor.setImageStyle,true)},$HN_1:function(a,b,c){ULSNVe:;return this.$8A_1(a,b,c,"Table",RTE.RichTextEditor.setTableStyle,true)},$HP_1:function(b,c){ULSNVe:;var a=c.CommandValueId;return this.$EY_1(b,a)},$EY_1:function(a,b){ULSNVe:;return this.$Aw_1(a,b,"Style",RTE.FontCommands.$LF,true)},$8A_1:function(b,c,g,d,e,f){ULSNVe:;var a=c.CommandValueId;return this.$Aw_1(b,a,d,e,f)},$Aw_1:function(c,a,d,e,f){ULSNVe:;RTE.RteUtility.classMustExist("CUI.Controls.GalleryButtonCommandProperties");if(!a)return true;if(RTE.PreviewManager.get_instance().$1H_0===a)return true;RTE.PreviewManager.get_instance().$1H_0=a;f&&RTE.PreviewManager.get_instance().restoreBeginState();var b=RTE.StyleRuleUtility.$36(a,d+"-");e(b,true);RTE.PreviewManager.get_instance().commitCommandOrAfterPreview(c);return true},$GA_1:function(a){ULSNVe:;switch(a){case"DecreaseIndent":RTE.RichTextEditor.decreaseIndent();break;case"IncreaseIndent":RTE.RichTextEditor.increaseIndent()}return true},$GB_1:function(a){ULSNVe:;switch(a){case"InsertImageUpload":case"InsertImage":RTE.RichTextEditor.insertHtmlFromDialog("Upload.aspx","UploadImage",false);break;case"InsertImageWeb":RTE.RichTextEditor.insertImage(false);break;case"InsertLinkWeb":case"InsertLink":RTE.RichTextEditor.insertLink();break;case"InsertList":RTE.WebPartCommands.insertWebPart("insertExistingList");break;case"InsertNewList":RTE.RichTextEditor.insertNewList()}return true},$GD_1:function(a){ULSNVe:;switch(a){case"LayoutOneColumn":RTE.RichTextEditor.relayout(1,false,false,false);break;case"LayoutOneColumnSidebar":RTE.RichTextEditor.relayout(2,false,false,true);break;case"LayoutTwoColumn":RTE.RichTextEditor.relayout(2,false,false,false);break;case"LayoutTwoColumnHeader":RTE.RichTextEditor.relayout(2,true,false,false);break;case"LayoutTwoColumnHeaderFooter":RTE.RichTextEditor.relayout(2,true,true,false);break;case"LayoutThreeColumn":RTE.RichTextEditor.relayout(3,false,false,false);break;case"LayoutThreeColumnHeader":RTE.RichTextEditor.relayout(3,true,false,false);break;case"LayoutThreeColumnHeaderFooter":RTE.RichTextEditor.relayout(3,true,true,false)}return true},$GE_1:function(b,a){ULSNVe:;RTE.RteUtility.classMustExist("CUI.Controls.ToggleButtonCommandProperties");RTE.RteUtility.classMustExist("CUI.Controls.TextBoxCommandProperties");switch(b){case"LinkDisplayIcon":RTE.RichTextEditor.setLinkDisplayIcon(a[CUI.Controls.ToggleButtonCommandProperties.On]);break;case"LinkEditWeb":RTE.RichTextEditor.insertLink();break;case"LinkInNewTab":RTE.RichTextEditor.setLinkOpenInNewWindow(a[CUI.Controls.ToggleButtonCommandProperties.On]);break;case"LinkRemove":RTE.RichTextEditor.removeLink();break;case"LinkTitleChanged":RTE.RichTextEditor.setLinkTitle(a[CUI.Controls.TextBoxCommandProperties.Value]);break;case"LinkUrlChanged":RTE.RichTextEditor.setLinkUrl(a[CUI.Controls.TextBoxCommandProperties.Value])}return true},$GF_1:function(a){ULSNVe:;switch(a){case"BulletedList":RTE.RichTextEditor.bulletedList();break;case"NumberedList":RTE.RichTextEditor.numberedList()}return true},$Gv_1:function(){ULSNVe:;RTE.RichTextEditor.removeStyles();RTE.Canvas.$O();return true},$HA_1:function(){ULSNVe:;RTE.RichTextEditor.selectAll();RTE.Canvas.$O();return true},$HC_1:function(b,c){ULSNVe:;var a=parseInt(c.CommandValueId);RTE.SelectionManager.selectParentElement(a,RTE.SPRichTextEditorComponentProvider.$3g(b));return true},$HE_1:function(d,c){ULSNVe:;var a=c.CommandValueId;if(!RTE.SU.$2(a))RTE.RichTextEditor.setLanguage(a);else{var b=c.Value;!RTE.SU.$2(b)&&RTE.RichTextEditor.setLanguage(b)}return true},$GW_1:function(b,a){ULSNVe:;a.IsFreeForm=true;a.Value=RTE.FontCommands.$IK();return true},$HD_1:function(b,a){ULSNVe:;RTE.RteUtility.classMustExist("CUI.RibbonComand");switch(b){case"ServerButton":a&&CUI.RibbonCommand.serverButton(a.SourceControlId,a.MenuItemId);break;case"ServerQueryButton":if(a)return CUI.RibbonCommand.serverQueryButton(a.SourceControlId)}return true},$HF_1:function(a){ULSNVe:;switch(a){case"SplitHorizontal":RTE.RichTextEditor.splitHorizontal();break;case"SplitVertical":RTE.RichTextEditor.splitVertical()}return true},$HH_1:function(a){ULSNVe:;switch(a){case"DeleteCell":RTE.RichTextEditor.deleteCell();break;case"DeleteColumn":RTE.RichTextEditor.deleteColumn();break;case"DeleteRow":RTE.RichTextEditor.deleteRow();break;case"DeleteTable":RTE.RichTextEditor.deleteTable()}return true},$HI_1:function(b,c){ULSNVe:;var a=RTE.RteUtility.getStringValueFromSpinnerControlProperties(c);switch(b){case"SetTableColumnWidth":RTE.RichTextEditor.setTableColumnWidth(a);break;case"SetTableHeight":RTE.RichTextEditor.setTableHeight(a);break;case"SetTableWidth":RTE.RichTextEditor.setTableWidth(a);break;case"SetTableRowHeight":RTE.RichTextEditor.setTableRowHeight(a)}RTE.Canvas.$O();return true},$HJ_1:function(b,c){ULSNVe:;switch(b){case"InsertTable":var d=c.Columns,e=c.Rows,a=new RTE.InsertTableOptions;a.columns=d;a.rows=e;a.commandType=RTE.SPRichTextEditorComponentProvider.$3g(b);RTE.RichTextEditor.insertTable(a);break;case"InsertTableDialog":RTE.RichTextEditor.showInsertTableDialog();break;case"InsertColumnLeft":RTE.RichTextEditor.insertColumn(true);break;case"InsertColumnRight":RTE.RichTextEditor.insertColumn(false);break;case"InsertRowAbove":RTE.RichTextEditor.insertRow(true);break;case"InsertRowBelow":RTE.RichTextEditor.insertRow(false)}return true},$HK_1:function(a){ULSNVe:;switch(a){case"MergeCellAbove":RTE.RichTextEditor.mergeAbove();break;case"MergeCellBelow":RTE.RichTextEditor.mergeBellow();break;case"MergeCells":RTE.RichTextEditor.mergeCells();break;case"MergeCellLeft":RTE.RichTextEditor.mergeLeft();break;case"MergeCellRight":RTE.RichTextEditor.mergeRight()}return true},$HL_1:function(a,b){ULSNVe:;RTE.RteUtility.classMustExist("CUI.Controls.ToggleButtonCommandProperties");switch(a){case"TableClearFormatting":RTE.RichTextEditor.clearTableStyle();break;case"TableViewGridlines":RTE.RichTextEditor.setTableGridLines(b[CUI.Controls.ToggleButtonCommandProperties.On])}return true},$HM_1:function(b,a){ULSNVe:;RTE.RteUtility.classMustExist("CUI.Controls.ToggleButtonCommandProperties");switch(b){case"TableFirstColumn":RTE.RichTextEditor.setTableFirstColumn(a[CUI.Controls.ToggleButtonCommandProperties.On]);break;case"TableFooterRow":RTE.RichTextEditor.setTableFooterRow(a[CUI.Controls.ToggleButtonCommandProperties.On]);break;case"TableHeadingRow":RTE.RichTextEditor.setTableHeaderRow(a[CUI.Controls.ToggleButtonCommandProperties.On]);break;case"TableLastColumn":RTE.RichTextEditor.setTableLastColumn(a[CUI.Controls.ToggleButtonCommandProperties.On])}return true},$HO_1:function(c,b){ULSNVe:;var a=b.Value;RTE.RichTextEditor.setTableSummary(a);return true},$HQ_1:function(){ULSNVe:;RTE.RichTextEditor.insertHtmlFromDialog("Upload.aspx","UploadDocument",false);return true},$HR_1:function(a){ULSNVe:;switch(a){case"InsertWebPart":RTE.WebPartCommands.insertWebPart(a)}return true},$GC_1:function(){ULSNVe:;RTE.EmbeddingCommands.launchEmbedDialog(null);return true},$Gx_1:function(c,b){ULSNVe:;var a=b;a.PopulationJSON=this.$Iv_1();return true},$Gy_1:function(c,b){ULSNVe:;var a=b;a.PopulationJSON=this.$Iw_1();return true},$H0_1:function(c,b){ULSNVe:;var a=b;a.PopulationJSON=RTE.FontCommands.initFontSizeDropDownMenu();return true},$Gz_1:function(c,b){ULSNVe:;var a=b;a.PopulationJSON=RTE.FontCommands.initFontFamilyDropDownMenu();return true},$H8_1:function(c,b){ULSNVe:;var a=b;a.PopulationXML=this.$J2_1();return true},$H3_1:function(e,a){ULSNVe:;var c=a,d=a.SourceControlId,b=RTE.RteRibbonBuilder.parseRibbonStyleButtonIndex(d);c.InnerHTML=this.$J3_1(b);a.On=this.$JR_1(b);return true},$H1_1:function(c,b){ULSNVe:;var a=b;a.PopulationJSON=this.$Iy_1();return true},$H5_1:function(c,b){ULSNVe:;var a=b;a.PopulationJSON=this.$J0_1();return true},$H6_1:function(c,b){ULSNVe:;var a=b;a.PopulationJSON=RTE.SelectionManager.$J1();return true},$H7_1:function(c,b){ULSNVe:;var a=b;a.PopulationJSON=this.$J4_1();return true},$H2_1:function(c,b){ULSNVe:;var a=b;a.PopulationJSON=this.$Iz_1();return true},$H4_1:function(c,b){ULSNVe:;var a=b;a.PopulationJSON=this.initPasteMenu();return true},$H9_1:function(c,b){ULSNVe:;RTE.RteUtility.classMustExist("CUI.CommandContextSwitchCommandProperties");var a=b;if(!a.ChangedByUser)return true;switch(a.NewContextCommand){case"TableDesignTab":case"TableLayoutTab":RTE.Cursor.select()}return true},$HG_1:function(){ULSNVe:;RTE.PreviewManager.get_instance().beginPreview();return true},$Au_1:function(){ULSNVe:;this.$Ag_1();var a=RTE.PreviewManager.get_instance().get_hasPreview();RTE.PreviewManager.get_instance().endPreview();a&&RTE.Canvas.$O();return true},$Gw_1:function(b,c,d){ULSNVe:;this.$8i_1=false;if(!this.$4D_1){var a=this;this.$4D_1=window.setTimeout(function(){ULSNVe:;a.$4D_1=0;a.$7F_1&&RTE.PreviewManager.get_instance().$1H_0===a.$7F_1&&a.$Au_1(b,c,d)},200)}this.$7F_1=RTE.PreviewManager.get_instance().get_hasPreview()?RTE.PreviewManager.get_instance().$1H_0:null;return true},$HB_1:function(){ULSNVe:;RTE.SelectionManager.$7C();return true},$GG_1:function(b,a){ULSNVe:;a.On=RTE.ParagraphCommands.queryAlign(2).get_commandOn();return true},$GH_1:function(b,a){ULSNVe:;a.On=RTE.ParagraphCommands.queryAlign(3).get_commandOn();return true},$GI_1:function(b,a){ULSNVe:;a.On=RTE.ParagraphCommands.queryAlign(0).get_commandOn();return true},$GJ_1:function(b,a){ULSNVe:;a.On=RTE.ParagraphCommands.queryAlign(1).get_commandOn();return true},$GK_1:function(b,a){ULSNVe:;a.On=RTE.RichTextEditor.queryBold().get_commandOn();return true},$GL_1:function(b,a){ULSNVe:;a.On=RTE.ParagraphCommands.queryBulletedList().get_commandOn();return true},$GM_1:function(d,a){ULSNVe:;var b=a.CommandValueId,c=RTE.SPRichTextEditorComponentProvider.$Dp(b);a.On=c;return true},$GN_1:function(b,a){ULSNVe:;a.IsFreeForm=true;a.Value=RTE.FontCommands.$IF();return true},$GO_1:function(b,a){ULSNVe:;a.IsFreeForm=true;a.Value=RTE.FontCommands.$IG();return true},$GP_1:function(c,b){ULSNVe:;var a=RTE.RichTextEditor.queryImageAlt();if(a.$C_0){b.On=true;b.Value=a.$D_0}return true},$GQ_1:function(c,a){ULSNVe:;var b=RTE.RichTextEditor.queryImageHeight();if(b.$C_0){a.On=true;RTE.RteUtility.parseStringForSpinnerControl(b.$D_0,a,100,"px")}else a.On=false;return true},$GR_1:function(b,a){ULSNVe:;a.On=RTE.RichTextEditor.queryImageLockRatio().get_commandOn();return true},$GU_1:function(c,a){ULSNVe:;var b=RTE.RichTextEditor.queryImageWidth();if(b.$C_0){a.On=true;RTE.RteUtility.parseStringForSpinnerControl(b.$D_0,a,100,"px")}else a.On=false;return true},$GS_1:function(c,b){ULSNVe:;var a=RTE.RichTextEditor.queryImageSrc();if(a.$C_0){b.On=true;b.Value=a.$D_0}return true},$GV_1:function(b,a){ULSNVe:;a.On=RTE.RichTextEditor.queryItalic().get_commandOn();return true},$GX_1:function(b,a){ULSNVe:;a.On=RTE.ParagraphCommands.queryDirection(true).get_commandOn();return true},$GY_1:function(){ULSNVe:;return true},$GZ_1:function(b,a){ULSNVe:;RTE.RteUtility.classMustExist("CUI.Controls.ToggleButtonCommandProperties");a[CUI.Controls.ToggleButtonCommandProperties.On]=RTE.RichTextEditor.queryLinkDisplayIcon().get_commandOn();return true},$Ga_1:function(b,a){ULSNVe:;RTE.RteUtility.classMustExist("CUI.Controls.ToggleButtonCommandProperties");a[CUI.Controls.ToggleButtonCommandProperties.On]=RTE.RichTextEditor.queryLinkOpenInNewWindow().get_commandOn();return true},$Gb_1:function(c,b){ULSNVe:;RTE.RteUtility.classMustExist("CUI.Controls.TextBoxCommandProperties");var a=RTE.RichTextEditor.queryLinkTitle();if(a.$C_0)b[CUI.Controls.TextBoxCommandProperties.Value]=a.$D_0;return true},$Gc_1:function(c,b){ULSNVe:;RTE.RteUtility.classMustExist("CUI.Controls.TextBoxCommandProperties");var a=RTE.RichTextEditor.queryLinkUrl();if(a.$C_0)b[CUI.Controls.TextBoxCommandProperties.Value]=a.$D_0;return true},$Gd_1:function(b,a){ULSNVe:;a.On=RTE.ParagraphCommands.queryNumberedList().get_commandOn();return true},$Ge_1:function(b,a){ULSNVe:;a.On=RTE.ParagraphCommands.queryDirection(false).get_commandOn();return true},$Gf_1:function(b,a){ULSNVe:;a.On=RTE.RichTextEditor.queryStrikeThrough().get_commandOn();return true},$Gg_1:function(b,a){ULSNVe:;a.On=RTE.RichTextEditor.querySubscript().get_commandOn();return true},$Gh_1:function(b,a){ULSNVe:;a.On=RTE.RichTextEditor.querySuperscript().get_commandOn();return true},$Gi_1:function(c,b){ULSNVe:;var a=RTE.TableCommands.queryTableColumnWidth();a.$C_0&&RTE.RteUtility.parseStringForSpinnerControl(a.$D_0,b,100,"px");return true},$Gm_1:function(c,b){ULSNVe:;var a=RTE.TableCommands.queryTableHeight();a.$C_0&&RTE.RteUtility.parseStringForSpinnerControl(a.$D_0,b,100,"px");return true},$Go_1:function(c,b){ULSNVe:;var a=RTE.TableCommands.queryTableRowHeight();a.$C_0&&RTE.RteUtility.parseStringForSpinnerControl(a.$D_0,b,18,"px");return true},$Gs_1:function(c,b){ULSNVe:;var a=RTE.TableCommands.queryTableWidth();a.$C_0&&RTE.RteUtility.parseStringForSpinnerControl(a.$D_0,b,100,"px");return true},$Gn_1:function(c,b){ULSNVe:;var a=RTE.CanvasEvents.getNodeFromEvent("Table");if(a)b.On=RTE.TableCommands.hasLastColumn(a);return true},$Gj_1:function(c,b){ULSNVe:;var a=RTE.CanvasEvents.getNodeFromEvent("Table");if(a)b.On=RTE.TableCommands.hasFirstColumn(a);return true},$Gk_1:function(c,b){ULSNVe:;var a=RTE.CanvasEvents.getNodeFromEvent("Table");if(a)b.On=RTE.TableCommands.hasFooterRow(a);return true},$Gl_1:function(c,b){ULSNVe:;var a=RTE.CanvasEvents.getNodeFromEvent("Table");if(a)b.On=RTE.TableCommands.hasHeaderRow(a);return true},$Gr_1:function(c,b){ULSNVe:;var a=RTE.CanvasEvents.getNodeFromEvent("Table");if(a)b.On=RTE.TableCommands.queryTableGridLines().get_commandOn();return true},$Gp_1:function(a,b,c){ULSNVe:;return this.$Av_1(a,b,c,"Table")},$Av_1:function(f,c,g,e){ULSNVe:;var a=c.CommandValueId;if(!a)return true;var d=RTE.StyleRuleUtility.$2c(a),b=RTE.CanvasEvents.getNodeFromEvent(e);if(b&&RTE.RteUtility.$6M(b,d))c.On=true;return true},$GT_1:function(a,b,c){ULSNVe:;return this.$Av_1(a,b,c,"Image")},$Gq_1:function(c,b){ULSNVe:;var a=RTE.RichTextEditor.queryTableSummary();if(a.$C_0){b.On=true;b.Value=a.$D_0}return true},$Gt_1:function(d,b){ULSNVe:;var a=b.CommandValueId;if(!a)return true;var c=this.$Dq_1(a);b.On=c;return true},$Dq_1:function(c){ULSNVe:;var b=RTE.StyleRuleUtility.$2c(c),a=RTE.FontCommands.$Ii();return!!a&&RTE.RteUtility.$6M(a,b)},$Gu_1:function(b,a){ULSNVe:;a.On=RTE.RichTextEditor.queryUnderline().get_commandOn();return true},$FP_1:function(){ULSNVe:;return RTE.RichTextEditor.queryBold().$C_0},$FQ_1:function(){ULSNVe:;return!RTE.Cursor.$Cq()&&RTE.ParagraphCommands.queryBulletedList().$C_0},$FR_1:function(){ULSNVe:;return RTE.Canvas.$1D},$FO_1:function(){ULSNVe:;return true},$Aj_1:function(){ULSNVe:;var a=RTE.CanvasEvents.getNodeFromEvent("Link");if(a)return false;var b=RTE.CanvasEvents.getNodeFromEvent("Atomic");return b?false:true},$Fl_1:function(){ULSNVe:;return!this.$Ak_1()?false:this.$Aj_1()},$Ak_1:function(){ULSNVe:;return!window.browseris.safariMobile},$FS_1:function(){ULSNVe:;return RTE.Canvas.$6C("copy")},$FT_1:function(){ULSNVe:;return RTE.Canvas.$6C("cut")},$Fn_1:function(){ULSNVe:;if(!RTE.Canvas.$1D)return false;var a=RTE.Canvas.currentEditableRegion();return!RTE.Canvas.getCachedRestriction(a,"AllowWebParts",false)?false:RTE.RteUtility.isInWebpartBox(a)?false:true},$Fk_1:function(){ULSNVe:;if(!RTE.Canvas.$1D)return false;if(!RTE.RteUtility.isClassAvailable("SP.Ribbon.DocLibAspxPageComponent"))return false;var b=SP.Ribbon.DocLibAspxPageComponent.get_instance()!=null&&SP.Ribbon.DocLibAspxPageComponent.get_instance().get_allowInsertNewList();if(!b)return false;var a=RTE.Canvas.currentEditableRegion();return!RTE.Canvas.getCachedRestriction(a,"AllowWebParts",false)?false:RTE.RteUtility.isInWebpartBox(a)?false:true},$FV_1:function(){ULSNVe:;return RTE.RichTextEditor.queryItalic().$C_0},$FW_1:function(){ULSNVe:;return!RTE.Cursor.$Cq()&&RTE.ParagraphCommands.queryNumberedList().$C_0},$FX_1:function(){ULSNVe:;return RTE.Canvas.$6C("paste")},$Fd_1:function(){ULSNVe:;return RTE.RichTextEditor.queryStrikeThrough().$C_0},$Fe_1:function(){ULSNVe:;return RTE.RichTextEditor.querySubscript().$C_0},$Ff_1:function(){ULSNVe:;return RTE.RichTextEditor.querySuperscript().$C_0},$Fg_1:function(){ULSNVe:;var a=RTE.CanvasEvents.getNodeFromEvent("Table");return RTE.TableCommands.hasTableStyle(a)},$Fh_1:function(){ULSNVe:;var a=RTE.CanvasEvents.getNodeFromEvent("Table");return RTE.TableCommands.hasTableStyle(a)},$Fi_1:function(){ULSNVe:;return RTE.RichTextEditor.queryUnderline().$C_0},$Ai_1:function(){ULSNVe:;return RTE.SnapshotManager.get_undoEnabled()},$Ah_1:function(){ULSNVe:;return RTE.SnapshotManager.$3Q.$13_0>0},$Fm_1:function(){ULSNVe:;var a=RTE.Canvas.currentEditableRegion();return!RTE.Canvas.getCachedRestriction(a,"UseInlineStyle",false)},$Fj_1:function(){ULSNVe:;return this.$Ai_1()||this.$Ah_1()},$FY_1:function(){ULSNVe:;return RTE.Canvas.$1D},$FZ_1:function(){ULSNVe:;return RTE.RichTextEditor.queryImageContextualGroup().$C_0},$Fa_1:function(){ULSNVe:;return RTE.RichTextEditor.queryLinkContextualGroup().$C_0},$Fb_1:function(){ULSNVe:;return RTE.RichTextEditor.queryTableContextualGroup().$C_0},$Fc_1:function(){ULSNVe:;return RTE.TableCommands.queryTableDesignTab().$C_0},$FU_1:function(){ULSNVe:;return RTE.Canvas.$1D},initializeCommandHandlerDictionary:function(){ULSNVe:;if(!RTE.SU.$7(this.$0_1))return;var a;this.$0_1={};a=this.$$d_$Fu_1;this.$0_1.AlignCenter=a;this.$0_1.AlignJustify=a;this.$0_1.AlignLeft=a;this.$0_1.AlignRight=a;a=this.$$d_$Fw_1;this.$0_1.BackgroundColorCssClass=a;this.$0_1.BackgroundColorCssClassPreview=a;this.$0_1.BackgroundColorThemeClass=a;this.$0_1.BackgroundColorThemeClassPreview=a;this.$0_1.BackgroundColorCustom=a;a=this.$$d_$Fx_1;this.$0_1.Bold=a;this.$0_1.ClearFormatting=a;this.$0_1.Italics=a;this.$0_1.StrikeThrough=a;this.$0_1.Subscript=a;this.$0_1.Superscript=a;this.$0_1.Underline=a;a=this.$$d_$GF_1;this.$0_1.BulletedList=a;this.$0_1.NumberedList=a;a=this.$$d_$Fz_1;this.$0_1.ColorCssClass=a;this.$0_1.ColorCssClassPreview=a;this.$0_1.ColorCustom=a;this.$0_1.ColorThemeClass=a;this.$0_1.ColorThemeClassPreview=a;a=this.$$d_$Fy_1;this.$0_1.Copy=a;this.$0_1.Cut=a;this.$0_1.Paste=a;this.$0_1.PasteDefault=a;a=this.$$d_$GA_1;this.$0_1.DecreaseIndent=a;this.$0_1.IncreaseIndent=a;a=this.$$d_$HH_1;this.$0_1.DeleteCell=a;this.$0_1.DeleteColumn=a;this.$0_1.DeleteRow=a;this.$0_1.DeleteTable=a;a=this.$$d_$G6_1;this.$0_1.EditSource=a;this.$0_1.MakeXhtml=a;a=this.$$d_$G1_1;this.$0_1.EditImageUpload=a;this.$0_1.EditImageWeb=a;a=this.$$d_$G2_1;this.$0_1.ElementWithStyle=a;this.$0_1.ElementWithStylePreview=a;a=this.$$d_$Fv_1;this.$0_1.ApplyLiveGalleryStyle=a;this.$0_1.ApplyLiveGalleryStylePreview=a;a=this.$$d_$G3_1;this.$0_1.FontFamilyCssClass=a;this.$0_1.FontFamilyCssClassPreview=a;this.$0_1.FontFamilyThemeClass=a;this.$0_1.FontFamilyThemeClassPreview=a;this.$0_1.FontFamilyStyleValue=a;a=this.$$d_$G4_1;this.$0_1.FontSizeCssClass=a;this.$0_1.FontSizeCssClassPreview=a;this.$0_1.FontSizeStyleValue=a;a=this.$$d_$G7_1;this.$0_1.ImageAlt=a;this.$0_1.ImageClearStyle=a;this.$0_1.ImageEdit=a;this.$0_1.ImageHeight=a;this.$0_1.ImageLockRatio=a;this.$0_1.ImageSrc=a;this.$0_1.ImageWidth=a;a=this.$$d_$G8_1;this.$0_1.ImagePosition=a;this.$0_1.ImagePositionPreview=a;a=this.$$d_$G9_1;this.$0_1.ImageStyle=a;this.$0_1.ImageStylePreview=a;a=this.$$d_$GB_1;this.$0_1.InsertImageUpload=a;this.$0_1.InsertImageWeb=a;this.$0_1.InsertImage=a;this.$0_1.InsertLinkWeb=a;this.$0_1.InsertLink=a;this.$0_1.InsertList=a;this.$0_1.InsertNewList=a;a=this.$$d_$HJ_1;this.$0_1.InsertColumnLeft=a;this.$0_1.InsertColumnRight=a;this.$0_1.InsertRowAbove=a;this.$0_1.InsertRowBelow=a;this.$0_1.InsertTable=a;this.$0_1.InsertTableDialog=a;a=this.$$d_$GD_1;this.$0_1.LayoutOneColumn=a;this.$0_1.LayoutOneColumnSidebar=a;this.$0_1.LayoutTwoColumn=a;this.$0_1.LayoutTwoColumnHeader=a;this.$0_1.LayoutTwoColumnHeaderFooter=a;this.$0_1.LayoutThreeColumn=a;this.$0_1.LayoutThreeColumnHeader=a;this.$0_1.LayoutThreeColumnHeaderFooter=a;a=this.$$d_$GE_1;this.$0_1.LinkDisplayIcon=a;this.$0_1.LinkEditWeb=a;this.$0_1.LinkInNewTab=a;this.$0_1.LinkRemove=a;this.$0_1.LinkTitleChanged=a;this.$0_1.LinkUrlChanged=a;a=this.$$d_$G0_1;this.$0_1.LeftToRight=a;this.$0_1.RightToLeft=a;a=this.$$d_$HK_1;this.$0_1.MergeCellAbove=a;this.$0_1.MergeCellBelow=a;this.$0_1.MergeCellLeft=a;this.$0_1.MergeCellRight=a;this.$0_1.MergeCells=a;a=this.$$d_$G5_1;this.$0_1.Redo=a;this.$0_1.Undo=a;this.$0_1.RemoveStyles=this.$$d_$Gv_1;this.$0_1.SelectAll=this.$$d_$HA_1;a=this.$$d_$HC_1;this.$0_1.SelectMenuItem=a;this.$0_1.SelectMenuItemPreview=a;a=this.$$d_$HE_1;this.$0_1.SetLanguage=a;a=this.$$d_$HN_1;this.$0_1.TableStyle=a;this.$0_1.TableStylePreview=a;this.$0_1.TableSummary=this.$$d_$HO_1;a=this.$$d_$HP_1;this.$0_1.TextStyle=a;this.$0_1.TextStylePreview=a;a=this.$$d_$HI_1;this.$0_1.SetTableColumnWidth=a;this.$0_1.SetTableHeight=a;this.$0_1.SetTableRowHeight=a;this.$0_1.SetTableWidth=a;a=this.$$d_$HF_1;this.$0_1.SplitHorizontal=a;this.$0_1.SplitVertical=a;a=this.$$d_$HL_1;this.$0_1.TableClearFormatting=a;this.$0_1.TableViewGridlines=a;a=this.$$d_$HM_1;this.$0_1.TableFirstColumn=a;this.$0_1.TableFooterRow=a;this.$0_1.TableHeadingRow=a;this.$0_1.TableLastColumn=a;this.$0_1.UploadDocumentRTE=this.$$d_$HQ_1;a=this.$$d_$HR_1;this.$0_1.InsertWebPart=a;a=this.$$d_$GC_1;this.$0_1.InsertEmbedding=a;a=this.$$d_$HD_1;this.$0_1.ServerButton=a;this.$0_1.ServerQueryButton=a;a=this.$$d_$H9_1;this.$0_1.CommandContextChanged=a;a=this.$$d_$HG_1;this.$0_1.SelectTextStyleOpen=a;this.$0_1.ElementWithStyleOptionsOpen=a;this.$0_1.TableStyleOptionsOpen=a;this.$0_1.ImageStyleOptionsOpen=a;this.$0_1.ImageArrangeMenuOpen=a;this.$0_1.FontFamilyStyleOpen=a;this.$0_1.FontSizeStyleOpen=a;this.$0_1.SelectBackgroundColorOpen=a;this.$0_1.SelectFontColorOpen=a;a=this.$$d_$Au_1;this.$0_1.SelectFontColorClose=a;this.$0_1.SelectBackgroundColorClose=a;this.$0_1.FontSizeStyleClose=a;this.$0_1.FontFamilyStyleClose=a;this.$0_1.ImageArrangeMenuClose=a;this.$0_1.ImageStyleOptionsClose=a;this.$0_1.TableStyleOptionsClose=a;this.$0_1.ElementWithStyleOptionsClose=a;this.$0_1.SelectTextStyleClose=a;this.$0_1.ApplyLiveGalleryStylePreviewRevert=this.$$d_$Gw_1;a=this.$$d_$HB_1;this.$0_1.SelectElementClose=a;this.$0_1.GetFontBackgroundColorMenuXml=this.$$d_$Gx_1;this.$0_1.GetFontColorMenuXml=this.$$d_$Gy_1;this.$0_1.GetFontFamilyMenuXml=this.$$d_$Gz_1;this.$0_1.GetFontSizeMenuXml=this.$$d_$H0_1;this.$0_1.GetImageStyleMenuXml=this.$$d_$H1_1;this.$0_1.GetPositionMenuXml=this.$$d_$H5_1;this.$0_1.GetSelectElementMenuXml=this.$$d_$H6_1;this.$0_1.GetTableStyleMenuXml=this.$$d_$H7_1;this.$0_1.GetTextStyleMenuXml=this.$$d_$H8_1;this.$0_1.GetLanguagesMenuXml=this.$$d_$H2_1;this.$0_1.GetPasteMenuXml=this.$$d_$H4_1;this.$0_1.QueryAlignCenter=this.$$d_$GG_1;this.$0_1.QueryAlignJustify=this.$$d_$GH_1;this.$0_1.QueryAlignLeft=this.$$d_$GI_1;this.$0_1.QueryAlignRight=this.$$d_$GJ_1;this.$0_1.QueryBold=this.$$d_$GK_1;this.$0_1.QueryBulletedList=this.$$d_$GL_1;this.$0_1.QueryElementWithStyle=this.$$d_$GM_1;this.$0_1.QueryFontFamily=this.$$d_$GN_1;this.$0_1.QueryFontSize=this.$$d_$GO_1;this.$0_1.QueryImageAlt=this.$$d_$GP_1;this.$0_1.QueryImageHeight=this.$$d_$GQ_1;this.$0_1.QueryImageLockRatio=this.$$d_$GR_1;this.$0_1.QueryImageWidth=this.$$d_$GU_1;this.$0_1.QueryImageStyle=this.$$d_$GT_1;this.$0_1.QueryImageSrc=this.$$d_$GS_1;this.$0_1.QueryItalics=this.$$d_$GV_1;this.$0_1.QueryLanguage=this.$$d_$GW_1;this.$0_1.QueryLeftToRight=this.$$d_$GX_1;this.$0_1.QueryLinkDisplayIcon=this.$$d_$GZ_1;this.$0_1.QueryLinkBookmark=this.$$d_$GY_1;this.$0_1.QueryLinkInNewTab=this.$$d_$Ga_1;this.$0_1.QueryLinkTitle=this.$$d_$Gb_1;this.$0_1.QueryLinkUrl=this.$$d_$Gc_1;this.$0_1.QueryNumberedList=this.$$d_$Gd_1;this.$0_1.QueryRightToLeft=this.$$d_$Ge_1;this.$0_1.QueryStrikeThrough=this.$$d_$Gf_1;this.$0_1.QuerySubscript=this.$$d_$Gg_1;this.$0_1.QuerySuperscript=this.$$d_$Gh_1;this.$0_1.QueryTableColumnWidth=this.$$d_$Gi_1;this.$0_1.QueryTableHeight=this.$$d_$Gm_1;this.$0_1.QueryTableRowHeight=this.$$d_$Go_1;this.$0_1.QueryTableWidth=this.$$d_$Gs_1;this.$0_1.QueryTableLastColumn=this.$$d_$Gn_1;this.$0_1.QueryTableFirstColumn=this.$$d_$Gj_1;this.$0_1.QueryTableFooterRow=this.$$d_$Gk_1;this.$0_1.QueryTableHeadingRow=this.$$d_$Gl_1;this.$0_1.QueryTableViewGridlines=this.$$d_$Gr_1;this.$0_1.QueryTableStyle=this.$$d_$Gp_1;this.$0_1.QueryTableSummary=this.$$d_$Gq_1;this.$0_1.QueryTextStyle=this.$$d_$Gt_1;this.$0_1.QueryUnderline=this.$$d_$Gu_1;this.$0_1.QueryLiveGalleryStyle=this.$$d_$H3_1},initializeCanHandleHandlerDictionary:function(){ULSNVe:;if(!RTE.SU.$7(this.$9_1))return;this.$9_1={};this.$9_1.Bold=this.$$d_$FP_1;this.$9_1.BulletedList=this.$$d_$FQ_1;this.$9_1.Copy=this.$$d_$FS_1;this.$9_1.Cut=this.$$d_$FT_1;this.$9_1.EditSource=this.$$d_$FU_1;this.$9_1.Italics=this.$$d_$FV_1;this.$9_1.MakeXhtml=this.$$d_$FU_1;this.$9_1.NumberedList=this.$$d_$FW_1;this.$9_1.Paste=this.$$d_$FX_1;this.$9_1.PasteDefault=this.$$d_$FX_1;this.$9_1.Redo=this.$$d_$Ah_1;this.$9_1.StrikeThrough=this.$$d_$Fd_1;this.$9_1.Subscript=this.$$d_$Fe_1;this.$9_1.Superscript=this.$$d_$Ff_1;this.$9_1.TableFooterRow=this.$$d_$Fg_1;this.$9_1.TableLastColumn=this.$$d_$Fh_1;this.$9_1.Underline=this.$$d_$Fi_1;this.$9_1.Undo=this.$$d_$Ai_1;this.$9_1.UndoOpen=this.$$d_$Fj_1;this.$9_1.FontGroup=this.$$d_$FR_1;this.$9_1.ParagraphGroup=this.$$d_$FR_1;this.$9_1.EditingGroup=this.$$d_$FR_1;this.$9_1.SelectFontColorOpen=this.$$d_$FO_1;this.$9_1.ColorCssClass=this.$$d_$FO_1;this.$9_1.ColorCssClassPreview=this.$$d_$FO_1;this.$9_1.ColorCustom=this.$$d_$FO_1;this.$9_1.ColorThemeClass=this.$$d_$FO_1;this.$9_1.ColorThemeClassPreview=this.$$d_$FO_1;this.$9_1.InsertLink=this.$$d_$Aj_1;this.$9_1.InsertLinkMenuOpen=this.$$d_$Aj_1;this.$9_1.InsertLinkWeb=this.$$d_$Aj_1;this.$9_1.UploadDocumentRTE=this.$$d_$Fl_1;this.$9_1.InsertImageUpload=this.$9_1.EditImageUpload=this.$$d_$Ak_1;this.$9_1.TablesGroup=this.$$d_$FR_1;this.$9_1.MediaGroup=this.$$d_$FR_1;this.$9_1.LinksGroup=this.$$d_$FR_1;this.$9_1.ImageStyleOptionsOpen=this.$$d_$Fm_1;this.$9_1.TableStyleOptionsOpen=this.$$d_$Fm_1;this.$9_1.EditingToolsContextualGroup=this.$$d_$FY_1;this.$9_1.ImageContextualGroup=this.$$d_$FZ_1;this.$9_1.LinkContextualGroup=this.$$d_$Fa_1;this.$9_1.TableContextualGroup=this.$$d_$Fb_1;this.$9_1.TableDesignTab=this.$$d_$Fc_1;this.$9_1.InsertColumnLeft=RTE.TableCommands.canInsertColumn;this.$9_1.InsertColumnRight=RTE.TableCommands.canInsertColumn;this.$9_1.InsertRowAbove=RTE.TableCommands.canInsertRow;this.$9_1.InsertRowBelow=RTE.TableCommands.canInsertRow;this.$9_1.MergeCellAbove=RTE.TableCommands.canMergeCells;this.$9_1.MergeCellBelow=RTE.TableCommands.canMergeCells;this.$9_1.MergeCellLeft=RTE.TableCommands.canMergeCells;this.$9_1.MergeCellRight=RTE.TableCommands.canMergeCells;this.$9_1.MergeCells=RTE.TableCommands.canMergeSelected;this.$9_1.SplitHorizontal=RTE.TableCommands.canSplit;this.$9_1.SplitVertical=RTE.TableCommands.canSplit;this.$9_1.ImageSizeGroup=RTE.RichTextEditor.$5s;this.$9_1.InsertWebPart=RTE.Canvas.canHandleInsertWebPart;this.$9_1.InsertList=RTE.Canvas.canHandleInsertWebPart;this.$9_1.InsertNewList=this.$$d_$Fk_1;this.$9_1.WebPartsGroup=this.$$d_$Fn_1;this.$9_1.InsertEmbedding=RTE.EmbeddingCommands.canHandleInsertEmbeddingButton;this.$9_1.EmbedGroup=RTE.EmbeddingCommands.canHandleInsertEmbedding},initializeAllCommandsDictionary:function(){ULSNVe:;if(!RTE.SU.$7(this.$57_1))return;var a,c,b;this.$57_1={};b=this.getFocusedCommands();c=b.length;for(a=0;a<c;a++)this.$57_1[b[a]]=true;b=this.getGlobalCommands();c=b.length;for(a=0;a<c;a++)this.$57_1[b[a]]=true}};RTE.RteRibbonCommand=function(){};RTE.RteRibbonCommand.prototype={$CA_0:null,$Ax_0:null,$Do_0:null,$EA_0:0};RTE.CssStyleInfo=function(){};RTE.CssStyleInfo.prototype={$EK_0:null,rule:null,$7N_0:null};RTE.StyleRuleUtility=function(){};RTE.StyleRuleUtility.$C4=function(a){ULSNVe:;var b=a.indexOf(";");return b===-1?a:a.substr(0,b)};RTE.StyleRuleUtility.$Bs=function(a){ULSNVe:;var b=a.indexOf(";");return b===-1?false:a.substring(b+1,a.length)==="true"};RTE.StyleRuleUtility.$2c=function(a){ULSNVe:;var b=a.indexOf(".");if(b>=0)a=a.substr(b+1);return a};RTE.StyleRuleUtility.$6I=function(b){ULSNVe:;var a=b.indexOf(".");return a>=0?b.substring(0,a):""};RTE.StyleRuleUtility.$IX=function(a,c,d,e,f){ULSNVe:;if(!RTE.SU.$1R(a.href)&&!RTE.SU.$2(a.href)){if(RTE.StyleRuleUtility.checkOnlyCssFromSameDomain&&!RTE.RteUtility.$JU(a.href))return false;var b=null;if(f){b=RTE.StyleRuleUtility.$Kz(a.href);if(!b)return false}else b=RTE.StyleRuleUtility.$E8(a.href);return b.indexOf(c)===-1?true:RTE.StyleRuleUtility.$Cs(a,c,d,e)}return RTE.StyleRuleUtility.$Cs(a,c,d,e)};RTE.StyleRuleUtility.$Cs=function(i,l,m,j){ULSNVe:;for(var f=RTE.StyleRuleUtility.$IV(i),k=f.length,c=0;c<k;c++){var d=f[c],g=d.selectorText;if(!RTE.SU.$2(g))for(var h=g.split(","),e=0;e<h.length;e++){var a=RTE.StyleRuleUtility.$IW(l,h[e].trim());if(a&&!j[a]){var b=new RTE.CssStyleInfo;b.$EK_0=i;b.rule=d;b.$7N_0=a;j[a]=d;m.push(b)}}}return true};RTE.StyleRuleUtility.$IW=function(e,a){ULSNVe:;if(a&&typeof a!=="undefined"&&a.length&&a.indexOf(e)!==-1){a=a.toLowerCase();var c,b=null;if((c=a.lastIndexOf(" "))>=0)if(++c<a.length)b=a.substr(c);else b="";else b=a;var d=b.indexOf(".");if(d!==-1)b=b.substr(d);if(b.indexOf(e)!==-1)return b}return null};RTE.StyleRuleUtility.$IV=function(a){ULSNVe:;return a.rules?a.rules:a.cssRules};RTE.StyleRuleUtility.getStyleRules=function(a,c,k){ULSNVe:;if(!a.startsWith("."))a="."+a;a=a.toLowerCase();if(!RTE.StyleRuleUtility.$5G)RTE.StyleRuleUtility.$5G={};var d=null;d=RTE.StyleRuleUtility.$5G[a];if(d)return d;else{if(!RTE.StyleRuleUtility.$5H)RTE.StyleRuleUtility.$5H={};var e=true,b=RTE.StyleRuleUtility.$5H[c];if(!b){b=[];for(var m={},i=document.styleSheets,n=i.length,g=0;g<n;g++){var o=RTE.StyleRuleUtility.$IX(i[g],c,b,m,k);if(!o)e=false}if(e)RTE.StyleRuleUtility.$5H[c]=b}for(var f=[],l=b.length,h=0;h<l;h++){var j=b[h];j.$7N_0.indexOf(a)!==-1&&f.push(j)}if(e)RTE.StyleRuleUtility.$5G[a]=f;return f}};RTE.StyleRuleUtility.$36=function(a,e){ULSNVe:;var b=a.indexOf(e);if(b!==-1){var d=b+e.length,c=a.indexOf(",",b);if(c===-1)c=a.length;var f=c-d;return a.substr(d,f)}else return""};RTE.StyleRuleUtility.$2F=function(a,b,c){ULSNVe:;return RTE.StyleRuleUtility.$8X(a,b,c,"-ms-name")};RTE.StyleRuleUtility.$Ac=function(a,b){ULSNVe:;return!b?a.rule.selectorText:a.rule.selectorText+(RTE.StyleRuleUtility.$Ce(a)?";true":";false")};RTE.StyleRuleUtility.$Ce=function(c){ULSNVe:;var a=RTE.StyleRuleUtility.$6I(c.rule.selectorText);if(RTE.SU.$2(a)||!RTE.HtmlTagName.allowedElementStyleTags[a.toUpperCase()])return false;var b=RTE.StyleRuleUtility.$8X(c,null,null,"-ms-element");return!RTE.SU.$2(b)&&b.trim().toLowerCase()==="true"};RTE.StyleRuleUtility.$IU=function(a,b,c){ULSNVe:;return RTE.StyleRuleUtility.$8X(a,b,c,"-ms-color")};RTE.StyleRuleUtility.$8X=function(b,e,c,d){ULSNVe:;var a=b.rule.style[d];if(RTE.SU.$7(a))a=RTE.StyleRuleUtility.$Ky(b,d);if(!RTE.SU.$7(a))a=unescape(a);else if(!RTE.SU.$2(c))a=RTE.StyleRuleUtility.$8E(b.rule.style,c);if(!RTE.SU.$7(a))a=RTE.RteUtility.removeQuotes(a);return a};RTE.StyleRuleUtility.$8E=function(a,b){ULSNVe:;return b==="fontSize"?RTE.StyleRuleUtility.$HV(a.fontSize):b==="fontFamily"?RTE.StyleRuleUtility.convertFontFamilyToDisplay(a.fontFamily):a[b]};RTE.StyleRuleUtility.convertFontFamilyToDisplay=function(a){ULSNVe:;var b=a.indexOf(",");if(b>0)a=a.substr(0,b);if(a.startsWith('"'))a=a.substr(1);if(a.endsWith('"'))a=a.substr(0,a.length-1);if(a.length>0)a=a.charAt(0).toUpperCase()+a.substr(1);return a};RTE.StyleRuleUtility.$HV=function(c){ULSNVe:;var a=RTE.RteUtility.parseUnitValue(c);if(!a)return"";if(a.unit==="px"&&Math.round(a.value*10)!==Math.round(a.value)*10){if(RTE.StyleRuleUtility.$77===-1){var b=document.createElement("SPAN");b.style.height="100pt";b.style.position="absolute";document.body.appendChild(b);RTE.StyleRuleUtility.$77=b.offsetHeight/100;b.parentNode.removeChild(b)}a.unit="pt";a.value=Math.round(a.value/RTE.StyleRuleUtility.$77*10)/10}return a.value+a.unit};RTE.StyleRuleUtility.$Ky=function(j,l){ULSNVe:;var g=j.$EK_0.href;if(!g)return null;var c=j.$7N_0;if(!c)return null;var e=RTE.StyleRuleUtility.$E8(g);if(!e)return null;var b=e.toLowerCase();c=c.toLowerCase();var a=-1;a=b.indexOf(c,a+1);while(a!==-1){var h=b.indexOf(l,a);if(h!==-1){var d=b.indexOf(":",h);if(d!==-1){var f=b.indexOf(";",d);if(f!==-1){var i=b.indexOf("}",a);if(i!==-1)if(i>=f){var k=e.substr(d+1,f-d-1);return k.trim()}}}}a=b.indexOf(c,a+1)}return null};RTE.StyleRuleUtility.$E8=function(a){ULSNVe:;if(!RTE.StyleRuleUtility.$2Q[a])try{var b=new XMLHttpRequest;b.open("GET",a,false);b.send(null);RTE.StyleRuleUtility.$2Q[a]=b.responseText}catch(c){RTE.StyleRuleUtility.$2Q[a]=""}return RTE.StyleRuleUtility.$2Q[a]};RTE.StyleRuleUtility.$Kz=function(a){ULSNVe:;var c=RTE.StyleRuleUtility.$2Q[a];if(!c){var d=RTE.StyleRuleUtility.$5e[a];if(!d||!d){RTE.StyleRuleUtility.$5e[a]=true;RTE.StyleRuleUtility.$5f++;RTE.StyleRuleUtility.$2Q[a]="";try{var b=new XMLHttpRequest;b.open("GET",a,true);b.onreadystatechange=function(){ULSNVe:;if(b.readyState===4){RTE.StyleRuleUtility.$5e[a]=false;RTE.StyleRuleUtility.$5f--;if(b.status===200)RTE.StyleRuleUtility.$2Q[a]=b.responseText;else RTE.StyleRuleUtility.$2Q[a]="";!RTE.StyleRuleUtility.$5f&&RTE.Canvas.$O()}};b.send(null)}catch(e){RTE.StyleRuleUtility.$5e[a]=false;RTE.StyleRuleUtility.$5f--}}}return c};RTE.TableCommands=function(){};RTE.TableCommands.queryTableDesignTab=function(){ULSNVe:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Table");a.$C_0=RTE.Canvas.$1D&&!!b;return a};RTE.TableCommands.insertTable=function(f){ULSNVe:;if(!RTE.Cursor.get_range().canDeleteContent())return;RTE.Cursor.get_range().deleteContent();var g=RTE.Canvas.getCurrentStyleSheetPrefix(),h=RTE.Cursor.get_range().$4_0,d=h.ownerDocument,a=d.createElement("TABLE");a.setAttribute("cellspacing","0");a.setAttribute("width","100%");var e=d.createElement("TBODY"),b=d.createElement("TR");e.appendChild(b);var c=d.createElement("TD");c.className=g+"Table-default";RTE.RteUtility.$3A(c);b.appendChild(c);for(var i=1;i<f.columns;i++)b.appendChild(c.cloneNode(true));for(var j=1;j<f.rows;j++)e.appendChild(b.cloneNode(true));a.appendChild(e);a.className=g+"Table-default";if(b&&b.childNodes.length>0)c=b.firstChild;RTE.RteUtility.$6S(a,h);if(!f.commandType&&c){RTE.Cursor.get_range().moveToEndOfNode(c);RTE.Cursor.update()}if(a.parentNode===RTE.Canvas.currentEditableRegion()&&!RTE.RteUtility.$t(a,false)){var k=a.ownerDocument.createElement("P");SP.UI.UIUtility.insertAfter(k,a)}RTE.Canvas.setTableWidths&&RTE.TableCommands.$EJ(a)};RTE.TableCommands.$EJ=function(a){ULSNVe:;var b=a;if(a.firstChild&&a.firstChild.nodeType===1&&a.firstChild.tagName==="TBODY")b=a.firstChild;if(b.childNodes.length>0&&b.childNodes[0].childNodes.length>0)for(var d=b.childNodes[0],e=d.childNodes.length,c=0;c<e;c++)if(RTE.SU.$2(d.childNodes[c].style.width)){var f=100/e,g=f+"%";d.childNodes[c].style.width=g}};RTE.TableCommands.$CS=function(a,b,o){ULSNVe:;for(var c=b.cloneNode(false),e=b.rowIndex,d=0;d<e;d++)for(var n=a.rows[d],k=n.cells,f=0;f<k.length;f++){var g=k[f];if(d+g.rowSpan>=e+1)g.rowSpan=g.rowSpan+1}if(o)SP.UI.UIUtility.insertBefore(c,b);else SP.UI.UIUtility.insertAfter(c,b);var l=RTE.TableCommands.hasHeaderRow(a),m=RTE.TableCommands.hasFooterRow(a);RTE.TableCommands.$9v(a,e,false);for(var j=b.cells,h=0;h<j.length;h++){var i=j[h].cloneNode(false);RTE.RteUtility.$3A(i);i.rowSpan=1;c.appendChild(i)}RTE.TableCommands.setHeaderRow(a,l);RTE.TableCommands.setFooterRow(a,m);return c};RTE.TableCommands.insertRow=function(f){ULSNVe:;var b=RTE.Cursor.getNearestContainingElementOfType("TR");if(!b)return;var a=RTE.RteUtility.$G(b,"TABLE");if(!a)return;if(!RTE.Canvas.isEditable(a))return;var c=RTE.TableCommands.$CS(a,b,f);RTE.TableCommands.$24(a);var d=RTE.Cursor.get_range(),e=RTE.RteUtility.$I9();if(e==="rtl")d.moveToNode(c.childNodes[c.childNodes.length-1]);else d.moveToNode(c.childNodes[0]);RTE.Cursor.update()};RTE.TableCommands.insertColumn=function(o){ULSNVe:;var e=RTE.Cursor.$1G(RTE.HtmlTagName.tableCellTagNames);if(!e)return;var a=RTE.RteUtility.$G(e,"TABLE");if(!a)return;if(!RTE.Canvas.isEditable(a))return;if(RTE.ParagraphCommands.queryDirection(false).get_commandOn())o=!o;var g=RTE.TableCommands.$x(a,e,false),h=g.targetCellColSpanIndex,q=e.colSpan,r=RTE.TableCommands.hasFirstColumn(a),s=RTE.TableCommands.hasLastColumn(a);RTE.TableCommands.$9p(a,g,h,false);g=RTE.TableCommands.$x(a,e,false);for(var c=[],m=[],n=0;n<a.rows.length*2;n++){var i=g.columns[h].cells[n];if(!RTE.SU.$7(i))if(!Array.contains(c,i.cell)){Array.add(c,i.cell);Array.add(m,i.colSpanIndex)}}var d=null,b,p=RTE.Cursor.get_range();if(o)for(var j=0;j<c.length;j++){var k=c[j],t=m[j];if(t===h){b=k.cloneNode(false);b.colSpan=1;RTE.RteUtility.$3A(b);SP.UI.UIUtility.insertBefore(b,k);if(!d){d=b;p.moveToNode(d)}}else k.colSpan=k.colSpan+1}else for(var l=0;l<c.length;l++){var f=c[l],u=m[l];if(u+f.colSpan===h+q){b=f.cloneNode(false);b.colSpan=1;RTE.RteUtility.$3A(b);SP.UI.UIUtility.insertAfter(b,f);if(!d){d=b;p.moveToNode(d)}}else f.colSpan=f.colSpan+1}RTE.TableCommands.setFirstColumn(a,r);RTE.TableCommands.setLastColumn(a,s);RTE.TableCommands.$24(a);RTE.Cursor.get_range().resetCacheRange();RTE.Cursor.update()};RTE.TableCommands.deleteColumn=function(){ULSNVe:;var c=RTE.Cursor.$1G(RTE.HtmlTagName.tableCellTagNames);if(!c)return;var m=RTE.RteUtility.$G(c,"TR");if(!m)return;var a=RTE.RteUtility.$G(m,"TABLE");if(!a)return;if(!RTE.Canvas.isEditable(a))return;for(var n=RTE.TableCommands.$x(a,c,false),h=n.targetCellColSpanIndex,t=c.colSpan,d=[],o=[],i=0;i<a.rows.length*2;i++){var e=n.columns[h].cells[i];if(!RTE.SU.$7(e))if(!Array.contains(d,e.cell)){Array.add(d,e.cell);Array.add(o,e.colSpanIndex)}}for(var f=0;f<d.length;f++){var b=d[f],u=o[f],p=RTE.TableCommands.$8V(h,t,u,b.colSpan);if(p===b.colSpan)b.parentNode.removeChild(b);else b.colSpan=b.colSpan-p}for(var j=a.rows.length-1;j>=0;j--){var k=a.rows[j],v=k.cells;!v.length&&k.parentNode.removeChild(k)}if(!a.rows.length){RTE.Cursor.get_range().moveAfterNode(a);a.parentNode.removeChild(a)}else{RTE.TableCommands.$24(a);for(var q=0,r=0,l=a.rows[0].cells,g=0;g<l.length;g++){q=g;var s=RTE.TableCommands.$3o(l[g]);if(r+s>h)break;r+=s}var w=RTE.Cursor.get_range(),x=l[q];w.moveToStartOfNode(x)}RTE.Cursor.update()};RTE.TableCommands.$3o=function(a){ULSNVe:;return a.colSpan};RTE.TableCommands.$9q=function(a,b){ULSNVe:;a.setAttribute("colSpan",b)};RTE.TableCommands.$Ic=function(){ULSNVe:;var e=[],b=RTE.Cursor.getNearestContainingElementOfType("TR");if(!b)return e;for(var g=RTE.Cursor.get_range(),h=g.$3_0,i=g.$4_0,c=b.cells,f=false,d=false,a=0;a<c.length;a++){if(!f)f=RTE.RteUtility.$b(h,c[a],b);f&&!d&&Array.add(e,c[a]);if(!d)d=RTE.RteUtility.$b(i,c[a],b);if(d)break}return e};RTE.TableCommands.splitHorizontal=function(){ULSNVe:;var a=RTE.Cursor.$1G(RTE.HtmlTagName.tableCellTagNames);if(!a)return;var i=RTE.RteUtility.$G(a,"TR");if(!i)return;var b=RTE.RteUtility.$G(i,"TABLE");if(!b)return;if(!RTE.Canvas.isEditable(b))return;var c=a.cloneNode(false);RTE.RteUtility.$3A(c);var f=RTE.TableCommands.$3o(a);if(f>1){RTE.TableCommands.$9q(c,Math.floor(f/2));RTE.TableCommands.$9q(a,f-RTE.TableCommands.$3o(c))}else{for(var j=RTE.TableCommands.$x(b,a,false),l=j.targetCellColSpanIndex,d=[],g=0;g<b.rows.length*2;g++){var e=j.columns[l].cells[g];if(!RTE.SU.$7(e))!Array.contains(d,e.cell)&&e.cell!==a&&Array.add(d,e.cell)}for(var h=0;h<d.length;h++){var k=d[h];k.colSpan=k.colSpan+1}}SP.UI.UIUtility.insertAfter(c,a);RTE.Cursor.get_range().moveToStartOfNode(c);RTE.TableCommands.$24(b);RTE.Cursor.update()};RTE.TableCommands.splitVertical=function(){ULSNVe:;var a=RTE.Cursor.$1G(RTE.HtmlTagName.tableCellTagNames);if(!a)return;var b=RTE.RteUtility.$G(a,"TR");if(!b)return;var c=RTE.RteUtility.$G(b,"TABLE");if(!c)return;if(!RTE.Canvas.isEditable(c))return;var g=b.cells;if(a.rowSpan>1){for(var q=true,j=0;j<g.length;j++)if(g[j].rowSpan!==a.rowSpan){q=false;break}if(q)for(var k=0;k<g.length;k++)g[k].rowSpan=1}var p=b.rowIndex,d=a.cloneNode(false);RTE.RteUtility.$3A(d);var x=RTE.TableCommands.$x(c,a,false),y=x.targetCellColSpanIndex,i=a.rowSpan;if(i>1){for(var l=Math.floor(i/2),e=b,t=0;t<l;t++)if(e)e=e.nextSibling;if(!e)return;for(var r=0,s=e.cells,m=null,n=0;n<s.length;n++){var u=s[n];r+=RTE.TableCommands.$3o(u);if(r>y){m=u;break}}d.rowSpan=i-l;a.rowSpan=l;if(!m)e.appendChild(d);else SP.UI.UIUtility.insertBefore(d,m)}else{var v=b.cloneNode(false);SP.UI.UIUtility.insertAfter(v,b);v.appendChild(d);for(var f=0;f<p+1&&f<c.rows.length;f++)for(var z=c.rows[f],w=z.cells,o=0;o<w.length;o++){var h=w[o];if(h!==a&&h.rowSpan+f===p+1)h.rowSpan=h.rowSpan+1}}RTE.Cursor.get_range().moveToStartOfNode(d);RTE.TableCommands.$24(c);RTE.Cursor.update()};RTE.TableCommands.mergeCells=function(){ULSNVe:;var a=RTE.CanvasEvents.getNodeFromEvent("Table");if(!a)return;if(!RTE.Canvas.isEditable(a))return;if(RTE.Cursor.$JG("TR"))RTE.TableCommands.$DD();else RTE.TableCommands.$5M(0)};RTE.TableCommands.mergeWithRight=function(){ULSNVe:;RTE.TableCommands.$5M(1)};RTE.TableCommands.mergeWithLeft=function(){ULSNVe:;RTE.TableCommands.$5M(2)};RTE.TableCommands.mergeWithAbove=function(){ULSNVe:;RTE.TableCommands.$5M(3)};RTE.TableCommands.mergeWithBelow=function(){ULSNVe:;RTE.TableCommands.$5M(4)};RTE.TableCommands.$5M=function(e){ULSNVe:;RTE.TableCommands.$DD();var k=RTE.Cursor.getCurrentElement();if(!k)return;var f=RTE.RteUtility.$2d(k,RTE.HtmlTagName.tableCellTagNames);if(!f)return;var a=RTE.RteUtility.$G(f,"TR");if(!a)return;var b=RTE.RteUtility.$G(a,"TABLE");if(!b)return;if(!RTE.Canvas.isEditable(b))return;var d=a.cells,l=RTE.ParagraphCommands.queryDirection(false).get_commandOn();if(l)if(1===e)e=2;else if(2===e)e=1;var c;if(1===e){c=f.cellIndex;if(c+1>=d.length)return;if(d[c+1].rowSpan===d[c].rowSpan)RTE.TableCommands.$6s(b,a,c);else alert(SP.Res.invalidMerge)}else if(2===e){c=f.cellIndex-1;if(c<0)return;if(d[c+1].rowSpan===d[c].rowSpan)RTE.TableCommands.$6s(b,a,c);else alert(SP.Res.invalidMerge)}else if(3===e){if(!a.rowIndex)return;var v=a,m=f,w=a.rowIndex,n=RTE.TableCommands.$x(b,f,true),o=n.targetCellColSpanIndex,p=n.columns[o].cells[w-1],q=p.cell;if(m.colSpan===q.colSpan&&p.colSpanIndex===o)RTE.TableCommands.$DE(b,v,m,q);else alert(SP.Res.invalidMerge)}else if(4===e){var h=f,r=RTE.TableCommands.$x(b,h,false),s=r.targetCellColSpanIndex,x=a.rowIndex,i=r.columns[s].cells[x+h.rowSpan];if(!i)return;var j=i.cell,t=RTE.RteUtility.$G(j,"TR");if(!t)return;if(j.colSpan===h.colSpan&&i.colSpanIndex===s)RTE.TableCommands.$DE(b,t,j,h);else alert(SP.Res.invalidMerge)}else if(0===e){var g=f.cellIndex;if(d[g]&&d[g+1])if(l&&(g===d.length-1||g)){var u=g-1;if(u<0)return;RTE.TableCommands.$6s(b,a,u)}else{if(g+1>=d.length)return;RTE.TableCommands.$6s(b,a,g)}}};RTE.TableCommands.$6s=function(g,e,f){ULSNVe:;RTE.RteUtility.$J(RTE.Cursor.get_range().$3_0);RTE.RteUtility.$J(RTE.Cursor.get_range().$4_0);var d=e.cells,a=d[f],c=d[f+1],b=a.innerHTML;if(b.length>0)b+=" ";b+=c.innerHTML;RTE.RteUtility.$2p(a,b);a.colSpan+=c.colSpan;e.removeChild(c);RTE.Cursor.get_range().moveToStartOfNode(a);RTE.TableCommands.$24(g);RTE.Cursor.update()};RTE.TableCommands.$DE=function(d,e,c,b){ULSNVe:;RTE.RteUtility.$J(RTE.Cursor.get_range().$3_0);RTE.RteUtility.$J(RTE.Cursor.get_range().$4_0);var a=b.innerHTML;if(a.length>0)a+=" ";a+=c.innerHTML;RTE.RteUtility.$2p(b,a);b.rowSpan+=c.rowSpan;e.removeChild(c);RTE.Cursor.get_range().moveToStartOfNode(b);RTE.TableCommands.$24(d);RTE.Cursor.update()};RTE.TableCommands.deleteCell=function(){ULSNVe:;var a=RTE.Cursor.$1G(RTE.HtmlTagName.tableCellTagNames);if(!a)return;var g=RTE.RteUtility.$G(a,"TR");if(!g)return;var f=RTE.RteUtility.$G(a,"TABLE");if(!f)return;if(!RTE.Canvas.isEditable(f))return;var i=g.cells;if(i.length<=1){RTE.TableCommands.deleteRow();return}var b=a.nextSibling,d=a.previousSibling,e;if(b&&b.rowSpan===a.rowSpan){b.colSpan=b.colSpan+a.colSpan;e=b}else if(d&&d.rowSpan===a.rowSpan){d.colSpan=d.colSpan+a.colSpan;e=d}else{var j=g.rowIndex,h=RTE.TableCommands.$x(f,a,true),c;c=h.columns[h.targetCellColSpanIndex].cells[j-1];if(!RTE.SU.$7(c)&&c.colSpanIndex===h.targetCellColSpanIndex&&c.cell.colSpan===a.colSpan){c.cell.rowSpan=c.cell.rowSpan+a.rowSpan;e=c.cell}else if(b)e=b;else e=d}RTE.Cursor.get_range().moveToStartOfNode(e);a.parentNode.removeChild(a);RTE.TableCommands.$24(f);RTE.Cursor.update()};RTE.TableCommands.deleteTable=function(){ULSNVe:;var a=RTE.CanvasEvents.getNodeFromEvent("Table");if(!a)return;if(!RTE.Canvas.isEditable(a))return;RTE.Cursor.get_range().moveAfterNode(a);a.parentNode.removeChild(a);RTE.Cursor.update();RTE.Canvas.$O()};RTE.TableCommands.$IT=function(b){ULSNVe:;var a=b.parentNode;return a.rowIndex};RTE.TableCommands.$8V=function(a,b,c,d){ULSNVe:;return a===c?b<d?b:d:a>c?RTE.TableCommands.$8V(c,d,a,b):c>a+b?0:c+d<=a+b?d:a+b-c};RTE.TableCommands.deleteRow=function(){ULSNVe:;var c=RTE.Cursor.$1G(RTE.HtmlTagName.tableCellTagNames);if(!c)return;var a=RTE.RteUtility.$G(c,"TR");if(!a)return;var b=RTE.RteUtility.$G(a,"TABLE");if(!b)return;var d=a.rowIndex,e=!d&&RTE.TableCommands.hasHeaderRow(b);RTE.TableCommands.$CT(a,b,true);RTE.TableCommands.$CY(e,b);RTE.Cursor.get_range().resetCacheRange();RTE.Cursor.update()};RTE.TableCommands.$CT=function(t,a,p){ULSNVe:;if(!RTE.Canvas.isEditable(a))return;if(a.rows.length===1){p&&RTE.Cursor.get_range().moveAfterNode(a);a.parentNode.removeChild(a)}else{for(var c=t.rowIndex,q=!c&&RTE.Canvas.setTableWidths,m=RTE.TableCommands.$x(a,null,false),e=[],j=0;j<m.totalColSpan;j++)for(var d=c;d<c+1;d++){var f=m.columns[j];if(!RTE.SU.$7(f)){var g=f.cells[d];if(!RTE.SU.$7(g)){!Array.contains(e,g.cell)&&Array.add(e,g.cell);if(!RTE.SU.$2(g.cell.style.width)&&q&&d+1<f.cells.length){var h=f.cells[d+1];if(!RTE.SU.$7(h)&&RTE.SU.$2(h.cell.style.width))h.cell.style.width=h.cell.offsetWidth+"px"}}}}for(var k=0;k<e.length;k++){var b=e[k],r=RTE.TableCommands.$IT(b),n=RTE.TableCommands.$8V(c,1,r,b.rowSpan);if(n===b.rowSpan)b.parentNode.removeChild(b);else b.rowSpan=b.rowSpan-n}for(var i=a.rows.length-1;i>=0;i--){var o=a.rows[i],s=a.rows[i].cells;!s.length&&o.parentNode.removeChild(o)}if(p)if(!a.rows.length){RTE.Cursor.get_range().moveAfterNode(a);a.parentNode.removeChild(a)}else{var l=null;if(c>=a.rows.length)l=a.rows[a.rows.length-1];else l=a.rows[c];RTE.Cursor.get_range().moveToNode(l.childNodes[0])}}};RTE.TableCommands.$CY=function(b,a){ULSNVe:;if(b)RTE.TableCommands.setHeaderRow(a,true);else RTE.TableCommands.$24(a)};RTE.TableCommands.$DD=function(){ULSNVe:;var d=RTE.Cursor.getCurrentElement();if(!d)return;if(d.tagName!=="TR")return;var f=RTE.RteUtility.$G(d,"TABLE");if(!f)return;if(!RTE.Canvas.isEditable(f))return;var a=RTE.TableCommands.$Ic();if(a.length>1){var b=a[0],e=new Sys.StringBuilder;e.append(b.innerHTML);for(var g=RTE.TableCommands.$3o(b),c=1;c<a.length;c++){e.append(" ");e.append(a[c].innerHTML);g+=RTE.TableCommands.$3o(a[c]);d.removeChild(a[c])}RTE.RteUtility.$2p(b,e.toString());RTE.TableCommands.$9q(b,g);var h=RTE.Cursor.get_range();h.moveToStartOfNode(b);RTE.TableCommands.$24(f);RTE.Cursor.update()}};RTE.TableCommands.showInsertTableDialog=function(){ULSNVe:;RTE.RteUtility.classMustExist("SP.UI.ModalDialog");RTE.RteUtility.classMustExist("SP.Utilities.Utility");RTE.RteUtility.classMustExist("SP.PageContextInfo");RTE.PreviewManager.get_instance().endPreview();var a=new SP.UI.DialogOptions,b=SP.PageContextInfo.get_currentLanguage();a.url=SP.Utilities.Utility.getLayoutsPageUrl("RteDialog.aspx?LCID="+b.toString()+"&Dialog=InsertTable&UseDivDialog=true");a.autoSizeStartWidth=300;a.autoSize=true;a.dialogReturnValueCallback=RTE.TableCommands.$LN;SP.UI.ModalDialog.showModalDialog(a)};RTE.TableCommands.$LN=function(e,f){ULSNVe:;if(e===1){var a=f,c=a[0],d=a[1];if(typeof a[0]==="string")c=parseInt(a[0]);if(typeof a[1]==="string")d=parseInt(a[1]);var b=new RTE.InsertTableOptions;b.columns=c;b.rows=d;b.commandType=0;RTE.TableCommands.insertTable(b)}};RTE.TableCommands.$x=function(j,g,k){ULSNVe:;var a=new RTE.TableGrid;a.columns=[];a.targetCellColSpanIndex=-1;a.totalColSpan=-1;for(var c=0;c<j.rows.length;c++){for(var b=0,i=j.rows[c].cells,h=0;h<i.length;h++){while(a.columns[b]&&a.columns[b].cells[c])b++;if(!a.columns[b]){a.columns[b]=new RTE.TableColumnInfo;a.columns[b].cells=[]}var e=i[h];if(e===g)a.targetCellColSpanIndex=b;a.columns[b].cells[c]=new RTE.TableCellInfo;a.columns[b].cells[c].cell=e;a.columns[b].cells[c].colSpanIndex=b;for(var d=0;d<e.colSpan;d++){if(!a.columns[b+d]){a.columns[b+d]=new RTE.TableColumnInfo;a.columns[b+d].cells=[]}for(var f=0;f<e.rowSpan;f++){a.columns[b+d].cells[c+f]=new RTE.TableCellInfo;a.columns[b+d].cells[c+f].cell=e;a.columns[b+d].cells[c+f].colSpanIndex=b}}b+=e.colSpan;if(k)if(a.targetCellColSpanIndex!==-1&&b>a.targetCellColSpanIndex+g.colSpan&&c!==g.parentNode.rowIndex+g.rowSpan-1)break}if(b>a.totalColSpan)a.totalColSpan=b}return a};RTE.TableCommands.queryTableWidth=function(){ULSNVe:;var c=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Table");if(!b||!RTE.Canvas.isEditable(b))return c;c.$C_0=true;var a=b.style.width;if(RTE.SU.$2(a))a=b.width;if(RTE.SU.$2(a)||!RTE.RteUtility.$3C(RTE.TableCommands.$5k,a))a=b.offsetWidth.toString()+"px";c.$D_0=a;return c};RTE.TableCommands.queryTableHeight=function(){ULSNVe:;var c=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Table");if(!b||!RTE.Canvas.isEditable(b))return c;c.$C_0=true;var a=b.style.height;if(RTE.SU.$2(a))a=b.height;if(RTE.SU.$2(a)||!RTE.RteUtility.$3C(RTE.TableCommands.$5k,a))a=b.offsetHeight.toString()+"px";c.$D_0=a;return c};RTE.TableCommands.queryTableRowHeight=function(){ULSNVe:;var a=new RTE.CommandState,b=RTE.Cursor.$1G(RTE.HtmlTagName.tableCellTagNames);if(!b||!RTE.Canvas.isEditable(b))return a;var d=RTE.RteUtility.$G(b,"TABLE");if(!d||!RTE.Canvas.isEditable(d))return a;a.$C_0=true;var c=b.style.height;if(RTE.SU.$2(c)||!RTE.RteUtility.$3C(RTE.TableCommands.$5k,c))c=b.offsetHeight.toString()+"px";a.$D_0=c;return a};RTE.TableCommands.queryTableColumnWidth=function(){ULSNVe:;var a=new RTE.CommandState,b=RTE.Cursor.$1G(RTE.HtmlTagName.tableCellTagNames);if(!b||!RTE.Canvas.isEditable(b))return a;var d=RTE.RteUtility.$G(b,"TABLE");if(!d||!RTE.Canvas.isEditable(d))return a;a.$C_0=true;var c=b.style.width;if(RTE.SU.$2(c)||!RTE.RteUtility.$3C(RTE.TableCommands.$5k,c))c=b.offsetWidth.toString()+"px";a.$D_0=c;return a};RTE.TableCommands.setTableWidth=function(b){ULSNVe:;var a=RTE.CanvasEvents.getNodeFromEvent("Table");if(!a)return;if(!RTE.Canvas.isEditable(a))return;RTE.RteUtility.getAttribute(a,"width")&&a.removeAttribute("width");RTE.SnapshotManager.setCurrentRegionDirtyIf(a.style.width!==b);a.style.width=b};RTE.TableCommands.setTableHeight=function(b){ULSNVe:;var a=RTE.CanvasEvents.getNodeFromEvent("Table");if(!a)return;if(!RTE.Canvas.isEditable(a))return;RTE.RteUtility.getAttribute(a,"height")&&a.removeAttribute("height");RTE.SnapshotManager.setCurrentRegionDirtyIf(a.style.height!==b);a.style.height=b};RTE.TableCommands.setTableColumnWidth=function(k){ULSNVe:;var b=RTE.Cursor.$1G(RTE.HtmlTagName.tableCellTagNames);if(!b)return;var c=RTE.RteUtility.$G(b,"TABLE");if(!c)return;if(!RTE.Canvas.isEditable(c))return;for(var h=RTE.TableCommands.$x(c,b,false),i=h.targetCellColSpanIndex,l=b.colSpan,d=[],j=[],g=0;g<c.rows.length*2;g++){var e=h.columns[i].cells[g];if(!RTE.SU.$7(e))if(!Array.contains(d,e.cell)){Array.add(d,e.cell);Array.add(j,e.colSpanIndex)}}for(var f=0;f<d.length;f++){var a=d[f],m=j[f];if(m===i&&a.colSpan===l){a.attributes.getNamedItem("width")&&a.removeAttribute("width");RTE.SnapshotManager.setCurrentRegionDirtyIf(a.style.width!==k);a.style.width=k}}};RTE.TableCommands.setTableRowHeight=function(g){ULSNVe:;var b=RTE.Cursor.$1G(RTE.HtmlTagName.tableCellTagNames);if(!b)return;var d=RTE.RteUtility.$G(b,"TR");if(!b)return;var e=RTE.RteUtility.$G(d,"TABLE");if(!e)return;if(!RTE.Canvas.isEditable(e))return;for(var f=d.cells,c=0;c<f.length;c++){var a=f[c];if(a.rowSpan===b.rowSpan){RTE.RteUtility.getAttribute(a,"height")&&a.removeAttribute("height");RTE.SnapshotManager.setCurrentRegionDirtyIf(a.style.height!==g);a.style.height=g}}};RTE.TableCommands.$Ip=function(d,f){ULSNVe:;for(var e=true,b=0;b<d.columns.length;b++){var c=d.columns[b].cells;if(c&&f<c.length){var a=c[f];if(a&&a.cell)if(a.cell.tagName==="TH"){if(a.colSpanIndex&&a.colSpanIndex+a.cell.colSpan!==d.totalColSpan)return true}else e=false}}return e};RTE.TableCommands.$Io=function(g,h){ULSNVe:;var d=true;if(h<g.columns.length){var a=g.columns[h].cells;if(a&&a.length>0){var e=null,f=null;if(a[0])e=a[0].cell;if(a[a.length-1])f=a[a.length-1].cell;for(var c=0;c<a.length;c++){var b=a[c];if(b&&b.cell)if(b.cell.tagName==="TH"){if(b.cell!==e&&b.cell!==f)return true}else d=false}}}return d};RTE.TableCommands.$CC=function(a,e,b){ULSNVe:;if(a.rows.length>0){var c=a.rows[b];if(c.className.indexOf("Table"+e)!==-1)return true;else{var d=RTE.TableCommands.$x(a,null,false);return RTE.TableCommands.$Ip(d,b)}}return true};RTE.TableCommands.hasHeaderRow=function(a){ULSNVe:;return RTE.TableCommands.$CC(a,"Header",0)};RTE.TableCommands.hasFooterRow=function(a){ULSNVe:;return RTE.TableCommands.$CC(a,"Footer",a.rows.length-1)};RTE.TableCommands.$CB=function(d,e,f){ULSNVe:;if(f<d.columns.length){var a=d.columns[f].cells;if(a){for(var b=0;b<a.length;b++)if(a[b]&&a[b].cell){var c=a[b].cell;if(c.className.indexOf("Table"+e)!==-1)return true;else if(c.className.indexOf("TableHeader"+e)!==-1)return true;else if(c.className.indexOf("TableFooter"+e)!==-1)return true}if(a.length>0)return RTE.TableCommands.$Io(d,f)}}return true};RTE.TableCommands.hasFirstColumn=function(b){ULSNVe:;var a=RTE.TableCommands.$x(b,null,false);return RTE.TableCommands.$CB(a,"First",0)};RTE.TableCommands.hasLastColumn=function(b){ULSNVe:;var a=RTE.TableCommands.$x(b,null,false);return a.totalColSpan>0?RTE.TableCommands.$CB(a,"Last",a.totalColSpan-1):false};RTE.TableCommands.$7P=function(b,c){ULSNVe:;var a=null;if(b.tagName==="TD"&&c)a=document.createElement("TH");else if(b.tagName==="TH"&&!c)a=document.createElement("TD");if(a){RTE.RteUtility.$k(b,a);a.style.cssText=b.style.cssText;a.className=b.className;a.rowSpan=b.rowSpan;a.colSpan=b.colSpan;b.parentNode.replaceChild(a,b)}};RTE.TableCommands.$9v=function(d,g,h){ULSNVe:;if(d.rows.length>0)for(var e=RTE.TableCommands.$x(d,null,false),b=0;b<e.columns.length;b++){var c=e.columns[b].cells;if(c&&g<c.length){var a=c[g];if(a&&a.cell){var f=a.cell;if(!a.colSpanIndex&&RTE.TableCommands.hasFirstColumn(d))RTE.TableCommands.$7P(f,true);else RTE.TableCommands.$7P(f,h)}}}};RTE.TableCommands.setHeaderRow=function(a,b){ULSNVe:;RTE.TableCommands.$9v(a,0,b);var c=RTE.TableCommands.$4t(a),d=RTE.TableCommands.hasFooterRow(a),e=RTE.TableCommands.hasFirstColumn(a),f=RTE.TableCommands.hasLastColumn(a);RTE.TableCommands.$5a(a,c,b,d,e,f,false);RTE.Cursor.update()};RTE.TableCommands.setFooterRow=function(a,b){ULSNVe:;!b&&RTE.TableCommands.$9v(a,a.rows.length-1,b);var c=RTE.TableCommands.$4t(a),d=RTE.TableCommands.hasHeaderRow(a),e=RTE.TableCommands.hasFirstColumn(a),f=RTE.TableCommands.hasLastColumn(a);RTE.TableCommands.$5a(a,c,d,b,e,f,false);RTE.Cursor.update()};RTE.TableCommands.$9p=function(g,e,f,h){ULSNVe:;if(f<e.columns.length){var b=e.columns[f].cells;if(b)for(var a=0;a<b.length;a++){var c=b[a];if(c&&c.cell){var d=c.cell;if(!a&&RTE.TableCommands.hasHeaderRow(g))RTE.TableCommands.$7P(d,true);else RTE.TableCommands.$7P(d,h)}}}};RTE.TableCommands.setFirstColumn=function(a,b){ULSNVe:;var c=RTE.TableCommands.$x(a,null,false);RTE.TableCommands.$9p(a,c,0,b);var d=RTE.TableCommands.$4t(a),e=RTE.TableCommands.hasHeaderRow(a),f=RTE.TableCommands.hasFooterRow(a),g=RTE.TableCommands.hasLastColumn(a);RTE.TableCommands.$5a(a,d,e,f,b,g,false);RTE.Cursor.update()};RTE.TableCommands.setLastColumn=function(a,b){ULSNVe:;if(!b){var c=RTE.TableCommands.$x(a,null,false);RTE.TableCommands.$9p(a,c,c.totalColSpan-1,b)}var d=RTE.TableCommands.$4t(a),e=RTE.TableCommands.hasHeaderRow(a),f=RTE.TableCommands.hasFooterRow(a),g=RTE.TableCommands.hasFirstColumn(a);RTE.TableCommands.$5a(a,d,e,f,g,b,false);RTE.Cursor.update()};RTE.TableCommands.$4t=function(f){ULSNVe:;var b=f.className,c="Table-",d=b.indexOf(c);if(d!==-1){var a=b.substr(d+c.length),e=a.indexOf(" ");return e!==-1?a.substring(0,e):a}return null};RTE.TableCommands.$24=function(a){ULSNVe:;var b=RTE.TableCommands.$4t(a);RTE.TableCommands.setTableStyle(a,b,false)};RTE.TableCommands.hasTableStyle=function(a){ULSNVe:;if(a&&a.className){var b=RTE.Canvas.getCurrentStyleSheetPrefix();return a.className.indexOf(b+"Table")!==-1}return false};RTE.TableCommands.getTableStyle=function(c){ULSNVe:;if(c&&c.className)for(var d=RTE.Canvas.getCurrentStyleSheetPrefix(),b=c.className.split(" "),a=0;a<b.length;a++)if(b[a].indexOf(d+"Table")!==-1)return b[a];return null};RTE.TableCommands.setTableStyle=function(a,f,g){ULSNVe:;var b=RTE.TableCommands.hasHeaderRow(a),c=RTE.TableCommands.hasFooterRow(a),d=RTE.TableCommands.hasFirstColumn(a),e=RTE.TableCommands.hasLastColumn(a);RTE.TableCommands.$5a(a,f,b,c,d,e,g)};RTE.TableCommands.$5a=function(a,e,r,s,t,u,v){ULSNVe:;var b=RTE.Canvas.getCurrentStyleSheetPrefix(),p=RTE.TableCommands.$AZ(a),f;if(v)f=[b+"Table",b+"BackColor",b+"ThemeBackColor"];else f=[b+"Table"];var j=false;RTE.RteUtility.assertNotNull("Cursor.GetSelectedTable()",a);var l="";if(!RTE.SU.$2(e))l=b+"Table-"+e;var q=a.className;RTE.RteUtility.$25(a,l,f);if(q!==a.className){j=true;a.removeAttribute("border");RTE.TableCommands.$86(a.style)}for(var c=0;c<a.rows.length;c++){var g=a.rows[c],k="",h="";if(!c&&r){h="Header";k="Header"}else if(c===a.rows.length-1&&s){h="Footer";k="Footer"}else if(c%2===1)h="Odd";else h="Even";var m="";if(!RTE.SU.$2(e))m=b+"Table"+h+"Row-"+e;RTE.RteUtility.$25(g,m,f);j&&RTE.TableCommands.$86(g.style);for(var d=0;d<g.cells.length;d++){var n=g.cells[d],i="";if(!d&&t)i="First";else if(d===g.cells.length-1&&u)i="Last";else if(d%2===1)i="Odd";else i="Even";var o="";if(!RTE.SU.$2(e))o=b+"Table"+k+i+"Col-"+e;RTE.RteUtility.$25(n,o,f);j&&RTE.TableCommands.$86(n.style)}}!RTE.PreviewManager.get_instance().get_hasPreview()&&RTE.TableCommands.$EE(a,p)};RTE.TableCommands.$86=function(a){ULSNVe:;RTE.RteUtility.$15(a,"border");RTE.RteUtility.$15(a,"background");RTE.RteUtility.$15(a,"color");RTE.RteUtility.$15(a,"direction");RTE.RteUtility.$15(a,"font");RTE.RteUtility.$15(a,"margin");RTE.RteUtility.$15(a,"padding");RTE.RteUtility.$15(a,"textAlign");RTE.RteUtility.$15(a,"textDecoration");RTE.RteUtility.$15(a,"textJustify");RTE.RteUtility.$15(a,"textTransform");RTE.RteUtility.$15(a,"verticalAlign");a.cssText=a.cssText.replace(new RegExp("(border-width|border-color)[^;]*;","gi"),"")};RTE.TableCommands.clearTableStyle=function(){ULSNVe:;var a=RTE.CanvasEvents.getNodeFromEvent("Table"),b=RTE.Canvas.getCurrentStyleSheetPrefix();RTE.RteUtility.$25(a,"",[b+"Table"]);for(var c=0;c<a.rows.length;c++){var e=a.rows[c];RTE.RteUtility.$25(e,"",[b+"Table"])}for(var d=0;d<a.cells.length;d++){var f=a.cells[d];RTE.RteUtility.$25(f,"",[b+"Table"])}};RTE.TableCommands.setTableGridLines=function(b){ULSNVe:;var a=RTE.CanvasEvents.getNodeFromEvent("Table");if(null===a)return;RTE.TableCommands.$EE(a,b)};RTE.TableCommands.queryTableGridLines=function(){ULSNVe:;var a=new RTE.CommandState,b=RTE.CanvasEvents.getNodeFromEvent("Table");if(!b)return a;a.$C_0=true;a.$1I_0=RTE.TableCommands.$AZ(b);return a};RTE.TableCommands.$EE=function(a,b){ULSNVe:;if(b)Sys.UI.DomElement.addCssClass(a,RTE.TableCommands.$7V);else Sys.UI.DomElement.removeCssClass(a,RTE.TableCommands.$7V)};RTE.TableCommands.$AZ=function(a){ULSNVe:;return!RTE.SU.$2(a.className)&&a.className.indexOf(RTE.TableCommands.$7V)>=0};RTE.TableCommands.canInsertRow=function(){ULSNVe:;var a;if(null===(a=RTE.Cursor.getNearestContainingElementOfType("TR")))return false;var b;return null===(b=RTE.RteUtility.$G(a,"TABLE"))?false:RTE.Canvas.isEditable(b)};RTE.TableCommands.canInsertColumn=function(){ULSNVe:;var a;if(null===(a=RTE.Cursor.$1G(RTE.HtmlTagName.tableCellTagNames)))return false;var b;return null===(b=RTE.RteUtility.$G(a,"TABLE"))?false:RTE.Canvas.isEditable(b)};RTE.TableCommands.canMergeCells=function(){ULSNVe:;var a;if(null===(a=RTE.Cursor.getCurrentElement()))return false;var b;if(null===(b=RTE.RteUtility.$2d(a,RTE.HtmlTagName.tableCellTagNames)))return false;var c;if(null===(c=RTE.RteUtility.$G(b,"TR")))return false;var d;return null===(d=RTE.RteUtility.$G(c,"TABLE"))?false:RTE.Canvas.isEditable(d)};RTE.TableCommands.canMergeSelected=function(){ULSNVe:;var a;if(null===(a=RTE.Cursor.getCurrentElement())||"TR"!==a.tagName)return false;var b;return null===(b=RTE.RteUtility.$G(a,"TABLE"))?false:RTE.Canvas.isEditable(b)};RTE.TableCommands.canSplit=function(){ULSNVe:;var a;if(null===(a=RTE.Cursor.$1G(RTE.HtmlTagName.tableCellTagNames)))return false;var b;if(null===(b=RTE.RteUtility.$G(a,"TR")))return false;var c;return null===(c=RTE.RteUtility.$G(b,"TABLE"))?false:RTE.Canvas.isEditable(c)};RTE.TableKeyTabProcessor=function(a){ULSNVe:;this.$43_0=a;this.$3M_0=RTE.Cursor.$1G(RTE.HtmlTagName.tableCellTagNames);this.$6r_0=RTE.RteUtility.$G(this.$3M_0,"TR");this.$98_0=RTE.RteUtility.$G(this.$6r_0,"TABLE")};RTE.TableKeyTabProcessor.prototype={$3M_0:null,$6r_0:null,$98_0:null,$43_0:false,process:function(){ULSNVe:;if(!this.$3M_0||!this.$6r_0||!this.$98_0)return false;var a=this.$43_0?RTE.RteUtility.$t(this.$3M_0,false):RTE.RteUtility.$m(this.$3M_0,false);if(!a){var b=this.$43_0?RTE.RteUtility.$t(this.$3M_0.parentNode,false):RTE.RteUtility.$m(this.$3M_0.parentNode,false);if(b)a=this.$43_0?b.children[0]:b.children[b.children.length-1]}if(!a){var c=RTE.TableCommands.$CS(this.$98_0,this.$6r_0,!this.$43_0);a=this.$43_0?c.children[0]:c.children[c.children.length-1]}if(a&&a.nodeType===1){var d=RTE.Cursor.get_range();d.moveToEndOfNode(a);RTE.Cursor.update();return true}return false}};RTE.XhtmlProcessor=function(){};RTE.XhtmlProcessor.$Hc=function(){ULSNVe:;if(null!==RTE.XhtmlProcessor.$3T)return;if(RTE.RteUtility.isClassAvailable("SP.UI.ModalDialog"))RTE.XhtmlProcessor.$3T=SP.UI.ModalDialog.showWaitScreenSize(SP.Res.xhtmlWaitScreenTitle,SP.Res.xhtmlWaitScreenText,RTE.XhtmlProcessor.$Lq,80,200)};RTE.XhtmlProcessor.$Ft=function(){ULSNVe:;if(null!==RTE.XhtmlProcessor.$3T){RTE.XhtmlProcessor.$3T.close(1);RTE.XhtmlProcessor.$3T=null}};RTE.XhtmlProcessor.xhtmlify=function(){ULSNVe:;if(null===(RTE.XhtmlProcessor.$2M=RTE.Cursor.getCurrentElement()))return;if(null===(RTE.XhtmlProcessor.$2M=RTE.Canvas.getEditableRegion(RTE.XhtmlProcessor.$2M)))return;RTE.XhtmlProcessor.$Hc();window.setTimeout(RTE.XhtmlProcessor.$Lp,0)};RTE.XhtmlProcessor.$Lp=function(){ULSNVe:;RTE.RteUtility.$J(RTE.Cursor.get_range().$3_0);RTE.RteUtility.$J(RTE.Cursor.get_range().$4_0);RTE.RteUtility.$9t(RTE.XhtmlProcessor.$2M,RTE.Canvas.getEditableRegionHtml(RTE.XhtmlProcessor.$2M));RTE.SafeHtml.$9V(RTE.XhtmlProcessor.$2M,false,false,false);RTE.XhtmlProcessor.$Hf(RTE.XhtmlProcessor.$2M);RTE.RteUtility.isClassAvailable("SP.UI.Notify")&&SP.UI.Notify.addNotification(SP.Res.xhtmlDone,false);RTE.XhtmlProcessor.$Ft();RTE.Cursor.get_range().moveToEndOfNode(RTE.XhtmlProcessor.$2M);RTE.Cursor.update()};RTE.XhtmlProcessor.$Lq=function(){ULSNVe:;RTE.XhtmlProcessor.$3T=null};RTE.XhtmlProcessor.$Hf=function(b){ULSNVe:;var a=new RTE.DOMTreePosition(b,0),c,d=a.$1_0;while(a.moveToNextElement()){if(b===a.$1_0.previousSibling)break;if(b===a.$1_0)break;if(d.parentNode!==a.$1_0)if(!SP.UI.UIUtility.isTextNode(a.$1_0)&&-1!==a.$1_0.className.indexOf("ms-rtestate-read"))a.setLocationAtEnd();else if(null!==(c=RTE.XhtmlProcessor.$Eg(a.$1_0,b))){a=null;a=new RTE.DOMTreePosition(c,0)}d=a.$1_0}};RTE.XhtmlProcessor.$Eg=function(a,k){ULSNVe:;var g,h,i=null;g=RTE.XhtmlProcessor.$Ie(a,k);if(null!==g)h=g.pop();else h=null;if(!SP.UI.UIUtility.isTextNode(a))switch(a.tagName){case"TABLE":case"TBODY":case"TR":RTE.XhtmlProcessor.$Hq(a);break;case"OL":case"UL":RTE.XhtmlProcessor.$Hl(a)}if(h!==a.parentNode)if(SP.UI.UIUtility.isTextNode(a)&&!RTE.RteUtility.$JT(a.nodeValue)){var j=new RTE.DOMTreePosition(a,0);j.moveToPreviousElement();i=j.$1_0;SP.UI.UIUtility.removeNode(a)}else if(null===h){var b,c;switch(a.tagName){case"LI":b="UL";c=false;break;case"TD":case"TH":b="TR";c=false;break;case"TR":b="TBODY";c=false;break;case"TBODY":b="TABLE";c=false;break;default:b="DIV";c=true}var d=document.createElement(b);if(c)d.innerText=a.innerText;a.parentNode.replaceChild(d,a);!c&&d.appendChild(a);!RTE.XhtmlRules.isValidChild(d.parentNode.tagName,b)&&RTE.XhtmlProcessor.$Eg(d,k);i=d}else{var e=g.pop(),f=RTE.RteUtility.$Fs(e,false);RTE.RteUtility.$Ea(f,e,null);var l=new RTE.ExtractChildNodesProcessor(e,a,null,f,false);l.process();RTE.RteUtility.$Ea(a,e,f);!RTE.RteUtility.$4c(e)&&SP.UI.UIUtility.removeNode(e);!RTE.RteUtility.$4c(f)&&SP.UI.UIUtility.removeNode(f)}return i};RTE.XhtmlProcessor.$Ie=function(c,f){ULSNVe:;if(null===c)return null;var b=[],e=SP.UI.UIUtility.isTextNode(c),a=c.parentNode,d=c;while(null!==a){if(e){if(RTE.XhtmlRules.canHaveInlineChildren(a.tagName)){b.push(d);b.push(a);return b}}else if(RTE.XhtmlRules.isValidChild(a.tagName,c.tagName)){b.push(d);b.push(a);return b}d=a;a=a.parentNode;if(d===f)break}return null};RTE.XhtmlProcessor.$Hq=function(c){ULSNVe:;var a=[];switch(c.tagName){case"TABLE":Array.add(a,"TBODY");break;case"TBODY":Array.add(a,"TR");break;case"TR":Array.add(a,"TD");Array.add(a,"TH")}var b=c.firstChild;while(null!==b){if(!SP.UI.UIUtility.isTextNode(b)&&Array.contains(a,b.tagName))return;b=b.nextSibling}var d=document.createElement(a[0]);c.appendChild(d)};RTE.XhtmlProcessor.$Hl=function(d){ULSNVe:;var a=d.firstChild,b=null,c=null;while(null!==a){if(!SP.UI.UIUtility.isTextNode(a)&&SP.UI.UIUtility.isNodeOfType(a,RTE.HtmlTagName.$Cw))if(null===b||SP.UI.UIUtility.isTextNode(b)||"LI"!==b.tagName){c=document.createElement("LI");d.insertBefore(c,a);c.appendChild(a)}else b.appendChild(a);if(null!==c){b=c;c=null}else b=a;a=a.nextSibling}};RTE.XhtmlProcessor.$Hn=function(b){ULSNVe:;if(!SP.UI.UIUtility.isNodeOfType(b,RTE.HtmlTagName.$6D)){for(var d=false,a=[],e=b.childNodes.length-1;e>=0;e--){var c=b.childNodes[e];if(c.tagName==="LI"){d=true;a.push(c)}else if(SP.UI.UIUtility.isNodeOfType(c,RTE.HtmlTagName.$6D))a.push(c);else if(a.length>0&&d){var g=RTE.XhtmlProcessor.$B3(a);SP.UI.UIUtility.insertAfter(g,c)}}if(a.length>0&&d){var f=RTE.XhtmlProcessor.$B3(a);if(b.firstChild)SP.UI.UIUtility.insertBefore(f,b.firstChild);else b.appendChild(f)}}};RTE.XhtmlProcessor.$B3=function(d){ULSNVe:;var b=document.createElement("UL");while(d.length>0){var a=d.pop();if(a.tagName==="LI"||SP.UI.UIUtility.isNodeOfType(a,RTE.HtmlTagName.$6D))b.appendChild(a);else{var c=document.createElement("LI");b.appendChild(c);c.appendChild(a)}}return b};RTE.XhtmlRules=function(){};RTE.XhtmlRules.$CN=function(){ULSNVe:;if(!SP.ScriptUtility.isNullOrUndefined(RTE.XhtmlRules.$A))return;RTE.XhtmlRules.$A={};RTE.XhtmlRules.$A.HR=0;RTE.XhtmlRules.$A.BR=1;RTE.XhtmlRules.$A.IMG=2;RTE.XhtmlRules.$A.SUB=3;RTE.XhtmlRules.$A.SUP=4;RTE.XhtmlRules.$A.BIG=5;RTE.XhtmlRules.$A.SMALL=6;RTE.XhtmlRules.$A.SPAN=7;RTE.XhtmlRules.$A.B=8;RTE.XhtmlRules.$A.I=9;RTE.XhtmlRules.$A.U=10;RTE.XhtmlRules.$A.STRONG=11;RTE.XhtmlRules.$A.EM=12;RTE.XhtmlRules.$A.A=13;RTE.XhtmlRules.$A.H1=14;RTE.XhtmlRules.$A.H2=15;RTE.XhtmlRules.$A.H3=16;RTE.XhtmlRules.$A.H4=17;RTE.XhtmlRules.$A.H5=18;RTE.XhtmlRules.$A.H6=19;RTE.XhtmlRules.$A.P=20;RTE.XhtmlRules.$A.DEL=21;RTE.XhtmlRules.$A.DIV=22;RTE.XhtmlRules.$A.TABLE=23;RTE.XhtmlRules.$A.CAPTION=24;RTE.XhtmlRules.$A.COLGROUP=25;RTE.XhtmlRules.$A.COL=26;RTE.XhtmlRules.$A.THEAD=27;RTE.XhtmlRules.$A.TFOOT=28;RTE.XhtmlRules.$A.TBODY=29;RTE.XhtmlRules.$A.TR=30;RTE.XhtmlRules.$A.TD=31;RTE.XhtmlRules.$A.TH=32;RTE.XhtmlRules.$A.OL=33;RTE.XhtmlRules.$A.UL=34;RTE.XhtmlRules.$A.LI=35;RTE.XhtmlRules.$A.DL=36;RTE.XhtmlRules.$A.DT=37;RTE.XhtmlRules.$A.DD=38;RTE.XhtmlRules.$A.CODE=39;RTE.XhtmlRules.$A.CITE=40;RTE.XhtmlRules.$A.ACRONYM=41;RTE.XhtmlRules.$A.ABBR=42;RTE.XhtmlRules.$A.KBD=43;RTE.XhtmlRules.$A.SAMP=44;RTE.XhtmlRules.$A.VAR=45;RTE.XhtmlRules.$A.DFN=46;RTE.XhtmlRules.$A.TT=47;RTE.XhtmlRules.$A.BDO=48;RTE.XhtmlRules.$A.LABEL=49;RTE.XhtmlRules.$A.Q=50;RTE.XhtmlRules.$A.ADDRESS=51;RTE.XhtmlRules.$A.INS=52;RTE.XhtmlRules.$A.PRE=53;RTE.XhtmlRules.$A.BLOCKQUOTE=54;RTE.XhtmlRules.$A.NOSCRIPT=55;RTE.XhtmlRules.$A.MAP=56;RTE.XhtmlRules.$A.AREA=57};RTE.XhtmlRules.isValidChild=function(b,c){ULSNVe:;RTE.XhtmlRules.$CN();var a=RTE.XhtmlRules.$A[b]*59+RTE.XhtmlRules.$A[c];return!!RTE.XhtmlRules.$9R[a]};RTE.XhtmlRules.canHaveInlineChildren=function(b){ULSNVe:;RTE.XhtmlRules.$CN();var a=(RTE.XhtmlRules.$A[b]+1)*59-1;return!!RTE.XhtmlRules.$9R[a]};RTE.RibbonReferences=function(){};RTE.RibbonReferences.$3S=function(a){ULSNVe:;a=a.replace("$Resources:core,Language;",SP.Res.lcid);return a};RTE.RibbonReferences.$4b=function(c,d,e,f,g){ULSNVe:;var b=document.createElement("IMG");b.src=c;b.style.left=d+"px";b.style.top=e+"px";var a=document.createElement("SPAN");a.style.width=f+"px";a.style.height=g+"px";a.style.overflow="hidden";a.appendChild(b);return a};Type.registerNamespace("RTE.PasteCommon");RTE.PasteCommon.Debug=function(){};RTE.PasteCommon.Debug.$1u=function(a,b,c){ULSNVe:;!a&&RTE.PasteCommon.Debug.$5t(b,c)};RTE.PasteCommon.Debug.$E=function(a,b){ULSNVe:;RTE.PasteCommon.Debug.$5t(a,b)};RTE.PasteCommon.Debug.assertTag=function(a,b){ULSNVe:;!a&&RTE.PasteCommon.Debug.$5t("Failed assert",b)};RTE.PasteCommon.Debug.$Je=function(){};RTE.PasteCommon.Debug.$7m=function(a){ULSNVe:;RTE.PasteCommon.Debug.$E("Failed assert not reached",a)};RTE.PasteCommon.Debug.$Aa=function(a,b,c){ULSNVe:;a&&!b&&RTE.PasteCommon.Debug.$5t("Assert implies failed",c)};RTE.PasteCommon.Debug.$5t=function(){};RTE.PasteCommon.Debug.assertString=function(a,b){ULSNVe:;RTE.PasteCommon.Debug.$1u(a,b,0)};RTE.PasteCommon.Debug.assertNotReachedString=function(a){ULSNVe:;RTE.PasteCommon.Debug.$E(a,0)};RTE.PasteCommon.Debug.assert=function(a){ULSNVe:;RTE.PasteCommon.Debug.assertTag(a,0)};RTE.PasteCommon.Debug.log=function(a,b,c){ULSNVe:;RTE.PasteCommon.Debug.$Je(a,b,c,0)};RTE.PasteCommon.Debug.assertNotReached=function(){ULSNVe:;RTE.PasteCommon.Debug.$7m(0)};RTE.PasteCommon.LogLevel=function(){};RTE.PasteCommon.StringUtils=function(){};RTE.PasteCommon.StringUtils.toLower=function(a){ULSNVe:;return a.toLowerCase()};RTE.PasteCommon.StringUtils.toUpper=function(a){ULSNVe:;return a.toUpperCase()};RTE.PasteCommon.CustomData=function(){};RTE.PasteCommon.CustomData.$4J=function(c,d,e){ULSNVe:;if(RTE.RteUtility.isValidRteNodeId(c)){var b=RTE.RteUtility.getRteNodeId(c);if(!RTE.SU.$2(b)){var a=RTE.PasteCommon.CustomData.dict[b];if(RTE.SU.$7(a)){a={};RTE.PasteCommon.CustomData.dict[b]=a}a[d]=e}}};RTE.PasteCommon.CustomData.getObject=function(c,d){ULSNVe:;if(RTE.RteUtility.isValidRteNodeId(c)){var a=RTE.RteUtility.getRteNodeId(c);if(!RTE.SU.$2(a)){var b=RTE.PasteCommon.CustomData.dict[a];if(!RTE.SU.$7(b))return b[d]}}return null};RTE.PasteCommon.CustomData.removeObject=function(a,b){ULSNVe:;RTE.PasteCommon.CustomData.$4J(a,b,null)};RTE.PasteCommon.AOperation=function(){};RTE.PasteCommon.SimpleOperation=function(a,b,c){ULSNVe:;RTE.PasteCommon.SimpleOperation.initializeBase(this);this.$V_1=a;this.$9x_1=c;this.$82_1=b;this.$3f_1=this.$V_1?this.$V_1.$3f_1:new SP.Utilities.CommandBlock(this,RTE.PasteCommon.SimpleOperation.$KR,RTE.PasteCommon.SimpleOperation.$Hk);this.$4Z_1=this.$V_1?this.$V_1.$4Z_1:new SP.Utilities.Task(null,0,192e4,this.$3f_1,null,null,null)};RTE.PasteCommon.SimpleOperation.$KR=function(d,c){ULSNVe:;var a=d;try{a.set_$5P_1(c);var b;do{if(!a.get_$2e_1()&&c())return a.get_$B9_1();a.$Ld_1();b=a.$82_1(a,a.$9x_1);if(!b)if(a.$V_1){a.$3f_1.state=a.$V_1;b=true}a=a.$3f_1.state}while(b&&a);return 1}catch(e){RTE.PasteCommon.Debug.assertNotReachedString(e.message);a.$4Z_1.cancel(0);throw e;}};RTE.PasteCommon.SimpleOperation.$Hk=function(c,b){ULSNVe:;var a=b;a.set_$5P_1(null)};RTE.PasteCommon.SimpleOperation.prototype={$B8_1:null,$Cp_1:false,$72_1:null,$71_1:.99,$3f_1:null,$4Z_1:null,$V_1:null,$9x_1:null,$82_1:null,get_$5P_1:function(){ULSNVe:;return!this.$V_1?this.$B8_1:this.$V_1.get_$5P_1()},set_$5P_1:function(a){ULSNVe:;this.$B8_1=a;this.$V_1&&this.$V_1.set_$5P_1(a);return a},get_$2e_1:function(){ULSNVe:;return!this.$V_1?this.$Cp_1:this.$V_1.get_$2e_1()},set_$2e_1:function(a){ULSNVe:;if(!this.$V_1)this.$Cp_1=a;else this.$V_1.set_$2e_1(a);return a},get_$B9_1:function(){ULSNVe:;return!this.$V_1?this.$71_1:this.$V_1.get_$B9_1()},get_$73_1:function(){ULSNVe:;return!this.$V_1?this.$72_1:this.$V_1.get_$73_1()},set_$73_1:function(a){ULSNVe:;if(!this.$V_1){this.$72_1=a;this.$71_1=.99}else this.$V_1.set_$73_1(a);return a},$60_1:function(a){ULSNVe:;this.$82_1=a},$9c_1:function(){ULSNVe:;this.$3f_1.state=this;!this.get_$5P_1()&&!this.get_$2e_1()&&this.$4Z_1.start()},$FM_1:function(){ULSNVe:;this.$4Z_1.cancel(0)},setDebugName:function(){},$Ld_1:function(){ULSNVe:;this.$Ec_1(this,this.$9x_1)},$Ec_1:function(a,b){ULSNVe:;try{if(!this.$V_1){if(this.$72_1)this.$71_1=Math.min(.99,this.$72_1(a,b))}else this.$V_1.$Ec_1(a,b)}catch(c){this.$71_1=.99}}};RTE.PasteCommon.HtmlProcessorPercentage=function(){ULSNVe:;this.$$d_$Lb_0=Function.createDelegate(this,this.$Lb_0);this.$3Z_0=-1};RTE.PasteCommon.HtmlProcessorPercentage.prototype={$AL_0:0,$AB_0:null,$Lb_0:function(d,c){ULSNVe:;var a=c;if(a&&a.$2Z_0){if(this.$3Z_0===-1&&a.$2Z_0.length>0)this.$3Z_0=a.$2Z_0[0].parentNode.getElementsByTagName("*").length;if(this.$3Z_0>0){var b=a.$2Z_0[a.$4e_0];if(b&&b!==this.$AB_0)if(b.nodeType===1)this.$AL_0++;this.$AB_0=b}}return this.$3Z_0>0?Math.min(.99,this.$AL_0/this.$3Z_0):.99}};Type.registerNamespace("RTE.HtmlImport");RTE.HtmlImport.HtmlProcessorArguments=function(a){ULSNVe:;this.$2Z_0=a.childNodes;this.$4e_0=0;this.$4x_0=false};RTE.HtmlImport.ProcessorInstructions=function(){};RTE.HtmlImport.ProcessorInstructions.prototype={notifyOnClose:1,ignoreCloseTag:2,pruneElement:3};RTE.HtmlImport.ProcessorInstructions.registerEnum("RTE.HtmlImport.ProcessorInstructions",false);RTE.HtmlImport.IFormattingSteward=function(){};RTE.HtmlImport.IFormattingSteward.registerInterface("RTE.HtmlImport.IFormattingSteward");RTE.HtmlImport.IHtmlEventAcceptor=function(){};RTE.HtmlImport.IHtmlEventAcceptor.registerInterface("RTE.HtmlImport.IHtmlEventAcceptor");RTE.HtmlImport.ISemanticEventAcceptor=function(){};RTE.HtmlImport.ISemanticEventAcceptor.registerInterface("RTE.HtmlImport.ISemanticEventAcceptor");RTE.HtmlImport.ListStyleType=function(){};RTE.HtmlImport.ListStyleType.prototype={unspecified:0,none:1,defaultUnordered:2,disc:3,circle:4,square:5,defaultOrdered:6,decimal:7,lowerAlpha:8,lowerRoman:9,upperAlpha:10,upperRoman:11};RTE.HtmlImport.ListStyleType.registerEnum("RTE.HtmlImport.ListStyleType",false);RTE.HtmlImport.WordConverterArguments=function(a){ULSNVe:;this.$9F_0=a;this.$2a_0=0;this.$8w_0={};this.$41_0=new Array(0);this.$1W_0=new Array(0);this.$1W_0[0]=new RTE.HtmlImport.LevelLists;this.$56_0=null};RTE.HtmlImport.LevelLists=function(){ULSNVe:;this.$8x_0={};this.$4i_0=-1};RTE.HtmlImport.ListItemMetadata=function(){};RTE.HtmlImport.ListMetadata=function(){ULSNVe:;this.$2R_0="UL";this.$3n_0=null;this.$3q_0=false;this.$6v_0=0};RTE.HtmlImport.AHtmlNormalizer=function(a){ULSNVe:;this.steward=a};RTE.HtmlImport.AHtmlNormalizer.prototype={steward:null,reset:function(){ULSNVe:;this.steward.reset()},get_defaultFormatting:function(){ULSNVe:;return this.steward.get_defaultFormatting()},onText:function(a){ULSNVe:;this.steward.onText(a)},onLineBreak:function(){ULSNVe:;this.steward.onLineBreak()},onImage:function(a){ULSNVe:;this.steward.onImage(a)},onFormattingChange:function(a){ULSNVe:;this.steward.onFormattingChange(a)},onAnchorStart:function(a){ULSNVe:;this.steward.onAnchorStart(a)},onAnchorEnd:function(){ULSNVe:;this.steward.onAnchorEnd()},onParagraphStart:function(){ULSNVe:;this.steward.onParagraphStart()},onParagraphEnd:function(){ULSNVe:;this.steward.onParagraphEnd()},onListStart:function(a){ULSNVe:;this.steward.onListStart(a)},onListEnd:function(){ULSNVe:;this.steward.onListEnd()},onListItemStart:function(a){ULSNVe:;this.steward.onListItemStart(a)},onListItemEnd:function(){ULSNVe:;this.steward.onListItemEnd()},onTableStart:function(a){ULSNVe:;this.steward.onTableStart(a)},onTableEnd:function(){ULSNVe:;this.steward.onTableEnd()},onTableRowStart:function(){ULSNVe:;this.steward.onTableRowStart()},onTableRowEnd:function(){ULSNVe:;this.steward.onTableRowEnd()},onTableCellStart:function(a){ULSNVe:;this.steward.onTableCellStart(a)},onTableCellEnd:function(){ULSNVe:;this.steward.onTableCellEnd()},onTablePartStart:function(){ULSNVe:;this.steward.onTablePartStart()},onTablePartEnd:function(){ULSNVe:;this.steward.onTablePartEnd()}};RTE.HtmlImport.AHtmlPasteSteward=function(a){ULSNVe:;this.ownerDocument=a};RTE.HtmlImport.AHtmlPasteSteward.prototype={ownerDocument:null,generatedHtmlLocation:null,reset:function(){ULSNVe:;this.generatedHtmlLocation=this.ownerDocument.body}};RTE.HtmlImport.AHtmlTranslator=function(a){ULSNVe:;this.$$d_$K4_0=Function.createDelegate(this,this.$K4_0);this.normalizer=a};RTE.HtmlImport.AHtmlTranslator.prototype={normalizer:null,$1s_0:null,$4Q_0:null,get_$B7_0:function(){ULSNVe:;return this.$4Q_0.peek()},$5o_0:false,reset:function(){ULSNVe:;this.normalizer.reset();this.$1s_0=new(RTE.HtmlImport.Stack.$$(Object));this.$4Q_0=new(RTE.HtmlImport.Stack.$$(RTE.HtmlImport.IFormattingSteward));this.$4Q_0.push(this.normalizer.get_defaultFormatting());this.$5o_0=false},onBeforeNewElement:function(){ULSNVe:;this.$5o_0=false},registerOnCloseCallback:function(a){ULSNVe:;if(!this.$5o_0){RTE.PasteCommon.Debug.$1u(!this.$1s_0.get_count()||!!this.$1s_0.peek(),"When encountering a new element, we should have a non-null callback on top of the stack if it's not empty.",582539);this.$1s_0.push(null);this.$5o_0=true}this.$1s_0.push(a)},onClose:function(){ULSNVe:;RTE.PasteCommon.Debug.$1u(!!this.$1s_0.get_count()&&!!this.$1s_0.peek(),"In OnClose, we should have a non-null callback on top of the stack.",582540);while(true){var a=this.$1s_0.pop();if(!a)break;var b=a;b()}RTE.PasteCommon.Debug.$1u(!this.$1s_0.get_count()||!!this.$1s_0.peek(),"After OnClose, we should have a non-null callback on top of the stack if it's not empty.",582541)},setFormattingFromAttributes:function(){ULSNVe:;return false},notifyNormalizerOfCurrentFormatting:function(){ULSNVe:;var a=this;return this.handleSpecifiedFormatting(function(){ULSNVe:;return true})},handleSpecifiedFormatting:function(b){ULSNVe:;var a=this.get_$B7_0().clone();if(b(a)){this.$4Q_0.push(a);this.normalizer.onFormattingChange(a);this.registerOnCloseCallback(this.$$d_$K4_0);return true}return false},handleCommonAttributes:function(a){ULSNVe:;if(!a.style)return 2;var b=this,c=this.handleSpecifiedFormatting(function(c){ULSNVe:;return b.setFormattingFromAttributes(c,a)});return c?1:2},$K4_0:function(){ULSNVe:;this.$4Q_0.pop();this.normalizer.onFormattingChange(this.get_$B7_0())},onText:function(){},onAOpen:function(){ULSNVe:;return 2},onAbbrOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("ABBR tags are transparent by default.  If this behavior has been overriden, provide a real handler",582542);return 2},onAcronymOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("ACRONYM tags are transparent by default.  If this behavior has been overriden, provide a real handler",582543);return 2},onAddressOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("ADDRESS tags are transparent by default.  If this behavior has been overriden, provide a real handler",582544);return 2},onAppletOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("APPLET tags are pruned by default.  If this behavior has been overriden, provide a real handler",582545);return 3},onAreaTag:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("AREA tags are pruned by default.  If this behavior has been overriden, provide a real handler",582546)},onBOpen:function(){ULSNVe:;return 2},onBaseTag:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("BASE tags are pruned by default.  If this behavior has been overriden, provide a real handler",582547)},onBasefontTag:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("BASEFONT tags are pruned by default.  If this behavior has been overriden, provide a real handler",582548)},onBdoOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("BDO tags are transparent by default.  If this behavior has been overriden, provide a real handler",582549);return 2},onBigOpen:function(){ULSNVe:;return 2},onBlockquoteOpen:function(){ULSNVe:;return 2},onBodyOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("BODY tags are transparent by default.  If this behavior has been overriden, provide a real handler",582550);return 2},onBrTag:function(){},onButtonOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("BUTTON tags are transparent by default.  If this behavior has been overriden, provide a real handler",582551);return 2},onCaptionOpen:function(){ULSNVe:;return 2},onCenterOpen:function(){ULSNVe:;return 2},onCiteOpen:function(){ULSNVe:;return 2},onCodeOpen:function(){ULSNVe:;return 2},onColTag:function(){},onColgroupOpen:function(){ULSNVe:;return 2},onDdOpen:function(){ULSNVe:;return 2},onDelOpen:function(){ULSNVe:;return 2},onDfnOpen:function(){ULSNVe:;return 2},onDirOpen:function(){ULSNVe:;return 2},onDivOpen:function(){ULSNVe:;return 2},onDlOpen:function(){ULSNVe:;return 2},onDtOpen:function(){ULSNVe:;return 2},onEmOpen:function(){ULSNVe:;return 2},onFieldsetOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("FIELDSET tags are transparent by default.  If this behavior has been overriden, provide a real handler",582552);return 2},onFontOpen:function(){ULSNVe:;return 2},onFormOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("FORM tags are transparent by default.  If this behavior has been overriden, provide a real handler",582553);return 2},onFrameTag:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("FRAME tags are pruned by default.  If this behavior has been overriden, provide a real handler",582554)},onFramesetOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("FRAMESET tags are transparent by default.  If this behavior has been overriden, provide a real handler",582555);return 2},onH1Open:function(){ULSNVe:;return 2},onH2Open:function(){ULSNVe:;return 2},onH3Open:function(){ULSNVe:;return 2},onH4Open:function(){ULSNVe:;return 2},onH5Open:function(){ULSNVe:;return 2},onH6Open:function(){ULSNVe:;return 2},onHeadOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("HEAD tags are pruned by default.  If this behavior has been overriden, provide a real handler",582556);return 3},onHrTag:function(){},onHtmlOpen:function(){ULSNVe:;return 2},onIOpen:function(){ULSNVe:;return 2},onIframeOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("IFRAME tags are pruned by default.  If this behavior has been overriden, provide a real handler",582557);return 3},onImgTag:function(){},onInputTag:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("INPUT tags are pruned by default.  If this behavior has been overriden, provide a real handler",582558)},onInsOpen:function(){ULSNVe:;return 2},onIsindexOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("ISINDEX tags are pruned by default.  If this behavior has been overriden, provide a real handler",582559);return 3},onKbdOpen:function(){ULSNVe:;return 2},onLabelOpen:function(){ULSNVe:;return 2},onLegendOpen:function(){ULSNVe:;return 2},onLiOpen:function(){ULSNVe:;return 2},onLinkTag:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("LINK tags are pruned by default.  If this behavior has been overriden, provide a real handler",582560)},onMapOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("MAP tags are pruned by default.  If this behavior has been overriden, provide a real handler",582561);return 3},onMenuOpen:function(){ULSNVe:;return 2},onMetaTag:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("META tags are pruned by default.  If this behavior has been overriden, provide a real handler",582562)},onNoframesOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("NOFRAMES tags are transparent by default.  If this behavior has been overriden, provide a real handler",582563);return 2},onNoscriptOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("NOSCRIPT tags are transparent by default.  If this behavior has been overriden, provide a real handler",582592);return 2},onObjectOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("OBJECT tags are pruned by default.  If this behavior has been overriden, provide a real handler",582593);return 3},onOlOpen:function(){ULSNVe:;return 2},onOptgroupOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("OPTGROUP tags are transparent by default.  If this behavior has been overriden, provide a real handler",582594);return 2},onOptionOpen:function(){ULSNVe:;return 2},onPOpen:function(){ULSNVe:;return 2},onParamTag:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("PARAM tags are pruned by default.  If this behavior has been overriden, provide a real handler",582595)},onPreOpen:function(){ULSNVe:;return 2},onQOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("Q tags are transparent by default.  If this behavior has been overriden, provide a real handler",582596);return 2},onSOpen:function(){ULSNVe:;return 2},onSampOpen:function(){ULSNVe:;return 2},onScriptOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("SCRIPT tags are pruned by default.  If this behavior has been overriden, provide a real handler",582597);return 3},onSelectOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("SELECT tags are transparent by default.  If this behavior has been overriden, provide a real handler",582598);return 2},onSmallOpen:function(){ULSNVe:;return 2},onSpanOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("SPAN tags are transparent by default.  If this behavior has been overriden, provide a real handler",582599);return 2},onStrikeOpen:function(){ULSNVe:;return 2},onStrongOpen:function(){ULSNVe:;return 2},onStyleOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("STYLE tags are pruned by default.  If this behavior has been overriden, provide a real handler",582600);return 3},onSubOpen:function(){ULSNVe:;return 2},onSupOpen:function(){ULSNVe:;return 2},onTableOpen:function(){ULSNVe:;return 2},onTbodyOpen:function(){ULSNVe:;return 2},onTdOpen:function(){ULSNVe:;return 2},onTextareaOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("TEXTAREA tags are transparent by default.  If this behavior has been overriden, provide a real handler",582601);return 2},onTfootOpen:function(){ULSNVe:;return 2},onThOpen:function(){ULSNVe:;return 2},onTheadOpen:function(){ULSNVe:;return 2},onTitleOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("TITLE tags are pruned by default.  If this behavior has been overriden, provide a real handler",582602);return 3},onTrOpen:function(){ULSNVe:;return 2},onTtOpen:function(){ULSNVe:;return 2},onUOpen:function(){ULSNVe:;return 2},onUlOpen:function(){ULSNVe:;return 2},onVarOpen:function(){ULSNVe:;return 2},onUnknownOpen:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("If the HTML Processor has registered an unrecognized tag, its Translator must override OnUnknownOpen to handle it",582603);return 2}};RTE.HtmlImport.AQueuingHtmlNormalizer=function(a){ULSNVe:;this.$$d_processTablePartEnd=Function.createDelegate(this,this.processTablePartEnd);this.$$d_processTablePartStart=Function.createDelegate(this,this.processTablePartStart);this.$$d_processTableCellEnd=Function.createDelegate(this,this.processTableCellEnd);this.$$d_processTableRowEnd=Function.createDelegate(this,this.processTableRowEnd);this.$$d_processTableRowStart=Function.createDelegate(this,this.processTableRowStart);this.$$d_processTableEnd=Function.createDelegate(this,this.processTableEnd);this.$$d_processListItemEnd=Function.createDelegate(this,this.processListItemEnd);this.$$d_processListEnd=Function.createDelegate(this,this.processListEnd);this.$$d_processParagraphEnd=Function.createDelegate(this,this.processParagraphEnd);this.$$d_processParagraphStart=Function.createDelegate(this,this.processParagraphStart);this.$$d_processAnchorEnd=Function.createDelegate(this,this.processAnchorEnd);this.$$d_processLineBreak=Function.createDelegate(this,this.processLineBreak);RTE.HtmlImport.AQueuingHtmlNormalizer.initializeBase(this,[a])};RTE.HtmlImport.AQueuingHtmlNormalizer.prototype={queueMode:false,onText:function(a){ULSNVe:;if(this.queueMode){var b=this;this.get_queueManager().$a_0(function(){ULSNVe:;b.processText(a)});return}this.processText(a)},processText:function(a){ULSNVe:;this.steward.onText(a)},onLineBreak:function(){ULSNVe:;if(this.queueMode){this.get_queueManager().$a_0(this.$$d_processLineBreak);return}this.processLineBreak()},processLineBreak:function(){ULSNVe:;this.steward.onLineBreak()},onImage:function(a){ULSNVe:;if(this.queueMode){var b=this;this.get_queueManager().$a_0(function(){ULSNVe:;b.processImage(a)});return}this.processImage(a)},processImage:function(a){ULSNVe:;this.steward.onImage(a)},onFormattingChange:function(a){ULSNVe:;if(this.queueMode){var b=this;this.get_queueManager().$a_0(function(){ULSNVe:;b.processFormattingChange(a)});return}this.processFormattingChange(a)},processFormattingChange:function(a){ULSNVe:;this.steward.onFormattingChange(a)},onAnchorStart:function(a){ULSNVe:;if(this.queueMode){var b=this;this.get_queueManager().$a_0(function(){ULSNVe:;b.processAnchorStart(a)});return}this.processAnchorStart(a)},processAnchorStart:function(a){ULSNVe:;this.steward.onAnchorStart(a)},onAnchorEnd:function(){ULSNVe:;if(this.queueMode){this.get_queueManager().$a_0(this.$$d_processAnchorEnd);return}this.processAnchorEnd()},processAnchorEnd:function(){ULSNVe:;this.steward.onAnchorEnd()},onParagraphStart:function(){ULSNVe:;if(this.queueMode){this.get_queueManager().$a_0(this.$$d_processParagraphStart);return}this.processParagraphStart()},processParagraphStart:function(){ULSNVe:;this.steward.onParagraphStart()},onParagraphEnd:function(){ULSNVe:;if(this.queueMode){this.get_queueManager().$a_0(this.$$d_processParagraphEnd);return}this.processParagraphEnd()},processParagraphEnd:function(){ULSNVe:;this.steward.onParagraphEnd()},onListStart:function(a){ULSNVe:;if(this.queueMode){var b=this;this.get_queueManager().$a_0(function(){ULSNVe:;b.processListStart(a)});return}this.processListStart(a)},processListStart:function(a){ULSNVe:;this.steward.onListStart(a)},onListEnd:function(){ULSNVe:;if(this.queueMode){this.get_queueManager().$a_0(this.$$d_processListEnd);return}this.processListEnd()},processListEnd:function(){ULSNVe:;this.steward.onListEnd()},onListItemStart:function(a){ULSNVe:;if(this.queueMode){var b=this;this.get_queueManager().$a_0(function(){ULSNVe:;b.processListItemStart(a)});return}this.processListItemStart(a)},processListItemStart:function(a){ULSNVe:;this.steward.onListItemStart(a)},onListItemEnd:function(){ULSNVe:;if(this.queueMode){this.get_queueManager().$a_0(this.$$d_processListItemEnd);return}this.processListItemEnd()},processListItemEnd:function(){ULSNVe:;this.steward.onListItemEnd()},onTableStart:function(a){ULSNVe:;if(this.queueMode){var b=this;this.get_queueManager().$a_0(function(){ULSNVe:;b.processTableStart(a)});return}this.processTableStart(a)},processTableStart:function(a){ULSNVe:;this.steward.onTableStart(a)},onTableEnd:function(){ULSNVe:;if(this.queueMode){this.get_queueManager().$a_0(this.$$d_processTableEnd);return}this.processTableEnd()},processTableEnd:function(){ULSNVe:;this.steward.onTableEnd()},onTableRowStart:function(){ULSNVe:;if(this.queueMode){this.get_queueManager().$a_0(this.$$d_processTableRowStart);return}this.processTableRowStart()},processTableRowStart:function(){ULSNVe:;this.steward.onTableRowStart()},onTableRowEnd:function(){ULSNVe:;if(this.queueMode){this.get_queueManager().$a_0(this.$$d_processTableRowEnd);return}this.processTableRowEnd()},processTableRowEnd:function(){ULSNVe:;this.steward.onTableRowEnd()},onTableCellStart:function(a){ULSNVe:;if(this.queueMode){var b=this;this.get_queueManager().$a_0(function(){ULSNVe:;b.processTableCellStart(a)});return}this.processTableCellStart(a)},processTableCellStart:function(a){ULSNVe:;this.steward.onTableCellStart(a)},onTableCellEnd:function(){ULSNVe:;if(this.queueMode){this.get_queueManager().$a_0(this.$$d_processTableCellEnd);return}this.processTableCellEnd()},processTableCellEnd:function(){ULSNVe:;this.steward.onTableCellEnd()},onTablePartStart:function(){ULSNVe:;if(this.queueMode){this.get_queueManager().$a_0(this.$$d_processTablePartStart);return}this.processTablePartStart()},processTablePartStart:function(){ULSNVe:;this.steward.onTablePartStart()},onTablePartEnd:function(){ULSNVe:;if(this.queueMode){this.get_queueManager().$a_0(this.$$d_processTablePartEnd);return}this.processTablePartEnd()},processTablePartEnd:function(){ULSNVe:;this.steward.onTablePartEnd()}};RTE.HtmlImport.DefaultHtmlNormalizer=function(a){ULSNVe:;RTE.HtmlImport.DefaultHtmlNormalizer.initializeBase(this,[a]);this.$2A_2=new(RTE.HtmlImport.Stack.$$(RTE.HtmlImport.DefaultHtmlNormalizer.ContentState))};RTE.HtmlImport.DefaultHtmlNormalizer.prototype={$8_2:null,$2A_2:null,reset:function(){ULSNVe:;RTE.HtmlImport.AHtmlNormalizer.prototype.reset.call(this);this.$8_2=new RTE.HtmlImport.DefaultHtmlNormalizer.ContentState(this);this.$2A_2.clear();this.queueMode=false},get_queueManager:function(){ULSNVe:;return this.$8_2&&this.$8_2.get_$2B_1()?this.$8_2.$27_1:this.$8_2},ensureReadyForText:function(a){ULSNVe:;RTE.PasteCommon.Debug.$Aa(this.$8_2.$3E_1,this.$8_2.$3x_1===!this.$8_2.$3D_1,582607);if(!this.$8_2.$3D_1){this.closeExpiredImpliedList();this.steward.onParagraphStart();this.$8_2.$3D_1=true;this.$8_2.$3x_1=false}if(!a&&this.$8_2.$4g_1&&!this.$8_2.$50_1){this.steward.onAnchorStart(this.$8_2.$4g_1);this.$8_2.$50_1=true}},ensureOutsideHyperlink:function(){ULSNVe:;if(!this.$8_2.$50_1)return;RTE.PasteCommon.Debug.assertTag(this.$8_2.$3D_1&&!!this.$8_2.$4g_1,582608);this.steward.onAnchorEnd();this.$8_2.$50_1=false},ensureOutsideParagraph:function(){ULSNVe:;RTE.PasteCommon.Debug.$1u(!this.$8_2.$50_1,"It's invalid to call EnsureOutsideParagraph while inside a hyperlink!",582609);if(!this.$8_2.$3D_1)return;this.steward.onParagraphEnd();this.$8_2.$3D_1=false;this.$8_2.$6x_1=""},ensureOutsideListItem:function(a){ULSNVe:;RTE.PasteCommon.Debug.$1u(!this.$8_2.$3D_1,"It's invalid to call EnsureOutsideListItem while inside a paragraph!",582610);if(!this.$8_2.$3E_1)return;if(this.$8_2.$3x_1){if(!a){this.steward.onParagraphStart();this.steward.onParagraphEnd();this.steward.onListItemEnd();this.$8_2.$3E_1=false}}else{this.steward.onListItemEnd();this.$8_2.$3E_1=false;this.$8_2.$3x_1=true}},ensureCurrentContentEnded:function(a){ULSNVe:;this.ensureOutsideHyperlink();this.ensureOutsideParagraph();this.ensureOutsideListItem(a)},openNewImpliedList:function(){ULSNVe:;this.steward.onListStart(new RTE.HtmlImport.ListSemanticArgs(2,1));this.$8_2.$3O_1++;this.$8_2.$6b_1=true},closeExpiredImpliedList:function(){ULSNVe:;if(!this.$8_2.$3E_1&&this.$8_2.$6b_1){RTE.PasteCommon.Debug.assertTag(this.$8_2.$3O_1===1,582611);this.steward.onListEnd();this.$8_2.$3O_1--;this.$8_2.$6b_1=false}},processText:function(a){ULSNVe:;a=a.replace(RTE.HtmlImport.DefaultHtmlNormalizer.$CH," ");if(a.startsWith(" ")&&(this.$8_2.$6x_1.endsWith(" ")||this.$8_2.$6x_1===""))a=a.substring(1,a.length);if(a==="")return;this.$8_2.$6x_1+=a;this.ensureReadyForText();this.steward.onText(a)},processLineBreak:function(){ULSNVe:;this.ensureOutsideHyperlink();this.ensureReadyForText(true);this.steward.onLineBreak()},processFormattingChange:function(a){ULSNVe:;if(this.$8_2.get_$2B_1())return;this.steward.onFormattingChange(a)},processAnchorStart:function(a){ULSNVe:;this.ensureOutsideHyperlink();this.$8_2.$4g_1=a},processAnchorEnd:function(){ULSNVe:;this.ensureOutsideHyperlink();this.$8_2.$4g_1=null},processParagraphStart:function(){ULSNVe:;this.ensureCurrentContentEnded(true)},processParagraphEnd:function(){ULSNVe:;this.ensureCurrentContentEnded(true)},processListStart:function(a){ULSNVe:;this.ensureCurrentContentEnded(false);this.closeExpiredImpliedList();this.steward.onListStart(a);this.$8_2.$3O_1++},processListEnd:function(){ULSNVe:;RTE.PasteCommon.Debug.assertTag(this.$8_2.$3O_1>0&&!this.$8_2.$6b_1,582612);this.ensureCurrentContentEnded(false);this.steward.onListEnd();this.$8_2.$3O_1--},processListItemStart:function(a){ULSNVe:;RTE.PasteCommon.Debug.$1u(!this.$8_2.$3E_1,"It had seemed that the browser wouldn't ever nest LIs in the DOM, but apparently it does.\nInvestigate this case, and then turn this Assert into a Log (or remove it)",582613);this.ensureCurrentContentEnded(false);!this.$8_2.$3O_1&&this.openNewImpliedList();this.steward.onListItemStart(a);this.$8_2.$3E_1=true;this.$8_2.$3x_1=true},processListItemEnd:function(){ULSNVe:;this.ensureCurrentContentEnded(false)},onTableStart:function(){ULSNVe:;if(this.$8_2.get_$2B_1())return;RTE.PasteCommon.Debug.assertTag(this.queueMode===!this.$2A_2.get_isEmpty(),582614);RTE.PasteCommon.Debug.$Aa(!this.queueMode,this.get_queueManager().get_$JL_0(),582615);this.queueMode=true;this.$8_2.$27_1=new RTE.HtmlImport.DefaultHtmlNormalizer.NormalizedTable(this)},processTableStart:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("We should handle Tables directly in OnTableStart",582616)},onTableEnd:function(){ULSNVe:;RTE.PasteCommon.Debug.assertTag(this.queueMode&&this.$8_2.get_$2B_1(),582617);if(!this.$8_2.$27_1)return;var a=this.$8_2.$27_1;this.$8_2.$27_1=null;if(this.$2A_2.get_isEmpty()){this.queueMode=false;a.$Be_1()}else this.get_queueManager().$a_0(a.$$d_$Be_1)},processTableEnd:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("We should handle Tables directly in OnTableEnd",582618)},onTableRowStart:function(){ULSNVe:;if(!this.$8_2.get_$2B_1())return;this.$8_2.$27_1.$Eq_1()},processTableRowStart:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("We should handle Table Rows directly in OnTableRowStart",582619)},onTableRowEnd:function(){},processTableRowEnd:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("We should handle Table Rows directly in OnTableRowEnd",582620)},onTableCellStart:function(c){ULSNVe:;var a=false;if(this.$8_2.get_$2B_1()){var b=new RTE.HtmlImport.DefaultHtmlNormalizer.ContentState(this);if(this.$8_2.$27_1.$Eo_1(c.colSpan,c.rowSpan,b)){this.$2A_2.push(this.$8_2);this.$8_2=b}else a=true}else a=true;if(a)this.$8_2.$9D_1++},processTableCellStart:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("We should handle Table Cells directly in OnTableCellStart",582621)},onTableCellEnd:function(){ULSNVe:;if(this.$8_2.$9D_1>0){this.$8_2.$9D_1--;return}RTE.PasteCommon.Debug.assertTag(!this.$2A_2.get_isEmpty()&&!this.$8_2.get_$2B_1(),582622);this.$8_2=this.$2A_2.pop();RTE.PasteCommon.Debug.assertTag(this.$8_2.get_$2B_1(),582623)},processTableCellEnd:function(){ULSNVe:;RTE.PasteCommon.Debug.$E("We should handle Table Cells directly in OnTableCellEnd",582624)}};RTE.HtmlImport.DefaultHtmlNormalizer.NormalizedTable=function(a){ULSNVe:;this.$$d_$Be_1=Function.createDelegate(this,this.$Be_1);RTE.HtmlImport.DefaultHtmlNormalizer.NormalizedTable.initializeBase(this);this.$r_1=a;this.$1Z_1=new(RTE.HtmlImport.List.$$(Array));this.$5r_1=new Array(0);this.$2U_1=-1;this.$29_1=0};RTE.HtmlImport.DefaultHtmlNormalizer.NormalizedTable.prototype={$r_1:null,get_$4M_1:function(){ULSNVe:;return this.$r_1.steward},$1Z_1:null,$2U_1:0,$29_1:0,$5r_1:null,$Eq_1:function(){ULSNVe:;this.$2U_1++;this.$29_1=0},get_$HY_1:function(){ULSNVe:;while(this.$29_1>=this.$1Z_1.get_count())this.$1Z_1.add(new Array(this.$2U_1+1));return this.$1Z_1.get_item(this.$29_1)},$Eo_1:function(f,g,h){ULSNVe:;if(this.$2U_1<0)return false;while(this.$5r_1[this.$29_1]>=this.$2U_1)this.$29_1++;var a=new RTE.HtmlImport.DefaultHtmlNormalizer.NormalizedTable.TableCell(f,g,h);this.get_$HY_1()[this.$2U_1]=a;if(a.$7G_0>1)for(var c=this.$2U_1+a.$7G_0-1,d=this.$29_1,e=this.$29_1+a.$64_0-1,b=d;b<=e;b++){if(this.$5r_1[b]>=c)continue;this.$5r_1[b]=c}this.$29_1+=a.$64_0;return true},$L9_0:function(){ULSNVe:;RTE.PasteCommon.Debug.assertTag(!this.$r_1.$8_2.get_$2B_1(),582605);this.$r_1.$8_2.$27_1=this},$Ku_0:function(){ULSNVe:;this.$r_1.$8_2.$27_1=null},$Be_1:function(){ULSNVe:;this.$Bd_0(true);for(var c=this.$2U_1+1,g=true,b=0;b<this.$1Z_1.get_count();b++){for(var i=this.$1Z_1.get_item(b),h=true,d=0;d<c;d++)if(i[d]){h=false;break}if(h){this.$1Z_1.removeAt(b);b--}else g=false}if(g)return;this.$r_1.ensureCurrentContentEnded(true);this.$r_1.closeExpiredImpliedList();RTE.PasteCommon.Debug.assertTag(c>0&&this.$1Z_1.get_count()>0,582606);this.get_$4M_1().onTableStart(new RTE.HtmlImport.TableSemanticArgs(c,this.$1Z_1.get_count()));for(var e=0;e<c;e++){this.get_$4M_1().onTableRowStart();for(var f=0;f<this.$1Z_1.get_count();f++){var a=this.$1Z_1.get_item(f)[e],j=!a?0:a.$64_0,k=!a?0:a.$7G_0;this.get_$4M_1().onTableCellStart(new RTE.HtmlImport.TableCellSemanticArgs(j,k));if(a){a.$65_0.$L9_0();a.$65_0.$Bd_0();this.$r_1.ensureCurrentContentEnded(false);this.$r_1.closeExpiredImpliedList();a.$65_0.$Ku_0()}this.get_$4M_1().onTableCellEnd()}this.get_$4M_1().onTableRowEnd()}this.get_$4M_1().onTableEnd();this.$r_1.$8_2.$3x_1=false;this.$r_1.ensureOutsideListItem(false)}};RTE.HtmlImport.DefaultHtmlNormalizer.NormalizedTable.TableCell=function(a,b,c){ULSNVe:;RTE.PasteCommon.Debug.assertTag(a>0&&b>0&&!!c,582604);this.$64_0=a;this.$7G_0=b;this.$65_0=c};RTE.HtmlImport.DefaultHtmlNormalizer.ContentState=function(a){ULSNVe:;RTE.HtmlImport.DefaultHtmlNormalizer.ContentState.initializeBase(this);this.$r_1=a};RTE.HtmlImport.DefaultHtmlNormalizer.ContentState.prototype={$r_1:null,$3D_1:false,$6x_1:"",$50_1:false,$4g_1:null,$3O_1:0,$6b_1:false,$3E_1:false,$3x_1:false,$27_1:null,get_$2B_1:function(){ULSNVe:;return!!this.$27_1},$9D_1:0,$L9_0:function(){ULSNVe:;this.$r_1.$2A_2.push(this.$r_1.$8_2);this.$r_1.$8_2=this},$Ku_0:function(){ULSNVe:;this.$r_1.$8_2=this.$r_1.$2A_2.pop()}};RTE.HtmlImport.DefaultHtmlTranslator=function(a){ULSNVe:;this.$$d_$K9_1=Function.createDelegate(this,this.$K9_1);this.$AF_1={none:1,disc:3,circle:4,square:5,"1":7,A:10,a:8,I:11,i:9,armenian:7,decimal:7,"decimal-leading-zero":7,georgian:7,"lower-alpha":8,"lower-greek":8,"lower-latin":8,"lower-roman":9,"upper-alpha":10,"upper-latin":10,"upper-roman":11};RTE.HtmlImport.DefaultHtmlTranslator.initializeBase(this,[a])};RTE.HtmlImport.DefaultHtmlTranslator.$8C=function(f){ULSNVe:;var a="";if(!f||f==="")return a;a=f.trim();if(a.startsWith("rgb")){a=a.substring(a.indexOf("(")+1,a.length-1);var d=a.split(",");if(d.length!==3)return"";a="";for(var e=0;e<d.length;e++){var b=parseInt(d[e]);if(isNaN(b)||b<0||b>255)return"";var c=b.toString(16);if(c.length===1)c="0"+c;a+=c}return a}if(RTE.HtmlImport.DefaultHtmlTranslator.$8f[a.toLowerCase()])return RTE.HtmlImport.DefaultHtmlTranslator.$8f[a.toLowerCase()];if(a.startsWith("#"))a=a.substring(1,a.length);return isNaN(parseInt(a,16))||a.length!==6?"":a};RTE.HtmlImport.DefaultHtmlTranslator.$Ci=function(a){ULSNVe:;if(!a||a==="")return false;a=a.toLowerCase();return a.indexOf("monospace")>=0||a.indexOf("consolas")>=0||a.indexOf("courier")>=0};RTE.HtmlImport.DefaultHtmlTranslator.$Bk=function(b,d,e){ULSNVe:;RTE.PasteCommon.Debug.assertTag(e>=0,596181);var c=b[d],a=parseInt(c);RTE.PasteCommon.Debug.log("GetAttributeValueAsNonNegativeInt("+(b.tagName||DOMElementType.toString(b.nodeType))+", "+d+")\nrawValue:  "+c+" | intValue:  "+a,"HtmlImport.Translator",RTE.PasteCommon.LogLevel.$7d);return isNaN(a)||a<0?e:a};RTE.HtmlImport.DefaultHtmlTranslator.prototype={$4R_1:null,get_listStyleTypes:function(){ULSNVe:;return this.$AF_1},getListStyleTypeFromElement:function(c,e){ULSNVe:;var a,b=!c.style?"":c.style.listStyleType;if(b&&b!==""){RTE.PasteCommon.Debug.log("list-style-type:  "+b,"HtmlImport.Translator",RTE.PasteCommon.LogLevel.$7d);a=this.get_listStyleTypes()[b];if(a)return a}var d=c.type;if(d&&d!==""){RTE.PasteCommon.Debug.log("list type attribute:  "+b,"HtmlImport.Translator",RTE.PasteCommon.LogLevel.$7d);a=this.get_listStyleTypes()[d.toLowerCase()];if(a)return a}return e},$K9_1:function(){ULSNVe:;this.$4R_1.pop();this.normalizer.onListEnd()},$4u_1:function(c,d){ULSNVe:;var b=this.getListStyleTypeFromElement(c,d?6:2),a;if(d){var e=RTE.HtmlImport.DefaultHtmlTranslator.$Bk(c,"start",1);a=new RTE.HtmlImport.ListSemanticArgs(b,e)}else a=new RTE.HtmlImport.ListSemanticArgs(b,1);this.$4R_1.push(a);this.normalizer.onListStart(a);this.registerOnCloseCallback(this.$$d_$K9_1);return 1},reset:function(){ULSNVe:;RTE.HtmlImport.AHtmlTranslator.prototype.reset.call(this);this.$4R_1=new(RTE.HtmlImport.Stack.$$(RTE.HtmlImport.ListSemanticArgs))},setFormattingFromAttributes:function(c,e){ULSNVe:;var a=false,d;try{d=e.getAttribute("xml:lang")||e.lang}catch(n){RTE.PasteCommon.Debug.log("Exception getting the lang or xml:lang attribute","HtmlImport.Translator",RTE.PasteCommon.LogLevel.$Ej);d=null}if(d&&d!=="")a=c.setLang(d)||a;var h=e.dir;if(h)a=c.setTextDir(h)||a;var b=e.style;if(b){if(b.fontWeight){var f=RTE.PasteCommon.StringUtils.toUpper(b.fontWeight),j=parseInt(f);if(!isNaN(j))if(j>=600)a=c.setBold(true)||a;else a=c.setBold(false)||a;else if(f==="BOLD")a=c.setBold(true)||a;else if(f==="NORMAL")a=c.setBold(false)||a}if(b.textAlign)a=c.setTextAlign(b.textAlign.toLowerCase())||a;if(b.fontStyle){var g=RTE.PasteCommon.StringUtils.toUpper(b.fontStyle);if(g==="ITALIC"||g==="OBLIQUE")a=c.setItalics(true)||a;else if(g==="NORMAL")a=c.setItalics(false)||a}var i=b.textDecoration.toLowerCase();if(b.textDecorationUnderline||i.indexOf("underline")>=0)a=c.setUnderline(true)||a;if(b.textDecorationLineThrough||i.indexOf("line-through")>=0)a=c.setStrikethrough(true)||a;if(b.verticalAlign){var k=RTE.PasteCommon.StringUtils.toUpper(b.verticalAlign);if(k==="SUB")a=c.setSubscript(true)||a;else if(k==="SUPER")a=c.setSuperscript(true)||a}if(b.fontFamily)if(RTE.HtmlImport.DefaultHtmlTranslator.$Ci(b.fontFamily))a=c.setFontface("consolas")||a;if(b.color){var l=b.color;a=c.setFontColor(RTE.HtmlImport.DefaultHtmlTranslator.$8C(l))||a}if(b.backgroundColor){var m=b.backgroundColor;a=c.setFontHighlight(RTE.HtmlImport.DefaultHtmlTranslator.$8C(m))||a}}return a},onText:function(a){ULSNVe:;this.normalizer.onText(a)},onAOpen:function(c){ULSNVe:;var b=c.href;if(b&&b!==""){this.normalizer.onAnchorStart(b);var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onAnchorEnd||(a.$$d_onAnchorEnd=Function.createDelegate(a,a.onAnchorEnd)));return 1}return 2},onBOpen:function(){ULSNVe:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setBold(true)});return a?1:2},onBigOpen:function(){ULSNVe:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.growFontsize()});return a?1:2},onBlockquoteOpen:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onBrTag:function(){ULSNVe:;this.normalizer.onLineBreak()},onCaptionOpen:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onCiteOpen:function(){ULSNVe:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setItalics(true)});return a?1:2},onCenterOpen:function(){ULSNVe:;var c=this;this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setTextAlign("center")});this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onCodeOpen:function(){ULSNVe:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setFontface("consolas")});return a?1:2},onDelOpen:function(){ULSNVe:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setStrikethrough(true)});return a?1:2},onDdOpen:function(a){ULSNVe:;return this.$4u_1(a,false)},onDfnOpen:function(){ULSNVe:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setItalics(true)});return a?1:2},onDirOpen:function(a){ULSNVe:;return this.$4u_1(a,false)},onDivOpen:function(b){ULSNVe:;var c=b.getAttribute("align"),d=this;this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setTextAlign(c)});this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onDlOpen:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onDtOpen:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onEmOpen:function(){ULSNVe:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setItalics(true)});return a?1:2},onFontOpen:function(a){ULSNVe:;var c=this,b=this.handleSpecifiedFormatting(function(b){ULSNVe:;var c=RTE.HtmlImport.DefaultHtmlTranslator.$Ci(a.getAttribute("face"))&&b.setFontface("consolas"),d=b.setFontColor(RTE.HtmlImport.DefaultHtmlTranslator.$8C(a.getAttribute("color")));return c||d});return b?1:2},onH1Open:function(){ULSNVe:;var c=this;this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setHeading(1)});this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onH2Open:function(){ULSNVe:;var c=this;this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setHeading(2)});this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onH3Open:function(){ULSNVe:;var c=this;this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setHeading(3)});this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onH4Open:function(){ULSNVe:;var c=this;this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setHeading(4)});this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onH5Open:function(){ULSNVe:;var c=this;this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setHeading(5)});this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onH6Open:function(){ULSNVe:;var c=this;this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setHeading(6)});this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onHrTag:function(){ULSNVe:;this.normalizer.onLineBreak()},onImgTag:function(a){ULSNVe:;var f=a.src,g=a.alt,d=a.width,e=a.height;if(!d&&!e&&a.currentStyle){var b=a.currentStyle.width,c=a.currentStyle.height;if(b&&b.indexOf("px")!==-1)d=parseInt(b.substring(0,b.indexOf("px")));if(c&&c.indexOf("px")!==-1)e=parseInt(c.substring(0,c.indexOf("px")))}var h=new RTE.HtmlImport.ImageSemanticArgs(f,g,d,e);this.normalizer.onImage(h)},onIOpen:function(){ULSNVe:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setItalics(true)});return a?1:2},onInsOpen:function(){ULSNVe:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setUnderline(true)});return a?1:2},onKbdOpen:function(){ULSNVe:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setFontface("consolas")});return a?1:2},onLabelOpen:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onLegendOpen:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onLiOpen:function(d){ULSNVe:;var b,e=this.getListStyleTypeFromElement(d,0),c=RTE.HtmlImport.DefaultHtmlTranslator.$Bk(d,"value",0);if(this.$4R_1.get_count()>0)b=this.$4R_1.peek();else{b=new RTE.HtmlImport.ListSemanticArgs(2,1);if(!c)c=1}b.$F6_0(e,c);this.normalizer.onListItemStart(b.$Fr_0());var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onListItemEnd||(a.$$d_onListItemEnd=Function.createDelegate(a,a.onListItemEnd)));return 1},onMenuOpen:function(a){ULSNVe:;return this.$4u_1(a,false)},onOlOpen:function(a){ULSNVe:;return this.$4u_1(a,true)},onOptionOpen:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onPOpen:function(b){ULSNVe:;var c=b.getAttribute("align"),d=this;this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setTextAlign(c)});this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onPreOpen:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onSOpen:function(){ULSNVe:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setStrikethrough(true)});return a?1:2},onSampOpen:function(){ULSNVe:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setFontface("consolas")});return a?1:2},onSmallOpen:function(){ULSNVe:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.shrinkFontsize()});return a?1:2},onStrikeOpen:function(){ULSNVe:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setStrikethrough(true)});return a?1:2},onStrongOpen:function(){ULSNVe:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setBold(true)});return a?1:2},onSubOpen:function(){ULSNVe:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setSubscript(true)});return a?1:2},onSupOpen:function(){ULSNVe:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setSuperscript(true)});return a?1:2},onTableOpen:function(){ULSNVe:;var c=this;this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.clearFormatting()});this.normalizer.onTableStart(new RTE.HtmlImport.TableSemanticArgs(0,0));var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onTableEnd||(a.$$d_onTableEnd=Function.createDelegate(a,a.onTableEnd)));return 1},onTdOpen:function(b){ULSNVe:;var c=parseInt(b.colSpan),d=parseInt(b.rowSpan);RTE.PasteCommon.Debug.assertTag(c>0&&d>0,596182);this.normalizer.onTableCellStart(new RTE.HtmlImport.TableCellSemanticArgs(c,d));var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onTableCellEnd||(a.$$d_onTableCellEnd=Function.createDelegate(a,a.onTableCellEnd)));this.notifyNormalizerOfCurrentFormatting();return 1},onThOpen:function(a){ULSNVe:;this.onTdOpen(a);var b=this;this.handleSpecifiedFormatting(function(a){ULSNVe:;var b=a.setBold(true),c=a.setTextAlign("center");return b||c});return 1},onTrOpen:function(){ULSNVe:;this.normalizer.onTableRowStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onTableRowEnd||(a.$$d_onTableRowEnd=Function.createDelegate(a,a.onTableRowEnd)));return 1},onTtOpen:function(){ULSNVe:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setFontface("consolas")});return a?1:2},onUOpen:function(){ULSNVe:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setUnderline(true)});return a?1:2},onUlOpen:function(a){ULSNVe:;return this.$4u_1(a,false)},onVarOpen:function(){ULSNVe:;var c=this,a=this.handleSpecifiedFormatting(function(a){ULSNVe:;return a.setUnderline(true)});return a?1:2}};RTE.HtmlImport.HtmlProcessor=function(a){ULSNVe:;this.$$d_$KM_0=Function.createDelegate(this,this.$KM_0);this.$6_0=a;this.$LI_0()};RTE.HtmlImport.HtmlProcessor.$Jg=function(a){ULSNVe:;a.nodeType!==3&&RTE.PasteCommon.CustomData.$4J(a,"alreadyPasted",true)};RTE.HtmlImport.HtmlProcessor.$Il=function(a){ULSNVe:;return a.nodeType!==3&&RTE.PasteCommon.CustomData.getObject(a,"alreadyPasted")};RTE.HtmlImport.HtmlProcessor.$5i=function(a){ULSNVe:;a.$4e_0++;a.$4x_0=false;return a.$4e_0<a.$2Z_0.length};RTE.HtmlImport.HtmlProcessor.prototype={$6_0:null,$AM_0:null,$4V_0:null,$30_0:null,$2z_0:null,registerNewTag:function(a){ULSNVe:;a=RTE.PasteCommon.StringUtils.toUpper(a);if(this.$4V_0[a]){RTE.PasteCommon.Debug.assertTag(!!this.$2z_0[a],596183);delete this.$4V_0[a]}else if(this.$30_0[a]){RTE.PasteCommon.Debug.assertTag(!!this.$2z_0[a],596184);delete this.$30_0[a]}else{var b=this.$6_0;this.$2z_0[a]=b.$$d_onUnknownOpen||(b.$$d_onUnknownOpen=Function.createDelegate(b,b.onUnknownOpen))}},process:function(a,b){ULSNVe:;if(!a){RTE.PasteCommon.Debug.$7m(596185);return}this.$6_0.reset();this.$Dn_0(new RTE.HtmlImport.HtmlProcessorArguments(a),b)},$Dn_0:function(b,c){ULSNVe:;if(!b.$2Z_0.length)return;var a=new RTE.PasteCommon.SimpleOperation(c,this.$$d_$KM_0,b);!c&&a.set_$2e_1(true);a.$9c_1()},$KM_0:function(e,f){ULSNVe:;var b=f,a=b.$2Z_0[b.$4e_0];if(a.nodeType===3){this.$6_0.onBeforeNewElement();this.$6_0.onText(a.nodeValue);return RTE.HtmlImport.HtmlProcessor.$5i(b)}if(a.nodeType!==1){RTE.PasteCommon.Debug.log("Skipping over DOMElement with NodeType = "+a.nodeType,"HtmlProcessor",RTE.PasteCommon.LogLevel.$3r);return RTE.HtmlImport.HtmlProcessor.$5i(b)}if(!b.$4x_0){var c=RTE.PasteCommon.StringUtils.toUpper(a.tagName);if(!RTE.HtmlImport.HtmlProcessor.$Il(a)&&!this.$30_0[c]){RTE.HtmlImport.HtmlProcessor.$Jg(a);this.$6_0.onBeforeNewElement();if(this.$AM_0[c]){this.$Jp_0(a,c);return RTE.HtmlImport.HtmlProcessor.$5i(b)}var d=false;switch(this.$Jo_0(a,c)){case 1:d=true;break;case 3:return RTE.HtmlImport.HtmlProcessor.$5i(b)}switch(this.$6_0.handleCommonAttributes(a)){case 1:d=true}b.$4x_0=d;this.$Dn_0(new RTE.HtmlImport.HtmlProcessorArguments(a),e);if(!e.get_$2e_1())return true}}if(b.$4x_0){RTE.PasteCommon.Debug.assertTag(!this.$30_0[RTE.PasteCommon.StringUtils.toUpper(a.tagName)],596187);RTE.PasteCommon.Debug.assertTag(!!this.$2z_0[RTE.PasteCommon.StringUtils.toUpper(a.tagName)],596188);this.$6_0.onClose()}return RTE.HtmlImport.HtmlProcessor.$5i(b)},$Jp_0:function(c,a){ULSNVe:;RTE.PasteCommon.Debug.assertTag(a===RTE.PasteCommon.StringUtils.toUpper(c.tagName),596189);RTE.PasteCommon.Debug.assertTag(!this.$30_0[a],596190);if(this.$4V_0[a])return;var b=this.$2z_0[a];RTE.PasteCommon.Debug.assertTag(!!b,596191);b(c);return},$Jo_0:function(c,a){ULSNVe:;RTE.PasteCommon.Debug.assertTag(a===RTE.PasteCommon.StringUtils.toUpper(c.tagName),596192);RTE.PasteCommon.Debug.assertTag(!this.$30_0[a],596193);if(!this.$4V_0[a]){var b=this.$2z_0[a];if(b)return b(c)}return 2},$LI_0:function(){ULSNVe:;this.$AM_0={AREA:true,BASE:true,BASEFONT:true,BR:true,COL:true,FRAME:true,HR:true,IMG:true,INPUT:true,LINK:true,META:true,PARAM:true};this.$4V_0={ABBR:true,ACRONYM:true,ADDRESS:true,BDO:true,BODY:true,BUTTON:true,FIELDSET:true,FORM:true,FRAMESET:true,NOFRAMES:true,NOSCRIPT:true,OPTGROUP:true,Q:true,SELECT:true,SPAN:true,TEXTAREA:true};this.$30_0={APPLET:true,AREA:true,BASE:true,BASEFONT:true,FRAME:true,HEAD:true,HTML:true,IFRAME:true,INPUT:true,ISINDEX:true,LINK:true,MAP:true,META:true,OBJECT:true,PARAM:true,SCRIPT:true,STYLE:true,TITLE:true};var D=this.$6_0,E=this.$6_0,F=this.$6_0,G=this.$6_0,H=this.$6_0,I=this.$6_0,J=this.$6_0,K=this.$6_0,L=this.$6_0,M=this.$6_0,N=this.$6_0,P=this.$6_0,R=this.$6_0,U=this.$6_0,W=this.$6_0,Y=this.$6_0,ab=this.$6_0,cb=this.$6_0,eb=this.$6_0,fb=this.$6_0,ib=this.$6_0,kb=this.$6_0,mb=this.$6_0,nb=this.$6_0,pb=this.$6_0,rb=this.$6_0,ub=this.$6_0,wb=this.$6_0,xb=this.$6_0,Ab=this.$6_0,Bb=this.$6_0,Db=this.$6_0,Fb=this.$6_0,Hb=this.$6_0,Kb=this.$6_0,Mb=this.$6_0,O=this.$6_0,Q=this.$6_0,S=this.$6_0,T=this.$6_0,V=this.$6_0,X=this.$6_0,Z=this.$6_0,bb=this.$6_0,db=this.$6_0,gb=this.$6_0,hb=this.$6_0,jb=this.$6_0,lb=this.$6_0,ob=this.$6_0,qb=this.$6_0,sb=this.$6_0,tb=this.$6_0,vb=this.$6_0,yb=this.$6_0,zb=this.$6_0,Cb=this.$6_0,Eb=this.$6_0,Gb=this.$6_0,Ib=this.$6_0,Jb=this.$6_0,Lb=this.$6_0,a=this.$6_0,b=this.$6_0,c=this.$6_0,d=this.$6_0,e=this.$6_0,f=this.$6_0,g=this.$6_0,h=this.$6_0,i=this.$6_0,j=this.$6_0,k=this.$6_0,l=this.$6_0,m=this.$6_0,n=this.$6_0,o=this.$6_0,p=this.$6_0,q=this.$6_0,r=this.$6_0,s=this.$6_0,t=this.$6_0,u=this.$6_0,v=this.$6_0,w=this.$6_0,x=this.$6_0,y=this.$6_0,z=this.$6_0,A=this.$6_0,B=this.$6_0,C=this.$6_0;this.$2z_0={A:D.$$d_onAOpen||(D.$$d_onAOpen=Function.createDelegate(D,D.onAOpen)),ABBR:E.$$d_onAbbrOpen||(E.$$d_onAbbrOpen=Function.createDelegate(E,E.onAbbrOpen)),ACRONYM:F.$$d_onAcronymOpen||(F.$$d_onAcronymOpen=Function.createDelegate(F,F.onAcronymOpen)),ADDRESS:G.$$d_onAddressOpen||(G.$$d_onAddressOpen=Function.createDelegate(G,G.onAddressOpen)),APPLET:H.$$d_onAppletOpen||(H.$$d_onAppletOpen=Function.createDelegate(H,H.onAppletOpen)),AREA:I.$$d_onAreaTag||(I.$$d_onAreaTag=Function.createDelegate(I,I.onAreaTag)),B:J.$$d_onBOpen||(J.$$d_onBOpen=Function.createDelegate(J,J.onBOpen)),BASE:K.$$d_onBaseTag||(K.$$d_onBaseTag=Function.createDelegate(K,K.onBaseTag)),BASEFONT:L.$$d_onBasefontTag||(L.$$d_onBasefontTag=Function.createDelegate(L,L.onBasefontTag)),BDO:M.$$d_onBdoOpen||(M.$$d_onBdoOpen=Function.createDelegate(M,M.onBdoOpen)),BIG:N.$$d_onBigOpen||(N.$$d_onBigOpen=Function.createDelegate(N,N.onBigOpen)),BLOCKQUOTE:P.$$d_onBlockquoteOpen||(P.$$d_onBlockquoteOpen=Function.createDelegate(P,P.onBlockquoteOpen)),BODY:R.$$d_onBodyOpen||(R.$$d_onBodyOpen=Function.createDelegate(R,R.onBodyOpen)),BR:U.$$d_onBrTag||(U.$$d_onBrTag=Function.createDelegate(U,U.onBrTag)),BUTTON:W.$$d_onButtonOpen||(W.$$d_onButtonOpen=Function.createDelegate(W,W.onButtonOpen)),CAPTION:Y.$$d_onCaptionOpen||(Y.$$d_onCaptionOpen=Function.createDelegate(Y,Y.onCaptionOpen)),CENTER:ab.$$d_onCenterOpen||(ab.$$d_onCenterOpen=Function.createDelegate(ab,ab.onCenterOpen)),CITE:cb.$$d_onCiteOpen||(cb.$$d_onCiteOpen=Function.createDelegate(cb,cb.onCiteOpen)),CODE:eb.$$d_onCodeOpen||(eb.$$d_onCodeOpen=Function.createDelegate(eb,eb.onCodeOpen)),COL:fb.$$d_onColTag||(fb.$$d_onColTag=Function.createDelegate(fb,fb.onColTag)),COLGROUP:ib.$$d_onColgroupOpen||(ib.$$d_onColgroupOpen=Function.createDelegate(ib,ib.onColgroupOpen)),DD:kb.$$d_onDdOpen||(kb.$$d_onDdOpen=Function.createDelegate(kb,kb.onDdOpen)),DEL:mb.$$d_onDelOpen||(mb.$$d_onDelOpen=Function.createDelegate(mb,mb.onDelOpen)),DFN:nb.$$d_onDfnOpen||(nb.$$d_onDfnOpen=Function.createDelegate(nb,nb.onDfnOpen)),DIR:pb.$$d_onDirOpen||(pb.$$d_onDirOpen=Function.createDelegate(pb,pb.onDirOpen)),DIV:rb.$$d_onDivOpen||(rb.$$d_onDivOpen=Function.createDelegate(rb,rb.onDivOpen)),DL:ub.$$d_onDlOpen||(ub.$$d_onDlOpen=Function.createDelegate(ub,ub.onDlOpen)),DT:wb.$$d_onDtOpen||(wb.$$d_onDtOpen=Function.createDelegate(wb,wb.onDtOpen)),EM:xb.$$d_onEmOpen||(xb.$$d_onEmOpen=Function.createDelegate(xb,xb.onEmOpen)),FIELDSET:Ab.$$d_onFieldsetOpen||(Ab.$$d_onFieldsetOpen=Function.createDelegate(Ab,Ab.onFieldsetOpen)),FONT:Bb.$$d_onFontOpen||(Bb.$$d_onFontOpen=Function.createDelegate(Bb,Bb.onFontOpen)),FORM:Db.$$d_onFormOpen||(Db.$$d_onFormOpen=Function.createDelegate(Db,Db.onFormOpen)),FRAME:Fb.$$d_onFrameTag||(Fb.$$d_onFrameTag=Function.createDelegate(Fb,Fb.onFrameTag)),FRAMESET:Hb.$$d_onFramesetOpen||(Hb.$$d_onFramesetOpen=Function.createDelegate(Hb,Hb.onFramesetOpen)),H1:Kb.$$d_onH1Open||(Kb.$$d_onH1Open=Function.createDelegate(Kb,Kb.onH1Open)),H2:Mb.$$d_onH2Open||(Mb.$$d_onH2Open=Function.createDelegate(Mb,Mb.onH2Open)),H3:O.$$d_onH3Open||(O.$$d_onH3Open=Function.createDelegate(O,O.onH3Open)),H4:Q.$$d_onH4Open||(Q.$$d_onH4Open=Function.createDelegate(Q,Q.onH4Open)),H5:S.$$d_onH5Open||(S.$$d_onH5Open=Function.createDelegate(S,S.onH5Open)),H6:T.$$d_onH6Open||(T.$$d_onH6Open=Function.createDelegate(T,T.onH6Open)),HEAD:V.$$d_onHeadOpen||(V.$$d_onHeadOpen=Function.createDelegate(V,V.onHeadOpen)),HR:X.$$d_onHrTag||(X.$$d_onHrTag=Function.createDelegate(X,X.onHrTag)),HTML:Z.$$d_onHtmlOpen||(Z.$$d_onHtmlOpen=Function.createDelegate(Z,Z.onHtmlOpen)),I:bb.$$d_onIOpen||(bb.$$d_onIOpen=Function.createDelegate(bb,bb.onIOpen)),IFRAME:db.$$d_onIframeOpen||(db.$$d_onIframeOpen=Function.createDelegate(db,db.onIframeOpen)),IMG:gb.$$d_onImgTag||(gb.$$d_onImgTag=Function.createDelegate(gb,gb.onImgTag)),INPUT:hb.$$d_onInputTag||(hb.$$d_onInputTag=Function.createDelegate(hb,hb.onInputTag)),INS:jb.$$d_onInsOpen||(jb.$$d_onInsOpen=Function.createDelegate(jb,jb.onInsOpen)),ISINDEX:lb.$$d_onIsindexOpen||(lb.$$d_onIsindexOpen=Function.createDelegate(lb,lb.onIsindexOpen)),KBD:ob.$$d_onKbdOpen||(ob.$$d_onKbdOpen=Function.createDelegate(ob,ob.onKbdOpen)),LABEL:qb.$$d_onLabelOpen||(qb.$$d_onLabelOpen=Function.createDelegate(qb,qb.onLabelOpen)),LEGEND:sb.$$d_onLegendOpen||(sb.$$d_onLegendOpen=Function.createDelegate(sb,sb.onLegendOpen)),LI:tb.$$d_onLiOpen||(tb.$$d_onLiOpen=Function.createDelegate(tb,tb.onLiOpen)),LINK:vb.$$d_onLinkTag||(vb.$$d_onLinkTag=Function.createDelegate(vb,vb.onLinkTag)),MAP:yb.$$d_onMapOpen||(yb.$$d_onMapOpen=Function.createDelegate(yb,yb.onMapOpen)),MENU:zb.$$d_onMenuOpen||(zb.$$d_onMenuOpen=Function.createDelegate(zb,zb.onMenuOpen)),META:Cb.$$d_onMetaTag||(Cb.$$d_onMetaTag=Function.createDelegate(Cb,Cb.onMetaTag)),NOFRAMES:Eb.$$d_onNoframesOpen||(Eb.$$d_onNoframesOpen=Function.createDelegate(Eb,Eb.onNoframesOpen)),NOSCRIPT:Gb.$$d_onNoscriptOpen||(Gb.$$d_onNoscriptOpen=Function.createDelegate(Gb,Gb.onNoscriptOpen)),OBJECT:Ib.$$d_onObjectOpen||(Ib.$$d_onObjectOpen=Function.createDelegate(Ib,Ib.onObjectOpen)),OL:Jb.$$d_onOlOpen||(Jb.$$d_onOlOpen=Function.createDelegate(Jb,Jb.onOlOpen)),OPTGROUP:Lb.$$d_onOptgroupOpen||(Lb.$$d_onOptgroupOpen=Function.createDelegate(Lb,Lb.onOptgroupOpen)),OPTION:a.$$d_onOptionOpen||(a.$$d_onOptionOpen=Function.createDelegate(a,a.onOptionOpen)),P:b.$$d_onPOpen||(b.$$d_onPOpen=Function.createDelegate(b,b.onPOpen)),PARAM:c.$$d_onParamTag||(c.$$d_onParamTag=Function.createDelegate(c,c.onParamTag)),PRE:d.$$d_onPreOpen||(d.$$d_onPreOpen=Function.createDelegate(d,d.onPreOpen)),Q:e.$$d_onQOpen||(e.$$d_onQOpen=Function.createDelegate(e,e.onQOpen)),S:f.$$d_onSOpen||(f.$$d_onSOpen=Function.createDelegate(f,f.onSOpen)),SAMP:g.$$d_onSampOpen||(g.$$d_onSampOpen=Function.createDelegate(g,g.onSampOpen)),SCRIPT:h.$$d_onScriptOpen||(h.$$d_onScriptOpen=Function.createDelegate(h,h.onScriptOpen)),SELECT:i.$$d_onSelectOpen||(i.$$d_onSelectOpen=Function.createDelegate(i,i.onSelectOpen)),SMALL:j.$$d_onSmallOpen||(j.$$d_onSmallOpen=Function.createDelegate(j,j.onSmallOpen)),SPAN:k.$$d_onSpanOpen||(k.$$d_onSpanOpen=Function.createDelegate(k,k.onSpanOpen)),STRIKE:l.$$d_onStrikeOpen||(l.$$d_onStrikeOpen=Function.createDelegate(l,l.onStrikeOpen)),STRONG:m.$$d_onStrongOpen||(m.$$d_onStrongOpen=Function.createDelegate(m,m.onStrongOpen)),STYLE:n.$$d_onStyleOpen||(n.$$d_onStyleOpen=Function.createDelegate(n,n.onStyleOpen)),SUB:o.$$d_onSubOpen||(o.$$d_onSubOpen=Function.createDelegate(o,o.onSubOpen)),SUP:p.$$d_onSupOpen||(p.$$d_onSupOpen=Function.createDelegate(p,p.onSupOpen)),TABLE:q.$$d_onTableOpen||(q.$$d_onTableOpen=Function.createDelegate(q,q.onTableOpen)),TBODY:r.$$d_onTbodyOpen||(r.$$d_onTbodyOpen=Function.createDelegate(r,r.onTbodyOpen)),TD:s.$$d_onTdOpen||(s.$$d_onTdOpen=Function.createDelegate(s,s.onTdOpen)),TEXTAREA:t.$$d_onTextareaOpen||(t.$$d_onTextareaOpen=Function.createDelegate(t,t.onTextareaOpen)),TFOOT:u.$$d_onTfootOpen||(u.$$d_onTfootOpen=Function.createDelegate(u,u.onTfootOpen)),TH:v.$$d_onThOpen||(v.$$d_onThOpen=Function.createDelegate(v,v.onThOpen)),THEAD:w.$$d_onTheadOpen||(w.$$d_onTheadOpen=Function.createDelegate(w,w.onTheadOpen)),TITLE:x.$$d_onTitleOpen||(x.$$d_onTitleOpen=Function.createDelegate(x,x.onTitleOpen)),TR:y.$$d_onTrOpen||(y.$$d_onTrOpen=Function.createDelegate(y,y.onTrOpen)),TT:z.$$d_onTtOpen||(z.$$d_onTtOpen=Function.createDelegate(z,z.onTtOpen)),U:A.$$d_onUOpen||(A.$$d_onUOpen=Function.createDelegate(A,A.onUOpen)),UL:B.$$d_onUlOpen||(B.$$d_onUlOpen=Function.createDelegate(B,B.onUlOpen)),VAR:C.$$d_onVarOpen||(C.$$d_onVarOpen=Function.createDelegate(C,C.onVarOpen))}}};RTE.HtmlImport.List=function(){ULSNVe:;this.$w_0=[]};RTE.HtmlImport.List.$$=function(f){ULSNVe:;var a="List$1$"+f.getName().replace(/\./g,"_");if(!RTE.HtmlImport[a]){var e=RTE.HtmlImport[a]=function(){ULSNVe:;(this.$$gta=this.$$gta||{})["RTE.HtmlImport.List"]={T:f};for(var b=[],a=0;a<arguments.length;++a)b[a]=arguments[a];RTE.HtmlImport.List.apply(this,b)};e.registerClass("RTE.HtmlImport."+a);var c=RTE.HtmlImport.List.prototype;for(var d in c){var b={key:d,value:c[d]};if("constructor"!==b.key)e.prototype[b.key]=b.value}}return RTE.HtmlImport[a]};RTE.HtmlImport.List.prototype={$w_0:null,get_count:function(){ULSNVe:;return this.$w_0.length},get_item:function(a){ULSNVe:;return this.$w_0[a]},set_item:function(b,a){ULSNVe:;this.$w_0[b]=a;return a},add:function(a){ULSNVe:;Array.add(this.$w_0,a)},clear:function(){ULSNVe:;Array.clear(this.$w_0)},contains:function(a){ULSNVe:;return Array.contains(this.$w_0,a)},forEach:function(a){ULSNVe:;var b=this;Array.forEach(this.$w_0,function(c){ULSNVe:;RTE.PasteCommon.Debug.assertTag(b.$$gta["RTE.HtmlImport.List"].T.isInstanceOfType(c),596194);a(c)})},getRange:function(c,b){ULSNVe:;RTE.PasteCommon.Debug.assertTag(c+b<=this.get_count(),596195);for(var d=new(RTE.HtmlImport.List.$$(this.$$gta["RTE.HtmlImport.List"].T)),a=0;a<b;a++)d.add(this.get_item(c+a));return d},indexOf:function(a){ULSNVe:;return Array.indexOf(this.$w_0,a)},insert:function(a,b){ULSNVe:;Array.insert(this.$w_0,a,b)},remove:function(a){ULSNVe:;return Array.remove(this.$w_0,a)},removeAt:function(a){ULSNVe:;Array.removeAt(this.$w_0,a)},removeRange:function(b,a){ULSNVe:;RTE.PasteCommon.Debug.assertTag(b+a<=this.get_count(),598016);for(var c=0;c<a;c++)Array.removeAt(this.$w_0,b)},reverse:function(){ULSNVe:;this.$w_0.reverse()},sort:function(){ULSNVe:;this.$w_0.sort()},toArray:function(){ULSNVe:;return Array.clone(this.$w_0)}};RTE.HtmlImport.PlaintextHtmlTranslator=function(a){ULSNVe:;RTE.HtmlImport.PlaintextHtmlTranslator.initializeBase(this,[a])};RTE.HtmlImport.PlaintextHtmlTranslator.prototype={onText:function(a){ULSNVe:;this.normalizer.onText(a)},onBlockquoteOpen:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onBrTag:function(){ULSNVe:;this.normalizer.onLineBreak()},onCaptionOpen:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onCenterOpen:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onDdOpen:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onDivOpen:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onDlOpen:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onDtOpen:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onH1Open:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onH2Open:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onH3Open:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onH4Open:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onH5Open:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onH6Open:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onHrTag:function(){ULSNVe:;this.normalizer.onLineBreak()},onLabelOpen:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onLegendOpen:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onLiOpen:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onOptionOpen:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onPOpen:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onPreOpen:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onTdOpen:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onThOpen:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1},onTrOpen:function(){ULSNVe:;this.normalizer.onParagraphStart();var a=this.normalizer;this.registerOnCloseCallback(a.$$d_onParagraphEnd||(a.$$d_onParagraphEnd=Function.createDelegate(a,a.onParagraphEnd)));return 1}};RTE.HtmlImport.QueueNode=function(){ULSNVe:;this.data=this.$$gta["RTE.HtmlImport.QueueNode"].TNode===Number||Type.isEnum(this.$$gta["RTE.HtmlImport.QueueNode"].TNode)?0:this.$$gta["RTE.HtmlImport.QueueNode"].TNode===Boolean?false:null};RTE.HtmlImport.QueueNode.$$=function(f){ULSNVe:;var a="QueueNode$1$"+f.getName().replace(/\./g,"_");if(!RTE.HtmlImport[a]){var e=RTE.HtmlImport[a]=function(){ULSNVe:;(this.$$gta=this.$$gta||{})["RTE.HtmlImport.QueueNode"]={TNode:f};for(var b=[],a=0;a<arguments.length;++a)b[a]=arguments[a];RTE.HtmlImport.QueueNode.apply(this,b)};e.registerClass("RTE.HtmlImport."+a);var c=RTE.HtmlImport.QueueNode.prototype;for(var d in c){var b={key:d,value:c[d]};if("constructor"!==b.key)e.prototype[b.key]=b.value}}return RTE.HtmlImport[a]};RTE.HtmlImport.QueueNode.prototype={next:null};RTE.HtmlImport.Queue=function(){ULSNVe:;this.$2w_0=null;this.$1r_0=null;this.$p_0=0};RTE.HtmlImport.Queue.$$=function(f){ULSNVe:;var a="Queue$1$"+f.getName().replace(/\./g,"_");if(!RTE.HtmlImport[a]){var e=RTE.HtmlImport[a]=function(){ULSNVe:;(this.$$gta=this.$$gta||{})["RTE.HtmlImport.Queue"]={T:f};for(var b=[],a=0;a<arguments.length;++a)b[a]=arguments[a];RTE.HtmlImport.Queue.apply(this,b)};e.registerClass("RTE.HtmlImport."+a);var c=RTE.HtmlImport.Queue.prototype;for(var d in c){var b={key:d,value:c[d]};if("constructor"!==b.key)e.prototype[b.key]=b.value}}return RTE.HtmlImport[a]};RTE.HtmlImport.Queue.prototype={$2w_0:null,$1r_0:null,$p_0:0,get_count:function(){ULSNVe:;return this.$p_0},get_isEmpty:function(){ULSNVe:;return!this.$p_0||!this.$2w_0||!this.$1r_0},enqueue:function(b){ULSNVe:;var a=new(RTE.HtmlImport.QueueNode.$$(this.$$gta["RTE.HtmlImport.Queue"].T));a.data=b;if(this.get_isEmpty()){this.$2w_0=a;this.$1r_0=a}else{RTE.PasteCommon.Debug.assertTag(!!this.$1r_0,598018);this.$2w_0.next=a;this.$2w_0=a}this.$p_0++},front:function(){ULSNVe:;return this.get_isEmpty()?null:this.$1r_0.data},dequeue:function(){ULSNVe:;if(this.get_isEmpty()){RTE.PasteCommon.Debug.$E("Attempting to Dequeue from an empty Queue!",598019);return null}var a=this.$1r_0;this.$1r_0=a.next;this.$p_0--;if(!this.$1r_0){this.$2w_0=null;RTE.PasteCommon.Debug.assertTag(this.get_isEmpty(),598020)}return a.data},clear:function(){ULSNVe:;this.$2w_0=null;this.$1r_0=null;this.$p_0=0},toArray:function(){ULSNVe:;for(var c=new Array(this.$p_0),a=this.$1r_0,b=0;b<this.$p_0;b++){if(!a){RTE.PasteCommon.Debug.$E("The Queue's Count is wrong!  Returning a partially-filled array",598021);break}c[b]=a.data;a=a.next}RTE.PasteCommon.Debug.$1u(!a,"The Queue's Count is wrong!  Returning a partial array",598022);return c}};RTE.HtmlImport.QueuedEventManager=function(){ULSNVe:;this.$4U_0=new(RTE.HtmlImport.Queue.$$(Object))};RTE.HtmlImport.QueuedEventManager.prototype={$4U_0:null,get_$JL_0:function(){ULSNVe:;return this.$4U_0.get_isEmpty()},$a_0:function(a){ULSNVe:;this.$4U_0.enqueue(a)},$Bd_0:function(a){ULSNVe:;a&&this.$L9_0();while(!this.$4U_0.get_isEmpty()){var b=this.$4U_0.dequeue();b()}a&&this.$Ku_0()},$L9_0:function(){},$Ku_0:function(){}};RTE.HtmlImport.ListSemanticArgs=function(a,b){ULSNVe:;RTE.PasteCommon.Debug.$1u(!!a,"Lists must specify a ListStyleType (eg DefaultUnordered/Ordered, Disc, Decimal, etc)",598024);this.$4S_0=a;this.$3Y_0=0;this.$3a_0=b;this.$2W_0=b===1;this.$2T_0=-1;this.$4W_0=true};RTE.HtmlImport.ListSemanticArgs.prototype={$4S_0:0,$3Y_0:0,$2T_0:0,$4W_0:false,get_listStyleType:function(){ULSNVe:;return this.get_isListItemStyleSpecified()?this.$3Y_0:this.$4S_0},get_isListStyleSpecified:function(){ULSNVe:;return this.$4S_0!==2&&this.$4S_0!==6},get_isListItemStyleSpecified:function(){ULSNVe:;return!!this.$3Y_0},get_startNumber:function(){ULSNVe:;return this.$3a_0},$3a_0:0,get_isListNumbered:function(){ULSNVe:;return this.get_listStyleType()>=6},get_isAutoNumber:function(){ULSNVe:;return this.$2W_0},$2W_0:false,get_currentNumber:function(){ULSNVe:;RTE.PasteCommon.Debug.assertTag(this.$2T_0>=0,598023);return this.$4W_0?this.$3a_0+this.$2T_0:this.$2T_0},$Fr_0:function(){ULSNVe:;var a=new RTE.HtmlImport.ListSemanticArgs(this.$4S_0,this.$3a_0);a.$3Y_0=this.$3Y_0;a.$2W_0=this.$2W_0;a.$2T_0=this.$2T_0;a.$4W_0=this.$4W_0;return a},$F6_0:function(b,a){ULSNVe:;RTE.PasteCommon.Debug.assertTag(a>=0,598025);this.$3Y_0=b;if(a>0){this.$2W_0=false;this.$2T_0=a;this.$4W_0=false}else{this.$2T_0++;this.$2W_0=true}},resetListStartNumber:function(a){ULSNVe:;this.$3a_0=a}};RTE.HtmlImport.TableSemanticArgs=function(a,b){ULSNVe:;this.rowCount=a;this.colCount=b};RTE.HtmlImport.TableSemanticArgs.prototype={rowCount:0,colCount:0};RTE.HtmlImport.TableCellSemanticArgs=function(a,b){ULSNVe:;this.colSpan=a;this.rowSpan=b};RTE.HtmlImport.TableCellSemanticArgs.prototype={colSpan:0,rowSpan:0};RTE.HtmlImport.ImageSemanticArgs=function(a,b,c,d){ULSNVe:;this.src=a;this.alt=b;this.width=c;this.height=d};RTE.HtmlImport.ImageSemanticArgs.prototype={src:null,alt:null,width:0,height:0};RTE.HtmlImport.StackNode=function(){ULSNVe:;this.data=this.$$gta["RTE.HtmlImport.StackNode"].TNode===Number||Type.isEnum(this.$$gta["RTE.HtmlImport.StackNode"].TNode)?0:this.$$gta["RTE.HtmlImport.StackNode"].TNode===Boolean?false:null};RTE.HtmlImport.StackNode.$$=function(f){ULSNVe:;var a="StackNode$1$"+f.getName().replace(/\./g,"_");if(!RTE.HtmlImport[a]){var e=RTE.HtmlImport[a]=function(){ULSNVe:;(this.$$gta=this.$$gta||{})["RTE.HtmlImport.StackNode"]={TNode:f};for(var b=[],a=0;a<arguments.length;++a)b[a]=arguments[a];RTE.HtmlImport.StackNode.apply(this,b)};e.registerClass("RTE.HtmlImport."+a);var c=RTE.HtmlImport.StackNode.prototype;for(var d in c){var b={key:d,value:c[d]};if("constructor"!==b.key)e.prototype[b.key]=b.value}}return RTE.HtmlImport[a]};RTE.HtmlImport.StackNode.prototype={next:null};RTE.HtmlImport.Stack=function(){ULSNVe:;this.$1t_0=null;this.$p_0=0};RTE.HtmlImport.Stack.$$=function(f){ULSNVe:;var a="Stack$1$"+f.getName().replace(/\./g,"_");if(!RTE.HtmlImport[a]){var e=RTE.HtmlImport[a]=function(){ULSNVe:;(this.$$gta=this.$$gta||{})["RTE.HtmlImport.Stack"]={T:f};for(var b=[],a=0;a<arguments.length;++a)b[a]=arguments[a];RTE.HtmlImport.Stack.apply(this,b)};e.registerClass("RTE.HtmlImport."+a);var c=RTE.HtmlImport.Stack.prototype;for(var d in c){var b={key:d,value:c[d]};if("constructor"!==b.key)e.prototype[b.key]=b.value}}return RTE.HtmlImport[a]};RTE.HtmlImport.Stack.prototype={$1t_0:null,$p_0:0,get_count:function(){ULSNVe:;return this.$p_0},get_isEmpty:function(){ULSNVe:;RTE.PasteCommon.Debug.assertTag(!this.$p_0===!this.$1t_0,598026);return!this.$p_0||!this.$1t_0},push:function(b){ULSNVe:;var a=new(RTE.HtmlImport.StackNode.$$(this.$$gta["RTE.HtmlImport.Stack"].T));a.data=b;a.next=this.$1t_0;this.$1t_0=a;this.$p_0++},peek:function(){ULSNVe:;return this.get_isEmpty()?null:this.$1t_0.data},pop:function(){ULSNVe:;if(this.get_isEmpty()){RTE.PasteCommon.Debug.$E("Attempting to Pop off an empty Stack!",598027);return null}var a=this.$1t_0;this.$1t_0=a.next;this.$p_0--;return a.data},clear:function(){ULSNVe:;this.$1t_0=null;this.$p_0=0},toArray:function(){ULSNVe:;for(var c=new Array(this.$p_0),a=this.$1t_0,b=this.$p_0-1;b>=0;b--){if(!a){RTE.PasteCommon.Debug.$E("The Stack's Count is wrong!  Returning a partially-filled array",598028);break}c[b]=a.data;a=a.next}RTE.PasteCommon.Debug.$1u(!a,"The Stack's Count is wrong!  Returning a partial array",598029);return c}};RTE.HtmlImport.WordConverter=function(){ULSNVe:;this.$$d_$KP_0=Function.createDelegate(this,this.$KP_0);this.$$d_$KQ_0=Function.createDelegate(this,this.$KQ_0)};RTE.HtmlImport.WordConverter.$IO=function(f,c,d){ULSNVe:;var a=RTE.HtmlImport.WordConverter.$Ds(f,c.$40_0,d),b=RTE.PasteCommon.CustomData.getObject(a,"UniqueListId");if(b&&b!==c.$2S_0||!b&&a.firstChild){var e=f.ownerDocument.createElement(d.$2R_0);a.parentNode.insertBefore(e,a.nextSibling);a=e}RTE.PasteCommon.CustomData.$4J(a,"UniqueListId",c.$2S_0);return RTE.HtmlImport.WordConverter.$HT(a,d)};RTE.HtmlImport.WordConverter.$HT=function(a,c){ULSNVe:;if(c.$2R_0!==a.tagName){var b=a.ownerDocument.createElement(c.$2R_0);RTE.PasteCommon.CustomData.$4J(b,"UniqueListId",RTE.PasteCommon.CustomData.getObject(a,"UniqueListId"));while(a.firstChild)b.appendChild(a.firstChild);a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a);a=b}return a};RTE.HtmlImport.WordConverter.$Ds=function(b,e,g){ULSNVe:;var c=null,a;if(e===1)a=RTE.HtmlImport.WordConverter.$m(b);else{c=RTE.HtmlImport.WordConverter.$Ds(b,e-1,null);a=c.lastChild}if(a&&a.nodeType===1){var f=a.tagName.toUpperCase();if(f==="UL"||f==="OL")return a}var d=b.ownerDocument.createElement(g?g.$2R_0:"UL");if(e===1)b.parentNode.insertBefore(d,b);else c.appendChild(d);return d};RTE.HtmlImport.WordConverter.$Aq=function(c,d){ULSNVe:;for(var b=0;b<c.childNodes.length;b++){var a=c.childNodes[b];a.nodeType===1&&d>1&&RTE.HtmlImport.WordConverter.$Aq(a,d-1);if(RTE.HtmlImport.WordConverter.$6T(a)||RTE.HtmlImport.WordConverter.$Ck(a)){c.removeChild(a);b--}}};RTE.HtmlImport.WordConverter.$IL=function(c){ULSNVe:;if(c.nodeType===1){var a=RTE.HtmlImport.WordConverter.$C7(c,"mso-list");if(a&&a.length>0)try{var d=a.split(" ");if(d.length===3){var b=new RTE.HtmlImport.ListItemMetadata;b.$40_0=Number.parseInvariant(d[1].substr(5));b.$A5_0=a;b.$DZ_0=c;return b}}catch(e){RTE.PasteCommon.Debug.$E("Error parsing mso-list: "+e.message,840342)}}return null};RTE.HtmlImport.WordConverter.$IC=function(a){ULSNVe:;return a!=="o"&&a!=="\u00b7"&&a!=="\u00a7"&&a!=="-"?"OL":"UL"};RTE.HtmlImport.WordConverter.$8S=function(d,e){ULSNVe:;for(var a=null,c=0;!a&&c<d.childNodes.length;c++){var b=d.childNodes[c];if(RTE.HtmlImport.WordConverter.$Ck(b)){if(typeof b.innerText==="string")a=b.innerText.trim();else a=b.textContent.trim();if(!a.length)a="o"}else if(b.nodeType===1&&e>1)a=RTE.HtmlImport.WordConverter.$8S(b,e-1)}return a};RTE.HtmlImport.WordConverter.$Ck=function(b){ULSNVe:;if(b.nodeType===1){var a=RTE.HtmlImport.WordConverter.$C7(b,"mso-list");if(a&&a.length>0&&a.trim().toLowerCase()==="ignore")return true}return false};RTE.HtmlImport.WordConverter.$6T=function(a){ULSNVe:;return a.nodeType===1&&!a.firstChild&&a.tagName.toUpperCase()==="SPAN"};RTE.HtmlImport.WordConverter.$C7=function(f,e){ULSNVe:;var a=f.getAttribute("style");if(a&&a.length>0&&a.indexOf(e)!==-1)for(var d=a.split(";"),b=0;b<d.length;b++){var c=d[b].split(":");if(c.length===2&&c[0].trim()===e)return c[1].trim()}return null};RTE.HtmlImport.WordConverter.$m=function(b){ULSNVe:;var a=b;do a=a.previousSibling;while(a&&RTE.HtmlImport.WordConverter.$1x(a));return a};RTE.HtmlImport.WordConverter.$1x=function(a){ULSNVe:;if(!a)return true;if(a.nodeType===3){var b=a.nodeValue;b=b.replace(RTE.HtmlImport.WordConverter.$AE,"");return!b.trim().length}return a.nodeType===1&&a.firstChild===a.lastChild&&(a.tagName==="SPAN"||a.tagName==="FONT")?RTE.HtmlImport.WordConverter.$1x(a.firstChild):false};RTE.HtmlImport.WordConverter.$Kv=function(c){ULSNVe:;for(var a=0;a<c.$1W_0.length;a++){var b=c.$1W_0[a];if(b)b.$4i_0=-1}};RTE.HtmlImport.WordConverter.prototype={$En_0:1,$AK_0:0,$7g_0:0,process:function(c,a){ULSNVe:;if(!c){RTE.PasteCommon.Debug.$7m(840341);return}this.$7g_0=0;this.$AK_0=0;if(c.querySelectorAll){var b=c.querySelectorAll("p");if(b&&b.length>0){var d=new RTE.PasteCommon.SimpleOperation(a,this.$$d_$KQ_0,new RTE.HtmlImport.WordConverterArguments(b));d.set_$2e_1(!a||a.get_$2e_1());d.$9c_1()}}},$KQ_0:function(h,i){ULSNVe:;var a=i,c=a.$9F_0[a.$2a_0],d=RTE.HtmlImport.WordConverter.$IL(c);if(d){var f=a.$1W_0[d.$40_0-1];if(!f){f=new RTE.HtmlImport.LevelLists;a.$1W_0[d.$40_0-1]=f}a.$56_0&&RTE.HtmlImport.WordConverter.$m(c)!==a.$56_0&&RTE.HtmlImport.WordConverter.$Kv(a);var b=f.$8x_0[d.$A5_0];if(!b){b=new RTE.HtmlImport.ListMetadata;b.$2S_0=this.$En_0++;b.$3n_0=RTE.HtmlImport.WordConverter.$8S(c,5);b.$3q_0=!b.$3n_0||!b.$3n_0.length;b.$2R_0=RTE.HtmlImport.WordConverter.$IC(b.$3n_0);f.$8x_0[d.$A5_0]=b;a.$8w_0[b.$2S_0.toString()]=b}else if(!b.$3q_0&&b.$6v_0===1){var g=RTE.HtmlImport.WordConverter.$8S(c,5);b.$2R_0=b.$3n_0===g?"UL":"OL"}d.$2S_0=b.$2S_0;if(b.$3q_0||b.$2R_0==="OL"&&b.$6v_0>0&&f.$4i_0!==d.$2S_0){b.$3q_0=true;a.$1W_0[0].$4i_0=-1;a.$1W_0=a.$1W_0.slice(0,1)}else{if(a.$1W_0.length>d.$40_0)a.$1W_0=a.$1W_0.slice(0,d.$40_0);f.$4i_0=d.$2S_0;a.$41_0[a.$41_0.length]=d;b.$6v_0++}a.$56_0=c}else{var e=a.$56_0;if(e&&RTE.HtmlImport.WordConverter.$m(c)===e&&c.tagName===e.tagName&&c.className===e.className){e.appendChild(e.ownerDocument.createElement("BR"));e.appendChild(e.ownerDocument.createElement("BR"));while(c.firstChild)e.appendChild(c.firstChild);c.parentNode.removeChild(c)}}a.$2a_0++;if(a.$9F_0.length<=a.$2a_0){if(!a.$41_0.length)return false;a.$2a_0=0;h.$60_1(this.$$d_$KP_0)}return true},$KP_0:function(h,g){ULSNVe:;var b=g,c=b.$41_0[b.$2a_0],a=c.$DZ_0,d=b.$8w_0[c.$2S_0.toString()];if(!d.$3q_0){var e=RTE.HtmlImport.WordConverter.$IO(a,c,d);if(e){RTE.HtmlImport.WordConverter.$Aq(a,5);var f=a.ownerDocument.createElement("LI");while(a.firstChild)f.appendChild(a.firstChild);e.appendChild(f);a.parentNode.removeChild(a);if(d.$2R_0==="UL")this.$AK_0++;else this.$7g_0++}}b.$2a_0++;return b.$2a_0<b.$41_0.length}};RTE.Rectangle.registerClass("RTE.Rectangle");RTE.EmbeddingInsertArgs.registerClass("RTE.EmbeddingInsertArgs");RTE.FontSizeInfo.registerClass("RTE.FontSizeInfo");RTE.FontFamilyInfo.registerClass("RTE.FontFamilyInfo");RTE.InsertTableOptions.registerClass("RTE.InsertTableOptions");RTE.InsertLinkDialogArguments.registerClass("RTE.InsertLinkDialogArguments");RTE.GalleryData.registerClass("RTE.GalleryData");RTE.StyleButton.registerClass("RTE.StyleButton");RTE.TableCellInfo.registerClass("RTE.TableCellInfo");RTE.TableColumnInfo.registerClass("RTE.TableColumnInfo");RTE.TableGrid.registerClass("RTE.TableGrid");RTE.CircularArray.registerClass("RTE.CircularArray");RTE.HtmlTagName.registerClass("RTE.HtmlTagName");RTE.SelectionNodesProcessor.registerClass("RTE.SelectionNodesProcessor");RTE.ApplyOnSelectionProcessor.registerClass("RTE.ApplyOnSelectionProcessor",RTE.SelectionNodesProcessor);RTE.Autocomplete.registerClass("RTE.Autocomplete");RTE.AutocompleteParseData.registerClass("RTE.AutocompleteParseData");RTE.WikiLinkAutoComplete.registerClass("RTE.WikiLinkAutoComplete",null,RTE.IAutocomplete);RTE.AutocompleteResultSource.registerClass("RTE.AutocompleteResultSource");RTE.AutocompleteWikiLinkSource.registerClass("RTE.AutocompleteWikiLinkSource",RTE.AutocompleteResultSource);RTE.AutocompleteListCacheObject.registerClass("RTE.AutocompleteListCacheObject");RTE.AutocompleteListItemCacheObject.registerClass("RTE.AutocompleteListItemCacheObject");RTE.AutocompleteCacheObject.registerClass("RTE.AutocompleteCacheObject");RTE.RTFieldFlags.registerClass("RTE.RTFieldFlags");RTE.Canvas.registerClass("RTE.Canvas");RTE.CanvasEvents.registerClass("RTE.CanvasEvents");RTE.CanvasRange.registerClass("RTE.CanvasRange");RTE.QuickRange.registerClass("RTE.QuickRange");RTE.ClientWebPartManager.registerClass("RTE.ClientWebPartManager");RTE.RibbonCommandNames.registerClass("RTE.RibbonCommandNames");RTE.CommandNames.registerClass("RTE.CommandNames");RTE.Cursor.registerClass("RTE.Cursor");RTE.DirtyBitManager.registerClass("RTE.DirtyBitManager");RTE.DOMTreePosition.registerClass("RTE.DOMTreePosition");RTE.EmbeddingCommands.registerClass("RTE.EmbeddingCommands");RTE.EmbeddingMethods.registerClass("RTE.EmbeddingMethods");RTE.EmbeddingDialog.registerClass("RTE.EmbeddingDialog");RTE.RteEmbeddingDialog.registerClass("RTE.RteEmbeddingDialog",RTE.EmbeddingDialog);RTE.WebPartEmbeddingDialog.registerClass("RTE.WebPartEmbeddingDialog",RTE.EmbeddingDialog);RTE.ExtractChildNodesProcessor.registerClass("RTE.ExtractChildNodesProcessor");RTE.FontCommands.registerClass("RTE.FontCommands");RTE.HtmlFormat.registerClass("RTE.HtmlFormat");RTE.HtmlAndSelection.registerClass("RTE.HtmlAndSelection");RTE.HtmlSourceCommands.registerClass("RTE.HtmlSourceCommands");RTE.EditHtmlSourceDialog.registerClass("RTE.EditHtmlSourceDialog");RTE.ShortcutKeys.registerClass("RTE.ShortcutKeys");RTE.MovementKeys.registerClass("RTE.MovementKeys");RTE.SelectionClearingKeys.registerClass("RTE.SelectionClearingKeys");RTE.LayoutsEditor.registerClass("RTE.LayoutsEditor");RTE.LayoutsZone.registerClass("RTE.LayoutsZone");RTE.NodeDictionaryCache.registerClass("RTE.NodeDictionaryCache");RTE.DialogUtility.registerClass("RTE.DialogUtility");RTE.InsertLinkDialog.registerClass("RTE.InsertLinkDialog");RTE.InsertHtmlDialog.registerClass("RTE.InsertHtmlDialog");RTE.InsertImageDialog.registerClass("RTE.InsertImageDialog");RTE.ObjectCommands.registerClass("RTE.ObjectCommands");RTE.ParagraphCommands.registerClass("RTE.ParagraphCommands");RTE.PasteFlyout.registerClass("RTE.PasteFlyout");RTE.RtePasteManager.registerClass("RTE.RtePasteManager");RTE.PasteOperationArgs.registerClass("RTE.PasteOperationArgs");RTE.PasteMode.registerClass("RTE.PasteMode");RTE.WordConverterPasteMode.registerClass("RTE.WordConverterPasteMode",RTE.PasteMode);RTE.AsIsPasteMode.registerClass("RTE.AsIsPasteMode",RTE.WordConverterPasteMode);RTE.CleanPasteMode.registerClass("RTE.CleanPasteMode",RTE.WordConverterPasteMode);RTE.PlainTextPasteMode.registerClass("RTE.PlainTextPasteMode",RTE.PasteMode);RTE.PreviewManager.registerClass("RTE.PreviewManager");RTE.ScrollPosition.registerClass("RTE.ScrollPosition");RTE.ElementPlaceholderReplacer.registerClass("RTE.ElementPlaceholderReplacer");RTE.Range.registerClass("RTE.Range");RTE.RemoveStyleOnSelectionProcessor.registerClass("RTE.RemoveStyleOnSelectionProcessor",RTE.SelectionNodesProcessor);RTE.RibbonIds.registerClass("RTE.RibbonIds");RTE.CommandState.registerClass("RTE.CommandState");RTE.RichTextEditor.registerClass("RTE.RichTextEditor");RTE.WebPartCommands.registerClass("RTE.WebPartCommands");RTE.RichTextEditorComponent.registerClass("RTE.RichTextEditorComponent",CUI.Page.PageComponent);RTE.RichTextEditorComponentProvider.registerClass("RTE.RichTextEditorComponentProvider");RTE.HtmlImport.AHtmlPasteSteward.registerClass("RTE.HtmlImport.AHtmlPasteSteward",null,RTE.HtmlImport.ISemanticEventAcceptor);RTE.RteHtmlPasteSteward.registerClass("RTE.RteHtmlPasteSteward",RTE.HtmlImport.AHtmlPasteSteward);RTE.RteHtmlPasteSteward.FormattingSteward.registerClass("RTE.RteHtmlPasteSteward.FormattingSteward",null,RTE.HtmlImport.IFormattingSteward);RTE.HtmlImport.AHtmlTranslator.registerClass("RTE.HtmlImport.AHtmlTranslator",null,RTE.HtmlImport.IHtmlEventAcceptor);RTE.HtmlImport.DefaultHtmlTranslator.registerClass("RTE.HtmlImport.DefaultHtmlTranslator",RTE.HtmlImport.AHtmlTranslator);RTE.RteHtmlTranslator.registerClass("RTE.RteHtmlTranslator",RTE.HtmlImport.DefaultHtmlTranslator);RTE.HtmlImport.AHtmlNormalizer.registerClass("RTE.HtmlImport.AHtmlNormalizer",null,RTE.HtmlImport.ISemanticEventAcceptor);RTE.HtmlImport.AQueuingHtmlNormalizer.registerClass("RTE.HtmlImport.AQueuingHtmlNormalizer",RTE.HtmlImport.AHtmlNormalizer);RTE.HtmlImport.DefaultHtmlNormalizer.registerClass("RTE.HtmlImport.DefaultHtmlNormalizer",RTE.HtmlImport.AQueuingHtmlNormalizer);RTE.RteHtmlNormalizer.registerClass("RTE.RteHtmlNormalizer",RTE.HtmlImport.DefaultHtmlNormalizer);RTE.RteRibbonBuilder.registerClass("RTE.RteRibbonBuilder");RTE.UnitValue.registerClass("RTE.UnitValue");RTE.RteUtility.registerClass("RTE.RteUtility");RTE.SU.registerClass("RTE.SU");RTE.Ie8TreeValidator.registerClass("RTE.Ie8TreeValidator");RTE.SafeHtml.registerClass("RTE.SafeHtml");RTE.Selection.registerClass("RTE.Selection");RTE.SelectionManager.registerClass("RTE.SelectionManager");RTE.Snapshot.registerClass("RTE.Snapshot");RTE.SnapshotManager.registerClass("RTE.SnapshotManager");RTE.SPRichTextEditorComponentProvider.registerClass("RTE.SPRichTextEditorComponentProvider",RTE.RichTextEditorComponentProvider);RTE.RteRibbonCommand.registerClass("RTE.RteRibbonCommand");RTE.CssStyleInfo.registerClass("RTE.CssStyleInfo");RTE.StyleRuleUtility.registerClass("RTE.StyleRuleUtility");RTE.TableCommands.registerClass("RTE.TableCommands");RTE.TableKeyTabProcessor.registerClass("RTE.TableKeyTabProcessor",null,RTE.ICommandProcessor);RTE.XhtmlProcessor.registerClass("RTE.XhtmlProcessor");RTE.XhtmlRules.registerClass("RTE.XhtmlRules");RTE.RibbonReferences.registerClass("RTE.RibbonReferences");RTE.PasteCommon.Debug.registerClass("RTE.PasteCommon.Debug");RTE.PasteCommon.LogLevel.registerClass("RTE.PasteCommon.LogLevel");RTE.PasteCommon.StringUtils.registerClass("RTE.PasteCommon.StringUtils");RTE.PasteCommon.CustomData.registerClass("RTE.PasteCommon.CustomData");RTE.PasteCommon.AOperation.registerClass("RTE.PasteCommon.AOperation");RTE.PasteCommon.SimpleOperation.registerClass("RTE.PasteCommon.SimpleOperation",RTE.PasteCommon.AOperation);RTE.PasteCommon.HtmlProcessorPercentage.registerClass("RTE.PasteCommon.HtmlProcessorPercentage");RTE.HtmlImport.HtmlProcessorArguments.registerClass("RTE.HtmlImport.HtmlProcessorArguments");RTE.HtmlImport.WordConverterArguments.registerClass("RTE.HtmlImport.WordConverterArguments");RTE.HtmlImport.LevelLists.registerClass("RTE.HtmlImport.LevelLists");RTE.HtmlImport.ListItemMetadata.registerClass("RTE.HtmlImport.ListItemMetadata");RTE.HtmlImport.ListMetadata.registerClass("RTE.HtmlImport.ListMetadata");RTE.HtmlImport.QueuedEventManager.registerClass("RTE.HtmlImport.QueuedEventManager");RTE.HtmlImport.DefaultHtmlNormalizer.NormalizedTable.registerClass("RTE.HtmlImport.DefaultHtmlNormalizer.NormalizedTable",RTE.HtmlImport.QueuedEventManager);RTE.HtmlImport.DefaultHtmlNormalizer.NormalizedTable.TableCell.registerClass("RTE.HtmlImport.DefaultHtmlNormalizer.NormalizedTable.TableCell");RTE.HtmlImport.DefaultHtmlNormalizer.ContentState.registerClass("RTE.HtmlImport.DefaultHtmlNormalizer.ContentState",RTE.HtmlImport.QueuedEventManager);RTE.HtmlImport.HtmlProcessor.registerClass("RTE.HtmlImport.HtmlProcessor");RTE.HtmlImport.PlaintextHtmlTranslator.registerClass("RTE.HtmlImport.PlaintextHtmlTranslator",RTE.HtmlImport.AHtmlTranslator);RTE.HtmlImport.ListSemanticArgs.registerClass("RTE.HtmlImport.ListSemanticArgs");RTE.HtmlImport.TableSemanticArgs.registerClass("RTE.HtmlImport.TableSemanticArgs");RTE.HtmlImport.TableCellSemanticArgs.registerClass("RTE.HtmlImport.TableCellSemanticArgs");RTE.HtmlImport.ImageSemanticArgs.registerClass("RTE.HtmlImport.ImageSemanticArgs");RTE.HtmlImport.WordConverter.registerClass("RTE.HtmlImport.WordConverter");function sp_ui_rte_initialize(){ULSNVe:;RTE.HtmlTagName.AREA="AREA";RTE.HtmlTagName.b="B";RTE.HtmlTagName.BODY="BODY";RTE.HtmlTagName.BUTTON="BUTTON";RTE.HtmlTagName.BR="BR";RTE.HtmlTagName.CENTER="CENTER";RTE.HtmlTagName.DEL="DEL";RTE.HtmlTagName.EM="EM";RTE.HtmlTagName.EMBED="EMBED";RTE.HtmlTagName.FONT="FONT";RTE.HtmlTagName.LI="LI";RTE.HtmlTagName.HTML="HTML";RTE.HtmlTagName.i="I";RTE.HtmlTagName.IFRAME="IFRAME";RTE.HtmlTagName.TABLE="TABLE";RTE.HtmlTagName.TBODY="TBODY";RTE.HtmlTagName.TFOOT="TFOOT";RTE.HtmlTagName.THEAD="THEAD";RTE.HtmlTagName.TD="TD";RTE.HtmlTagName.TH="TH";RTE.HtmlTagName.TR="TR";RTE.HtmlTagName.UL="UL";RTE.HtmlTagName.OBJECT="OBJECT";RTE.HtmlTagName.OL="OL";RTE.HtmlTagName.OPTION="OPTION";RTE.HtmlTagName.MENU="MENU";RTE.HtmlTagName.DIR="DIR";RTE.HtmlTagName.p="P";RTE.HtmlTagName.DIV="DIV";RTE.HtmlTagName.BLOCKQUOTE="BLOCKQUOTE";RTE.HtmlTagName.a="A";RTE.HtmlTagName.IMG="IMG";RTE.HtmlTagName.INPUT="INPUT";RTE.HtmlTagName.META="META";RTE.HtmlTagName.LINK="LINK";RTE.HtmlTagName.PARAM="PARAM";RTE.HtmlTagName.h1="H1";RTE.HtmlTagName.h2="H2";RTE.HtmlTagName.h3="H3";RTE.HtmlTagName.h4="H4";RTE.HtmlTagName.h5="H5";RTE.HtmlTagName.h6="H6";RTE.HtmlTagName.HR="HR";RTE.HtmlTagName.s="S";RTE.HtmlTagName.SELECT="SELECT";RTE.HtmlTagName.SPAN="SPAN";RTE.HtmlTagName.SCRIPT="SCRIPT";RTE.HtmlTagName.STYLE="STYLE";RTE.HtmlTagName.STRIKE="STRIKE";RTE.HtmlTagName.STRONG="STRONG";RTE.HtmlTagName.SUP="SUP";RTE.HtmlTagName.SUB="SUB";RTE.HtmlTagName.SVG="SVG";RTE.HtmlTagName.TEXTAREA="TEXTAREA";RTE.HtmlTagName.u="U";RTE.HtmlTagName.XML="XML";RTE.HtmlTagName.blockElements=["ADDRESS","BLOCKQUOTE","BODY","CENTER","DD","DT","DIR","DIV","DL","FIELDSET","FORM","FRAMESET","H1","H2","H3","H3","H4","H5","H6","HR","ISINDEX","MENU","NOFRAMES","NOSCRIPT","LI","OL","P","PRE","TABLE","TBODY","TFOOT","TD","TH","THEAD","TR","UL"];RTE.HtmlTagName.$7q={ADDRESS:true,BLOCKQUOTE:true,BODY:true,CENTER:true,DD:true,DT:true,DIR:true,DIV:true,DL:true,FIELDSET:true,FORM:true,FRAMESET:true,H1:true,H2:true,H3:true,H4:true,H5:true,H6:true,HR:true,ISINDEX:true,MENU:true,NOFRAMES:true,NOSCRIPT:true,LI:true,OL:true,P:true,PRE:true,TABLE:true,TBODY:true,TFOOT:true,TD:true,TH:true,THEAD:true,TR:true,UL:true};RTE.HtmlTagName.allowedElementStyleTags={P:true,H1:true,H2:true,H3:true,H4:true,H5:true,H6:true};RTE.HtmlTagName.tableCellTagNames=["TD","TH"];RTE.HtmlTagName.inlineElements=["A","ABBR","ACRONYM","B","BASEFONT","BDO","BIG","BR","CITE","CODE","DEL","DFN","EM","FONT","I","IMG","INPUT","KBD","LABEL","Q","S","SAMP","SELECT","SMALL","SPAN","STRIKE","STRONG","SUB","SUP","TEXTAREA","TT","U","VAR"];RTE.HtmlTagName.$CP={A:true,ABBR:true,ACRONYM:true,B:true,BASEFONT:true,BDO:true,BIG:true,BR:true,CITE:true,CODE:true,DEL:true,DFN:true,EM:true,FONT:true,I:true,IMG:true,INPUT:true,KBD:true,LABEL:true,Q:true,S:true,SAMP:true,SELECT:true,SMALL:true,SPAN:true,STRIKE:true,STRONG:true,SUB:true,SUP:true,TEXTAREA:true,TT:true,U:true,VAR:true};RTE.HtmlTagName.inlineOrBlockElements=["APPLET","BUTTON","DEL","IFRAME","INS","MAP","OBJECT","SCRIPT"];RTE.HtmlTagName.$J5={APPLET:true,BUTTON:true,DEL:true,IFRAME:true,INS:true,MAP:true,OBJECT:true,SCRIPT:true};RTE.HtmlTagName.$HZ={CENTER:true,FONT:true,MENU:true,S:true,STRIKE:true,U:true};RTE.HtmlTagName.$FC={TABLE:true,TD:true,TH:true,TR:true};RTE.HtmlTagName.$Es={CAPTION:true,DIV:true,H1:true,H2:true,H3:true,H4:true,H5:true,H6:true,HR:true,IMG:true,INPUT:true,LEGEND:true,OBJECT:true,P:true,TABLE:true};RTE.HtmlTagName.$LQ={HR:true};RTE.HtmlTagName.$Lo={HR:true,PRE:true,TD:true,TH:true};RTE.HtmlTagName.$FE={IMG:true,OBJECT:true};RTE.HtmlTagName.$Ir={TD:true,TH:true};RTE.HtmlTagName.$Jq={TD:true,TH:true};RTE.HtmlTagName.$F4={LI:true};RTE.HtmlTagName.$Cw=["OL","UL"];RTE.HtmlTagName.$6D=["OL","UL","DIR","MENU"];RTE.ApplyOnSelectionProcessor.$22=new RTE.ApplyOnSelectionProcessor;RTE.ApplyOnSelectionProcessor.$Bf={color:"color",fontFamily:"face",fontSize:"size"};RTE.RTFieldFlags.$Dt=2;RTE.Canvas.editableItemClass="ms-rtestate-write";RTE.Canvas.atomicItemClass="ms-rtestate-read";RTE.Canvas.regionItemClass="ms-rtestate-field";RTE.Canvas.removeOnPasteClass="ms-rtepaste-remove";RTE.Canvas.notifyOnAddedClass="ms-rtestate-notify";RTE.Canvas.notifyOnGenerateClass="ms-rtegenerate-notify";RTE.Canvas.objectGenerateClass="ms-rtegenerate-object";RTE.Canvas.skipOnGenerateClass="ms-rtegenerate-skip";RTE.Canvas.skipAllOnGenerateClass="ms-rtegenerate-allskip";RTE.Canvas.inputBoxClass="ms-inputBox";RTE.Canvas.inputBoxActiveClass="ms-inputBoxActive";RTE.Canvas.webPartBoxClass="ms-rte-wpbox";RTE.Canvas.restrictionInlineStyle="UseInlineStyle";RTE.Canvas.allowWebParts="AllowWebParts";RTE.Canvas.$EZ=300;RTE.Canvas.$33=[];RTE.Canvas.$8g=false;RTE.Canvas.$8j=false;RTE.Canvas.$3N=null;RTE.Canvas.$3i=500;RTE.Canvas.$6W=false;RTE.Canvas.setTableWidths=true;RTE.Canvas.$3j=false;RTE.Canvas.$1N=null;RTE.Canvas.$2n=null;RTE.Canvas.$1D=false;RTE.Canvas.$1h=null;RTE.Canvas.$8q=null;RTE.Canvas.$6g=false;RTE.Canvas.$5S=new Array(0);RTE.Canvas.$26=0;RTE.Canvas.$2P=null;RTE.Canvas.$9m=null;RTE.Canvas.$2u=null;RTE.Canvas.$68=false;RTE.Canvas.$3z=null;RTE.Canvas.$9K=null;RTE.Canvas.$9I=RTE.Canvas.onMouseMove;RTE.Canvas.$5N=false;RTE.Canvas.$55=null;RTE.Canvas.$El=new RegExp("\\W","g");RTE.Canvas.$5v=null;RTE.Canvas.$4E=null;RTE.Canvas.$7H=null;RTE.Canvas.$4H=null;RTE.Canvas.$5y=null;RTE.Canvas.$7z=null;RTE.CanvasEvents.imageEvent="Image";RTE.CanvasEvents.linkEvent="Link";RTE.CanvasEvents.tableEvent="Table";RTE.CanvasEvents.atomicEvent="Atomic";RTE.CanvasEvents.editableRegionEvent="EditableRegion";RTE.CanvasEvents.elementEvent="Element";RTE.CanvasEvents.transferEvent="Transfer";RTE.CanvasEvents.imageBlurEvent="ImageBlur";RTE.CanvasEvents.imageFocusEvent="ImageFocus";RTE.CanvasEvents.linkBlurEvent="LinkBlur";RTE.CanvasEvents.linkFocusEvent="LinkFocus";RTE.CanvasEvents.tableBlurEvent="TableBlur";RTE.CanvasEvents.tableFocusEvent="TableFocus";RTE.CanvasEvents.atomicBlurEvent="AtomicBlur";RTE.CanvasEvents.atomicFocusEvent="AtomicFocus";RTE.CanvasEvents.editableRegionBlurEvent="EditableRegionBlur";RTE.CanvasEvents.editableRegionFocusEvent="EditableRegionFocus";RTE.CanvasEvents.editableRegionSelectionEvent="EditableRegionSelection";RTE.CanvasEvents.editableRegionChangedEvent="EditableRegionChanged";RTE.CanvasEvents.elementAddedEvent="ElementAdded";RTE.CanvasEvents.elementGenerateTagEvent="ElementGenerateTag";RTE.CanvasEvents.$6f=new Sys.EventHandlerList;RTE.CanvasEvents.$2L={};RTE.CanvasEvents.$2D=null;RTE.CanvasEvents.$3m={};RTE.CanvasEvents.$4h=false;RTE.CanvasEvents.$7e=0;RTE.CanvasEvents.$EH=RTE.CanvasEvents.setImageSize;RTE.CanvasEvents.$7n=RTE.CanvasEvents.onAtomicResize;RTE.CanvasRange.$66=false;RTE.CanvasRange.$1f=null;RTE.CanvasRange.$9g=["TD","TH","TR","LI","BR"];RTE.CanvasRange.$7K=["TR","TBODY","TD","TH","LI"];RTE.ClientWebPartManager.$9e=false;RTE.RibbonCommandNames.clipboardGroup="ClipboardGroup";RTE.RibbonCommandNames.markupGroup="MarkupGroup";RTE.RibbonCommandNames.commandContextChanged="CommandContextChanged";RTE.RibbonCommandNames.editContextualGroup="EditingToolsContextualGroup";RTE.RibbonCommandNames.editTab="CPEditTab";RTE.RibbonCommandNames.editTabFullId="Ribbon.EditingTools.CPEditTab";RTE.RibbonCommandNames.editingGroup="EditingGroup";RTE.RibbonCommandNames.embedGroup="EmbedGroup";RTE.RibbonCommandNames.elementWithStyleOptions="ElementWithStyleOptions";RTE.RibbonCommandNames.existingDataGroup="ExistingDataGroup";RTE.RibbonCommandNames.fontGroup="FontGroup";RTE.RibbonCommandNames.getFontBackgroundColorMenuXml="GetFontBackgroundColorMenuXml";RTE.RibbonCommandNames.getFontColorMenuXml="GetFontColorMenuXml";RTE.RibbonCommandNames.getFontFamilyMenuXml="GetFontFamilyMenuXml";RTE.RibbonCommandNames.getFontSizeMenuXml="GetFontSizeMenuXml";RTE.RibbonCommandNames.getImageStyleMenuXml="GetImageStyleMenuXml";RTE.RibbonCommandNames.getPositionMenuXml="GetPositionMenuXml";RTE.RibbonCommandNames.getSelectElementMenuXml="GetSelectElementMenuXml";RTE.RibbonCommandNames.getTableStyleMenuXml="GetTableStyleMenuXml";RTE.RibbonCommandNames.getTextStyleMenuXml="GetTextStyleMenuXml";RTE.RibbonCommandNames.getLanguagesMenuXml="GetLanguagesMenuXml";RTE.RibbonCommandNames.getPasteMenuXml="GetPasteMenuXml";RTE.RibbonCommandNames.homeTab="HomeTab";RTE.RibbonCommandNames.imageAltLabel="ImageAltLabel";RTE.RibbonCommandNames.imageArrangeGroup="ImageArrangeGroup";RTE.RibbonCommandNames.imageArrange="ImageArrange";RTE.RibbonCommandNames.imageContextualGroup="ImageContextualGroup";RTE.RibbonCommandNames.imageEditGroup="ImageEditGroup";RTE.RibbonCommandNames.imageHorizontalLabel="ImageHorizontalLabel";RTE.RibbonCommandNames.imagePropertyGroup="ImagePropertyGroup";RTE.RibbonCommandNames.imageSizeGroup="ImageSizeGroup";RTE.RibbonCommandNames.imageStyleOptions="ImageStyleOptions";RTE.RibbonCommandNames.imageStyleGroup="ImageStyleGroup";RTE.RibbonCommandNames.imageTab="ImageTab";RTE.RibbonCommandNames.imageUrlLabel="ImageUrlLabel";RTE.RibbonCommandNames.imageVerticalLabel="ImageVerticalLabel";RTE.RibbonCommandNames.insertTab="InsertTab";RTE.RibbonCommandNames.insertImageMenuOpen="InsertImageMenuOpen";RTE.RibbonCommandNames.insertImageMenuClose="InsertImageMenuClose";RTE.RibbonCommandNames.insertLinkMenuOpen="InsertLinkMenuOpen";RTE.RibbonCommandNames.insertLinkMenuClose="InsertLinkMenuClose";RTE.RibbonCommandNames.insertDocumentMenuOpen="InsertDocumentMenuOpen";RTE.RibbonCommandNames.insertDocumentMenuClose="InsertDocumentMenuClose";RTE.RibbonCommandNames.insertDocumentOptions="InsertDocumentOptions";RTE.RibbonCommandNames.languageLabel="LanguageLabel";RTE.RibbonCommandNames.selectLabel="SelectLabel";RTE.RibbonCommandNames.htmlLabel="HtmlLabel";RTE.RibbonCommandNames.linkContextualGroup="LinkContextualGroup";RTE.RibbonCommandNames.linkGroup="LinkGroup";RTE.RibbonCommandNames.linkBehaviorGroup="LinkBehaviorGroup";RTE.RibbonCommandNames.linkAltLabel="LinkAltLabel";RTE.RibbonCommandNames.linkUrlLabel="LinkUrlLabel";RTE.RibbonCommandNames.linkPropertyGroup="LinkPropertyGroup";RTE.RibbonCommandNames.linkTab="LinkTab";RTE.RibbonCommandNames.linksGroup="LinksGroup";RTE.RibbonCommandNames.mediaGroup="MediaGroup";RTE.RibbonCommandNames.newListGroup="NewListGroup";RTE.RibbonCommandNames.pageLayoutOptions="PageLayoutOptions";RTE.RibbonCommandNames.pasteOption="PasteOption";RTE.RibbonCommandNames.pasteOpen="PasteOpen";RTE.RibbonCommandNames.pasteClose="PasteClose";RTE.RibbonCommandNames.paragraphGroup="ParagraphGroup";RTE.RibbonCommandNames.selectElement="SelectElement";RTE.RibbonCommandNames.selectTextStyle="SelectTextStyle";RTE.RibbonCommandNames.setLanguageOptions="SetLanguageOptions";RTE.RibbonCommandNames.textStyleGroup="TextStyleGroup";RTE.RibbonCommandNames.tableColumnWidthLabel="TableColumnWidthLabel";RTE.RibbonCommandNames.tableContextualGroup="TableContextualGroup";RTE.RibbonCommandNames.tableCellGroup="TableCellGroup";RTE.RibbonCommandNames.tableDeleteOptions="TableDeleteOptions";RTE.RibbonCommandNames.tableDesignTab="TableDesignTab";RTE.RibbonCommandNames.tableHeightLabel="TableHeightLabel";RTE.RibbonCommandNames.tableLayoutTab="TableLayoutTab";RTE.RibbonCommandNames.tableMiscGroup="TableMiscGroup";RTE.RibbonCommandNames.tableMergeOptions="TableMergeOptions";RTE.RibbonCommandNames.tableRowColumnGroup="TableRowColumnGroup";RTE.RibbonCommandNames.tableRowHeightLabel="TableRowHeightLabel";RTE.RibbonCommandNames.tableSplitOptions="TableSplitOptions";RTE.RibbonCommandNames.tableStyleGroup="TableStyleGroup";RTE.RibbonCommandNames.tableStyleOptions="TableStyleOptions";RTE.RibbonCommandNames.tableStyleOptionGroup="TableStyleOptionGroup";RTE.RibbonCommandNames.tableSummaryLabel="TableSummaryLabel";RTE.RibbonCommandNames.tableSummaryGroup="TableSummaryGroup";RTE.RibbonCommandNames.tableWidthHeightGroup="TableWidthHeightGroup";RTE.RibbonCommandNames.tableWidthLabel="TableWidthLabel";RTE.RibbonCommandNames.tablesGroup="TablesGroup";RTE.RibbonCommandNames.undoClose="UndoClose";RTE.RibbonCommandNames.undoOpen="UndoOpen";RTE.RibbonCommandNames.webPartsGroup="WebPartsGroup";RTE.RibbonCommandNames.wikiGroup="WikiGroup";RTE.RibbonCommandNames.selectTextStyleOpen="SelectTextStyleOpen";RTE.RibbonCommandNames.selectTextStyleClose="SelectTextStyleClose";RTE.RibbonCommandNames.elementWithStyleOptionsOpen="ElementWithStyleOptionsOpen";RTE.RibbonCommandNames.elementWithStyleOptionsClose="ElementWithStyleOptionsClose";RTE.RibbonCommandNames.selectElementOpen="SelectElementOpen";RTE.RibbonCommandNames.selectElementClose="SelectElementClose";RTE.RibbonCommandNames.tableStyleOptionsOpen="TableStyleOptionsOpen";RTE.RibbonCommandNames.tableStyleOptionsClose="TableStyleOptionsClose";RTE.RibbonCommandNames.imageStyleOptionsOpen="ImageStyleOptionsOpen";RTE.RibbonCommandNames.imageStyleOptionsClose="ImageStyleOptionsClose";RTE.RibbonCommandNames.imageArrangeMenuOpen="ImageArrangeMenuOpen";RTE.RibbonCommandNames.imageArrangeMenuClose="ImageArrangeMenuClose";RTE.RibbonCommandNames.fontFamilyStyleOpen="FontFamilyStyleOpen";RTE.RibbonCommandNames.fontFamilyStyleClose="FontFamilyStyleClose";RTE.RibbonCommandNames.fontSizeStyleOpen="FontSizeStyleOpen";RTE.RibbonCommandNames.fontSizeStyleClose="FontSizeStyleClose";RTE.RibbonCommandNames.selectBackgroundColorOpen="SelectBackgroundColorOpen";RTE.RibbonCommandNames.selectBackgroundColorClose="SelectBackgroundColorClose";RTE.RibbonCommandNames.selectFontColorOpen="SelectFontColorOpen";RTE.RibbonCommandNames.selectFontColorClose="SelectFontColorClose";RTE.RibbonCommandNames.htmlMenuOpen="HtmlMenuOpen";RTE.CommandNames.alignLeft="AlignLeft";RTE.CommandNames.alignCenter="AlignCenter";RTE.CommandNames.alignRight="AlignRight";RTE.CommandNames.alignJustify="AlignJustify";RTE.CommandNames.backgroundColorCssClass="BackgroundColorCssClass";RTE.CommandNames.backgroundColorCssClassPreview="BackgroundColorCssClassPreview";RTE.CommandNames.backgroundColorCssClassPreviewRevert="BackgroundColorCssClassPreviewRevert";RTE.CommandNames.backgroundColorThemeClass="BackgroundColorThemeClass";RTE.CommandNames.backgroundColorThemeClassPreview="BackgroundColorThemeClassPreview";RTE.CommandNames.backgroundColorThemeClassPreviewRevert="BackgroundColorThemeClassPreviewRevert";RTE.CommandNames.backgroundColorCustom="BackgroundColorCustom";RTE.CommandNames.bold="Bold";RTE.CommandNames.bulletedList="BulletedList";RTE.CommandNames.clearFormatting="ClearFormatting";RTE.CommandNames.copy="Copy";RTE.CommandNames.copyPageAddress="CopyPageAddress";RTE.CommandNames.colorCssClass="ColorCssClass";RTE.CommandNames.colorCssClassPreview="ColorCssClassPreview";RTE.CommandNames.colorCssClassPreviewRevert="ColorCssClassPreviewRevert";RTE.CommandNames.colorThemeClass="ColorThemeClass";RTE.CommandNames.colorThemeClassPreview="ColorThemeClassPreview";RTE.CommandNames.colorThemeClassPreviewRevert="ColorThemeClassPreviewRevert";RTE.CommandNames.colorCustom="ColorCustom";RTE.CommandNames.cut="Cut";RTE.CommandNames.decreaseIndent="DecreaseIndent";RTE.CommandNames.deleteCell="DeleteCell";RTE.CommandNames.deleteRow="DeleteRow";RTE.CommandNames.deleteColumn="DeleteColumn";RTE.CommandNames.deleteTable="DeleteTable";RTE.CommandNames.editImage="EditImage";RTE.CommandNames.editImageUpload="EditImageUpload";RTE.CommandNames.editImageWeb="EditImageWeb";RTE.CommandNames.editSource="EditSource";RTE.CommandNames.elementWithStyle="ElementWithStyle";RTE.CommandNames.elementWithStylePreview="ElementWithStylePreview";RTE.CommandNames.elementWithStylePreviewRevert="ElementWithStylePreviewRevert";RTE.CommandNames.applyLiveGalleryStyle="ApplyLiveGalleryStyle";RTE.CommandNames.applyLiveGalleryStylePreview="ApplyLiveGalleryStylePreview";RTE.CommandNames.applyLiveGalleryStylePreviewRevert="ApplyLiveGalleryStylePreviewRevert";RTE.CommandNames.fontFamilyCssClass="FontFamilyCssClass";RTE.CommandNames.fontFamilyCssClassPreview="FontFamilyCssClassPreview";RTE.CommandNames.fontFamilyCssClassPreviewRevert="FontFamilyCssClassPreviewRevert";RTE.CommandNames.fontFamilyThemeClass="FontFamilyThemeClass";RTE.CommandNames.fontFamilyThemeClassPreview="FontFamilyThemeClassPreview";RTE.CommandNames.fontFamilyThemeClassPreviewRevert="FontFamilyThemeClassPreviewRevert";RTE.CommandNames.fontFamilyStyleValue="FontFamilyStyleValue";RTE.CommandNames.fontSizeCssClass="FontSizeCssClass";RTE.CommandNames.fontSizeCssClassPreview="FontSizeCssClassPreview";RTE.CommandNames.fontSizeCssClassPreviewRevert="FontSizeCssClassPreviewRevert";RTE.CommandNames.fontSizeStyleValue="FontSizeStyleValue";RTE.CommandNames.leftToRight="LeftToRight";RTE.CommandNames.increaseIndent="IncreaseIndent";RTE.CommandNames.linkBookmark="LinkBookmark";RTE.CommandNames.linkDisplayIcon="LinkDisplayIcon";RTE.CommandNames.linkEditWeb="LinkEditWeb";RTE.CommandNames.linkInNewTab="LinkInNewTab";RTE.CommandNames.linkTitleChanged="LinkTitleChanged";RTE.CommandNames.linkUrlChanged="LinkUrlChanged";RTE.CommandNames.linkRemove="LinkRemove";RTE.CommandNames.imageAlt="ImageAlt";RTE.CommandNames.imageClearStyle="ImageClearStyle";RTE.CommandNames.imageEdit="ImageEdit";RTE.CommandNames.imagePosition="ImagePosition";RTE.CommandNames.imagePositionPreview="ImagePositionPreview";RTE.CommandNames.imagePositionPreviewRevert="ImagePositionPreviewRevert";RTE.CommandNames.imageHeight="ImageHeight";RTE.CommandNames.imageLockRatio="ImageLockRatio";RTE.CommandNames.imageSrc="ImageSrc";RTE.CommandNames.imageStyle="ImageStyle";RTE.CommandNames.imageStylePreview="ImageStylePreview";RTE.CommandNames.imageStylePreviewRevert="ImageStylePreviewRevert";RTE.CommandNames.imageWidth="ImageWidth";RTE.CommandNames.insertEmbedding="InsertEmbedding";RTE.CommandNames.insertLink="InsertLink";RTE.CommandNames.insertLinkWeb="InsertLinkWeb";RTE.CommandNames.insertImage="InsertImage";RTE.CommandNames.insertImageUpload="InsertImageUpload";RTE.CommandNames.insertImageWeb="InsertImageWeb";RTE.CommandNames.insertTable="InsertTable";RTE.CommandNames.insertTableMenu="InsertTableMenu";RTE.CommandNames.insertTableDialog="InsertTableDialog";RTE.CommandNames.insertTablePreview="InsertTablePreview";RTE.CommandNames.insertTablePreviewRevert="InsertTablePreviewRevert";RTE.CommandNames.insertRowAbove="InsertRowAbove";RTE.CommandNames.insertRowBelow="InsertRowBelow";RTE.CommandNames.insertColumnLeft="InsertColumnLeft";RTE.CommandNames.insertColumnRight="InsertColumnRight";RTE.CommandNames.insertList="InsertList";RTE.CommandNames.insertNewList="InsertNewList";RTE.CommandNames.insertWebPart="InsertWebPart";RTE.CommandNames.italic="Italics";RTE.CommandNames.layoutOneColumn="LayoutOneColumn";RTE.CommandNames.layoutOneColumnSidebar="LayoutOneColumnSidebar";RTE.CommandNames.layoutTwoColumn="LayoutTwoColumn";RTE.CommandNames.layoutTwoColumnHeader="LayoutTwoColumnHeader";RTE.CommandNames.layoutTwoColumnHeaderFooter="LayoutTwoColumnHeaderFooter";RTE.CommandNames.layoutThreeColumn="LayoutThreeColumn";RTE.CommandNames.layoutThreeColumnHeader="LayoutThreeColumnHeader";RTE.CommandNames.layoutThreeColumnHeaderFooter="LayoutThreeColumnHeaderFooter";RTE.CommandNames.makeXhtml="MakeXhtml";RTE.CommandNames.mergeCellAbove="MergeCellAbove";RTE.CommandNames.mergeCellBelow="MergeCellBelow";RTE.CommandNames.mergeCellLeft="MergeCellLeft";RTE.CommandNames.mergeCellRight="MergeCellRight";RTE.CommandNames.mergeCells="MergeCells";RTE.CommandNames.numberedList="NumberedList";RTE.CommandNames.paste="Paste";RTE.CommandNames.pasteDefault="PasteDefault";RTE.CommandNames.queryAlignCenter="QueryAlignCenter";RTE.CommandNames.queryAlignJustify="QueryAlignJustify";RTE.CommandNames.queryAlignLeft="QueryAlignLeft";RTE.CommandNames.queryAlignRight="QueryAlignRight";RTE.CommandNames.queryBold="QueryBold";RTE.CommandNames.queryBulletedList="QueryBulletedList";RTE.CommandNames.queryElementWithStyle="QueryElementWithStyle";RTE.CommandNames.queryLiveGalleryStyle="QueryLiveGalleryStyle";RTE.CommandNames.queryFontFamily="QueryFontFamily";RTE.CommandNames.queryFontSize="QueryFontSize";RTE.CommandNames.queryLanguage="QueryLanguage";RTE.CommandNames.queryLinkDisplayIcon="QueryLinkDisplayIcon";RTE.CommandNames.queryLinkBookmark="QueryLinkBookmark";RTE.CommandNames.queryLinkInNewTab="QueryLinkInNewTab";RTE.CommandNames.queryLinkTitle="QueryLinkTitle";RTE.CommandNames.queryLinkUrl="QueryLinkUrl";RTE.CommandNames.queryItalic="QueryItalics";RTE.CommandNames.queryImageAlt="QueryImageAlt";RTE.CommandNames.queryImageHeight="QueryImageHeight";RTE.CommandNames.queryImageLockRatio="QueryImageLockRatio";RTE.CommandNames.queryImageSrc="QueryImageSrc";RTE.CommandNames.queryImageStyle="QueryImageStyle";RTE.CommandNames.queryImageWidth="QueryImageWidth";RTE.CommandNames.queryLeftToRight="QueryLeftToRight";RTE.CommandNames.queryNumberedList="QueryNumberedList";RTE.CommandNames.queryRightToLeft="QueryRightToLeft";RTE.CommandNames.queryStrikeThrough="QueryStrikeThrough";RTE.CommandNames.querySubscript="QuerySubscript";RTE.CommandNames.querySuperscript="QuerySuperscript";RTE.CommandNames.queryTableColumnWidth="QueryTableColumnWidth";RTE.CommandNames.queryTableHeight="QueryTableHeight";RTE.CommandNames.queryTableRowHeight="QueryTableRowHeight";RTE.CommandNames.queryTableWidth="QueryTableWidth";RTE.CommandNames.queryTableHeadingRow="QueryTableHeadingRow";RTE.CommandNames.queryTableFirstColumn="QueryTableFirstColumn";RTE.CommandNames.queryTableFooterRow="QueryTableFooterRow";RTE.CommandNames.queryTableLastColumn="QueryTableLastColumn";RTE.CommandNames.queryTableViewGridlines="QueryTableViewGridlines";RTE.CommandNames.queryTableStyle="QueryTableStyle";RTE.CommandNames.queryTableSummary="QueryTableSummary";RTE.CommandNames.queryTextStyle="QueryTextStyle";RTE.CommandNames.queryUnderline="QueryUnderline";RTE.CommandNames.redo="Redo";RTE.CommandNames.removeStyles="RemoveStyles";RTE.CommandNames.rightToLeft="RightToLeft";RTE.CommandNames.selectAll="SelectAll";RTE.CommandNames.selectMenuItem="SelectMenuItem";RTE.CommandNames.selectMenuItemPreview="SelectMenuItemPreview";RTE.CommandNames.selectMenuItemPreviewRevert="SelectMenuItemPreviewRevert";RTE.CommandNames.selectBackgroundColor="SelectBackgroundColor";RTE.CommandNames.selectFontColor="SelectFontColor";RTE.CommandNames.selectFontFamily="SelectFont";RTE.CommandNames.selectFontSize="SelectFontSize";RTE.CommandNames.serverButton="ServerButton";RTE.CommandNames.serverQueryButton="ServerQueryButton";RTE.CommandNames.setLanguage="SetLanguage";RTE.CommandNames.setTableWidth="SetTableWidth";RTE.CommandNames.setTableHeight="SetTableHeight";RTE.CommandNames.setTableRowHeight="SetTableRowHeight";RTE.CommandNames.setTableColumnWidth="SetTableColumnWidth";RTE.CommandNames.splitHorizontal="SplitHorizontal";RTE.CommandNames.splitVertical="SplitVertical";RTE.CommandNames.strikeThrough="StrikeThrough";RTE.CommandNames.subscript="Subscript";RTE.CommandNames.superscript="Superscript";RTE.CommandNames.tableViewGridlines="TableViewGridlines";RTE.CommandNames.tableHeadingRow="TableHeadingRow";RTE.CommandNames.tableFooterRow="TableFooterRow";RTE.CommandNames.tableFirstColumn="TableFirstColumn";RTE.CommandNames.tableLastColumn="TableLastColumn";RTE.CommandNames.tableClearFormatting="TableClearFormatting";RTE.CommandNames.tableStyle="TableStyle";RTE.CommandNames.tableStylePreview="TableStylePreview";RTE.CommandNames.tableStylePreviewRevert="TableStylePreviewRevert";RTE.CommandNames.tableSummary="TableSummary";RTE.CommandNames.textStyle="TextStyle";RTE.CommandNames.textStylePreview="TextStylePreview";RTE.CommandNames.textStylePreviewRevert="TextStylePreviewRevert";RTE.CommandNames.underline="Underline";RTE.CommandNames.undo="Undo";RTE.CommandNames.uploadDocumentRTE="UploadDocumentRTE";RTE.Cursor.$7f=false;RTE.Cursor.$5n=null;RTE.Cursor.$6Z=false;RTE.Cursor.$6a=false;RTE.Cursor.$23=true;RTE.Cursor.s_range=new RTE.CanvasRange("cursor");RTE.Cursor.$7I=false;RTE.Cursor.$3s=false;RTE.Cursor.$4L=true;RTE.Cursor.$14=false;RTE.Cursor.$48=null;RTE.Cursor.$69=null;RTE.Cursor.allowSafariDragAndDrop=false;RTE.Cursor.$4I=false;RTE.Cursor.$4X=false;RTE.Cursor.$3X=null;RTE.Cursor.$X=null;RTE.Cursor.$49=false;RTE.Cursor.$3P=false;RTE.Cursor.$1V=0;RTE.Cursor.ignoreBeforePasteOrDrop=false;RTE.Cursor.$K=null;RTE.Cursor.$70=null;RTE.Cursor.$8l=RTE.Cursor.$K6;RTE.Cursor.$4v=false;RTE.Cursor.$67=0;RTE.Cursor.$L=new RTE.CanvasRange("paste");RTE.Cursor.$37=false;RTE.Cursor.$51=false;RTE.Cursor.$4P=0;RTE.Cursor.$4O=true;RTE.Cursor.$Ed=RTE.Cursor.$Le;RTE.DirtyBitManager.$5U=false;RTE.DirtyBitManager.$4F=false;RTE.EmbeddingCommands.$9j={};RTE.FontCommands.$91=true;RTE.FontCommands.$DQ=["UL","OL","MENU","DIR","TR","TBODY","TABLE"];RTE.FontCommands.$8v="pt";RTE.FontCommands.$8u=null;RTE.HtmlFormat.$BD=new RegExp("<span[^>]*id=(\"|'|)ms-rterangecursor-start(\"|'|)","i");RTE.HtmlFormat.$BB=new RegExp("<span[^>]*id=(\"|'|)ms-rterangecursor-end(\"|'|)","i");RTE.HtmlFormat.$9S=new RegExp("\\n|\\r","g");RTE.HtmlFormat.$Ek=new RegExp("style\\s*=\\s*(\"|')[^(\"|')]*white-space:\\s*pre","i");RTE.HtmlFormat.$2q=null;RTE.HtmlFormat.$39=null;RTE.ShortcutKeys.$u=null;RTE.MovementKeys.$1B=null;RTE.SelectionClearingKeys.$11=null;RTE.LayoutsEditor.$2l=null;RTE.DialogUtility.$2m=null;RTE.InsertHtmlDialog.uploadImageDialogName="UploadImage";RTE.InsertHtmlDialog.uploadDocumentDialogName="UploadDocument";RTE.PasteFlyout.$W=null;RTE.RtePasteManager.$32=null;RTE.RtePasteManager.$2C=null;RTE.RtePasteManager.$3h=null;RTE.PasteMode.pasteAsIsId="PasteAsIs";RTE.PasteMode.pasteCleanId="PasteClean";RTE.PasteMode.pastePlainId="PastePlain";RTE.CleanPasteMode.passThroughClasses=new Array(0);RTE.CleanPasteMode.$$cctor();RTE.PlainTextPasteMode.$AG=new RegExp("\x0d","gi");RTE.PlainTextPasteMode.$AI=new RegExp("\x0a","gi");RTE.PlainTextPasteMode.$AH=new RegExp("\x0a *\x0a","gi");RTE.PlainTextPasteMode.$AJ=new RegExp("  +","gi");RTE.PreviewManager.$W=null;RTE.Range.$9h=["StartToEnd","StartToStart","EndToStart","EndToEnd"];RTE.RemoveStyleOnSelectionProcessor.keepStyleOnNode="ms-rteKeepStyles";RTE.RemoveStyleOnSelectionProcessor.$22=new RTE.RemoveStyleOnSelectionProcessor;RTE.RibbonIds.bold="Ribbon.EditingTools.CPEditTab.Font.Bold";RTE.RibbonIds.editContextualGroup="Ribbon.EditingTools";RTE.RibbonIds.editSource="Ribbon.EditingTools.CPEditTab.Html.EditSource";RTE.RibbonIds.elementWithStyle="ElementWithStyle";RTE.RibbonIds.elementWithStyleMenu="Ribbon.EditingTools.CPEditTab.Paragraph.ElementWithStyle.Menu";RTE.RibbonIds.elementWithStyleMenuSection="Ribbon.EditingTools.CPEditTab.Paragraph.ElementWithStyle.Menu.Styles";RTE.RibbonIds.fontFaceMenu="Ribbon.EditingTools.CPEditTab.Font.FontFace.Menu";RTE.RibbonIds.fontSizeMenu="Ribbon.EditingTools.CPEditTab.Font.FontSize.Menu";RTE.RibbonIds.fontColorMenu="Ribbon.EditingTools.CPEditTab.Font.FontColor.Menu";RTE.RibbonIds.fontBackgroundColorMenu="Ribbon.EditingTools.CPEditTab.Font.FontBackgroundColor.Menu";RTE.RibbonIds.fontGroup="Font";RTE.RibbonIds.homeTab="Ribbon.tabhome";RTE.RibbonIds.languagesMenuItem="Ribbon.EditingTools.CPEditTab.Html.Languages.Menu.Languages";RTE.RibbonIds.languagesMenu="Ribbon.EditingTools.CPEditTab.Html.Languages.Menu";RTE.RibbonIds.languagesMenuSection="Ribbon.EditingTools.CPEditTab.Html.Languages.Menu.Languages";RTE.RibbonIds.pasteMenu="Ribbon.EditingTools.CPEditTab.Clipboard.Paste.Menu";RTE.RibbonIds.pasteMenuSection="Ribbon.EditingTools.CPEditTab.Clipboard.Paste.Menu.PasteModes";RTE.RibbonIds.linkContextualGroup="Ribbon.Link";RTE.RibbonIds.imageStyle="ImageStyle";RTE.RibbonIds.imageStyleMenu="Ribbon.Image.Image.Styles.ImageStyles.Menu";RTE.RibbonIds.imageStyleMenuSection="Ribbon.Image.Image.Styles.ImageStyles.Menu.Styles";RTE.RibbonIds.imageRemoveStyle="ImageRemoveStyle";RTE.RibbonIds.imagePosition="ImagePosition";RTE.RibbonIds.imagePositionMenu="Ribbon.Image.Position.Menu";RTE.RibbonIds.imagePositionMenuInlineSection="Ribbon.Image.Position.Menu.Inline";RTE.RibbonIds.imagePositionMenuFloatSection="Ribbon.Image.Position.Menu.Float";RTE.RibbonIds.imageWidth="fsspImageWidth";RTE.RibbonIds.imageWidthLabel="ImageWidthLabel";RTE.RibbonIds.imageContextualGroup="Ribbon.Image";RTE.RibbonIds.imageGroup="Ribbon.Image.Image.Properties";RTE.RibbonIds.imageTab="Ribbon.Image.Image";RTE.RibbonIds.italic="Ribbon.EditingTools.CPEditTab.Font.Italics";RTE.RibbonIds.paragraphGroup="Ribbon.EditingTools.CPEditTab.Paragraph";RTE.RibbonIds.selectMenu="Ribbon.EditingTools.CPEditTab.Html.Select.Menu";RTE.RibbonIds.selectMenuSection="Ribbon.EditingTools.CPEditTab.Html.Select.Menu.Elements";RTE.RibbonIds.selectMenuItem="SelectMenuItem";RTE.RibbonIds.tableStyleMenu="Ribbon.Table.Design.Style.TableStyles.Menu";RTE.RibbonIds.tableStyleMenuSection="Ribbon.Table.Design.Styles.TableStyles.Menu.TableStyles";RTE.RibbonIds.tableStyle="TableStyle";RTE.RibbonIds.tablesGroup="grpTables";RTE.RibbonIds.tableHeadingRow="Ribbon.Table.Design.StyleOptions.TableHead";RTE.RibbonIds.tableFooterRow="Ribbon.Table.Design.StyleOptions.TableLastRow";RTE.RibbonIds.tableFirstColumn="Ribbon.Table.Design.StyleOptions.TableFirstCol";RTE.RibbonIds.tableLastColumn="Ribbon.Table.Design.StyleOptions.TableLastCol";RTE.RibbonIds.tableLayoutContextualGroup="tabTableLayout";RTE.RibbonIds.tableRemoveStyle="TableRemoveStyle";RTE.RibbonIds.textStyle="Ribbon.EditingTools.CPEditTab.Styles.Styles.Menu.Styles.TextStyle";RTE.RibbonIds.textStyleMenu="ms-rte-styleGalleryMenu";RTE.RibbonIds.textStyleMenuSection="Ribbon.EditingTools.CPEditTab.Styles.Styles.Menu.Styles";RTE.RibbonIds.tableContextualGroup="Ribbon.Table";RTE.RibbonIds.tableDesignTab="Ribbon.Table.Design";RTE.RibbonIds.underline="Ribbon.EditingTools.CPEditTab.Font.Underline";RTE.RichTextEditor.$6c="Language";RTE.RichTextEditor.$A4=["px","%"];RTE.RichTextEditor.$5Q="Position";RTE.RichTextEditor.$38="Image";RTE.RichTextEditor.$Ll=["px","%"];RTE.RichTextEditorComponent.$W=null;RTE.RichTextEditorComponentProvider.$2N=null;RTE.RichTextEditorComponentProvider.$4G=null;RTE.RteHtmlPasteSteward.$18={};RTE.RteHtmlTranslator.$AP=new RegExp("^0(px|em|in|pt)$","i");RTE.RteRibbonBuilder.numStyleRibbonButtons=5;RTE.RteUtility.$CJ=20;RTE.RteUtility.$CK=20;RTE.RteUtility.$8k=RTE.RteUtility.$LC;RTE.RteUtility.$4q="ForceImageSizeInit";RTE.RteUtility.$7v=String.fromCharCode(160)+String.fromCharCode(160);RTE.RteUtility.$3U=String.fromCharCode(160);RTE.RteUtility.$2O="\u200b";RTE.RteUtility.$8t=null;RTE.RteUtility.$8r=null;RTE.RteUtility.$8s=null;RTE.RteUtility.$7a=true;RTE.RteUtility.$6O={};RTE.RteUtility.$6P=0;RTE.RteUtility.$84=RTE.RteUtility.$Fp;RTE.RteUtility.$A7={IMG:"true",BR:"true",INPUT:"true",META:"true",LINK:"true",PARAM:"true",AREA:"true",HR:"true"};RTE.RteUtility.$Hx=RTE.RteUtility.$Hw;RTE.RteUtility.$7S=document.createElement("DIV");RTE.RteUtility.$7T={};RTE.RteUtility.$5d=0;RTE.RteUtility.$ER=new RegExp('<span((id|rtenodeid)="[^"]*"|style="display:[ ]*none;[ ]*"|\\s*)*>');RTE.RteUtility.$BO=new RegExp('<font(rtenodeid="[^"]*"|\\s*)*>');RTE.RteUtility.$EQ=new RegExp('<div((id|rtenodeid)="[^"]*"|style="display:[ ]*none;[ ]*"|\\s*)*>');RTE.RteUtility.$5T={};RTE.RteUtility.$9d=false;RTE.RteUtility.$BP=new RegExp("(<span/>)","ig");RTE.RteUtility.$BC=new RegExp('(<span(([^<]*) id=("|)ms-rterange([^-]*)-(end|start)("|)([^<]*)|)></span>|<span/>)',"ig");RTE.RteUtility.$9b=new RegExp("\\s*RteNodeId\\s*=\\s*(\"|'|)[\\d]*(\"|'|)","ig");RTE.RteUtility.$Dr=new RegExp('(<span(([^<]*) id=("|)ms-rterange(?!cursor)([^-]*)-(end|start)("|)([^<]*)|)></span>|<span/>)',"ig");RTE.RteUtility.$7X=null;RTE.RteUtility.$Eh=["px","pt","%","em","in","mm","cm","ex","pc",""];RTE.RteUtility.$EO=RTE.RteUtility.$LP;RTE.RteUtility.$7Q=null;RTE.RteUtility.$7R=null;RTE.RteUtility.$EU=new RegExp("^[ \\n\\r\\t\\v\\f]*$","i");RTE.RteUtility.$ET=new RegExp("^[ \\n\\r\\t\\v\\f\\u00A0\\u200B]*$","i");RTE.RteUtility.$9E=1;RTE.SafeHtml.$9f=null;RTE.SafeHtml.$3V=null;RTE.SafeHtml.$4k=["ms-rtestate-field"];RTE.SelectionManager.$2o=null;RTE.SelectionManager.$7O=true;RTE.SelectionManager.$5V=[];RTE.SelectionManager.$6w=[];RTE.SnapshotManager.$54=null;RTE.SnapshotManager.$1U=new RTE.CircularArray(200);RTE.SnapshotManager.$3Q=new RTE.CircularArray(200);RTE.SnapshotManager.$DL=1;RTE.SnapshotManager.$78=false;RTE.SnapshotManager.$4j=RTE.SnapshotManager.$Ju;RTE.SnapshotManager.$3W=false;RTE.SnapshotManager.$79=false;RTE.SnapshotManager.$8G=RTE.SnapshotManager.$Jv;RTE.StyleRuleUtility.$5G=null;RTE.StyleRuleUtility.$5H=null;RTE.StyleRuleUtility.checkOnlyCssFromSameDomain=true;RTE.StyleRuleUtility.$77=-1;RTE.StyleRuleUtility.$2Q={};RTE.StyleRuleUtility.$5e={};RTE.StyleRuleUtility.$5f=0;RTE.TableCommands.$5k=["in","cm","px","%"];RTE.TableCommands.$7V="ms-rteTableGrid";RTE.XhtmlProcessor.$3T=null;RTE.XhtmlProcessor.$2M=null;RTE.XhtmlRules.$A=null;RTE.XhtmlRules.$9R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];RTE.RibbonReferences.$9L=RTE.RibbonReferences.$3S("/_layouts/15/$Resources:core,Language;/images/formatmap16x16.png?rev=23");RTE.RibbonReferences.$Dd=RTE.RibbonReferences.$3S("/_layouts/15/$Resources:core,Language;/images/formatmap16x16.png?rev=23");RTE.RibbonReferences.$Df=RTE.RibbonReferences.$3S("/_layouts/15/$Resources:core,Language;/images/formatmap16x16.png?rev=23");RTE.RibbonReferences.$De=RTE.RibbonReferences.$3S("/_layouts/15/$Resources:core,Language;/images/formatmap16x16.png?rev=23");RTE.RibbonReferences.$Dh=RTE.RibbonReferences.$3S("/_layouts/15/$Resources:core,Language;/images/formatmap16x16.png?rev=23");RTE.RibbonReferences.$Dg=RTE.RibbonReferences.$3S("/_layouts/15/$Resources:core,Language;/images/formatmap16x16.png?rev=23");RTE.RibbonReferences.$BK=RTE.RibbonReferences.$3S("/_layouts/15/$Resources:core,Language;/images/formatmap16x16.png?rev=23");RTE.PasteCommon.LogLevel.$7d=0;RTE.PasteCommon.LogLevel.$3r=1;RTE.PasteCommon.LogLevel.$Ej=2;RTE.PasteCommon.LogLevel.$Hg=3;RTE.PasteCommon.CustomData.dict={};RTE.HtmlImport.DefaultHtmlNormalizer.$CH=new RegExp("[ \x09\x0c\u200b\x0d\x0a]+","g");RTE.HtmlImport.DefaultHtmlTranslator.$8f={aliceblue:"F0F8FF",antiquewhite:"FAEBD7",aqua:"00FFFF",aquamarine:"7FFFD4",azure:"F0FFFF",beige:"F5F5DC",bisque:"FFE4C4",black:"000000",blanchedalmond:"FFEBCD",blue:"0000FF",blueviolet:"8A2BE2",brown:"A52A2A",burlywood:"DEB887",cadetblue:"5F9EA0",chartreuse:"7FFF00",chocolate:"D2691E",coral:"FF7F50",cornflowerblue:"6495ED",cornsilk:"FFF8DC",crimson:"DC143C",cyan:"00FFFF",darkblue:"00008B",darkcyan:"008B8B",darkgoldenrod:"B8860B",darkgray:"A9A9A9",darkgrey:"A9A9A9",darkgreen:"006400",darkkhaki:"BDB76B",darkmagenta:"8B008B",darkolivegreen:"556B2F",darkorange:"FF8C00",darkorchid:"9932CC",darkred:"8B0000",darksalmon:"E9967A",darkseagreen:"8FBC8F",darkslateblue:"483D8B",darkslategray:"2F4F4F",darkslategrey:"2F4F4F",darkturquoise:"00CED1",darkviolet:"9400D3",deeppink:"FF1493",deepskyblue:"00BFFF",dimgray:"696969",dimgrey:"696969",dodgerblue:"1E90FF",firebrick:"B22222",floralwhite:"FFFAF0",forestgreen:"228B22",fuchsia:"FF00FF",gainsboro:"DCDCDC",ghostwhite:"F8F8FF",gold:"FFD700",goldenrod:"DAA520",gray:"808080",grey:"808080",green:"008000",greenyellow:"ADFF2F",honeydew:"F0FFF0",hotpink:"FF69B4",indianred:"CD5C5C",indigo:"4B0082",ivory:"FFFFF0",khaki:"F0E68C",lavender:"E6E6FA",lavenderblush:"FFF0F5",lawngreen:"7CFC00",lemonchiffon:"FFFACD",lightblue:"ADD8E6",lightcoral:"F08080",lightcyan:"E0FFFF",lightgoldenrodyellow:"FAFAD2",lightgray:"D3D3D3",lightgrey:"D3D3D3",lightgreen:"90EE90",lightpink:"FFB6C1",lightsalmon:"FFA07A",lightseagreen:"20B2AA",lightskyblue:"87CEFA",lightslategray:"778899",lightslategrey:"778899",lightsteelblue:"B0C4DE",lightyellow:"FFFFE0",lime:"00FF00",limegreen:"32CD32",linen:"FAF0E6",magenta:"FF00FF",maroon:"800000",mediumaquamarine:"66CDAA",mediumblue:"0000CD",mediumorchid:"BA55D3",mediumpurple:"9370D8",mediumseagreen:"3CB371",mediumslateblue:"7B68EE",mediumspringgreen:"00FA9A",mediumturquoise:"48D1CC",mediumvioletred:"C71585",midnightblue:"191970",mintcream:"F5FFFA",mistyrose:"FFE4E1",moccasin:"FFE4B5",navajowhite:"FFDEAD",navy:"000080",oldlace:"FDF5E6",olive:"808000",olivedrab:"6B8E23",orange:"FFA500",orangered:"FF4500",orchid:"DA70D6",palegoldenrod:"EEE8AA",palegreen:"98FB98",paleturquoise:"AFEEEE",palevioletred:"D87093",papayawhip:"FFEFD5",peachpuff:"FFDAB9",peru:"CD853F",pink:"FFC0CB",plum:"DDA0DD",powderblue:"B0E0E6",purple:"800080",red:"FF0000",rosybrown:"BC8F8F",royalblue:"4169E1",saddlebrown:"8B4513",salmon:"FA8072",sandybrown:"F4A460",seagreen:"2E8B57",seashell:"FFF5EE",sienna:"A0522D",silver:"C0C0C0",skyblue:"87CEEB",slateblue:"6A5ACD",slategray:"708090",slategrey:"708090",snow:"FFFAFA",springgreen:"00FF7F",steelblue:"4682B4",tan:"D2B48C",teal:"008080",thistle:"D8BFD8",tomato:"FF6347",turquoise:"40E0D0",violet:"EE82EE",wheat:"F5DEB3",white:"FFFFFF",whitesmoke:"F5F5F5",yellow:"FFFF00",yellowgreen:"9ACD32"};RTE.HtmlImport.WordConverter.$AE=new RegExp("[\x0a|\x0d]","gi")}sp_ui_rte_initialize();function SPAutoSaveIsPageDirty(){ULSNVe:;if(typeof _spRteScriptLoaded!="undefined"&&_spRteScriptLoaded)if(RTE.DirtyBitManager.isDirty())return true;return false}RTE.DomHelper=function(){};RTE.DomHelper.focus=function(a){ULSNVe:;if(a.contentWindow){var b=a.contentWindow;if(b.focus)try{b.focus()}catch(c){}}a.setActive&&a.setActive()};RTE.DomHelper.insertAdjacentHtml=function(a,c,e){ULSNVe:;if(a.insertAdjacentHTML)return a.insertAdjacentHTML(c,e);var d=a.ownerDocument.createRange();d.setStartBefore(a);var b=d.createContextualFragment(e);switch(c){case"afterEnd":if(a.nextSibling)a.parentNode.insertBefore(b,a.nextSibling);else a.parentNode.appendChild(b);break;case"beforeBegin":a.parentNode.insertBefore(b,a)}};RTE.DomHelper.insertAdjacentText=function(a,d,c){ULSNVe:;var b=document.createTextNode(c);switch(d){case"afterEnd":if(a.nextSibling&&SP.UI.UIUtility.isTextNode(a.nextSibling))a.nextSibling.nodeValue=c+a.nextSibling.nodeValue;else if(a.nextSibling)a.parentNode.insertBefore(b,a.nextSibling);else a.parentNode.appendChild(b);break;case"beforeBegin":if(a.previousSibling&&SP.UI.UIUtility.isTextNode(a.previousSibling))a.previousSibling.nodeValue+=c;else a.parentNode.insertBefore(b,a)}};RTE.DomHelper.insertAdjacentElement=function(a,c,b){ULSNVe:;if(a.insertAdjacentElement)return a.insertAdjacentElement(c,b);switch(c){case"afterEnd":if(a.nextSibling)a.parentNode.insertBefore(b,a.nextSibling);else a.parentNode.appendChild(b);break;case"beforeBegin":a.parentNode.insertBefore(b,a)}};RTE.DomHelper.getKeyCode=function(b){ULSNVe:;var a;if(b.rawEvent)a=b.rawEvent;else a=b;return a.charCode&&a.charCode!=0?a.charCode:a.keyCode?a.keyCode:void 0};RTE.DomHelper.preventDefault=function(b){ULSNVe:;var a;if(b.rawEvent)a=b.rawEvent;else a=b;a.returnValue=false;a.preventDefault&&a.preventDefault()};RTE.DomHelper.createRange=function(a){ULSNVe:;var b;if(a.createRange)b=a.createRange();else if(a.body.createTextRange)b=a.body.createTextRange();else{alert("Browser does not support CBX_GetRange");return}return b};RTE.DomHelper.createRangeFromSelection=function(a){ULSNVe:;if(a.createRange)try{return a.createRange()}catch(c){return null}return a.rangeCount>0?a.getRangeAt(0):null};RTE.DomHelper.duplicateRange=function(a){ULSNVe:;var b;if(a.duplicate)b=a.duplicate();if(a.cloneRange)b=a.cloneRange();return b};RTE.DomHelper.isRangeInRange=function(a,b){ULSNVe:;if(a.inRange)return a.inRange(b);var c=b.compareBoundaryPoints(Range.START_TO_START,a),d=b.compareBoundaryPoints(Range.END_TO_END,a);return c<=0&&d>=0};RTE.DomHelper.pasteHtmlIntoRange=function(a,b){ULSNVe:;if(a.pasteHTML){try{a.pasteHTML(b)}catch(d){a.text="";a.pasteHTML(b)}return}a.extractContents();var c=a.createContextualFragment(b);a.insertNode(c)};RTE.DomHelper.compareRangeEndPoints=function(a,c,b){ULSNVe:;if(a.compareEndPoints)return a.compareEndPoints(c,b);switch(c){case"StartToEnd":return-b.compareBoundaryPoints(Range.START_TO_END,a);break;case"StartToStart":return-b.compareBoundaryPoints(Range.START_TO_START,a);break;case"EndToStart":return-b.compareBoundaryPoints(Range.END_TO_START,a);break;case"EndToEnd":return-b.compareBoundaryPoints(Range.END_TO_END,a)}};RTE.DomHelper.setRangeEndPoint=function(b,c,a){ULSNVe:;if(b.setEndPoint)return b.setEndPoint(c,a);switch(c){case"StartToEnd":return b.setStart(a.endContainer,a.endOffset);break;case"StartToStart":return b.setStart(a.startContainer,a.startOffset);break;case"EndToStart":return b.setEnd(a.startContainer,a.startOffset);break;case"EndToEnd":return b.setEnd(a.endContainer,a.endOffset)}};RTE.DomHelper.isRangeVisible=function(a){ULSNVe:;var d=false,c=false,b=null;if(typeof a.text!=="undefined")b=a.text;else if(typeof a.toString!=="undefined")b=a.toString();d=b!=null&&b!="";if(a.htmlText!=undefined&&a.htmlText!=null&&a.htmlText.indexOf("<IMG")!=-1)c=true;return d||c};RTE.NativeSafeHtml=function(){};RTE.NativeSafeHtml.getSafeHtmlRules=function(){ULSNVe:;return["!--_accesskey","A","!--_class","A","!--_contextmenu","A","!--_dir","A","!--_hidden","A","!--_hidefocus","A","!--_id","A","!--_lang","A","!--_spellcheck","A","!--_style","A","!--_tabindex","A","!--_title","A","!--_unselectable","A","!--_atomicselection","A","!--_msallowcapture","A","!--_role","A","A","A","A_href","A","A_target","A","A_rel","A","A_media","A","A_hreflang","A","A_type","A","A_charset","A","A_name","A","A_coords","A","A_rev","A","A_shape","A","A_datasrc","A","ABBR","A","ABBR_cite","A","ACRONYM","A","ACRONYM_cite","A","ADDRESS","A","ADDRESS_clear","A","APPLET","DB","AREA","A","AREA_href","A","AREA_target","A","AREA_rel","A","AREA_media","A","AREA_hreflang","A","AREA_type","A","AREA_alt","A","AREA_coords","A","AREA_shape","A","ARTICLE","A","ASIDE","A","AUDIO","A","AUDIO_src","A","AUDIO_preload","A","AUDIO_autoplay","A","AUDIO_loop","A","AUDIO_controls","A","AUDIO_autobuffer","A","AUDIO_mediagroup","A","AUDIO_msaudiocategory","A","AUDIO_muted","A","B","A","B_cite","A","BASEFONT","A","BASEFONT_size","A","BASEFONT_face","A","BASEFONT_color","A","BDI","A","BDO","A","BDO_cite","A","BGSOUND","A","BGSOUND_src","A","BGSOUND_loop","A","BIG","A","BIG_cite","A","BLOCKQUOTE","A","BLOCKQUOTE_cite","A","BLOCKQUOTE_clear","A","BR","A","BR_clear","A","BUTTON","A","BUTTON_autofocus","A","BUTTON_disabled","A","BUTTON_form","A","BUTTON_formenctype","A","BUTTON_formmethod","A","BUTTON_formnovalidate","A","BUTTON_formtarget","A","BUTTON_name","A","BUTTON_type","A","BUTTON_value","A","BUTTON_datasrc","A","BUTTON_autofocus","A","CANVAS","A","CANVAS_width","A","CANVAS_height","A","CAPTION","A","CAPTION_align","A","CAPTION_valign","A","CENTER","A","CENTER_clear","A","CITE","A","CITE_cite","A","CODE","A","CODE_cite","A","COL","A","COL_span","A","COL_align","A","COL_valign","A","COL_width","A","COL_char","A","COL_charoff","A","COL_bgcolor","A","COL_ch","A","COL_choff","A","COLGROUP","A","COLGROUP_span","A","COLGROUP_align","A","COLGROUP_valign","A","COLGROUP_width","A","COLGROUP_char","A","COLGROUP_charoff","A","COLGROUP_bgcolor","A","COLGROUP_ch","A","COLGROUP_choff","A","COMMAND","A","COMMAND_type","A","COMMAND_label","A","COMMAND_icon","A","COMMAND_disabled","A","COMMAND_checked","A","COMMAND_radiogroup","A","COMMENT","DB","DATALIST","A","DD","A","DD_nowrap","A","DEL","A","DEL_cite","A","DEL_datetime","A","DETAILS","A","DETAILS_open","A","DFN","A","DIR","A","DIR_compact","A","DIV","A","DIV_datasrc","A","DIV_align","A","DIV_webpartid","A","DIV_nowrap","A","DL","A","DL_compact","A","DT","A","DT_nowrap","A","EM","A","EM_cite","A","EVENT","DB","FIELDSET","A","FIELDSET_disabled","A","FIELDSET_form","A","FIELDSET_name","A","FIELDSET_tabindex","A","FIGCAPTION","A","FIGURE","A","FONT","A","FONT_size","A","FONT_face","A","FONT_color","A","FOOTER","A","FRAMESET","DB","H1","A","H1_align","A","H1_clear","A","H2","A","H2_align","A","H2_clear","A","H3","A","H3_align","A","H3_clear","A","H4","A","H4_align","A","H4_clear","A","H5","A","H5_align","A","H5_clear","A","H6","A","H6_align","A","H6_clear","A","HEAD","DB","HEADER","A","HGROUP","A","HR","A","HR_width","A","HR_size","A","HR_align","A","HR_color","A","HR_noshade","A","I","A","I_cite","A","IMG","A","IMG_alt","A","IMG_src","A","IMG_usemap","A","IMG_width","A","IMG_height","A","IMG_datasrc","A","IMG_align","A","IMG_hspace","A","IMG_vspace","A","IMG_dynsrc","A","IMG_lowsrc","A","IMG_border","A","IMG_loop","A","IMG_controls","A","IMG_start","A","IMG_longdesc","A","IMG_name","A","IMG_mstagchanged","A","INPUT","A","INPUT_accept","A","INPUT_alt","A","INPUT_autocomplete","A","INPUT_autofocus","A","INPUT_checked","A","INPUT_dirname","A","INPUT_disabled","A","INPUT_form","A","INPUT_formenctype","A","INPUT_formmethod","A","INPUT_formnovalidate","A","INPUT_formtarget","A","INPUT_height","A","INPUT_max","A","INPUT_maxlength","A","INPUT_min","A","INPUT_multiple","A","INPUT_name","A","INPUT_pattern","A","INPUT_placeholder","A","INPUT_readonly","A","INPUT_required","A","INPUT_size","A","INPUT_src","A","INPUT_step","A","INPUT_type","A","INPUT_value","A","INPUT_width","A","INPUT_datasrc","A","INPUT_align","A","INPUT_accesskey","A","INPUT_tabindex","A","INPUT_usemap","A","INS","A","INS_cite","A","INS_datetime","A","KEYGEN","A","KEYGEN_autofocus","A","KEYGEN_challenge","A","KEYGEN_disabled","A","KEYGEN_form","A","KEYGEN_keytype","A","KEYGEN_name","A","LABEL","A","LABEL_form","A","LABEL_datasrc","A","LABEL_accesskey","A","LABEL_for","A","LEGEND","A","LEGEND_datasrc","A","LEGEND_align","A","LEGEND_accesskey","A","LI","A","LI_value","A","LI_type","A","LISTING","A","LISTING_align","A","LISTING_clear","A","MAP","A","MAP_name","A","MARK","A","MARQUEE","A","MARQUEE_datasrc","A","MARQUEE_behavior","A","MARQUEE_bgcolor","A","MARQUEE_direction","A","MARQUEE_height","A","MARQUEE_hspace","A","MARQUEE_loop","A","MARQUEE_scrollamount","A","MARQUEE_scrolldelay","A","MARQUEE_vspace","A","MARQUEE_width","A","MENU","A","MENU_type","A","MENU_label","A","MENU_compact","A","METER","A","METER_value","A","METER_min","A","METER_max","A","METER_low","A","METER_high","A","METER_optimum","A","METER_form","A","NAV","A","NEXTID","A","NOBR","A","NOBR_cite","A","NOFRAMES","A","OL","A","OL_reversed","A","OL_start","A","OL_type","A","OL_compact","A","OPTGROUP","A","OPTGROUP_disabled","A","OPTGROUP_label","A","OPTGROUP_datasrc","A","OPTION","A","OPTION_disabled","A","OPTION_label","A","OPTION_selected","A","OPTION_value","A","OPTION_datasrc","A","OUTPUT","A","OUTPUT_form","A","OUTPUT_name","A","P","A","P_align","A","P_clear","A","PLAINTEXT","A","PLAINTEXT_align","A","PLAINTEXT_clear","A","PRE","A","PRE_width","A","PRE_clear","A","PROGRESS","A","PROGRESS_value","A","PROGRESS_max","A","PROGRESS_form","A","Q","A","Q_cite","A","RP","A","RT","A","RT_cite","A","RUBY","A","RUBY_cite","A","S","A","S_cite","A","SAMP","A","SAMP_cite","A","SCRIPT","DB","SECTION","A","SELECT","A","SELECT_autofocus","A","SELECT_disabled","A","SELECT_form","A","SELECT_multiple","A","SELECT_name","A","SELECT_required","A","SELECT_size","A","SELECT_align","A","SELECT_datasrc","A","SELECT_tabindex","A","SELECT_value","A","SMALL","A","SMALL_cite","A","SOURCE","A","SOURCE_src","A","SOURCE_type","A","SOURCE_media","A","SPAN","A","SPAN_datasrc","A","SPAN_fragmentid","A","SPAN_xml:lang","A","STRIKE","A","STRIKE_cite","A","STRONG","A","STRONG_cite","A","STYLE","A","STYLE_media","A","STYLE_type","A","STYLE_scoped","A","STYLE_disabled","A","SUB","A","SUB_cite","A","SUMMARY","A","SUP","A","SUP_cite","A","TABLE","A","TABLE_border","A","TABLE_datasrc","A","TABLE_width","A","TABLE_align","A","TABLE_bordercolor","A","TABLE_bgcolor","A","TABLE_cellpadding","A","TABLE_cellspacing","A","TABLE_background","A","TABLE_bordercolordark","A","TABLE_bordercolorlight","A","TABLE_height","A","TABLE_rules","A","TABLE_cols","A","TABLE_summary","A","TBODY","A","TBODY_align","A","TBODY_char","A","TBODY_charoff","A","TBODY_valign","A","TD","A","TD_colspan","A","TD_rowspan","A","TD_headers","A","TD_align","A","TD_width","A","TD_height","A","TD_valign","A","TD_bgcolor","A","TD_background","A","TD_bordercolor","A","TD_bordercolordark","A","TD_bordercolorlight","A","TD_nowrap","A","TD_char","A","TD_charoff","A","TD_scope","A","TD_abbr","A","TEXTAREA","A","TEXTAREA_autofocus","A","TEXTAREA_cols","A","TEXTAREA_disabled","A","TEXTAREA_form","A","TEXTAREA_maxlength","A","TEXTAREA_name","A","TEXTAREA_placeholder","A","TEXTAREA_readonly","A","TEXTAREA_required","A","TEXTAREA_rows","A","TEXTAREA_wrap","A","TEXTAREA_datasrc","A","TEXTAREA_tabindex","A","TEXTAREA_form","A","TEXTAREA_dirname","A","TFOOT","A","TFOOT_align","A","TFOOT_char","A","TFOOT_charoff","A","TFOOT_valign","A","TH","A","TH_colspan","A","TH_rowspan","A","TH_headers","A","TH_scope","A","TH_align","A","TH_valign","A","TH_width","A","TH_height","A","TH_bgcolor","A","TH_background","A","TH_bordercolor","A","TH_bordercolordark","A","TH_bordercolorlight","A","TH_nowrap","A","TH_char","A","TH_charoff","A","TH_abbr","A","THEAD","A","THEAD_align","A","THEAD_char","A","THEAD_charoff","A","THEAD_valign","A","TIME","A","TIME_datetime","A","TIME_pubdate","A","TITLE","DB","TR","A","TR_align","A","TR_valign","A","TR_height","A","TR_bgcolor","A","TR_bordercolor","A","TR_bordercolordark","A","TR_bordercolorlight","A","TR_char","A","TR_charoff","A","TRACK","A","TRACK_default","A","TRACK_kind","A","TRACK_label","A","TRACK_srclang","A","TT","A","TT_cite","A","U","A","U_cite","A","UL","A","UL_compact","A","UL_type","A","VIDEO","A","VIDEO_src","A","VIDEO_poster","A","VIDEO_preload","A","VIDEO_autoplay","A","VIDEO_mediagroup","A","VIDEO_loop","A","VIDEO_muted","A","VIDEO_controls","A","VIDEO_width","A","VIDEO_height","A","VIDEO_audio","A","VIDEO_autobuffer","A","VIDEO_msaudiocategory","A","WBR","A","XML","DB","XMP","A","XMP_align","A","XMP_clear","A"]};RTE.NativeSafeHtml.cleanStyleText=function(m){ULSNVe:;for(var h="",k=m.split(";"),j=0;j<k.length;j++){var g=k[j].replace(/opacity=/,"_opacity");g=g.replace(/=/,":");g=g.replace(/_opacity/,"opacity=");var e=g.split(":"),b=null,a="";if(e.length>0){b=e[0];b=b.replace(/^[ \t]+/g,"");b=b.replace(/[ \t]+$/g,"");b=b.replace(/[ \t]+/g," ");b=b.toLowerCase()}var c=false;if(b.indexOf("position")==0)c=true;if(!c)switch(b){case"behavior":c=true}if(c)continue;for(var i=1;i<e.length;i++){a+=e[i];if(i+1<e.length)a+=":"}a=a.replace(/^[ \t]+/g,"");a=a.replace(/[ \t]+$/g,"");a=a.replace(/[ \t]+/g," ");a=a.toLowerCase();if(!c&&a!=""){var d=a.indexOf("(");while(d!=-1){c=true;var f=a.slice(0,d),l=f.lastIndexOf(" ");if(l>-1)f=f.slice(l+1,f.length);switch(f.toLowerCase()){case"rect":c=false;break;case"alpha":c=false;break;case"rgb":c=false}if(c)break;d=a.indexOf(")",d+1);if(d!=-1)d=a.indexOf("(",d+1)}}if(!c){h+=b;if(a!="")h+=":"+a;h+=";"}}return h};ExecuteAndRegisterBeginEndFunctions("sp.ui.rte.js",sp_ui_rte_initialize,null,function(){ULSNVe:;RTE.Imports=function(){};RTE.Imports.ExecuteOrDelayUntilScriptLoaded=ExecuteOrDelayUntilScriptLoaded;RTE.Imports.SelectRibbonTab=SelectRibbonTab;if(typeof _spBodyOnLoadCalled=="undefined"||_spBodyOnLoadCalled)window.setTimeout(RTE.Canvas.load,0);else _spBodyOnLoadFunctionNames.push("RTE.Canvas.load");RTE.Canvas.loadPageComponent();_spRteScriptLoaded=true});typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();NotifyScriptLoadedAndExecuteWaitingJobs("sp.ui.rte.js");