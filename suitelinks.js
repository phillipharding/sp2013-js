function $_global_suitelinks(){spoLite=new HelpNamespace("SPOLITE",0);spoMidsized=new HelpNamespace("SPOMIDSIZED",1);spoStandardE1E2=new HelpNamespace("SPOSTANDARDE1E2",2);spoStandard=new HelpNamespace("SPOSTANDARD",3);SPOHelpNamespaceMap=function(){a:;var a={};a.SHAREPOINTENTERPRISE=spoStandard;a.SHAREPOINTENTERPRISELRG=spoStandard;a.SHAREPOINTEXTRANET=spoStandard;a.SHAREPOINTPARTNER=spoStandard;a.SHAREPOINTPROJADDON=spoStandard;a.SHAREPOINTSTORAGE=spoStandard;a.SHAREPOINTWAC=spoStandard;a.SHAREPOINTWACLRG=spoStandard;a.SHAREPOINTENTERPRISE_EDU=spoStandard;a.SHAREPOINTWAC_EDU=spoStandard;a.SHAREPOINT_S_ENTERPRISE_PILOT=spoStandard;a.SHAREPOINT_PROJECT_PILOT=spoStandard;a.SHAREPOINT_DUET_PILOT=spoStandard;a.SHAREPOINT_S_DEVELOPER_PILOT=spoStandard;a.SHAREPOINTWAC_DEVELOPER_PILOT=spoStandard;a.SHAREPOINTWAC_EDU_PILOT=spoStandard;a.SHAREPOINTWAC_PILOT=spoStandard;a.SHAREPOINT_S_ENTERPRISE_B_PILOT=spoStandard;a.SHAREPOINT_PROJECT_B_PILOT=spoStandard;a.SHAREPOINT_DUET_B_PILOT=spoStandard;a.SHAREPOINT_S_DEVELOPER_B_PILOT=spoStandard;a.SHAREPOINTWAC_EDU_B_PILOT=spoStandard;a.SHAREPOINTWAC_DEVELOPER_B_PILOT=spoStandard;a.SHAREPOINTWAC_B_PILOT=spoStandard;a.SHAREPOINTENTERPRISE_EDULRG=spoStandard;a.SHAREPOINTWAC_EDULRG=spoStandard;a.SHAREPOINTENTERPRISE_GOV=spoStandard;a.SHAREPOINTENTERPRISELRG_GOV=spoStandard;a.SHAREPOINTEXTRANET_GOV=spoStandard;a.SHAREPOINTSTORAGE_GOV=spoStandard;a.SHAREPOINTWAC_GOV=spoStandard;a.SHAREPOINTWACLRG_GOV=spoStandard;a.SHAREPOINT_APP_HOSTING=spoStandard;a.SHAREPOINT_PROJECT=spoStandard;a.SHAREPOINT_DUET=spoStandard;a.SHAREPOINT_S_DEVELOPER=spoStandard;a.SHAREPOINTWAC_DEVELOPER=spoStandard;a.SHAREPOINTWAC_DEVELOPER_B_PILOT=spoStandard;a.SHAREPOINT_PROJECT_GOV=spoStandard;a.SHAREPOINT_DUET_GOV=spoStandard;a.SHAREPOINT_APP_HOSTING_GOV=spoStandard;a.SHAREPOINT_PROJECT_EDU=spoStandard;a.SHAREPOINT_DUET_EDU=spoStandard;a.SHAREPOINT_APP_HOSTING_EDU=spoStandard;a.SHAREPOINTDESKLESS=spoStandardE1E2;a.SHAREPOINTSTANDARD=spoStandardE1E2;a.SHAREPOINTSTANDARD_EDU=spoStandardE1E2;a.SHAREPOINTSTANDARD_EDU_PILOT=spoStandardE1E2;a.SHAREPOINTSTANDARD_EDU_B_PILOT=spoStandardE1E2;a.SHAREPOINTDESKLESS_GOV=spoStandardE1E2;a.SHAREPOINTSTANDARD_GOV=spoStandardE1E2;a.SHAREPOINTENTERPRISE_MIDMARKET=spoMidsized;a.SHAREPOINTLITE=spoLite;a.SHAREPOINT_L_PROFESSIONAL_PILOT=spoLite;a.SHAREPOINT_L_PROFESSIONAL_B_PILOT=spoLite;return{GetNamespace:function(b){a:;return b==null?null:a[b]}}}()}function ULSDDa(){var a={};a.ULSTeamName="Microsoft SharePoint Foundation";a.ULSFileName="suitelinks.commentedjs";return a}function RenderSuiteLinks(b,d,a){function c(d){if(b==null||d==null)return;try{var c=JSON.parse(d);a!=null&&a(c);UpdateCompanyDisplayName(c);EnsureSPSuiteNavBar();SPSuiteNavBar.Render(b,c,function(a){!IsStrNullOrEmpty(a.href)&&GoToLink(a);return false});SP.SOD.notifyEventAndExecuteWaitingJobs("SPSuiteLinksRendered",[c])}catch(e){}}GetSuiteLinks(d,c)}function CacheSuiteLinks(b){try{JSON.parse(b)}catch(d){return false}var c=GetCurrentUICultureOrNone(),a=false;if(!IsNullOrUndefined(window.localStorage)){a=TrySetProperty(window.localStorage,"SPSuiteLinksJson",b);if(a){TrySetProperty(window.localStorage,"SPSuiteLinksLanguage",c);TrySetProperty(window.localStorage,"SPSuiteLinksDate",new Date);TrySetProperty(window.localStorage,"SPSuiteLinksUserKey",GetCurrentUserKey())}}if(!a){EnsureSPSuiteNavBar();SPSuiteNavBar.cachedJson=b}return true}function ClearSuiteLinksCache(){a:;if(!IsNullOrUndefined(window.localStorage))try{window.localStorage.removeItem("SPSuiteLinksJson");window.localStorage.removeItem("SPSuiteLinksLanguage");window.localStorage.removeItem("SPSuiteLinksDate");window.localStorage.removeItem("SPSuiteLinksUserKey")}catch(a){}}function GetQueryParamValue(d,a){if(typeof d!="undefined"&&typeof a!="undefined"){var e=new RegExp("[?&]"+d+"=","i"),b=a.search(e);if(b==-1)return null;b+=d.length+2;var c=a.indexOf("&",b);if(c==-1)c=a.length;return a.substring(b,c)}return null}function GetHelpIdFromKey(a){if(a!=null){var b=a.indexOf("_")+1;if(b>0)return a.substr(b)}return null}function GetSPOHelpNamespaceFromKey(b,e){var a="WSSENDUSER";if(b!=null){b=b.toUpperCase();var d=b.indexOf("_");if(d>0)a=b.substr(0,d);else a=b}if(a=="WSSENDUSER"||a=="HELPHOME"){var f=GetQueryParamValue("services",e),c=GetNamespaceForServices(f);if(c!=null)a=c}if(a=="PSENDUSER")a="PSOENDUSER";return a}function HelpNamespace(a,b){a:;this.namespace=a;this.priority=b}var spoLite,spoMidsized,spoStandardE1E2,spoStandard,SPOHelpNamespaceMap;function GetNamespaceForServices(b){a:;if(b==null)return spoStandard.namespace;b=b.toUpperCase();for(var e=b.split("%2C"),a=null,d=0;d<b.length;d++){var c=SPOHelpNamespaceMap.GetNamespace(e[d]);if(c!=null)if(a==null||c.priority>a.priority)a=c}if(a==null)a=spoStandard;return a.namespace}function GetSPOHelpUrl(h,e){if(e==null)return null;var c=GetSuiteHelpLink(h);if(c==null)return null;var a="http://o15.officeredir.microsoft.com/r/rlidOfficeWebHelp?",f=GetQueryParamValue("Key",e),d=GetSPOHelpNamespaceFromKey(f,c);if(d!=null){a+="p1=";a+=d}else return null;a+="&clid=";a+=Strings.STS.L_Language_Text;var g=GetHelpIdFromKey(f);if(g!=null){a+="&helpID=";a+=g}a+="&ver=15";var b=c.indexOf("?");if(b==-1)b=c.indexOf("&");else{b+=1;a+="&"}if(b>-1)a+=c.substring(b);return a}function UpdateCompanyDisplayName(b){if(Boolean(b.CompanyDisplayName)){var a=Strings.STS.L_Mybrary_Branding_TextWithName2;if(Boolean(a))a=String.format(a,"OneDrive",b.CompanyDisplayName);else{a=Strings.STS.L_Mybrary_Branding_TextWithName;a=String.format(a,b.CompanyDisplayName)}SP.SOD.notifyEventAndExecuteWaitingJobs("AddMybraryBranding",[a]);var d=document.getElementById("skyDriveText");d!=null&&setInnerText(d,a);var c=document.getElementById("skyDriveFolder");c!=null&&setInnerText(c,STSHtmlEncode(b.CompanyDisplayName))}}function EnsureSPSuiteNavBar(){a:;if(typeof SPSuiteNavBar!="undefined")return;SPSuiteNavBar=new function(){a:;function d(b,a,c){this.containerClass=b;this.imgClass=a;this.imgSrc=c}d.prototype.containerClass="";d.prototype.imgClass="";d.prototype.imgSrc="";var s="Suite_NavBar",B="_Clip",C=window.document.documentElement.getAttribute("dir")=="rtl",p=null,b=null,l=null,a=null,c=null,f=null,g=null,e=null,n=this,j=GetThemedImageUrl("spcommon.png");this.cachedJson="";var q=function(b,a){var c=b.clientX,d=b.clientY;return c>a.left&&c<a.right&&d>a.top&&d<a.bottom},D=function(a){return c!=null&&(q(a,e)||q(a,f))},h=function(b){a:;var a=document.createElement("div");a.appendChild(document.createTextNode(b));return a.innerHTML.replace(/\"/g,"&quot;")},o=function(e){var b=e.getBoundingClientRect(),c=Boolean(window.pageXOffset)?window.pageXOffset:document.documentElement.scrollLeft,d=Boolean(window.pageYOffset)?window.pageYOffset:document.documentElement.scrollTop,a={};a.left=b.left+c;a.right=b.right+c;a.top=b.top+d;a.bottom=b.bottom+d;return a},i=function(b,c){a:;var a=window.document.documentElement;if(Boolean(a.addEventListener))a.addEventListener(b,c,true);else Boolean(a.attachEvent)&&a.attachEvent("on"+b,c)},x=function(b){if(b==null)a.push('<li class="ms-core-menu-separatorHr"/>');else{a.push('<li class="ms-core-menu-item">');a.push("<a id=");a.push(StAttrQuote("Suite_SubLink_"+b.Id));a.push(' class="ms-core-menu-link" onblur="SPSuiteNavBar.MenuItemBlur(this);"');a.push(' onfocus="SPSuiteNavBar.MenuItemFocus(this);"');if(b.TargetWindow){a.push(" target=");a.push(StAttrQuote(b.TargetWindow))}a.push(' onkeydown="SPSuiteNavBar.MenuItemKeyDown(this,event);"');a.push(" href=");a.push(StAttrQuote(b.Url));a.push(">");a.push('<div class="ms-core-menu-label"><span class="ms-core-menu-title">');a.push(h(b.Text));a.push("</span></div></a></li>")}},w=function(c){if(c!=null){var b,d;d=c.length;if(d>0){a.push('<ul class="ms-core-menu-list">');for(b=0;b<d;b++)x(c[b]);a.push("</ul>")}}},y=function(c,b){a.push("<div id=");a.push(StAttrQuote(b));a.push(' class="ms-core-menu-box ms-core-suitemenu">');w(c);a.push("</div>")},k=function(a){var c=a.Id!=null&&a.Id==b.CurrentMainLinkElementID;r(a.Id,a.Url,a.TargetWindow,a.Text,null,a.SubLinks,false,c)},r=function(p,i,o,f,e,g,n,s,b){var t="Suite_MainLink_"+p;n=true;a.push('<li class="ms-core-suiteLink">');a.push("<a id=");a.push(StAttrQuote(t));var k,l=true,c=g!=null&&g.length>0;if(c){i=null;l=false;k="Suite_PopupMenu_"+p;u(k,n)}else a.push(' onfocus="SPSuiteNavBar.HideMenu();"');if(o!=null){a.push(" target=");a.push(StAttrQuote(o))}if(b==null&&e!=null)b=f;if(b!=null){a.push(' title="');a.push(h(b));a.push('"')}if(i!=null){a.push(" href=");a.push(StAttrQuote(i))}else if(c)a.push(' href="#"');else a.push(' class="ms-core-suiteLink-disabled"');a.push(' class="ms-core-suiteLink-a">');a.push('<span onblur="SPSuiteNavBar.HideMenuOnBlur()">');if(e==null){a.push(h(f));if(c){var q=new d("ms-suitenav-downarrowBox","ms-suitenav-downarrowIcon",j);m(q,null,null,false)}}else m(e,null,f,l);if(s){var r=new d("ms-suitenav-caratBox","ms-suitenav-caratIcon",j);m(r,"Suite_ActiveLinkIndicator",null,false)}a.push("</span>");a.push("</a>");c&&y(g,k);a.push("</li>")},u=function(f,e){a:;var b,d,c=["onfocus","onclick"];d=c.length;for(b=0;b<d;b++){a.push(" ");a.push(c[b]);a.push("=\"SPSuiteNavBar.ShowMenu(this, '");a.push(STSScriptEncode(f));a.push("', ");a.push(STSScriptEncode(String(e)));a.push(");");c[b]=="onclick"&&a.push("SPSuiteNavBar.KillEvent(event);");a.push('"')}a.push(' onblur="SPSuiteNavBar.HideMenuOnBlur()"')},m=function(b,d,c,e){if(b==null||b.imgSrc==null)return;a.push("<span");if(d!=null){a.push(" id=");a.push(StAttrQuote(d+B))}a.push(" class=");a.push(StAttrQuote(b.containerClass));a.push(' onblur="SPSuiteNavBar.HideMenuOnBlur()"><img');if(d!=null){a.push(" id=");a.push(StAttrQuote(d))}a.push(" class=");a.push(StAttrQuote(b.imgClass));a.push(" src=");a.push(StAttrQuote(b.imgSrc));if(c!=null){c=h(c);a.push(' alt="');a.push(c);a.push('"');if(e){a.push(' title="');a.push(c);a.push('"')}}a.push("/></span>")},A=function(){a:;if(b.IsAuthenticated||Boolean(b.UserDisplayName)){a.push("<div id=");a.push(StAttrQuote(s));Boolean(l)&&a.push(' onclick="SPSuiteNavBar.OnLinkClicked(event);"');a.push('><ul id="Suite_TopMenu" class="ms-core-suiteLinkList">');if(b.WorkloadLinks){var c,f;f=b.WorkloadLinks.length;for(c=0;c<f;c++)k(b.WorkloadLinks[c])}if(b.AppsLinks){var e=Strings.STS.L_OpenMenu_Text;if(b.AppsImage!=null&&b.AppsImage.AltText!=null)e=b.AppsImage.AltText;var g=new d("ms-suitenav-ellipsisBox ms-verticalAlignMiddle","ms-suitenav-ellipsisIcon",j);r("Apps",null,null,e,g,b.AppsLinks,false,false)}b.AdminLink&&k(b.AdminLink);b.PartnerLink&&k(b.PartnerLink);a.push("</ul></div>")}},v=function(){a:;b.O365SettingsLink!=null&&t(b.O365SettingsLink);z()},z=function(){a:;var a=null;if(b.LogoImage!=null)a=b.LogoImage.AltText;var d=document.getElementById("suiteBrandingLink");if(d!=null){b.LogoNavigationUrl!=null&&d.setAttribute("href",STSHtmlEncode(b.LogoNavigationUrl));a!=null&&d.setAttribute("title",a)}if(a!=null){var c=document.getElementById("suiteBrandingIcon");if(c!=null){c.setAttribute("alt",a);c.setAttribute("title",a)}}},t=function(a){for(var c=null,e=document.getElementsByTagName("menu"),d=0;d<e.length;d++){var b=e[d];if(b!=null&&b.id!=null&&b.id.toLowerCase().endsWith("siteactionsmenumain")){c=b;break}}if(c!=null&&a!=null&&a.Id!=null&&a.Url!=null&&a.Text!=null&&document.getElementById(a.Id)==null){var f=String.format('<ie:menuitem id={0} type="option" onMenuClick="STSNavigate2(event,\'{1}\');" text={2} description={2}></ie:menuitem>',StAttrQuote(a.Id),STSScriptEncode(a.Url),StAttrQuote(a.Text));c.innerHTML+=f}};this.KillEvent=function(a){if(Boolean(a.preventDefault))a.preventDefault();else a.returnValue=false;if(Boolean(a.stopPropagation))a.stopPropagation();else a.cancelBubble=true};this.HideMenuOnBlur=function(){a:;if(c!=null){var b=c,a=c.parentNode,d=this;setTimeout(function(){a:;var f=true,e=document.activeElement;if(e!=null){var c=e;while(c!=null){if(c==a){f=false;break}c=c.parentNode}}f&&b.style.display!="none"&&d.HideMenu()},0)}};this.HideMenu=function(){a:;if(c!=null){c.style.display="none";c.style.top="-10000px";c=null}if(g!=null){RemoveCssClassFromElement(g,"ms-core-suiteLink-active");g=null}};this.ShowMenu=function(i,m,d){var b=document.getElementById(m);if(b===c)return;this.HideMenu();MenuHtc_hide();AddCssClassToElement(i,"ms-core-suiteLink-active");c=b;g=i;e=o(i);var l=o(p);b.style.display="inline-block";var a,j=b.offsetWidth;if(typeof d=="undefined")d=false;if(C)d=!d;if(d)a=e.right-j;else a=e.left;var q=document.documentElement.clientWidth,h=Boolean(window.pageXOffset)?window.pageXOffset:document.documentElement.scrollLeft,k=h+q;if(a<h)a=h;else if(a+j>k)a=k-j;b.style.left=String(Math.max(h,a))+"px";b.style.top=String(l.bottom)+"px";var n=o(b);f=n;f.top=Math.min(f.top,e.bottom-1)};this.MenuItemBlur=function(d){var f="ms-core-menu-box",e="ms-core-menu-itemSelected",b=d.parentNode;b!=null&&RemoveCssClassFromElement(b,e);var a=d.parentNode;while(a!=null&&!HasCssClass(a,f))a=a.parentNode;if(a!=c)return;this.HideMenuOnBlur()};this.MenuItemFocus=function(c){var b="ms-core-menu-itemSelected",a=c.parentNode;a!=null&&!HasCssClass(a,b)&&AddCssClassToElement(a,b)};this.MenuItemKeyDown=function(b,a){if(a==null)a=window.event;a!=null&&GetEventKeyCode(a)==32&&ClkElmt(b);return false};this.OnLinkClicked=function(b){var a=Boolean(b.target)?b.target:b.srcElement,c=null;while(a!=null&&a!=p){if(a.tagName!=null&&a.tagName.toUpperCase()=="A"){c=a;break}a=a.parentNode}if(c!=null){var d=l(c);!d&&this.KillEvent(b)}};this.Render=function(c,e,f){a:;if(e==null)return;b=e;l=f;if(c!=null){var d=document.getElementById(c);if(d!=null){a=[];A();d.innerHTML=a.join("");p=document.getElementById(s)}}v();a=null;b=null};i("keydown",function(b){var a=27;(b.which==a||b.keyCode==a)&&n.HideMenu()});i("click",function(){n.HideMenu()});i("contextmenu",function(){n.HideMenu()})}}$_global_suitelinks();