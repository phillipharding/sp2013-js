Type.registerNamespace("SP.UI.CommunityModeration");SP.UI.CommunityModeration.CommunityModerationViewPageComponent=function(){SP.UI.CommunityModeration.CommunityModerationViewPageComponent.initializeBase(this)};SP.UI.CommunityModeration.CommunityModerationViewPageComponent.get_instance=function(){if(!SP.UI.CommunityModeration.CommunityModerationViewPageComponent.$0)SP.UI.CommunityModeration.CommunityModerationViewPageComponent.$0=new SP.UI.CommunityModeration.CommunityModerationViewPageComponent;return SP.UI.CommunityModeration.CommunityModerationViewPageComponent.$0};SP.UI.CommunityModeration.CommunityModerationViewPageComponent.initialize=function(){SP.Ribbon.PageManager.get_instance().addPageComponent(SP.UI.CommunityModeration.CommunityModerationViewPageComponent.get_instance());RegisterSod("reputation.js",SP.Utilities.VersionUtility.getLayoutsPageUrl("reputation.js"))};SP.UI.CommunityModeration.CommunityModerationViewPageComponent.prototype={$2_1:null,$1_1:null,getId:function(){return"CommunityModerationViewPageComponent"},getFocusedCommands:function(){this.$1_1=["ModerationViewTabEditItem","ModerationViewTabDeleteItem","ModerationViewTabApproveItem"];return this.$1_1},getGlobalCommands:function(){this.$2_1=["ModerationViewTabEditItem","ModerationViewTabDeleteItem","ModerationViewTabApproveItem"];return this.$2_1},canHandleCommand:function(a){return a==="ModerationViewTabEditItem"||a==="ModerationViewTabApproveItem"||a==="ModerationViewTabDeleteItem"?true:false},handleCommand:function(a){if(a==="ModerationViewTabApproveItem"){var b=GetUrlKeyValue("List",false,null),c=GetUrlKeyValue("ID",false,null);SP.UI.CommunityModeration.ModerationHelpers.approveReportedItems(b,c)}else if(a==="ModerationViewTabEditItem"){var d=GetUrlKeyValue("ID",false,null),e=GetUrlKeyValue("List",false,null);SP.UI.CommunityModeration.ModerationHelpers.navigateToModerationEditForm(e,d)}else a==="ModerationViewTabDeleteItem"&&SP.UI.CommunityModeration.ModerationHelpers.deleteReportedItem();return true}};SP.UI.CommunityModeration.CommunityModerationPageComponent=function(){SP.UI.CommunityModeration.CommunityModerationPageComponent.initializeBase(this)};SP.UI.CommunityModeration.CommunityModerationPageComponent.get_instance=function(){if(!SP.UI.CommunityModeration.CommunityModerationPageComponent.$0)SP.UI.CommunityModeration.CommunityModerationPageComponent.$0=new SP.UI.CommunityModeration.CommunityModerationPageComponent;return SP.UI.CommunityModeration.CommunityModerationPageComponent.$0};SP.UI.CommunityModeration.CommunityModerationPageComponent.initialize=function(){SP.Ribbon.PageManager.get_instance().addPageComponent(SP.UI.CommunityModeration.CommunityModerationPageComponent.get_instance());RegisterSod("reputation.js",SP.Utilities.VersionUtility.getLayoutsPageUrl("reputation.js"))};SP.UI.CommunityModeration.CommunityModerationPageComponent.prototype={$2_1:null,$1_1:null,getId:function(){return"CommunityModerationPageComponent"},getFocusedCommands:function(){this.$1_1=["ModerationViewItem","ModerationEditItem","ModerationApproveItem"];return this.$1_1},getGlobalCommands:function(){this.$2_1=["ModerationViewItem","ModerationEditItem","ModerationApproveItem"];return this.$2_1},canHandleCommand:function(a){return a==="ModerationEditItem"||a==="ModerationViewItem"?SP.UI.CommunityModeration.Utilities.getSelectedItemCount()===1:a==="ModerationApproveItem"?SP.UI.CommunityModeration.Utilities.getSelectedItemCount()>=1:false},handleCommand:function(a){var b=SP.ListOperation.Selection.getSelectedList(),c=SP.UI.CommunityModeration.Utilities.selectedItemIds();if(a==="ModerationApproveItem")SP.UI.CommunityModeration.ModerationHelpers.approveReportedItems(b,c);else if(a==="ModerationViewItem")SP.UI.CommunityModeration.ModerationHelpers.navigateToModerationViewForm(b,c);else a==="ModerationEditItem"&&SP.UI.CommunityModeration.ModerationHelpers.navigateToModerationEditForm(b,c);return true}};SP.UI.CommunityModeration.ModerationHelpers=function(){};SP.UI.CommunityModeration.ModerationHelpers.approveReportedItems=function(a,b){confirm(Strings.STS.L_SPDiscApproveConfirmation)&&EnsureScriptFunc("reputation.js","Microsoft.SharePoint.Portal.CommunityModeration",function(){var c=new SP.ClientContext;Microsoft.SharePoint.Portal.CommunityModeration.approveReportedItems(c,a,b);c.executeQueryAsync(SP.UI.CommunityModeration.ModerationHelpers.$6,SP.UI.CommunityModeration.ModerationHelpers.$5)})};SP.UI.CommunityModeration.ModerationHelpers.$6=function(){var a=GetUrlKeyValue("Source",false,null);if(!SP.UI.CommunityModeration.Utilities.isNullOrUndefinedOrEmpty(a))STSNavigate(a);else RefreshPage(1)};SP.UI.CommunityModeration.ModerationHelpers.$5=function(){};SP.UI.CommunityModeration.ModerationHelpers.navigateToModerationEditForm=function(a,b){SP.UI.CommunityModeration.ModerationHelpers.$3("CommunityModerationEdit.aspx",a,b)};SP.UI.CommunityModeration.ModerationHelpers.deleteReportedItem=function(){if(confirm(Strings.STS.L_SPDiscDeleteConfirm)){var a=SP.ClientContext.get_current(),b=a.get_web();b.retrieve("RecycleBinEnabled");a.executeQueryAsync(SP.UI.CommunityModeration.ModerationHelpers.$A,SP.UI.CommunityModeration.ModerationHelpers.$9)}};SP.UI.CommunityModeration.ModerationHelpers.$A=function(){var a=SP.ClientContext.get_current(),c=a.get_web(),d=GetUrlKeyValue("ID",false,null),e=GetUrlKeyValue("List",false,null),f=a.get_web().get_lists().getById(new SP.Guid(e)),b=f.getItemById(d);if(c.get_recycleBinEnabled())b.recycle();else b.deleteObject();a.executeQueryAsync(SP.UI.CommunityModeration.ModerationHelpers.$8,SP.UI.CommunityModeration.ModerationHelpers.$7)};SP.UI.CommunityModeration.ModerationHelpers.$9=function(){};SP.UI.CommunityModeration.ModerationHelpers.$8=function(){var a=GetUrlKeyValue("Source",false,null);STSNavigate(a)};SP.UI.CommunityModeration.ModerationHelpers.$7=function(){};SP.UI.CommunityModeration.ModerationHelpers.navigateToModerationViewForm=function(a,b){SP.UI.CommunityModeration.ModerationHelpers.$3("CommunityModerationView.aspx",a,b)};SP.UI.CommunityModeration.ModerationHelpers.$3=function(c,d,e){var b=SP.Utilities.Utility.getLayoutsPageUrl(c),a=new SP.Utilities.UrlBuilder(b);a.addKeyValueQueryString("ID",e);a.addKeyValueQueryString("List",d);a.addKeyValueQueryString("Source",document.URL);STSNavigate(a.get_url())};SP.UI.CommunityModeration.Utilities=function(){};SP.UI.CommunityModeration.Utilities.isNullOrUndefinedOrEmpty=function(b){var c=null,a=b;return a===c||typeof a==="undefined"||!b.length};SP.UI.CommunityModeration.Utilities.selectedItemIds=function(){var f=SP.ListOperation.Selection.getSelectedList();if(SP.ScriptUtility.isNullOrUndefined(f))return"";var d=SP.ListOperation.Selection.getSelectedItems();if(SP.ScriptUtility.isNullOrUndefined(d))return"";var a="",e=null,b=d;for(var c in b){var g={key:c,value:b[c]};a=a+g.value.id+","}if(a.length)e=a.substring(0,a.length-1);return e};SP.UI.CommunityModeration.Utilities.getSelectedItemCount=function(){var d=SP.ListOperation.Selection.getSelectedItems(),c=0,a=d;for(var b in a){var e={key:b,value:a[b]};c++}return c};SP.UI.CommunityModeration.CommunityModerationViewPageComponent.registerClass("SP.UI.CommunityModeration.CommunityModerationViewPageComponent",CUI.Page.PageComponent);SP.UI.CommunityModeration.CommunityModerationPageComponent.registerClass("SP.UI.CommunityModeration.CommunityModerationPageComponent",CUI.Page.PageComponent);SP.UI.CommunityModeration.ModerationHelpers.registerClass("SP.UI.CommunityModeration.ModerationHelpers");SP.UI.CommunityModeration.Utilities.registerClass("SP.UI.CommunityModeration.Utilities");function sp_ui_communitymoderation_initialize(){SP.UI.CommunityModeration.CommunityModerationViewPageComponent.$0=null;SP.UI.CommunityModeration.CommunityModerationPageComponent.$0=null}sp_ui_communitymoderation_initialize();RegisterModuleInit("sp.ui.communitymoderation.js",sp_ui_communitymoderation_initialize);typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();NotifyScriptLoadedAndExecuteWaitingJobs("SP.UI.CommunityModeration.js");