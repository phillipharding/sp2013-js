function $_global_ows(){IsMenuShown=false;ChevronContainer=null;itemTableDeferred=null;imageCell=null;onKeyPress=false;downArrowText=null;currentEditMenu=null;currentItemID=null;currentItemAppName=null;currentItemProgId=null;currentItemIcon=null;currentItemOpenControl=null;currentItemOpenApp=null;currentItemFileUrl=null;currentItemFSObjType=null;currentItemContentTypeId=null;currentItemCheckedOutUserId=null;currentItemCheckoutExpires=null;currentItemModerationStatus=null;currentItemUIString=null;currentItemCheckedoutToLocal=null;bIsCheckout=0;currentItemCanModify=null;currentItemPermMaskH=null;currentItemPermMaskL=null;currentItemEvtType=0;currentItemIsEventsExcp=null;currentItemIsEventsDeletedExcp=null;g_MaximumSelectedItemsAllowed=100;g_CustomActionDialogHandlers={};g_CustomActionDialogHandlerId=0;g_ExpGroupWPState=new LRUCache;DocOpen={CLIENT:0,BROWSER:1};hoverTR=null;ecbTD=null;ProtocolCommand={View:"ofv",Edit:"ofe",New:"nft"};phManager=new function(){a:;var a=false,c=false,b={};this.ShouldTryProtocolHandler=function(a){return!IsStrNullOrEmpty(a)&&typeof navigator.msLaunchUri=="function"&&b[a]==null};this.SetProtocolHandlerEnabled=function(c,a){b[c]=a};this.IsProtocolHandlerEnabled=function(d){if(IsStrNullOrEmpty(d))return false;if(b[d]!=null)return b[d];if(c)return a;c=true;if(d==="ms-project")if(typeof navigator.msLaunchUri=="function"){a=true;return a}if(Boolean(window.ActiveXObject))try{if(d==="ms-project")var f=new ActiveXObject("WinProj.Activator");else var g=new ActiveXObject("SharePoint.OpenDocuments.5");a=true}catch(h){}else if(IsSupportedNPApiBrowserOnWin()){var e=CreateNPApiOnWindowsPlugin("application/x-sharepoint");if(e!=null)try{if(e.GetOfficeVersion()=="15")a=true}catch(h){}}return a};this.CreateProtocolHandlerUrl=function(c,e,d,f){var a=[],b=c.split("|");if(b.length==2){a.push(b[0]);a.push(":");a.push(e);return a.join("")}else if(b.length==3)c=b[0];a.push(c);a.push(":");a.push(d);a.push("|u|");a.push(e);if(d==ProtocolCommand.New){a.push("|s|");a.push(f)}return a.join("")}};CBSelectedValues_InitializePrototype();PageContextInfo_InitializePrototype();g_ExtensionNotSupportCheckoutToLocal=["ascx","asp","aspx","htm","html","master","odc","exe","bat","com","cmd","onetoc2"];g_ExtensionDefaultForRead=["jpg","jpeg","bmp","png","gif","onetoc2","one","odc"];bValidSearchTerm=false;fListControl=false;fListErrorShown=false;fNewDoc=false;fNewDoc2=false;fNewDoc3=false;SPDesignerDownloadUrl="http://o15.officeredir.microsoft.com/r/rlidSPD2013Download";SPDesignerProgID="SharePoint.WebPartPage.Document";CtxRgiid_InitializePrototype();g_varSkipRefreshOnFocus=0;g_useDialogAlwaysList=["upload.aspx","uploadex.aspx","deploydeveloperapp.aspx"];LRUCache_InitializePrototype();v_stsOpenDoc=null;v_strStsOpenDoc=null;g_AdditionalNavigateHierarchyQString="";httpFolderTarget=null;httpFolderSource=null;httpFolderDiv=null;previousClickedItemRow=null;Point.prototype={x:undefined,y:undefined,toString:function(){a:;return"("+String(this.x)+","+String(this.y)+")"}};isdlg=ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"));_spBodyOnLoadFunctionNames!=null&&typeof _spBodyOnLoadFunctionNames!="undefined"&&_spBodyOnLoadFunctionNames.push("SearchOnBodyLoad");isdlg==null&&SetEvent("resize",FixRibbonAndWorkspaceDimensionsForResize,window);QstringStruct.prototype.toString=QstringStructToString;QstringStruct.prototype.toArray=QstringStructToArray;Diff.prototype={left:[],right:[]};QstringStruct.Diff=function(h,g){for(var f=new QstringStruct(h).toArray(),e=new QstringStruct(g).toArray(),b={},d=new Diff,a=0;a<f.length;a++)b[f[a]]|=1;for(a=0;a<e.length;a++)b[e[a]]|=2;for(var c in b)if(b[c]==1)d.left.push(c);else b[c]==2&&d.right.push(c);return d};g_listItemCache={};g_fSkipAnimation=false;g_fSkipNextTabExpandAnimation=false;g_InViewPort=1;g_OutOfViewPortCloserToTop=2;g_OutOfViewPortCloserToBottom=3;UTF8_1ST_OF_2=192;UTF8_1ST_OF_3=224;UTF8_1ST_OF_4=240;UTF8_TRAIL=128;HIGH_SURROGATE_BITS=55296;LOW_SURROGATE_BITS=56320;SURROGATE_6_BIT=64512;SURROGATE_ID_BITS=63488;SURROGATE_OFFSET=65536;if(typeof String.prototype.endsWith=="undefined")String.prototype.endsWith=function(a){return this.substr(this.length-a.length)===a};if(typeof String.prototype.startsWith=="undefined")String.prototype.startsWith=function(a){return this.substr(0,a.length)===a};XUIHtml={};XUIHtml.SetOpacity=function(a,b){if(typeof a.style=="undefined")return;if(document.body.style.opacity!=null)if(b==1)XUIHtml.RemoveCSSProperty(a,"opacity");else a.style.opacity=b;else if(b==1)XUIHtml.RemoveCSSProperty(a,"filter");else a.style.filter="alpha(opacity="+String(b*100)+")"};XUIHtml.RemoveCSSProperty=function(a,b){if(typeof a.style.removeProperty!="undefined")a.style.removeProperty(b);else a.style.removeAttribute(b)};XUIHtml.GetOpacity=function(a){if(typeof a.style=="undefined")return-1;if(document.body.style.opacity!=null){var c=a.style.opacity;return c!=null&&c!=""?parseFloat(c):1}else{var b=a.style.filter;return b!=null&&b!=""?parseInt(b.replace("alpha(opacity=","").replace(")",""))/100:1}};Calendar_InitializePrototype();CalEvent_InitializePrototype();Span_InitializePrototype();cGCMinimumWidth=400;cGCMinimumHeight=200;cGCMaxGCResizeCount=10;glGCObjectHeight=0;glGCObjectWidth=0;glGCResizeCounter=0;objGCGlobal=null;PositionInfo_InitializePrototype();ecbManager={callOutPar:null,DismissECB:function(){a:;var c={};if(ecbManager.callOutPar!=null){var e=itemTable;c.callOut=true;OutItem(c);ecbManager.callOutPar=null;itemTable=e}var d=window.event,a=null;if(d!=null)a=Boolean(d.srcElement)?d.srcElement:d.target;while(a!=null&&a.tagName!="TR")a=a.parentNode;var b=null;if(a!=null&&itemTable!=null){b=itemTable;while(b!=null){if(b==a)break;b=b.parentNode}}if(b==null){c.callOut=false;OutItem(c)}}};ecbItems="ECBItems";SYSTEM_ACCOUNT_ID=1073741823;resetItemGlobals();IMNControlObj=null;bIMNControlInited=false;IMNDictionaryObj=null;bIMNSorted=false;bIMNOnloadAttached=false;IMNOrigScrollFunc=null;bIMNInScrollFunc=false;IMNSortableObj=null;IMNHeaderObj=null;IMNNameDictionaryObj=null;IMNShowOfflineObj=null;IMNImageInfo_InitializePrototype();imnCount=0;imnElemsCount=0;imnMarkerBatchSize=4;imnMarkerBatchDelay=40;g_dlgWndTop=null;g_spDlgLauncher=true;g_ModalDialogCount=0;g_overlayPopup=undefined;g_childDialog=undefined;CommonGlobalDialogReturnValue_InitializePrototype();commonModalDialogReturnValue=new CommonGlobalDialogReturnValue;filterTable=null;bIsFilterMenuShown=false;bIsFilterDataLoaded=false;filterImageCell=null;currentFilterMenu=null;loadingFilterMenu=null;ctxFilter=null;bIsFilterKeyPress=false;filterStr=null;strFieldName="";bMenuLoadInProgress=false;strFilteredValue=null;bIsMultiFilter=false;fnOnFilterMouseOut=null;_spBodyOnLoadCalled=false;if(typeof _spBodyOnLoadFunctions==="undefined"||_spBodyOnLoadFunctions===null)_spBodyOnLoadFunctions=[];_spFormOnSubmitCalled=false;_spBodyOnPageShowRegistered=false;_spBodyOnLoadCalled=false;if("undefined"!=typeof _spBodyOnLoad)_spBodyOnLoad=undefined;if("undefined"!=typeof _spRestoreScrollForDiv_rscr)_spRestoreScrollForDiv_rscr=undefined;if(_spBodyOnLoadFunctionNames==null){_spBodyOnLoadFunctionNames=[];_spBodyOnLoadFunctionNames.push("_spBodyOnLoad");_spBodyOnLoadFunctionNames.push("_spRestoreScrollForDiv_rscr")}_spFormOnSubmitCalled=false;_spBodyOnPageShowRegistered=false;_spPageLoadedRegistered=false;_inlineEditString=null;_spOriginalFormAction=null;g_numberOfYields=10;g_spPreFetchKeys=[];_spSuppressFormOnSubmitWrapper=false;_inlineEditString=null;_spPageLoadedRegistered=false;g_fAnimateListCSR=true;if(document.body==null||document.body.firstChild==null){typeof document.addEventListener!="undefined"&&typeof window.msWriteProfilerMark!="undefined"&&document.addEventListener("DOMContentLoaded",function(){a:;window.msWriteProfilerMark("DOMContentLoaded")},false);AttachEvent("DOMContentLoaded",_spBodyOnLoadWrapper,document);window.onload=_spBodyOnLoadWrapper;AttachEvent("hashchange",_bodyOnHashChangeHandler,window)}typeof Sys!="undefined"&&Sys!=null&&Sys.Application!=null&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs=="function"&&NotifyScriptLoadedAndExecuteWaitingJobs("ows.js")}function ULSw7Q(){var a={};a.ULSTeamName="Microsoft SharePoint Foundation";a.ULSFileName="ows.commentedjs";return a}var IsMenuShown,ChevronContainer,itemTableDeferred,imageCell,onKeyPress,downArrowText,currentEditMenu,currentItemID,currentItemAppName,currentItemProgId,currentItemIcon,currentItemOpenControl,currentItemOpenApp,currentItemFileUrl,currentItemFSObjType,currentItemContentTypeId,currentItemCheckedOutUserId,currentItemCheckoutExpires,currentItemModerationStatus,currentItemUIString,currentItemCheckedoutToLocal,bIsCheckout,currentItemCanModify,currentItemPermMaskH,currentItemPermMaskL,currentItemEvtType,currentItemIsEventsExcp,currentItemIsEventsDeletedExcp,g_MaximumSelectedItemsAllowed,g_CustomActionDialogHandlers,g_CustomActionDialogHandlerId,g_ExpGroupWPState,DocOpen,hoverTR,ecbTD;function RowOnHover(b,c){var g=b.getAttribute("iid"),f=CtxFromRow(b);if(CountSelectedItems(f)>1&&ItemIsCurrentlySelected(f,g,b)){ecbTD=null;hoverTR=null;for(var e=0;e<b.childNodes.length;e++){var d=b.childNodes[e];if(d.getAttribute("IsECB")=="TRUE"){OnChildItem(d);ecbTD=d;hoverTR=b;break}}var a=null;if(c!=null)a=c.toElement!=null?c.toElement:c.target;if(a!=null&&b!=a){if(a.tagName!="DIV")a=GetAncestor(a,"DIV");if(a!=null&&typeof a.onmouseover=="function")a.onmouseover(c)}}}function RowHoverOff(e,c){if(hoverTR==null||c==null||ecbTD==null||CountSelectedItems(CtxFromRow(e))<=1)return;var b=c.toElement!=null?c.toElement:c.relatedTarget;if(b!=null&&b.tagName!="TR"){var a=b.parentNode;while(a!=null&&a.tagName!="TR")a=a.parentNode;if(a==hoverTR)return}else if(b==hoverTR)return;var d={};OutItem(d);ecbTD=null;hoverTR=null}function IsEventTargetAnchor(a){var b=a.srcElement!=null?a.srcElement:a.target;return b!=null&&b.tagName.toUpperCase()=="A"?true:false}function IsEventRightClickOnAnchor(a){return a==null?false:a.type=="contextmenu"?IsEventTargetAnchor(a):false}function ShowMenuForTrOuter(d,b,c){if(b==null)return true;var a=b.srcElement;return a==null?true:a.tagName.toLowerCase()=="div"&&a.className.indexOf("ms-list-itemLink")>=0?ShowCalloutMenuForTr(d,b,c):true}function ShowCalloutMenuForTr(c,d,b){var a=false;EnsureScriptFunc("callout.js","Callout",function(){a:;a=ShowCalloutMenuForTrInner(c,d,b)});return a}function ShowCalloutMenuForTrInner(h,c,g){if(IsEventRightClickOnAnchor(c))return true;var b=GetAncestor(h,"TR"),e=GetEcbTdFromRow(b),a=GetEcbDivFromEcbTd(e),d=GetEcbAffordanceDivFromRow(b);if(a==null)return true;g&&SingleItemSelectByElement(b,false);var f=GetAttributeFromItemTable(a,"ItemId","Id");OpenCallout(d,c,a,f);return false}function FIsMouseCursorInsideElement(a,c){if(a==null||c==null||a.clientX==null||a.clientY==null||a.clientX==0||a.clientY==0)return false;var b=c.getBoundingClientRect();return b.left<=a.clientX&&b.right>=a.clientX&&b.top<=a.clientY&&b.bottom>=a.clientY?true:false}function ShowECBMenuForTr(d,b){if(IsEventRightClickOnAnchor(b))return true;var c=GetAncestor(d,"TR"),f=GetEcbTdFromRow(c),a=GetEcbDivFromEcbTd(f);if(a==null)return true;c.className.indexOf("s4-itm-selected")<0&&SingleItemSelectByElement(c,false);var g=IsAjaxMenu(a);itemTable=a;currentItemID=GetAttributeFromItemTable(a,"ItemId","Id");currentCtx=g_ctxDict[a.getAttribute("CTXName")];if(g){var e=FIsMouseCursorInsideElement(b,d);return CreateAjaxMenu(b,e)}else return CreateMenu(b)}var ProtocolCommand,phManager;function CBSelectedValues(b,a){this.strList=b;this.fAllChecked=a}function CBSelectedValues_InitializePrototype(){a:;CBSelectedValues.prototype.strList="";CBSelectedValues.prototype.fAllChecked=false}function PageContextInfo(e,n,h,m,q,p,r,k,c,a,j,l,o,g,i,f,d,b){this.webServerRelativeUrl=e;this.webAbsoluteUrl=j;this.siteAbsoluteUrl=i;this.layoutsUrl=o;this.webLanguage=n;this.siteClientTag=l;this.currentLanguage=h;this.webUIVersion=m;this.pageListId=q;this.pageItemId=p;this.userId=r;this.alertsEnabled=k;this.siteServerRelativeUrl=c;this.allowSilverlightPrompt=a;this.tenantAppVersion=g;this.themedImageRootPath=f;this.themedImageFileNames=d;this.clientServerTimeDelta=b}function PageContextInfo_InitializePrototype(){a:;PageContextInfo.prototype.webServerRelativeUrl="";PageContextInfo.prototype.webAbsoluteUrl="";PageContextInfo.prototype.siteAbsoluteUrl="";PageContextInfo.prototype.serverRequestPath="";PageContextInfo.prototype.layoutsUrl="";PageContextInfo.prototype.siteClientTag="";PageContextInfo.prototype.webLanguage=0;PageContextInfo.prototype.webTitle=null;PageContextInfo.prototype.webLogoUrl=null;PageContextInfo.prototype.currentCultureName=null;PageContextInfo.prototype.currentUICultureName=null;PageContextInfo.prototype.currentLanguage=0;PageContextInfo.prototype.crossDomainPhotosEnabled=false;PageContextInfo.prototype.webUIVersion=0;PageContextInfo.prototype.pageListId="";PageContextInfo.prototype.pageItemId=0;PageContextInfo.prototype.userId="";PageContextInfo.prototype.systemUserKey="";PageContextInfo.prototype.alertsEnabled=false;PageContextInfo.prototype.siteServerRelativeUrl="";PageContextInfo.prototype.allowSilverlightPrompt="";PageContextInfo.prototype.tenantAppVersion=null;PageContextInfo.prototype.themedImageRootPath=null;PageContextInfo.prototype.themedImageFileNames=null;PageContextInfo.prototype.clientServerTimeDelta=0}var _groupCollapse,_spPageContextInfo,bGridViewPresent,_fV4Calendar,_spCustomNavigateHierarchy,g_ExtensionNotSupportCheckoutToLocal,g_ExtensionDefaultForRead,bValidSearchTerm,ListCtrlObj,fListControl,fListErrorShown,fNewDoc,fNewDoc2,fNewDoc3,SPDesignerDownloadUrl,SPDesignerProgID;function CtxRgiid(b,a){this.ctx=b;this.rgiid=a}function CtxRgiid_InitializePrototype(){a:;CtxRgiid.prototype={ctx:undefined,rgiid:undefined}}function FilterNoteField(b,g,i,o){if(o!=13)return;event.returnValue=false;var a=window.location.href,m=/&Paged=TRUE&p_[^&]*&PageFirstRow=[^&]*/gi;a=a.replace(m,"");var f=GetUrlKeyValue("View",true);if(f==""){a=StURLSetVar2(a,"View",b);f=b}var e;if(b.toUpperCase()!=f.toUpperCase()){var k=escapeProperly(b);if(k.toUpperCase()!=f.toUpperCase()){var p=/\?[^?]*/i;e=a.indexOf("?");if(e!=-1)a=a.replace(p,"?View="+b);else a=a+"?View="+b}}var c=a.match(new RegExp("FilterField([0-9]+)="+g));if(c==null){e=a.indexOf("?");if(e!=-1)a=a+"&";else a=a+"?";var d=0,h;do{d++;h=a.match(new RegExp("FilterField"+String(d)+"=[^&]*&FilterValue"+String(d)+"=[^&]*"))}while(h!=null);a=a+"FilterField"+String(d)+"="+g+"&FilterValue"+String(d)+"="+escapeProperly(i);a=a.replace("Filter=1&","")}else{var n=parseInt(c[1]),l=a.match(new RegExp("&FilterValue"+String(n)+"=[^&]*")),q="&"+c[0]+l[0],j="&FilterField"+c[1]+"="+g+"&FilterValue"+c[1]+"="+escapeProperly(i);a=a.replace(q,j);a=a.replace("Filter=1&","")}window.location.href=STSPageUrlValidation(a)}function _SelectField(k,m){var a=ajaxNavigate.get_href(),i=ajaxNavigate.get_hash(),b=false,e=/\#.*/i;a=a.replace(e,"");var h=GetUrlKeyValue("View",true),g=GetUrlKeyValue("PageView",true),j=GetUrlKeyValue("ID",true),f=GetUrlKeyValue("ContentTypeId",true);if(k.toUpperCase()!=h.toUpperCase()){var c=escapeProperly(k);if(c.toUpperCase()!=h.toUpperCase()){e=/\?[^?]*/i;var l=a.indexOf("?");if(l!=-1)a=a.replace(e,"?View="+c);else a=a+"?View="+c;b=true}}if(!b&&GetUrlKeyValue("SelectedID")!=""){var d=/&SelectedID=[^&]*/gi;a=a.replace(d,"");d=/\?SelectedID=[^&]*&?/;a=a.replace(d,"?")}a=a+"&SelectedID=";a=a+m;if(b&&g!="")a=a+"&PageView="+g;if(j!="")a=a+"&ID="+j;if(f!="")a=a+"&ContentTypeId="+f;if(i!="")a=a+i;_SubmitFormPost(a);return false}function getSortQueryParam(b){a:;if(b==null||b=="")return"";var c="",a;a=b.match(new RegExp("SortField=[^&]*&SortDir=[^&]*"));if(a!=null)c=a[0];return c}function _FilterField(d,b,a,c){return FilterFieldV3(d,b,a,c,"",false)}function CompleteDecode(b){if(typeof b=="undefined"||b==null)return b;var a=b,c=unescapeProperly(a);while(a!=c){a=c;c=unescapeProperly(a)}return a}function FilterFieldV3(l,k,i,t,r,G){var g,a=Boolean(r)?r:CanonicalizeUrlEncodingCase(ajaxNavigate.get_href()),v=new URI(a,{disableEncodingDecodingForLegacyCode:true});a="?"+v.getQuery();var e,q,b=a.match(new RegExp("[&?]Paged=TRUE[^&]*"));if(b!=null){var c=/&p_[^&]*/gi;a=a.replace(c,"");c=/&PageFirstRow=[^&]*/gi;a=a.replace(c,"");c=/&PageLastRow=[^&]*/gi;a=a.replace(c,"");c=/&PagedPrev=TRUE[^&]*/i;a=a.replace(c,"");b=a.match(new RegExp("[?]Paged=TRUE[^&]*"));if(b!=null){g=a.substr(b.index).indexOf("&");if(g!=-1)a=a.substr(0,b.index+1)+a.substr(g+b.index+1);else a=a.substr(0,b.index)}else{c=/&Paged=TRUE[^&]*/i;a=a.replace(c,"")}}var u=GetUrlKeyValue("View",true);if(u==""){a=StURLSetVar2(a,"View",l);u=l}if(CompleteDecode(l.toUpperCase())!=CompleteDecode(u.toUpperCase())){var H=/\?[^?]*/i;g=a.indexOf("?");if(g!=-1)a=a.replace(H,"?View="+l);else a=a+"?View="+l}var s=true;b=a.match(new RegExp("FilterField([0-9]+)="+k+"&"));if(!Boolean(b)){b=a.match(new RegExp("FilterFields([0-9]+)="+k+"&"));s=false}if(!Boolean(b))if(0==t){a=a.replace("Filter=1&","");a=a.replace("?Filter=1","")}else{g=a.indexOf("?");if(g!=-1)a=a+"&";else a=a+"?";var m=0;do{m++;q=a.match(new RegExp("FilterField"+String(m)+"=[^&]*"));if(!Boolean(q))q=a.match(new RegExp("FilterFields"+String(m)+"=[^&]*"))}while(q!=null);a=a+"FilterField"+String(m)+"="+k+"&FilterValue"+String(m)+"="+escapeProperly(i);a=a.replace("Filter=1&","")}else{e=parseInt(b[1]);var f=a.match(new RegExp("FilterValue"+String(e)+"=[^&]*"));if(!Boolean(f))f=a.match(new RegExp("FilterValues"+String(e)+"=[^&]*"));var C=a.match(new RegExp("&FilterOp"+String(e)+"=[^&]*")),z=a.match(new RegExp("&FilterLookupId"+String(e)+"=[^&]*")),B=a.match(new RegExp("&FilterData"+String(e)+"=[^&]*")),j="&"+b[0]+f[0];if(0==t){if(a.indexOf(j)==-1){var F=b[0];j=F+f[0]+"&"}a=a.replace(j,"");if(C!=null)a=a.replace(String(C[0]),"");if(z!=null)a=a.replace(String(z[0]),"");if(B!=null)a=a.replace(String(B[0]),"");a=restructureFilterUrl(a,e);a=a.replace("Filter=1&","");a=a.replace("?Filter=1","");a=a.replace("&Filter=1","")}else{var o;if(a.indexOf(j)==-1){j="?"+b[0]+f[0];o="?"}else o="&";var p;if(ctxFilter==null||!ctxFilter.IsClientRendering)p=o+"FilterField"+b[1]+"="+k+"&FilterValue"+b[1]+"="+escapeProperly(i);else{var w=false,d=String(f[0].substr(f[0].indexOf("=")+1)),h=[],n=[];if(s){d=unescapeProperly(d);if(i!=d){h.push(d);h.push(i)}}else{n=ParseMultiColumnValue(unescapeProperly(d),";#",true);for(var A in n){if(n[A]==i){w=true;continue}h.push(n[A])}!w&&h.push(i)}d=escapeProperly(ConvertMultiColumnValueToString(h,null,false));var x="FilterField",y="&FilterValue";if(h.length>1){x="FilterFields";y="&FilterValues"}p=o+x+b[1]+"="+k+y+b[1]+"="+d;if(d==""&&s){p="";a=restructureFilterUrl(a,e)}}a=a.replace(j,p);a=a.replace("Filter=1&","");a=a.replace("&Filter=1","")}}var E=b;b=a.match(new RegExp("FilterField([0-9]+)="));if(!Boolean(b))b=a.match(new RegExp("FilterFields([0-9]+)="));if(b==null&&t==0&&ctxFilter!=null&&(!ctxFilter.IsClientRendering||E!=null&&!Boolean(r)))a=a+"&FilterClear=1";else a=a.replace("&FilterClear=1","");v.setQuery(a);a=v.getString();if(G){var D=a.indexOf("?");D=a.substr(D+1).indexOf("?");return a}else _SubmitFormPost(a);return null}function restructureFilterUrl(a,h){var b=h+1,f=a.match(new RegExp("FilterField"+String(b)+"=[^&]*")),g=false;if(!Boolean(f)){f=a.match(new RegExp("FilterFields"+String(b)+"=[^&]*"));g=f!=null}for(var e=h;f!=null;e++){var c=g?"FilterFields"+String(e):"FilterField"+String(e),d=g?"FilterFields"+String(b):"FilterField"+String(b);a=a.replace(d,c);c=g?"FilterValues"+String(e):"FilterValue"+String(e);d=g?"FilterValues"+String(b):"FilterValue"+String(b);a=a.replace(d,c);c="FilterOp"+String(e);d="FilterOp"+String(b);a=a.replace(d,c);c="FilterLookupId"+String(e);d="FilterLookupId"+String(b);a=a.replace(d,c);c="FilterData"+String(e);d="FilterData"+String(b);a=a.replace(d,c);b++;f=a.match(new RegExp("FilterField"+String(b)+"=[^&]*"));if(!Boolean(f))f=a.match(new RegExp("FilterFields"+String(b)+"=[^&]*"))}return a}function CanonicalizeUrlEncodingCase(c){for(var b="",a=0;a<c.length;a++){var d=c.charAt(a);if(d=="%"&&a+2<c.length){b+=d;a++;b+=c.charAt(a).toString().toUpperCase();a++;b+=c.charAt(a).toString().toUpperCase()}else b+=d}return b}function _SetControlValue(b,c){var a=document.getElementById(b);if(a!=null)a.value=c}function SetSearchView(){a:;if(typeof bValidSearchTerm!="undefined")bValidSearchTerm=true}function GroupCollapse(){a:;return typeof _groupCollapse!="undefined"&&_groupCollapse}function HandleFilter(e,b,d){if(FV4UI()){var a;try{a=typeof inplview.HandleFilterReal}catch(h){a="undefined"}var g="inplview.HandleFilterReal",c=g.split(".");if(c.length>1){var f=function(){a:;inplview.HandleFilterReal(e,b,d)};EnsureScript(c[0],a,f)}return}_SubmitFormPost(b)}function _SubmitFormPost(a,d,c){if(typeof MSOWebPartPageFormName!="undefined"){var b=document.forms[MSOWebPartPageFormName];if(null!=b)if(d!=undefined&&d==true||typeof b.onsubmit=="undefined"||b.onsubmit==null||b.onsubmit()!=false){typeof window.WebForm_OnSubmit=="function"&&window.WebForm_OnSubmit();if(ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))!=null)a+=a.indexOf("?")==-1?"?IsDlg=1":"&IsDlg=1";if(FV4UI())try{var e=SP.Ribbon.PageManager.get_instance().get_ribbon().get_selectedTabId();if(Boolean(e)){a=StURLSetVar2(a,"InitialTabId",escapeProperly(e));a=StURLSetVar2(a,"VisibilityContext","WSSTabPersistence")}}catch(f){}if(c!=undefined&&c==true){a=DemoteIntoFormBody(b,a,"owsfileref");a=DemoteIntoFormBody(b,a,"NextUsing")}b.action=STSPageUrlValidation(a);b.method="POST";if(isPortalTemplatePage(a))b.target="_top";!bValidSearchTerm&&_ClearSearchTerm("");b.submit()}}}function DemoteIntoFormBody(e,c,b){var d=GetUrlKeyValue(b,false,c);if(d.length>0){var a=document.createElement("INPUT");if(a!=null){a.setAttribute("type","hidden");a.setAttribute("id",b);a.setAttribute("name",b);a.setAttribute("value",d);e.appendChild(a);return RemoveUrlKeyValue(b,c)}}return c}function RemoveUrlKeyValue(c,a){var b=new RegExp(c+"=[^&]*&");a=a.replace(b,"");b=new RegExp(c+"=[^&]*");a=a.replace(b,"");return a}function _RefreshPageTo(b,c,a){EnsureScript("inplview",typeof inplview,null,true);inplview.RefreshPageTo(b,c,a)}var g_varSkipRefreshOnFocus;function RefreshOnFocus(){a:;(typeof g_varSkipRefreshOnFocus=="undefined"||!Boolean(g_varSkipRefreshOnFocus))&&_RefreshPage(1)}function RefreshOnFocusForOneRow(){a:;RefreshOnFocus()}function DisableRefreshOnFocus(){a:;g_varSkipRefreshOnFocus=1}function SetWindowRefreshOnFocus(){a:;window.onbeforeunload=DisableRefreshOnFocus;window.onfocus=RefreshOnFocus}function RemoveParametersFromUrl(a){var b=a.indexOf("?");return b==-1?a:a.substr(0,b)}function _GoToPageRelative(a){if(a.substr(0,4)!="http"&&a.substr(0,1)!="/"){var b=RemoveParametersFromUrl(window.location.href),c=b.lastIndexOf("/");if(c>0)a=b.substring(0,c+1)+a}GoToPage(a)}function _EnterFolder(c){var b=RemoveParametersFromUrl(window.location.href),a=RemoveParametersFromUrl(c),d=a!=null&&a.length>0&&a.charAt(0)=="/"&&a.length<b.length&&b.indexOf(a)==b.length-a.length;if(!d&&a.toLowerCase()!=b.toLowerCase())STSNavigate(c);else _SubmitFormPost(c)}function _HandleFolder(f,e,s,l,h,k,c,n,d,a,b,o,p,m,j,r){var q=Boolean(a)&&a!="",i=Boolean(b)&&b!="",g=!IsNullOrUndefined(f.getAttribute("isEdit"));if(q&&i||a=="OneNote.Notebook"&&g){if(c=="FALSE"&&f!=null&&g&&!IsNullOrUndefined(d))c=d;DispEx(f,e,l,h,k,c,n,d,a,b,o,p,m,j,r)}else{e!=null&&CancelEvent(e);_EnterFolder(s)}}function UseDialogsForNewItem(a){var b=GetCtxFromFormUrl(a),d=new URI(a),c=d.getQueryParameter("Type");return Boolean(b)&&c=="1"}var g_useDialogAlwaysList;function UseDialogsForFormsPages(b){if(Boolean(b)){var d=new URI(b),a=d.getLastPathSegment();if(Boolean(a)){a=a.toLowerCase();for(var c=0;c<g_useDialogAlwaysList.length;c++)if(a==g_useDialogAlwaysList[c])return true}}return UseDialogsForFormsWithCtx(GetCtxFromFormUrl(b))}function GetCtxFromFormUrl(c){var d=null,a=GetUrlKeyValue("LISTID",false,c.toUpperCase());if(a=="")a=GetUrlKeyValue("LIST",false,c.toUpperCase());if(a!=""&&g_ctxDict!=null)for(var e in g_ctxDict){var b=g_ctxDict[e];if(Boolean(b.listName)&&b.listName.toUpperCase()==a.toUpperCase()){d=b;break}}return d}function UseDialogsForFormsWithCtx(a){return a==null||typeof a.NavigateForFormsPages=="undefined"?false:!Boolean(a.NavigateForFormsPages)}function _EditItemWithCheckoutAlert(c,a,b,d,g,h,f,e){if(CheckoutAlertBeforeNavigate(a,b,d,g,h,f,e))if(b=="1"&&UseDialogsForFormsPages(a))NewOrEditV4Core(c,a,true);else _EditItem2(c,a)}function _STSNavigateWithCheckoutAlert(a,g,b,e,f,d,c){CheckoutAlertBeforeNavigate(a,g,b,e,f,d,c)&&STSNavigate(a)}function ShowInPopUI(b,a,c){var d=function(){a:;if(a==null&&typeof b.fromRibbon=="boolean"&&b.fromRibbon&&typeof b.currentCtx!="undefined"&&b.currentCtx!=null)a=b.currentCtx;if(typeof a!="undefined"&&a!=null&&a.clvp!=null){var d=a.clvp;GetFocusInfo(b,d);d.ShowPopup(c)}else STSNavigate(c)};EnsureScript("inplview",typeof inplview,d)}function CheckoutAlertBeforeNavigate(g,f,d,c,e,a,b){if(typeof a=="undefined"||a==null||a=="")a=currentItemCheckedOutUserId;if((typeof b=="undefined"||b==null||b=="")&&typeof ctx!="undefined")b=ctx.CurrentUserId;if(d=="1"){alert(Strings.STS.L_CannotEditPropertyForLocalCopy_Text);return false}if(a!=null&&a!=""&&b!=null&&a!=b){alert(Strings.STS.L_CannotEditPropertyCheckout_Text);return false}if(f=="1")if(confirm(Strings.STS.L_ConfirmCheckout_Text)){if(c.charAt(0)=="/"||c.substr(0,3).toLowerCase()=="%2f")c=window.location.protocol+"//"+window.location.host+c;return CheckoutviaXmlhttp(e,c)}else return false;return true}function CheckoutviaXmlhttp(c,b){var a,e;a=new XMLHttpRequest;if(a==null)return false;a.open("POST",c+"/_vti_bin/lists.asmx",false);a.setRequestHeader("Content-Type","text/xml; charset=utf-8");a.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/CheckOutFile");var d='<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><CheckOutFile xmlns="http://schemas.microsoft.com/sharepoint/soap/"><pageUrl>'+b+"</pageUrl></CheckOutFile></soap:Body></soap:Envelope>";a.send(d);return a.status==200&&a.responseText.indexOf("true")!=0}function FSupportCheckoutToLocal(a){var c=true;if(a==null||a=="")return false;a=a.toLowerCase();for(var b=0,b=0;b<g_ExtensionNotSupportCheckoutToLocal.length;b++)if(a==g_ExtensionNotSupportCheckoutToLocal[b])return false;return true}function FDefaultOpenForReadOnly(a){var c=false;if(a==null||a=="")return true;a=a.toLowerCase();for(var b=0,b=0;b<g_ExtensionDefaultForRead.length;b++)if(a==g_ExtensionDefaultForRead[b])return true;return false}function CheckoutDocument(g,a,e){var b=null,c=true,d=false;if(a.charAt(0)=="/"||a.substr(0,3).toLowerCase()=="%2f")a=window.location.protocol+"//"+window.location.host+a;var f=SzExtension(unescapeProperly(a));if(FSupportCheckoutToLocal(f)&&e=="SharePoint.OpenDocuments.3")b=StsOpenEnsureEx2(e);if(b!=null&&!browseris.chrome)try{c=typeof b.CheckoutDocumentPrompt!="undefined"&&b.CheckoutDocumentPrompt(unescapeProperly(a),false,"");c&&RefreshOnFocus();d=c;if(d||!(IsSupportedMacBrowser()||IsSupportedFirefoxOnWin()))return c}catch(i){}if(!d){var h="FileName="+escapeProperly(unescapeProperly(a))+"&Checkout=true";NavigateToCheckinAspx(g,h)}return true}function NewOrEditV4Core(a,b,c){var d=function(){a:;var b=CLVPFromEventReal(a);GetFocusInfo(a,b)};a!=null&&EnsureScript("inplview",typeof InitAllClvps,d);if(c)_OpenPopUpPage(b,RefreshOnDialogClose);else _OpenPopUpPage(b,RefreshPage);return false}function _NewItem2(b,a){if(UseDialogsForNewItem(a)||UseDialogsForFormsPages(a))return NewOrEditV4Core(b,a);else{_NewItem(a);return undefined}}function _NewItem(a){GoToPage(a)}function _EditItem2(b,a){if(UseDialogsForFormsPages(a))return NewOrEditV4Core(b,a);_EditItem(a);return false}function _EditItem(a){GoToPage(a)}function _CorrectUrlForRefreshPageSubmitForm(){a:;var b=window.location.href;if(typeof g_MinimalDownload!="undefined"&&g_MinimalDownload){var d=ajaxNavigate.getSavedFormAction();if(d!=null&&d.length>0)b=d}var a=ajaxNavigate.getParam("ServerFilter");if(typeof a!="undefined"&&null!=a&&a.length>0){a=a.replace(/-/g,"&").replace(/&&/g,"-");var f=GetUrlKeyValue("RootFolder",true,a),e=GetUrlKeyValue("RootFolder",true);if(""==f&&""!=e)a+="&RootFolder="+e;var c=new URI(b,{disableEncodingDecodingForLegacyCode:true});c.setFragment("");c.setQuery(a);return c.getString()}return b}function _RefreshPage(a){var b=function(){a:;SetFocusBack(a)};if(a==1)_SubmitFormPost(_CorrectUrlForRefreshPageSubmitForm());else EnsureScript("inplview",typeof InitAllClvps,b)}function AJAXRefreshView(a,c){a:;if(a==null||!(typeof a.fakeEvent=="boolean"&&a.fakeEvent||typeof a.csrAjaxRefresh=="boolean"&&a.csrAjaxRefresh||typeof a.fromRibbon=="boolean"&&a.fromRibbon))_RefreshPage(c);else if(c==SP.UI.DialogResult.OK){var b;try{b=typeof inplview.HandleRefreshView}catch(g){b="undefined"}var f="inplview.HandleRefreshView",d=f.split(".");if(d.length>1){var e=function(){a:;inplview.HandleRefreshView(a)};EnsureScript(d[0],b,e)}}}function AJAXRefreshViewOnDialogClose(a){a:;AJAXRefreshView(a,SP.UI.DialogResult.OK)}function RefreshOnDialogClose(){a:;_RefreshPage(SP.UI.DialogResult.OK)}function OpenPopUpPageWithDialogOptions(c){var d=function(){a:;var a=SP.UI.ModalDialog.showModalDialog(c)},b;try{b=typeof SP.UI.ModalDialog.showModalDialog}catch(e){b="undefined"}EnsureScript("SP.UI.Dialog.js",b,d);var a=window.event;if(a!=null)if(a.stopPropagation!=null)a.stopPropagation();else a.cancelBubble=true}function OpenPopUpPageWithTitle(f,a,d,b,c){var e={url:f,args:null,title:c,dialogReturnValueCallback:a,width:d,height:b};OpenPopUpPageWithDialogOptions(e)}function SetupAndOpenDialogForCustomAction(a,j,g,i){if(typeof a=="undefined"||a==null||a.length==0)return;var d=a.indexOf("//",0),b=-1;if(d==-1)b=a.indexOf("/",0);else b=a.indexOf("/",d+2);var h="";if(b==-1)b=a.length-1;h=a.substring(0,b);var f={url:a,args:null,title:i,dialogReturnValueCallback:CustomActionDialogCloseCallback,width:j,height:g},k=EnsureScriptParams("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",f),e=g_CustomActionDialogHandlerId,c=function(a){if(typeof a.data=="undefined"||typeof a.data==null||a.data!="CloseCustomActionDialogRefresh"&&a.data!="CloseCustomActionDialogNoRefresh")return;if(typeof a.origin=="undefined"||typeof a.origin==null)return;var c=function(){a:;var b=SP.UI.ModalDialog.get_childDialog();if(a.data=="CloseCustomActionDialogRefresh")b.close(0);else b.close(1)},b;try{b=typeof SP.UI.ModalDialog.get_childDialog}catch(a){b="undefined"}EnsureScript("SP.UI.Dialog.js",b,c);a.data=="CloseCustomActionDialogNoRefresh"&&RemoveCustomActionDialogPostMessageHandler(e)};g_CustomActionDialogHandlers[g_CustomActionDialogHandlerId]=c;g_CustomActionDialogHandlerId++;if(typeof window.addEventListener!="undefined")window.addEventListener("message",c,false);else typeof window.attachEvent!="undefined"&&window.attachEvent("onmessage",c)}function CustomActionDialogCloseCallback(a){a:;a==0&&RefreshOnDialogClose()}function RemoveCustomActionDialogPostMessageHandler(b){var a=g_CustomActionDialogHandlers[b];if(typeof a=="function"){if(typeof window.removeEventListener!="undefined"&&typeof window.removeEventListener!=null)window.removeEventListener("message",a,false);else typeof window.detachEvent!="undefined"&&typeof window.detachEvent!=null&&window.detachEvent("onmessage",a);delete g_CustomActionDialogHandlers[b]}}function _OpenPopUpPage(d,a,c,b){OpenPopUpPageWithTitle(d,a,c,b,null)}function _RemoveQueryStringsAndHash(a){if(Boolean(a)){var b=a.indexOf("#");if(b>=0)a=a.substr(0,b);b=a.indexOf("?");if(b>=0)a=a.substr(0,b)}return a}function _OpenCreateWebPageDialog(a){if(!Boolean(a)&&typeof _spPageContextInfo!="undefined"&&_spPageContextInfo.webServerRelativeUrl!=null){a=_spPageContextInfo.webServerRelativeUrl;if(a.charAt(a.length-1)!="/")a=a+"/";a=a+"_layouts/15/createwebpage.aspx"}var b=ajaxNavigate.get_href();b=_RemoveQueryStringsAndHash(b);a=StURLSetVar2(a,"Url",escapeProperly(b));if(FV4UI()){var c={};commonModalDialogOpen(a,c,null,null)}else GoToPage(a)}function _EditLink2(a,b){var c=function(){a:;var d=GetGotoLinkUrl(a);if(d==null)return false;var c=window["ctx"+String(b)];if(c!=null&&c.clvp!=null&&UseDialogsForFormsWithCtx(c)){var e=c.clvp;PreventDefaultNavigation();e.ShowPopup(d);return false}GoToLinkOrDialogNewWindow(a);return false};EnsureScript("inplview",typeof inplview,c)}function EditLink(a,b){if(FV4UI())EditLink2(a,b);else GoToLink(a)}function _GoBack(a){window.location.href=unescapeProperly(GetSource(a))}function _ReplyItem(a,b,d,c){if(b.length>=504)alert(Strings.STS.L_ReplyLimitMsg_Text);else{a+="?Threading="+b;a+="&Guid="+d;a+="&Subject="+c;GoToPage(a)}}function GoBacktoCurrentIssue(a,b){a+="?ID="+b;GoToPage(a)}function _ExportToDatabase(c,d,e,b){if(g_expDatabase==null){var a=GetCookie("databaseBtnText");if(a!=null&&a!="0")try{g_expDatabase=new ActiveXObject("SharePoint.ExportDatabase")}catch(f){return}else if(a==null)GetDataBaseInstalled();else return}if(g_expDatabase!=null&&typeof g_expDatabase.DoExport!="undefined")if(browseris.ie5up&&browseris.win32)try{g_expDatabase.SiteUrl=makeAbsUrl(c);g_expDatabase.ListID=d;g_expDatabase.ViewID=e;g_expDatabase.DoExport(b)}catch(f){alert(Strings.STS.L_ExportDBFail_Text);return}else alert(Strings.STS.L_NoWSSClient_Text)}function _ExportList(a){var b=typeof navigator.msProtocols=="function"&&navigator.msProtocols.excel;!b&&g_ssImporterObj==null&&EnsureSSImporter();if(!b&&g_ssImporterObj==null)(g_fSSImporter||GetCookie("EnsureSSImporter")==null)&&EnsureSSImporter(true);if(IsSupportedMacBrowser()){if(g_fSSImporter!=null&&typeof g_ssImporterObj.IqyExportEnabled!="undefined"&&g_ssImporterObj.IqyExportEnabled&&typeof g_ssImporterObj.IqyExport!="undefined"){var c=g_ssImporterObj.IqyExport(makeAbsUrl(a));if(!c)window.location.href=STSPageUrlValidation(makeAbsUrl(a))}else if(confirm(Strings.STS.L_ExportListSpreadsheet_Text))window.location.href=STSPageUrlValidation(makeAbsUrl(a))}else if(b||g_fSSImporter!=false&&typeof g_ssImporterObj.IqyImportEnabled!="undefined"&&g_ssImporterObj.IqyImportEnabled()||confirm(Strings.STS.L_ExportListSpreadsheet_Text))window.location.href=STSPageUrlValidation(makeAbsUrl(a))}function ExportDiagram(l,e,k,f,h,g){if(g_objDiagramLaunch==null){var a=GetCookie("digInstalled");if(a!=null&&a!="0")try{g_objDiagramLaunch=new ActiveXObject("DiagramLaunch.DiagramLauncher")}catch(m){return}else if(a==null)GetDiagramLaunchInstalled();else return}if(g_objDiagramLaunch!=null&&typeof g_objDiagramLaunch.CreateDiagram!="undefined")try{var c="",i=l,d=g,b=e,j=k;g_objDiagramLaunch.CreateDiagram(c,i,d,b,f,h,j)}catch(m){alert(Strings.STS.L_DiagramLaunchFail_Text)}}function OpenTasks(g,a,f,b,e,d){var c="ms-project:ost|u|"+g+"|l|"+a+"|i|"+f+"|n|"+b+"|v|"+e+"|g|"+d;window.location.href=c}function CatchListCreateError(){alert(Strings.STS.L_EditInGrid_Text);fListErrorShown=true;return false}function RegisterTouchOverride(a,b){if(a.getAttribute("hasTouchHandler")!="true")if(window.navigator.msMaxTouchPoints!=null&&window.navigator.msMaxTouchPoints>0){AttachEvent("MSPointerDown",function(a){a.target.setAttribute("pointerType",a.pointerType.toString())},a);a.setAttribute("hasTouchHandler","true")}else if(document.documentElement!=null&&"ontouchstart"in document.documentElement){AttachEvent("touchstart",function(a){if(b(a)){a.preventDefault!=null&&a.preventDefault();a.stopPropagation!=null&&a.stopPropagation()}},a);a.setAttribute("hasTouchHandler","true")}}function EnsureListControl(){a:;if(!fListControl){fListErrorShown=false;if(browseris.ie5up&&browseris.win32){var b='try{    ListCtrlObj = new ActiveXObject("ListNet.ListNet");    if (ListCtrlObj)        fListControl = true;} catch (e){    fListControl = false;};',a=new Function(b);a()}else{window.onerror=CatchListCreateError;ListCtrlObj=new ActiveXObject("ListNet.ListNet");if(ListCtrlObj!=null)fListControl=true}}ListCtrlObj=null;return fListControl}function IsVoteOK(a){if(1==a)alert(Strings.STS.L_NoQuestion_Text);else if(2==a)alert(Strings.STS.L_NoVoteAllowed_Text);else return true;return false}function hasHighChar(b){for(var a=0,a=0;a<b.length;a++)if(b.charCodeAt(a)>127)return true;return false}function _ClearSearchTerm(a){if(typeof MSOWebPartPageFormName!="undefined"){var c=document.forms[MSOWebPartPageFormName];if(null!=c)if(a!=null){var b=c["SearchString"+a];if(b!=null)b.value=""}}bValidSearchTerm=true}function _SubmitSearchRedirect(b){var a=document.forms.frmSiteSearch;if(a==null)if(typeof MSOWebPartPageFormName!="undefined")a=document.forms[MSOWebPartPageFormName];if(a!=null){var e;if(typeof a.elements.SearchString!="undefined")e=a.elements.SearchString;var c=e.value.trim();if(c===Strings.STS.L_SharepointSearch_Text||c==="")return false;b=b+"?k="+escapeProperly(c);var f=a.elements.SearchScope;if(f!=null){var d=f.value;if(Boolean(d))b=b+"&u="+escapeProperly(d)}window.location.href=b}return false}function ShowGridUrlInHTML(a){if(a.indexOf("?")>0)a=a+"&";else a=a+"?";a=a+"ShowInGrid=HTML";return a}function SearchOnBodyLoad(){a:;var a=document.getElementById("idSearchString");if(a!=null&&(a.value.trim()===Strings.STS.L_SharepointSearch_Text||a.value.trim()===""))a.className="ms-sharepointsearchtext"}function SearchOnBlur(){a:;var a=document.getElementById("idSearchString");if(a!=null&&a.value.trim()===""){a.value=Strings.STS.L_SharepointSearch_Text;a.className="ms-sharepointsearchtext"}}function SearchOnFocus(){a:;var a=document.getElementById("idSearchString");if(a!=null&&a.value.trim()===Strings.STS.L_SharepointSearch_Text){a.value="";a.className="ms-searchtext"}}function SubmitSearch(){a:;_SubmitSearchForView("")}function _SubmitSearchForView(e){var a=document.forms[0],c="SearchString"+e,d=a.elements[c].value;if(""==d){alert(Strings.STS.L_Enter_Text);a.elements[c].focus()}else{var b;b=RemovePagingArgs(a.action);if(typeof bGridViewPresent!="undefined"&&bGridViewPresent)b=ShowGridUrlInHTML(b);a.action=b;a.submit()}}function IsKeyDownSubmit(a){if(a!=null){var c,b;if(browseris.ie){c=a.keyCode;b=Number(a.altKey||a.ctrlKey)}else{c=a.which;b=typeof a.modifers!="undefined"&&typeof a.ALT_MASK!="undefined"&&typeof a.CONTROL_MASK!="undefined"?a.modifers&(a.ALT_MASK|a.CONTROL_MASK):0}if(c==13&&!Boolean(b))return true}return false}function SearchViewKeyDown(a){IsKeyDownSubmit(event)&&_SubmitSearchForView(a)}function SearchKeyDown(b,a){if(IsKeyDownSubmit(b)){_SubmitSearchRedirect(a);return false}return true}function SearchKeyDownGoSearch(a){if(IsKeyDownSubmit(a)){typeof GoSearch!="undefined"&&GoSearch();return false}return true}function _AlertAndSetFocus(b,a){a.focus();a.select();window.alert(b)}function _AlertAndSetFocusForDropdown(b,a){a.focus();window.alert(b)}function setElementValue(c,b){var a=document.getElementsByName(c)[0];if(a==null)return false;a.value=b;return true}function GetMultipleSelectedText(a){var c="";if(a!=null)for(var e=a.options.length,d=true,b=0;b<e;b++)if(a.options[b].selected){if(!d)c+=",";else d=false;c+=a.options[b].text}return c}function GetCBSelectedValues(c){if(c==null)return null;for(var a="",e=true,f=c.elements.length,d=0;d<f;d++){var b=c.elements[d];if(b.type=="checkbox"&&!b.disabled)if(b.checked){if(a!="")a+=",";a+=b.value}else e=false}return new CBSelectedValues(a,e)}function editDocumentWithProgID(a,b){if(fNewDoc){if(a.charAt(0)=="/"||a.substr(0,3).toLowerCase()=="%2f")a=window.location.protocol+"//"+window.location.host+a;if(!fNewDoc2&&!fNewDoc3)(typeof EditDocumentButton.EditDocument=="undefined"||!EditDocumentButton.EditDocument(a,b))&&alert(Strings.STS.L_EditDocumentRuntimeError_Text);else(typeof EditDocumentButton.EditDocument2=="undefined"||!EditDocumentButton.EditDocument2(window,a,b))&&alert(Strings.STS.L_EditDocumentRuntimeError_Text)}else alert(Strings.STS.L_EditDocumentProgIDError_Text)}function GetSPDDownLoadUrl(){a:;var a=typeof navigator.userLanguage=="string"?navigator.userLanguage:null;if(!Boolean(a))a=navigator.browserLanguage;return SPDesignerDownloadUrl+"?clid="+a}function PHSucceed(b,a){a:;phManager.SetProtocolHandlerEnabled(b,a)}function _EditInSPD(a,e){var b=GetSPDDownLoadUrl();if(a.charAt(0)=="/")a=window.location.protocol+"//"+window.location.host+a;var c=ajaxNavigate.convertMDSURLtoRegularURL(a);if(phManager.ShouldTryProtocolHandler("ms-spd")){navigator.msLaunchUri(phManager.CreateProtocolHandlerUrl("ms-spd",c,ProtocolCommand.Edit,null),function(){a:;PHSucceed("ms-spd",true)},function(){a:;PHSucceed("ms-spd",false);d()});return}d();function d(){a:;if(phManager.IsProtocolHandlerEnabled("ms-spd")){window.location.href=phManager.CreateProtocolHandlerUrl("ms-spd",unescapeProperly(c),ProtocolCommand.Edit,null);return}var d=StsOpenEnsureEx2("SharePoint.OpenDocuments.3");if(d!=null&&typeof d.EditDocument3!="undefined"){if(!d.EditDocument3(window,a,false,SPDesignerProgID))window.open(b);else if(e)window.onfocus=RefreshOnNextFocus}else window.open(b)}}function editDocumentWithProgID2(e,a,h,g,f,b,i){editDocumentWithProgIDNoUI(e,a,h,g,f,b,i,c,d);function c(){a:;if(a==SPDesignerProgID){var b=GetSPDDownLoadUrl();window.open(b)}else alert(Strings.STS.L_EditDocumentRuntimeError_Text);window.onfocus=RefreshOnNextFocus}function d(){a:;alert(Strings.STS.L_EditDocumentProgIDError_Text)}}function editDocumentWithProgIDNoUI(a,d,e,h,n,l,c,i,j){var b,f=false;e=e.replace(/(?:\.\d+)$/,"");if(a.charAt(0)=="/"||a.substr(0,3).toLowerCase()=="%2f")a=window.location.protocol+"//"+window.location.host+a;var m=SzExtension(unescapeProperly(a));if(phManager.ShouldTryProtocolHandler(c)){navigator.msLaunchUri(phManager.CreateProtocolHandlerUrl(c,a,ProtocolCommand.Edit,null),function(){a:;PHSucceed(c,true)},function(){a:;PHSucceed(c,false);g()});return}g();function g(){a:;var a=k();if(a==1&&i!=null)i();else a==2&&j!=null&&j()}function k(){a:;if(!IsNullOrUndefined(c)&&c!=""&&phManager.IsProtocolHandlerEnabled(c)){window.location.href=phManager.CreateProtocolHandlerUrl(c,a,ProtocolCommand.Edit,null);return 0}if(FSupportCheckoutToLocal(m))try{b=StsOpenEnsureEx2(e+".3");if(b!=null){if(h=="1"){if(typeof b.CheckoutDocumentPrompt=="undefined")return 1;if(!b.CheckoutDocumentPrompt(a,true,d))return 1}else{if(l=="1")f=true;if(!b.EditDocument3(window,a,f,d))return 1}var g=false;g=b.PromptedOnLastOpen();if(g)window.onfocus=RefreshOnNextFocus;else SetWindowRefreshOnFocus();return 0}}catch(i){}if(h=="1")if(confirm(Strings.STS.L_ConfirmCheckout_Text))NavigateToCheckinAspx(n,"FileName="+escapeProperly(unescapeProperly(a))+"&Checkout=true");else return 0;b=StsOpenEnsureEx2(e);if(b!=null){try{if(!b.EditDocument2(window,a,d))return 1;if(e=="SharePoint.OpenXMLDocuments")SetWindowRefreshOnFocus();else window.onfocus=RefreshOnNextFocus;return 0}catch(i){}try{window.onfocus=null;if(SzExtension(a)=="ppt"&&d=="")d="PowerPoint.Slide";if(!b.EditDocument(a,d))return 1;SetWindowRefreshOnFocus();return 0}catch(i){return 2}}return 1}}function RefreshOnNextFocus(){a:;SetWindowRefreshOnFocus()}function createNewDocumentWithProgID2Ex(g,b,a,d,c,e,f){createNewDocumentWithProgID2(b,a,d,c,e,f)}function createNewDocumentWithProgID2(b,a,f,e,c,d){createNewDocumentWithProgIDCore(b,a,f,c,false,d,function(){a:;createNewDocumentWithProgIDCore(b,a,e,c,true,d)})}function createNewDocumentWithProgIDEx(f,b,a,c,d,e){createNewDocumentWithProgID(b,a,c,d,e)}function createNewDocumentWithProgID(b,a,c,d,e){createNewDocumentWithProgIDCore(b,a,c,d,true,e)}function createNewDocumentWithProgIDCore(e,d,i,m,l,b,j){var a,c,f,g=false;if(phManager.ShouldTryProtocolHandler(b)){navigator.msLaunchUri(phManager.CreateProtocolHandlerUrl(b,e,ProtocolCommand.New,d),function(){a:;PHSucceed(b,true)},function(){a:;PHSucceed(b,false);h()});return}h();function h(){a:;!k()&&j!=null&&j()}function k(){a:;if(Boolean(b)&&phManager.IsProtocolHandlerEnabled(b)){window.location.href=phManager.CreateProtocolHandlerUrl(b,e,ProtocolCommand.New,d);return true}if(m){c=Strings.STS.L_NewFormLibTb1_Text;f=Strings.STS.L_NewFormLibTb2_Text}else{c=Strings.STS.L_NewDocLibTb1_Text;f=Strings.STS.L_NewDocLibTb2_Text}try{a=StsOpenEnsureEx2(i+".2");(typeof a.CreateNewDocument2=="undefined"||!a.CreateNewDocument2(window,e,d))&&alert(c);g=typeof a.PromptedOnLastOpen!="undefined"&&a.PromptedOnLastOpen();if(g)window.onfocus=RefreshOnNextFocus;else SetWindowRefreshOnFocus();return true}catch(h){}try{a=StsOpenEnsureEx2(i+".1");window.onfocus=null;(typeof a.CreateNewDocument=="undefined"||!a.CreateNewDocument(e,d))&&alert(c);SetWindowRefreshOnFocus();return true}catch(h){l&&alert(f)}return undefined}}function createNewDocumentWithRedirect2(i,d,b,e,f,c,h,a,g){createNewDocumentWithRedirect(d,b,e,f,c,h,a,g)}function createNewDocumentWithRedirect(f,b,a,g,e,h,d,c){if(h)if(IsClientAppInstalled(a,c,null))createNewInClient(f,b,a,g,c);else createNewInBrowser(e,b,a,d);else if(IsClientAppInstalled(a,c,null)&&d!=1)createNewInClient(f,b,a,g,c);else createNewInBrowser(e,b,a,d)}function createNewInClient(c,b,d,e,f){var a=d.replace(/(?:\.\d+)$/,"");createNewDocumentWithProgID(c,b,a,e,f)}function createNewInBrowser(a,f,g,e){a=a+"&SaveLocation="+makeAbsUrl(escapeProperly(f));a=AddInfoPathParametersToUrl(a,g,null,e);a=AddSourceToUrl(a);var d=new URI(a),b=false;if(Boolean(d)){var c=d.getPath(true);if(Boolean(c)&&c.toLowerCase().indexOf("createnewdocument.aspx")!=-1)b=true}if(b)_OpenPopUpPage(a,OnCloseDialogNavigate);else STSNavigate(a)}function OnCloseDialogNavigate(b,a){a:;b==SP.UI.DialogResult.OK&&Boolean(a)&&STSNavigate(a)}function LRUCache(){a:;this.state=[];this.ageStack=[];this.count=0}function LRUCache_InitializePrototype(){a:;LRUCache.prototype.state=[];LRUCache.prototype.ageStack=[];LRUCache.prototype.count=0}function LRUCache_Add(a,b){if(a==null)return;var c=a.state[b];if(c!=null)a.ageStack[c]=null;else a.count++;var d=a.ageStack.length;a.state[b]=d;a.ageStack.push(b)}function LRUCache_Remove(a,b){if(a==null)return;var c=a.state[b];if(c!=null){a.ageStack[c]=null;a.state[b]=null;a.count--}}function _AddGroupToCookie(c){var a=ExpGroupFetchWebPartID(c);if(a==null)return;LRUCache_Add(g_ExpGroupWPState,a);if(g_ExpGroupTable[a]==null)g_ExpGroupTable[a]=new LRUCache;var b=ExpGroupFetchGroupString(c);if(b==null)return;LRUCache_Add(g_ExpGroupTable[a],b);ExpGroupRenderCookie()}function _RemoveGroupFromCookie(d){var a=ExpGroupFetchWebPartID(d);if(a==null)return;if(g_ExpGroupTable[a]==null)return;LRUCache_Add(g_ExpGroupWPState,a);var c=ExpGroupFetchGroupString(d);if(c==null)return;var b;for(b in g_ExpGroupTable[a].state)g_ExpGroupTable[a].state[b]!=null&&b.substring(0,c.length)==c&&LRUCache_Remove(g_ExpGroupTable[a],b);ExpGroupRenderCookie()}function ExpGroupRenderCookie(){a:;if(g_ExpGroupWPState==null)return;for(var c=ExpGroupWPListName+"=",a=0,d=g_ExpGroupWPState.ageStack.length-1;d>=0;d--)if(g_ExpGroupWPState.ageStack[d]!=null){var b=g_ExpGroupWPState.ageStack[d];if(a==ExpGroupMaxWP){DeleteCookie(ExpGroupCookiePrefix+b);break}else if(g_ExpGroupTable[b]==null){a++;if(a>1)c+=escapeProperly(ExpGroupCookieDelimiter);c+=escapeProperly(b)}else if(g_ExpGroupTable[b].count==0)DeleteCookie(ExpGroupCookiePrefix+b);else if(a<ExpGroupMaxWP){a++;ExpGroupRenderCookieForWebPart(b);if(a>1)c+=escapeProperly(ExpGroupCookieDelimiter);c+=escapeProperly(b)}}if(a==0)DeleteCookie(ExpGroupWPListName);else document.cookie=c}function ExpGroupRenderCookieForWebPart(a){if(!g_ExpGroupTable[a].ageStack)return;for(var d=ExpGroupCookiePrefix+a+"=",e=true,c=g_ExpGroupTable[a].ageStack.length-1;c>=0;c--)if(g_ExpGroupTable[a].ageStack[c]!=null){var f=g_ExpGroupTable[a].ageStack[c],b="";if(!e)b+=escapeProperly(ExpGroupCookieDelimiter);b+=escapeProperly(f);if(d.length+b.length<=ExpGroupMaxCookieLength){d+=b;e=false}}document.cookie=d+";"}function ExpDataViewGroupOnPageLoad(){a:;ExpGroupOnPageLoad("PageLoad")}function ExpGroupOnPageLoad(a){var b=document.getElementById("GroupByColFlag");if(b!=null){g_ExpGroupNeedsState=true;ExpGroupParseCookie(a)}}function ExpGroupParseCookie(a){var d=GetCookie(ExpGroupWPListName);if(d==null)return;g_ExpGroupParseStage=true;for(var e=d.split(ExpGroupCookieDelimiter),c=e.length-1;c>=0;c--){var b=e[c];LRUCache_Add(g_ExpGroupWPState,b);if(g_ExpGroupTable[b]==null)document.getElementById("GroupByCol"+b)!=null&&ExpGroupParseCookieForWebPart(b,a)}g_ExpGroupParseStage=false;if(Boolean(a)&&g_ExpGroupXSLTQueue.length>0)ExpGroupFetchData(g_ExpGroupXSLTQueue.shift(),a);else!Boolean(a)&&g_ExpGroupCAMLQueue.length>0&&ExpGroupFetchData(g_ExpGroupCAMLQueue.shift(),a)}function ExpGroupParseCookieForWebPart(c,f){var n=GetCookie(ExpGroupCookiePrefix+c);if(n==null)return;var o=n.split(ExpGroupCookieDelimiter),e,b;g_ExpGroupTable[c]=new LRUCache;for(b=o.length-1;b>=0;b--){e=o[b];LRUCache_Add(g_ExpGroupTable[c],e)}var d=[],q=document.getElementById("GroupByCol"+c).parentNode,j=q.getElementsByTagName("TBODY");for(b=0;b<j.length;b++){e=j[b].getAttribute("groupString");if(e!=null){var k=j[b].id;if(k==null)continue;var a=k.substring(4,k.length),s=a.substring(0,a.indexOf("-")),m=g_ctxDict["ctx"+s];if(m==null||!m.isXslView&&Boolean(f)||m.isXslView&&!Boolean(f)){g_ExpGroupTable[c]=null;break}if(g_ExpGroupTable[c].state[e]!=null&&d[a]==null){ExpCollGroup(a,"img_"+a,f);d[a]=true;var p=document.getElementById("tbod"+a+"_");if(p!=null){var r=p.getAttribute("isLoaded");if(r=="false")if(Boolean(f))g_ExpGroupXSLTQueue.push(a);else g_ExpGroupCAMLQueue.push(a)}}}}var g;for(g in d){var l=g.indexOf("_");if(l!=g.length-1&&l!=-1){var h=g.substring(0,l+1);if(d[h]==null){var i=ExpGroupFetchGroupString(h);if(i!=null){LRUCache_Add(g_ExpGroupWPState,i);ExpCollGroup(h,"img_"+h,f);d[i]=true}}}}}function _ExpGroupBy(s){if(browseris.w3c&&!browseris.ie)document.all=document.getElementsByTagName("*");var j=document.all,o=j.length,u=s.getElementsByTagName("IMG"),e=u[0],l=e.getAttribute("src"),x=l.lastIndexOf("/"),k=l.slice(x+1),h=GetThemedImageUrl("commentexpand12.png"),r=GetThemedImageUrl("commentcollapse12.png"),f="auto";if(l==h||k=="plus.gif"){f="";if(k=="plus.gif")e.src="/_layouts/15/images/minus.gif";else e.src=h}else{f="none";if(k=="minus.gif")e.src="/_layouts/15/images/plus.gif";else e.src=GetThemedImageUrl("commentcollapse12.png")}var t=e.name;e.name=e.alt;e.alt=t;var c=e;while(c!=null){c=c.parentNode;if(c!=null&&c.id!=null&&c.id.length>5&&c.id.substr(0,5)=="group")break}var b=c;while(b!=null){b=b.parentNode;if(b!=null&&b.tagName=="TABLE")break}var d=null;if(b!=null){d=b.lastChild;if(d!=null&&d.tagName=="TBODY")d=d.lastChild;if(d!=null&&d.tagName=="TR"&&d.lastChild!=null)d=d.lastChild}for(var a,g=0;g<o;g++){a=j[g];if(a==c)break}for(var q=c.id.slice(5),w=parseInt(q),i=f,m=g+1;m<o;m++){a=j[m];if(a.id.length>5&&a.id.substr(0,5)=="group"){var v=parseInt(a.id.slice(5));if(v<=w)return}b=a;while(b!=null){b=b.parentNode;if(b==c)break}if(b==c)continue;if(a.id!=null&&a.id.substring(0,5)=="group")f=i;if(a.id!=null&&a.id.substring(0,8)=="footer"+q)f=i;if(i!="none"&&a!=e&&a.tagName=="IMG"&&a.src!=null){var p="/_layouts/15/images/plus.gif",n="/_layouts/15/images/minus.gif";if(a.getAttribute("src")==h||a.src.slice(a.src.length-p.length)==p)f="none";else if(a.getAttribute("src")==r||a.src.slice(a.src.length-n.length)==n)f=""}if(a.tagName==c.tagName&&a.id!="footer")a.style.display=f;if(a.tagName=="TABLE"&&d==null||a==d)break}}function SzExtension(a){var c=new String(a),b=/^.*\.([^\.]*)$/;return c.replace(b,"$1").toLowerCase()}function SzServer(a){var c=new String(a),b=/^([^:]*):\/\/([^\/]*).*$/;return c.replace(b,"$1://$2")}var v_stsOpenDoc,v_strStsOpenDoc;function NavigateParentOrSelf(b,a){if(b.target=="_top"&&typeof window.frameElement.navigateParent!="undefined")window.frameElement.navigateParent(a);else STSNavigate(a)}function StsOpenEnsureEx(a){if(v_stsOpenDoc==null||v_strStsOpenDoc!=a)if(window.ActiveXObject!=null)try{v_stsOpenDoc=new ActiveXObject(a);v_strStsOpenDoc=a}catch(b){v_stsOpenDoc=null;v_strStsOpenDoc=null}return v_stsOpenDoc}function _DispDocItem(b,a){return _DispDocItemEx(b,"FALSE","FALSE","FALSE",a)}function _DispDocItemExWithServerRedirect(d,c,j,g,i,f,k,a){var e=a!=null&&a!="",h=IsClientAppInstalled(f,null,d)&&HasRights(16,0)||SzExtension(d.href)=="pdf";if(e){a=a.substring(1);e=a!=""}if(e)if(k=="1"||!h){var b=a;b=AddInfoPathParametersToUrl(b,f,d,DocOpen.BROWSER);b=AddSourceToUrl(b);if(ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))!=null)typeof window.frameElement.navigateParent!="undefined"&&window.frameElement.navigateParent(b);else if(c.shiftKey||c.ctrlKey)return true;else NavigateParentOrSelf(d,b);c.cancelBubble=true;c.returnValue=false;return false}return DispDocItemExWithEvent(d,c,j,g,i,f)}function _DispDocItemEx(e,c,a,b,d){return DispDocItemExWithEvent(e,null,c,a,b,d)}function DispDocItemExWithEvent(f,g,r,o,q,c,l,p){var h;itemTable=FindSTSMenuTable(f,"CTXName");if(!browseris.ie&&!IsSupportedMacBrowser()&&!IsSupportedNPApiBrowserOnWin()){if(browseris.ie)event.cancelBubble=false;h=f.href;if(ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))!=null)typeof window.frameElement.navigateParent!="undefined"&&window.frameElement.navigateParent(h);else STSNavigate(h);return false}var a,b,e=true,i="",s=document.getElementById("FileDialogViewTable");if(s!=null){if(browseris.ie){event.cancelBubble=false;event.returnValue=false}return true}var d=itemTable!=null?GetAttributeFromItemTable(itemTable,"App",null):"",k=Boolean(f.getAttribute("isEdit"))||d=="ms-infopath";b=itemTable!=null?GetAttributeFromItemTable(itemTable,"Url","ServerUrl"):"";if(b==null||b==""){if(k)b=f.editHref;if(!Boolean(b))b=f.href}else b=SzServer(f.href)+b;var j=SzExtension(b),n=k&&HasRights(0,4)&&!FDefaultOpenForReadOnly(j)&&(!Boolean(currentItemCheckedOutUserId)||currentItemCheckedOutUserId==ctx.CurrentUserId);if(!Boolean(d))d=f.getAttribute("App");if(phManager.ShouldTryProtocolHandler(d)){navigator.msLaunchUri(phManager.CreateProtocolHandlerUrl(d,b,n?ProtocolCommand.Edit:ProtocolCommand.View,null),function(){a:;PHSucceed(d,true)},function(){a:;PHSucceed(d,false);if(l!=null&&!(k&&p))l();else m()});return CancelMyEvent(false,a,g,true)}return m();function m(){a:;if(Boolean(d)&&phManager.IsProtocolHandlerEnabled(d))if(d!=null&&d!=""){window.location.href=phManager.CreateProtocolHandlerUrl(d,b,n?ProtocolCommand.Edit:ProtocolCommand.View,null);return CancelMyEvent(false,a,g,true)}if(currentItemProgId==null&&itemTable!=null)currentItemProgId=GetAttributeFromItemTable(itemTable,"Type","HTMLType");if(currentItemProgId!=null)i=currentItemProgId;if(FDefaultOpenForReadOnly(j)){if(c.indexOf("SharePoint.OpenDocuments")>=0)c="SharePoint.OpenDocuments.3"}else if(!FSupportCheckoutToLocal(j))c="";if(currentItemCheckedOutUserId==null&&itemTable!=null&&typeof itemTable.COUId=="string")currentItemCheckedOutUserId=itemTable.COUId;if(currentItemCheckedoutToLocal==null&&itemTable!=null)currentItemCheckedoutToLocal=GetAttributeFromItemTable(itemTable,"COut","IsCheckedoutToLocal ");if(currentItemCheckedOutUserId!=null&&currentItemCheckedOutUserId!=""&&currentItemCheckedOutUserId==ctx.CurrentUserId&&(c==""||c.indexOf("SharePoint.OpenDocuments")>=0)&&FSupportCheckoutToLocal(j)||c=="SharePoint.OpenDocuments")c="SharePoint.OpenDocuments.3";var m=2;if(c!=""&&HasRights(16,0)){if(c.indexOf(".3")>=0)m=3;a=StsOpenEnsureEx2(c);if(a==null&&m==3){c=c.replace(".3",".2");a=StsOpenEnsureEx2(c);m=2}}if(a!=null)if(m==2||itemTable==null&&currentItemCheckedOutUserId==null||ctx.isVersions==1&&(itemTable==null||typeof itemTable.isMostCur!="string"||itemTable.isMostCur=="0")){try{if(currentItemCheckedOutUserId!=null&&currentItemCheckedOutUserId!=""&&(currentItemCheckedOutUserId==ctx.CurrentUserId||ctx.CurrentUserId==null))if(currentItemCheckedoutToLocal=="1"){alert(Strings.STS.L_OpenDocumentLocalError_Text);e=false}else e=typeof a.EditDocument2!="undefined"&&a.EditDocument2(window,b,i);else e=typeof a.ViewDocument2!="undefined"&&a.ViewDocument2(window,b,i)}catch(t){e=false}if(e)window.onfocus=RefreshOnNextFocus}else{var l=0;if(currentItemCheckedOutUserId!="")if(currentItemCheckedOutUserId!=ctx.CurrentUserId&&ctx.CurrentUserId!=null)l=1;else if(currentItemCheckedoutToLocal==null||currentItemCheckedoutToLocal!="1")l=2;else l=4;else if(!HasRights(0,4)||FDefaultOpenForReadOnly(j))l=1;else if(ctx.isForceCheckout==true)l=3;try{if(k)e=typeof a.EditDocument3!="undefined"&&a.EditDocument3(window,b,false,i);else e=typeof a.ViewDocument3!="undefined"&&a.ViewDocument3(window,b,l,i)}catch(t){e=false}if(e){var p=typeof a.PromptedOnLastOpen!="undefined"&&a.PromptedOnLastOpen();if(p)window.onfocus=RefreshOnNextFocus;else SetWindowRefreshOnFocus()}}else currentItemCheckedoutToLocal=="1"&&alert(Strings.STS.L_OpenDocumentLocalError_Text);if(a==null||!e){if(r=="TRUE"&&o=="TRUE"&&q=="TRUE"){if(itemTable==null)return e;if(browseris.ie){event.cancelBubble=true;event.returnValue=false}else if(IsSupportedMacBrowser()||IsSupportedFirefoxOnWin()){typeof g.preventDefault!="undefined"&&g.preventDefault();typeof g.stopPropagation!="undefined"&&g.stopPropagation()}var s=new Function("return "+itemTable.getAttribute("CTXName")+".HttpRoot;");h=s()+"/_layouts/15/htmltrverify.aspx?doc="+escapeProperly(b);if(ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))!=null)typeof window.frameElement.navigateParent!="undefined"&&window.frameElement.navigateParent(h);else GoToPage(h)}else if(ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))!=null)typeof window.frameElement.navigateParent!="undefined"&&window.frameElement.navigateParent(f.href);else STSNavigate(f.href);return false}return CancelMyEvent(e,a,g)}}function CancelMyEvent(b,d,a,c){if(browseris.ie){if(event!=null){event.cancelBubble=true;event.returnValue=false}}else if(IsSupportedMacBrowser()||IsSupportedNPApiBrowserOnWin()){if(c||d!=null&&b){typeof a.preventDefault!="undefined"&&a.preventDefault();typeof a.stopPropagation!="undefined"&&a.stopPropagation()}return true}return b}function DispDocItemEx2(b,d,l,j,k,r,m,c,f){var a,u=false,o=f!=null&&f!="",e=IsClientAppInstalled(c,null,b)&&HasRights(16,0),h=!IsNullOrUndefined(b.getAttribute("isEdit"));function p(){a:;a=f;a=AddInfoPathParametersToUrl(a,c,b,DocOpen.BROWSER);a=AddSourceToUrl(a);if(h){var e=new URI(a);e.setQueryParameter("action","edit");a=e.getString()}if(ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))!=null)typeof window.frameElement.navigateParent!="undefined"&&window.frameElement.navigateParent(a);else if(d.shiftKey||d.ctrlKey)return true;else NavigateParentOrSelf(b,a);d.cancelBubble=true;d.returnValue=false;return false}if(SzExtension(b.href).indexOf("pdf")!=-1){var g=b,q=h&&Boolean(g.editHref)?g.editHref:g.href;g.href=q;STSNavigate(q);return false}if(o){itemTable=FindSTSMenuTable(b,"CTXName");var i=itemTable!=null?GetAttributeFromItemTable(itemTable,"App",null):"";if(!Boolean(i))i=b.getAttribute("App");var s=!e&&browseris.ie10standardUp&&Boolean(i)&&(m=="0"||h)&&HasRights(0,32);if(!s&&(m=="1"&&!(e&&h&&HasRights(0,32))||!e))return p();else if(e)if(c==""||c.indexOf("SharePoint.OpenDocuments")>=0)return DispDocItemExWithEvent(b,d,l,j,k,r);else{!ViewDoc(b.href,c)&&editDocumentWithProgIDNoUI(b.href,currentItemProgId,c,"0",ctx.HttpRoot,"0",i,n,n);var t=StsOpenEnsureEx2(c);return CancelMyEvent(false,t,d)}}function n(){a:;a=f;a=AddInfoPathParametersToUrl(a,c,b,-1);a=AddSourceToUrl(a);if(ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))!=null)typeof window.frameElement.navigateParent!="undefined"&&window.frameElement.navigateParent(a);else NavigateParentOrSelf(b,a)}return DispDocItemExWithEvent(b,d,l,j,k,c,o?p:null,e)}function DispDocItemExWithOutContext(o,n,e,a,d,i,g,m,k,b,h,j,f,c,l){DispEx(o,n,e,a,d,i,g,m,k,b,h,j,f,c,l)}function AddSourceToUrl(a){var d=a.toLowerCase().indexOf("/wopiframe.aspx?")>0;if(d){document.cookie="WOPISessionContext="+GetSource()+";path=/;";return a}else{var b=GetSource(),c=a.length+b.length;if(c>1950)return a;else{var e=a.indexOf("?")>=0?"&":"?";return a+e+"Source="+b}}}function IsInfoPathProgId(a){return a!=null&&(a.startsWith("SharePoint.OpenXMLDocuments")||a.startsWith("SharePoint.OpenXmlDocuments"))?true:false}function AddInfoPathParametersToUrl(b,d,f,c){if(IsInfoPathProgId(d)){var e=IsClientAppInstalled(d,null,f)&&HasRights(16,0),g=b.indexOf("?")>=0?"&":"?",a=b+g+"ClientInstalled="+String(e);if(c!=-1)a=a+"&DefaultItemOpen="+String(c);return a.length>1950?b:a}else return b}function _VerifyFolderHref(a,d,m,l,f,j,b,c){var h=d.button==Sys.UI.MouseButton.rightButton,k=GetRedirectedHref(a.href,f,j,b,c,false,h,a),i=b!=null&&b!=""&&c!=null&&c.length>1;if(i){if(Boolean(a.getAttribute("isEdit")))a.editHref=a.href;if(!(b=="OneNote.Notebook"&&f=="0"))a.href=k;else{var e=GetCurrentCtx();if(e!=null&&typeof getHostUrl=="function"){var g=ListItemDataFromId(e,a.parentNode.id);if(g!=null)a.href=getHostUrl(e.HttpRoot)+g.FileRef}}d.cancelBubble=true;d.returnValue=true;DetachEvent("mousedown",VerifyFolderHref,a)}return false}function _VerifyHref(a,d,c,f,b){var g=d.button==Sys.UI.MouseButton.rightButton,i=GetRedirectedHref(a.href,c,f,null,b,false,g,a),h=b!=null&&b.length>1,e=IsClientAppInstalled(f,null,a)&&HasRights(16,0);if(h){if(c=="1"&&!(e&&!IsNullOrUndefined(a.getAttribute("isEdit")))||!e){if(Boolean(a.getAttribute("isEdit")))a.editHref=a.href;if(c=="1")a.href=i;d.cancelBubble=true;d.returnValue=true}DetachEvent("mousedown",VerifyHref,a)}return false}function GetRedirectedHref(c,k,e,f,b,g,j,h){var d=b!=null&&b!=""&&(!g||f!=null&&f!=""),i=IsClientAppInstalled(e,null,h)&&HasRights(16,0);if(d){b=b.substring(1);d=b!=""}var a=c;if(d)if(g||k=="1"||!i){a=b;if(!IsInfoPathProgId(e)&&c.indexOf("?")<0&&j)a=c+"?Web=1";else if(GetUrlKeyValue("Web",true,c,true)=="1")a=c;else{a=AddInfoPathParametersToUrl(a,e,h,DocOpen.BROWSER);a=AddSourceToUrl(a)}a=STSPageUrlValidation(a)}return a}function _DispEx(p,a,h,e,g,k,c,o,m,b,j,l,i,f,d){if(a.shiftKey||a.ctrlKey)return true;var n=document.getElementById("FileDialogViewTable");if(n!=null){a.cancelBubble=false;a.returnValue=false;return true}if(typeof ctx=="undefined"||ctx==null)ctx=new ContextInfo;CtxSetCurrentUserId(l);if(i=="1")CtxSetIsForceCheckout(true);else CtxSetIsForceCheckout(false);currentItemCheckedOutUserId=j;currentItemCheckedoutToLocal=f;currentItemProgId=m;if(d!=null&&d!=""){SetCurrentPermMaskFromString(d,null);if(c=="0"&&!HasRights(0,32))c="1"}a.cancelBubble=true;if(b!=null&&b!="")b=b.substring(1);return DispDocItemEx2(p,a,h,e,g,k,c,o,b)}function IsClientAppInstalled(c,e,b){if(e!=null&&phManager.IsProtocolHandlerEnabled(e))return true;if(b!=null){itemTable=FindSTSMenuTable(b,"CTXName");var a=itemTable!=null?GetAttributeFromItemTable(itemTable,"App",null):"";if(!Boolean(a))a=b.getAttribute("App");if(Boolean(a)&&phManager.IsProtocolHandlerEnabled(a))return true}var d=null;if(c!="")d=StsOpenEnsureEx2(c);return d!=null}function ViewDoc(d,c){var a=StsOpenEnsureEx2(c),b=false;if(a!=null)try{b=typeof a.ViewDocument2!="undefined"&&a.ViewDocument2(window,d)}catch(e){b=false}return b}function _PortalPinToMyPage3(a,c,b){a.action=c+"_vti_bin/portalapi.aspx?Cmd=PinToMyPage";if(typeof a.ReturnUrl!="undefined")a.ReturnUrl.value=window.location.href;if(typeof a.ListViewUrl!="undefined"&&typeof a.ListViewUrl.value!="undefined")a.ListViewUrl.value=MakeMtgInstanceUrl(a.ListViewUrl.value,b);a.submit()}function _PortalPinToMyPage(a,g,e,f,b,d,h,c){a.action=g+"_vti_bin/portalapi.aspx?Cmd=PinToMyPage";SetFieldValue(a,"ReturnUrl",window.location.href);SetFieldValue(a,"ListViewUrl",MakeMtgInstanceUrl(d,e));SetFieldValue(a,"ListTitle",f);SetFieldValue(a,"ListDescription",b);SetFieldValue(a,"BaseType",h);SetFieldValue(a,"ServerTemplate",c);a.submit()}function SetFieldValue(c,b,d){var a=c[b];if(a==null){a=document.createElement("INPUT");a.setAttribute("type","hidden");a.setAttribute("name",b);c.appendChild(a)}a.value=d}function _MoveToViewDate(b,a,c){var d=function(){a:;var d;if(Boolean(c))d=SP.UI.ApplicationPages.CalendarInstanceRepository.lookupInstance(c);else d=SP.UI.ApplicationPages.CalendarInstanceRepository.firstInstance();if(d!=null)if(a!=null)typeof d.moveToViewType!="undefined"&&d.moveToViewType(a);else typeof d.moveToDate!="undefined"&&d.moveToDate(b)};if(FV4UI()&&typeof _fV4Calendar!="undefined"&&_fV4Calendar)AjaxCalendarCall(d);else MoveToViewDatePostBack(b,a)}function MoveToViewDatePostBack(c,b){var a=window.location.href;if(c!=null)a=StURLSetVar2(a,"CalendarDate",escapeProperly(c));if(b!=null)a=StURLSetVar2(a,"CalendarPeriod",b);_SubmitFormPost(a,true)}function AjaxCalendarCall(b){var a;try{a=typeof SP.UI.ApplicationPages.CalendarInstanceRepository}catch(c){a="undefined"}EnsureScript("SP.js",a,b)}function _MoveToDate(a,b){_MoveToViewDate(a,null,b)}function MoveToToday(){a:;_MoveToViewDate("",null)}function MoveView(a){_MoveToViewDate(null,a)}function _ClickDay(a){a:;_MoveToDate(a)}function GetIframe(){a:;return null}function _GetMonthView(c){var b=window.location.href,a=document.getElementById("ExpandedWeeksId");if(a!=null){a.value=c;_SubmitFormPost(b,true)}}function NewItemDT(a,c,b){if(a==null)return;if(b!=null)a=StURLSetVar2(a,"CalendarTime",b);if(c!=null)a=StURLSetVar2(a,"CalendarDate",c);_NewItem(a)}function ClickTime(b,a){NewItemDT(b,null,a)}function NewItemDay(b,a){NewItemDT(b,a,null)}function ScrollToAnchorInInnerScrollPane(k,h,j){try{var l=document.getElementById(k),b=document.getElementById(l[h].value);if(typeof b=="undefined"||b==null)throw"";var d=b.parentNode.previousSibling;if(typeof d!="undefined"&&d!=null){var e=d.previousSibling;if(typeof e!="undefined"&&e!=null)b=e;else b=d}else throw"";}catch(o){for(var f=null,i=document.anchors.length,g=0;g<i;g++){f=document.anchors[g];var m=f.href;if(m.search(new RegExp(j))!=-1){b=f;break}}}if(typeof b!="undefined"&&b!=null){var c=b.parentNode;while(c!=null&&c.tagName!="TABLE")c=c.parentNode;if(typeof c!="undefined"&&c!=null){var a=c.parentNode;while(a!=null&&(a.tagName!="DIV"||a.style.overflow!="auto"))a=a.parentNode;if(typeof a!="undefined"&&a!=null){var n=b.offsetLeft;a.scrollLeft=n;a.scrollTop=c.offsetTop-a.clientHeight+c.offsetHeight}}}}function FilterChoice(d,h,E,u){var a,g=0,f=false,l="",w=d.id,v=d.name,j="",r="",s=h.getAttribute("choices"),D=s!=null?s:"",c=D.split("|"),z=0,A=h.offsetHeight,q=h.getAttribute("optHid"),C=q!=null?q:"",x=c.length-1,m=-1,p=false,o="";if(d!=null&&d.selectedIndex>=0){f=true;o=d.options[d.selectedIndex].innerText}for(a=0;a<c.length;a=a+2){var b=c[a];while(a<x-1&&c[a+1].length==0){b=b+"|";a++;if(a<x-1)b=b+c[a+1];a++}var k=c[a+1],i=b.toLocaleLowerCase(),B=E.toLocaleLowerCase();if(u.length!=0)f=true;if(i.indexOf(B)==0){var n=u.toLocaleLowerCase();if(n.length!=0&&i.indexOf(n)==0&&j.length==0)f=false;if(i.length>20)p=true;if(!f||i==o){l+='<option selected value="'+k+'">'+STSHtmlEncode(b)+"</option>";f=true;j=b;r=k;m=a}else l+='<option value="'+k+'">'+STSHtmlEncode(b)+"</option>";g++}}var t=' ondblclick="HandleOptDblClick()" onkeydown="HandleOptKeyDown()"',e="";if(p)e='<select tabIndex="-1" ctrl="'+h.id+'" name="'+v+'" id = "'+w+'"'+t;else e='<select class="ms-lookuptypeindropdown" tabIndex="-1" ctrl="'+h.id+'" name="'+v+'" id = "'+w+'"'+t;if(g==0)e+=' style="display:none;position:absolute;z-index:2;left:'+String(z)+"px;top:"+String(A)+'px" onfocusout="OptLoseFocus(this)"></select>';else e+=' style="position:absolute;z-index:2;left:'+String(z)+"px;top:"+String(A)+'px" size="'+String(g<=8?g:8)+'"'+(g==1?'multiple="true"':"")+' onfocusout="OptLoseFocus(this)">'+l+"</select>";d.outerHTML=e;var y=document.getElementById(C);if(m!=0||c[1]!="0")y.value=r;else y.value="0";return m!=0||c[1]!="0"?j:""}function _OptLoseFocus(a){var b=a.getAttribute("ctrl"),c=b!=null?b:"",d=document.getElementById(c);a.selectedIndex>=0&&_SetCtrlFromOpt(d,a);a.style.display="none"}function SetCtrlMatch(b,a){var c=b.getAttribute("optHid"),e=c!=null?c:"",d=document.getElementById(e);d.value=a.options[a.selectedIndex].value;if(d.value!="0")b.match=a.options[a.selectedIndex].innerText;else b.match=""}function _SetCtrlFromOpt(a,b){var c=a.getAttribute("optHid"),d=c!=null?c:"",e=document.getElementById(d);e.value=b.options[b.selectedIndex].value;a.value=b.options[b.selectedIndex].innerText;if(b.options[b.selectedIndex].value==0)a.match="";else a.match=a.value;typeof a.onValueSetFromPicker=="function"&&a.onValueSetFromPicker()}function HandleOptDblClick(){a:;var a=event.srcElement,b=a.getAttribute("ctrl"),d=b!=null?b:"",c=document.getElementById(d);_SetCtrlFromOpt(c,a);SetCtrlMatch(c,a);a.style.display="none"}function HandleOptKeyDown(){a:;var a=event.srcElement,b=a.getAttribute("ctrl"),c=b!=null?b:"",d=document.getElementById(c),e=event.keyCode;switch(e){case 13:case 9:_SetCtrlFromOpt(d,a);event.returnValue=false;a.style.display="none";return}return}function CommitInlineEditChange(tr,cancel){if(tr.cells.length>0){var c=tr.cells[0];if(c.width=="1%")eval(cancel==true?c.firstChild.lastChild.href:c.firstChild.firstChild.href);else if(tr.cells.length>1){c=tr.cells[1];if(c.width=="1%")eval(cancel==true?c.firstChild.lastChild.href:c.firstChild.firstChild.href)}}}function InlineEditNextTR(tr,nextTr,element,down){var inlineEditString;if(nextTr!=null){_inlineEditString=tr.getAttribute("automode")+"#";var index=null;while(element!=null&&element.nodeType==1&&element.getAttribute("automode")==null){var siblingCount=0,sibling=element.previousSibling;while(sibling!=null){siblingCount++;sibling=sibling.previousSibling}if(index==null)index=String(siblingCount);else index=String(siblingCount)+","+index;element=element.parentNode}_inlineEditString+=index;var tab=nextTr;while(tab!=null&&tab.tagName!="TABLE")tab=tab.parentNode;if(tab!=null&&nextTr!=null&&nextTr.getAttribute("iid")!=null){inlineEditString=tab.getAttribute("inlineedit");if(inlineEditString!=null){inlineEditString=inlineEditString.replace("{@ID}","{"+IdFromRow(nextTr)+"}");inlineEditString=inlineEditString.replace("__cancel;","__commit;dvt_inlineedit={"+_inlineEditString+"};");eval(inlineEditString)}}else if(down==true&&nextTr!=null)if(nextTr.cells.length>0){inlineEditString=null;var c=nextTr.cells[0];if(c.width=="1%")inlineEditString=c.firstChild.href;else if(nextTr.cells.length>1){c=nextTr.cells[1];if(c.width=="1%")inlineEditString=c.firstChild.href}if(inlineEditString!=null){inlineEditString=inlineEditString.replace("__cancel;","__commit;dvt_inlineedit={"+_inlineEditString+"};");eval(inlineEditString)}}}}function HandleInlineEditKeyDown(c){var d=event.srcElement;if(d.tagName!="INPUT")return;var e=event.keyCode,a=c.parentNode,b;switch(e){case 27:CommitInlineEditChange(a,true);break;case 38:b=a.previousSibling;InlineEditNextTR(a,b,d);break;case 13:case 40:b=a.nextSibling;InlineEditNextTR(a,b,d,true)}if(window.event!=null)window.event.cancelBubble=true;else c!=null&&typeof c.stopPropagation!="undefined"&&c.stopPropagation()}function EnsureSelectElement(b,c){var a=document.getElementById(c);if(a==null){a=document.createElement("SELECT");b.parentNode.appendChild(a);a.outerHTML='<select id="'+c+'" ctrl="'+b.id+'" class="ms-lookuptypeindropdown" name="'+c+'" style="display:none" onfocusout="OptLoseFocus(this)"></select>';FilterChoice(a,b,b.value,"")}else{a.parentNode.removeChild(a);b.parentNode.appendChild(a)}return document.getElementById(c)}function HandleKey(){a:;var j=event.keyCode,b=event.srcElement,c=b.value,g=b.getAttribute("opt"),i=g!=null?g:"",a=EnsureSelectElement(b,i),d=false,f,e;switch(j){case 8:if(c.length>0)c=c.substr(0,c.length-1);d=true;break;case 16:case 17:case 18:return;case 9:case 16:case 17:case 18:return;case 13:f=b.value.toLocaleLowerCase();var h=typeof b.match=="string"?b.match:"";e=h.toLocaleLowerCase();if(e.indexOf(f)!=0)b.match=FilterChoice(a,b,b.value,"");if(a.style.display!="none"){b.value=b.match;a.style.display="none";event.returnValue=false}return;case 27:a.style.display="none";event.returnValue=false;return;case 38:if(a.style.display!="none"){if(a.selectedIndex>0)a.selectedIndex=a.selectedIndex-1;else a.selectedIndex=a.options.length-1;SetCtrlMatch(b,a);event.returnValue=false}return;case 40:if(a.style.display!="none"&&a.selectedIndex<a.options.length-1){a.selectedIndex=a.selectedIndex+1;SetCtrlMatch(b,a);event.returnValue=false;return}d=true}if(d)b.match=FilterChoice(a,b,c,"")}function ShowDropdown(c){var a=document.getElementById(c),f=a.value,b=a.getAttribute("opt"),d=b!=null?b:"",e=EnsureSelectElement(a,d);a.match=FilterChoice(e,a,"",a.value);a.focus()}function HandleChar(){a:;var a=event.srcElement,b=a.value,c=a.getAttribute("opt"),e=c!=null?c:"",f=document.getElementById(e),d=event.keyCode;if(d==13)return;b=b+String.fromCharCode(d).toLocaleLowerCase();a.match=FilterChoice(f,a,b,"")}function HandleLoseFocus(){a:;var d=event.srcElement,b=d.getAttribute("opt"),c=b!=null?b:"",a=document.getElementById(c);a!=null&&a.style.display!="none"&&typeof document.activeElement!="undefined"&&document.activeElement!=a&&_OptLoseFocus(a)}function HandleChange(){a:;var a=event.srcElement,e=a.value,b=a.getAttribute("opt"),c=b!=null?b:"",d=document.getElementById(c);a.match=FilterChoice(d,a,e,"")}function IsSafeHref(a){return a.match(new RegExp("^http://","i"))!=null||a.match(new RegExp("^https://","i"))!=null||a.match(new RegExp("^ftp://","i"))!=null||a.match(new RegExp("^file://","i"))!=null||a.match(new RegExp("^mailto:","i"))!=null||a.match(new RegExp("^news:","i"))!=null||a.match(new RegExp("^pnm://","i"))!=null||a.match(new RegExp("^mms://","i"))!=null||a.match(new RegExp("^/","i"))!=null||a.match(new RegExp("^#","i"))!=null||a.match(new RegExp("^\\\\\\\\","i"))!=null}function Discuss(a){if(browseris.ie5up&&browseris.win32)window.parent.location.href=a;else alert(Strings.STS.L_IE5upRequired_Text)}var g_AdditionalNavigateHierarchyQString;function GetAdditionalNavigateHierarchyQString(){a:;return g_AdditionalNavigateHierarchyQString}function SetAdditionalNavigateHierarchyQString(a){g_AdditionalNavigateHierarchyQString=a}function ProcessDefaultNavigateHierarchy(g,e,d,b,c,j,i,h,f){if(typeof _spCustomNavigateHierarchy!="undefined")_spCustomNavigateHierarchy(g,e,d,b,c,j);else if(c==false)top.location.href=b;else{var a=document.createElement("INPUT");a.type="hidden";a.name="_spTreeNodeClicked";a.value=d;i.appendChild(a);var k="?RootFolder="+escapeProperly(b)+h+"&"+g_AdditionalNavigateHierarchyQString;_SubmitFormPost(f+k);return false}return undefined}function ParseMultiColumnValue(b,f,i){var d,e=[];if(f==null)f=";#";var p=f.charCodeAt(0),o=f.charCodeAt(1);if(b==null||b.length==0)return e;var h=f.charAt(0),n=h+h,l=new RegExp(n,"g"),k=f.charAt(0),c=0;if(b.substr(0,2)==f){Boolean(i)&&e.push("");c=2}var a=c,g=false,j=b.length;while(a<j){var m=b.indexOf(h,a);if(m>=0){a=m;a++;if(b.charCodeAt(a)==o){if(a-1>c){d=b.substr(c,a-c-1);if(g)d=d.replace(l,k);e.push(d);g=false}else e.push("");a++;c=a;continue}else if(b.charCodeAt(a)==p){a++;g=true;continue}else throw"ArgumentException";}else a=j}if(a>c){d=b.substr(c,a-c);if(g)d=d.replace(l,k);e.push(d)}else Boolean(i)&&e.push("");return e}function ConvertMultiColumnValueToString(f,b,c){if(b==null)b=";#";if(c==null)c=true;for(var h=b.charAt(0),i=h+h,j=new RegExp(b.charAt(0),"g"),g=false,d="",e=0;e<f.length;e++){var a=f[e];if(a!=null&&a.length>0)a=a.replace(j,i);if(a!=null&&a.length>0)g=true;if(c||e!=0)d+=b;d+=a}if(g){if(c)d+=b;return d}else return""}var httpFolderTarget,httpFolderSource,httpFolderDiv;function NavigateHttpFolderCore(){a:;var a;if(httpFolderDiv==null){httpFolderDiv=document.createElement("DIV");document.body.appendChild(httpFolderDiv);httpFolderDiv.onreadystatechange=NavigateHttpFolderCore;typeof httpFolderDiv.addBehavior!="undefined"&&httpFolderDiv.addBehavior("#default#httpFolder")}if(typeof httpFolderDiv.readyState=="string"&&httpFolderDiv.readyState=="complete"){httpFolderDiv.onreadystatechange=null;try{a=typeof document.frames!="undefined"&&typeof document.frames.item!="undefined"?document.frames.item(httpFolderTarget):null;if(a!=null){var d=typeof a.document!="undefined"?a.document:null;if(d!=null){var f=typeof d.body!="undefined"?d.body:null;if(f!=null&&typeof f.innerText=="string")f.innerText=Strings.STS.L_WebFoldersRequired_Text}}}catch(i){}var b=false;try{var g="";if(typeof httpFolderDiv.navigateFrame!="undefined")g=httpFolderDiv.navigateFrame(httpFolderSource,httpFolderTarget);if(g=="OK")b=true}catch(i){}if(!b&&0==httpFolderSource.search(new RegExp("http://[a-zA-Z0-9-.]+(:80)?/"))){var h=httpFolderSource.replace(/http:\/\/([a-zA-Z0-9\-\.]+)(:80)?[\/]/,"//$1/").replace(/[\/]/g,"\\");try{a=typeof document.frames!="undefined"&&typeof document.frames.item!="undefined"?document.frames.item(httpFolderTarget):null;if(a!=null){a.onload=null;var c=typeof a.document!="undefined"?a.document:null;if(c!=null){var e=typeof c.location!="undefined"?c.location:null;if(e!=null&&typeof e.href=="string"){e.href=h;b=true}}}}catch(i){}}if(!b)if(browseris.ie)alert(Strings.STS.L_WebFoldersError_IE_Text);else alert(Strings.STS.L_WebFoldersError_Text)}}function NavigateHttpFolder(a,b){if("/"==a.charAt(0))a=window.location.protocol+"//"+window.location.host+a;httpFolderSource=a;httpFolderTarget=b;NavigateHttpFolderCore()}function NavigateHttpFolderIfSupported(b,a){if(a=="_blank")if(SupportsNavigateHttpFolder())NavigateHttpFolder(b,a);else alert(Strings.STS.L_WebFoldersError_Text);else alert(Strings.STS.L_NoExplorerView_Text)}function AutoIndexForRelationshipsConfirmation(){a:;var a=Strings.STS.L_Lookup_AutoIndexForRelationships_Confirm_Text;return confirm(a)}function SetHomePage2(c){if(!window.confirm(SP.Res.confirmWelcomePage))return;var d=new SP.ClientContext(undefined),b=d.get_web().get_rootFolder(),a="";if(c.length>0){a=_spPageContextInfo.serverRequestPath;a=unescapeProperly(a);a=a.substr(c.length);if(a.indexOf("/")==0)a=a.substr(1)}b.set_welcomePage(a);b.update();var e=STSHtmlEncode(SP.Res.sending),f=addNotification(e,true);d.executeQueryAsync(function(){a:;removeNotification(f);addNotification(STSHtmlEncode(SP.Res.pageIsSiteHomePage),false)},null)}function SetHomePage(b){var a=function(){a:;SetHomePage2(b)};if(typeof SP!="undefined")EnsureScript("SP.js",typeof SP.ClientContext,a);else EnsureScript("SP.js",typeof SP,a)}function SendEmail(c){var a;try{a=typeof SP.Ribbon.EMailLink.openMailerWithUrl}catch(f){a="undefined"}var e="SP.Ribbon.EMailLink.openMailerWithUrl",b=e.split(".");if(b.length>1){var d=function(){a:;SP.Ribbon.EMailLink.openMailerWithUrl(c)};EnsureScript(b[0],a,d)}}function TryCopyStringToClipboard(b){if(typeof window.clipboardData!="undefined"&&typeof window.clipboardData.setData!="undefined")window.clipboardData.setData("Text",b);else if(typeof netscape!="undefined"&&typeof Components!="undefined"){netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var d=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);if(d==null)return false;d.data=b;var a=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(a==null||typeof a.addDataFlavor=="undefined"||typeof a.setTransferData=="undefined")return false;a.addDataFlavor("text/unicode");a.setTransferData("text/unicode",d,b.length*2);var e=Components.interfaces.nsIClipboard,c=Components.classes["@mozilla.org/widget/clipboard;1"].getService(e);if(c==null||typeof c.setData=="undefined")return false;c.setData(a,null,e.kGlobalClipboard)}return true}function CopyStringToClipboard(b){var a=false;try{a=TryCopyStringToClipboard(b)}catch(c){a=false}!a&&alert(SP.Res.clipboardNoAccess)}function CopyPageAddressToClipboard(){a:;CopyStringToClipboard(window.location.href)}function showViewSelector(b,a,d){if(b==null)b=window.event;CancelEvent(b);a=EnsureValidPositioningElement(b,a);if(a!=null&&a.className=="ms-csrlistview-viewselectormenu")a=a.parentNode;var e=function(){a:;SP.Application.UI.ViewSelectorMenuBuilder.showMenu(a,d)},c;try{c=typeof SP.Application.UI.ViewSelectorMenuBuilder.showMenu}catch(f){c="undefined"}EnsureScript("SP.js",c,e)}function EnsureValidPositioningElement(d,c){if(c!=null)return c;var b=GetEventSrcElement(d),a=b;while(a!=null&&a.tagName!="BODY"){if(a.tagName=="TD"&&(a.className=="ms-viewselector"||a.className=="ms-viewselectorhover"))return a;a=a.parentNode}return b}function EnsureCheckoutAndChangeLayoutModeToEdit(e,d,g){var a,c=function(){a:;var a;try{a=typeof browserScript.MSOLayout_ChangeLayoutMode}catch(e){a="undefined"}var d="browserScript.MSOLayout_ChangeLayoutMode",b=d.split(".");if(b.length>1){var c=function(){a:;browserScript.MSOLayout_ChangeLayoutMode(g)};EnsureScript(b[0],a,c)}},f=function(){a:;var g=a!=null?a.get_item("CheckoutUser"):null;if(!g){if(confirm(Strings.STS.L_ConfirmCheckout_Text)){var b=new SP.ClientContext(undefined),f=b.get_web().get_lists().getById(new SP.Guid(e));a=f.getItemById(d);a.get_file().checkOut();b.executeQueryAsync(c,null)}}else c()},h=function(){a:;var b=new SP.ClientContext(undefined),c=b.get_web().get_lists().getById(new SP.Guid(e));a=c.getItemById(d);b.load(a,"CheckoutUser");b.executeQueryAsync(f,null)},b;try{b=typeof SP.ClientContext}catch(i){b="undefined"}EnsureScript("SP.js",b,h)}function _ChangeLayoutMode(e,f){var a;try{a=typeof browserScript.MSOLayout_ChangeLayoutMode}catch(g){a="undefined"}var d="browserScript.MSOLayout_ChangeLayoutMode",b=d.split(".");if(b.length>1){var c=function(){a:;browserScript.MSOLayout_ChangeLayoutMode(e,f)};EnsureScript(b[0],a,c)}}function OpenWebPartMenuFromLink(a,b,c,d){OpenWebPartMenu(a,b,c,d,false)}function OpenWebPartMenu(e,f,g,h,i){var a;try{a=typeof browserScript.MSOWebPartPage_OpenMenu}catch(j){a="undefined"}var d="browserScript.MSOWebPartPage_OpenMenu",b=d.split(".");if(b.length>1){var c=function(){a:;browserScript.MSOWebPartPage_OpenMenu(e,f,g,h,i)};EnsureScript(b[0],a,c)}return true}function UpdateWebPartMenuFocus(a,d,c){if(a!=null)a.className=d;var b=null;if(a!=null&&a.childNodes!=null){b=a.childNodes[0];if(b!=null&&b.tagName=="SPAN")b.className=c}}function _WebPartMenuKeyboardClick(e,c,d,f){var a;try{a=typeof browserScript.MSOMenu_KeyboardClick}catch(i){a="undefined"}var h="browserScript.MSOMenu_KeyboardClick",b=h.split(".");if(b.length>1){var g=function(){a:;browserScript.MSOMenu_KeyboardClick(e,c,d,f)};EnsureScript(b[0],a,g)}}function _ShowToolPane2Wrapper(e,f,g){var a;try{a=typeof browserScript.MSOTlPn_ShowToolPane2Wrapper}catch(h){a="undefined"}var d="browserScript.MSOTlPn_ShowToolPane2Wrapper",b=d.split(".");if(b.length>1){var c=function(){a:;browserScript.MSOTlPn_ShowToolPane2Wrapper(e,f,g)};EnsureScript(b[0],a,c)}}function ChangeWebPartPageView(c){var a;try{a=typeof browserScript.MSOLayout_ToggleView}catch(f){a="undefined"}var e="browserScript.MSOLayout_ToggleView",b=e.split(".");if(b.length>1){var d=function(){a:;browserScript.MSOLayout_ToggleView(c)};EnsureScript(b[0],a,d)}}function _SetupFixedWidthWebParts(){a:;var a;try{a=typeof browserScript.MSOWebPartPage_SetupFixedWidthWebParts}catch(e){a="undefined"}var d="browserScript.MSOWebPartPage_SetupFixedWidthWebParts",b=d.split(".");if(b.length>1){var c=function(){a:;browserScript.MSOWebPartPage_SetupFixedWidthWebParts()};EnsureScript(b[0],a,c)}}function EnsureSelectionHandlerOnFocusDeferred(d,c,b){var a=c;while(a.tagName!="TABLE")a=a.parentNode;EnsureSelectionHandlerDeferred(d,a,b)}function EnsureSelectionHandlerDeferred(n,g,j){var c=window["ctx"+String(j)];if(!FV4UI()||c==null){g.onmouseover=null;return}if(c.BaseViewID=="MapView"&&(IsStrNullOrEmpty(g.className)||g.className.indexOf("ms-mapviewtable")==-1))return;ctxInitItemState(c);var e=g.querySelector(".ms-selectall-span");if(e!=null){$addHandler(e,"keydown",function(a){if(a.keyCode==Sys.UI.Key.space||a.keyCode==Sys.UI.Key.enter){ClkElmt(e);e.focus();a.preventDefault()}});$addHandler(e,"mousedown",function(){a:;e.style.outline="none"});$addHandler(e,"mouseup",function(){a:;e.style.outline="";e.firstChild.focus()})}for(var k=g.rows,h=0;h<k.length;h++){var a=k[h];if(HasCssClass(a,"ms-viewheadertr")){var b=a.cells[0];if(b!=null){var f=b.getElementsByTagName("INPUT")[0];if(f!=null)f.className="s4-selectAllCbx";else f=b.querySelector(".ms-selectall-span");if(f!=null){c.SelectAllCbx=f;if(typeof f.onfocus!="undefined")c.TableCbxFocusHandler=f.onfocus;f.onfocus=null}}}var l=a.getAttribute("iid");if(l!=null){var i=false;if(ItemIsCurrentlySelected(c,l,a)){i=true;c.CurrentSelectedItems++}if(ItemIsCurrentlyVisible(a)){c.TotalListItems++;c.LastSelectableRowIdx=h}if(a.cells.length>0){b=a.cells[0];var d=b.querySelector(".s4-itm-cbx");if(d!=null){if(!i)d.checked=false;if(typeof d._setup=="undefined"||!Boolean(d._setup)){d._setup=true;var m=TooltipOfRow(a);if(m!=null)d.title=m;d.onblur=HideItemCbx;d.onfocus=DisplayItemCbx;d.onclick=ToggleItemRowSelection;b.onclick=ToggleItemRowSelection;if(d.nodeName=="DIV"){$addHandler(b,"keydown",function(b,a){return function(c){if(c.keyCode==Sys.UI.Key.space||c.keyCode==Sys.UI.Key.enter){ToggleItemRowSelection(c,b);a.focus()}}}(a,b));$addHandler(b,"mousedown",function(a){return function(){a:;a.style.outline="none"}}(b));$addHandler(b,"mouseup",function(a){return function(){a:;a.style.outline=""}}(b))}}if(a.getAttribute("automode")==null)a.onclick=SingleItemSelect}UpdateAutoMode(a);AddSpaceToEmptyTDs(a);AddBorderToLastCell(a)}}}c.TableMouseoverHandler=g.onmouseover;g.onmouseover=null;AddKeyDownEventHandler(g,j)}function AddKeyDownEventHandler(a,c){if(a.nodeName.toUpperCase()!="TABLE")return;var b=window["ctx"+String(c)];if(IsStrNullOrEmpty(a.className)||b.BaseViewID=="MapView"&&a.className.indexOf("ms-mapviewtable")==-1||b.BaseViewID!="MapView"&&a.className.indexOf("ms-listviewtable")==-1)return;if(a.getAttribute("handleDeleteInit")==null){a.setAttribute("handleDeleteInit","true");$addHandler(a,"keydown",function(a){a:;OnListViewKeyDown(a,c)})}}function ItemIsSelectable(a){return a==null||!ItemHasiid(a)||!ItemIsCurrentlyVisible(a)?false:true}function ItemIsCurrentlyVisible(a){return a==null||a.parentNode==null?false:GetCurrentEltStyle(a.parentNode,"display")=="none"||GetCurrentEltStyle(a,"display")=="none"?false:true}function ItemIsCurrentlySelected(b,c,d){if(b==null||!Boolean(c))return false;var a=GetSelectedItemsDict(b);return a==null||a[c]==null||d.className.indexOf("s4-itm-selected")<0?false:true}function ItemHasiid(a){return a==null||a.getAttribute("iid")==null?false:true}function OnListViewKeyDown(a,b){var d=GetListContextFromContextNumber(String(b));if(d==null||d.inGridMode)return;var e=a.keyCode,c=a.shiftKey||a.ctrlKey;if(IsCallOutOn())return;switch(e){case Sys.UI.Key.del:HandleItemDelete(a,b);break;case Sys.UI.Key.up:SelectNextRow(b,-1,c,a);break;case Sys.UI.Key.down:SelectNextRow(b,1,c,a);break;case Sys.UI.Key.enter:if(IsEventTargetAnchor(a))return;if(a.target!=null&&!IsStrNullOrEmpty(a.target.className)&&a.target.className.indexOf("ms-lstItmLinkAnchor")>=0)OpenCallOutOrECB(b,a);else ListItem_Open(b,a)}}function OpenCallOutOrECB(e,b){var c=GetListContextFromContextNumber(String(e));if(c==null)return true;var a=b.target,d=DoesListUseCallout(c),f=GetAncestor(a,"TR"),g=IdFromRow(f);if(IsStrNullOrEmpty(g))return true;if(d)ShowCalloutMenuForTr(a,b,true);else ShowECBMenuForTr(a.parentNode,b);return true}function ListItem_Open(c,d){var a=GetListContextFromContextNumber(String(c));if(a==null)return false;var b=GetLastSelectedRow(a);if(b==null)return false;if(a.ListSchema.IsDocLib)OpenDocItem(d,a,b);else OpenListItem(b,c);return true}function OpenDocItem(h,f,b){var a=GetListItemDataFromTrInternal(f,b),c=b,g=GetEcbTdFromRow(b),e=GetEcbDivFromEcbTd(g);if(e!=null)c=e.querySelector("a.ms-draggable");if(c==null)c=b;var d=f.ListSchema;return DispEx(c,h,"TRUE","FALSE",a["File_x0020_Type.url"],a["File_x0020_Type.progid"],d.DefaultItemOpen,a["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"],a.HTML_x0020_File_x0020_Type,a["serverurl.progid"],Boolean(a.CheckoutUser)?a.CheckoutUser[0].id:"",d.Userid,d.ForceCheckout,a.IsCheckedoutToLocal,a.PermMask)}function OpenListItem(b,c){var a=b.querySelector('a[class*="ms-listlink"]');if(a==null)return;EditLink2(a,c)}function GetListItemDataFromTr(a){if(a==null)return null;var b=GetListContextFromTr(a);return b==null?null:GetListItemDataFromTrInternal(b,a)}function GetListItemDataFromTrInternal(b,a){if(b==null||a==null)return null;var c=IdFromRow(a);return ListItemDataFromId(b,c)}function GetListContextFromTr(a){if(a==null)return null;var b=a.getAttribute("iid");if(IsStrNullOrEmpty(b))return null;var c=b.split(",");return c.length<=2?null:GetListContextFromContextNumber(c[0])}function GetListContextFromContextNumber(a){return window["ctx"+a]}function ListItemDataFromId(c,d){if(c==null||d==null||c.ListData==null)return null;var a=c.ListData.Row;if(a==null)return null;for(var e=a.length,b=0;b<e;b++)if(a[b].ID===d)return a[b];return null}function SelectNextRow(g,h,f,e){var c=GetListContextFromContextNumber(String(g)),b=GetLastSelectedRow(c),a=null;if(b!=null){a=GetNextRow(b,h);if(a!=null){var d;d=SingleItemSelectByElement(a,f);return e==null?d:CancelEvent(e)}}else MakeDefaultSelectionForListView(c);return true}function GetLastSelectedRow(c){var e=c.dictSel,b="",a=null;if(c!=null)b=c.LastSelectedItemIID;if(b!=null&&b.length>0){var d='tr[iid="'+b+'"]';a=document.querySelector(d);if(a!=null&&a.getAttribute("automode")!=null)a=null}return a}function GetIndexFromIID(a,c){if(c==null)return-1;var e=c.split(",")[1],d=0;if(a!=null&&a.ListData!=null&&a.ListData.Row!=null){var f=a.ListData.Row;d=f.length;for(var b=0;b<d;b++){var g=a.ListData.Row[b].ID;if(g===e)return b}}return-1}function GetLastSelectedRowIndex(a){var b=a.LastSelectedItemIID;return GetIndexFromIID(a,b)}function GetTrFromIID(a){if(a==null||a.length==0)return null;var b='tr[iid="'+a+'"]';return document.querySelector(b)}function SelectRowByIID(c,b){var a=GetTrFromIID(c);a!=null&&SingleItemSelectByElement(a,b)}function SelectRowByIndex(a,c,d){var b;if(a!=null&&a.ListData!=null&&a.ListData.Row!=null&&a.ListData.Row[c]!=null){b=GenerateIIDForListItem(a,a.ListData.Row[c]);b!=null&&b.length>0&&SelectRowByIID(b,d)}}function EnsureKeyBoardHandlersRegistered(a){if(a==null)return;if(a.ListData==null||a.ListData.Row==null||a.ListData.Row[0]==null)return;var b=GenerateIIDForListItem(a,a.ListData.Row[0]),d=GetTrFromIID(b);if(d==null)return;var c=GetAncestor(d,"TABLE");if(c==null)return;AddKeyDownEventHandler(c,b.split(",")[0])}function MakeDefaultSelectionForListView(a){if(a==null)return;EnsureKeyBoardHandlersRegistered(a);if(a.ListData!=null&&a.ListData.Row!=null&&a.ListData.Row[0]!=null){var b=GetTrFromIID(GenerateIIDForListItem(a,a.ListData.Row[0]));if(b==null)return;while(b!=null){if(b.className.indexOf("s4-wpcell")>=0||b.className.indexOf("s4-wpActive")>=0)break;b=b.parentNode}if(b==null)return;EnsureScriptParams("ribbon","SelectWp",b)}if(a.LastSelectedItemIID!=null&&a.LastSelectedItemIID.length>0){var e=GetTrFromIID(a.LastSelectedItemIID);if(e!=null){SingleItemSelectByElement(e,false);return}}var c=a.LastRowIndexSelected;if(c==null)c=0;else{if(a.ListData!=null&&a.ListData.Row!=null)var d=a.ListData.Row.length;if(c>=d)c=d==0?-1:d-1}a.LastRowIndexSelected=null;c!=-1&&SelectRowByIndex(a,c,false)}function GetNextRow(b,c){var a=null;if(b!=null&&b.nodeName.toLowerCase()!="tr")return null;if(c==1)a=b.nextSibling;else if(c==-1)a=b.previousSibling;if(a!=null){var d=a.getAttribute("iid");return d!=null&&d.length>0?a:GetNextRow(a,c)}return a}function HandleItemDelete(h,e){var b=window["ctx"+String(e)],a=GetLastSelectedRowIndex(b);if(a==-1)a=0;b.LastRowIndexSelected=a;var c;try{c=typeof inplview.DeleteSelectedItems}catch(i){c="undefined"}var g="inplview.DeleteSelectedItems",d=g.split(".");if(d.length>1){var f=function(){a:;inplview.DeleteSelectedItems(b)};EnsureScript(d[0],c,f)}return false}function GetItemRow2(b){var a=b;while(a!=null&&a.nodeType==1&&a.tagName!="BODY"&&a.getAttribute("iid")==null){if(typeof a.parentNode=="undefined"||a.parentNode==null||typeof a.parentNode.tagName=="undefined"){a=null;break}a=a.parentNode}return a!=null&&a.nodeType==1&&a.tagName=="TR"?a:null}function GetItemRow(a){if(a==null)a=window.event;var b=GetEventSrcElement(a);return GetItemRow2(b)}function TooltipOfRow(d){for(var c=d.cells,a=0,a=0;a<c.length;a++){var e=c[a];if(HasCssClass(e,"ms-vb-title"))return GetInnerText(e).trim()}var b=d.getAttribute("iid");if(b!=null){var f=b.split(",");if(f.length>2)return""+f[1]}return null}function AlertCheckOut(){a:;alert(Strings.STS.L_MustCheckout_Text)}function UpdateAutoModeImage(a){if(a==null)a=window.event;if(a!=null){var b=a.srcElement!=null?a.srcElement:a.currentTarget;if(b!=null&&b.tagName=="A")if(a.type=="blur")RemoveCssClassFromElement(b,"ms-inlineEditLink");else a.type=="focus"&&AddCssClassToElement(b,"ms-inlineEditLink")}}function AddAutoModeTag(f,e,g){var a=document.createElement("A");SetEvent("blur",UpdateAutoModeImage,a);SetEvent("focus",UpdateAutoModeImage,a);var c=e;while(c.tagName!="TABLE")c=c.parentNode;if(f.getAttribute("requiresCheckout")!=null)SetEvent("click",AlertCheckOut,a);else{var d=c.getAttribute("inlineedit");if(d!=null)a.href=d.replace("{@ID}","{"+IdFromRow(e)+"}")}var b=document.createElement("IMG");b.className="s4-itm-inlineedit";b.src=g;b.border=0;b.alt=Strings.STS.L_Edit_Text;a.appendChild(b);f.appendChild(a)}function GetItemRowCbx(a){var b=null;if(a!=null&&a.cells!=null&&a.cells.length>0){var c=a.cells[0];b=c.querySelector(".s4-itm-cbx")}return b}function GetEcbTdFromRow(b){var a=null;if(b!=null)a=b.querySelector('td[IsECB="TRUE"]');return a}function GetEcbDivFromEcbTd(a){return a==null?null:a.querySelector("div.ms-vb.itx")}function GetEcbAffordanceDivFromRow(a){return a==null?null:a.querySelector("div.ms-list-itemLink")}function UpdateAutoMode(b){if(b!=null){var c=CtxFromRow(b);if(c==null||typeof c.InlineEdit=="undefined"||!Boolean(c.InlineEdit))return;if(b.cells!=null&&b.cells.length>0){var a=b.cells[0];if(a.innerHTML==""&&a.width=="1%"){if(a.getAttribute("requiresCheckout")==null)a.onclick=ClickToEdit;AddAutoModeTag(a,b,"/_layouts/15/images/edititem.gif?rev=23")}else if(b.cells.length>1){a=b.cells[1];if(a.innerHTML==""&&a.width=="1%"){if(a.getAttribute("requiresCheckout")==null)a.onclick=ClickToEdit;AddAutoModeTag(a,b,"/_layouts/15/images/edititem.gif?rev=23")}}}}}function ClickToEdit(a){var c=GetItemRow(a);if(c!=null&&c.cells.length>1){var e=c.cells[1],d=e.firstChild;if(d!=null){var b=d.firstChild;if(b!=null&&b.tagName=="IMG")b.src="/_layouts/15/images/spinnyrefresh.gif?rev=23"}}if(window.event!=null)window.event.cancelBubble=true;else a!=null&&a.stopPropagation()}function HideItemCbx(b){if(b==null)b=window.event;var c=GetItemRow(b),a=GetItemRowCbx(c);if(a!=null&&a.tagName=="INPUT"){a.style.top="";a.style.position="";a.onmouseout=null}}function DisplayItemCbx(b){if(b==null)b=window.event;var c=GetItemRow(b),a=GetItemRowCbx(c);if(a!=null&&a.tagName=="INPUT"){a.style.top="0px";a.style.position="relative";a.onmouseout=HideItemCbx}}function Log(b){var a=document.createElement("DIV");a.innerHTML=b;document.body.appendChild(a)}function _ToggleAllItems(a,b,c){if(a==null)a=window.event;MenuHtc_hide();ToggleAllItems2(b,c,b.checked);if(window.event!=null)window.event.cancelBubble=true;else a.stopPropagation();return false}function ToggleAllItems2(b,f,g){var a=window["ctx"+String(f)];if(a==null){b.checked=false;return}if(a.inGridMode){SPGridToggleAllItems(a);return}var c=b;while(c.tagName!="TABLE")c=c.parentNode;var e=c.rows,d=CountTotalItems(a);if(d==0){b.checked=false;return}if(g){if(d>g_MaximumSelectedItemsAllowed){b.checked=false;alert(Strings.STS.L_BulkSelection_TooManyItems);return}SelectAllItems(a,e)}else DeselectAllItems(a,e,true)}function SelectAllItems(a,b){if(a==null||b==null)return;for(var e=a.LastSelectableRowIdx,c=1;c<e;c++){var d=b[c],f=d.getAttribute("iid");if(f!=null)ItemIsCurrentlyVisible(d)&&ToggleItemRowSelection2(a,d,true,false,true)}ToggleItemRowSelection2(a,b[e],true,true,true)}function DeselectAllItems(a,b,i){if(a==null)return;var d,f=a.LastSelectableRowIdx,e=1;if(a.BaseViewID=="MapView"){e=0;var g=document.getElementById("mapviewListTable_"+a.wpq);if(g==null)return;b=g.rows;f=b.length-1}if(b==null)return;for(d=e;d<=f;d++){var h=b[d],c=h.getAttribute("iid");if(c!=null&&typeof c=="string"){var j=c.split(",");SelectListItem(a,c,j,h,false,true)}}i&&RefreshCommandUI()}function DeselectCollapsedGroup(e,b){if(b==null)return;var c=b.rows,a=GetLastSelectableRowIdx(b,ItemHasiid);if(Boolean(c)&&a!=-1){for(var d=0;d<a;d++){var f=c[d];ItemHasiid(f)&&ToggleItemRowSelection2(e,f,false,false,false)}ToggleItemRowSelection2(e,c[a],false,true,false)}}function HandleSingleGroupByRow(a,b,d){if(a==null||b==null)return;var c=b.getAttribute("iid");if(c==null)return;if(!d){a.TotalListItems--;ItemIsCurrentlySelected(a,c,b)&&ToggleItemRowSelection2(a,b,false,true,false)}else a.TotalListItems++}function RefreshCommandUI(){a:;if(IsFullNameDefined("SP.Ribbon.PageManager")){var a=SP.Ribbon.PageManager.get_instance();a!=null&&a.get_commandDispatcher().executeCommand(Commands.CommandIds.ApplicationStateChanged,null)}}function _CommandUIExecuteCommand(b){if(IsFullNameDefined("SP.Ribbon.PageManager")){var a=SP.Ribbon.PageManager.get_instance();a!=null&&a.get_commandDispatcher().executeCommand(b,null)}}function OnItemSelectionChanged(d,a,b){var e=d;if(FV4UI()){var c=function(){a:;var d=[];if(typeof _ribbon!="undefined"&&_ribbon!=null){var c=e.clvp;if(c!=null)if(b)c.EnsureEcbInfo(RefreshCommandUI,d,a);else c.EnsureEcbInfo(null,null,a)}};EnsureScript("inplview",typeof InitAllClvps,c)}}function IdFromRow(c){var b=c.getAttribute("iid"),a=b.split(",");return a[1]}function CtxFromRow(d){var c=d.getAttribute("iid"),b=c.split(","),a=b[0];return window["ctx"+a]}function GroupNameFromRow(e){var c=e.parentNode,a=c.id;if(a==null||a==""){var b=c.previousSibling;if(b!=null&&b.childNodes.length==0&&b.tagName==c.tagName)a=b.id}if(a==null||a=="")return null;var d=a.substr(4,a.length-6);return d==""?null:d}function GroupStringFromGroupName(a){if(a==null||a=="")return null;var c=document.getElementById("titl"+a+"_");if(c==null)return null;var b=c.getAttribute("groupString");return b==""?null:b}var previousClickedItemRow;function IsCallOutOn(){a:;return typeof CalloutManager==="object"&&typeof CalloutManager.isAtLeastOneCalloutOn==="function"&&CalloutManager.isAtLeastOneCalloutOn()}function SingleItemSelectByElement(b,a){return SingleItemSelectInternal(null,false,b,a)}function MultiItemSelect(i){var e=GetItemRow(i);if(e==null)return false;var a=CtxFromRow(e),n=e.getAttribute("iid"),c=GetIndexFromIID(a,n),k=a.LastSelectedItemIID,b=GetLastSelectedRowIndex(a),l=GetLastSelectedRow(a),m=c<b?c:b,o=c>b?c:b;if(!i.ctrlKey)if(CountSelectedItems(a)>0){var d=e;while(d.tagName!="TABLE")d=d.parentNode;for(var h=d.rows,f=0;f<h.length;f++){var j=h[f];ItemIsSelectable(j)&&ToggleItemRowSelection2(a,j,false,false,false)}}for(var g=m;g<=o;g++)SelectRowByIndex(a,g,true);FocusRow(a,k,l);return false}function OpenCalloutAndSelectItem(a,b,e,c){var d=GetAncestor(a,"TR");SingleItemSelectInternal(b,false,d,false);OpenCallout(a,b,e,c)}function SingleItemSelect(a){if(a==null)a=window.event;var c=a.shiftKey,b=a.ctrlKey;if(c){MultiItemSelect(a);return false}else{var d=SingleItemSelectInternal(a,true,null,b);return b?false:d}}function SingleItemSelectInternal(e,g,a,k){var d=true;if(g){var j=GetEventSrcElement(e);if(j!=null&&ElementContainsLink(j))return undefined;if(IsCallOutOn())return true;a=GetItemRow(e);if(clearECBMenu(j,a==null?null:CtxFromRow(a))){CancelEvent(e);return false}}if(a==null)return false;var c=a;while(c.tagName!="TABLE")c=c.parentNode;var p=c.rows,b=CtxFromRow(a);if(g){var l=a.getAttribute("iid"),o=l.split(",");d=!ItemIsCurrentlySelected(b,l,a);if(!k&&CountSelectedItems(b)>1)d=true}if(d&&!k)if(CountSelectedItems(b)>0)for(var h=c==null?null:c.querySelectorAll("tr[class*='s4-itm-selected']"),m=h==null?0:h.length,i=0;i<m;i++){var f=h[i],n=f.getAttribute("iid");ItemIsSelectable(f)&&ItemIsCurrentlySelected(b,n,f)&&ToggleItemRowSelection2(b,f,false,false,false)}ToggleItemRowSelection2(b,a,d,true,false);UpdateSelectAllCbx(b,d);previousClickedItemRow=a;g&&CancelEvent(e);return true}function Point(a,b){this.x=a;this.y=b}function GetCellCoordinates(b){var c=0,d=0;while(b.tagName!="TD")b=b.parentNode;var a=b.previousSibling;while(a!=null){c++;a=a.previousSibling}a=b.parentNode.previousSibling;while(a!=null){d++;a=a.previousSibling}return new Point(c,d)}function ElementContainsLink(a){while(a!=null&&a.tagName!="TD"){if(a.tagName=="A")return true;a=a.parentNode}return false}function clearECBMenu(c,b){if(g_menuHtc_lastMenu==null)return false;if(c!=null){var a=c;while(a!=null&&a.tagName!="TD")a=a.parentNode;var e=GetItemRow2(a);MenuHtc_hide();var d=b!=null&&b.IsClientRendering==true;!d&&tdHasEcbMenu(a)&&OnChildItem(a)}return true}function tdHasEcbMenu(d){for(var b=0;b<d.childNodes.length;b++){var a=d.childNodes[b];if(a.nodeType==1&&a.tagName=="DIV"){var c=a.getAttribute("CTXName");if(c!=null&&c!="")return true}}return false}function ToggleItemRowSelection(b,a){if(b==null)b=window.event;if(b.keyCode==Sys.UI.Key.enter)return false;MenuHtc_hide();if(a==null)a=GetItemRow(b);var c=CtxFromRow(a),f=a.getAttribute("iid"),d=!ItemIsCurrentlySelected(c,f,a);if(d&&CountSelectedItems(c)==g_MaximumSelectedItemsAllowed){var e=GetItemRowCbx(a);e.checked=false;alert(Strings.STS.L_BulkSelection_TooManyItems);CancelEvent(b);return true}ToggleItemRowSelection2(c,a,d,true,false);UpdateSelectAllCbx(c,d);previousClickedItemRow=a;if(window.event!=null)window.event.cancelBubble=true;else b.stopPropagation();return true}function ToggleItemRowSelection2(b,a,g,e,f){var d=a.getAttribute("iid"),c=d.split(",");if(c[1]=="")return false;SelectListItem(b,d,c,a,g,f);OnItemSelectionChanged(b,GroupNameFromRow(a),e);return true}function UpdateSelectAllCbx(a,c){if(a==null||a.SelectAllCbx==null)return;a.SelectAllCbx.checked=false;if(c){var d=CountTotalItems(a),b=CountSelectedItems(a);if(b==d&&b>0)a.SelectAllCbx.checked=true}}function SelectListItem(a,c,f,d,e,g){var b=GetItemRowCbx(d);if(b==null)return;b.checked=e;if(typeof a.dictSel=="undefined")a.dictSel=[];if(e){AddCssClassToElement(d,"s4-itm-selected");if(a.dictSel[c]==null){a.CurrentSelectedItems++;a.dictSel[c]={id:f[1],fsObjType:f[2]}}b.nodeName.toUpperCase()!="INPUT"&&b.setAttribute("aria-checked","true")}else{RemoveCssClassFromElement(d,"s4-itm-selected");if(a.dictSel[c]!=null){delete a.dictSel[c];a.CurrentSelectedItems--}b.nodeName.toUpperCase()!="INPUT"&&b.setAttribute("aria-checked","false")}!g&&FocusRow(a,c,d)}function FocusRow(a,c,d){if(a==null)return;a.LastSelectedItemIID=c;var b=GetItemRowCbx(d);if(b!=null){a.RowFocusTimerID!=null&&clearTimeout(a.RowFocusTimerID);a.RowFocusTimerID=setTimeout(function(){a:;SetFocusOnRowDelayed(a,b)},11)}}function SetFocusOnRowDelayed(c,a){if(a==null||c==null)return;a.focus();if(browseris.webKit){var b=ElementInViewportVertical(a,document.getElementById("s4-workspace"));if(b!=g_InViewPort){var d=b==g_OutOfViewPortCloserToTop?true:false;a.scrollIntoView(d)}}c.RowFocusTimerID=null}function CountTotalItems(a){if(a.TotalListItems==null)a.TotalListItems=0;return a.TotalListItems}function CountSelectedItems(a){if(a.CurrentSelectedItems==null)a.CurrentSelectedItems=0;return a.CurrentSelectedItems}function GetCtxRgiidFromIid(c){if(c==null)return null;var b=c.split(",");if(b.length!=3)return null;if(b[1]=="")return null;var d=b[0],a=window["ctx"+d];if(a==null)return null;if(typeof a.dictSel=="undefined")a.dictSel=[];if(a.CurrentSelectedItems==null)a.CurrentSelectedItems=0;return new CtxRgiid(a,b)}function GetCurrentCtx(){a:;var c=document.getElementById("_wpSelected");if(c==null)return null;var a=c.getAttribute("value");if(a==null||a=="")return null;a=a.substr(12);c=document.getElementById(a);if(c==null)return null;var b;if(typeof _spWebPartComponents!="undefined"&&_spWebPartComponents!=null&&_spWebPartComponents[a]&&_spWebPartComponents[a].storageId)b=_spWebPartComponents[a].storageId;else b=c.getAttribute("WebPartID");if(b==null)return null;b=b.toUpperCase();var d=g_ViewIdToViewCounterMap["{"+b+"}"];if(d==null)return null;var e=window["ctx"+d];return e}function GetLastSelectableRowIdx(c,d){if(c==null||d==null)return-1;for(var b=c.rows,a=b.length-1;a>=0;a--){var e=b[a];if(d(e))return a}return-1}function UpdateCtxLastSelectableRow(a,c){if(a==null||c==null)return;a.LastSelectableRowIdx=0;var b=GetLastSelectableRowIdx(c,ItemIsSelectable);if(b!=-1)a.LastSelectableRowIdx=b}function DeselectAllWPItems(){a:;var a=GetCurrentCtx(),b;if(a==null||(b=a.clvp)==null||b.tab==null)return;var d=b.tab,c=getSelectAllCbxFromTable(d);if(c==null)return;c.checked=false;CountSelectedItems(a)>0&&DeselectAllItems(a,d.rows,false)}function callOpenBreadcrumbMenu(a,g,j,i,c,d,e,f,m,n,h,k){if(a==null)a=window.event;a.cancelBubble=true;typeof a.stopPropagation!="undefined"&&a.stopPropagation();var l=function(){a:;SP.UI.PopoutMenu.createPopoutMenuInstanceAndLaunch(g,j,i,c,d,e,f,m,n,h,k)},b;try{b=typeof SP.UI.PopoutMenu.createPopoutMenuInstanceAndLaunch}catch(o){b="undefined"}EnsureScript("SP.js",b,l)}function HasCssClass(d,f,e){var c=d.className;if(c==null)return false;for(var a=c.split(" "),b=0;b<a.length;b++)if(a[b]==f){if(e){a.splice(b,1);d.className=a.join(" ")}return true}return false}function AddSpaceToEmptyTDs(b){var c;if(browseris.ie7down&&b!=null){if(b.getAttribute("addEmptySpace")==null)b.setAttribute("addEmptySpace","true");else return;for(c=0;c<b.childNodes.length;c++){var a=b.childNodes[c];if(a.nodeType==1&&a.tagName=="TD"&&a.width!="1%")if(a.innerHTML=="")a.innerHTML="&#8203;";else if(a.innerText==""){while(a!=null&&a.nodeType==1&&a.innerHTML!="")a=a.firstChild;if(a!=null&&a.nodeType==1&&a.innerHTML==""&&(a.tagName=="SPAN"||a.tagName=="DIV"||a.tagName=="NOBR"))a.innerHTML="&#8203;"}}}}function AddBorderToLastCell(c){if(c.getAttribute("setEdgeBorder")!=null)return;var a=c.cells;if(a!=null&&a.length>0){if(browseris.ie7down)a[0].className+="";var b=a[a.length-1];if(b!=null)if(b.className!="")b.className+=" ms-vb-lastCell";else b.className="ms-vb-lastCell"}c.setAttribute("setEdgeBorder","true")}function AddCssClassToElement(a,b){var c=a.className;if(c!=null){if(!HasCssClass(a,b))a.className=a.className+" "+b}else a.className=b}function RemoveCssClassFromElement(b,a){HasCssClass(b,a,true)}function AddGallery_TypeOf(c){if(c!=null){var b=typeof c;if(b=="object")if(b.constructor!=null){var a=c.constructor.toString(),d=a.indexOf(" "),e=a.indexOf("("),f=a.substr(d+1,e-d-1);return f}return b}return null}function IsLanguageSupportedInSilverlight(a){return a==1025||a==1037||a==1054||a==1081?false:true}function IsSilverlightInstalled(b){if(typeof b=="undefined")b=null;var a=false,l=null;try{var f=null,k=false;if(window.ActiveXObject!=null)try{f=new ActiveXObject("AgControl.AgControl");if(b===null)a=true;else if(typeof f.IsVersionSupported!="undefined"&&f.IsVersionSupported(b))a=true;f=null}catch(m){k=true}else k=true;if(k){var j=typeof navigator.plugins!="undefined"?navigator.plugins["Silverlight Plug-In"]:null;if(j!=null)if(b===null)a=true;else{var i=typeof j.description=="string"?j.description:"";if(i==="1.0.30226.2")i="2.0.30226.2";var c=i.split(".");while(c.length>3)c.pop();while(c.length<4)c.push(0);var e=b.split(".");while(e.length>4)e.pop();var d,h,g=0;do{d=parseInt(e[g]);h=parseInt(c[g]);g++}while(g<e.length&&d===h);if(d<=h&&!isNaN(d))a=true}}}catch(m){a=false}return a}function IsAddGalleryProviderEnabled(d,c){var a,b=true;try{if(window.XMLHttpRequest!=null){a=new XMLHttpRequest;a.open("HEAD",d+c+".deny.xml",false);a.send();if(a.status==200)b=false}}catch(e){}return b}function SilverlightBasedCreateHandler(a){var k=new Date,f,b,c,i,h;if(typeof _spPageContextInfo!="undefined"){if(_spPageContextInfo.siteServerRelativeUrl!=null){b=_spPageContextInfo.siteServerRelativeUrl;if(b.charAt(b.length-1)!="/")b=b+"/"}else return true;if(_spPageContextInfo.webServerRelativeUrl!=null){c=_spPageContextInfo.webServerRelativeUrl;if(c.charAt(c.length-1)!="/")c=c+"/";f=c+"_layouts/15/AddGallery.aspx"}else return true;if(Boolean(_spPageContextInfo.webLanguage))i=_spPageContextInfo.webLanguage;else return true;if(Boolean(_spPageContextInfo.currentLanguage))h=_spPageContextInfo.currentLanguage;else return true}else return true;if(FV4UI()&&IsSilverlightInstalled("3.0.40624.0")&&IsLanguageSupportedInSilverlight(i)&&IsLanguageSupportedInSilverlight(h)){if(a==null)a="All";if(AddGallery_TypeOf(a)!="string")return true;a=a.toLowerCase();if(a=="page"||a=="publishingpage")return true;var d=[];d=a.split(":");if(d.length==2&&d[0]=="provider")if(!IsAddGalleryProviderEnabled(b+"_layouts/15/AddGalleryProviders/",d[1]))return true;var g=function(b,c){a:;if(FV4UI()){if(Boolean(b))if(Boolean(c))window.location=c;else window.location.reload()}else{var a=typeof b=="string"?b:null;if(a!=null&&a!="")window.location.href=a;else window.location.reload()}},j=function(){a:;var i={scope:a,currentWeb:c,currentSiteCollection:b,clickDateTime:k},e=a=="page"?660:1012,d=a=="page"?360:600;if(FV4UI())var j={width:e,height:d,resizable:true,status:false,menubar:false,help:false,url:f,dialogReturnValueCallback:g,args:i},l=SP.UI.ModalDialog.showModalDialog(j);else{var h;if(window.showModalDialog!=null)h="dialogWidth:"+String(e)+"px;dialogHeight:"+String(d)+"px;resizable:yes;status:no;menubar:no;help:no";else h="width="+String(e)+",height="+String(d)+",resizable=yes,status=no,menubar=no,help=no";var m=commonShowModalDialog(f,h,g,i)}},e;try{e=typeof SP.UI.ModalDialog.showModalDialog}catch(l){e="undefined"}EnsureScript("SP.UI.Dialog.js",e,j);return false}return true}function LaunchCreateHandler(a){if(typeof __CreateHandler!="undefined"&&__CreateHandler!=null)return __CreateHandler(a);else try{return SilverlightBasedCreateHandler(a)}catch(c){return true}}var isdlg;function QstringStruct(b){if(b==null)b="";if(b.indexOf("?")==0)b=b.substring(1);this.nonFilterParams={};this.filterParams={};for(var f=b.split("&"),e=0;e<f.length;e++){var h=f[e],a=h.split("=");if(a.length==2)if(a[0].search("^Filter")!=-1){var d=a[0].match(new RegExp("[0-9]*$")),c;if(typeof this.filterParams[d]!="undefined")c=this.filterParams[d];else{c={};this.filterParams[d]=c}var g=a[0].match(new RegExp("^Filter[^0-9]*"));c[g]=a[1]}else this.nonFilterParams[a[0]]=a[1]}}function QstringStructToString(){a:;var a=this.toArray();return"?"+a.join("&")}function QstringStructToArray(){a:;var c=[],b,a,d=1,f=typeof this.filterParams.length=="number"?this.filterParams.length:0;for(b in this.filterParams){var e=this.filterParams[b];for(b in e){a=[];a.push(b);a.push(d);a.push("=");a.push(e[b]);c.push(a.join(""))}d++}for(b in this.nonFilterParams){a=[];a.push(b);a.push("=");a.push(this.nonFilterParams[b]);c.push(a.join(""))}return c}function Diff(){}function ReconcileQstringFilters(k,l){var c=[];c.push(new QstringStruct(k));c.push(new QstringStruct(l));for(var g=[],j,e,a,b=0;b<c.length;b++)for(e in c[b].nonFilterParams)if(b==0||typeof c[0].nonFilterParams[e]=="undefined"&&b==1){a=[];a.push(e);a.push("=");a.push(c[b].nonFilterParams[e]);g.push(a.join(""))}var i=1,h={};for(b=0;b<c.length;b++)for(j in c[b].filterParams){var d=c[b].filterParams[j],f=typeof d.FilterField=="string"?d.FilterField:null;if(f==null)f=typeof d.FilterFields=="string"?d.FilterFields:null;if(f!=null&&typeof h[f]=="undefined"){for(e in d){a=[];a.push(e);a.push(i);a.push("=");a.push(d[e]);g.push(a.join(""))}i++;h[d.FilterField]=d}}return g.join("&")}function PageActionClick(){a:;EnsureScript("ribbon",TypeofFullName("SP.Ribbon.PageStateActionButton"),function(){a:;SP.Ribbon.PageStateActionButton.sendCommand()})}function ShowWebPartAdder(a){LoadWPAdderOnDemand();ExecuteOrDelayUntilEventNotified(function(){a:;var b=window.WPAdder;if(b!=null){b._showCategoryColumn(true);b._setZone(a);b.show()}},"_spEventWebPartAdderReady")}function GenerateXMLArray(b,c){var a=[];if(b!=null){var d="<"+c+">",e="</"+c+">";for(var f in b){a.push(d);a.push(b[f]);a.push(e)}}return a.join("")}function GetAncestor(a,b){while(a!=null&&a.tagName!=b)a=a.parentNode;return a}function GetAncestorByTagNames(b,c){if(b==null)return null;var a=b.parentNode;while(a!=null){if(Array.contains(c,a.tagName))break;a=a.parentNode}return a}function StURLNormalize(a){if(a.substr(0,2)=="\\\\"||a.substr(0,2)=="//")a="file:"+a;if(a.substr(0,5)=="file:")a=a.replace(/\\/g,"/");return a}function QuickLaunchInitDroppable(){a:;if(Boolean(g_QuickLaunchControlIds)){for(var a=[],c=0;c<g_QuickLaunchControlIds.length;c++){var g=g_QuickLaunchControlIds[c],e=document.getElementById(g);if(Boolean(e)){var b=e.querySelectorAll(".ms-quicklaunch-dropNode");if(Boolean(b))for(var d=0;d<b.length;d++){var f=b[d];a.push(f)}}}a.length>0&&EnsureScriptParams("DragDrop.js","InitMenuItemAsDroppable",a)}}var g_listItemCache;function GetListItemByIID(b){if(typeof g_listItemCache[b]!=="undefined")return g_listItemCache[b];var d=GetCtxRgiidFromIid(b),a=d.ctx,e=d.rgiid[1];if(typeof a==="undefined"||a===null||typeof a.ListData==="undefined"||a.ListData===null||typeof a.ListData.Row==="undefined"||a.ListData.Row===null)throw"Error: ctx ListData could not be found";for(var c=0;c<a.ListData.Row.length;c++)if(a.ListData.Row[c].ID===e)return g_listItemCache[b]=a.ListData.Row[c];return g_listItemCache[b]=null}function FixRibbonAndPageLayout(e){a:;var c=GetCachedElement("s4-ribbonrow");if(Boolean(c)){c.className=c.className.replace(RegExp("s4-ribbonrowhidetitle"),"");var d=GetCachedElement("s4-titlerow"),j=document.body;if(Boolean(d)){d.className=d.className.replace(RegExp("s4-titlerowhidetitle"),"");if(e)d.style.display="block";else d.style.display="none"}var g=c.querySelector(".ms-core-webpartadder");if(Boolean(g))if(GetCurrentEltStyle(g,"position")=="absolute"){var a=document.getElementById("Ribbon");if(Boolean(a)){var b;if(e)b=AbsTop(a)+a.offsetHeight;else{var f=a.querySelector(".ms-cui-tabContainer");if(Boolean(f))b=AbsTop(f)+f.offsetHeight;else b=AbsTop(a)+a.offsetHeight}b-=AbsTop(c);g.style.top=b.toString()+"px"}}}var i=g_spribbon.isInited;g_spribbon.isInited=true;var h=g_spribbon.isMinimized;g_spribbon.isMinimized=e;(h!=e||!i)&&FixRibbonAndWorkspaceDimensions()}var g_fRibbonAnimationEnabled,g_fSkipAnimation,g_fSkipNextTabExpandAnimation;function PrepareRibbonForAnimation(e,f){g_fRibbonAnimationEnabled=ajaxNavigate.get_search().indexOf("IsDlg=1")==-1&&SPAnimation.Settings.IsAnimationEnabled();if(!g_fRibbonAnimationEnabled)return;var c=document.getElementById("Ribbon"),b=c.childNodes[2],g=pxToNum(g_spribbon.maximizedHeight)-pxToNum(g_spribbon.minimizedHeight);if(e){if(b!=null){var a=SPAnimationUtility.BasicAnimator.CloneElement(b,false,true,false,false),d=a.firstChild;SPAnimationUtility.BasicAnimator.PositionAbsoluteExact(d,0,0,null,null);SPAnimationUtility.BasicAnimator.Move(d,0,-g,function(){a:;a.parentNode!=null&&a.parentNode.removeChild(a);b.style.visibility=""},null)}}else{if(g_fSkipNextTabExpandAnimation){g_fSkipAnimation=true;g_fSkipNextTabExpandAnimation=false}else g_fSkipAnimation=f&&Boolean(b);!g_fSkipAnimation&&c.className.indexOf("ms-cui-animatingRibbon")==-1&&CSSUtil.AddClass(c,"ms-cui-animatingRibbon")}}function AnimateRibbonMinimizedChanged(b){if(!g_fRibbonAnimationEnabled||b)FixRibbonAndPageLayout(b);else if(!g_fSkipAnimation){var c=document.getElementById("Ribbon"),d=c.childNodes[2],e=pxToNum(g_spribbon.maximizedHeight)-pxToNum(g_spribbon.minimizedHeight);PrepareRibbonForAnimation(b,false);if(d!=null){var a=d.firstChild;a.style.top=String(-e)+"px";fRightToLeft?a.style.right="0px":a.style.left="0px";SPAnimationUtility.BasicAnimator.Move(a,0,0,function(){a:;var d=document.getElementById("Ribbon").childNodes[2];if(d!=null){var e=d.firstChild;if(e!=null&&a.id=="Ribbon.BlankTab"&&e.id=="Ribbon.BlankTab")g_fSkipNextTabExpandAnimation=true}if(a.parentNode==null||a.parentNode.parentNode==null||a.parentNode.parentNode.nodeType!=1)b=true;CSSUtil.RemoveClass(c,"ms-cui-animatingRibbon");FixRibbonAndPageLayout(b)},null)}}}function UpdateAnimationUserControl(c){var b=document.getElementById("TurnOnAnimation"),a=document.getElementById("TurnOffAnimation"),e=document.getElementById("linkTurnOnAnimation"),d=document.getElementById("linkTurnOffAnimation");if(SPAnimation.Settings.IsAnimationEnabled()){if(b!=null)b.style.display="none";if(a!=null)a.style.display="";c&&d!=null&&d.focus()}else{if(b!=null)b.style.display="";if(a!=null)a.style.display="none";c&&e!=null&&e.focus()}}function ToggleAnimationStatus(){a:;if(SPAnimation.Settings.IsAnimationEnabled())SPAnimation.Settings.DisableAnimation();else SPAnimation.Settings.EnableAnimation();UpdateAnimationUserControl(true)}function setupPageDescriptionCallout(){a:;var b=document.getElementById("ms-pageDescription");if(Boolean(b)){var a=GetInnerText(b),c=document.getElementById("ms-pageDescriptionDiv");if(Boolean(a)){setInnerText(b,a);a=a.replace(/(\n|\r|\t| )/g,"");if(Boolean(a)){SPAnimationUtility.BasicAnimator.FadeIn(document.getElementById("ms-pageDescriptionDiv"),null,null);EnsureScriptFunc("callout.js","Callout",function(){a:;CalloutManager.createNew({ID:"ms-pageDescriptionCallout",launchPoint:c,openOptions:{event:"click",showCloseButton:true},content:b.innerHTML})})}}}}function SendAjaxFormPostWithFormDigest(d,b,c){var a=new XMLHttpRequest;a.open("POST",d,true);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");b!=null&&a.setRequestHeader("Content-length",b.length);a.setRequestHeader("Connection","Keep-alive");a.setRequestHeader("x-requestdigest",document.forms[MSOWebPartPageFormName].__REQUESTDIGEST.value);a.setRequestHeader("x-requested-with","XMLHttpRequest");a.onreadystatechange=function(){a:;if(a.readyState==4)c!=null&&c(a)};a.send(b)}function numToPx(a){return String(a)+"px"}var g_InViewPort,g_OutOfViewPortCloserToTop,g_OutOfViewPortCloserToBottom;function ElementInViewportVertical(b,a){if(b==null)return g_InViewPort;if(a==null)a=document.body;var f=AbsTop(b),g=AbsTop(a),h=a.scrollTop,e=g+h,i=b.offsetHeight,d=f-e,c=e+a.offsetHeight-(f+i);return d>=0&&c>=0?g_InViewPort:Math.abs(d)<Math.abs(c)?g_OutOfViewPortCloserToTop:g_OutOfViewPortCloserToBottom}function GetSuiteHelpLink(c){var a=null;if(c!=null)a=JSON.parse(c);var b=null;if(a!=null)if(typeof a.HelpLink!="undefined"&&typeof a.HelpLink.Url=="string")b=a.HelpLink.Url;return b}function SuiteLinksEmptyOrSuiteHelpLinkIsCached(){a:;var b=OpenSuiteLinksJson(),a=false;if(b=="{}")a=true;else a=!IsStrNullOrEmpty(GetSuiteHelpLink(b));return a}function GetCurrentUserKey(){a:;var a=null;if(_spPageContextInfo!=null)a=_spPageContextInfo.systemUserKey;return a}function GetCurrentUICultureOrNone(){a:;var a="none";if(_spPageContextInfo!=null&&Boolean(_spPageContextInfo.currentUICultureName))a=_spPageContextInfo.currentUICultureName;return a}function GetSuiteLinks(d,b){a:;var f=GetCurrentUICultureOrNone(),e=null,a=null,c=false;if(!IsNullOrUndefined(window.localStorage)&&typeof window.localStorage.SPSuiteLinksJson=="string"){if(GetCurrentUserKey()==window.localStorage.SPSuiteLinksUserKey){e=window.localStorage.SPSuiteLinksLanguage;a=window.localStorage.SPSuiteLinksJson;var g=Date.parse(window.localStorage.SPSuiteLinksDate);c=!(g>0)||+new Date-g>24*60*60*1e3}}else if(typeof SPSuiteNavBar!="undefined"&&typeof SPSuiteNavBar.cachedJson=="string"&&!IsStrNullOrEmpty(SPSuiteNavBar.cachedJson)){c=false;e=f;a=SPSuiteNavBar.cachedJson}if(typeof SP._yam!=="undefined")if(!c&&Boolean(a)&&a.indexOf(SP._yam?"ShellNewsfeed":"ShellYammer")!==-1)c=true;if(e!=f||a==null){if(d!=null)d(function(a){SP.SOD.executeFunc("suitelinks.js","CacheSuiteLinks",function(){a:;CacheSuiteLinks(a);b!=null&&b(a)})});else b!=null&&b(null);return}if(c)d!=null&&d(function(b){SP.SOD.executeFunc("suitelinks.js","CacheSuiteLinks",function(){a:;if(CacheSuiteLinks(b))a=b})});b!=null&&b(a)}function CtxFromElement(e){if(e==null)return null;var f=null,j=null;f=GetAncestor(e,"TABLE");var b=f.getElementsByTagName("SCRIPT");if(b==null)return null;var a;if(b.length>0)a=b[0];while(!fIsNullOrUndefined(a)&&!fIsNullOrUndefined(a.id)&&a.id.indexOf("scriptBodyWPQ")==-1)a=a.previousSibling;var c=null,d=null;if(!fIsNullOrUndefined(a)&&!fIsNullOrUndefined(a.id)){c=a.id;var h=c.indexOf("WPQ");if(h!=-1)d=c.substr(h)}if(!fIsNullOrUndefined(d)&&!fIsNullOrUndefined(g_ctxDict))for(var i in g_ctxDict){var g=g_ctxDict[i];if(g.wpq==d)return g}return null}function $dg(a){a:;if(!(a in window))window[a]=undefined}var UTF8_1ST_OF_2,UTF8_1ST_OF_3,UTF8_1ST_OF_4,UTF8_TRAIL,HIGH_SURROGATE_BITS,LOW_SURROGATE_BITS,SURROGATE_6_BIT,SURROGATE_ID_BITS,SURROGATE_OFFSET;function escapeProperlyCoreCore(f,g,h,i){var c="",b,d=0,k=" \"%<>'&";if(typeof f=="undefined")return"";for(d=0;d<f.length;d++){var a=f.charCodeAt(d),e=f.charAt(d);if(g&&(e=="#"||e=="?")){c+=f.substr(d);break}if(h&&e=="&"){c+=e;continue}if(a<=127){if(i)c+=e;else if(a>=97&&a<=122||a>=65&&a<=90||a>=48&&a<=57||g&&a>=32&&a<=95&&k.indexOf(e)<0)c+=e;else if(a<=15)c+="%0"+a.toString(16).toUpperCase();else if(a<=127)c+="%"+a.toString(16).toUpperCase()}else if(a<=2047){b=UTF8_1ST_OF_2|a>>6;c+="%"+b.toString(16).toUpperCase();b=UTF8_TRAIL|a&63;c+="%"+b.toString(16).toUpperCase()}else if((a&SURROGATE_6_BIT)!=HIGH_SURROGATE_BITS){b=UTF8_1ST_OF_3|a>>12;c+="%"+b.toString(16).toUpperCase();b=UTF8_TRAIL|(a&4032)>>6;c+="%"+b.toString(16).toUpperCase();b=UTF8_TRAIL|a&63;c+="%"+b.toString(16).toUpperCase()}else if(d<f.length-1){a=(a&1023)<<10;d++;var j=f.charCodeAt(d);a|=j&1023;a+=SURROGATE_OFFSET;b=UTF8_1ST_OF_4|a>>18;c+="%"+b.toString(16).toUpperCase();b=UTF8_TRAIL|(a&258048)>>12;c+="%"+b.toString(16).toUpperCase();b=UTF8_TRAIL|(a&4032)>>6;c+="%"+b.toString(16).toUpperCase();b=UTF8_TRAIL|a&63;c+="%"+b.toString(16).toUpperCase()}}return c}function escapeProperly(a){a:;return escapeProperlyCoreCore(a,false,false,false)}function escapeProperlyCore(b,a){a:;return escapeProperlyCoreCore(b,a,false,false)}function escapeUrlForCallback(a){var c=a.indexOf("#"),b=a.indexOf("?");if(c>0&&(b==-1||c<b)){var d=a.substr(0,c);if(b>0)d+=a.substr(b);a=d}return escapeProperlyCoreCore(a,true,false,true)}function IsSTSPageUrlValid(a){return a.substr(0,4)=="http"||a.substr(0,1)=="/"||a.indexOf(":")==-1}function PageUrlValidation(a){if(IsSTSPageUrlValid(a))return a;else{alert(Strings.STS.L_InvalidPageUrl_Text);return""}}function SelectRibbonTab(b,c){a:;var a;try{a=SP.Ribbon.PageManager.get_instance().get_ribbon()}catch(d){}if(!Boolean(a))typeof _ribbonStartInit!="undefined"&&_ribbonStartInit(b,false,null);else(c||a.get_selectedTabId()=="Ribbon.Read")&&a.selectTabById(b)}function FV4UI(){a:;return typeof _fV4UI!="undefined"&&_fV4UI}function GoToHistoryLink(c,d){if(c.href==null)return;var b=c.href,f=c.href.indexOf("?")>=0?"&":"?",e=f+"VersionNo="+d,a=GetSource();if(a!=null&&a!="")a="&Source="+a;b=c.href+e+a;if(isPortalTemplatePage(b))window.top.location.href=STSPageUrlValidation(b);else window.location.href=STSPageUrlValidation(b)}function GetGotoLinkUrl(b){if(b.href==null)return null;var d=b.href.indexOf("?")>=0?"&":"?",a=GetSource();if(a!=null&&a!="")a=d+"Source="+a;var c=b.href+a;return c}function GoToLink(c){a:;var a=GetGotoLinkUrl(c);if(a==null)return;var b=true;if(typeof window.top.SPUpdatePage!=="undefined")b=window.top.SPUpdatePage(a);if(b)if(c.target==="_blank")window.open(a,"_blank");else if(isPortalTemplatePage(a))window.top.location.href=STSPageUrlValidation(a);else window.location.href=STSPageUrlValidation(a)}function GoToLinkOrDialogNewWindow(a){if(a.href==null)return;if(Boolean(ajaxNavigate.get_search().match(RegExp("[?&]IsDlg=1"))))window.open(a.href);else GoToLink(a)}function GoToDiscussion(b){var c=b.indexOf("?")>=0?"&":"?",a=GetSource();if(a!=null&&a!="")b+=c+"TopicsView="+a;STSNavigate(b)}function GetCurrentEltStyle(b,c){if(Boolean(b.currentStyle))return b.currentStyle[c];else if(Boolean(window)&&Boolean(window.getComputedStyle)){var a=window.getComputedStyle(b,null);if(Boolean(a)&&Boolean(a.getPropertyValue))return a.getPropertyValue(c)}return null}function InsertNodeAfter(a,b){if(a==null||a.parentNode==null||b==null)return;var d=a.parentNode,c=a.nextSibling;if(c==null)d.appendChild(b);else d.insertBefore(b,c)}function EEDecodeSpecialChars(b){var a=b.replace(/&quot;/g,'"');a=a.replace(/&gt;/g,">");a=a.replace(/&lt;/g,"<");a=a.replace(/&#39;/g,"'");a=a.replace(/&amp;/g,"&");return a}function ShowAttachmentRows(){a:;var b=document.getElementById("idAttachmentsTable"),a=document.getElementById("idAttachmentsRow");if(a!=null)if(b==null||b.rows.length==0)a.style.display="none";else a.style.display="table-row"}function PreventDefaultNavigation(){a:;var a=window.event;if(a!=null)if(a.preventDefault==null)a.returnValue=false;else a.preventDefault()}function cancelDefault(a){if(typeof a=="undefined"||a==null)a=window.event;if(!(typeof a=="undefined"||a==null)){if(typeof a.stopPropagation=="function")a.stopPropagation();else a.cancelBubble=true;if(typeof a.preventDefault=="function")a.preventDefault();else a.returnValue=false}return false}function IsArray(a){return typeof a=="object"&&a instanceof Array}function IsNullOrUndefined(a){return a==null||a==undefined}function SetOpacity(a,b){XUIHtml.SetOpacity(a,b)}function GetOpacity(a){return XUIHtml.GetOpacity(a)}var XUIHtml;function Calendar_InitializePrototype(){a:;Calendar.prototype={actualDateEnd:undefined,actualDateStart:undefined,dateDP:undefined,dateEnd:undefined,dateStart:undefined,day:undefined,dow:undefined,iperiod:undefined,maxQuarterEnd:undefined,month:undefined,mon:undefined,mpEvents:undefined,mpIchan:undefined,mpSpan:undefined,msDay:undefined,msHour:undefined,msWeek:undefined,multiDay:undefined,stViewID:undefined,yr:undefined};Calendar.prototype.AddEvent=CalAddEvent;Calendar.prototype.AddFullEvent=CalAddFullEvent;Calendar.prototype.AssignChannels=CalAssignChannels;Calendar.prototype.BuildUI=CalBuildUI;Calendar.prototype.DPDayStyle=CalDPDayStyle;Calendar.prototype.DayStyle=CalDayStyle;Calendar.prototype.IchanNext=CalIchanNext;Calendar.prototype.IrwFromDate=CalIrwFromDate;Calendar.prototype.MoveDate=CalMoveDate;Calendar.prototype.MoveDay=CalMoveDay;Calendar.prototype.MoveMonth=CalMoveMonth;Calendar.prototype.MoveToDay=CalMoveToDay;Calendar.prototype.MoveToToday=CalMoveToToday;Calendar.prototype.MoveVDay=CalMoveDay;Calendar.prototype.MoveWeek=CalMoveWeek;Calendar.prototype.PlaceEventInRow=CalPlaceEventInRow;Calendar.prototype.Post=CalDoPost;Calendar.prototype.SetDate=CalSetDate;Calendar.prototype.SetDateFromGrid=CalSetDateFromGrid;Calendar.prototype.SpanCheck=CalSpanCheck;Calendar.prototype.StBuild=CalStBuild;Calendar.prototype.StBuildDHTML=CalStBuildDHTML;Calendar.prototype.StBuildPicker=CalStBuildPicker;Calendar.prototype.StDayMonthYear=CalStDayMonthYear;Calendar.prototype.StDaySpanMonthYear=CalDaySpanMonthYear;Calendar.prototype.StDownlevelBuild=CalStDownlevelBuild;Calendar.prototype.StMonthYear=CalStMonthYear;Calendar.prototype.rgDOW=CalGetDOW;Calendar.prototype.rgDOWLong=CalGetDOWLong;Calendar.prototype.rgDOWDP=CalGetDOWDP;Calendar.prototype.rgMonths=CalGetMonths;Calendar.msMinute=1e3*60;Calendar.msHour=Calendar.msMinute*60;Calendar.msDay=Calendar.msHour*24;Calendar.msWeek=Calendar.msDay*7}function CalEvent_InitializePrototype(){a:;CalEvent.prototype.actualDateEnd=undefined;CalEvent.prototype.actualDateStart=undefined;CalEvent.prototype.dateEnd=undefined;CalEvent.prototype.dateStart=undefined;CalEvent.prototype.ichan=undefined;CalEvent.prototype.ihour=undefined;CalEvent.prototype.multiDay=undefined;CalEvent.prototype.multiQuarter=undefined;CalEvent.prototype.rowspan=undefined;CalEvent.prototype.rgIcons=undefined;CalEvent.prototype.stDesc=undefined;CalEvent.prototype.stLocation=undefined;CalEvent.prototype.stTitle=undefined;CalEvent.prototype.stURL=undefined;CalEvent.prototype.FOverlap=EvtFOverlap;CalEvent.prototype.StTip=EvtStTip}function Span_InitializePrototype(){a:;Span.prototype.evt=undefined;Span.prototype.cbucket=undefined}function MsFloorTime(d,b,c){var a=d.getTime();if(c)a=a-1;a=b*Math.floor(a/b);return a}function Calendar(d,b,c,g){a:;if(!Boolean(c))c=new DateOptions;this.dopt=c;var i=1;if(d==null||b==null){var a=StURLGetVar("CalendarDate");if(a!=""){d=Number(a.substr(0,4));var h=a.indexOf("-",5);if(h==-1)b=Number(a.substr(5))-1;else{b=Number(a.substr(5,h-5))-1;i=Number(a.substr(h+1))}}if(a==""||isNaN(Number(c.DateYMD(d,b,1)))){var f=this.dopt.Today();d=f.getUTCFullYear();b=f.getUTCMonth();i=f.getUTCDate()}}var e=StURLGetVar("CalendarPeriod");if(e=="week"){this.period="week";this.iperiod=1}else if(e=="day"){this.period="vday";this.iperiod=2}else if(e=="vday"){this.period="vday";this.iperiod=2}else if(e=="month"){this.period="month";this.iperiod=0}else{this.period=c.CalendarPeriod;if(this.period=="week")this.iperiod=1;else if(this.period=="day")this.iperiod=2;else if(this.period=="vday")this.iperiod=2;else this.iperiod=0}this.SetDate(d,b,i);if(this.iperiod==0){this.cchanMin=4;this.cchanMax=4}else if(this.iperiod==1){this.cchanMin=20;this.cchanMax=20}else{this.cchanMin=3;this.cchanMax=100}this.ievtMax=0;this.rgEvt=[];this.fUseDHTML=browseris.ie&&browseris.verIEFull>4&&browseris.win32||browseris.nav6up;this.fDatePicker=false;this.dateDP=null;if(!Boolean(g))g="cal";this.stObject=g}function CalGetDOW(a){a:;var b=[Strings.STS.L_rgDOW0_Text,Strings.STS.L_rgDOW1_Text,Strings.STS.L_rgDOW2_Text,Strings.STS.L_rgDOW3_Text,Strings.STS.L_rgDOW4_Text,Strings.STS.L_rgDOW5_Text,Strings.STS.L_rgDOW6_Text];return b[a]}function CalGetDOWLong(b){a:;var a=[Strings.STS.L_rgDOWLong0_Text,Strings.STS.L_rgDOWLong1_Text,Strings.STS.L_rgDOWLong2_Text,Strings.STS.L_rgDOWLong3_Text,Strings.STS.L_rgDOWLong4_Text,Strings.STS.L_rgDOWLong5_Text,Strings.STS.L_rgDOWLong6_Text];return a[b]}function CalGetDOWDP(b){a:;var a=[Strings.STS.L_rgDOWDP0_Text,Strings.STS.L_rgDOWDP1_Text,Strings.STS.L_rgDOWDP2_Text,Strings.STS.L_rgDOWDP3_Text,Strings.STS.L_rgDOWDP4_Text,Strings.STS.L_rgDOWDP5_Text,Strings.STS.L_rgDOWDP6_Text];return a[b]}function CalGetMonths(b){a:;var a=[Strings.STS.L_rgMonths0_Text,Strings.STS.L_rgMonths1_Text,Strings.STS.L_rgMonths2_Text,Strings.STS.L_rgMonths3_Text,Strings.STS.L_rgMonths4_Text,Strings.STS.L_rgMonths5_Text,Strings.STS.L_rgMonths6_Text,Strings.STS.L_rgMonths7_Text,Strings.STS.L_rgMonths8_Text,Strings.STS.L_rgMonths9_Text,Strings.STS.L_rgMonths10_Text,Strings.STS.L_rgMonths11_Text];return a[b]}function CalStMonthYear(){a:;var a="";if(this.iperiod!=0)a+='<span style="cursor:pointer;" onmouseover="HighlightText(this, \'red\');" onmouseout="HighlightText(this, \'\');"'+StClickEvent(this.stObject+".MoveMonth(0)")+">";var b="",c="",d="";switch(this.dopt.stDateOrder){case"MDY":case"DMY":c=this.rgMonths(this.mon);d=String(this.yr);b=Strings.STS.L_MYDATE_Text;break;case"YMD":c=String(this.yr);d=this.rgMonths(this.mon);b=Strings.STS.L_YMDATE_Text}a+=StBuildParam(b,[c,d]);if(this.iperiod!=0)a+="</span>";return a}function CalDaySpanMonthYear(){a:;var i="",k="",l="",a="",b="",c="",d="",e="",f="",g="",h="";if(this.iperiod!=0)i+='<span style="cursor:pointer;" onmouseover="HighlightText(this, \'red\');" onmouseout="HighlightText(this, \'\');"'+StClickEvent(this.stObject+".MoveMonth(0)")+">";var j=this.dateStart.getUTCFullYear()!=this.dateEnd.getUTCFullYear();switch(this.dopt.stDateOrder){case"MDY":c=this.rgMonths(this.dateStart.getUTCMonth());d=String(this.dateStart.getUTCDate());e=String(this.dateStart.getUTCFullYear());if(j)a=Strings.STS.L_MDYDATE_Text;else a=Strings.STS.L_MDYDATESameYear_Text;f=this.rgMonths(this.dateEnd.getUTCMonth());g=String(this.dateEnd.getUTCDate());h=String(this.dateEnd.getUTCFullYear());b=Strings.STS.L_MDYDATE_Text;break;case"DMY":c=String(this.dateStart.getUTCDate());d=this.rgMonths(this.dateStart.getUTCMonth());e=String(this.dateStart.getUTCFullYear());if(j)a=Strings.STS.L_DMYDATE_Text;else a=Strings.STS.L_DMYDATESameYear_Text;f=String(this.dateEnd.getUTCDate());g=this.rgMonths(this.dateEnd.getUTCMonth());h=String(this.dateEnd.getUTCFullYear());b=Strings.STS.L_DMYDATE_Text;break;case"YMD":c=String(this.dateStart.getUTCFullYear());d=this.rgMonths(this.dateStart.getUTCMonth());e=String(this.dateStart.getUTCDate());if(j)a=Strings.STS.L_YMDDATE_Text;else a=Strings.STS.L_YMDDATESameYear_Text;f=String(this.dateEnd.getUTCFullYear());g=this.rgMonths(this.dateEnd.getUTCMonth());h=String(this.dateEnd.getUTCDate());b=Strings.STS.L_YMDDATE_Text}k=StBuildParam(a,[c,d,e]);l=StBuildParam(b,[f,g,h]);i+=StBuildParam(Strings.STS.L_DATE1DATE2_Text,[k,l]);if(this.iperiod!=0)i+="</span>";return i}function CalStDayMonthYear(){a:;var e="";e+='<span style="cursor:pointer;" onmouseover="HighlightText(this, \'red\');" onmouseout="HighlightText(this, \'\');"'+StClickEvent(this.stObject+".MoveMonth(0)")+">";var a="",b="",c="",d="",f=this.rgDOWLong(this.dow);switch(this.dopt.stDateOrder){case"MDY":b=this.rgMonths(this.mon);c=String(this.day);d=String(this.yr);a=Strings.STS.L_MDY_DOW_DATE_Text;break;case"DMY":b=String(this.day);c=this.rgMonths(this.mon);d=String(this.yr);a=Strings.STS.L_DMY_DOW_DATE_Text;break;case"YMD":b=String(this.yr);c=this.rgMonths[this.mon];d=String(this.day);a=Strings.STS.L_YMD_DOW_DATE_Text}e+=StBuildParam(a,[b,c,d,f]);e+="</span>";return e}function CalSetDate(d,c,e){a:;var a=new Date(Date.UTC(d,c,e));this.dateStart=new Date(a.getTime());this.dateEnd=new Date(a.getTime());this.givenDate=new Date(a.getTime());if(this.iperiod==0){this.dateStart.setUTCDate(1);this.dateEnd.setTime(Date.UTC(d,c+1,0))}var b=0;if(this.iperiod!=2){this.dateStart.setUTCDate(this.dateStart.getUTCDate()-(this.dateStart.getUTCDay()-this.dopt.dow+7)%7);b=this.IrwFromDate(this.dateEnd);this.dateEnd.setUTCDate(this.dateEnd.getUTCDate()+b*7-1)}this.irwMax=b+1;if(this.iperiod==1){this.dateEnd.setTime(this.dateStart.getTime()+6*Calendar.msDay);a=new Date(this.dateStart.getTime()+3*Calendar.msDay)}else if(this.iperiod==2)this.dateTodayEnd=new Date(this.dateStart.getTime()+Calendar.msDay-1);this.day=a.getUTCDate();this.mon=a.getUTCMonth();this.yr=a.getUTCFullYear();this.dow=a.getUTCDay()}function CalDayStyle(b,d,f,e){var a,c=this.dopt.Today();if(b.getTime()==c.getTime())if(d)a=" style=\"border-color:'#FFD275'; border-bottom-style:solid; border-left-style:solid; border-right-style:solid; border-bottom-width:2pt; border-left-width:2pt; border-right-width:2pt\" ";else if(f)a=" style=\"border-color:'#FFD275'; border-top-style:solid; border-left-style:solid; border-right-style:solid; border-top-width:2pt; border-left-width:2pt; border-right-width:2pt\" ";else a=" style=\"border-color:'#FFD275'; border-left-style:solid; border-right-style:solid; border-left-width:2pt; border-right-width:2pt\" ";else if(!e&&b.getUTCMonth()!=this.mon)a=' BGCOLOR="#e6e6e6"';else a="";return a}function CalAddFullEvent(e,g,i,l,k,h,j){var a,b;if(e=="")return;a=DateOptions.ParseISODate(e,undefined);if(g=="")b=new Date(a.getTime());else b=DateOptions.ParseISODate(g,undefined);if(Number(b)<Number(a))b=new Date(a.getTime());var c=new Date(a.getTime()),d=new Date(b.getTime());if(this.iperiod==2){if(Number(a)>Number(this.dateTodayEnd)||Number(b)<Number(this.dateStart))return;if(Number(c)<Number(this.dateStart))c=this.dateStart;var f=Calendar.msHour/3;if(b.getTime()<a.getTime()+f)d=new Date(a.getTime()+f)}h+="&Source="+escapeProperly(window.location.href);var m=new CalEvent(c,d,a,b,i,l,k,h,j);this.AddEvent(m)}function CalAddEvent(a){a:;this.rgEvt[String(this.ievtMax++)]=a}function CalAssignChannels(){a:;var d;this.mpSpan={};this.mpIchan={};this.mpEvents={};var n=false,g,h,a;if(this.iperiod==2){n=true;g=this.dateStart;h=this.dateTodayEnd;this.mpNoTimeEvents=[];this.mpAllDayEvents=[];var k=this.dopt.WorkDayStartHour-this.dopt.DailyStartHourDelta,l=this.dopt.WorkDayEndHour+this.dopt.DailyEndHourDelta;if(k<0)k=0;if(l>24)l=24;this.minQuarterStart=4*k;this.maxQuarterEnd=4*l-1;for(d=0;d<this.rgEvt.length;d++){a=this.rgEvt[String(d)];if(Number(a.actualDateStart)>Number(h)||Number(a.actualDateEnd)-1<Number(g)||Number(a.actualDateStart)<=Number(g)&&Number(a.actualDateEnd)>=Number(h))continue;var c=this.IrwFromDate(a.dateStart);if(c<0)c=0;var b=this.IrwFromDate(a.dateEnd);if(b>this.irwMax)b=this.irwMax;if(c<this.irwMax&&b>=0)for(var e=c;e<=b;e++){var j=new Date;this.SetDateFromGrid(j,e,0);if(Number(j)<Number(g)||Number(j)>=Number(h))continue;var p=j.getTime()/(Calendar.msHour/4),f=MsFloorTime(a.dateStart,Calendar.msHour/4,Boolean(0))/(Calendar.msHour/4)-p,i=MsFloorTime(a.dateEnd,Calendar.msHour/4,Boolean(1))/(Calendar.msHour/4)-p+1;if(i<f)i=f;if(f<this.minQuarterStart)this.minQuarterStart=f;if(i>this.maxQuarterEnd)this.maxQuarterEnd=i;if(f>0&&95-f<2)this.FVdayOverflow=true}}this.minQuarterStart=Math.floor(this.minQuarterStart/4)*4;if(this.minQuarterStart<0)this.minQuarterStart=0;if(this.maxQuarterEnd>95)this.maxQuarterEnd=95;else this.maxQuarterEnd=4*(Math.floor(this.maxQuarterEnd/4)+1)-1}this.iperiod<=1&&this.rgEvt.sort(CalEvtSort);var m=this.dateStart;m.setUTCHours(0,0,0,0);var o=m.getTime();for(d=0;d<this.rgEvt.length;d++){a=this.rgEvt[String(d)];if(n){if(a.actualDateStart.getTime()==o&&a.actualDateEnd.getTime()==o){this.mpNoTimeEvents[this.mpNoTimeEvents.length]=a;continue}if(Number(a.actualDateStart)<=Number(g)&&Number(a.actualDateEnd)>=Number(h)){this.mpAllDayEvents[this.mpAllDayEvents.length]=a;continue}}c=this.IrwFromDate(a.dateStart);if(c<0)c=0;b=this.IrwFromDate(a.dateEnd);if(b>this.irwMax)b=this.irwMax;if(c<this.irwMax&&b>=0)for(e=c;e<=b;e++)this.PlaceEventInRow(a,e)}}function CalEvtSort(a,b){if(a.multiDay!=b.multiDay)return a.multiDay?-1:1;else if(a.multiDay){var c=Number(a.dateEnd)-Number(a.dateStart),d=Number(b.dateEnd)-Number(b.dateStart);return d<c?-1:d>c?1:0}else return Number(a.dateStart)<Number(b.dateStart)?-1:Number(a.dateStart)>Number(b.dateStart)?1:0}function CalPlaceEventInRow(c,f){var m,k=new Date;this.SetDateFromGrid(k,f,0);if(this.iperiod==2){if(f!=0)return;var l=k.getTime()/(Calendar.msHour/4),d=MsFloorTime(c.dateStart,Calendar.msHour/4,Boolean(0))/(Calendar.msHour/4)-l,e=MsFloorTime(c.dateEnd,Calendar.msHour/4,Boolean(1))/(Calendar.msHour/4)-l;if(e<d)e=d;var h,g;if(this.iperiod==2){h=this.minQuarterStart;g=this.maxQuarterEnd}else{h=4*this.dopt.WorkDayStartHour;g=4*this.dopt.WorkDayEndHour-1}if(e>=h&&d<=g){if(this.FVdayOverflow)g=99;d=Math.max(d,h);e=Math.min(e,g);var j=this.IchanNext(f,d,e);new Span(this,f,d,e,j,c)}}else{var i,a,b;i=k.getTime()/Calendar.msDay;a=MsFloorTime(c.dateStart,Calendar.msDay,Boolean(0))/Calendar.msDay-i;b=MsFloorTime(c.dateEnd,Calendar.msDay,Boolean(1))/Calendar.msDay-i;if(b<a||c.actualDateEnd.getTime()-c.actualDateStart.getTime()<Calendar.msDay)b=a;if(b>=0&&a<=6){a=Math.max(a,0);b=Math.min(b,6);j=this.IchanNext(f,a,b);new Span(this,f,a,b,j,c)}}}function Span(a,f,b,i,h,e){this.evt=e;this.cbucket=i-b+1;if(a.iperiod==2){e.ichan=h;e.ihour=b;var g=a.maxQuarterEnd;if(g==95)g=99;e.rowspan=Math.min(this.cbucket,1+g-b)}a.mpSpan[String(f)+"."+String(b)+"."+String(h)]=this;for(var c=b;c<=i;c++){a.mpIchan[String(f)+"."+String(c)]=h+1;var d=a.mpEvents[String(f)+"."+String(c)];if(d==null){d=[];a.mpEvents[String(f)+"."+String(c)]=d}d[d.length]=e}}function CalIchanNext(c,d,e){a:;for(var b=0,a=d;a<=e;a++)if(this.mpIchan[String(c)+"."+String(a)]!=null)b=Math.max(b,this.mpIchan[String(c)+"."+String(a)]);return b}function CalIrwFromDate(b){var a;a=Math.floor((b.getTime()-this.dateStart.getTime())/Calendar.msWeek);return a}function CalBuildUI(){a:;var a=this.StBuild();document.write(a)}function CalStBuild(){a:;this.AssignChannels();return this.fDatePicker?this.StBuildPicker():!this.fUseDHTML?this.StDownlevelBuild():this.StBuildDHTML()}function CalStBuildDHTML(){a:;var a,e,h=new Date,m,d,c,f,b,u,o,F,G,j;u=F=4*this.dopt.WorkDayStartHour;o=4*this.dopt.WorkDayEndHour;G=o-1;if(this.iperiod==2){u=this.minQuarterStart;o=this.maxQuarterEnd+1;if(o==96&&this.FVdayOverflow)o=100}var A='<th style="cursor:pointer;" onmouseover="HighlightText(this, \'red\');" onmouseout="HighlightText(this, \'\');" ';if(this.iperiod==2){f=this.IchanNext(0,u,o);var y=this.mpNoTimeEvents.length,x=this.mpAllDayEvents.length;f=Math.max(f,this.cchanMin);if(this.cchanMax>0)f=Math.min(f,this.cchanMax);a="<table width='100%' class='ms-cal' cellpadding='0' cellspacing='0'>";a+="<tr>"+A+StClickEvent(this.stObject+".MoveDate(-1)")+' class="ms-calhead" style="cursor:pointer;" width="8%">&lt;</th><th width="84%" class="ms-calhead" nowrap>'+this.StDayMonthYear()+"</th>"+A+StClickEvent(this.stObject+".MoveDate(1)")+' class="ms-calhead" style="cursor:pointer;" width="8%">&gt;</th></tr>';if(y>0){a+="</table><table width='100%' class='ms-cal' cellpadding='0' cellspacing='0'>\r";a+="<tr height='0'><td width='"+String(Number(this.dopt.AllDayWidth)+8)+"pt' /><td/></tr>\r";a+="<tr><td class='ms-CalAllDay' rowspan='"+String(y+1)+"'></td><td width='1%' /></tr>";for(i=0;i<y;i++){j=this.mpNoTimeEvents[i];a+="<tr><td class='ms-Vapptsingle' style='border-top:1px solid black; border-left:1px solid black; border-bottom:1px solid black; border-right:1px solid black;' ";a+=" title="+StAttrQuote(j.StTip(this.dopt))+"><nobr>"+StRenderVDayEvt(j,this.dopt,2)+"</nobr></td></tr>\r"}}if(x>0){a+="</table><table width='100%' class='ms-cal' cellpadding='0' cellspacing='0'>\r";a+="<tr height='0'><td width='"+String(Number(this.dopt.AllDayWidth)+8)+"pt' /><td/></tr>\r";a+="<tr><td class='ms-CalAllDay' rowspan='"+String(x+1)+"'>"+this.dopt.L_AllDay_Text+"</td><td width='1%'/></tr>";for(var i=0;i<x;i++){j=this.mpAllDayEvents[i];a+="<tr><td class='ms-Vapptsingle' style='border-top:1px solid black; border-left:1px solid black; border-bottom:1px solid black; border-right:1px solid black;' ";a+=" title="+StAttrQuote(j.StTip(this.dopt))+"><nobr>"+StRenderVDayEvt(j,this.dopt,2)+"</nobr></td></tr>\r"}}a+="</table><table width='100%' style='table-layout:fixed' class='ms-vcal' cellpadding='0' cellspacing='0'>\r";a+="<tr height='0'><td width='"+String(this.dopt.AllDayWidth)+"pt' /><td width='8pt' />\r";for(c=1;c<f;c++)a+="<td/>\r";a+="</tr>\r";var w={},n=new Array(o);for(b=u;b<o;b++){n[b]=0;for(c=0;c<f;c++)w[String(b)+"."+String(c)]=0}for(i=0;i<this.rgEvt.length;i++){j=this.rgEvt[i];b=j.ihour;c=j.ichan;var q=j.rowspan,l=c+1;for(g=0;g<q;g++)if(n[b+g]>l)l=n[b+g];for(g=0;g<q;g++){n[b+g]=l;w[String(b+g)+"."+String(c)]=1}}for(i=0;i<this.rgEvt.length;i++){var M=0,g=0;j=this.rgEvt[i];b=j.ihour;l=n[b];q=j.rowspan;var t=0,E=false;for(g=1;g<q;g++){t=n[b+g];E=E||t!=l;if(t>l)l=t}if(!E)continue;for(g=0;g<q;g++)n[b+g]=l}for(i=this.rgEvt.length-1;i>=0;i--){var L=0,s=0;j=this.rgEvt[i];b=j.ihour;l=n[b];q=j.rowspan;var N=0,D=false;for(s=1;s<q;s++){t=n[b+s];D=D||t!=l;if(t>l)l=t}if(!D)continue;for(s=0;s<q;s++)n[b+s]=l}for(b=u;b<o;b++){a+="<tr>\r";if(b%4==0){var r=String(b/4);if(r=="24")r="&nbsp;";else if(this.dopt.f12Hour){r=String((b/4+11)%12+1);if(this.dopt.TimeMarkPosn==0)r+=" "+(b/4<12?this.dopt.stAM:this.dopt.stPM);else r=(b/4<12?this.dopt.stAM:this.dopt.stPM)+" "+r}var k="";if(b<F||b>G)k=' BGCOLOR="#e6e6e6" ';if(b!=u||x>0||y>0){a+="<td class='ms-CalHour' rowspan='2'"+k+"><nobr>"+r+"</nobr></td>";a+="<td class='ms-calHour'"+k+">&nbsp;</td>\r"}else{a+="<td class='ms-firstCalHour' rowspan='2'"+k+"><nobr>"+r+"</nobr></td>";a+="<td class='ms-firstCalHour'"+k+">&nbsp;</td>\r"}}else if(b%2==0){a+="<td class='ms-CalHalfHour'"+k+">&nbsp;</td>\r";a+="<td class='ms-calHalfHour'"+k+">&nbsp;</td>\r"}else if(b%4==1)a+="<td class='ms-CalQuarterHour'"+k+">&nbsp;</td>\r";else if(b%4==3){a+="<td class='ms-CalQuarterHour'"+k+">&nbsp;</td>\r";a+="<td class='ms-calQuarterHour'"+k+">&nbsp;</td>\r"}for(c=0;c<f;c++){e=this.mpSpan["0."+String(b)+"."+String(c)];if(e!=null){var K="ms-Vappt",I=e.evt.rowspan,v=Math.floor(f/n[b]);if(v>f/this.cchanMin)v=Math.floor(f/this.cchanMin);var z=v-1;if(z>0)for(g=0;g<I;g++){z=v-1;for(var B=f-1;B>c&&z>0;B--)if(w[String(b+g)+"."+String(B)]==0){w[String(b+g)+"."+String(B)]=1;z--}}a+="<td class="+K+" style='border-top:1px solid black; border-left:1px solid black; border-bottom:2px solid black; border-right:2px solid black;' rowspan="+String(e.evt.rowspan);if(v>1)a+=" colspan="+String(v);a+=" title="+StAttrQuote(e.evt.StTip(this.dopt))+"><nobr>"+StRenderVDayEvt(e.evt,this.dopt,e.evt.rowspan)+"</nobr></td>\r"}else if(w[String(b)+"."+String(c)]==0)if(b%4==0)if(b!=u||x>0||y>0)a+="<td class='ms-calHour'"+k+">&nbsp;</td>\r";else a+="<td class='ms-firstCalHour'"+k+">&nbsp;</td>\r";else if(b%2==0)a+="<td class='ms-calHalfHour'"+k+">&nbsp;</td>\r";else a+="<td class='ms-calQuarterHour'"+k+">&nbsp;</td>\r"}a+="</tr>\r"}a+="<tr>\r";for(c=-2;c<f;c++)a+="<td class='ms-CalHour'>&nbsp;</td>\r";a+="</tr>\r"}else{var p=this.iperiod==1;a="<table width='100%' class='ms-cal' cellpadding='0' cellspacing='0'>";a+="<tr>"+A+StClickEvent(this.stObject+".MoveDate(-1)")+' class="ms-calhead" style="cursor:pointer;">&lt;</td><td class="ms-calhead" colspan="5">';if(this.iperiod==0)a+=this.StMonthYear();else a+=this.StDaySpanMonthYear();a+="</td>"+A+StClickEvent(this.stObject+".MoveDate(1)")+' class="ms-calhead" style="cursor:pointer;">&gt;</td></tr>';a+="<tr>\r";for(d=0;d<7;d++)a+="<td class='ms-calDOW'>"+this.rgDOW((d+this.dopt.dow)%7)+"</td>\r";a+="</tr>";for(m=0;m<this.irwMax;m++){f=Math.max(this.IchanNext(m,0,6),this.cchanMin);if(this.cchanMax>0)f=Math.min(f,this.cchanMax);a+="<tr>\r";for(d=0;d<7;d++){this.SetDateFromGrid(h,m,d);a+='<td class="ms-calTop"'+this.DayStyle(h,false,true,p)+'>&nbsp;<span style="cursor:pointer;" onmouseover="HighlightText(this, \'red\');" onmouseout="HighlightText(this, \'\');"'+StClickEvent(this.stObject+".MoveToDay("+String(h.getUTCFullYear())+","+String(h.getUTCMonth()+1)+","+String(h.getUTCDate())+")")+">"+String(h.getUTCDate())+"</span>&nbsp;</td>\r"}a+="</tr>\r";for(c=0;c<f;c++){if(this.iperiod==1){a+="<tr>\r";for(d=0;d<7;d++){this.SetDateFromGrid(h,m,d);if(c==f-1&&this.SpanCheck(m,d,c,f))a+="<td class='ms-apptsingle' "+this.DayStyle(h,false,false,p)+">&nbsp;</td>";else{e=this.mpSpan[String(m)+"."+String(d)+"."+String(c)];if(e!=null&&!e.evt.multiDay&&0!=e.evt.actualDateStart.getTime()%Calendar.msDay&&0!=e.evt.actualDateEnd.getTime()%Calendar.msDay){var J="ms-apptsingle"+this.DayStyle(h,false,false,p);a+="<td class="+J+" colspan="+String(e.cbucket)+" title="+StAttrQuote(e.evt.StTip(this.dopt))+"><nobr>";a+=StEvtTime(e.evt,this.dopt,true);a+="&nbsp;</nobr></td>\r";d+=e.cbucket-1}else a+="<td class='ms-calMid'"+this.DayStyle(h,false,false,p)+">&nbsp;</td>\r"}}a+="</tr>\r"}a+="<tr>\r";for(d=0;d<7;d++){this.SetDateFromGrid(h,m,d);if(c==f-1&&this.SpanCheck(m,d,c,f))a+="<td class='ms-apptsingle' "+this.DayStyle(h,false,false,p)+'><span style="cursor:pointer;" onmouseover="HighlightText(this, \'red\');" onmouseout="HighlightText(this, \'\');"'+StClickEvent(this.stObject+".MoveToDay("+String(h.getUTCFullYear())+","+String(h.getUTCMonth()+1)+","+String(h.getUTCDate())+")")+">"+this.dopt.L_More_Text+"</span></td>\r";else{e=this.mpSpan[String(m)+"."+String(d)+"."+String(c)];if(e!=null){var H="ms-appt";if(!e.evt.multiDay)H="ms-apptsingle"+this.DayStyle(h,false,false,p);a+="<td class="+H+" colspan="+String(e.cbucket)+" title="+StAttrQuote(e.evt.StTip(this.dopt))+"><nobr>"+StURL(e.evt.stURL,e.evt.stTitle)+"</nobr></td>\r";d+=e.cbucket-1}else a+="<td class='ms-calMid'"+this.DayStyle(h,false,false,p)+">&nbsp;</td>\r"}}a+="</tr>\r";a+="<tr>\r";var C;if(c==f-1)C="ms-CalBot";else C="ms-CalSpacer";for(d=0;d<7;d++){this.SetDateFromGrid(h,m,d);a+="<td class="+C+this.DayStyle(h,c==f-1,false,p)+">&nbsp;</td>\r"}a+="</tr>\r"}}}a+="</table>";return a}function CalSpanCheck(e,a,g,f){a:;var d,b,c;if(this.IchanNext(e,a,a)>f)return true;d=this.mpSpan[String(e)+"."+String(a)+"."+String(g)];if(d!=null){c=d.cbucket+a;if(c>7)c=7;for(b=a+1;b<c;b++)if(this.IchanNext(e,b,b)>f)return true}return false}function StRenderVDayEvt(a,g,f){var b="";b+="<table height='12px' border='0' cellpadding='0' cellspacing='0' style='border-collapse: collapse; padding-right:6px' ><tr>";if(Boolean(a.rgIcons)&&Boolean(a.rgIcons.length)){var d,c,e=true;for(d in a.rgIcons){c=a.rgIcons[d];if(Boolean(c)&&c.indexOf("blank.gif")<0){e=false;break}}if(!e){b+="<td valign='top' nowrap>";for(d in a.rgIcons){c=a.rgIcons[d];if(Boolean(c)&&Boolean(c.length))b+=a.rgIcons[d]}b+="</td>"}}b+="<td nowrap>"+StURL(a.stURL,a.stTitle)+"</td></tr></table>";if(f>2)b+="<nobr>"+StEvtTime(a,g,false)+"</nobr>";if(f>3&&a.stLocation!=null)b+="<br><nobr>"+STSHtmlEncode(a.stLocation)+"</nobr>";return b}function StEvtTime(a,c,d){var b="";if(d)b+=c.StTime(a.actualDateStart);else b+=c.StBareTime(a.actualDateStart);if(a.actualDateStart.getTime()!=a.actualDateEnd.getTime()&&(MsFloorTime(a.actualDateStart,Calendar.msDay,Boolean(0))==MsFloorTime(a.actualDateEnd,Calendar.msDay,Boolean(0))||a.actualDateEnd.getTime()-a.actualDateStart.getTime()<Calendar.msDay)){b+=" - ";if(d)b+=c.StTime(a.actualDateEnd);else b+=c.StBareTime(a.actualDateEnd)}return b}function StClickEvent(a){a:;return'onclick="'+a+'" ondblclick="'+a+'"'}function CalStBuildPicker(){a:;var a,c=new Date,d=this.dopt.Today(),f,b,p,e;a='<table ONSELECTSTART="return false;" class="ms-datepicker" cellpadding="2" cellspacing="0" border="1">\r';var i="<td style=\"cursor:pointer;\" onmouseover=\"Highlight(this, 'yellow', 'black');\" onmouseout=\"Highlight(this, '', '');\" ";a+="<tr>"+i+StClickEvent(this.stObject+".MoveMonth(-1)")+' class="ms-dpnextprev">&lt;</td><td class="ms-dphead" colspan="5">'+this.StMonthYear()+"</td>"+i+StClickEvent(this.stObject+".MoveMonth(1)")+' class="ms-dpnextprev">&gt;</td></tr>';a+="<tr>\r";for(b=0;b<7;b++)a+='<td class="ms-dpdow" height="20" width="14%">&nbsp;'+this.rgDOWDP((b+this.dopt.dow)%7)+"&nbsp;</td>\r";a+="</tr>\r";for(f=0;f<this.irwMax;f++){a+="<tr>\r";for(b=0;b<7;b++){this.SetDateFromGrid(c,f,b);var h=this.mpEvents[String(f)+"."+String(b)],g=h!=null,o=c.getUTCFullYear(),n=c.getUTCMonth(),m=c.getUTCDate();a+=i+StClickEvent(this.stObject+".ClickDay("+String(o)+","+String(n)+","+String(m)+")");if(g){var j="";for(e=0;e<h.length;e++){var l=h[String(e)];j+=l.StTip(this.dopt);if(e<h.length-1)j+="\r"}a+=" title="+StAttrQuote(j)}a+=' width="14%"'+this.DPDayStyle(c,g)+">&nbsp;"+(g?"<b>":"")+String(c.getUTCDate())+(g?"</b>":"")+(c.getTime()==d.getTime()?"<font color='red'>"+Strings.STS.L_LittleRedDiamond_TXT+"</font>":"&nbsp;");a+="</td>\r"}a+="</tr>\r"}var k="<a href='javascript:"+this.stObject+".SetDate("+String(d.getUTCFullYear())+","+String(d.getUTCMonth())+","+String(d.getUTCDate())+");'>"+this.dopt.StDate(d)+"</a>";a+="<tr><td class='ms-DPFoot' colspan='7'><font color='red'>"+Strings.STS.L_LittleRedDiamond_TXT+"</font>"+StBuildParam(Strings.STS.L_TodaysDate_Text,[k])+"</td></tr>";a+="</table>";return a}function CalMoveDate(a){a:;if(this.iperiod==2)this.MoveVDay(a);else if(this.iperiod==1)this.MoveWeek(a);else this.MoveMonth(a)}function CalMoveMonth(c){var a,b=this.givenDate.getUTCFullYear()*12+this.givenDate.getUTCMonth()+c,d=Math.floor(b/12);b=b%12;if(c!=0)a=StURLSetVar("CalendarDate",String(d)+"-"+St2Digits(b+1)+"-1");else a=StURLSetVar("CalendarDate",String(d)+"-"+St2Digits(b+1)+"-"+String(this.givenDate.getUTCDate()));a=StURLSetVar2(a,"CalendarPeriod","month");this.Post(a)}function CalMoveWeek(c){var a,b=this.givenDate;b.setUTCDate(this.givenDate.getUTCDate()+7*c);a=StURLSetVar("CalendarDate",String(b.getUTCFullYear())+"-"+St2Digits(b.getUTCMonth()+1)+"-"+String(b.getUTCDate()));a=StURLSetVar2(a,"CalendarPeriod","week");this.Post(a)}function CalMoveDay(c){a:;var a,b=this.givenDate;b.setUTCDate(this.givenDate.getUTCDate()+c);a=StURLSetVar("CalendarDate",String(b.getUTCFullYear())+"-"+St2Digits(b.getUTCMonth()+1)+"-"+String(b.getUTCDate()));a=StURLSetVar2(a,"CalendarPeriod","day");this.Post(a)}function CalMoveToDay(d,c,b){a:;var a;a=StURLSetVar("CalendarDate",d+"-"+St2Digits(c)+"-"+b);a=StURLSetVar2(a,"CalendarPeriod","day");this.Post(a)}function CalMoveToToday(){a:;var a=this.dopt.Today(),b=StURLSetVar("CalendarDate",String(a.getUTCFullYear())+"-"+St2Digits(a.getUTCMonth()+1)+"-"+String(a.getUTCDate()));this.Post(b)}function CalDoPost(a){a:;if(Boolean(this.stViewID)&&Boolean(this.stViewID.length))a=StURLSetVar2(a,"View",this.stViewID);SubmitFormPost(a,undefined,undefined)}function EditSeries(c){a:;var b="";if(Boolean(c))b=StSearchVar(c,"ID");else b=StURLGetVar("ID");if(Boolean(b.length)){var d=b.indexOf(".0.");if(d>0){var a="";if(Boolean(c)){a=window.location.href;var e=a.indexOf("?");if(e>0)c+=a.substring(e,a.length);a=StURLSetVar2(c,"ID",b.substr(0,d))}else a=StURLSetVar("ID",b.substr(0,d));window.location.href=a}}}function EditSeriesID(b,c){if(Boolean(b.length)){var a="";if(Boolean(c)){a=window.location.href;var d=a.indexOf("?");if(d>0)c+=a.substring(d,a.length);a=StURLSetVar2(c,"ID",b)}else a=StURLSetVar("ID",b);window.location.href=a}}function StURLSetVar(b,a){a:;return StURLSetVar2(window.location.href,b,a)}function StViewURLSetVar(c,e,d){a:;var a=window.location.href,b=a.lastIndexOf("/");if(b>0)a=a.substring(0,b+1)+c;return StURLSetVar2(a,e,d)}function StURLGetVar(b){a:;var a=location.href;return StSearchVar(a,b)}function StSearchVar(b,d){var f=new RegExp("[?&]"+d+"=","g"),a=b.search(f);if(a==-1)return"";a+=d.length+2;var c=b.indexOf("&",a+1);if(c==-1)c=b.length;var e=b.substring(a,c);return e}function HighlightText(a,b){if(b!=""){a.colorTextSav=a.style.color;a.style.color=b}else a.style.color=a.colorTextSav}function Highlight(a,b,c){if(b!=""){a.colorBackSav=a.style.backgroundColor;a.colorTextSav=a.style.color;a.style.backgroundColor=b;a.style.color=c}else{a.style.backgroundColor=a.colorBackSav;a.style.color=a.colorTextSav}}function CalDPDayStyle(b,c){var a="";if(b.getTime()==this.dateDP.getTime())a+=" class=ms-dpselectedday";else if(b.getUTCMonth()!=this.mon)a+=" class=ms-dpnonmonth";else a+=" class=ms-dpday";if(c)a+=' style:"font-weight: bold;"';return a}function CalStDownlevelBuild(){a:;var a,e=new Date,c,b,h,d;a='<table cellpadding="2" cellspacing="0" width="100%" border="1">\r';a+='<tr><td class="ms-calhead"><a class="ms-calhead" target="_self" href="javascript:'+this.stObject+'.MoveDate(-1);"><b>&lt;</b></a></td><td class="ms-calhead" colspan="5">'+this.StMonthYear()+'</td><td class="ms-calhead"><a class="ms-calhead" target="_self" href="javascript:'+this.stObject+'.MoveDate(1);"><b>&gt;</b></a></td></tr>';a+="<tr>\r";for(b=0;b<7;b++)a+='<td class="ms-calDOWDown" height="20" width="14%">&nbsp;'+this.rgDOW((b+this.dopt.dow)%7)+"&nbsp;</td>\r";a+="</tr>\r";for(c=0;c<this.irwMax;c++){a+="<tr>\r";for(b=0;b<7;b++){this.SetDateFromGrid(e,c,b);a+='<td class="ms-calDown" height="80" width="14%"'+this.DayStyle(e)+">&nbsp;"+String(e.getUTCDate())+"&nbsp;<br>\r";var f=this.mpEvents[String(c)+"."+String(b)];if(f!=null)for(d=0;d<f.length;d++){var g=f[String(d)];a+=StURL(g.stURL,g.stTitle)+"<br>\r"}a+="</td>"}a+="</tr>\r"}a+="</table>";return a}function CalSetDateFromGrid(a,c,b){a.setTime(this.dateStart.getTime()+c*Calendar.msWeek+b*Calendar.msDay)}function CalEvent(a,b,c,d,h,l,e,m,j){this.dateStart=a;this.dateEnd=b;this.actualDateStart=c;this.actualDateEnd=d;this.stLocation=h;this.stDesc=l;this.stTitle=e;if(e.length==0)this.stTitle=Strings.STS.L_NoTitle_Text;this.stURL=m;this.rgIcons=j;var i=MsFloorTime(a,Calendar.msDay,Boolean(0)),k=MsFloorTime(b,Calendar.msDay,Boolean(1));if(Number(i)<Number(k)&&d.getTime()-c.getTime()>=Calendar.msDay)this.multiDay=true;else this.multiDay=false;var f=MsFloorTime(a,Calendar.msHour/4,Boolean(0)),g=MsFloorTime(b,Calendar.msHour/4,Boolean(1));if(f<g)this.multiQuarter=true}function EvtFOverlap(a){return Number(a.dateStart)<=Number(this.dateEnd)&&Number(a.dateEnd)>=Number(this.dateStart)}function EvtStTip(c){a:;var a,b=StEvtTime(this,c,true);if(DateOptions.FHasTime(this.actualDateStart)||DateOptions.FHasTime(this.actualDateEnd))a=StBuildParam(Strings.STS.L_Tip_Text,[b,this.stTitle]);else a=this.stTitle;if(!FBlankString(this.stLocation))a+="\r"+this.stLocation;if(!FBlankString(this.stDesc))a+="\r"+this.stDesc;return a}var cGCMinimumWidth,cGCMinimumHeight,cGCMaxGCResizeCount,glGCObjectHeight,glGCObjectWidth,glGCResizeCounter;function GCComputeSizing(e){if(TestGCObject(e)){var g=document.documentElement.currentStyle.direction=="rtl",h=typeof document.compatMode!="undefined"&&document.compatMode=="BackCompat",d=h?document.documentElement.scrollWidth:document.documentElement.clientWidth,f=h?document.documentElement.scrollHeight:document.documentElement.clientHeight,b=0,c=0;if(g){b=-180;c=120}else{b=32;c=-2}var a=e.parentNode;while(a!=document.body){b+=a.offsetLeft;c+=a.offsetTop;a=a.offsetParent;if(a==null)break;if(g)if(a.offsetLeft>0)break}b+=e.parentNode.offsetLeft;c+=e.parentNode.offsetTop;glGCObjectHeight=f-c;if(glGCObjectHeight>f)glGCObjectHeight=f;if(glGCObjectHeight<cGCMinimumHeight)glGCObjectHeight=cGCMinimumHeight;if(g)glGCObjectWidth=d+b;else glGCObjectWidth=d-b;if(glGCObjectWidth>d)glGCObjectWidth=d;if(glGCObjectWidth<cGCMinimumWidth)glGCObjectWidth=cGCMinimumWidth}}function GCResizeGridControl(a){if(TestGCObject(a)){var c=glGCObjectHeight,b=glGCObjectWidth;GCComputeSizing(a);if(c!=glGCObjectHeight)a.height=String(glGCObjectHeight);if(b!=glGCObjectWidth)a.width=String(glGCObjectWidth)}}function GCWindowResize(a){a:;if(TestGCObject(a)){glGCResizeCounter=0;GCResizeGridControl(a)}}function GCOnResizeGridControl(a){a:;if(TestGCObject(a))if(glGCResizeCounter<cGCMaxGCResizeCount){glGCResizeCounter++;GCResizeGridControl(a)}}function _GCActivateAndFocus(a){a:;if(TestGCObject(a)){typeof a.SetActive!="undefined"&&a.SetActive();typeof a.Focus!="undefined"&&a.Focus()}}function _GCNavigateToNonGridPage(){a:;var c,a=window.location.href,e=a.match(new RegExp("ShowInGrid="));if(null!=e){c=/ShowInGrid=\w*/;a=a.replace(c,"")}var b=a.indexOf("?");if(b!=-1){var d=a.indexOf("?",b+1);if(d!=-1)a=a.slice(0,d);a=a+"&"}else a=a+"?";a=a+"ShowInGrid=False";window.location.replace(STSPageUrlValidation(a))}function GCAddNewColumn(a,b){if(TestGCObject(a)){var h=window.location.href,e=typeof a.Name!="undefined"?a.Name:"",g=typeof a.SelectedColumnUniqueName!="undefined"?a.SelectedColumnUniqueName:"",i=typeof a.RightToLeft!="undefined"?a.RightToLeft:"",f=typeof a.ViewGUID!="undefined"?a.ViewGUID:"",d=typeof a.ServerTemplate!="undefined"?a.ServerTemplate:"",c="FldNew.aspx";if(d=="102")c="QstNew.aspx";b=b+"/_layouts/15/"+c+"?List="+e+"&View="+f+"&Source="+h+"&RelativeToField="+g+"&LTR="+i;window.location.href=b}}function GCEditDeleteColumn(a,b){if(TestGCObject(a)){var g=window.location.href,e=typeof a.Name!="undefined"?a.Name:"",f=typeof a.SelectedColumnUniqueName!="undefined"?a.SelectedColumnUniqueName:"",d=typeof a.ServerTemplate!="undefined"?a.ServerTemplate:"",c="FldEdit.aspx";if(d=="102")c="QstEdit.aspx";b=b+"/_layouts/15/"+c+"?List="+e+"&Field="+f+"&Source="+g;window.location.href=b}}var objGCGlobal;function GCShowTaskPane(){a:;if(objGCGlobal!=null){objGCGlobal.DisplayTaskPane=true;objGCGlobal=null}}function GCShowHideTaskPane(a){if(TestGCObject(a))if(typeof a.DisplayTaskPane!=undefined){var b=a.DisplayTaskPane;a.DisplayTaskPane=!b;if(!b){objGCGlobal=a;window.setTimeout("GCShowTaskPane()",5)}}}function GCShowHideTotalsRow(a){if(TestGCObject(a))if(typeof a.DisplaySheetTotals!="undefined"){var b=a.DisplaySheetTotals;a.DisplaySheetTotals=!b}}function GCGridNewRow(a){if(TestGCObject(a))typeof a.SelectNewRow!="undefined"&&a.SelectNewRow()}function GCRefresh(a){if(TestGCObject(a))typeof a.Refresh!="undefined"&&a.Refresh()}function GCNewFolder(a){if(TestGCObject(a))typeof a.NewFolder!="undefined"&&a.NewFolder()}function PositionInfo(c,d,b,a){this.left=c;this.top=d;this.width=b;this.height=a}function PositionInfo_InitializePrototype(){a:;PositionInfo.prototype.left=0;PositionInfo.prototype.top=0;PositionInfo.prototype.width=0;PositionInfo.prototype.height=0}function CUIInfo(a,c,b){a.CUICommand=c;a.CUIEnabledCommands=b}function resetExecutionState(){a:;IsMenuShown=false;itemTable=null;imageCell=null;onKeyPress=false;currentCtx=null;currentEditMenu=null;currentItemID=null;downArrowText=null;resetItemGlobals()}function resetItemGlobals(){a:;currentItemAppName=null;currentItemProgId=null;currentItemIcon=null;currentItemOpenControl=null;currentItemModerationStatus=null;currentItemUIString=null;currentItemCheckedoutToLocal=null;currentItemOpenApp=null;currentItemCanModify=null;currentItemFileUrl=null;currentItemFSObjType=null;currentItemContentTypeId=null;currentItemCheckedOutUserId=null;currentItemCheckoutExpires=null;currentItemPermMaskH=null;currentItemPermMaskL=null;currentItemIsEventsExcp=null;currentItemIsEventsDeletedExcp=null}var ecbManager;function IsMenuEnabled(){a:;return browseris.ie55up||browseris.nav6up||browseris.safari125up}function GetSelectedElement(a,c,b){while(a!=null&&a.tagName!=c&&(b==null||a.tagName!=b))a=a.parentNode;return a}function setupMenuContext(a){currentCtx=a}function setupMenuContextName(strCtx){var lctx;try{eval("lctx = "+strCtx+";")}catch(e){eval("lctx = g_ctxDict['"+strCtx+"'];")}setupMenuContext(lctx)}function FindSTSMenuTable(a,c){var b=a.getAttribute(c);while(a!=null&&(b==null||b=="")){a=GetSelectedElement(a.parentNode,"TABLE","DIV");if(a!=null)b=a.getAttribute(c)}return a}function OnLinkDeferCall(a){if(!IsMenuEnabled())return false;a.onfocusout=OutItem;a.onkeydown=PopMenu;var b=FindSTSMenuTable(a,"CTXName");if(b==null)return false;OnItem(b);return false}function StartDeferItem(a){if(a!=itemTable){itemTableDeferred=a;var c=a.tagName=="TABLE";if(c){a.onmouseout=EndDeferItem;a.onclick=DeferredOnItem;a.oncontextmenu=DeferredOnItem}else{var b=a.parentNode;if(b.getAttribute("IsCallout")!="TRUE"){b.onmouseout=EndDeferItem;b.oncontextmenu=DeferredOnItem}}}}function IsAjaxMenu(d){var a=d.getAttribute("eventtype");if(a!=null&&(a==5||a==3||a==4))return false;var c=d.className;if(c!=null&&c.length>0){var b=c.split(" ");if(b!=null&&b.length>1&&b[b.length-1]=="itx")return true}return false}function DeferredOnItem(b){var a=itemTableDeferred;if(a!=null){MenuHtc_hide();OnItem(a);if(IsAjaxMenu(a))CreateAjaxMenu(b);else CreateMenu(b);return false}return undefined}function EndDeferItem(){a:;var a=itemTableDeferred;if(a!=null){itemTableDeferred=null;var c=a.tagName=="TABLE";if(c){a.onmouseout=null;a.onclick=null;a.oncontextmenu=null}else{var b=a.parentNode;b.onmouseout=null;b.onclick=null;b.oncontextmenu=null}}}function GetLastChildElement(b){for(var a=b.childNodes.length-1;a>=0;a--)if(b.childNodes[a].nodeType==1)return b.childNodes[a];return null}function CreateHiddenCtxMenu(b,a){return CreateCtxImg_Helper(b,a,false)}function CreateCtxImg(b,a){return CreateCtxImg_Helper(b,a,true)}function CreateCtxImg_Helper(c,j,i){var a=FindCtxImg(c);if(a!=null&&typeof a.shown=="boolean"&&a.shown==true)return a;if(a==null){a=document.createElement("DIV");a.className="s4-ctx";var b=[];b.push("<span>\u00a0</span>");b.push("<a onfocus='");if(c.tagName=="TD")b.push("OnChildItem(this.parentNode.parentNode); return false;'");else if(c.tagName=="TH")b.push("OnChildColumn(this.parentNode.parentNode); return false;'");else b.push("return false;'");b.push("href='javascript:;' onclick='PopMenuFromChevron(event); return false;' title='");b.push(Strings.STS.L_OpenMenu_Text+"'></a>");b.push("<span>\u00a0</span>");a.innerHTML=b.join("");delete b;c.appendChild(a)}if(typeof a.shown=="undefined"){for(var h=a.getElementsByTagName("SPAN"),k=h.length,f=0;f<k;f++)if(browseris.ie&&browseris.iever==6)h[f].style.lineHeight="1px";var e=a.getElementsByTagName("A")[0];e.onfocusout=j;var d=e.getElementsByTagName("img")[0],g=d==null;if(g)d=document.createElement("img");d.style.visibility="hidden";if(c.getAttribute("IsECB")=="TRUE"||c.getAttribute("IsCallout")=="TRUE"||c.getAttribute("role")=="gridcell")d.src=!IsElementRtl(c)?GetThemedImageUrl("ecbbutton.png"):GetThemedImageUrl("ecbbuttonrtl.png");else d.src=GetThemedImageUrl("ecbarw.png");d.alt=Strings.STS.L_OpenMenu_Text;d.setAttribute("ms-jsgrid-click-passthrough","true");g&&e.appendChild(d)}i&&ShowCtxImg(a,true,c);return a}function FindCtxImg(f){for(var b=null,d=f.childNodes,e=d.length,c=0;c<e;c++){var a=d[c];if(a.nodeType==1&&a.className.indexOf("s4-ctx")!=-1){b=a;break}else{b=FindCtxImg(a);if(b!=null)break}}return b}function RemoveCtxImg(b){var a=FindCtxImg(b);a!=null&&ShowCtxImg(a,false,b)}function ShowCtxImg(a,c,b){EnsureScriptFunc("mQuery.js","m$",function(){a:;var e=null,d=null;if(a!=null)e=a.getElementsByTagName("A")[0];if(e!=null)d=e.getElementsByTagName("IMG")[0];if(d!=null){var f=b.tagName=="TH";if(c==true){AddCssClassToElement(a,"s4-ctx-show");f&&AddCssClassToElement(b,"ms-headerCellStyleHover");PositionCtxImg(a,b);d.style.visibility="visible";a.shown=true;ChevronContainer=b;if(a.onmouseover==null)a.onmouseover=function(){!HasCssClass(a,"s4-ctx-show-hover")&&AddCssClassToElement(a,"s4-ctx-show-hover")};a.onmouseout=function(c){if(!IsMenuOn()&&!IsCallOutOn()&&!IsFilterMenuOn()){if(c==null)c=window.event;var b=Boolean(c.relatedTarget)?c.relatedTarget:c.toElement;while(b!=null&&b.tagName!="BODY"){if(b==this)return;b=b.parentNode}b!=null&&RemoveCssClassFromElement(a,"s4-ctx-show-hover")}}}else{d.style.visibility="hidden";RemoveCssClassFromElement(a,"s4-ctx-show");RemoveCssClassFromElement(a,"s4-ctx-show-hover");a.shown=false;a.onmouseout=null;ChevronContainer=null;if(f){RemoveCssClassFromElement(b,"ms-headerCellStyleHover");RemoveCssClassFromElement(b,"ms-headerCellStylePressed");RemoveCssClassFromElement(b,"ms-headerCellStyleMenuOpen")}}}})}function GetPosition(b){if(b==null)return null;var c=0,d=0,h=0,g=0,j=null,f=null;f=b.offsetParent;var e=b,a=b;while(a.parentNode!=null){a=a.parentNode;if(a.offsetParent!=null){var i=true;if(typeof a.scrollTop=="number"&&a.scrollTop>0)d-=a.scrollTop;if(typeof a.scrollLeft=="number"&&a.scrollLeft>0)c-=a.scrollLeft}if(a==f){c+=b.offsetLeft;if(typeof a.clientLeft=="number"&&a.nodeName!="TABLE")c+=a.clientLeft;d+=b.offsetTop;if(typeof a.clientTop=="number"&&a.nodeName!="TABLE")d+=a.clientTop;b=a;if(b.offsetParent==null){if(typeof b.offsetLeft=="number")c+=b.offsetLeft;if(typeof b.offsetTop=="number")d+=b.offsetTop}f=b.offsetParent}}if(typeof e.offsetWidth=="number")h=e.offsetWidth;if(typeof e.offsetHeight=="number")g=e.offsetHeight;return new PositionInfo(c,d,h,g)}function GetElemHeight(c,d,g,h){a:;var e=browseris.ie9standardUp;if(!e&&d&&!g&&!h)return c.clientHeight;var b=window.getComputedStyle(c,null),a=getWidthFromPxString(b.height);if(e||d){var f=getWidthFromPxString(b.paddingTop)+getWidthFromPxString(b.paddingBottom);if(e)a=Math.max(c.clientHeight,a+f)-f;if(d)a+=f}if(g)a+=getWidthFromPxString(GetCurrentEltStyle(c,"border-top-width"))+getWidthFromPxString(GetCurrentEltStyle(c,"border-bottom-width"));var i=0;if(h)a+=getWidthFromPxString(b.marginTop)+getWidthFromPxString(b.marginBottom);return a}function PositionCtxImg(b,a){var j=0,c=0,f=HasCssClass(b.parentNode,"ms-positionRelative"),o=GetPosition(a),s=GetPosition(b.offsetParent);if(!window.browseris.chrome&&getCurrentEltStyleByNames(a,["border-collapse","borderCollapse"])=="collapse"){var k=a.offsetHeight-a.clientHeight;o.height+=k;o.top-=k}var n=m$(f?a:a).offset(),m=m$(f?b.parentNode:b.offsetParent).offset();j=n.top-m.top;if(f){var g,h;if(!IsElementRtl(a)){g=getCurrentEltStyleByNames(a,["padding-right","paddingRight"]);h=getCurrentEltStyleByNames(a,["border-right-width","borderRightWidth"])}else{g=getCurrentEltStyleByNames(a,["padding-left","paddingLeft"]);h=getCurrentEltStyleByNames(a,["border-left-width","borderLeftWidth"])}var r=getWidthFromPxString(g),q=getWidthFromPxString(h);c=-r-q}else{c=n.left-m.left;if(!IsElementRtl(a))c=c+a.offsetWidth-b.offsetWidth;j+=b.offsetParent.scrollTop;c+=b.offsetParent.scrollLeft}var l=String(c)+"px",d=b.style;d.top=String(j)+"px";if(!IsElementRtl(a)&&f)d.right=l;else d.left=l;var i=GetElemHeight(a,true,false,false);if(browseris.ie9standardUp){var e=GetAncestorByTagNames(a,["TR","TH"]);if(e!=null&&e.nextSibling!=null){var p=e.nextSibling.offsetTop-e.offsetTop-e.offsetHeight;i+=p}}d.height=String(i)+"px";d.lineHeight=String(Math.max(i-2,0))+"px";d.margin="0px"}function getCurrentEltStyleByNames(d,c){var a=null,b=0;while(b<c.length){a=GetCurrentEltStyle(d,c[b]);if(a!=null)break;b++}return a}function getWidthFromPxString(b){if(typeof b!="string")return 0;var a=b.trim(),c=Number(a.substring(0,a.length-2).trim());return isNaN(c)?0:c}function IsInCtxImg(a){while(a!=null&&a.tagName!="TD"&&a.tagName!="BODY"&&a.className.indexOf("s4-ctx")==-1)a=a.parentNode;return a!=null&&a.className.indexOf("s4-ctx")!=-1?a:null}function OnItemDeferCall(h){if(!IsMenuEnabled())return false;if(IsMenuOn()){StartDeferItem(h);return false}if(itemTable==h)return undefined;itemTable!=null&&OutItem();itemTable=h;currentItemID=GetAttributeFromItemTable(itemTable,"ItemId","Id");var c=itemTable.tagName=="TABLE",k=new Function("setupMenuContextName('"+itemTable.getAttribute("CTXName")+"');");k();var g=currentCtx,j=IsAjaxMenu(itemTable);if(c){if(browseris.nav6up)itemTable.className="ms-selectedtitlealternative";else itemTable.className="ms-selectedtitle";if(j)itemTable.className=itemTable.className+" itx"}var a=itemTable.parentNode;while(a.tagName!="TD"&&a.tagName!="BODY")a=a.parentNode;var b=null;if(!c)if(g.IsClientRendering!=true)b=CreateCtxImg(a,OutItem);var d=j?CreateAjaxMenu:CreateMenu;if(c){itemTable.onclick=d;itemTable.oncontextmenu=d}else{var i=false;if(b!=null)if(b.onclick==null)b.onclick=d;else i=true;if(!i)a.oncontextmenu=d;else if(b!=null)a.oncontextmenu=b.onclick}if(c)itemTable.onmouseout=OutItem;else if(a.getAttribute("IsECB")!="TRUE"||itemTable.onmouseover!=null)a.onmouseout=OutItem;if(c){var f;f=GetFirstChildElement(GetFirstChildElement(itemTable));if(f!=null)imageCell=GetLastChildElement(f);if(g.listTemplate==200){if(itemTable.getAttribute("menuType")=="Orphaned")downArrowText=Strings.STS.L_Reschedule_Text}else downArrowText=Strings.STS.L_Edit_Text;var e=GetFirstChildElement(imageCell);e.src=g.imagesPath+"menudark.gif";e.alt=downArrowText;e.style.visibility="visible";imageCell.className="ms-menuimagecell"}return false}function OutItem(b){var a=null;if(b!=null&&typeof b.callOut!="undefined"&&Boolean(b.callOut)&&ecbManager.callOutPar!=null)a=ecbManager.callOutPar;if(!IsMenuOn()&&(itemTable!=null||a!=null)){var d=itemTable!=null&&itemTable.tagName=="TABLE";if(d){if(IsAjaxMenu(itemTable))itemTable.className="ms-unselectedtitle itx";else itemTable.className="ms-unselectedtitle";itemTable.onclick=null;itemTable.oncontextmenu=null;itemTable.onmouseout=null}else{if(a==null)a=GetAncestorByTagNames(itemTable,["TD","TH"]);if(a!=null&&a.getAttribute!=null&&a.getAttribute("IsCallout")=="TRUE")if(typeof CalloutManager==="object"&&calloutManager.containsOneCalloutOpen(a)){ecbManager.callOutPar=a;return true}var c=null;if(b==null)b=window.event;if(b!=null){c=typeof b.toElement!="undefined"&&b.toElement!=null?b.toElement:b.relatedTarget;if(a!=null&&c!=null&&IsContained(c,a))return true}if(a!=null){a.onclick=null;a.oncontextmenu=null;a.onmouseout=null;RemoveCtxImg(a)}}if(d&&imageCell!=null){GetFirstChildElement(imageCell).style.visibility="hidden";imageCell.className=""}resetExecutionState()}return undefined}function IsContained(a,d){if(a==d)return true;for(var c=d.getElementsByTagName(a.tagName),b=0;b<c.length;b++)if(a==c[b])return true;return false}function IsMenuOn(){a:;if(!IsMenuShown)return false;var a=false;a=MenuHtc_isOpen(currentEditMenu);if(!a)IsMenuShown=false;return a}function _ListHeaderMenu_OnMouseDown(a){if(a!=null&&a.tagName=="TH")if(HasCssClass(a,"ms-headerCellStyleHover")){RemoveCssClassFromElement(a,"ms-headerCellStyleHover");AddCssClassToElement(a,"ms-headerCellStylePressed")}}function _PopMenuFromChevron(d){a:;if(d==null)d=window.event;var g=Boolean(d.srcElement)?d.srcElement:d.target,b=g.parentNode;while(b.tagName!="TD"&&b.tagName!="TH"&&b.tagName!="BODY")b=b.parentNode;var c,a;if(b.tagName=="TD"){c=b.getElementsByTagName("DIV");var f=null;for(a=0;a<c.length;a++)if(c[a].getAttribute("CtxNum")!=null)f=c[a];f!=null&&OnItemDeferCall(f)}else if(b.tagName=="TH"){c=b.getElementsByTagName("DIV");var e=null;for(a=0;a<c.length;a++)if(c[a].getAttribute("CtxNum")!=null)e=c[a];e!=null&&OnMouseOverFilterDeferCall(e)}return false}function PopMenu(a){if(!IsMenuEnabled())return true;if(a==null)a=window.event;var b;if(a==null)return true;if(browseris.nav6up)b=a.which;else b=a.keyCode;if(!IsMenuOn()&&(a.shiftKey&&b==13||a.altKey&&b==40)){onKeyPress=true;var d=Boolean(a.srcElement)?a.srcElement:a.target,c=FindSTSMenuTable(d,"CTXName");if(c==null)return false;OnItemDeferCall(c);if(IsAjaxMenu(c))CreateAjaxMenu(a);else CreateMenu(a);onKeyPress=false;return false}else return true}function CreateMenuEx(h,a,e,g){if(a==null)return undefined;IsMenuShown=true;document.body.onclick=null;var d;d=BuildMenu(h);d.setAttribute("hideicons","true");currentEditMenu=d;a.onmouseout=null;var b=null,c=null;if(a.tagName=="SPAN"&&HasCssClass(a,"js-callout-ecbMenu"))b=a;else{c=FindCtxImg(a);if(c==null){b=GetAncestorByTagNames(a,["TD","TR"]);if(b==null)b=a;else c=FindCtxImg(a)}}c!=null&&typeof c.shown=="boolean"&&c.shown==false&&ShowCtxImg(c,true,b);OMenu(d,b,null,g,-1,false,false,e);if(itemTable!=null&&itemTable.tagName!="DIV"){var f=itemTable.getAttribute("CTXName");if(f==undefined||f=="")itemTable=GetSelectedElement(a,"TABLE","DIV")}if(b.tagName=="TD")b.onclick=SingleItemSelect;d._onDestroy=OutItem;if(e!=null)e.cancelBubble=true;return false}function BuildMenuWithInit(a){resetItemGlobals();setDocType();currentItemID=GetAttributeFromItemTable(itemTable,"ItemId","Id");currentItemCheckedOutUserId=typeof itemTable.COUId=="string"?itemTable.COUId:null;currentItemCheckedoutToLocal=GetAttributeFromItemTable(itemTable,"COut","IsCheckedoutToLocal ");currentItemModerationStatus=GetAttributeFromItemTable(itemTable,"MS","MStatus");return BuildMenu(a)}function BuildMenu(a){var b=CMenu(currentItemID+"_menu");if(b==null)return null;else if(Boolean(a.isVersions))AddVersionMenuItems(b,a);else if(a.listTemplate==121)AddSolutionsCatalogMenuItems(b,a);else if(a.listBaseType==1)AddDocLibMenuItems(b,a);else if(a.listTemplate==200)AddMeetingMenuItems(b,a);else AddListMenuItems(b,a);InsertFeatureMenuItems(b,a);SP.SOD.notifyEventAndExecuteWaitingJobs("CleanupContextMenu",[b,a]);return b}function GetParentLinkFromEvent(a){if(a==null)a=window.event;var c=Boolean(a.srcElement)?a.srcElement:a.target,b=GetSelectedElement(c,"A");return b!==null&&b.tagName==="A"?b:null}function isInvalidAjaxMenuElement(a){a:;return a===null||typeof a==="undefined"||onKeyPress==false&&IsInCtxImg(a)==null&&a.className.indexOf("js-callout-action")===-1&&a.className.indexOf("ms-lstItmLinkAnchor")===-1&&(a.tagName=="A"||a.parentNode.tagName=="A")}function CreateAjaxMenu(b,g){if(!IsContextSet())return undefined;if(b==null)b=window.event;if(itemTable==null||itemTable.tagName=="TABLE"&&imageCell==null)return undefined;var e=GetParentLinkFromEvent(b);if(isInvalidAjaxMenuElement(e)){e=Boolean(b.srcElement)?b.srcElement:b.target;if(isInvalidAjaxMenuElement(e))return undefined}var a=itemTable,f=a.parentNode;if(f!=null&&parseInt(f.getAttribute("creatingAjax"))==1)return undefined;a.parentNode.setAttribute("creatingAjax","1");var d=currentCtx,c=null;if(g&&b!=null&&b.clientX!=null&&b.clientY!=null&&b.clientX!=0&&b.clientY!=0){c={};c.clientX=b.clientX;c.clientY=b.clientY}var h=function(e,b){a:;if(b!=undefined)if(typeof d.IsClientRendering!="undefined"&&d.IsClientRendering){b.FileRef!=undefined&&a.setAttribute("Url",b.FileRef);b.FileDirRef!=undefined&&a.setAttribute("DRef",b.FileDirRef);b.File_x0020_Type!=undefined&&a.setAttribute("Ext",b.File_x0020_Type);b.HTML_x0020_File_x0020_Type!=undefined&&a.setAttribute("Type",b.HTML_x0020_File_x0020_Type);b.FSObjType!=undefined&&a.setAttribute("OType",b.FSObjType);b.CheckedOutUserId!=undefined&&a.setAttribute("COUId",b.CheckedOutUserId);b._HasCopyDestinations!=undefined&&a.setAttribute("HCD",b._HasCopyDestinations);b._CopySource!=undefined&&a.setAttribute("CSrc",b._CopySource);b._ModerationStatus!=undefined&&a.setAttribute("MS",b["_ModerationStatus."]);b.ContentType!=undefined&&a.setAttribute("CType",b.ContentType);b.ContentTypeId!=undefined&&a.setAttribute("CId",b.ContentTypeId);b._UIVersion!=undefined&&a.setAttribute("UIS",b._UIVersion);b._SourceUrl!=undefined&&a.setAttribute("SUrl",b._SourceUrl);b["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"]!=undefined&&a.setAttribute("Icon",b["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"]);if(d.ListSchema.IsDocLib){b["serverurl.progid"]!=undefined&&a.setAttribute("sred",b["serverurl.progid"]);b["ctxt.ListSchema.DefaultItemOpen"]!=undefined&&a.setAttribute("defaultio",d.ListSchema.DefaultItemOpen);b.IsCheckedoutToLocal!=undefined&&a.setAttribute("cout",b.IsCheckedoutToLocal)}OnItemDeferCall(a);CreateMenuEx(e,a,c,false);a.parentNode.removeAttribute("creatingAjax")}else{a.parentNode.replaceChild(b,a);b.onclick=typeof a.onclick!="undefined"?a.onclick:undefined;b.onmousehover=OnItem;OnItemDeferCall(b);CreateMenuEx(e,b,c);b.parentNode.removeAttribute("creatingAjax")}};FetchEcbInfo(d,itemTable.id,itemTable.tagName,h);b.cancelBubble=true;return false}var ecbItems;function FetchEcbInfo(a,e,i,f){var b=[],g=false,d=escapeUrlForCallback(a.HttpRoot);b.push(d);d[d.length-1]!="/"&&b.push("/");b.push("_layouts/15/inplview.aspx?Cmd=Ctx&List=");b.push(a.listName);a.HasRelatedCascadeLists==1&&a.CascadeDeleteWarningMessage==null&&b.push("&CascDelWarnMessage=1");if(a.view!=null){b.push("&View=");b.push(a.view)}b.push("&ViewCount=");b.push(a.ctxId);if(typeof a.isXslView!="undefined"&&a.isXslView){b.push("&IsXslView=TRUE");b.push("&Field=");if(itemTable!=null)b.push(GetAttributeFromItemTable(itemTable,"Field","Field"));else b.push("LinkFilename");if(typeof a.IsClientRendering!="undefined"&&a.IsClientRendering){b.push("&IsCSR=TRUE");if(Boolean(a.listName)){var k=ecbItems+"_"+a.listName.toLowerCase();if(document.getElementById(k)==null){b.push("&CustomAction=TRUE");g=true}else if(Boolean(a.ExternalDataList)){CallBackWithRowData(a,e,a.ListData,f);return}}}}b.push("&ID=");b.push(e);var h=GetUrlKeyValue("RootFolder",true,ajaxNavigate.get_href());if(h.length>0){b.push("&RootFolder=");b.push(h)}b.push("&ListViewPageUrl=");var l=new URI(ajaxNavigate.get_href(),{disableEncodingDecodingForLegacyCode:true});d=l.getStringWithoutQueryAndFragment();b.push(d);if(typeof a.overrideScope!="undefined"){b.push("&OverrideScope=");b.push(escapeProperly(a.overrideScope))}if(typeof a.searchTerm!="undefined"&&a.searchTerm!=null){b.push("&InplaceSearchQuery=");b.push(escapeProperlyCore(a.searchTerm,true))}else if(typeof a.completedSearchTerm!="undefined"&&a.completedSearchTerm!=null){b.push("&InplaceSearchQuery=");b.push(escapeProperlyCore(a.completedSearchTerm,true))}typeof a.fullListSearch!="undefined"&&a.fullListSearch!=null&&a.fullListSearch==true&&b.push("&InplaceFullListSearch=true");var j=b.join(""),c;if(window.XMLHttpRequest!=null){c=new XMLHttpRequest;c.open("POST",j,true);c.onreadystatechange=function(){a:;if(c.readyState!=4)return;if(c.status==601)alert(c.responseText);else if(c.status==503)alert(Strings.STS.L_ServerBusyError);else if(typeof a.IsClientRendering!="undefined"&&a.IsClientRendering){var d=c.responseText;if(g){var p="<CustomAction/>",l=d.indexOf(p);if(l>=0){var s=document.createElement("DIV");s.innerHTML=d.substring(0,l);document.body.appendChild(s);d=d.substring(l+p.length)}}var j=null;if(Boolean(a.ExternalDataList))j=a.ListData;else j=JSON.parse(d);if(a.HasRelatedCascadeLists==1&&a.CascadeDeleteWarningMessage==null)a.CascadeDeleteWarningMessage=j.CascadeDeleteWarningMessage;CallBackWithRowData(a,e,j,f)}else{var b=c.responseText,n=document.createElement("DIV");n.style.visibility="hidden";if(a.HasRelatedCascadeLists==1&&a.CascadeDeleteWarningMessage==null){var q="<CascadeDeleteWarningMessage>",r="</CascadeDeleteWarningMessage>";if(b.startsWith(q)){var o=b.indexOf(r);if(o!==-1){a.CascadeDeleteWarningMessage=b.substring(q.length,o);b=b.substring(o+r.length)}}}n.innerHTML=b;for(var m=n.getElementsByTagName(i),h,k=0;k<m.length;k++){h=m[k];if(h.id==e)break}if(k==m.length)h=null;if(h!=null)f(a,h);else{alert(Strings.STS.L_ItemGone);RefreshPage(1)}}};c.send(null)}}function CallBackWithRowData(e,f,b,d){for(var c=undefined,a=0;a<b.Row.length;a++)if(b.Row[a].ID==f){c=b.Row[a];break}c!=undefined&&d(e,c)}function CreateMenu(a){if(!IsContextSet())return undefined;var c=currentCtx;if(a==null)a=window.event;var b=a.srcElement!=null?a.srcElement:a.target;return itemTable==null||itemTable.tagName=="TABLE"&&imageCell==null||onKeyPress==false&&IsInCtxImg(b)==null&&(b.tagName=="A"||b.parentNode.tagName=="A")?undefined:CreateMenuEx(c,itemTable,a)}function AddSendSubMenu(z,b){var k=[];k.Copy=Strings.STS.L_SubmitFileCopyWarning_Text;k.Move=Strings.STS.L_SubmitFileMoveWarning_Text;k.Link=Strings.STS.L_SubmitFileLinkWarning_Text;var d=Strings.STS.L_Send_Text,s=GetAttributeFromItemTable(itemTable,"Url","ServerUrl"),g,n,h;if(currentItemFileUrl!=null){n=unescapeProperly(currentItemFileUrl);g=escapeProperly(n);h=SzExtension(n);if(h!=null&&h!="")h=h.toLowerCase()}var l=itemTable.getAttribute("SRed"),u=itemTable.getAttribute("DefaultIO");if(u=="0"&&!HasRights(0,32))u="1";var q=currentItemProgId!="SharePoint.WebPartPage.Document"&&(l==null||l==""||HasRights(0,32))&&h!="aspx",r=HasRights(16,0),p=currentItemFSObjType!="1"&&b.listBaseType==1&&(l==null||l==""||HasRights(0,32));if(!q&&!r&&!p)return;var e=CASubM(z,d,"","",String(400));CUIInfo(e,"SendTo",["SendTo","PopulateSendToMenu"]);e.IsSubMenu=true;e.id="ID_Send";e.style.display="none";var c;if(q){if(typeof b.SendToLocationName!="undefined"&&b.SendToLocationName!=null&&b.SendToLocationName!=""&&typeof b.SendToLocationUrl!="undefined"&&b.SendToLocationUrl!=null&&b.SendToLocationUrl!=""){var a="STSNavigate('"+b.HttpRoot+"/_layouts/15/copy.aspx?SourceUrl="+g+"&FldUrl="+escapeProperly(b.SendToLocationUrl);a=AddSourceToUrl(a)+"')";c=CAMOpt(e,b.SendToLocationName,a,"");CUIInfo(c,"SendToRecommendedLocation",["SendToRecommendedLocation"])}if(typeof itemTable.getAttribute("HCD")!="undefined"&&itemTable.getAttribute("HCD")=="1"){d=Strings.STS.L_ExistingCopies_Text;a="STSNavigate('"+b.HttpRoot+"/_layouts/15/updatecopies.aspx?SourceUrl="+g;a=AddSourceToUrl(a)+"')";var f=b.imagesPath+"existingLocations.gif";c=CAMOpt(e,d,a,f);c.id="ID_ExistingCopies";CUIInfo(c,"SendToExistingCopies",["SendToExistingCopies"])}d=Strings.STS.L_OtherLocation_Text;a="NavigateToSendToOtherLocationV4(event, '"+b.HttpRoot+"/_layouts/15/copy.aspx?SourceUrl="+g;a=AddSourceToUrl(a)+"')";f=b.imagesPath+"sendOtherLoc.gif";c=CAMOpt(e,d,a,f);c.id="ID_OtherLocation";CUIInfo(c,"SendToOtherLocation",["SendToOtherLocation"]);if(typeof b.OfficialFileNames=="string"&&b.OfficialFileNames!=""){var o=b.OfficialFileNames.split("__HOSTSEPARATOR__");if(o!=null)for(var m=0;m<o.length;m++){var A=o[m],i=A.split(",");d=i[0];var y=0,x="Copy";if(i.length==3){d=i[0].replace(/%2c/g,",").replace(/%25/g,"%");y=i[1];x=i[2]}a='if(confirm("'+StBuildParam(k[x],STSScriptEncode(d))+"\")!=0) SubmitFormPost('"+b.HttpRoot+"/_layouts/15/SendToOfficialFile.aspx?ID="+escapeProperly(d)+"&Index="+String(y)+"&SourceUrl="+g;a=AddSourceToUrl(a)+"')";f="";c=CAMOpt(e,d,a,f);var t="SendToOfficialFile"+String(m);CUIInfo(c,t,[t])}}CAMSep(e)}if(r){d=Strings.STS.L_SendToEmail_Text;s=GetAttributeFromItemTable(itemTable,"Url","ServerUrl");var j=ctx.HttpRoot.substr(0);if(j[j.length-1]!="/")j+="/";var v=-1,w="";v=j.substring(8).indexOf("/")+8;w=j.substr(0,v)+escapeProperlyCore(unescapeProperly(s),true);a="javascript:SendEmail('"+w+"')";f=ctx.imagesPath+"gmailnew.gif";c=CAMOpt(e,d,a,f);CUIInfo(c,"EmailLink",["EmailLink"]);c.id="ID_SendToEmail"}if(p){ctx.listTemplate!=119&&AddWorkspaceMenuItem(e,ctx);if(ctx.listTemplate!=119){a="STSNavigate('"+ctx.HttpRoot+"/_layouts/15/download.aspx?SourceUrl="+g+"&FldUrl="+escapeProperly(ctx.SendToLocationUrl);a=AddSourceToUrl(a)+"')";c=CAMOpt(z,Strings.STS.L_DownloadACopy_Text,a,"");CUIInfo(c,"DownloadCopy",["DownloadCopy"]);c.id="ID_DownloadACopy"}}}function AddDocTransformSubMenu(m,k){if(typeof rgDocTransformers=="undefined"||rgDocTransformers==null)return;var n=rgDocTransformers,b=null,c=GetAttributeFromItemTable(itemTable,"Url","ServerUrl"),e;if(currentItemFileUrl!=null)e=escapeProperly(unescapeProperly(currentItemFileUrl));var h=c.lastIndexOf(".");if(h>0)for(var j=c.substring(h+1,c.length).toLowerCase(),f=false,a=0;a<rgDocTransformers.length;a++)if(rgDocTransformers[a].ConvertFrom==j){var g=GetAttributeFromItemTable(itemTable,"CId","ContentTypeId"),l=new RegExp("/|"+g+"|/");if(g!=null&&!l.test(rgDocTransformers[a].ExcludedContentTypes)){if(!f){b=CASubM(m,Strings.STS.L_DocTran_Text,ctx.imagesPath+"ConvertDocument.gif",Strings.STS.L_DocTran_Text,String(500));b.IsSubMenu=true;b.Id="ID_ConvertDocument";f=true}var d="STSNavigate('"+k.HttpRoot+"/_layouts/15/"+escapeProperlyCore(rgDocTransformers[a].TransformUIPage,true)+"?FileName="+e+"&TID="+rgDocTransformers[a].Id;d=AddSourceToUrl(d)+"')";var i;i=CAMOpt(b,rgDocTransformers[a].Name,d,"");i.Id="ID_Transform"+rgDocTransformers[a].Id}}}function AddMeetingMenuItems(g,b){if(itemTable.getAttribute("menuType")=="Orphaned"){var a,f=GetAttributeFromItemTable(itemTable,"ItemId","Id"),c=Strings.STS.L_Move_Text,e="GoToMtgMove('"+b.listUrlDir+"',"+f+",'"+itemTable.getAttribute("DateTime")+"','"+itemTable.getAttribute("DateTimeISO")+"')",d="";a=CAMOpt(g,c,e,d);a.id="ID_Move";c=Strings.STS.L_Keep_Text;e="MtgKeep('"+b.HttpPath+"','"+b.listName+"',"+f+")";d="";a=CAMOpt(g,c,e,d);a.id="ID_Keep";c=Strings.STS.L_Delete_Text;e="MtgDelete('"+b.HttpPath+"','"+b.listName+"',"+f+")";d=b.imagesPath+"delitem.gif";a=CAMOpt(g,c,e,d);a.id="ID_Delete"}}function AddListMenuItems(d,a){if(typeof Custom_AddListMenuItems!="undefined")if(Custom_AddListMenuItems(d,a))return;if(currentItemFileUrl==null)currentItemFileUrl=GetAttributeFromItemTable(itemTable,"Url","ServerUrl");var g;if(currentItemFileUrl!=null)g=escapeProperly(unescapeProperly(currentItemFileUrl));var j=currentItemID;if(currentItemIsEventsExcp==null){currentItemIsEventsExcp=false;currentItemIsEventsDeletedExcp=false;currentItemEvtType=parseInt(itemTable.getAttribute("EventType"));if(currentItemEvtType!=null&&(currentItemEvtType==2||currentItemEvtType==3||currentItemEvtType==4)){currentItemIsEventsExcp=true;if(currentItemEvtType==3)currentItemIsEventsDeletedExcp=true;if(currentItemID.indexOf(".")!=-1)j=currentItemID.split(".")[0]}}var c,b,f;if(a.listBaseType==3&&a.listTemplate==108){var e=Strings.STS.L_Reply_Text;if(itemTable.getAttribute("Ordering").length>=504)b="alert('"+Strings.STS.L_ReplyLimitMsg_Text+"')";else{b="STSNavigate('"+a.newFormUrl+"&Threading="+escapeProperly(itemTable.getAttribute("Ordering"))+"&Guid="+escapeProperly(itemTable.getAttribute("ThreadID"))+"&Subject="+escapeProperly(itemTable.getAttribute("Subject"));b=AddSourceToUrl(b)+"')"}f=a.imagesPath+"reply.gif";c=CAMOpt(d,e,b,f,null,String(100));c.id="ID_Reply"}AddSharedNamespaceMenuItems(d,a);var i=itemTable.getAttribute("CId");if(i!=null&&i.indexOf("0x0106")==0&&HasRights(16,0)){e=Strings.STS.L_ExportContact_Text;b="STSNavigate('"+a.HttpPath+"&Cmd=Display&CacheControl=1&List="+a.listName+"&ID="+currentItemID+"&Using="+escapeProperly(a.listUrlDir)+"/vcard.vcf')";f=a.imagesPath+"exptitem.gif";c=CAMOpt(d,e,b,f,null,String(350));CUIInfo(c,"ExportContact",["ExportContact"]);c.id="ID_ExportContact"}CAMSep(d);a.verEnabled==1&&AddVersionsMenuItem(d,a,g);if(HasRights(0,4)&&a.isModerated==true&&HasRights(0,16)&&HasRights(0,135168)&&a.listBaseType!=4&&currentItemID.indexOf(".0.")<0){e=Strings.STS.L_ModerateItem_Text;b="NavigateToApproveRejectAspx(event, '"+a.HttpRoot+"/_layouts/15/approve.aspx?List="+a.listName+"&ID="+j;b=AddSourceToUrl(b)+"')";f=a.imagesPath+"apprj.gif";c=CAMOpt(d,e,b,f,null,String(850));CUIInfo(c,"Moderate",["Moderate"]);c.id="ID_ModerateItem"}CAMSep(d);AddWorkflowsMenuItem(d,a);var h=typeof _spPageContextInfo!="undefined"&&_spPageContextInfo!=null&&_spPageContextInfo.alertsEnabled;if(currentItemID.indexOf(".0.")<0&&HasRights(128,0)&&!a.ExternalDataList&&h){e=Strings.STS.L_Subscribe_Text;b="NavigateToSubNewAspxV4(event, '"+a.HttpRoot+"', 'List="+a.listName+"&ID="+currentItemID+"')";f="";c=CAMOpt(d,e,b,f,null,String(1100));c.id="ID_Subscribe";CUIInfo(c,"Subscribe",["Subscribe"])}(h||!a.ExternalDataList&&HasRights(0,4))&&CAMSep(d);AddManagePermsMenuItem(d,a,a.listName,currentItemID);if(currentItemID.indexOf(".0.")<0&&HasRights(0,8)&&!currentItemIsEventsExcp){if(a.listBaseType==4)e=Strings.STS.L_DeleteResponse_Text;else e=Strings.STS.L_DeleteItem_Text;b="DeleteListItem()";f=a.imagesPath+"delitem.gif";c=CAMOpt(d,e,b,f,null,String(1180));CUIInfo(c,"Delete",["Delete"]);c.id="ID_DeleteItem";CUIInfo(c,"Delete",["Delete"])}var k=currentItemProgId!=null&&currentItemProgId!="";if(currentItemFSObjType=="1"&&!k&&HasRights(0,4)&&a.ContentTypesEnabled&&a.listTemplate!=108){e=Strings.STS.L_CustomizeNewButton_Text;b="STSNavigate('"+a.HttpRoot+"/_layouts/15/ChangeContentTypeOrder.aspx?List="+a.listName+"&RootFolder="+g;b=AddSourceToUrl(b)+"')";f="";c=CAMOpt(d,e,b,f,null,String(1170));CUIInfo(c,"ChangeNewButton",["ChangeNewButton"]);c.id="ID_CustomizeNewButton"}}function ReplaceUrlTokens(c,d){var e;if(c==null||c==""){c="";return c}if(currentItemID!=null)c=c.replace(/{ItemId}/g,currentItemID);var a=null,b=null,f=c.indexOf("?");if(-1!=f&&f+2<c.length){a=c.substr(f+1);b=c.substr(0,f+1)}else b=c;if(currentItemFileUrl!=null){if(null!=a){e=escapeProperly(unescapeProperly(currentItemFileUrl));a=a.replace(/{ItemUrl}/g,e)}b=b.replace(/{ItemUrl}/g,currentItemFileUrl)}if(d.HttpRoot!=null){if(null!=a){e=escapeProperly(unescapeProperly(d.HttpRoot));a=a.replace(/{SiteUrl}/g,e)}b=b.replace(/{SiteUrl}/g,d.HttpRoot)}if(d.listName!=null){if(null!=a){e=escapeProperly(d.listName);a=a.replace(/{ListId}/g,e)}b=b.replace(/{ListId}/g,d.listName)}if(d.listUrlDir!=null){if(null!=a){e=escapeProperly(unescapeProperly(d.listUrlDir));a=a.replace(/{ListUrlDir}/g,e)}b=b.replace(/{ListUrlDir}/g,d.listUrlDir)}var g=GetSource();b=b.replace(/{Source}/g,g);if(a!=null)if(b.length+a.length+g.length>1950)a=a.replace(/{Source}/g,"");else a=a.replace(/{Source}/g,g);return null==a?b:b+a}var SYSTEM_ACCOUNT_ID;function UseCustomAction(c,a,f,g,j,k,e,d,h){a:;var b=false,i=true;if(a!=null){a=a.toLowerCase();if(c=="FileType")b=j==a.toLowerCase();else if(c=="ProgId")b=k==a.toLowerCase();else if(c=="ContentType")b=e!=null&&e.indexOf(a.toLowerCase())==0;else if(c=="List")if(null!=d&&d==a)b=true;else if(null!=h&&h==a)b=true}if(b)i=!HasRights(f,g)||IsTrimmedBySystem(f,g);return b&&!i}function InsertFeatureMenuItems(x,f){CAMSep(x);var j=GetAttributeFromItemTable(itemTable,"Ext","FileType"),k=GetAttributeFromItemTable(itemTable,"Type","HTMLType"),h=GetAttributeFromItemTable(itemTable,"CId","ContentTypeId"),n=null,l=null,q=ecbItems;if(f!=null){n=String(f.listTemplate);if(null!=f.listName&&0<f.listName.length){l=f.listName.toLowerCase();q=q+"_"+l}}if(j!=null)j=j.toLowerCase();if(k!=null)k=k.toLowerCase();if(h!=null)h=h.toLowerCase();var v,o=document.getElementById(q),m=new Array(0),a=null,d=0,t=[];if(o!=null)for(var p=0;p<o.childNodes.length;p++){var b=o.childNodes[p],B=GetInnerText(b.childNodes[5]),C=GetInnerText(b.childNodes[6]),z=parseInt(GetInnerText(b.childNodes[3])),A=parseInt(GetInnerText(b.childNodes[4]));if(!UseCustomAction(B,C,z,A,j,k,h,n,l))continue;a={};a.Title=GetInnerText(b.childNodes[0]);a.ImageUrl=GetInnerText(b.childNodes[1]);a.Action=GetInnerText(b.childNodes[2]);a.Sequence=parseInt(GetInnerText(b.childNodes[7]));var i=GetInnerText(b.childNodes[8]);a.ProductId=i.length>0?i:null;a.FromTenantApp=false;if(i!=null&&i.length>0)t[i]=true;m.push(a)}var u=GetTenantAppData();if(u!=null){var w=u.apps;for(d=0;d<w.length;d++)for(var r=w[d],s=0;s<r.customActions.length;s++)try{a=r.customActions[s];if(!UseCustomAction(a.registrationType,a.registrationId,parseInt(a.rightsHigh),parseInt(a.rightsLow),j,k,h,n,l))continue;if(typeof t[a.productId]!="undefined")continue;var c={};c.Title=a.title;c.ImageUrl=a.imageUrl;c.Action=a.action;c.Sequence=parseInt(a.sequence);c.ProductId=a.productId;c.FromTenantApp=true;c.AppTitle=r.title;m.push(c)}catch(D){throw D;}}for(d=0;d<m.length;d++){a=m[d];var e=ReplaceUrlTokens(a.Action,f),g=null;if(a.FromTenantApp){if(e.startsWith("javascript:LaunchApp"))g=e;else if(e.substr(0,11)!="javascript:")g="STSNavigate('"+STSScriptEncode(e)+"')"}else if(e.substr(0,11)=="javascript:")g=e;else g="STSNavigate('"+STSScriptEncode(e)+"')";if(g!=null){var y=a.ImageUrl==null?null:ReplaceUrlTokens(a.ImageUrl,f);v=CIMOpt(x,a.Title,g,y,null,String(a.Sequence));v.id="ID_"+a.Title}}}function GetRootFolder2(d){var b=GetUrlKeyValue("RootFolder",false),c=d.clvp;if(c!=null&&c.rootFolder!=null)b=c.rootFolder;if(b==""||bValidSearchTerm){var a;if(itemTable!=null)a=GetAttributeFromItemTable(itemTable,"DRef","FileDirRef");if(a!=null&&a!="")if(a.substring(0,1)=="/")b=a;else b="/"+a;else b=d.listUrlDir}return b}function GetRootFolder(b){var a=GetRootFolder2(b);return"&RootFolder="+escapeProperly(a)}function HasRights(a,b){if(currentItemPermMaskH==null){if(itemTable==null)return true;var c=GetAttributeFromItemTable(itemTable,"Perm","PermMask");if(c==null)return true;var d=itemTable.getAttribute("Author");SetCurrentPermMaskFromString(c,d)}return!currentItemCanModify&&(EqualRights(a,b,0,4)||EqualRights(a,b,0,8)||EqualRights(a,b,1073741824,0))?false:(b&currentItemPermMaskL)==b&&(a&currentItemPermMaskH)==a}function EqualRights(a,c,b,d){return a==b&&c==d}function CheckIfHasRights(a,b,c,d){return(b&d)==b&&(a&c)==a}function IsTrimmedBySystem(b,c){var a=false;if(CheckIfHasRights(0,4,b,c)&&itemTable!=null){if(currentItemCheckedOutUserId==null)currentItemCheckedOutUserId=itemTable.getAttribute("COUId");a=currentItemCheckedOutUserId==String(SYSTEM_ACCOUNT_ID)&&ctx.CurrentUserId!=String(SYSTEM_ACCOUNT_ID)}return a}function GetPermMaskH(b){var a=b.length;return a<=10?0:parseInt(b.substring(2,a-8),16)}function GetPermMaskL(b){var a=b.length;return a<=10?parseInt(b):parseInt(b.substring(a-8,a),16)}function SetCurrentPermMaskFromString(b,a){currentItemPermMaskH=GetPermMaskH(b);currentItemPermMaskL=GetPermMaskL(b);currentItemCanModify=a==null||HasRights(0,2048)||ctx.CurrentUserId==a||ctx.CurrentUserId==null||typeof ctx.WriteSecurity=="number"&&ctx.WriteSecurity==1}function AddSharedNamespaceMenuItems(i,a){var j=GetRootFolder(a);setupMenuContext(a);if(currentItemFileUrl==null)currentItemFileUrl=GetAttributeFromItemTable(itemTable,"Url","ServerUrl");if(currentItemFSObjType==null)currentItemFSObjType=String(parseInt(GetAttributeFromItemTable(itemTable,"OType","FSObjType")));if(currentItemContentTypeId==null)currentItemContentTypeId=GetAttributeFromItemTable(itemTable,"CId","ContentTypeId");if(currentItemModerationStatus==null)currentItemModerationStatus=GetAttributeFromItemTable(itemTable,"MS","MStatus");if(currentItemCheckedOutUserId==null)currentItemCheckedOutUserId=itemTable.getAttribute("COUId");if(currentItemCheckedoutToLocal==null)currentItemCheckedoutToLocal=GetAttributeFromItemTable(itemTable,"COut","IsCheckedoutToLocal ");if(currentItemCheckedoutToLocal!="1")currentItemCheckedoutToLocal="0";var l=currentItemCheckedOutUserId==String(SYSTEM_ACCOUNT_ID)&&a.CurrentUserId!=String(SYSTEM_ACCOUNT_ID);bIsCheckout=0;if(a.isForceCheckout==true&&currentItemCheckedOutUserId==""&&currentItemFSObjType!="1")bIsCheckout=1;var k;if(currentItemFileUrl!=null)k=escapeProperly(unescapeProperly(currentItemFileUrl));var c,d,b,g;if(a.listBaseType==1)d=Strings.STS.L_ViewProperties_Text;else if(a.listBaseType==4)d=Strings.STS.L_ViewResponse_Text;else d=Strings.STS.L_ViewItem_Text;var f="";if(currentItemContentTypeId!=null&&currentItemContentTypeId!="")f="&ContentTypeID="+currentItemContentTypeId;var e="&";if(a.displayFormUrl.indexOf("?")==-1)e="?";var h=a.displayFormUrl+e+"ID="+currentItemID+f;h=AddSourceToUrl(h)+j;if(301==a.listTemplate)b="EditItem('"+h+"')";else b="EditItem2(event, '"+h+"')";c=CAMOpt(i,d,b,g,null,String(200));CUIInfo(c,"ViewProperties",["ViewProperties"]);if(a.listBaseType==1)c.id="ID_ViewProperties";else c.id="ID_ViewItem";if(HasRights(0,4)&&!l&&!currentItemIsEventsDeletedExcp){if(a.listBaseType==1)d=Strings.STS.L_EditProperties_Text;else if(a.listBaseType==4)d=Strings.STS.L_EditResponse_Text;else d=Strings.STS.L_EditItem_Text;e="&";if(a.editFormUrl.indexOf("?")==-1)e="?";if(a.listBaseType==1){b="EditItemWithCheckoutAlert(event, '"+a.editFormUrl+e+"ID="+currentItemID+f;b=AddSourceToUrl(b)+j+"',"+String(bIsCheckout)+",'"+currentItemCheckedoutToLocal+"','"+STSScriptEncode(currentItemFileUrl)+"','"+a.HttpRoot+"')"}else if(FV4UI())b="EditItem2(event, '"+a.editFormUrl+e+"ID="+currentItemID+f+"')";else{b="EditItem('"+a.editFormUrl+e+"ID="+currentItemID+f;b=AddSourceToUrl(b)+"')"}g=a.imagesPath+"edititem.gif";c=CAMOpt(i,d,b,g,null,String(220));if(a.listBaseType==1){c.id="ID_EditProperties";CUIInfo(c,"EditProperties",["EditProperties"])}else{c.id="ID_EditItem";CUIInfo(c,"EditProperties",["EditProperties"])}if(a.listTemplate==106&&currentItemID.indexOf(".0.")>0){var n=currentItemID.indexOf(".0."),m=currentItemID.substr(0,n);d=Strings.STS.L_EditSeriesItem_Text;b="EditItem2(event, '"+a.editFormUrl+e+"ID="+m+f;b=AddSourceToUrl(b)+"')";g=a.imagesPath+"recurrence.gif";c=CAMOpt(i,d,b,g,null,String(230));CUIInfo(c,"EditSeriesItem",["EditSeriesItem"]);c.id="ID_EditSeriesItem"}}}function AddSolutionsCatalogMenuItems(a,f){if(HasRights(0,4))if(currentItemFSObjType!="1"){var d=true,b=GetAttributeFromItemTable(itemTable,"Url",null);if(b.length>4){var h=b.substr(b.length-4).toLowerCase();if(h==".wsp"){var c=GetAttributeFromItemTable(itemTable,"SolutionHash",null),g=GetAttributeFromItemTable(itemTable,"Hash",null),i=GetAttributeFromItemTable(itemTable,"SolutionItemID",null),e=GetAttributeFromItemTable(itemTable,"Status",null),j=GetAttributeFromItemTable(itemTable,"id",null);if(c!="")if(e=="")AddSolutionMenuActivate(a);else if(c==g){d=false;AddSolutionMenuDeactivate(a)}else AddSolutionMenuUpgrade(a)}}d&&AddSolutionMenuDelete(a,f)}}function AddSolutionMenuHelper(i,d,f,e,g,b,c){var a,h="if(event){event.currentItemID="+currentItemID+';}RunSolutionOperation(event, "'+f+'")';a=CAMOpt(i,d,h,e,null,String(g));CUIInfo(a,b,[b]);a.id=c}function AddSolutionMenuActivate(a){typeof window.SPUserCanManageSolutions=="boolean"&&window.SPUserCanManageSolutions==true&&AddSolutionMenuHelper(a,Strings.STS.L_ActivateSolution_Text,"ACT","",1210,"ActivateSolution","ID_ActivateSolution")}function AddSolutionMenuDeactivate(a){typeof window.SPUserCanManageSolutions=="boolean"&&window.SPUserCanManageSolutions==true&&AddSolutionMenuHelper(a,Strings.STS.L_DeactivateSolution_Text,"DEA","",1220,"DeactivateSolution","ID_DeactivateSolution")}function AddSolutionMenuUpgrade(a){typeof window.SPUserCanManageSolutions=="boolean"&&window.SPUserCanManageSolutions==true&&AddSolutionMenuHelper(a,Strings.STS.L_UpgradeSolution_Text,"UPG","",1230,"UpgradeSolution","ID_UpgradeSolution")}function AddSolutionMenuDelete(h,b){var a,c;currentItemFileUrl=GetAttributeFromItemTable(itemTable,"Url","ServerUrl");if(currentItemFileUrl!=null)c=escapeProperly(unescapeProperly(currentItemFileUrl));var e=Strings.STS.L_DeleteDocItem_Text,d="false";if(typeof itemTable.getAttribute("CSrc")!="undefined"&&itemTable.getAttribute("CSrc")!=null&&itemTable.getAttribute("CSrc")!="")d="true";var g="DeleteDocLibItem('"+b.HttpPath+"&Cmd=Delete&List="+b.listName+"&ID="+currentItemID+"&owsfileref="+c+"&NextUsing="+GetSource()+"',"+d+")",f=b.imagesPath+"delitem.gif";a=CAMOpt(h,e,g,f,null,"310");a.id="ID_DeleteDocItem";CUIInfo(a,"Delete",["Delete"])}function RunSolutionOperation(a,g){if(a==null&&!IsContextSet())return;var b=currentCtx!=null?currentCtx:typeof a.currentCtx=="object"?a.currentCtx:null,e=currentItemID!=null?currentItemID:typeof a.currentItemID=="string"?a.currentItemID:"";if(b==null)return;var f=b.listUrlDir,i=GetSource(),c=f+"/Forms/Activate.aspx?Op="+g+"&ID="+e+"&Source="+i;if(b.listBaseType==1)c=c+GetRootFolder(b);var h=function(){},j=function(){a:;var a={url:c,args:null,width:650,height:450,dialogReturnValueCallback:h},b=SP.UI.ModalDialog.showModalDialog(a)},d;try{d=typeof SP.UI.ModalDialog.showModalDialog}catch(k){d="undefined"}EnsureScript("SP.UI.Dialog.js",d,j)}function AddDocLibMenuItems(c,a){if(typeof window.Custom_AddDocLibMenuItems!="undefined")if(window.Custom_AddDocLibMenuItems(c,a))return;var l=GetRootFolder(a),b,e,d,f;AddSharedNamespaceMenuItems(c,a);var g;if(currentItemFileUrl!=null)g=escapeProperly(unescapeProperly(currentItemFileUrl));var h=itemTable.getAttribute("SRed"),i=currentItemCheckedOutUserId==String(SYSTEM_ACCOUNT_ID)&&a.CurrentUserId!=String(SYSTEM_ACCOUNT_ID);if(HasRights(0,4)&&HasRights(16,0)&&!i&&(h==null||h==""||HasRights(0,32)))if(a.isWebEditorPreview==0&&a.listBaseType==1)if(a.listTemplate!=119){setDocType();if(currentItemAppName!=""&&currentItemOpenControl!="")if(!(a.IsAppWeb&&currentItemProgId==SPDesignerProgID)){e="";if(currentItemAppName!=" ")e=StBuildParam(Strings.STS.L_EditIn_Text,currentItemAppName);else{var k=StsOpenEnsureEx2(currentItemOpenControl+".3");if(k!=null)e=Strings.STS.L_EditInApplication_Text}if(e!=""){d="editDocumentWithProgID2('"+currentItemFileUrl+"', '"+currentItemProgId+"', '"+currentItemOpenControl+"', '"+String(bIsCheckout)+"', '"+a.HttpRoot+"', '"+currentItemCheckedoutToLocal+"', '"+currentItemOpenApp+"')";f=a.imagesPath+currentItemIcon;b=CAMOpt(c,e,d,f,null,String(260));b.id="ID_EditIn_"+currentItemAppName;b.style.cssText="display:none";CUIInfo(b,"EditDocument",["EditDocument"])}}}CAMSep(c);if(HasRights(0,4))if(currentItemFSObjType!="1")a.listBaseType==1&&AddCheckinCheckoutMenuItem(c,a,g);(a.verEnabled==1||a.isModerated)&&currentItemFSObjType!="1"&&AddVersionsMenuItem(c,a,g);if(HasRights(0,4))if(a.isModerated==true&&HasRights(0,16)&&((currentItemModerationStatus==String(2)||!a.EnableMinorVersions)&&currentItemCheckedOutUserId==""||currentItemFSObjType=="1")){e=Strings.STS.L_ModerateItem_Text;d="NavigateToApproveRejectAspx(event, '"+a.HttpRoot+"/_layouts/15/approve.aspx?List="+a.listName+"&ID="+currentItemID;d=AddSourceToUrl(d)+GetRootFolder(a)+"')";f=a.imagesPath+"apprj.gif";b=CAMOpt(c,e,d,f,null,String(850));CUIInfo(b,"Moderate",["Moderate"]);b.id="ID_ModerateItem"}CAMSep(c);AddWorkflowsMenuItem(c,a);if(currentItemFSObjType!="1"){if(a.PortalUrl!=null){e=Strings.STS.L_AddToMyLinks_Text;d="Portal_Tasks('PinToMyPage')";f="";b=CAMOpt(c,e,d,f,null,String(1e3));CUIInfo(b,"AddToMyLinks",["AddToMyLinks"]);b.id="ID_AddToMyLinks";b.style.display="none"}}else a.listBaseType==1&&HasRights(16,0)&&AddWorkOfflineMenuItem(c,a,currentItemFileUrl);if(HasRights(128,0)&&typeof _spPageContextInfo!="undefined"&&_spPageContextInfo!=null&&typeof _spPageContextInfo.alertsEnabled=="boolean"&&_spPageContextInfo.alertsEnabled){e=Strings.STS.L_Subscribe_Text;d="NavigateToSubNewAspxV4(event, '"+a.HttpRoot+"', 'List="+a.listName+"&ID="+currentItemID+"')";f="";b=CAMOpt(c,e,d,f,null,String(1100));CUIInfo(b,"Subscribe",["Subscribe"]);b.id="ID_Subscribe";b.style.display="none"}if(currentItemFSObjType!="1"){AddSendSubMenu(c,a);AddGotoSourceItemMenuItem(c,a,itemTable,currentItemFSObjType);AddDocTransformSubMenu(c,a)}CAMSep(c);AddManagePermsMenuItem(c,a,a.listName,currentItemID);if(HasRights(0,8)&&!i){e=Strings.STS.L_DeleteDocItem_Text;var j="false";if(typeof itemTable.getAttribute("CSrc")!="undefined"&&itemTable.getAttribute("CSrc")!=null&&itemTable.getAttribute("CSrc")!="")j="true";d="DeleteDocLibItem('"+a.HttpPath+"&Cmd=Delete&List="+a.listName+"&ID="+currentItemID+"&owsfileref="+g+"&NextUsing="+GetSource()+"',"+j+")";f=a.imagesPath+"delitem.gif";b=CAMOpt(c,e,d,f,null,String(1190));b.id="ID_DeleteDocItem";CUIInfo(b,"Delete",["Delete"])}if(HasRights(0,4)&&currentItemFSObjType=="1"&&a.ContentTypesEnabled&&a.listTemplate!=108){e=Strings.STS.L_CustomizeNewButton_Text;d="STSNavigate('"+a.HttpRoot+"/_layouts/15/ChangeContentTypeOrder.aspx?List="+a.listName+"&RootFolder="+g;d=AddSourceToUrl(d)+"')";f="";b=CAMOpt(c,e,d,f,null,String(1170));CUIInfo(b,"ChangeNewButton",["ChangeNewButton"]);b.id="ID_CustomizeNewButton"}}function AddManagePermsMenuItem(h,a,f,g){if(!HasRights(0,131072)||currentItemIsEventsExcp||a.ExternalDataList||currentItemEvtType==5)return;var c=Strings.STS.L_SharedWithDialogTitle,e="EnsureScriptFunc('sharing.js', 'DisplaySharedWithDialog', function () {ULSw7Q:; DisplaySharedWithDialog('"+a.HttpRoot+"', '"+f+"','"+g+"'); })",d=a.imagesPath+"permissions16.png",b=CAMOpt(h,c,e,d,null,String(1160));b.id="ID_MngPerms";CUIInfo(b,"ManagePermissions",["ManagePermissions"])}function AddGotoSourceItemMenuItem(i,h,e,g){if(g!="1"){var a=e.getAttribute("CSrc");if(typeof a!="undefined"&&a!=null&&a!=""){var c=Strings.STS.L_GoToSourceItem_Text,f="NavigateToSourceItem(event, '"+STSScriptEncode(a)+"')",d=h.imagesPath+"goToOriginal.gif",b=CAMOpt(i,c,f,d,null,String(440));b.id="ID_GoToSourceItem";CUIInfo(b,"GotoSourceItem",["GotoSourceItem"])}}}function CheckoutSingleItemFromECB(c,d){var a;try{a=typeof inplview.CheckOutSingleItem}catch(g){a="undefined"}var f="inplview.CheckOutSingleItem",b=f.split(".");if(b.length>1){var e=function(){a:;inplview.CheckOutSingleItem(c,d)};EnsureScript(b[0],a,e)}}function AddCheckinCheckoutMenuItem(g,a,f){var b,d,e,c;if(!HasRights(0,4))return;if(currentItemCheckedOutUserId==String(SYSTEM_ACCOUNT_ID)&&a.CurrentUserId!=String(SYSTEM_ACCOUNT_ID))return;if(currentItemCheckedOutUserId==null)currentItemCheckedOutUserId=itemTable.getAttribute("COUId");if(currentItemCheckedOutUserId!=""){if(currentItemCheckedOutUserId==a.CurrentUserId||a.CurrentUserId==null||HasRights(0,256)){d=Strings.STS.L_Checkin_Text;if(!FV4UI())c="NavigateToCheckinAspx('"+a.HttpRoot+"', 'List="+a.listName+"&FileName="+f+"')";else c="CheckInSingleItemFromECB(event, currentCtx, itemTable)";e=a.imagesPath+"checkin.gif";b=CAMOpt(g,d,c,e,null,String(300));b.id="ID_Checkin";CUIInfo(b,"CheckIn",["CheckIn"]);d=Strings.STS.L_DiscardCheckou_Text;c="UnDoCheckOutwithNotification('"+a.HttpRoot+"', '"+f+"')";e=a.imagesPath+"unchkout.gif";b=CAMOpt(g,d,c,e,null,String(310));b.id="ID_DiscardCheckou";CUIInfo(b,"DiscardCheckOut",["DiscardCheckOut"])}}else if(typeof g_disableCheckoutInEditMode=="undefined"||!g_disableCheckoutInEditMode){d=Strings.STS.L_Checkout_Text;currentItemOpenControl==""&&setDocType();var l="",j=itemTable.getAttribute("SRed");if(j==null||j==""||HasRights(0,32)){if(!FV4UI())c="CheckoutDocument('"+a.HttpRoot+"', '"+f+"', '"+l+"')";else c="CheckoutSingleItemFromECB(currentCtx, itemTable)";e=a.imagesPath+"checkout.gif";b=CAMOpt(g,d,c,e,null,String(300));b.id="ID_Checkout";CUIInfo(b,"CheckOut",["CheckOut"])}if(currentItemModerationStatus==null)currentItemModerationStatus=GetAttributeFromItemTable(itemTable,"MS","MStatus");if(a.EnableMinorVersions){if(currentItemUIString==null)currentItemUIString=GetAttributeFromItemTable(itemTable,"UIS","UIString");var k=parseInt(currentItemUIString)%512;if((currentItemModerationStatus==String(1)||currentItemModerationStatus==String(3))&&a.isModerated||!a.isModerated&&k!=0){d=Strings.STS.L_PublishItem_Text;c="PublishMajorVersion(event, '"+a.HttpRoot+"', 'List="+a.listName+"&FileName="+f+"&Publish=true')";e=a.imagesPath+"pubmajor.gif";b=CAMOpt(g,d,c,e,null,String(320));CUIInfo(b,"Publish",["Publish"]);b.id="ID_PublishItem"}else{var i,h=false;if(!a.isModerated||currentItemModerationStatus==String(0)){d=Strings.STS.L_UnPublishItem_Text;i="ID_UnPublishItem";e=a.imagesPath+"unpub.gif"}else{d=Strings.STS.L_CancelPublish_Text;i="ID_CancelPublish";e=a.imagesPath+"unapprv.gif";h=true}c="UnPublish('"+a.HttpRoot+"', 'FileName="+f+"&UnPublish=true',"+String(h)+")";b=CAMOpt(g,d,c,e,null,String(330));if(h)CUIInfo(b,"CancelApproval",["CancelApproval"]);else CUIInfo(b,"Unpublish",["Unpublish"]);b.id=i}}}}function AddWorkflowsMenuItem(h,a){if(HasRights(0,4)&&!a.ExternalDataList){var f=GetAttributeFromItemTable(itemTable,"CId","ContentTypeId");if(f==null||f.substr(0,8)!="0x010801"){var g=a.imagesPath+"workflows.png",c,d=(""+currentItemID).indexOf(".0.");if(d>0)c=currentItemID.substr(0,d);else c=currentItemID;var b="STSNavigate('"+a.HttpRoot+"/_layouts/15/Workflow.aspx?ID="+c+"&List="+a.listName;b=AddSourceToUrl(b)+"')";var e=CAMOpt(h,Strings.STS.L_Workflows_Text,b,g,null,String(900));CUIInfo(e,"ViewWorkflows",["ViewWorkflows"]);e.id="ID_Workflows"}}}function AddWorkspaceMenuItem(e,b){var a,c,d=GetAttributeFromItemTable(itemTable,"SUrl","SourceUrl");if(d!=null&&d!=""&&d!="%20"){if(HasRights(0,135168)){c="STSNavigate('"+b.HttpRoot+"/_layouts/15/publishback.aspx?list="+b.listName+"&item="+currentItemID+GetRootFolder(b)+"')";a=CAMOpt(e,Strings.STS.L_PublishBack_Text,c,"",null,String(1140));CUIInfo(a,"PublishBack",["PublishBack"]);a.id="ID_PublishBack"}}else if(HasRights(0,8388608)&&HasRights(0,135168)&&HasRights(0,67108864)){c="STSNavigate('"+b.HttpRoot+"/_layouts/15/createws.aspx?list="+b.listName+"&item="+currentItemID+GetRootFolder(b)+"')";a=CAMOpt(e,Strings.STS.L_CreateDWS_Text,c,"",null,String(1140));CUIInfo(a,"CreateDocumentWorkspace",["CreateDocumentWorkspace"]);a.id="ID_CreateDWS"}}function AddVersionsMenuItem(i,a,h){if(currentItemID!=null){var d=currentItemID.toString();if(d.indexOf(".0.")>=0)return}var b=currentItemID;if(currentItemIsEventsExcp)if(currentItemID.indexOf(".")!=-1)b=currentItemID.split(".")[0];if(!HasRights(0,64))return;var e=Strings.STS.L_Versions_Text,g="NavigateToVersionsAspxV4(event, '"+a.HttpRoot+"', 'list="+a.listName+"&ID="+b+"&FileName="+h+"')",f=a.imagesPath+"versions.gif",c=CAMOpt(i,e,g,f,null,String(800));CUIInfo(c,"ViewVersions",["ViewVersions"]);c.id="ID_Versions"}function AddWorkOfflineMenuItem(j,a,i){var b=GetStssyncData("documents",Strings.STS.L_WorkOffline_Text,a.imagesPath+"tbsprsht.gif",a.imagesPath);if(b!=null){var d=b.BtnText,h=b.BtnImagePath;if(d!=null){var f="";if(typeof a.SiteTitle=="string"&&a.SiteTitle!=null)f=STSScriptEncode(a.SiteTitle);var c="";if(typeof a.ListTitle=="string"&&a.ListTitle!=null)c=STSScriptEncode(a.ListTitle);var g="javascript:ExportHailStorm('documents','"+a.HttpRoot+"','"+STSScriptEncode(a.listName)+"','"+STSScriptEncode(f)+"','"+c+"','"+STSScriptEncode(a.listUrlDir)+"','','"+STSScriptEncode(unescapeProperly(a.listUrlDir))+"'";g+=",'"+STSScriptEncode(unescapeProperly(i))+"','"+currentItemID+"')";var e=CAMOpt(j,d,g,h);CUIInfo(e,"ConnectFolderToClient",["ConnectFolderToClient"]);e.id="ID_WorkOffline"}}}function AddVersionMenuItems(b,a){typeof AddVersionMenuItemsCore=="function"&&AddVersionMenuItemsCore(b,a)}function NavigateToApproveRejectAspx(b,a){if(FV4UI())ShowInPopUI(b,currentCtx,a);else STSNavigate(a)}function PublishMajorVersion(d,b,c){var a=b+"/_layouts/15/Checkin.aspx?"+c;a=AddSourceToUrl(a);if(FV4UI())ShowInPopUI(d,currentCtx,a);else SubmitFormPost(a)}function _NavigateToSubNewAspx(b,c){var a=b+"/_layouts/15/SubNew.aspx?"+c;a=AddSourceToUrl(a);STSNavigate(a)}function NavigateToSubNewAspxV4(d,b,c){var a=b+"/_layouts/15/SubNew.aspx?"+c;a=AddSourceToUrl(a);if(FV4UI())ShowInPopUI(d,currentCtx,a);else STSNavigate(a)}function NavigateToVersionsAspx(b,c){var a=b+"/_layouts/15/Versions.aspx?"+c;a=AddSourceToUrl(a);STSNavigate(a)}function NavigateToVersionsAspxV4(d,b,c){var a=b+"/_layouts/15/Versions.aspx?"+c;a=AddSourceToUrl(a);if(FV4UI())ShowInPopUI(d,currentCtx,a);else STSNavigate(a)}function NavigateToSendToOtherLocationV4(b,a){if(FV4UI())ShowInPopUI(b,currentCtx,a);else STSNavigate(a)}function UnDoCheckOutwithNotification(a,c){var b=UnDoCheckOut(a,c);if(b){var d=Strings.STS.L_Notification_DiscardCheckOut;addNotification(d,true)}}function UnDoCheckOut(f,c){try{var b=null,e=SzExtension(unescapeProperly(c));if(FSupportCheckoutToLocal(e))b=StsOpenEnsureEx2("SharePoint.OpenDocuments.3");if(b!=null&&typeof b.DiscardLocalCheckout=="function"){var a=unescapeProperly(c);if(a.charAt(0)=="/")a=window.location.protocol+"//"+window.location.host+a;var d=b.DiscardLocalCheckout(a);if(d){SetWindowRefreshOnFocus();return d}if(IsSupportedMacBrowser()||IsSupportedFirefoxOnWin()){if(!confirm(Strings.STS.L_UndoCheckoutWarning_Text))return false}else return d}else if(!confirm(Strings.STS.L_UndoCheckoutWarning_Text))return false}catch(g){}NavigateToCheckinAspx(f,"FileName="+c+"&DiscardCheckout=true");return true}function UnPublish(c,d,b){var a=Strings.STS.L_UnPublishWarning_Text;if(b)a=Strings.STS.L_CancleApproval_TEXT;if(!confirm(a))return;NavigateToCheckinAspx(c,d)}function NavigateToCheckinAspx(b,c){var a=b+"/_layouts/15/Checkin.aspx?"+c;a=AddSourceToUrl(a);SubmitFormPost(a)}function _NavigateToManagePermsPage(a,c,b){NavigateToManagePermsPageEx(a,c,b,false)}function NavigateToManagePermsPageEx(c,b,d,f){var e=",LISTITEM",a=c+"/_layouts/15/User.aspx?obj="+b+","+d+e+"&List="+b;a=AddSourceToUrl(a);if(f)typeof window.frameElement.navigateParent=="function"&&window.frameElement.navigateParent(a);else STSNavigate(a)}function NavigateToSourceItem(e,a){var d=a.match(/[^\/]*\/\/[^\/]*/g),c=d[0];a=escapeProperly(a);var b=c+"/_layouts/15/copyutil.aspx?GoToDispForm=1&Use=url&ItemUrl="+a;b=AddSourceToUrl(b);STSNavigate(b)}function setDocType(){a:;var b=GetAttributeFromItemTable(itemTable,"Icon","DocIcon"),a=Boolean(b)?b.split("|"):[];currentItemIcon=a[0];currentItemAppName=a[1];currentItemOpenControl=a[2];if(a[3]==null)currentItemOpenApp="";else currentItemOpenApp=a[3];currentItemProgId=GetAttributeFromItemTable(itemTable,"Type","HTMLType")}function DeleteListItem(){a:;if(!IsContextSet())return;var b=currentCtx,e=currentItemID,c=Strings.STS.L_STSRecycleConfirm_Text;if(!b.RecycleBinEnabled||b.ExternalDataList)c=Strings.STS.L_STSDelConfirm_Text;if(Boolean(b.HasRelatedCascadeLists)&&b.CascadeDeleteWarningMessage!=null)c=b.CascadeDeleteWarningMessage+c;if(confirm(c)){var g=Strings.STS.L_Notification_Delete,f=addNotification(g,true),a=b.clvp;if(b.ExternalDataList&&a!=null){a.DeleteItemCore(e);a.pendingItems=[];typeof a.cctx.executeQueryAsync!="undefined"&&a.cctx.executeQueryAsync(function(){a:;if(a.rgehs!=null&&typeof a.rgehs.length=="number"){if(a.rgehs.length==1&&a.rgehs[0].get_serverErrorCode()==SP.ClientErrorCodes.redirect){GoToPage(a.rgehs[0].get_serverErrorValue());return}removeNotification(f);a.ShowErrorDialog(RefreshOnDialogClose)}else RefreshPage(SP.UI.DialogResult.OK)},function(){a:;removeNotification(f);typeof a.rgehs!="undefined"&&a.ShowErrorDialog(function(){})})}else{var d=b.HttpPath+"&Cmd=Delete&List="+b.listName+"&ID="+e+"&NextUsing="+GetSource();if(null!=currentItemContentTypeId)d+="&ContentTypeId="+currentItemContentTypeId;SubmitFormPost(d)}}}function DeleteDocLibItem(d,e){if(!IsContextSet())return;var b=currentCtx,h=currentItemID,g=currentItemFSObjType,a,c=false;if(currentItemFSObjType=="1"){if(currentItemContentTypeId!=null){d+="&ContentTypeId="+currentItemContentTypeId;if(currentItemContentTypeId.substr(0,8).toLowerCase()=="0x0120d5")c=true}if(c)a=b.RecycleBinEnabled?Strings.STS.L_STSRecycleConfirm2_Text:Strings.STS.L_STSDelConfirm2_Text;else a=b.RecycleBinEnabled?Strings.STS.L_STSRecycleConfirm1_Text:Strings.STS.L_STSDelConfirm1_Text}else a=b.RecycleBinEnabled?Strings.STS.L_STSRecycleConfirm_Text:Strings.STS.L_STSDelConfirm_Text;if(Boolean(b.HasRelatedCascadeLists)&&b.CascadeDeleteWarningMessage!=null)a=b.CascadeDeleteWarningMessage+a;if(e&&currentItemFSObjType!="1")a=Strings.STS.L_NotifyThisIsCopy_Text+a;if(confirm(a)){var f=Strings.STS.L_Notification_Delete;addNotification(f,true);SubmitFormPost(d,false,true)}}function EditMenuDefaultForOnclick(){a:;if(!IsContextSet())return;var a=currentCtx;if(Boolean(a.isVersions))STSNavigate(itemTable.getAttribute("verUrl"));else if(a.listTemplate==200){var b=currentItemID;MtgNavigate(b)}else EditListItem()}function EditListItem(){a:;if(event.srcElement.tagName=="A"||event.srcElement.parentNode.tagName=="A")return;if(!IsContextSet())return;var b=currentCtx,c="&";if(b.editFormUrl.indexOf("?")==-1)c="?";var a=b.editFormUrl+c+"ID="+currentItemID;a=AddSourceToUrl(a);if(b.listBaseType==1)a=a+GetRootFolder(b);STSNavigate2(event,a)}function _DoNavigateToTemplateGallery(a,b){document.cookie="MSOffice_AWS_DefSaveLoc="+a;STSNavigate(b)}function Portal_Tasks(j){if(!IsContextSet())return;var b=currentCtx,g=unescapeProperly(currentItemFileUrl),c=0,d=0;c=g.lastIndexOf("/");d=g.lastIndexOf(".");if(c<0||d<0||c>d)return;var i=g.substr(c+1,d-c-1),f="";c=b.HttpRoot.indexOf("://");if(c>0){d=b.HttpRoot.indexOf("/",c+3);if(d>0)f=b.HttpRoot.substring(0,d);else f=b.HttpRoot}var e="";if(currentItemFileUrl.charAt(0)=="/"||currentItemFileUrl.substr(0,3).toLowerCase()=="%2f")e=f+currentItemFileUrl;else e=currentItemFileUrl;var a="";if(setElementValue("ListViewURL",e)==false)a=a+"&ListViewURL="+escapeProperly(e);if(setElementValue("ListTitle",i)==false)a=a+"&ListTitle="+escapeProperly(i);if(setElementValue("ListDescription","")==false)a=a+"&ListDescription=";if(setElementValue("ReturnUrl",window.location.href)==false)a=a+"&ReturnUrl="+escapeProperly(window.location.href);if(b.PortalUrl.substr(0,4)!="http")b.PortalUrl=f+b.PortalUrl;var h=b.PortalUrl+"_vti_bin/portalapi.aspx?cmd="+j;h=h+"&IconUrl="+b.imagesPath+currentItemIcon+a;SubmitFormPost(h)}function IsContextSet(){a:;return currentCtx==null?false:typeof currentCtx.isExplictLogin=="boolean"&&currentCtx.isExplictLogin?true:currentCtx.HttpPath==null||currentItemID==null?false:true}function ChangeContentType(d){var b=document.getElementById(d),a=window.location.href,e=a.indexOf("?");if(a.indexOf("?")<=0)a=a+"?ContentTypeId="+b.value;else if(a.indexOf("&ContentTypeId=")<=0)a=a+"&ContentTypeId="+b.value;else{var c=/&ContentTypeId=[^&]*/i;a=a.replace(c,"&ContentTypeId="+b.value)}STSNavigate(a)}var IMNControlObj,bIMNControlInited,IMNDictionaryObj,bIMNSorted,bIMNOnloadAttached,IMNOrigScrollFunc,bIMNInScrollFunc,IMNSortableObj,IMNHeaderObj,IMNNameDictionaryObj,IMNShowOfflineObj;function GetCurrentEvent(a){a:;return browseris.ie5up?window.event:Boolean(a)?a:window.event}function GetEventTarget(a){return Boolean(a.srcElement)?a.srcElement:a.target}function EnsureIMNControl(){a:;if(!bIMNControlInited||IMNControlObj==null){var b=typeof g_presenceEnabled!="undefined"&&g_presenceEnabled;try{if(IsSupportedMacBrowser())IMNControlObj=CreateMacPlugin();else if(IsSupportedNPApiBrowserOnWin()){IMNControlObj=CreateNPApiOnWindowsPlugin(WIN_FIREFOX_PLUGIN_IM_MIME_TYPE);if(IMNControlObj!=null&&b)IMNControlObj.OnStatusChange=IMNOnStatusChange}else if(browseris.ie5up)if(Boolean(window.ActiveXObject)){IMNControlObj=new ActiveXObject("Name.NameCtrl.1");if(IMNControlObj&&b){var a;if(IsSupportedMacBrowser())a="IMNOnStatusChange";else a=IMNOnStatusChange;IMNControlObj.OnStatusChange=a}}bIMNControlInited=true}catch(c){IMNControlObj=null}AddEvtHandler(window,"onbeforeunload",DiscardIMNControl)}return IMNControlObj}function DiscardIMNControl(){a:;IMNControlObj=null;bIMNControlInited=false}function IMNImageInfo_InitializePrototype(){a:;IMNImageInfo.prototype.img=null;IMNImageInfo.prototype.classPrefix=null;IMNImageInfo.prototype.alt=""}function IMNImageInfo(){}function IMNGetStatusImage(e,d){a:;var f="spimn.png",a="ms-spimn-presence-disconnected",b="";switch(e){case 0:a="ms-spimn-presence-online";b=Strings.STS.L_IMNOnline_Text;break;case 11:a="ms-spimn-presence-online-oof";b=Strings.STS.L_IMNOnline_OOF_Text;break;case 1:if(d){a="ms-spimn-presence-offline";b=Strings.STS.L_IMNOffline_Text}else{a="";b=""}break;case 12:if(d){a="ms-spimn-presence-offline-oof";b=Strings.STS.L_IMNOffline_OOF_Text}else{a="";b=""}break;case 2:a="ms-spimn-presence-away";b=Strings.STS.L_IMNAway_Text;break;case 13:a="ms-spimn-presence-away-oof";b=Strings.STS.L_IMNAway_OOF_Text;break;case 3:a="ms-spimn-presence-busy";b=Strings.STS.L_IMNBusy_Text;break;case 14:a="ms-spimn-presence-busy-oof";b=Strings.STS.L_IMNBusy_OOF_Text;break;case 4:a="ms-spimn-presence-away";b=Strings.STS.L_IMNAway_Text;break;case 5:a="ms-spimn-presence-busy";b=Strings.STS.L_IMNBusy_Text;break;case 6:a="ms-spimn-presence-away";b=Strings.STS.L_IMNAway_Text;break;case 7:a="ms-spimn-presence-busy";b=Strings.STS.L_IMNBusy_Text;break;case 8:a="ms-spimn-presence-away";b=Strings.STS.L_IMNAway_Text;break;case 9:a="ms-spimn-presence-donotdisturb";b=Strings.STS.L_IMNDoNotDisturb_Text;break;case 15:a="ms-spimn-presence-donotdisturb-oof";b=Strings.STS.L_IMNDoNotDisturb_OOF_Text;break;case 21:a="ms-spimn-presence-donotdisturb";b=Strings.STS.L_IMNInPresentation_Text;break;case 10:a="ms-spimn-presence-busy";b=Strings.STS.L_IMNBusy_Text;break;case 16:a="ms-spimn-presence-away";b=Strings.STS.L_IMNIdle_Text;break;case 17:a="ms-spimn-presence-away-oof";b=Strings.STS.L_IMNIdle_OOF_Text;break;case 18:a="ms-spimn-presence-blocked";b=Strings.STS.L_IMNBlocked_Text;break;case 19:a="ms-spimn-presence-busy";b=Strings.STS.L_IMNBusy_Text;break;case 20:a="ms-spimn-presence-busy-oof";b=Strings.STS.L_IMNBusy_OOF_Text}var c=new IMNImageInfo;c.img=f;c.classPrefix=a;c.alt=b;return c}function IMNGetHeaderImage(){a:;var a=new IMNImageInfo;a.img="imnhdr.gif";a.alt="";return a}function IMNIsOnlineState(a){a:;return a==1?false:true}function IMNSortList(g,e,f){a:;var d=null,b=null;if(Boolean(IMNSortableObj)&&IMNSortableObj[g]){b=document.getElementById(g);while(Boolean(b)&&!(b.tagName=="TR"&&typeof b.Sortable!="undefined"))b=b.parentNode;d=b;while(Boolean(d)&&d.tagName!="TABLE")d=d.parentNode;var a=d.rows;if(d!=null&&b!=null){if(a[1].style.display=="none")for(var c=1;c<4;c++)a[c].style.display="block";if(!IMNIsOnlineState(e)&&IMNIsOnlineState(f)){a[2].style.display="none";c=3;while(a[c].id!="Offline"&&Number(a[c].innerText)<Number(b.innerText))c++;typeof d.moveRow=="function"&&d.moveRow(b.rowIndex,c);if(a[a.length-3].id=="Offline")a[a.length-2].style.display="block"}else if(IMNIsOnlineState(e)&&!IMNIsOnlineState(f)){if(b.rowIndex==3&&a[b.rowIndex+1].id=="Offline")a[2].style.display="block";if(a[a.length-3].id=="Offline")a[a.length-2].style.display="none";c=a.length-2;while(a[c-1].id!="Offline"&&Number(a[c].innerText)>Number(b.innerText))c--;d.moveRow(b.rowIndex,c)}}}}function IMNOnStatusChange(d,b,a){a:;if(Boolean(IMNDictionaryObj)){var c=IMNGetStatusImage(b,IMNSortableObj[a]||IMNShowOfflineObj[a]);if(IMNDictionaryObj[a]!=b){bIMNSorted&&IMNSortList(a,IMNDictionaryObj[a],b);IMNUpdateImage(a,c);IMNDictionaryObj[a]=b}}}function IMNUpdateImageClassPrefix(b,c){a:;var d=/ms-spimn-presence-[a-zA-Z]*-([0-9])/i,a=b.getAttribute("class");a!=null&&b.setAttribute("class",a.replace(d,c+"-$1"))}function IMNUpdateImage(l,e){var a=document.images[l];if(Boolean(a)){var d=a.parentNode;d.firstChild!=a&&d.insertBefore(a,d.firstChild);var f=e.img,g=e.classPrefix,k=e.alt,c=a.src;if(typeof a.src=="undefined")c=a.item(0).src;var i=c.lastIndexOf("/"),b=c.slice(0,i+1);b+=f;IMNUpdateImageClassPrefix(a,g);if(c==b&&f!="blank.gif")return;if(typeof a.altbase!="undefined"&&Boolean(a.altbase))a.alt=a.altbase;else a.alt=k;var h=browseris.ie&&browseris.ie55up&&browseris.verIEFull<7,j=b.toLowerCase().indexOf(".png")>0;if(h)if(j){a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src="+b+"),sizingMethod=scale,enabled=true);";a.src="/_layouts/15/images/blank.gif?rev=23"}else{a.style.filter="";a.src=b}else a.src=b}}function IMNHandleAccelerator(b){a:;if(IMNControlObj){var a=GetCurrentEvent(b);if(a.altKey&&a.shiftKey&&a.keyCode==121)typeof IMNControlObj.DoAccelerator!="undefined"&&IMNControlObj.DoAccelerator()}}function IMNImageOnClick(a){a:;if(IMNControlObj){IMNShowOOUIKyb(a);typeof IMNControlObj.DoAccelerator!="undefined"&&IMNControlObj.DoAccelerator()}}function IMNGetOOUILocation(m){a:;var g={},a=m,c=m,o=m,h=0,i=0,t=0,u=document.dir=="rtl",k=a.className;while(Boolean(a)&&(k==null||k.indexOf("ms-imnSpan")==-1)&&a.tagName!="TABLE"){if(a.tagName=="TD"&&k.indexOf("ms-vb")>=0)break;a=a.parentNode;if(!Boolean(a))return null;k=a.className}if(Boolean(a)){var b;if(a.tagName=="TABLE"){var s=a.rows(0),r=s.cells(0);b=r.firstChild}else b=a.firstChild;while(b!=null){if(b.tagName=="A"){var d=b.firstChild;while(d!=null){if(d.tagName=="IMG"&&Boolean(d.id)){b=d;break}d=d.firstChild}}if(b.tagName=="IMG"&&Boolean(b.id)){c=b;break}b=b.nextSibling}o=c;c=a}m=c;var j=1;if(Boolean(browseris.ie9standardUp))j=window.screen.deviceXDPI/window.screen.logicalXDPI;i=c.getBoundingClientRect().top*j-5;h=c.getBoundingClientRect().left*j-5;var f=c.parentNode;while((h<0||i<0)&&f!=null&&Boolean(f.getBoundingClientRect)){i=f.getBoundingClientRect().top*j-5;h=f.getBoundingClientRect().left*j-5;f=f.parentNode}try{var e=window;while(Boolean(e)&&e!=e.parent){var n=e.frameElement,l=Boolean(n)?n.getBoundingClientRect():null,q=Boolean(l)?l.top:0,p=Boolean(l)?l.left:0;i+=q;h+=p;e=e.parent}}catch(v){}g.objSpan=a;g.objOOUI=c!=a?c:o;g.oouiX=h;g.oouiY=i;return g}function IMNShowOOUIMouse(a){a:;IMNShowOOUI(a,0)}function IMNShowOOUIKyb(a){a:;IMNShowOOUI(a,1)}function IMNShowOOUI(j,i){a:;if(browseris.ie5up||IsSupportedMacBrowser()||IsSupportedNPApiBrowserOnWin()){var b=GetCurrentEvent(j),f=GetEventTarget(b),d=f,g=f,e=0,h=0;if(EnsureIMNControl()&&Boolean(IMNNameDictionaryObj)){var a=IMNGetOOUILocation(f);if(Boolean(a)){d=a.objSpan;g=a.objOOUI;e=a.oouiX;h=a.oouiY;if(Boolean(b.clientX))e=b.clientX;var c=IMNNameDictionaryObj[g.id];if(c==null||c.length<1)return;if(Boolean(d))d.onkeydown=IMNHandleAccelerator;typeof IMNControlObj.ShowOOUI!="undefined"&&IMNControlObj.ShowOOUI(c,i,Math.round(e),Math.round(h))}}}}function IMNHideOOUI(){a:;if(Boolean(IMNControlObj)){typeof IMNControlObj.HideOOUI!="undefined"&&IMNControlObj.HideOOUI();return false}return true}function IMNScroll(){a:;if(!bIMNInScrollFunc){bIMNInScrollFunc=true;IMNHideOOUI()}bIMNInScrollFunc=false;return IMNOrigScrollFunc==IMNScroll?true:Boolean(IMNOrigScrollFunc)?IMNOrigScrollFunc():true}var imnCount,imnElems,imnElemsCount,imnMarkerBatchSize,imnMarkerBatchDelay;function ProcessImn(){a:;imnCount=0;imnElems=document.getElementsByName("imnmark");imnElemsCount=imnElems.length;if(EnsureIMNControl())ProcessImnMarkers();else RemoveImnAnchors()}function ClientCanHandleImn(){a:;return EnsureIMNControl()&&typeof IMNControlObj.PresenceEnabled!="undefined"&&IMNControlObj.PresenceEnabled}function RemoveImnAnchors(){a:;for(var b=0;b<imnElemsCount;b++){var c=imnElems[b],a=c.parentNode;while(a!=null&&!IsImnAnchor(a)){c=a;a=a.parentNode}if(IsImnAnchor(a)&&a.childNodes.length==1){a.setAttribute("tabIndex","-1");a.onclick=null}}var d=document.getElementsByName("imnempty");for(b=0;b<d.length;b++){c=d[b];a=c.parentNode;a!=null&&a.tagName=="SPAN"&&!Boolean(a.getAttribute("title"))&&a.appendChild(c)}}function ProcessImnMarkers(){a:;for(var b=0;b<imnMarkerBatchSize;++b){if(imnCount==imnElemsCount)return;var a=imnElems[imnCount];a!=null&&typeof a!="undefined"&&IMNRC(a.getAttribute("sip"),a);imnCount++}setTimeout("ProcessImnMarkers()",imnMarkerBatchDelay)}function IMNRC(d,h){a:;if(d==null||d=="")return;var g=typeof g_presenceEnabled!="undefined"&&g_presenceEnabled&&EnsureIMNControl()&&IMNControlObj.PresenceEnabled;if(browseris.ie5up||IsSupportedMacBrowser()||IsSupportedNPApiBrowserOnWin()){var b=Boolean(h)?h:window.event.srcElement,c=b,a=b.id;if(!Boolean(IMNDictionaryObj)){IMNDictionaryObj={};IMNNameDictionaryObj={};IMNSortableObj={};IMNShowOfflineObj={};if(!Boolean(IMNOrigScrollFunc)){if(typeof window.onscroll!="undefined")IMNOrigScrollFunc=window.onscroll;window.onscroll=IMNScroll}}if(Boolean(IMNDictionaryObj)){if(!IMNNameDictionaryObj[a])IMNNameDictionaryObj[a]=d;if(typeof IMNDictionaryObj[a]=="undefined")IMNDictionaryObj[a]=1;if(!IMNSortableObj[a]&&typeof b.Sortable!="undefined"){IMNSortableObj[a]=b.Sortable;if(!bIMNOnloadAttached&&g){AttachEvent("load",IMNSortTable,window);bIMNOnloadAttached=true}}if(!IMNShowOfflineObj[a]&&b.getAttribute("ShowOfflinePawn")!=null)IMNShowOfflineObj[a]=b.getAttribute("ShowOfflinePawn");if(g){var e=1,i;if(typeof IMNControlObj.GetStatus!="undefined")e=IMNControlObj.GetStatus(d,a);if(IMNIsOnlineState(e)||IMNSortableObj[a]||IMNShowOfflineObj[a]){i=IMNGetStatusImage(e,IMNSortableObj[a]||IMNShowOfflineObj[a]);IMNUpdateImage(a,i);IMNDictionaryObj[a]=e}}}var f=IMNGetOOUILocation(b);if(Boolean(f)){SetImnOnClickHandler(f.objOOUI);c=f.objSpan;if(Boolean(c)){c.onmouseover=IMNShowOOUIMouse;c.onfocusin=IMNShowOOUIKyb;c.onmouseout=IMNHideOOUI;c.onfocusout=IMNHideOOUI}}}}function IsImnAnchor(b){if(!Boolean(b))return false;var a=b.className;return a!=null&&a.indexOf("ms-imnlink")!=-1}function SetImnOnClickHandler(d){var b=d.parentNode,a=b,e=a.className;while(Boolean(a)&&!IsImnAnchor(a))a=a.parentNode;if(Boolean(a))b=a;if(IsImnAnchor(b)){if(typeof b.onclick=="undefined")b.onclick=IMNImageOnClickHandler}else{var c=document.createElement("a");c.onclick=IMNImageOnClickHandler;c.className="ms-imnlink";c.href="javascript:;";b.insertBefore(c,d);c.appendChild(d)}}function IMNImageOnClickHandler(a){a:;IMNImageOnClick(a);return false}function IMNSortTable(){a:;var a;for(a in IMNDictionaryObj)IMNSortList(a,1,IMNDictionaryObj[a]);bIMNSorted=true}function IMNRegisterHeader(d){a:;if(browseris.ie5up||IsSupportedMacBrowser()||IsSupportedNPApiBrowserOnWin()){var b=GetCurrentEvent(d);if(b==null)return;var e=GetEventTarget(b);if(!Boolean(IMNHeaderObj))IMNHeaderObj={};if(Boolean(IMNHeaderObj)){var a=e.id;IMNHeaderObj[a]=a;var c;c=IMNGetHeaderImage();IMNUpdateImage(a,c)}}}function _TopHelpButtonClick(a){if(typeof navBarHelpOverrideKey!="undefined")return HelpWindowKey(navBarHelpOverrideKey);if(a!=null)HelpWindowKey(a);else HelpWindowKey("HelpHome")}function GetSPHelpUrl(d){a:;var c,a;if(typeof d=="undefined")c="?Lcid="+Strings.STS.L_Language_Text;else c="?Lcid="+Strings.STS.L_Language_Text+d;var b;if(typeof ctx=="undefined"||ctx==null)if(typeof currentCtx!="undefined"&&currentCtx!=null)ctx=currentCtx;else if(typeof ctxFilter!="undefined"&&ctxFilter!=null)ctx=ctxFilter;if(typeof ctx!="undefined"&&ctx!=null&&typeof ctx.HttpRoot!="undefined"&&ctx.HttpRoot!=null){a=ctx.HttpRoot;if(a.charAt(a.length-1)!="/")a=a+"/";b=a+"_layouts/15/help.aspx"}if(b==null&&typeof _spPageContextInfo!="undefined"&&_spPageContextInfo!=null&&typeof _spPageContextInfo.webServerRelativeUrl!="undefined"&&_spPageContextInfo.webServerRelativeUrl!=null){a=_spPageContextInfo.webServerRelativeUrl;if(a.charAt(a.length-1)!="/")a=a+"/";b=a+"_layouts/15/help.aspx"}if(b==null)b="/_layouts/15/help.aspx";return b+c}function ShowHelpWindow(a){if(a!=null){var b=window.open(a,"STSHELP_15","height=500,location=no,menubar=no,resizable=yes,scrollbars=no,status=no,toolbar=no,width=400");b.focus()}}function HelpWindowHelper(a){if(SuiteLinksEmptyOrSuiteHelpLinkIsCached())GetSuiteLinks(null,function(b){a:;SP.SOD.executeFunc("suitelinks.js","GetSPOHelpUrl",function(){a:;var c=GetSPOHelpUrl(b,a);ShowHelpWindow(c)})});else{var b=GetSPHelpUrl(a);ShowHelpWindow(b)}}function _HelpWindowKey(a){if(a!=null)HelpWindowHelper("&Key="+a+"&ShowNav=true");else HelpWindowHelper("&Key=HelpHome&ShowNav=true")}function _HelpWindowUrl(a){HelpWindowHelper("&Url="+a)}function _HelpWindow(){a:;HelpWindowKey("HelpHome")}function EditSelectedImages(){a:;if(!IsImgLibJssLoaded()){alert(Strings.STS.L_NotOurView_Text);return}_EditSelectedImages()}function DeleteImages(){a:;if(!IsImgLibJssLoaded()){alert(Strings.STS.L_NotOurView_Text);return}_DeleteImages()}function SendImages(){a:;if(!IsImgLibJssLoaded()){alert(Strings.STS.L_NotOurView_Text);return}_SendImages()}function DownloadImages(){a:;if(!IsImgLibJssLoaded()){alert(Strings.STS.L_NotOurView_Text);return}_DownloadImages()}function MtgToggleTimeZone(){a:;var b=document.getElementById("TimeZoneSection"),a=document.getElementById("TimeZoneLink");if(b.style.display=="none"){b.style.display="";a.innerHTML="&lt;&lt;";a.title=Strings.STS.L_HideTZ_Text;SetMtgCookie("MtgTimeZone","1","")}else{b.style.display="none";a.innerHTML="&gt;&gt;";a.title=Strings.STS.L_ShowTZ_Text;SetMtgCookie("MtgTimeZone","0","")}}function GetPageUrl(b){var a=undefined;if(b&&typeof g_webUrl!="undefined")a=g_webUrl;else if(typeof g_pageUrl!="undefined")a=g_pageUrl;return unescapeProperly(a)}function MtgNavigate(a){if(typeof g_instanceId!="undefined"&&a==g_instanceId)return;if(typeof g_fPageGlobal!="undefined")var c=!g_fPageGlobal;if(typeof g_thispagedata!="undefined")var b=g_thispagedata;window.location.href=GetPageUrl(c)+"?InstanceID="+a+"&"+b}function GoToMtgMove(d,c,b,a){window.location.href=d+"/movetodt.aspx?FromInstanceID="+c+"&FromInstanceDate="+escapeProperly(b)+"&FromInstanceDateISO="+escapeProperly(a)+"&Source="+escapeProperly(window.location.href)}function MtgKeep(b,c,a){confirm(Strings.STS.L_MtgKeepConfirm_Text)&&SubmitFormPost(b+"&Cmd=MtgKeep&List="+escapeProperly(c)+"&EditInstanceID="+a+"&NextUsing="+escapeProperly(window.location.href))}function MtgDelete(c,d,a){if(confirm(Strings.STS.L_MtgDeleteConfirm_Text)){var b=a==g_instanceId;SubmitFormPost(c+"&Cmd=MtgMove&List="+escapeProperly(d)+"&FromInstanceID="+a+"&ToInstanceID=-3&NextUsing="+escapeProperly(b?GetPageUrl(true):window.location.href))}}function SetMtgCookie(a,b,c){document.cookie=a+"="+b+";path="+c}function SetAsLastTabVisited(){a:;typeof g_pageUrl!="undefined"&&typeof g_webUrl!="undefined"&&SetMtgCookie("MtgLastTabVisited",escapeProperly(unescapeProperly(g_pageUrl)),escapeProperlyCore(unescapeProperly(g_webUrl),true))}function MtgRedirect(){a:;var a=GetCookie("MtgLastTabVisited");if(a==null)if(typeof g_webUrl!="undefined")a=g_webUrl;else a="../../";else a=escapeProperlyCore(a,true);window.location.href=a}function MakeMtgInstanceUrl(a,c){if(c!="undefined"&&c!=""){var b=a.indexOf("?");if(b==-1||a.indexOf("InstanceID=",b)==-1)a=a+(b==-1?"?":"&")+"InstanceID="+c}return a}var g_dlgWndTop,g_spDlgLauncher,g_ModalDialogCount,g_overlayPopup,g_childDialog;function _dlgWndTop(){a:;if(Boolean(g_dlgWndTop))return g_dlgWndTop;try{var a=window;while(a!=null&&a!=a.parent){a=a.parent;if(a!=null&&a.g_spDlgLauncher)g_dlgWndTop=a}}catch(b){}finally{if(!Boolean(g_dlgWndTop))g_dlgWndTop=window}return g_dlgWndTop}function commonShowModalDialog(n,b,c,m){function r(){a:;return[]}function d(a,b,c){a.push(b);a[b]=c}function q(b){for(var c=[],a=0;a<b.length;a++)c.push(b[a]);return c}if(document.getElementById("__spPickerHasReturnValue")!=null)document.getElementById("__spPickerHasReturnValue").value="";if(document.getElementById("__spPickerReturnValueHolder")!=null)document.getElementById("__spPickerReturnValueHolder").value="";commonModalDialogReturnValue.clear();var h;if(Boolean(window.showModalDialog)){h=window.showModalDialog(n,m,b);Boolean(c)&&invokeModalDialogCallback(c,h)}else{var l=500,k=550,p="yes";if(!Boolean(b))b="width="+String(l)+",height="+String(k);else{var a=r(),j,f;if(b.search(/^(\s*\w+\s*:\s*.+?\s*)(;\s*\s*\w+\s*:\s*.+?\s*)*(;\s*)?$/)!=-1){j=/^\s*(\w+)\s*:\s*(.+?)\s*$/;f=b.split(/\s*;\s*/)}else{j=/^\s*(\w+)\s*=\s*(.+?)\s*$/;f=b.split(/\s*,\s*/)}for(var s in f){var g=j.exec(f[s]);Boolean(g)&&g.length==3&&d(a,g[1].toLowerCase(),g[2])}!Boolean(a.width)&&d(a,"width",a.dialogwidth||Boolean(l));!Boolean(a.height)&&d(a,"height",a.dialogheight||Boolean(k));!Boolean(a.scrollbars)&&d(a,"scrollbars",a.scroll||Boolean(p));b="";var i=q(a);for(var o in i){if(Boolean(b))b+=",";b+=i[o]+"="+a[i[o]]}}var e=window.open(n,"_blank",b+",modal=yes,dialog=yes");e.dialogArguments=m;window.onfocus=function(){a:;var a=document.getElementById("__spPickerHasReturnValue")!=null&&document.getElementById("__spPickerHasReturnValue").value=="1"||commonModalDialogReturnValue.isSet();if(Boolean(e)&&!e.closed&&!a)e.focus();else{window.onfocus=null;Boolean(c)&&invokeModalDialogCallback(c,h)}};if(!browseris.ie)if(window.frameElement!=null)window.fndlgClose=c}return h}function invokeModalDialogCallback(b,a){a:;if(typeof a!="undefined"&&a!=null)b(a);else if(commonModalDialogReturnValue.isSet()){a=commonModalDialogReturnValue.get();b(a);commonModalDialogReturnValue.clear()}else if(document.getElementById("__spPickerHasReturnValue")!=null&&document.getElementById("__spPickerHasReturnValue").value=="1"&&document.getElementById("__spPickerReturnValueHolder")!=null){a=document.getElementById("__spPickerReturnValueHolder").value;b(a)}return a}function setModalDialogReturnValue(a,b){if(a.opener!=null&&typeof b=="string"&&a.opener.document.getElementById("__spPickerHasReturnValue")!=null&&a.opener.document.getElementById("__spPickerReturnValueHolder")!=null){a.opener.document.getElementById("__spPickerHasReturnValue").value="1";a.opener.document.getElementById("__spPickerReturnValueHolder").value=b}else setModalDialogObjectReturnValue(a,b);if(browseris.safari125up)a.opener!=null&&a.opener.fndlgClose!=null&&a.opener.fndlgClose(b)}function setModalDialogObjectReturnValue(a,b){a:;if(Boolean(a.showModalDialog))a.returnValue=b;if(a.opener!=null)if(typeof a.opener.commonModalDialogReturnValue!="undefined"){var c=a.opener.commonModalDialogReturnValue;c.set(b)}}function CommonGlobalDialogReturnValue_InitializePrototype(){a:;CommonGlobalDialogReturnValue.prototype.hasRetVal=undefined;CommonGlobalDialogReturnValue.prototype.retVal=undefined;CommonGlobalDialogReturnValue.prototype.set=function(a){a:;if(typeof a!="undefined"){this.retVal=a;this.hasRetval=true}};CommonGlobalDialogReturnValue.prototype.isSet=function(){a:;return this.hasRetval};CommonGlobalDialogReturnValue.prototype.get=function(){a:;return this.hasRetval?this.retVal:undefined};CommonGlobalDialogReturnValue.prototype.clear=function(){a:;this.hasRetval=false;this.retVal=null}}function CommonGlobalDialogReturnValue(){}var commonModalDialogReturnValue;function commonModalDialogOpen(d,a,b,c){a:;a.url=d;a.dialogReturnValueCallback=b;a.args=c;EnsureScriptParams("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",a)}function commonModalDialogClose(c,d){a:;var a,b=_dlgWndTop();if(typeof b.g_childDialog!="undefined")a=b.g_childDialog;if(Boolean(a)){a.set_returnValue(d);a.close(c)}}function commonModalDialogGetArguments(){a:;var a,b=_dlgWndTop();if(typeof b.g_childDialog!="undefined")a=b.g_childDialog;return Boolean(a)&&typeof a.get_args!="undefined"?a.get_args():null}function ShowPopupDialog(a){a:;ShowPopupDialogWithCallback(a,PopupDialogCallback)}function ShowPopupDialogWithCallback(a,b){a:;if(FV4UI()){var c={url:a,dialogReturnValueCallback:b};EnsureScriptParams("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",c)}else STSNavigate(a)}function PopupDialogCallback(a){a:;a==1&&STSNavigate(_dlgWndTop().location.href)}var filterTable,bIsFilterMenuShown,bIsFilterDataLoaded,filterImageCell,currentFilterMenu,loadingFilterMenu,ctxFilter,bIsFilterKeyPress,filterStr,strFieldName,bMenuLoadInProgress,strFilteredValue,bIsMultiFilter,fnOnFilterMouseOut;function resetFilterMenuState(){a:;if(bMenuLoadInProgress)return;bIsFilterMenuShown=false;bIsFilterDataLoaded=false;filterTable=null;filterImageCell=null;currentFilterMenu=null;loadingFilterMenu=null;ctxFilter=null;bIsFilterKeyPress=false;fnOnFilterMouseOut!=null&&fnOnFilterMouseOut();fnOnFilterMouseOut=null}function setupFilterMenuContext(a){ctxFilter=a}function IsFilterMenuOn(){a:;var a=false;if(!bIsFilterMenuShown)return false;a=bMenuLoadInProgress||MenuHtc_isOpen(currentFilterMenu)||MenuHtc_isOpen(loadingFilterMenu);if(!a)bIsFilterMenuShown=false;return a}function IsFilterMenuEnabled(b){if(b==null)return true;var a=CtxFromElement(b);return a!=null&&typeof a.fullListSearch!="undefined"&&Boolean(a.fullListSearch)?false:true}function OnMouseOverFilterDeferCall(elm){if(!IsFilterMenuEnabled(elm))return false;if(IsFilterMenuOn()||bMenuLoadInProgress)return false;if(window.location.href.search(new RegExp("[\\?&]Filter=1"))!=-1)return false;if(typeof elm.FilterDisable!=undefined&&elm.FilterDisable=="TRUE")return false;if(IsFieldNotFilterable(elm)&&IsFieldNotSortable(elm))return false;if(filterTable==elm)return true;filterTable!=null&&OnMouseOutFilter();filterTable=elm;var isTable=filterTable.tagName=="TABLE",curCtx;try{curCtx=eval("ctx"+filterTable.getAttribute("CtxNum"))}catch(e){}if(typeof curCtx=="undefined")return false;var createCtx=new Function("setupFilterMenuContext(ctx"+filterTable.getAttribute("CtxNum")+");");createCtx();if(isTable){filterTable.className="ms-selectedtitle";SetEvent("click",CreateFilterMenu,filterTable);SetEvent("contextmenu",CreateFilterMenu,filterTable);SetEvent("mouseout",OnMouseOutFilter,filterTable)}else{var par=filterTable.parentNode;SetEvent("click",CreateFilterMenu,par);SetEvent("contextmenu",CreateFilterMenu,par);SetEvent("mouseout",OnMouseOutFilter,par);CreateCtxImg(par,OnMouseOutFilter)}if(isTable){var titleParent=filterTable.childNodes[0],titleRow=titleParent.childNodes[0];filterImageCell=titleRow.childNodes[titleRow.childNodes.length-1];var filterArrow=filterImageCell.childNodes[0];filterArrow.src=ctxFilter.imagesPath+"menudark.gif";filterArrow.alt=Strings.STS.L_OpenMenu_Text;filterArrow.style.visibility="visible";if(IsElementRtl(filterTable)){filterImageCell.style.right=null;filterImageCell.style.left="1px"}else{filterImageCell.style.left=null;filterImageCell.style.right="1px"}filterImageCell.className="ms-menuimagecell"}return true}function OnMouseOutFilter(a){if(!IsFilterMenuOn()&&filterTable!=null&&!bMenuLoadInProgress){var c=filterTable.tagName=="TABLE",b=filterTable.parentNode;if(c||b==null){filterTable.className="ms-unselectedtitle";filterTable.onclick=null;filterTable.oncontextmenu=null;filterTable.onmouseout=null}else{if(a==null)a=window.event;if(a!=null){var d=typeof a.toElement!="undefined"&&a.toElement!=null?a.toElement:a.relatedTarget;if(b!=null&&d!=null&&IsContained(d,b))return}b.onclick=null;b.oncontextmenu=null;b.onmouseout=null;RemoveCtxImg(b)}if(c&&filterImageCell!=null&&filterImageCell.childNodes.length>0){filterImageCell.childNodes[0].style.visibility="hidden";filterImageCell.className=""}resetFilterMenuState()}}function _OnFocusFilter(a){if(window.location.href.search(new RegExp("[\\?&]Filter=1"))!=-1)return false;if(!IsFilterMenuEnabled(a))return false;a.onfocusout=OnMouseOutFilter;a.onkeydown=PopFilterMenu;var b=a.getAttribute("FilterString");if(b!=null)filterStr=b;var c=FindSTSMenuTable(a,"CTXNum");if(c==null)return false;OnMouseOverFilter(c);return false}function PopFilterMenu(a){var b;if(a==null)a=window.event;if(browseris.nav6up)b=a.which;else b=a.keyCode;if(!IsFilterMenuOn()&&(a.shiftKey&&b==13||a.altKey&&b==40)){var c=Boolean(a.srcElement)?a.srcElement:a.target;if(!IsFilterMenuEnabled(c))return true;var d=FindSTSMenuTable(c,"CTXNum");if(d==null)return false;OnMouseOverFilterDeferCall(d);CreateFilterMenu(a);return false}else return true}function CreateFilterMenu(b){if(filterTable==null||filterTable.tagName=="TABLE"&&filterImageCell==null)return true;var a=filterTable.tagName=="DIV"?filterTable.parentNode:filterTable,c=FindCtxImg(a);c!=null&&c.shown==false&&ShowCtxImg(c,true,a);if(b==null)b=window.event;bIsFilterMenuShown=true;window.origBodyOnClickHandler=document.body.onclick;window.document.body.onclick=null;currentFilterMenu=CMenu("filter_menu");loadingFilterMenu=CMenu("filter_menu_loading");currentFilterMenu.setAttribute("CompactMode","true");addSortMenuItems(currentFilterMenu,loadingFilterMenu);if(filterStr==null)addFilterMenuItems(currentFilterMenu,loadingFilterMenu);else addAdHocFilterMenuItems(currentFilterMenu,loadingFilterMenu);if(HasCssClass(a,"ms-headerCellStylePressed")||HasCssClass(a,"ms-headerCellStyleHover")){RemoveCssClassFromElement(a,"ms-headerCellStylePressed");RemoveCssClassFromElement(a,"ms-headerCellStyleHover");AddCssClassToElement(a,"ms-headerCellStyleMenuOpen")}b!=null&&b.stopPropagation!=null&&b.stopPropagation();return false}function GetUrlWithNoSortParameters(e){var a=ajaxNavigate.get_href(),h=new URI(a,{disableEncodingDecodingForLegacyCode:true});h.setFragment("");a=h.getString();var b,f=0,d,g;do{d=e.indexOf("=",f);if(d==-1)return a;b=e.substring(f,d);if(b!="")a=RemoveQueryParameterFromUrl(a,b);if(typeof b=="string"&&b.length>"FilterField".length&&b.substring(0,"FilterField".length)=="FilterField"){var c=b.substring("FilterField".length);a=RemoveQueryParameterFromUrl(a,"FilterValue"+c);a=RemoveQueryParameterFromUrl(a,"FilterLookupId"+c);a=RemoveQueryParameterFromUrl(a,"FilterOp"+c);a=RemoveQueryParameterFromUrl(a,"FilterData"+c)}g=e.indexOf("&",d+1);if(g==-1)return a;f=g+1}while(b!="");return a}function IsFieldNotSortable(a){return a.getAttribute("Sortable")=="FALSE"||a.getAttribute("SortDisable")=="TRUE"||a.getAttribute("FieldType")=="MultiChoice"?true:false}function addSortMenuItems(b,a){if(IsFieldNotSortable(filterTable)){CAMOptFilter(b,a,Strings.STS.L_NotSortable_Text,"","",false,"fmi_ns");CAMSep(b);CAMSep(a);return}var e="",f="",d="",g=GetThemedLocalizedImageUrl("SortUpGlyph.png"),h=GetThemedLocalizedImageUrl("SortDownGlyph.png");if(filterStr==null){var c=ctxFilter.queryString;if(null==c||c=="")c=filterTable.getAttribute("SortFields");else{var z=GetUrlKeyValue("SortField",true,c),w=filterTable.getAttribute("SortFields"),v=GetUrlKeyValue("SortField",true,w);if(z!=v){c=SetUrlKeyValue("SortField",v,false,c);c=SetUrlKeyValue("SortDir",GetUrlKeyValue("SortDir",true,w),false,c)}}var l=new URI(c,{disableEncodingDecodingForLegacyCode:true});if(l.getQuery().length>0)c=l.getQuery();var r=c.indexOf("&SortDir");if(r==-1){CAMOptFilter(b,a,Strings.STS.L_NotSortable_Text,"","",false,"fmi_ns");CAMSep(b);CAMSep(a);return}var q=c.indexOf("&",r+1),t=GetUrlWithNoSortParameters(c);t=RemovePagingArgs(t);l=new URI(t,{disableEncodingDecodingForLegacyCode:true});var k="?"+l.getQuery();if(k.length>1)k+="&";var C=k;if(q<0)q=c.length;k+=c.substr(0,r)+"&SortDir=Asc"+c.substr(q);l.setQuery(k);e="HandleFilter(event, '"+STSScriptEncode(l.getString())+"', 1);";k=C;k+=c.substr(0,r)+"&SortDir=Desc"+c.substr(q);l.setQuery(k);f="HandleFilter(event, '"+STSScriptEncode(l.getString())+"', 1);";if(e.indexOf("?")>=0)e.substr(e.indexOf("?")+1).indexOf("?")>=0;d=filterTable.getAttribute("FieldType");strFieldName=filterTable.getAttribute("Name")}else{var s=" ",j=filterStr.lastIndexOf(s);d=filterStr.substring(j+1);if(d.substring(0,2)=="x:")d=d.substring(2);var o=filterStr.substring(0,j);j=o.lastIndexOf(s);strFieldName=o.substring(j+1);if(strFieldName.substring(0,1)=="@")strFieldName=strFieldName.substring(1);o=filterStr.substring(0,j);j=o.lastIndexOf(s);if(j>0)strFieldName=o.substring(0,j);var B=filterTable.tagName=="TABLE",i=null;if(B){var y=filterTable.childNodes[0],A=y.childNodes[0],x=A.childNodes[0];i=x.childNodes[0];if(i.tagName=="TABLE"){var n=i.childNodes[0];n=n.childNodes[0];n=n.childNodes[1];i=n.childNodes[0]}}else i=filterTable.firstChild;if(i.tagName=="DIV")i=i.childNodes[0];var m=i.href;m=m.replace(/%20/g," ");if(m.indexOf("'ascending'")>0){e=m.replace("'ascending'","ascending");f=m.replace("'ascending'","descending")}else{f=m.replace("'descending'","descending");e=m.replace("'descending'","ascending")}}d=d.toLowerCase();if(d=="dateTime"){CAMOptFilter(b,a,Strings.STS.L_OldestOnTop_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_NewestOnTop_Text,f,h,true,"fmi_desc")}else if(d=="integer"||d=="number"||d=="currency"){CAMOptFilter(b,a,Strings.STS.L_SmallestOnTop_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_LargestOnTop_Text,f,h,true,"fmi_desc")}else if(d=="text"||d=="user"||d=="string"){CAMOptFilter(b,a,Strings.STS.L_AOnTop_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_ZOnTop_Text,f,h,true,"fmi_desc")}else if(d=="calculated"){var p=filterTable.getAttribute("ResultType");if(p=="Number"||p=="Currency"){CAMOptFilter(b,a,Strings.STS.L_SmallestOnTop_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_LargestOnTop_Text,f,h,true,"fmi_desc")}else if(p=="dateTime"){CAMOptFilter(b,a,Strings.STS.L_OldestOnTop_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_NewestOnTop_Text,f,h,true,"fmi_desc")}else if(p=="boolean"){CAMOptFilter(b,a,Strings.STS.L_Ascending_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_Descending_Text,f,h,true,"fmi_desc")}else{CAMOptFilter(b,a,Strings.STS.L_AOnTop_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_ZOnTop_Text,f,h,true,"fmi_desc")}}else if(d=="attachments"){CAMOptFilter(b,a,Strings.STS.L_BlanksOnTop_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_AttachmentsOnTop_Text,f,h,true,"fmi_desc")}else if(d=="lookup"){var u=filterTable.getAttribute("Name");if(u=="Last_x0020_Modified"||u=="Created_x0020_Date"){CAMOptFilter(b,a,Strings.STS.L_OldestOnTop_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_NewestOnTop_Text,f,h,true,"fmi_desc")}else{CAMOptFilter(b,a,Strings.STS.L_Ascending_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_Descending_Text,f,h,true,"fmi_desc")}}else{CAMOptFilter(b,a,Strings.STS.L_Ascending_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_Descending_Text,f,h,true,"fmi_desc")}CAMSep(b);CAMSep(a)}function CAMOptFilter(h,g,d,f,c,b,e){var a;a=CAMOpt(h,d,f,c);a.id=e;if(!b){a.setAttribute("enabled","false");a.disabled=true}a=CAMOpt(g,d,f,c);a.id=e+"_p";if(!b){a.setAttribute("enabled","false");a.disabled=true}}function ShowFilterLoadingMenu(){a:;!bIsFilterDataLoaded&&filterTable!=null&&FilterOMenu(loadingFilterMenu,filterTable)}function IsFieldNotFilterable(a){return a.getAttribute("Filterable")=="FALSE"||a.getAttribute("FilterDisable")=="TRUE"||a.getAttribute("FieldType ")=="Note"||a.getAttribute("FieldType ")=="URL"?true:false}function addFilteringDisabledMenuItem(a){FilterOMenu(a,filterTable);a._onDestroy=OnMouseOutFilter}function addFilterMenuItems(n,k){if(IsFieldNotFilterable(filterTable)){addFilteringDisabledMenuItem(n);return}var e=document.getElementById("FilterIframe"+filterTable.getAttribute("CtxNum"));if(e==null)return;var c=ctxFilter.queryString;if(null==c||c=="")c=e.getAttribute("FilterLink");(c==null||c=="")&&window.alert("Unexpected");if(c=="?"){var r=ajaxNavigate.getParam("InplviewHash"+ctxFilter.view);if(Boolean(r))c+=DecodeHashAsQueryString(r)}var h=escapeProperly(filterTable.getAttribute("Name"));strFilteredValue=null;var a="",d=0,b,f;do{d++;var s=false;b=c.match(new RegExp("FilterField"+String(d)+"=[^&#]*"));if(!Boolean(b))b=c.match(new RegExp("FilterFields"+String(d)+"=[^&#]*"));f=c.match(new RegExp("&FilterValue"+String(d)+"=[^&#]*"));if(!Boolean(f)){f=c.match(new RegExp("&FilterValues"+String(d)+"=[^&#]*"));s=true}if(b!=null&&f!=null){if(strFilteredValue==null){strFilteredValue=getFilterValueFromUrl(b.toString()+f.toString(),h);bIsMultiFilter=s}a=a+"&"+b.toString()+f.toString();var q=c.match(new RegExp("&FilterOp"+String(d)+"=[^&#]*"));if(q!=null)a=a+q.toString();var i=c.match(new RegExp("&FilterLookupId"+String(d)+"=[^&#]*"));if(i!=null)a=a+i.toString();var m=c.match(new RegExp("&FilterData"+String(d)+"=[^&#]*"));if(m!=null)a=a+m.toString();if(i!=null&&m==null&&strFilteredValue!=null){addFilteringDisabledMenuItem(n);return}}}while(null!=b);var p=strFilteredValue!=null,t=StBuildParam(Strings.STS.L_DontFilterBy_Text,filterTable.getAttribute("DisplayName")),u="javascript:HandleFilter(event, '"+STSScriptEncode(FilterFieldV3(ctxFilter.view,h,"",0,ctxFilter.queryString,true))+"')",l;if(p)l=GetThemedImageUrl("DeleteFilterGlyph.png");else l=GetThemedImageUrl("DisabledDeleteFilterGlyph.png");CAMOptFilter(n,k,t,u,l,p,"fmi_clr");var v=CAMOpt(k,Strings.STS.L_Loading_Text,"");v.setAttribute("enabled","false");setTimeout("ShowFilterLoadingMenu()",500);k._onDestroy=OnMouseOutFilter;b=c.match(new RegExp("MembershipGroupId=[^&]*"));if(b!=null)a=a+"&"+b.toString();b=c.match(new RegExp("InstanceID=[^&]*"));if(b!=null)a=a+"&"+b.toString();if(a!=null&&a.length>0){if(ctxFilter.overrideFilterQstring!=null&&ctxFilter.overrideFilterQstring.length>0)a="&"+ReconcileQstringFilters(a.substring(1),ctxFilter.overrideFilterQstring)}else if(ctxFilter.overrideFilterQstring!=null&&ctxFilter.overrideFilterQstring.length>0)a="&"+ctxFilter.overrideFilterQstring;var j="",g;if(ctxFilter!=null&&(g=ctxFilter.clvp)!=null&&g.rootFolder!=null&&g.rootFolder.length>0)j="&RootFolder="+escapeProperlyCore(g.rootFolder,true);else{b=c.match(new RegExp("RootFolder=[^&]*"));if(b!=null)j="&"+b.toString()}var o="";b=a.match(new RegExp("OverrideScope=[^&]*"));if(ctxFilter!=null&&typeof ctxFilter.overrideScope!="undefined"&&b==null)o="&OverrideScope="+escapeProperlyCore(ctxFilter.overrideScope,false);if(browseris.safari){e.src="/_layouts/15/blank.htm";e.style.offsetLeft="-550px";e.style.offsetTop="-550px";e.style.border="0px";e.style.display="block"}e.src=ctxFilter.HttpRoot+"/_layouts/15/filter.aspx?ListId="+ctxFilter.listName+j+o+"&FieldInternalName="+h+"&ViewId="+ctxFilter.view+"&FilterOnly=1&Filter=1"+a;bMenuLoadInProgress=true}function getFilterValueFromUrl(b,f){var a,c,e;a=b.indexOf("=");if(a==-1)return null;c=b.indexOf("&");if(c==-1)return null;if(c<a)return null;b=CanonicalizeUrlEncodingCase(b);e=b.substring(a+1,c);if(e==f){var d;a=b.indexOf("=",c+1);if(a==-1)return null;d=b.substr(a+1);d=unescapeProperly(d);return d}return null}function _OnIframeLoad(){a:;bMenuLoadInProgress=false;if(filterTable!=null&&filterTable.getAttribute("Name")!=null){var b=null;b=document.getElementById("FilterIframe"+filterTable.getAttribute("CtxNum"));if(b!=null){var a=null,e=filterTable.getAttribute("Name");if(typeof b.contentDocument!="undefined")a=b.contentDocument;if(a==null&&null!=b.contentWindow)a=b.contentWindow.document;if(a==null)a=b.ownerDocument;if(a!=null){var h=a.getElementById("diidFilterCustomTable");if(h!=null&&(typeof b.contentWindow!="undefined"&&null!=b.contentWindow&&typeof b.contentWindow.CustomPopulateFilterMenu!="undefined"&&null!=b.contentWindow.CustomPopulateFilterMenu||typeof a.defaultView!="undefined"&&null!=a.defaultView&&typeof a.defaultView.CustomPopulateFilterMenu!="undefined"&&null!=a.defaultView.CustomPopulateFilterMenu))if(null!=b.contentWindow)b.contentWindow.CustomPopulateFilterMenu(currentFilterMenu,h,"FilterIframe"+filterTable.getAttribute("CtxNum"),ctxFilter.view,e);else a.defaultView.CustomPopulateFilterMenu(currentFilterMenu,h,"FilterIframe"+filterTable.getAttribute("CtxNum"),ctxFilter.view,e);else{var i=a.getElementById("diidFilter"+e);e=escapeProperly(e);if(i!=null){var k=i.childNodes.length;if(k>500)addFilterOptionMenuItem();else for(var d=i.childNodes,c=1;c<k;c++){var g;if(d[c].innerText)g=d[c].innerText;else if(d[c].textContent)g=d[c].textContent;else g=d[c].innerHTML;var m="javascript:HandleFilter(event, '"+STSScriptEncode(FilterFieldV3(ctxFilter.view,e,d[c].value,c,ctxFilter.queryString,true))+"')",j=CAMOpt(currentFilterMenu,g,m);ctxFilter.IsClientRendering&&j.setAttribute("checked","false");if(strFilteredValue!=null){var f=[];if(bIsMultiFilter)f=ParseMultiColumnValue(strFilteredValue,";#",true);else f.push(strFilteredValue);for(var l in f)f[l]!=null&&f[l]==d[c].value&&j.setAttribute("checked","true")}}}else{alert(Strings.STS.L_FilterThrottled_Text);return}}bIsFilterDataLoaded=true;if(loadingFilterMenu!=null)loadingFilterMenu._onDestroy=null;if(currentFilterMenu!=null){currentFilterMenu._onDestroy=OnMouseOutFilter;FilterOMenu(currentFilterMenu,filterTable)}}}}}function addFilterOptionMenuItem(){a:;var a=ajaxNavigate.get_href();a=StURLSetVar2(a,"Filter","1");a=StURLSetVar2(a,"View",ctxFilter.view);a="javascript:SubmitFormPost('"+a+"')";CAMOpt(currentFilterMenu,Strings.STS.L_FilterMode_Text,a)}function OnMouseOverAdHocFilterDeferCall(g,f){filterStr=f;if(IsFilterMenuOn())return false;filterTable!=null&&OnMouseOutFilter();filterTable=g;var d=filterTable.tagName=="TABLE";if(d){filterTable.className="ms-selectedtitle";SetEvent("click",CreateFilterMenu,filterTable);SetEvent("contextmenu",CreateFilterMenu,filterTable);SetEvent("mouseout",OnMouseOutFilter,filterTable)}else{var a=filterTable.parentNode;SetEvent("click",CreateFilterMenu,a);SetEvent("contextmenu",CreateFilterMenu,a);SetEvent("mouseout",OnMouseOutFilter,a);CreateCtxImg(a,OnMouseOutFilter)}if(d){var e=filterTable.childNodes[0],c=e.childNodes[0];filterImageCell=c.childNodes[c.childNodes.length-1];var b=filterImageCell.childNodes[0];b.src="/_layouts/15/images/menudark.gif?rev=23";b.alt=Strings.STS.L_OpenMenu_Text;b.style.visibility="visible";if(IsElementRtl(filterTable)){filterImageCell.style.right=null;filterImageCell.style.left="1px"}else{filterImageCell.style.left=null;filterImageCell.style.right="1px"}filterImageCell.className="ms-menuimagecell"}return true}function addAdHocFilterMenuItems(b,a){if(IsFieldNotFilterable(filterTable)){addFilteringDisabledMenuItem(b);return}var c=CAMOpt(a,Strings.STS.L_Loading_Text,"");c.setAttribute("enabled","false");FilterOMenu(a,filterTable);a._onDestroy=OnMouseOutFilter;typeof DoCallBack=="function"&&DoCallBack("__filter={"+filterStr+"}");filterStr=null}function UpdateFilterCallback(b){var j="</OPTION>",a=-1;a=b.indexOf(j,a+1);var d=b.lastIndexOf(">",a),l=StBuildParam(Strings.STS.L_DontFilterBy_Text,strFieldName),i,e="",c,f;if(d<a-1){c=b.lastIndexOf('"',a);if(c>0){f=b.lastIndexOf('"',c-1);if(f>0)e=b.substring(f+1,c)}}if(d==a-1)i=GetThemedImageUrl("DisabledDeleteFilterGlyph.png");else i=GetThemedImageUrl("DeleteFilterGlyph.png");var g;if(a>0){g=CAMOpt(currentFilterMenu,l,e,i);g.setAttribute("enabled",d==a-1?"false":"true");c=a;var m='<OPTION href="';a=b.indexOf(j,a+8);while(a>0){d=b.indexOf(m,c+8);d=b.indexOf('"',d+20);if(d>0&&d<a){var k=b.indexOf(">",d),h=b.substring(k+1,a);e="";c=b.lastIndexOf('"',d);if(c>0){f=b.lastIndexOf('"',c-1);if(f>0){e=b.substring(f+1,c);e=e.replace(/&amp;/g,"&")}}if(h.length>40)h=h.substring(0,40)+"...";if(h.length>0){g=CAMOpt(currentFilterMenu,h,e);k>d+1&&g.setAttribute("checked","true")}}c=a;a=b.indexOf(j,a+8)}}else{g=CAMOpt(currentFilterMenu,Strings.STS.L_OpenMenu_Text,Strings.STS.L_NotFilterable_Text,"");g.setAttribute("enabled","false");FilterOMenu(currentFilterMenu,filterTable);return}loadingFilterMenu._onDestroy=null;FilterOMenu(currentFilterMenu,filterTable);currentFilterMenu._onDestroy=OnMouseOutFilter}function FilterOMenu(c,a){if(a==null)return;var b=a.tagName=="DIV"?a.parentNode:a;OMenu(c,b,null,null,-1)}function _OnClickFilter(d,b){if(!IsFilterMenuEnabled(d)){alert(Strings.STS.L_SortNotAllowed);return false}if(FV4UI()){if(browseris.ie){b.cancelBubble=true;b.returnValue=false}else b.stopPropagation();var c;try{c=typeof inplview.OnClickFilterV4}catch(b){c="undefined"}var i="inplview.OnClickFilterV4",g=i.split(".");if(g.length>1){var h=function(){a:;inplview.OnClickFilterV4(d)};EnsureScript(g[0],c,h)}return false}var e=FindSTSMenuTable(d,"CTXNum");if(e!=null&&e.getAttribute("SortFields")!=null){var f=e.getAttribute("SortFields"),a=GetUrlWithNoSortParameters(f);a=RemovePagingArgs(a);if(a.indexOf("?")<0)a+="?";else a+="&";SubmitFormPost(a+f)}if(!bIsFileDialogView)b.cancelBubble=true;return false}var _spBodyOnLoadFunctionNames,_spBodyOnLoadFunctions,_spBodyOnLoadCalled,_spOriginalFormAction,_spEscapedFormAction,_spFormOnSubmitCalled,_spBodyOnPageShowRegistered;function _spBodyOnPageShow(){a:;_spFormOnSubmitCalled=false}function _spResetFormOnSubmitCalledFlag(){a:;_spFormOnSubmitCalled=false}function _ribbonReadyForInit(){a:;return _spBodyOnLoadCalled}function _spBodyOnLoadWrapperInit(){a:;ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))==null&&FixRibbonAndWorkspaceDimensions()}function _spBodyOnLoadWrapper(){a:;if(_spBodyOnLoadCalled)return;_spBodyOnLoadCalled=true;_spBodyOnLoadWrapperInit();if(!_spBodyOnPageShowRegistered&&typeof browseris!="undefined"&&!browseris.ie&&typeof window.addEventListener=="function"){window.addEventListener("pageshow",_spBodyOnPageShow,false);_spBodyOnPageShowRegistered=true}if(typeof Sys!="undefined"&&typeof Sys.WebForms!="undefined"&&typeof Sys.WebForms.PageRequestManager!="undefined"){var a=Sys.WebForms.PageRequestManager.getInstance();if(!_spPageLoadedRegistered&&a!=null){a.add_pageLoaded(_spPageLoaded);_spPageLoadedRegistered=true}}!_spPageLoadedRegistered&&_spPageLoaded();_spFormOnSubmitCalled=false;typeof Sys!="undefined"&&typeof Sys.Net!="undefined"&&typeof Sys.Net.WebRequestManager!="undefined"&&Sys.Net.WebRequestManager.add_invokingRequest(_spResetFormOnSubmitCalledFlag);typeof NotifyBodyLoadedAndExecuteWaitingJobs!="undefined"&&NotifyBodyLoadedAndExecuteWaitingJobs();ExecuteOrDelayUntilScriptLoaded(ProcessDefaultOnLoad,"core.js");if(typeof g_prefetch=="undefined"||g_prefetch==1){var c=new URI(window.location.href,{queryCaseInsensitive:true}),b=c.getQueryParameter("prefetch");b!=String(0)&&_spPreFetch()}}var g_numberOfYields;function _spDelayAfterAllScripts(a){_spYield(a,g_numberOfYields)}function _spYield(b,a){if(a>0)window.setTimeout(function(){a:;_spYield(b,a-1)},0);else b()}function _spTrace(){}var g_spPreFetchKeys;function _spPreFetch(){a:;_spDelayAfterAllScripts(function(){a:;var b;if(Boolean(_v_dictSod)){_spTrace("-----Starting prefetch-----");g_spPreFetchKeys.push("strings.js");g_spPreFetchKeys.push("core.js");typeof ribbon=="undefined"&&typeof _ribbon!="undefined"&&g_spPreFetchKeys.push("ribbon");for(var a=0;a<g_spPreFetchKeys.length;a++){var c=g_spPreFetchKeys[a];b=_v_dictSod[c];Boolean(b)&&LoadSod(b)}}});typeof _ribbon!="undefined"&&Boolean(_ribbon)&&SP.SOD.get_ribbonImagePrefetchEnabled()&&window.setTimeout(function(){a:;if(Boolean(document.images)&&typeof _spPageContextInfo!="undefined"&&typeof _spPageContextInfo.currentLanguage!="undefined"){window.imgRibbon32x32=new Image;var a="/_layouts/15/"+String(_spPageContextInfo.currentLanguage)+"/images/formatmap32x32.png";window.imgRibbon32x32.src=GetImageUrlWithRevision(a);window.imgRibbon16x16=new Image;a="/_layouts/15/"+String(_spPageContextInfo.currentLanguage)+"/images/formatmap16x16.png";window.imgRibbon16x16.src=GetImageUrlWithRevision(a)}},0)}var _spSuppressFormOnSubmitWrapper;function _spFormOnSubmitWrapper(){a:;if(_spSuppressFormOnSubmitWrapper)return true;if(_spFormOnSubmitCalled)return false;if(typeof _spFormOnSubmit=="function"){var b=_spFormOnSubmit(),a=false;if(typeof b==typeof a&&b==a)return false}if(typeof _startOnSubmitStatement=="function")return _startOnSubmitStatement();_spFormOnSubmitCalled=true;return true}var _inlineEditString,_spPageLoadedRegistered;function _spPageLoaded(){a:;_spOriginalFormAction=null;EscapeFormAction();RefreshInplViewState();RefreshHeroButtonState();InlineEditSetDefaultFocus()}function InlineEditSetDefaultFocus(){a:;if(_inlineEditString!=null){var c=_inlineEditString.indexOf("#");if(c<=0)return;for(var i=_inlineEditString.substring(0,c),d=document.getElementsByTagName("TR"),b=0;b<d.length;b++)if(d[b].getAttribute("automode")==i){for(var h=_inlineEditString.substring(c+1),f=h.split(","),a=d[b],e=0;e<f.length;e++){if(a==null)break;a=a.firstChild;for(var g=0;g<f[e];g++){if(a==null)break;a=a.nextSibling}}a!=null&&focusControl(a);break}_inlineEditString=null}}function focusControl(b){a:;if(Sys.Browser.agent===Sys.Browser.InternetExplorer){var c,a=b;if(Boolean(a)&&typeof a.contentEditable!=="undefined"){c=a.contentEditable;a.contentEditable=false}else a=null;try{b.focus()}catch(d){}if(Boolean(a))a.contentEditable=c}else b.focus()}function EscapeFormAction(){a:;if(document.forms.length>0&&!Boolean(_spOriginalFormAction)){_spOriginalFormAction=document.forms[0].action;var a=ajaxNavigate.get_href(),b=a.indexOf("://");if(b>=0){var c=a.substring(b+3);b=c.indexOf("/");if(b>=0)a=c.substring(b);if(a.length>2&&a.charAt(0)=="/"&&a.charAt(1)=="/")a=a.substring(1)}_spEscapedFormAction=escapeUrlForCallback(a);document.forms[0].action=_spEscapedFormAction;document.forms[0]._initialAction=document.forms[0].action}}function RefreshHeroButtonState(){a:;if(typeof _spWebPartComponents!="undefined")for(var d in _spWebPartComponents)if(d.length>7){var b=d.substr(7),a=window["heroButtonWebPart"+b];if(typeof a!="undefined"&&a!=null&&a==true){var c=document.getElementById("Hero-"+b);if(c!=null)c.style.display=""}}}function RefreshInplViewState(){a:;if(typeof window.ctx=="undefined")return;var a=window.ctx;if(a.clvp==null){EnsureScript("inplview",typeof InitAllClvps,function(){a:;a.clvp==null&&InitAllClvps()});return}var c=a.clvp,b=c.tab;if(b==null||b!=null&&(b.parentNode==null||b.parentNode.innerHTML==null)){FixDroppedOrPastedClvps();if(a.dictSel!=null){a.dictSel=[];a.CurrentSelectedItems=0}}}function RestoreToOriginalFormAction(){a:;if(_spOriginalFormAction!=null){if(_spEscapedFormAction==document.forms[0].action){document.forms[0].action=_spOriginalFormAction;document.forms[0]._initialAction=document.forms[0].action}_spOriginalFormAction=null;_spEscapedFormAction=null}}function DefaultFocus(){a:;if(typeof _spUseDefaultFocus!="undefined"){var a=document.getElementsByName("_spFocusHere"),c=null;if(a==null||a.length<=0)c=document.getElementById("_spFocusHere");else if(a!=null&&a.length>0)c=a[0];if(c!=null){var b=c.getElementsByTagName("a");if(b!=null&&b.length>0)for(var d=0;d<b.length;d++)if(b[d].style.visibility!="hidden"){try{b[d].focus()}catch(e){}break}}}}var g_fAnimateListCSR;function ProcessDefaultOnLoad(){a:;ProcessPNGImages();UpdateAccessibilityUI();UpdateAnimationUserControl(false);window.setTimeout("ProcessImn()",10);ProcessOnLoadFunctionNames(_spBodyOnLoadFunctionNames);ProcessOnLoadFunctions(_spBodyOnLoadFunctions);typeof _spUseDefaultFocus!="undefined"&&DefaultFocus();if(ajaxNavigate.get_hash().indexOf("InplviewHash")!=-1){var a;try{a=typeof inplview.RestoreAllClvpsNavigation}catch(e){a="undefined"}var d="inplview.RestoreAllClvpsNavigation",b=d.split(".");if(b.length>1){var c=function(){a:;inplview.RestoreAllClvpsNavigation()};EnsureScript(b[0],a,c)}}}function ProcessOnLoadFunctionNames(onLoadFunctionNames){a:;for(var i=0;i<onLoadFunctionNames.length;i++){var expr="if(typeof("+onLoadFunctionNames[i]+")=='function'){"+onLoadFunctionNames[i]+"();}";eval(expr)}onLoadFunctionNames=[]}function ProcessOnLoadFunctions(a){a:;for(var b=0;b<a.length;b++)a[b]();a=[]}function CoreInvoke(a){a:;var c=Array.prototype.slice.call(arguments,1),b=function(){a:;var b=window[a];b.apply(null,c)};EnsureScript("core.js",TypeofFullName(a),b);return false}function _bodyOnHashChangeHandler(){a:;typeof _spBodyOnHashChange!="undefined"&&_spBodyOnHashChange()}$_global_ows();