function $_global_followingcommon(){(function(){window.SetFollowStatus=function(g,f,e,d,a){SP.SOD.executeFunc("userprofile","SP.UserProfiles.ProfileLoader",function(){var i=SP.ClientContext.get_current(),j=SP.UserProfiles.ProfileLoader.getProfileLoader(i).getUserProfile(),k=j.get_followedContent(),h;if(f){IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfSPFollowContentBegin);h=k.follow(g,null)}else{IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfSPStopFollowContentBegin);k.stopFollowing(g)}i.executeQueryAsync(function(){if(f)if(m$.isDefinedAndNotNull(h)){var i=h.get_resultType();if(i===SP.UserProfiles.FollowResultType.followed||i===SP.UserProfiles.FollowResultType.refollowed){var o=h.get_item(),g=o.get_iconUrl(),j=o.get_title();if(e===true){if(g===null)g=SP.Utilities.Utility.getImageUrl("lg_icgen.gif");if(i===SP.UserProfiles.FollowResultType.followed)addDocumentFollowNotification(j,"",g);else addAlreadyFollowingDocumentNotification(j,"",g);IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfSPFollowDocEnd)}else{if(g==null)g="/_layouts/15/images/siteicon.png?rev=23";if(i==SP.UserProfiles.FollowResultType.followed)addSiteFollowNotification(j,"",g,null,function(){NavigateToFollowedList(true)});else addAlreadyFollowingSiteNotification(j,"",g,null,function(){NavigateToFollowedList(true)});IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfSPFollowSiteEnd)}m$.isDefinedAndNotNull(d)&&d()}else if(i===SP.UserProfiles.FollowResultType.hitFollowLimit){var m,l,k,n=null;if(e){m=Strings.STS.L_DocumentsFollowLimitReachedDialog_Text;l=Strings.STS.L_FollowLimitReachedDialog_Title;k=Strings.STS.L_DocumentsFollowLimitReachedDialog_Button;n=function(){NavigateToFollowedList()}}else{m=Strings.STS.L_SitesFollowLimitReachedDialog_Text;l=Strings.STS.L_FollowLimitReachedDialog_Title;k=Strings.STS.L_SitesFollowLimitReachedDialog_Button;n=function(){NavigateToFollowedList(true)}}b(m,l,k,n);m$.isDefinedAndNotNull(a)&&a()}else{c(e,Strings.STS.L_FollowingException_FollowFailed);m$.isDefinedAndNotNull(a)&&a()}}else m$.isDefinedAndNotNull(a)&&a();else{IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfSPStopFollowContentEnd);m$.isDefinedAndNotNull(d)&&d()}},function(m,h){var g=h.get_errorCode(),f,d="";if(g==SP.UserProfiles.SocialDataStoreExceptionCode.cannotCreatePersonalSite||g==SP.UserProfiles.SocialDataStoreExceptionCode.noSocialFeatures){f=Strings.STS.L_FollowingCannotCreatePersonalSiteError_Text;d=Strings.STS.L_FollowingCannotCreatePersonalSiteError_Title;SP.SOD.executeFunc("SP.UI.MySiteCommon.js","SP.UI.MySiteCommon.MySiteDialog",function(){var a=new SP.UI.MySiteCommon.MySiteDialog(d,f);a.set_hideOkButton(true);a.set_cancelButtonText(Strings.STS.L_CloseButtonCaption);a.show()})}else if(g==SP.UserProfiles.SocialDataStoreExceptionCode.personalSiteNotFound){f=Strings.STS.L_FollowingPersonalSiteNotFoundError_Text;d=Strings.STS.L_FollowingPersonalSiteNotFoundError_Title;var k=Strings.STS.L_FollowingPersonalSiteNotFoundError_ButtonText;b(f,d,k,function(){i.load(j,"UrlToCreatePersonalSite");i.executeQueryAsync(function(){window.location.href=j.get_urlToCreatePersonalSite()})})}else{var l=h.get_message();c(e,l)}m$.isDefinedAndNotNull(a)&&a()})})};var c=function(d,c){var a=Strings.STS.L_FollowingGenericError_Title,b=d?Strings.STS.L_FollowingGenericError_Document_Text:Strings.STS.L_FollowingGenericError_Site_Text;SP.SOD.executeFunc("SP.UI.MySiteCommon.js","SP.UI.MySiteCommon.MySiteDialog",function(){var d=new SP.UI.MySiteCommon.MySiteDialog(a,b);d.set_errorMessage(c);d.set_okButtonText(Strings.STS.L_CloseButtonCaption);d.set_hideCancelButton(true);d.show()})},b=function(c,b,a,d){SP.SOD.executeFunc("SP.UI.MySiteCommon.js","SP.UI.MySiteCommon.MySiteDialog",function(){var e=new SP.UI.MySiteCommon.MySiteDialog(b,c);e.set_okButtonText(a);e.set_okButtonCallback(d);e.show()})},d=function(a,c,b){SP.SOD.executeFunc("SP.UI.MySiteCommon.js","SP.UI.MySiteCommon.MySiteDialog",function(){var e=String.format(Strings.STS.L_DialogFollowAction_Title,a),f=c,d=new SP.UI.MySiteCommon.MySiteDialog(e,f);d.set_okButtonText(Strings.STS.L_DialogFollowButton_Text);d.set_okButtonCallback(b);d.show()})};window.FollowSiteFromEmail=function(a){d(a,Strings.STS.L_DialogFollowSiteAction_Content,function(){FollowSite()})};window.FollowDocumentFromEmail=function(b,c,a){d(a,Strings.STS.L_DialogFollowDocAction_Content,function(){FollowDoc(c,b)})};window.FollowSelectedDocument=function(c){var b,a=null;if(m$.isDefinedAndNotNull(c)){var d=c.CurrentItem;if(m$.isUndefinedOrNull(d)||m$.isUndefinedOrNull(d.ID))throw"Error: listItem is missing properties";b=c.listName;a=d.ID}else{var e=SP.ListOperation.Selection.getSelectedItems();if(e.length==1){b=SP.ListOperation.Selection.getSelectedList();a=e[0].id}}m$.isDefinedAndNotNull(b)&&m$.isDefinedAndNotNull(a)&&FollowDoc(b,a)};window.FollowDoc=function(d,c){var a=SP.ClientContext.get_current(),e=a.get_url(),b=window.location.protocol+"//"+window.location.host+e+"?listId="+d+"&itemId="+c;SetFollowStatus(b,true,true)};window.FollowSite=function(){var b=SP.ClientContext.get_current(),a=b.get_url();a=window.location.protocol+"//"+window.location.host+a;SetFollowStatus(a,true,false)};window.NavigateToFollowedList=function(a){a=Boolean(a);SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){SP.SOD.executeFunc("userprofile","SP.UserProfiles.ProfileLoader",function(){var b=SP.ClientContext.get_current(),d=SP.UserProfiles.ProfileLoader.getProfileLoader(b).getUserProfile(),c=d.get_followedContent();b.load(c,a?"FollowedSitesUrl":"FollowedDocumentsUrl");b.executeQueryAsync(function(){if(a)window.location.href=c.get_followedSitesUrl();else window.location.href=c.get_followedDocumentsUrl()})})})};window.addFollowNotification=function(e,h,f,g,b,c){var d=new SPStatusNotificationData(STSHtmlEncode(h),Strings.STS.L_FollowNotificationText,f,g);return a(e,d,b,c)};window.addPeopleFollowNotification=function(e,h,f,g,b,c){var d=new SPStatusNotificationData(STSHtmlEncode(h),Strings.STS.L_FollowNotificationText_Person,f,g);return a(e,d,b,c)};window.addDocumentFollowNotification=function(e,h,f,g,b,c){var d=new SPStatusNotificationData(STSHtmlEncode(h),Strings.STS.L_FollowNotificationText_Document,f,g);return a(e,d,b,c)};window.addSiteFollowNotification=function(e,h,f,g,b,c){var d=new SPStatusNotificationData(STSHtmlEncode(h),Strings.STS.L_FollowNotificationText_Site,f,g);return a(e,d,b,c)};window.addAlreadyFollowingDocumentNotification=function(e,h,f,g,b,c){var d=new SPStatusNotificationData(STSHtmlEncode(h),Strings.STS.L_AlreadyFollowingNotificationText_Document,f,g);return a(e,d,b,c)};window.addAlreadyFollowingSiteNotification=function(e,h,f,g,b,c){var d=new SPStatusNotificationData(STSHtmlEncode(h),Strings.STS.L_AlreadyFollowingNotificationText_Site,f,g);return a(e,d,b,c)};var a=function(e,f,b,d){var a;if(b!=null)a=b;else a=function(){NavigateToFollowedList()};var c=new SP.UI.Notify.Notification(SPNotifications.ContainerID.Status,STSHtmlEncode(e),false,null,a,f);c.Show(d);return c.id}})();m$.isDefinedAndNotNull(Sys)&&m$.isDefinedAndNotNull(Sys.Application)&&Sys.Application.notifyScriptLoaded();m$.isFunction(NotifyScriptLoadedAndExecuteWaitingJobs)&&NotifyScriptLoadedAndExecuteWaitingJobs("followingcommon.js")}$_global_followingcommon();