function ULS0I9(){var o=new Object;o.ULSTeamName="DLC Server";o.ULSFileName="SP.UI.MyLinksRibbon.js";return o;}
Type.registerNamespace("SP.UI.MyLinksRibbon");SP.UI.MyLinksRibbon.MyLinksCommandNames=function(){};SP.UI.MyLinksRibbon.CallbackCommands=function(){};SP.UI.MyLinksRibbon.MyLinksRibbonPageComponent=function(a){ULS0I9:;SP.UI.MyLinksRibbon.MyLinksRibbonPageComponent.initializeBase(this);SP.UI.MyLinksRibbon.MyLinksRibbonPageComponent.$0=this;this.m_callbackScript=a};SP.UI.MyLinksRibbon.MyLinksRibbonPageComponent.ribbonActionCallback=function(arg,context){ULS0I9:;var $v_0=SP.UI.MyLinksRibbon.MyLinksRibbonPageComponent.$0.initWithPortal(eval("("+arg+")"));if(context==="Manage")SP.UI.MyLinksRibbon.MyLinksRibbonPageComponent.$0.goToManagePage();else{var $v_1=ensurePersonalSiteOrPortal14("");$v_1&&!SP.ScriptUtility.isNullOrEmptyString($v_0)&&SP.UI.Notify.addNotification($v_0,false)}};SP.UI.MyLinksRibbon.MyLinksRibbonPageComponent.prototype={m_callbackScript:null,m_fPortalInited:false,m_portalUrl:null,m_mySiteUrl:null,registerWithPageManager:function(){ULS0I9:;CUI.Page.PageManager.get_instance().addPageComponent(this)},getGlobalCommands:function(){ULS0I9:;return["MyLinksMenu","MyLinksAdd","MyLinksDelete","MyLinksManage"]},$2_1:false,$1_1:false,get_isActivexPresent:function(){ULS0I9:;if(!this.$1_1){this.$2_1=tryLoadPortalConnect14();this.$1_1=true}return this.$2_1},canHandleCommand:function(){ULS0I9:;return this.get_isActivexPresent()},invokeCallback:function(functionName){ULS0I9:;return eval(this.m_callbackScript+"('"+functionName+"', '"+functionName+"');")},handleCommand:function(a){ULS0I9:;if(a==="MyLinksMenu"||a==="MyLinksAdd"){this.invokeCallback("Add");return true}if(a==="MyLinksDelete"){this.invokeCallback("Del");return true}if(a==="MyLinksManage"){this.invokeCallback("Manage");return true}return false},initWithPortal:function(a){ULS0I9:;if(!this.m_fPortalInited){this.m_mySiteUrl=a.MySiteUrl;this.m_portalUrl=a.PortalUrl;myLinksInitSettings(this.m_portalUrl,this.m_mySiteUrl,a.MySiteName)}this.m_fPortalInited=true;return a.Notification},goToManagePage:function(){ULS0I9:;var a=this.m_portalUrl+(this.m_portalUrl.endsWith("/")?"":"/")+SP.Utilities.Utility.get_layoutsLatestVersionRelativeUrl()+"MyQuickLinks.aspx";STSNavigate(a)}};SP.UI.MyLinksRibbon.MyLinksCommandNames.registerClass("SP.UI.MyLinksRibbon.MyLinksCommandNames");SP.UI.MyLinksRibbon.CallbackCommands.registerClass("SP.UI.MyLinksRibbon.CallbackCommands");SP.UI.MyLinksRibbon.MyLinksRibbonPageComponent.registerClass("SP.UI.MyLinksRibbon.MyLinksRibbonPageComponent",CUI.Page.PageComponent);function sp_ui_mylinksribbon_initialize(){ULS0I9:;SP.UI.MyLinksRibbon.MyLinksCommandNames.myLinksMenu="MyLinksMenu";SP.UI.MyLinksRibbon.MyLinksCommandNames.myLinksAdd="MyLinksAdd";SP.UI.MyLinksRibbon.MyLinksCommandNames.myLinksDelete="MyLinksDelete";SP.UI.MyLinksRibbon.MyLinksCommandNames.myLinksManage="MyLinksManage";SP.UI.MyLinksRibbon.CallbackCommands.add="Add";SP.UI.MyLinksRibbon.CallbackCommands.del="Del";SP.UI.MyLinksRibbon.CallbackCommands.manage="Manage";SP.UI.MyLinksRibbon.MyLinksRibbonPageComponent.$0=null}sp_ui_mylinksribbon_initialize();var g_objPortalConnect14,g_mySiteUrl,g_portalUrl,g_mySiteName,mylinks_init;ExecuteAndRegisterBeginEndFunctions("sp.ui.mylinksribbon.js",sp_ui_mylinksribbon_initialize,null,function(){ULS0I9:;g_objPortalConnect14=null;g_mySiteUrl=null;g_portalUrl=null;g_mySiteName=null;mylinks_init={MyLinksInit:MyLinksInitFn}});typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();NotifyScriptLoadedAndExecuteWaitingJobs("sp.ui.mylinksribbon.js");function MyLinksInitFn(b){ULS0I9:;var a=SP.Ribbon.PageManager.get_instance();a.addPageComponent(new SP.UI.MyLinksRibbon.MyLinksRibbonPageComponent(b))}function tryLoadPortalConnect14(){ULS0I9:;if(g_objPortalConnect14==null)try{g_objPortalConnect14=new ActiveXObject("PortalConnect14.PersonalSite.1")}catch(a){return false}return true}function ensurePersonalSiteOrPortal14(){ULS0I9:;if(!tryLoadPortalConnect14())return false;try{return g_objPortalConnect14.EnsurePersonalSiteOrPortal(g_mySiteName,g_mySiteUrl,g_portalUrl)}catch(a){return false}}function myLinksInitSettings(c,b,a){ULS0I9:;g_portalUrl=c;g_mySiteUrl=b;g_mySiteName=a};