function $_global_inplview(){g_SPGridInitInfo={};SPGridInitInfo.prototype={controllerId:undefined,gridSerializer:undefined,jsInitObj:undefined,showLoading:undefined,pagingInfo:undefined,initialized:false,selectedRows:null,fnCallback:null,stale:false,unfilteredHierarchyInfo:null};TranslatedCSRtoJsGridFieldData.prototype={value:undefined,localizedValue:undefined,localizedValueSetExplicitly:undefined};SelectedItem.prototype={id:undefined,fsObjType:undefined};CLVP_InitializePrototype();ajaxNavigate.add_navigate(RestoreAllClvpsNavigation);SPListOperationType={Default:0,Sort:1,PagingRight:2,PagingLeft:3};FocusInfo_InitializePrototype();focusAcc=null;InitAllClvps();inplview={CheckOutSingleItem:CheckOutSingleItem,InitAllClvps:InitAllClvps,HandleFilterReal:HandleFilterReal,OnClickFilterV4:OnClickFilterV4,RefreshInplViewUrl:RefreshInplViewUrl,RefreshInplViewUrlByContext:RefreshInplViewUrlByContext,CancelRefreshView:CancelRefreshView,CancelRefreshViewByContext:CancelRefreshViewByContext,HandleRefreshView:HandleRefreshView,HandleRefreshViewByContext:HandleRefreshViewByContext,STSNavigate2Real:STSNavigate2Real,DeleteSelectedItems:DeleteSelectedItems,ExpGroup:ExpGroup,STSNavigateToViewReal:STSNavigateToViewReal,CheckInSingleItemFromECB:CheckInSingleItemFromECB,RestoreAllClvpsNavigation:RestoreAllClvpsNavigation,RefreshPageTo:RefreshPageToEx};typeof Sys!="undefined"&&Sys!=null&&typeof Sys.Application!="undefined"&&Sys.Application!=null&&typeof Sys.Application.notifyScriptLoaded=="function"&&Sys.Application.notifyScriptLoaded();NotifyScriptLoadedAndExecuteWaitingJobs("inplview.js")}var g_SPGridInitInfo;function SPGridInitInfo(b,a,e,c,d){this.controllerId=b;this.gridSerializer=a;this.jsInitObj=e;this.showLoading=c;this.pagingInfo=d}function SPGridToggleAllItems(c){var b=g_SPGridInitInfo[c.view],a=window[b.controllerId];a.ToggleAllItems()}function SPGridMakeInplviewRequest(i,g,h,d,c,e,f){var b=new XMLHttpRequest,a=[];a.push(SP.Utilities.Utility.getLayoutsPageUrl("inplview.aspx"));a.push("?Cmd=");a.push(i);a.push("&List=");a.push(g);a.push("&View=");a.push(h);a.push("&IsXslView=TRUE&Grid=True");if(Boolean(d)){a.push("&");a.push(d)}else{if(c){a.push("&SortField=");a.push(escapeProperly(c.sortField));a.push("&SortDir=");a.push(c.isDescending?"Desc":"Asc")}Boolean(e)&&a.push(e)}b.open("POST",a.join(""),true);b.onreadystatechange=f(b);b.send(null)}function SPGridFetchData(c,i,f,h,g,b,a,d){var e=function(e){return function(){if(e.readyState==4){try{e.onreadystatechange=null}catch(m){}var g=e.responseText;if(e.status==601)throw g;if(d){var i=JSON.parse(g),k=JSON.parse(i.CSRData),h=SP.JsGrid.Deserializer.DeserializeFromJson(i.JSGridSchema,null),f;for(var l in g_ctxDict){f=g_ctxDict[l];if(f.listName==c)break}var j=f.ListSchema;TranslateCSRtoJsGrid(k,h,j,f);b(h)}else b(SP.JsGrid.Deserializer.DeserializeFromJson(g,null));typeof a=="function"&&a()}}},j=d?"GridCSRHybrid":"Grid";SPGridMakeInplviewRequest(j,c,i,f,h,g,e)}function SPGridFetchSchema(e,a,c){var d=g_SPGridInitInfo[a];d.stale=true;var b=function(a){return function(){if(a.readyState==4){try{a.onreadystatechange=null}catch(e){}var b=a.responseText;if(a.status==601)throw b;var d=JSON.parse(b);c(d)}}};SPGridMakeInplviewRequest("Schema",e,a,null,null,null,b)}function GetCtxFromView(c){var a=null;for(var d in g_ctxDict){var b=g_ctxDict[d];if(b.view==c){a=b;break}}return a}function RenderSPGridBody(b){AddPostRenderCallback(b,PostRenderSPGrid);var a=[];a.push('<tbody><tr><td><div id="spgridcontainer_');a.push(b.wpq);a.push('" style="display:none;" /></td></tr></tbody></table>');return a.join("")}function PostRenderAfterJSGridRender(a){a.enteringGridMode=false;typeof ProcessImn=="function"&&ProcessImn();SPClientRenderer._ExecuteRenderCallbacks(a,"OnPostRender")}function PostRenderSPGrid(b){var e=document.getElementById("js-listviewthead-"+b.wpq);e.style.display="none";var d=document.getElementById("agg"+b.wpq);if(d!=null)d.style.display="none";var a=g_SPGridInitInfo[b.view],c=document.getElementById("spgridcontainer_"+b.wpq);c.style.width="100%";c.style.display="";EnsureScriptFunc("spgantt.js","SP.GanttControl",function(){EnsureScriptFunc("mquery.js","m$",function(){var d=SP.JsGrid.Deserializer.DeserializeFromJson(a.gridSerializer),e=function(h){var d=new SP.JsGrid.JsGridControl(c,a.showLoading);window[a.controllerId]=new SP.GanttControl;window[a.controllerId].Init(d,h,a.jsInitObj,a.pagingInfo);window.setTimeout(function(){d.Focus()},0);if((a.selectedRows==null||a.selectedRows.length==1)&&b.ListTemplateType==171){var f=a.selectedRows==null?d.GetTopRecordIndex():d.GetViewIndexOfRecord(a.selectedRows[0]),g=d.GetColumns();if(g.length>1&&g[0].columnKey=="Checkmark")d.SelectCellRange(f,f,1,1,false);else d.SelectRowRange(f,f,false)}else if(a.selectedRows!=null)for(var e=0;e<a.selectedRows.length;e++)d.SelectRowRangeByKey(a.selectedRows[e],a.selectedRows[e],e!=0);g_fAnimateListCSR=false;a.fnCallback!=null&&a.fnCallback(window[a.controllerId]);window.setTimeout(function(){PostRenderAfterJSGridRender(b)},0)};if(typeof b.ListSchema.group2=="string"||b.ListSchema.Collapse=="TRUE"||a.stale)SPGridFetchData(b.listName,b.view,b.clvp.PagingString(),null,null,e,null,b.IsClientRendering);else{if(a.unfilteredHierarchyInfo!=null)d.UnfilteredHierarchy=a.unfilteredHierarchyInfo;if(b.ListData.ForceNoHierarchy)d.UnfilteredHierarchy=null;TranslateCSRtoJsGrid(b.ListData,d,b.ListSchema,b);e(d)}})})}function TryRefreshGrid(a){ExitGrid(a,true,function(){var b=g_SPGridInitInfo[a];b.stale=true;InitGridFromView(a,false)})}function ExitGrid(f,g,e){var b=g_SPGridInitInfo[f],c=GetCtxFromView(f),d=window[b.controllerId],h=d.GetCLVPQString(),a=d.GetUnfilteredHierarchyMap();d.TryDispose(function(k){b.initialized=false;c.inGridMode=false;c.leavingGridMode=true;var i=null;if(k!=null&&k.markGridSerializerAsStale)b.stale=true;else if(a!=null){var d=[{Key:0}],f={"0":0},j=function(g){for(var e=0;e<g.length;e++){var b=g[e],c={};c.Key=Number(b);if(a[b].parentKey!=null){var h=f[a[b].parentKey];c.Parent=h}if(a[b].tag!=null)c.Tag=a[b].tag;f[b]=d.length;d.push(c);a[b].childKeys!=null&&j(a[b].childKeys)}};j(a[0].childKeys);i=d}window[b.controllerId]=null;b.unfilteredHierarchyInfo=i;var m=document.getElementById("js-listviewthead-"+c.wpq);m.style.display="";var l=document.getElementById("agg"+c.wpq);if(l!=null)l.style.display="";!g&&c.clvp.RefreshPaging(h.toString());e!=null&&e()})}function InitGridFromView(a,c){var b=g_SPGridInitInfo[a],d=GetCtxFromView(a);InitGrid(b,d,c)}function InitGrid(b,a,e){if(b.initialized)return;b.initialized=true;if(a==null||a.clvp==null)return;a.clvp.CancelAnyOutstandingRequest();a.inGridMode=true;a.enteringGridMode=true;b.jsInitObj.spCsrRenderCtx=a;b.jsInitObj.viewRootFolder=unescapeProperly(a.rootFolder);if(!e){var c=a.clvp.PagingString();a.queryString="?"+(c!=null?c:"");if(a.CurrentSelectedItems>0){b.selectedRows=[];for(var g in a.dictSel){var d=a.dictSel[g];b.selectedRows.push(d.id)}}var f={currentCtx:a,csrAjaxRefresh:true};AJAXRefreshView(f,SP.UI.DialogResult.OK)}}function TranslateCSRtoJsGrid(d,a,s,C){var e,c,f,m={},X,n,b,u,i,g,j={},N=s.Field,S=N.length,w={},Q=a.Fields,T=Q.length,r=null,G=d.Row,B=G.length,I=0,E=[],k=0,H=null,h=null,o=null,x=null,v=null,l=null,A=null,W=false,M=0,F=C==null;function P(c,b){if(typeof d[b]=="string")if(d[b].substring(0,1)=="?")a.AdditionalParams[c]=d[b].substring(1);else{var e=d[b].split("?");a.AdditionalParams[c]=e[1]}else a.AdditionalParams[c]=null}P("prevHref","PrevHref");P("nextHref","NextHref");function R(c,b){if(typeof d[b]=="string")a.AdditionalParams[c]=Number(d[b]);else if(typeof d[b]=="number")a.AdditionalParams[c]=d[b];else a.AdditionalParams[c]=null}R("first","FirstRow");R("last","LastRow");if(typeof s.group1=="string"){k=1;h=s.group1;v=a.MetaData.GroupingPrefix;A=[];if(typeof s.group2=="string"){k=2;o=s.group2}a.MetaData.GroupingLevel=k;x=a.MetaData.GridOperationalConstantsFieldKeyMap[0]=a.Columns[0].fieldKey;delete a.RecordCount;delete a.TopRecord}for(c=0;c<T;c++){f=Q[c];w[f.fieldKey]=f}for(c=0;c<S;c++){f=N[c];j[f.RealFieldName]=f}if(B>0){for(c=0,b=null;c<B&&(b==null||Boolean(b["CustomData."]));c++)b=G[c];for(e in b){i=TranslateCSRtoJsGridFieldName(e,j[e]);m[e]=i;if(j[e]!=null)m[j[e].Name]=i}if(typeof d.FilterLink=="string"){var U=d.FilterLink.substring(1),O=new QstringStruct(U),J={};for(var V in O.filterParams){var t=O.filterParams[V],p=null,q=null;if(t.FilterField!=null){p=t.FilterField;q=t.FilterValue}else{p=t.FilterFields;q=t.FilterValues}p=m[unescapeProperly(p)];q=unescapeProperly(q);J[p]=q}a.AutoFilterState=J}}if(Boolean(d.SortField)){var y=m[d.SortField];if(y==null)y=d.SortField;a.SortState=[{fieldKey:y,isDescending:d.SortDir!="ascending"}]}a.LocalizedTable=[];a.UnlocalizedTable=[];for(c=0;c<B;c++){b=G[c];if(Boolean(b["CustomData."])){I++;continue}M++;if(k>0){var z=function(c,d,e){var a=e==2?"2":"";return v+b[c+".groupindex"+a]+"_"+d},L=function(c,e){var d;if(F){d=c+": "+String(b[c]);if(e==1)l=v+" "+c+":"+String(b[c]);else l=v+" "+h+":"+String(b[h])+" "+o+":"+String(b[o])}else{var f=document.createElement("div");if(e==1)f.innerHTML=RenderGroupEx(C,b,true);else{var i=b[h+".newgroup"];b[h+".newgroup"]="0";f.innerHTML=RenderGroup(C,b);b[h+".newgroup"]=i}d=GetInnerText(f);if(e==1)l=z(c,d,1);else l=z(h,d,1)+" "+z(o,d,2)}n={};g={ID:l,_GRPDESC:Number(b[c+".COUNT.group"+(e==2?"2":"")])};if(k==2)g._GRPLVL=e;if(e==2)H._GRPDESC++;else H=g;g[x]=n[x]=d;a.LocalizedTable.push(n);a.UnlocalizedTable.push(g);A.push(l);E.push(l)};b[h+".newgroup"]=="1"&&L(h,1);b[o+".newgroup"]=="1"&&L(o,2)}n={};g={};E.push(TranslateCSRtoJsGridField("ID",j.ID,b,w.ID).value);for(e in b){var D=j[e],K=D==null?null:m[D.Name];r=K==null?null:w[K];u=TranslateCSRtoJsGridField(e,D,b,r);if(u!=null){i=m[e];f=w[i];if(f!=null){if(f.hasLocalizedValue)n[i]=u.localizedValue;if(f.hasDataValue||k>0&&i=="Title")g[i]=u.value}}}if(!F)g.csrInfo=b;a.LocalizedTable.push(n);a.UnlocalizedTable.push(g)}if(!F)for(c=0;c<a.Fields.length;c++){r=a.Fields[c];r.csrInfo=j[r.fieldKey]}a.ViewInfo=E;if(k>0)a.ViewDepKeys=A;else a.RecordCount=M;a.AdditionalParams.last-=I}function TranslateCSRtoJsGridFieldName(b,a){var c=a!=null?a.FieldType:b;switch(c){case"ContentTypeId":return"_ContentTypeId";case"File_x0020_Type":return"DocIcon";case"PermMask":return"Edit"}return a!=null&&typeof a.RealFieldName=="string"?a.RealFieldName:b}function TranslatedCSRtoJsGridFieldData(b,a){this.value=b;if(a!=null){this.localizedValue=a;this.localizedValueSetExplicitly=true}else{this.localizedValue=b;this.localizedValueSetExplicitly=false}}function TranslateCSRtoJsGridField(b,g,d,e){var c,a=d[b];if(e!=null&&(e.propertyTypeId=="SPMultilineText"||e.propertyTypeId=="String"||e.propertyTypeId=="SPTextMaxLength"))a=STSHtmlDecode(a);var f=g!=null?g.FieldType:b;if(a==null)throw"CSR JSON did not contain a value for expected field "+b;if(f==null)return null;switch(f){case"Boolean":var r=b+".value";return a==null||a==""?null:new TranslatedCSRtoJsGridFieldData(d[r],a);case"Computed":if(b=="FileLeafRef"){EnsureScriptFunc("clienttemplates.js","EnsureFileLeafRefName",function(){EnsureFileLeafRefName(d)});return new TranslatedCSRtoJsGridFieldData(null,d["FileLeafRef.Name"])}else if(g.Format=="Hyperlink")return i(b,a,d);break;case"File_x0020_Type":return a==""?null:new TranslatedCSRtoJsGridFieldData(null,a);case"ID":return new TranslatedCSRtoJsGridFieldData(Number(a),String(a));case"Lookup":case"LookupMulti":if(a=="")return null;if(typeof a=="string")return new TranslatedCSRtoJsGridFieldData(a);else{var l=a,j=[];a=null;for(c=0;c<l.length;c++){var m=l[c],k=m.lookupId,h=m.lookupValue;if(f=="Lookup")return new TranslatedCSRtoJsGridFieldData(k,h);if(a==null)a=h;else a=a+"; "+h;j.push(k)}}return new TranslatedCSRtoJsGridFieldData(j,a);case"MultiChoice":return m$.isArray(a)?new TranslatedCSRtoJsGridFieldData(a.join("; ")):new TranslatedCSRtoJsGridFieldData("");case"PermMask":var q=parseInt(a.substring(a.length-8),16)|0;return new TranslatedCSRtoJsGridFieldData(q);case"URL":return i(b,a,d);case"User":case"UserMulti":var n=d[b];a=null;for(c=0;c<n.length;c++){var o=n[c];if(a==null)a=o.title;else a=a+"; "+o.title}break;case"TaxonomyFieldType":case"TaxonomyFieldTypeMulti":if(typeof SP.UI!="undefined"&&typeof SP.UI.Taxonomy!="undefined"&&typeof SP.UI.Taxonomy.DataConverters!="undefined"&&typeof SP.UI.Taxonomy.DataConverters.DataValueToInputValue=="function"){var p=SP.UI.Taxonomy.DataConverters.DataValueToInputValue(a,f=="TaxonomyFieldTypeMulti");return new TranslatedCSRtoJsGridFieldData(a,p)}}if(a==null||a=="")return null;return new TranslatedCSRtoJsGridFieldData(a);function i(e,a,f){if(a==null||a=="")return null;var b=a,c=f[e+".desc"],d={display:c,address:b};return new TranslatedCSRtoJsGridFieldData(d)}}function CreateColumn(){EnsureScriptFunc("ribbon","SP.Ribbon.PageManager",function(){SP.Ribbon.PageManager.get_instance().executeRootCommand("CreateColumn")});return false}function GetSPGanttFromCtx(b){var a=g_SPGridInitInfo[b.view];return a==null?null:window[a.controllerId]}var AllViews;function ShowSaveAsNewViewDialog(f,g,h,b,a){var c=document.getElementById("CSRSaveAsNewViewAnchor"+h);if(Boolean(c)&&c.getAttribute("saveViewButtonDisabled")=="true")return;else Boolean(c)&&c.setAttribute("saveViewButtonDisabled","true");var d=SP.ClientContext.get_current(),j=d.get_web(),i=d.get_web().get_lists().getById(f),e=i.get_views().getById(g);AllViews=i.get_views();d.load(AllViews);d.load(e);d.executeQueryAsync(function(){var k=document.createElement("DIV"),d=[];d.push(Strings.STS.L_SaveViewDlgMsg+"<br/>");d.push('<br/><input id="SaveAsNewViewName" style="width: 200px" type="text" value='+StAttrQuote(e.get_title())+" onkeyup=\"ValidateNewOrUpdatedView('");d.push(b+"', '"+a+"')\" /><br/>");d.push('<form id="SANVPrivacyForm"><br/>');d.push('<label for="SANVprivacy-public" style="display: block;"><input style="vertical-align: bottom;" type="radio" id="SANVprivacy-public" name="SANVprivacy" value="public" checked="checked" onclick="ValidateNewOrUpdatedView(\'');d.push(b+"', '"+a+'\')" disabled="true"/>');d.push(Strings.STS.L_SaveViewDlgPublicOpt);d.push("</label>");d.push('<label for="SANVprivacy-private" style="display: block;"><input style="vertical-align: bottom;" type="radio" id="SANVprivacy-private" name="SANVprivacy" value="personal" onclick="ValidateNewOrUpdatedView(\'');d.push(b+"', '"+a+'\')" disabled="true"/>');d.push(Strings.STS.L_SaveViewDlgPersonalOpt);d.push("</label></form><br/>");d.push('<div class="ms-core-form-bottomButtonBox">');d.push('<button id="ms-SaveBtnDismissDlg" class="ms-ButtonHeightWidth" ');d.push('value="save" onclick="DismissSaveAsNewViewDialog(this,\''+f+"', '"+g+"', '"+h+'\')" disabled="true">');d.push(Strings.STS.L_SaveButtonCaption);d.push("</button>");d.push('<button id="ms-CancelBtnDismissDlg" class="ms-ButtonHeightWidth" ');d.push('value="cancel" onclick="DismissSaveAsNewViewDialog(this,\''+f+"', '"+g+"', '"+h+"')\">");d.push(Strings.STS.L_CancelButtonCaption);d.push("</button>");d.push("</div>");k.innerHTML=d.join("");var l={html:k,title:Strings.STS.L_SaveViewDlgTitle,dialogReturnValueCallback:function(){Boolean(c)&&c.setAttribute("saveViewButtonDisabled","false")}},m=new SP.UI.ModalDialog.showModalDialog(l),i=document.getElementById("SaveAsNewViewName");if(Boolean(i))if(!e.get_personalView()&&b=="false"&&a=="true"||e.get_personalView()&&b=="true"&&a=="false")i.value="";ValidateNewOrUpdatedView(b,a);var j=document.getElementById("ms-CancelBtnDismissDlg");Boolean(j)&&j.focus()},function(){ULS.SendErrorMessageJS("inplview","ShowSaveAsNewViewDialog failed")})}function DismissSaveAsNewViewDialog(j,h,i,k){var b=SP.UI.ModalDialog.get_childDialog();if(Boolean(b)){var e=SP.UI.DialogResult.cancel;if(j.value=="save"){var a=document.getElementById("SaveAsNewViewName").value;if(GetExistingView(a)!=null)if(!confirm(StBuildParam(Strings.STS.L_SaveViewOverwriteDlgMsg,a)))return;var g=document.getElementById("SANVPrivacyForm"),d=false;if(g[1].checked)d=true;var f={name:a,privacyOption:d};SaveThisView(h,i,f);b.set_returnValue(f);e=SP.UI.DialogResult.OK}b.close(e);var c=document.getElementById("CSRSaveAsNewViewAnchor"+k);Boolean(c)&&c.setAttribute("saveViewButtonDisabled","false")}}function GetExistingView(b){for(var a=0;a<AllViews.get_data().length;a++){var c=AllViews.get_data()[a].get_title();if(b==c)return AllViews.get_data()[a]}return null}function ValidateNewOrUpdatedView(d,c){var a=document.getElementById("SANVPrivacyForm");if(d=="true"&&c=="true"){a[0].disabled=false;a[1].disabled=false}else if(d=="false"&&c=="true"){a[0].checked=false;a[1].checked=true}if(AllViews==null)return;var k=document.getElementById("SaveAsNewviewErrorMsg"),g=document.getElementById("SaveAsNewViewName").value,e=document.getElementById("ms-SaveBtnDismissDlg"),b=GetExistingView(g);if(b!=null){var j=b.get_title();if(j==g){var i="public",h="personal";if(b.get_personalView()){i="personal";h="public"}if(d=="true"&&c=="true"){if(b.get_personalView()){a[0].checked=false;a[1].checked=true}else{a[0].checked=true;a[1].checked=false}a[0].disabled=true;a[1].disabled=true}var f=false;if(a[1].checked)f=true;if(b.get_personalView()!=f){e.disabled=true;return}else{e.disabled=false;return}}}e.disabled=false}function SaveThisView(e,f,c){var b=SP.ClientContext.get_current(),d=b.get_web().get_lists().getById(e),a=document.location.href;a=d.saveAsNewView(f,c.name,c.privacyOption,a);b.load(d);b.executeQueryAsync(function(){a=a.get_value();STSNavigate(a)},function(){ULS.SendErrorMessageJS("inplview","SaveThisView failed")})}function SelectedItem(){}function SwapNode(a,b){return a.parentNode.replaceChild(b,a)}function CountDictionary(b){var a=0,c;for(c in b)a++;return a}function EncodeQueryStringAsHash(a){return a.replace(/-/g,"--").replace(/&/g,"-")}function DecodeHashAsQueryString(a){return a.replace(/-/g,"&").replace(/&&/g,"-")}function CLVP_InitializePrototype(){CLVP.prototype={outstandingRequest:undefined,bRequestOutstanding:false,cctx:undefined,ctx:undefined,dsrc:null,fnEcbCallback:null,fRestore:false,inplUrl:null,isEcbInfo:false,isInserting:false,pagingTab:null,queueEcbInfo:[],rgehs:undefined,rgpag:null,rgpaging:null,rootFolder:null,rootFolderGuid:null,strGroupCache:null,strGroupName:null,tBody:null,tab:null,trEmpty:null,wpid:null,wpq:null,strHash:"",CancelAnyOutstandingRequest:CLVPCancelAnyOutstandingRequest,CacheEcbInfo:CLVPCacheEcbInfo,CacheGroupName:CLVPCacheGroupName,CheckinItem:CLVPCheckinItem,CheckoutItem:CLVPCheckoutItem,DeleteGroupNameCache:CLVPDeleteGroupNameCache,DeleteItemCore:CLVPDeleteItemCore,DiscardCheckoutItem:CLVPDiscardCheckoutItem,EnqueueEcbInfoRequest:CLVPEnqueueEcbInfoRequest,EnsureChangeContext:CLVPEnsureChangeContext,EnsureEcbInfo:CLVPEnsureEcbInfo,FilterString:CLVPFilterString,FindWebPartDiv:CLVPFindWebPartDiv,GetEcbInfo:CLVPGetEcbInfo,GetQueryString:CLVPGetQueryString,Init:CLVPInit,InplViewUrl:CLVPInplViewUrl,ModerateItem:CLVPModerateItem,RefreshInplViewUrl:CLVPRefreshInplViewUrl,InplViewUrlTrim:CLVPInplViewUrlTrim,InplViewUrlHash:CLVPInplViewUrlHash,InvalidateEcbInfo:CLVPInvalidateEcbInfo,IsInGroupCache:CLVPIsInGroupCache,ManageCopies:CLVPManageCopies,NoOutstandingECBRequests:CLVPNoOutstandingECBRequests,PagingString:CLVPPagingString,RefreshCore:CLVPRefreshCore,RefreshCurrent:CLVPRefreshCurrent,RefreshEcbInfo:CLVPRefreshEcbInfo,RefreshPaging:CLVPRefreshPaging,RefreshPagingEx:CLVPRefreshPagingEx,RehookPaging:CLVPRehookPaging,ResetSelection:CLVPResetSelection,ShowErrorDialog:CLVPShowErrorDialog,ShowPopup:CLVPShowPopup,SyncPagingTables:CLVPSyncPagingTables,WebPartId:CLVPWebPartId,RestoreNavigation:CLVPRestoreNavigation,GetQueryStringFromHash:CLVPGetQueryStringFromHash,FindTab:CLVPFindTab}}function CLVP(a){this.ctx=a;a.clvp=this}function CLVPInit(){if(false)this.ctx.clvp=null;var b=this.FindTab();if(b==null)return;this.wpq=b.id;this.pagingTab=document.getElementById("bottomPagingCell"+this.wpq.substr(7));if(this.tab!=null&&this.tab.className=="ms-emptyView"){var c=GetAncestor(this.tab,"TR");this.trEmpty=c.nextSibling}if(this.ctx.rootFolder!=null)this.rootFolder=unescapeProperly(this.ctx.rootFolder);if(!Boolean(this.rootFolder))this.rootFolder=GetUrlKeyValue("RootFolder");if(this.rootFolder.length==0)this.rootFolder=null;var a=this.GetQueryStringFromHash();if(!IsNullOrUndefined(a))this.ctx.queryString=a}function CLVPFindTab(){var f=this.ctx.listBaseType==1,c=this.ctx.listName+"-"+this.ctx.view,b=GetElementsByName(c);if(b.length==0&&f){c="onetidDoclibViewTbl0";b=GetElementsByName(c)}var a=null;if(b.length==0&&!f)b=GetElementsByName("onetidDoclibViewTbl0");if(b.length==0)b=GetElementsByName("onetidDoclibViewTbl"+this.ctx.ctxId);for(var e=0;e<b.length;e++){var g=b[e];a=g;var d=null;while(a!=null&&(a.tagName!="DIV"||(d=a.getAttribute("WebPartID"))==null)&&a.parentNode!=null)a=a.parentNode;if(a!=null)if(d!=null&&this.ctx.view.indexOf(d.toUpperCase())==1){this.tab=g;this.wpq=a.id;break}}if(a==null||this.tab==null)return null;this.tab.clvp=this;return a}function CLVPFindWebPartDiv(b){var a=b;while(a!=null&&a.tagName!="DIV")a=a.parentNode;return a}function CLVPRestoreNavigation(){var a=ajaxNavigate.getParam("InplviewHash"+this.WebPartId());if(a==null)a="";if(!CompareUrls(this.strHash,a)){var b="?"+DecodeHashAsQueryString(a),d=GetUrlKeyValue("ShowInGrid",true,b);if(d=="True")InitGridFromView(this.ctx.view,true);else this.ctx.inGridMode&&ExitGrid(this.ctx.view,true);this.strHash=a;this.fRestore=true;var c=GetRootFolder2(this);if(c!=null)b=SetUrlKeyValue("RootFolder",unescapeProperly(c),true,b);this.RefreshPagingEx(b,true,null)}}function CLVPGetQueryStringFromHash(){var a=ajaxNavigate.getParam("InplviewHash"+this.WebPartId());return IsNullOrUndefined(a)?"":"?"+DecodeHashAsQueryString(a)}function CLVPSyncPagingTables(){if(this.wpq==null)return;var b=this.pagingTab,a=document.getElementById("topPagingCell"+this.wpq.substr(7));if(b==null){if(a!=null)a.style.display="none";return}if(a!=null){a.style.display="";if(GetInnerText(a)!=GetInnerText(b))a.innerHTML=b.innerHTML;for(var e=a.getElementsByTagName("A"),d=b.getElementsByTagName("A"),c=0,c=0;c<d.length;c++)e[c].onclick=d[c].onclick}}function CLVPRehookPaging(c){if(typeof this.ctx.noAJAX!="undefined"&&this.ctx.noAJAX)return;var i=this.pagingTab;if(i==null){this.SyncPagingTables();return}for(var h=i.getElementsByTagName("A"),f=0;f<h.length;f++){var e=h[f],a=typeof e.onclick!="undefined"?String(e.onclick):"",g='"';a=a.substr(a.indexOf(g)+1);a=a.substr(0,a.indexOf(g));if(c!=null)a+="&IsGroupRender=TRUE";var k=this,b,d;if(c!=null)b=c.id;else b=null;d=a;typeof b!="undefined"&&typeof d!="undefined"&&j(e,k,d,b)}c==null&&this.SyncPagingTables();function j(d,a,c,b){d.onclick=function(){a.RefreshPaging(c,b);return false}}}function CLVPFilterString(){return this.PagingString(["Filter","Sort"])}function CLVPPagingString(d){if(this.rgpaging==null)return null;var b,g,a=[],e=true;for(b in this.rgpaging){var c=false;if(d==null)c=true;else for(var f in d)if(b.indexOf(f)==0){c=true;break}if(c){if(e)e=false;else a.push("&");a.push(b);a.push("=");a.push(this.rgpaging[b])}}return a.join("")}function CLVPRefreshPaging(c,a,b){if(a!=null)this.tBody=document.getElementById(a);return this.RefreshPagingEx(c,true,null,b)}function RefreshPageToEx(f,b,e){var a=CLVPFromEvent(f);if(a!=null&&a.ctx.IsClientRendering){a.RefreshPaging(b);a.ctx.queryString=b;if((typeof a.ctx.operationType=="undefined"||a.ctx.operationType==SPListOperationType.Default)&&Boolean(a.ctx.ListData)){var c=a.ctx.ListData.FirstRow-1,d=Number(GetUrlKeyValue("PageFirstRow",false,b));if(!isNaN(c)&&!isNaN(d)&&c!=d)c<d?a.ctx.operationType=SPListOperationType.PagingRight:a.ctx.operationType=SPListOperationType.PagingLeft}}else SubmitFormPost(b,e)}function CLVPRefreshPagingEx(e,p,o,t){var r=GetUrlKeyValue("PageFirstRow",false,e)=="1";if(r)e=RemoveOnlyPagingArgs(e);var w=new URI(e,{disableEncodingDecodingForLegacyCode:true}),v=w.getQuery(),g=v.split("&"),f,b=[];o!=null&&b.push("&Cmd="+o);this.ctx.HasRelatedCascadeLists==1&&this.ctx.CascadeDeleteWarningMessage==null&&b.push("&CascDelWarnMessage=1");if(p||typeof this.rgpaging=="undefined"||this.rgpaging==null){this.rgpaging=[];for(f=0;f<g.length;f++){var c=g[f].split("=");if(c[0]=="List"||c[0]=="View"||c[0]=="ID"){delete c;continue}if(c.length>1)this.rgpaging[c[0]]=c[1];delete c;b.push("&");b.push(g[f])}}else{var d;for(d in this.rgpaging){if(d=="List"||d=="View"||d=="ID")continue;b.push("&");b.push(d);b.push("=");b.push(this.rgpaging[d])}}var m=document.getElementById("GroupByWebPartID"+this.ctx.ctxId);m!=null&&b.push("&WebPartID="+m.getAttribute("webPartID"));if(this.strGroupName!=null){var h=GroupStringFromGroupName(this.strGroupName);h!=null&&b.push("&IsGroupRender=TRUE&DrillDown=1&GroupString="+h)}var k=new URI(this.InplViewUrl(),{disableEncodingDecodingForLegacyCode:true}),u=k.getStringWithoutQueryAndFragment(),s=k.getQuery(),q=b.join("");delete b;var a=u+"?"+ReconcileQstringFilters(s,q);if(GetUrlKeyValue("SortField",true,a).length==0){var j=GetUrlKeyValue("SortField",true,window.location.href);if(j.length>0)a=SetUrlKeyValue("SortField",j,false,a);var l=GetUrlKeyValue("SortDir",true,window.location.href);if(l.length>0)a=SetUrlKeyValue("SortDir",l,false,a)}var n=GetUrlKeyValue("RootFolder",true,e);if(n.length>0&&GetUrlKeyValue("RootFolder",true,a).length==0)a=SetUrlKeyValue("RootFolder",n,false,a);var i=GetUrlKeyValue("ShowInGrid",true,a);if(i=="True"&&!this.ctx.inGridMode)a=SetUrlKeyValue("ShowInGrid","False",true,a);else if(i!="True"&&this.ctx.inGridMode)a=SetUrlKeyValue("ShowInGrid","True",true,a);if(t)return a;this.RefreshCore(a);return undefined}function CLVPResetSelection(){var a=this.ctx,f=true;this.CUIItemInfo=null;if(CountSelectedItems(a)>0){var g=a.dictSel;a.dictSel=[];a.CurrentSelectedItems=0;var h=window.location.href;if(h.indexOf("Filter")==-1&&h.indexOf("Sort")==-1){var d=this.tab;if(d!=null){var c=d.rows,k=function(b){var a=b.getAttribute("iid");return a!=null&&g[a]!=null},b=GetLastSelectableRowIdx(d,k);if(c!=null&&b>0){for(var e=0;e<b;e++){var j=c[e],i=j.getAttribute("iid");i!=null&&g[i]!=null&&ToggleItemRowSelection2(a,j,true,false,false)}f=false;ToggleItemRowSelection2(a,c[b],true,true,false)}}}}UpdateSelectAllCbx(a,true);f&&RefreshCommandUI()}function CLVPWebPartId(){if(this.wpid==null){if(this.tab!=null){var a=this.tab;while(a!=null&&a.tagName!="DIV")a=a.parentNode;if(a!=null){if(a.getAttribute("WebPartID2")!=null){this.wpid=a.getAttribute("WebPartID2");return this.wpid}if(a.getAttribute("WebPartID")!=null){this.wpid=a.getAttribute("WebPartID");return this.wpid}}}this.wpid=this.ctx.view.toLowerCase().substring(1,this.ctx.view.length-1)}return this.wpid}function FixAggregate(b,c,a){if(c==null||a==null)return;var e=a.Aggregate;if(e!=null&&c.Row.length>0&&!a.groupRender&&!b.inGridMode){var d=document.getElementById("aggr"+b.wpq),h="<table>"+RenderAggregate(b,null,c.Row[0],a,null,true,e)+"</table>",i=document.getElementById("scriptBody"+b.wpq),f=document.createElement("div");f.innerHTML=h;var g=f.firstChild.firstChild;d.replaceChild(g.firstChild,d.firstChild)}}function FixSortOrderIcon(c,b,e){if(c==null||b==null||e==null)return;if(c.IsClientRendering){var a;if(b.SortField!=null){a=document.getElementById("diidSortArrowSpan"+c.ctxId+b.SortField);if(a!=null){var f=a.getElementsByTagName("img")[0];if(f!=null){if(b.SortDir=="ascending"){a.className="ms-sortarrowup-iconouter";f.className="ms-sortarrowup-icon"}else{a.className="ms-sortarrowdown-iconouter";f.className="ms-sortarrowdown-icon"}a.style.display=""}}}var h,g;for(var i in e.Field){var d=e.Field[i];if(d.GroupField!=null)continue;if(d.Name!=b.SortField){a=document.getElementById("diidSortArrowSpan"+c.ctxId+d.Name);if(a!=null)a.style.display="none"}g=document.getElementById("diidFilterSpan"+c.ctxId+d.Name);if(g!=null){h=b.FilterFields!=null&&b.FilterFields.indexOf(";"+d.Name+";")>=0;g.style.display=h?"":"none"}}}else FixSortOrderIcon_NonCSR(c,b,e)}function FixSortOrderIcon_NonCSR(l,d,j){var h="/_layouts/15/images/sort.gif",g="/_layouts/15/images/rsort.gif";if(d==null||j==null)return;if(d.SortField!=null){var b=document.getElementById("diidSort"+l.ctxId+d.SortField);if(b!=null){var c=b.lastChild;if(c!=null){var a=c.previousSibling;a!=null&&a.tagName=="IMG"&&(a.src.substr(a.src.length-h.length)==h||a.src.substr(a.src.length-g.length)==g)&&a.parentNode.removeChild(a);var f=document.createElement("IMG");f.border=0;if(d.SortDir=="ascending"){f.alt=Strings.STS.L_viewedit_onetidSortAsc;f.src="/_layouts/15/images/sort.gif?rev=23"}else{f.alt=Strings.STS.L_viewedit_onetidSortDesc;f.src="/_layouts/15/images/rsort.gif?rev=23"}if(c.tagName!="IMG"){var k=document.createElement("IMG");k.border=0;k.src="/_layouts/15/images/blank.gif";c=b.appendChild(k)}b.insertBefore(f,c)}}}for(var n in j.Field){var i=j.Field[n];if(i.GroupField!=null)continue;b=document.getElementById("diidSort"+l.ctxId+i.Name);if(i.Name!=d.SortField)if(b!=null){c=b.lastChild;if(c!=null){a=c.previousSibling;a!=null&&a.tagName=="IMG"&&(a.src.substr(a.src.length-h.length)==h||a.src.substr(a.src.length-g.length)==g)&&a.parentNode.removeChild(a)}}if(b!=null){var e=b.nextSibling;if(e==null){e=document.createElement("IMG");e.border=0;b.parentNode.appendChild(e)}var m=d.FilterFields!=null&&d.FilterFields.indexOf(";"+i.Name+";")>=0;if(m)e.src="/_layouts/15/images/filter.gif";else e.src="/_layouts/15/images/blank.gif"}}}function CLVPCancelAnyOutstandingRequest(){var a=this;if(a.bRequestOutstanding&&a.outstandingRequest!=undefined){if(a.isEcbInfo){a.isEcbInfo=false;a.strGroupName=null}a.outstandingRequest.isCancelled=true;a.outstandingRequest=undefined}return false}function EnableListAnimation(a){var b=SPAnimation.Settings.IsAnimationEnabled()&&IsNullOrUndefined(a.ListSchema.group1)&&IsNullOrUndefined(a.ListSchema.group2)&&IsNullOrUndefined(a.ListSchema.Aggregate)&&a.Templates.Body===RenderBodyTemplate&&(a.BaseViewID==1||a.ListTemplateType==101&&a.ListSchema.IsDocLib=="1"&&a.BaseViewID==50||a.ListTemplateType==700&&(a.BaseViewID==51||a.BaseViewID==52))&&!a.clvp.fRestore&&!a.skipNextAnimation&&!a.inGridMode&&!a.leavingGridMode;a.skipNextAnimation=false;return b}function ReRenderListView(a,l,e){var b=a.clvp,c=EnableListAnimation(a),g=false,f=false;if(c)g=a.ListData.Row.length==0||Boolean(a.ListData.NextHref);if(e!=null)a.ListData=JSON.parse(e.responseText);if(c)f=a.ListData.Row.length==0||Boolean(a.ListData.NextHref);var k=c&&f&&!g,d=null;if(!(b.fRestore||a.enteringGridMode||a.leavingGridMode))d=document.getElementById("scriptBody"+a.wpq);RenderListView(a,a.wpq,d,c,k);FixSortOrderIcon(a,a.ListData,a.ListSchema);FixAggregate(a,a.ListData,a.ListSchema);if(b.tab==null)b.Init();else d==null&&b.FindTab();if(b.fRestore||a.enteringGridMode||a.leavingGridMode){b.fRestore=false;b.tab!=null&&RemoveCssClassFromElement(b.tab,"s4-hide-tr")}if(!Boolean(b.ctx.loadingAsyncData)&&!b.fRestore&&e!=null||b.ctx.enteringGridMode||b.ctx.leavingGridMode){var j={},i=b.InplViewUrlHash(l);j["InplviewHash"+b.WebPartId()]=i;ajaxNavigate.update(null,j);b.strHash=i}if(Boolean(b.ctx.loadingAsyncData))b.ctx.loadingAsyncData=false;ctxInitItemState(a);ClearSelectedItemsDict(a);if(b.tab!=null&&(typeof b.tab.onmouseover=="undefined"||b.tab.onmouseover==null))b.tab.onmouseover=b.ctx.TableMouseoverHandler;if(a.SelectAllCbx!=null&&(typeof a.SelectAllCbx.onfocus=="undefined"||a.SelectAllCbx.onfocus==null))a.SelectAllCbx.onfocus=a.TableCbxFocusHandler;b.InvalidateEcbInfo();b.ResetSelection();b.SyncPagingTables();if(c&&d!=null)AnimateListDelta(a,d.parentNode);else if(typeof ProcessImn!="undefined"){imnCount=0;bIMNOnloadAttached=false;ProcessImn()}if(typeof b.ctx.onViewReRenderCompleted=="function"){var h=b.ctx.onViewReRenderCompleted;b.ctx.onViewReRenderCompleted=null;h!=null&&h(b.ctx)}a.operationType=SPListOperationType.Default;if(a.leavingGridMode)a.leavingGridMode=false}function CLVPRefreshCore(d,f){ctxFilter==null&&MenuHtc_hide();var c=new XMLHttpRequest,e="";if(typeof this.ctx.overrideSelectCommand!="undefined"){e="&OverrideSelectCommand="+this.ctx.overrideSelectCommand;d=SetUrlKeyValue("IgnoreQString","TRUE",false,d)}var g=GetUrlKeyValue("RootFolder",true,d);if(g.length>0){e=e+"&InplRootFolder="+g;d=RemoveUrlKeyValue("RootFolder",d)}c.open("POST",d,true);c.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var a=this,b=a.tBody;a.tBody=null;a.focusInfo=null;a.CancelAnyOutstandingRequest();if(focusAcc!=null&&focusAcc.focusInCLVPTab!=null)a.focusInfo=focusAcc;if(a.ctx.enteringGridMode&&!a.fRestore){ReRenderListView(a.ctx,d,null);return}a.outstandingRequest=c;a.bRequestOutstanding=true;c.onreadystatechange=function(){var i,callback=null;if(c.readyState==4&&typeof a.ctx.onDataRefreshCompleted=="function"){callback=a.ctx.onDataRefreshCompleted;a.ctx.onDataRefreshCompleted=null}if((typeof c.isCancelled=="undefined"||c.isCancelled!=true)&&c.readyState==4){callback!=null&&callback(a.ctx);try{c.onreadystatechange=null}catch(e){}a.bRequestOutstanding=false;var reqStatus=0;try{reqStatus=c.status}catch(e){}if(reqStatus==0)return;var strInner=c.responseText,uri=Boolean(a.ctx.queryString)?new URI(a.ctx.queryString,{disableEncodingDecodingForLegacyCode:true}):null;if(uri!==null&&uri.getQuery()!==""){var SaveThisViewButton=document.getElementById("CSRSaveAsNewViewDiv"+a.ctx.wpq);if(Boolean(SaveThisViewButton))SaveThisViewButton.style.visibility="visible"}if(reqStatus==601){if(typeof a.ctx.onRefreshFailed=="function"){a.ctx.onRefreshFailed(a.ctx,c);a.ctx.onRefreshFailed=null}else alert(strInner);return}if(typeof f==="function"){f(d,c.responseText);return}if(a.isEcbInfo){a.CacheEcbInfo(strInner);a.isEcbInfo=false;a.strGroupName=null;if(a.queueEcbInfo.length>0)while(a.EnsureEcbInfo(null,null,a.queueEcbInfo.shift())!=null&&a.queueEcbInfo.length>0);return}var oldListData=null;if(b==null&&a.ctx.IsClientRendering){var rCtx=a.ctx;ReRenderListView(rCtx,d,c);g_ExpGroupTable=[];ExpDataViewGroupOnPageLoad();return}else if(b!=null&&a.ctx.IsClientRendering){rCtx=a.ctx;oldListData=rCtx.ListData;rCtx.ListData=JSON.parse(c.responseText);var listSchema=rCtx.ListSchema,group1=listSchema.group1,group2=listSchema.group2,collapse=listSchema.Collapse;listSchema.groupRender=true;listSchema.group1=null;listSchema.group2=null;listSchema.Collapse=null;var oldHeaderTemplate=rCtx.Templates.Header;rCtx.Templates.Header="";SPClientRenderer._ExecuteRenderCallbacks(rCtx,"OnPreRender");strInner=SPClientRenderer.RenderCore(rCtx);if(rCtx.Templates.Footer=="")rCtx.Templates.Footer=RenderFooterTemplate;strInner+=rCtx.RenderFooter(rCtx);rCtx.Templates.Header=oldHeaderTemplate;listSchema.group1=group1;listSchema.group2=group2;listSchema.Collapse=collapse;listSchema.groupRender=null;if(typeof m$!="undefined")rCtx.ListData=MergeListData(oldListData,rCtx.ListData)}var div=document.createElement("DIV"),tid=a.tab.id;if(a.tab.tagName=="DIV"&&typeof a.tab.tabid!="undefined")tid=a.tab.tabid;var pid=Boolean(a.pagingTab)?a.pagingTab.id:null;div.style.visibility="hidden";div.innerHTML=strInner;for(var oldFilterIfrm=document.getElementById("FilterIframe"+a.ctx.ctxId),newIfrms=div.getElementsByTagName("IFRAME"),newFilterIfrm=null,idx=0;idx<newIfrms.length;idx++)if(newIfrms[idx].id=="FilterIframe"+a.ctx.ctxId){newFilterIfrm=newIfrms[idx];break}if(oldFilterIfrm!=null&&newFilterIfrm!=null){var td=oldFilterIfrm.parentNode;td.removeChild(oldFilterIfrm);td.appendChild(newFilterIfrm)}document.body.appendChild(div);var evalSafeClvp=a;eval("ctx"+a.ctx.ctxId+".clvp = evalSafeClvp;");var rgscripts=ExpColGroupScripts(strInner),ppid="previewpanetable"+a.ctx.ctxId,ppold=document.getElementById(ppid);if(ppold!=null)ppold.id="";a.tab.id="";var hid=document.getElementById("hidRootFolder");if(hid!=null){a.rootFolder=hid.value;hid.value.indexOf("?")>=0}var hidFolderGuid=document.getElementById("hidRootFolderGuid");if(hidFolderGuid!=null)a.rootFolderGuid=hidFolderGuid.value;var tabs;if(b!=null&&a.ctx.IsClientRendering)tabs=div.childNodes;else tabs=GetElementsByName(tid);if(tabs.length==0)if(tid=="onetidDoclibViewTbl0")tabs=GetElementsByName(a.ctx.listName+"-"+a.ctx.view);else tabs=GetElementsByName("onetidDoclibViewTbl0");var tabNew=null,pagNew=document.getElementById("bottomPagingCell"),trNew=null;if(tabs.length==1)tabNew=tabs[0];else{for(i=0;i<tabs.length;i++){tabNew=tabs[i];var divNew=a.FindWebPartDiv(tabNew);if(divNew==div)break}if(i==tabs.length)tabNew=null}if(tabNew==null){SwapNode(a.tab,div);div.style.visibility="visible";return}if(tabNew.className=="ms-emptyView"){trNew=GetAncestor(tabNew,"TR");trNew=trNew.nextSibling}var groupRender=false;if(b!=null){groupRender=true;if(b.getAttribute("isLoaded")!=null){b.setAttribute("isLoaded","true");a.tab.id=tid;if(typeof a.tab.onmouseover=="undefined"||a.tab.onmouseover==null)a.tab.onmouseover=a.ctx.TableMouseoverHandler;if(a.ctx.SelectAllCbx!=null&&(typeof a.ctx.SelectAllCbx.onfocus=="undefined"||a.ctx.SelectAllCbx.onfocus==null))a.ctx.SelectAllCbx.onfocus=a.ctx.TableCbxFocusHandler;!a.ctx.StateInitDone&&ctxInitItemState(a.ctx);var objChildren=b.childNodes;for(i=objChildren.length-1;i>=0;i--){var objToRemove=objChildren[i];if(objToRemove.tagName=="TR"&&ItemIsSelectable(objToRemove))a.ctx.TotalListItems--;b.removeChild(objToRemove)}var selectableNodes=0,tBodyArray=tabNew.getElementsByTagName("TBODY");if(tBodyArray.length>=1){objChildren=tBodyArray[0].childNodes;var node=null;for(i=objChildren.length-1;i>=0;i--){var objToInsert=objChildren[i];if(i==0&&objToInsert.className.startsWith("ms-viewheadertr"))continue;if(objToInsert.tagName=="TR"&&ItemIsSelectable(objToInsert)){selectableNodes++;a.ctx.TotalListItems++}node=b.insertBefore(objToInsert,node)}if(pagNew!=null){var pagingTable=GetAncestor(pagNew,"TABLE"),curPagTab=b.nextSibling;if(curPagTab==null||curPagTab.tagName!="TBODY"||curPagTab.id!=b.id+"page"||curPagTab.firstChild==null||curPagTab.firstChild.tagName!="TR"){curPagTab=document.createElement("TBODY");curPagTab.id=b.id+"page";curPagTab=b.parentNode.insertBefore(curPagTab,b.nextSibling);var tr=document.createElement("TR");tr=curPagTab.appendChild(tr)}var trNode=curPagTab.firstChild;trNode.firstChild!=null&&trNode.removeChild(trNode.firstChild);pagNew.colSpan=100;pagNew.id=pagNew.id+a.wpq.substr(7)+b.id;pagNew=trNode.appendChild(pagNew)}b.setAttribute("selectableRows",String(selectableNodes));UpdateCtxLastSelectableRow(a.ctx,a.tab)}a.InvalidateEcbInfo();a.ResetSelection()}}document.body.removeChild(div);if(pagNew!=null){var tab=a.pagingTab;a.pagingTab=pagNew;a.RehookPaging(b);a.pagingTab=tab}if(typeof ProcessImn!="undefined"){imnCount=0;bIMNOnloadAttached=false;ProcessImn()}if(groupRender){g_ExpGroupInProgress=false;g_ExpInitializing=false;g_ExpGroupXSLTQueue.length>0&&ExpGroupFetchData(g_ExpGroupXSLTQueue.shift(),"true")}!g_ExpGroupInProgress&&a.queueEcbInfo.length>0&&a.EnsureEcbInfo(null,null,a.queueEcbInfo.shift());if(a!=null&&a.focusInfo!=null)if(a.focusInfo.focusInCLVPTab!=null&&a.focusInfo.focusInCLVPTab==true){var focusTabl=a.tab,focusBack=null;if(focusTabl!=null&&a.focusInfo.tagName!=null&&a.focusInfo.id!=null){var focusArray=focusTabl.getElementsByTagName(a.focusInfo.tagName);for(i=0;i<focusArray.length;i++)if(focusArray[i].id==a.focusInfo.id){focusBack=focusArray[i];break}}if(focusBack!=null&&focusBack.tagName!="A"){var anchorList=focusBack.getElementsByTagName("A"),anchorListLen=anchorList.length;if(anchorListLen>0)focusBack=anchorList[anchorListLen-1]}if(focusBack!=null)if(typeof focusBack.setActive!="undefined"&&focusBack.setActive!=null)focusBack.setActive();else focusBack.focus!=null&&focusBack.focus();focusAcc=null}b!=null&&a.ctx.IsClientRendering&&SPClientRenderer._ExecuteRenderCallbacks(rCtx,"OnPostRender")}};var h=function(){c.send(e)};if(a.ctx.inGridMode&&!a.ctx.enteringGridMode&&!a.isEcbInfo){ExitGrid(a.ctx.view,true,function(){a.ctx.inGridMode=true;a.ctx.leavingGridMode=false;h()});return}h()}var SPListOperationType;function AnimateListDelta(c,f){var g=g_fAnimateListCSR&&IsVisible(f),d=c.ctxId,h=FetchTableBodies(f),e=h.oldbody,a=h.newbody,b=document.getElementById("scriptPaging"+c.wpq);if(e==null&&a==null)return;if(c.operationType==SPListOperationType.PagingRight||c.operationType==SPListOperationType.PagingLeft)if(g){var i=new SPAnimationUtility.TableAnimator(f);i.AnimatePaging(c.operationType==SPListOperationType.PagingRight,b,function(){FixupTable(null,a,b,d)})}else FixupTable(e,a,b,d);else if(Boolean(a)&&g){var j=new SPAnimationUtility.TableAnimator(f);j.AnimateSort(e,a,function(){FixupTable(null,a,b,d)})}else FixupTable(e,a,b,d);g_fAnimateListCSR=true;return}function FetchTableBodies(c){var a=c.firstChild;while(a!=null&&a.nodeName!="TBODY")a=a.nextSibling;var b;if(a==null)b=null;else if(a.style.display=="none"){b=a;a=null}else b=a.nextSibling;return{oldbody:a,newbody:b}}function IsVisible(a){var b=a.offsetWidth==0||a.offsetHeight==0||a.style.visibility=="hidden";return!b}function FixupTable(a,b,d,e){var c=Boolean(a)?a.parentNode:b.parentNode;if(c!=null&&c.nodeName=="TABLE"){Boolean(a)&&a.nodeName=="TBODY"&&c.removeChild(a);if(Boolean(b)&&b.nodeName=="TBODY")b.style.display="";EnsureSelectionHandler(null,c,e)}if(typeof ProcessImn!="undefined"){imnCount=0;bIMNOnloadAttached=false;ProcessImn()}if(d!=null&&d.style.display=="none")d.style.display=""}function CLVPRefreshCurrent(){var a=ajaxNavigate.get_href();a=FixUrlFromClvp2(this,a,false);return this.RefreshPagingEx(a,false,null,true)}function CLVPGetQueryString(){return this.tab!=null&&this.tab.getAttribute("FilterLink")!=null?this.tab.getAttribute("FilterLink"):ajaxNavigate.get_href()}function CLVPRefreshEcbInfo(b){var a=this.GetQueryString();a=FixUrlFromClvp2(this,a,false);this.isEcbInfo=true;this.strGroupName=b;var c=this;this.RefreshPagingEx(a,false,"EcbView")}function CLVPCacheEcbInfo(c){if(this.ctx.HasRelatedCascadeLists==1&&this.ctx.CascadeDeleteWarningMessage==null){var j="<CascadeDeleteWarningMessage>",k="</CascadeDeleteWarningMessage>";if(c.startsWith(j)){var h=c.indexOf(k);if(h!==-1){this.ctx.CascadeDeleteWarningMessage=c.substring(j.length,h);c=c.substring(h+k.length)}}}var g=document.createElement("DIV");g.innerHTML=c;g.style.display="none";var m=g.getElementsByTagName("TABLE"),a,e,b=null;if(this.strGroupName!=null){var o="ecbtab_ctx"+this.ctx.ctxId;b=document.getElementById(o)}for(e=0;e<m.length;e++){a=m[e];if(this.tab!=null&&a.id==this.tab.id){if(b==null)a.id="ecbtab_ctx"+this.ctx.ctxId;else a.id="ecbtab_ctx"+this.ctx.ctxId+"_"+this.strGroupName;var l=a.rows;l.length>0&&!l[0].className.indexOf("ms-viewheadertr")&&a.deleteRow(0);a.style.display="none";this.tab.appendChild(a);var d;if(b==null)d=[];else d=typeof b.dict=="undefined"?undefined:b.dict;for(var n=a.getElementsByTagName("DIV"),i=0;i<n.length;i++){var f=n[i];if(f.id!="")d[f.id]=f}if(b==null)a.dict=d;this.strGroupName!=null&&this.CacheGroupName(this.strGroupName);break}}if(this.fnEcbCallback!=null&&this.queueEcbInfo.length==0){this.fnEcbCallback();this.fnEcbCallback=null}}function CLVPEnsureEcbInfo(c,f,a){var g="ecbtab_ctx"+this.ctx.ctxId,b=document.getElementById(g);if(b==null&&this.tab!=null&&this.tab.parentNode==null)for(var d=0;d<this.tab.childNodes.length;d++){var e=this.tab.childNodes[d];if(e.id==g)b=e}if(b!=null&&a!=null)if(!this.IsInGroupCache(a))b=null;if(b!=null){typeof c=="function"&&this.NoOutstandingECBRequests()&&c(f);return b}if(c!=null&&this.fnEcbCallback==null)this.fnEcbCallback=function(){c(f)};if(this.isEcbInfo||this.bRequestOutstanding){(!this.isEcbInfo||a!=null&&a!=this.strGroupName)&&this.EnqueueEcbInfoRequest(a);return null}this.RefreshEcbInfo(a);return null}function CLVPInvalidateEcbInfo(){var b="ecbtab_ctx"+this.ctx.ctxId,a=document.getElementById(b);if(a!=null&&a.parentNode!=null){a.parentNode.removeChild(a);this.DeleteGroupNameCache()}}function CLVPGetEcbInfo(b){var a=this.EnsureEcbInfo();if(a!=null)if(typeof a.dict!="undefined"&&a.dict!=null)return a.dict[b];return null}function CLVPEnsureChangeContext(){if(this.cctx==null)this.cctx=new SP.ClientContext(null)}function CLVPDeleteItemCore(c){var g=this.ctx.listBaseType==1;this.EnsureChangeContext();var a=null;if(typeof this.rgehs=="undefined")this.rgehs=[];var b,d;b=new SP.ExceptionHandlingScope(this.cctx);this.rgehs.push(b);d=b.startScope();this.cctx.get_pendingRequest().set_navigateWhenServerRedirect(true);var e=this.cctx.get_web().get_lists().getById(this.ctx.listName);if(this.ctx.ExternalDataList)a=e.getItemById(String(c));else a=e.getItemById(parseInt(c));if(g){a.retrieve("FileLeafRef");b.itmContext=a}var f=this.ctx.RecycleBinEnabled&&!this.ctx.ExternalDataList;if(f)a.recycle();else a.deleteObject();this.changePending=true;d.dispose()}function CLVPCheckoutItem(f,d){this.EnsureChangeContext();if(typeof this.rgehs=="undefined")this.rgehs=[];var a,c,b=null;if(d!="0")return;a=new SP.ExceptionHandlingScope(this.cctx);this.rgehs.push(a);c=a.startScope();b=this.cctx.get_web().get_lists().getById(this.ctx.listName).getItemById(Number(f));b.retrieve("FileLeafRef");a.itmContext=b;var e=b.get_file();e.checkOut();c.dispose();this.changePending=true}function CLVPDiscardCheckoutItem(e,g){this.EnsureChangeContext();if(typeof this.rgehs=="undefined")this.rgehs=[];var b=null,a,f;if(g!="0")return;a=new SP.ExceptionHandlingScope(this.cctx);this.rgehs.push(a);f=a.startScope();b=this.cctx.get_web().get_lists().getById(this.ctx.listName).getItemById(Number(e));b.retrieve("FileLeafRef");a.itmContext=b;var h=b.get_file(),d=this.GetEcbInfo(e);if(d!=null&&d.getAttribute("COut")=="1")try{var i=this.ctx.HttpRoot+d.getAttribute("Url"),c=StsOpenEnsureEx("SharePoint.OpenDocuments.3");c!=null&&typeof c.DiscardLocalCheckout=="function"&&c.DiscardLocalCheckout(i)}catch(j){}else h.undoCheckOut();this.changePending=true;f.dispose()}function CLVPCheckinItem(g,j,a){this.EnsureChangeContext();if(typeof this.rgehs=="undefined")this.rgehs=[];var d=null,c,h;if(j!="0")return;c=new SP.ExceptionHandlingScope(this.cctx);this.rgehs.push(c);h=c.startScope();d=this.cctx.get_web().get_lists().getById(this.ctx.listName).getItemById(Number(g));d.retrieve("FileLeafRef");c.itmContext=d;var f=d.get_file(),e=this.GetEcbInfo(g);if(e!=null&&e.getAttribute("COut")=="1")try{var i=this.ctx.HttpRoot+e.getAttribute("Url"),b=StsOpenEnsureEx("SharePoint.OpenDocuments.3");if(b!=null&&typeof b.CheckinDocument=="function")if(a.kco!=null)b.CheckinDocument(i,a.cit,a.cmt,true);else b.CheckinDocument(i,a.cit,a.cmt)}catch(k){}else{f.checkIn(a.cmt,a.cit);a.kco&&f.checkOut();this.changePending=true}h.dispose()}function CLVPManageCopies(f,e){if(e!="0")return;var b=this.GetEcbInfo(f);if(b!=null&&b.getAttribute("Url")!=null){var d=this.ctx.HttpRoot+"/_layouts/15/managecopies.aspx?ItemUrl="+escapeProperly(b.getAttribute("Url"))+"&Source="+GetSource(),a=window["ctx"+this.ctx.ctxId];if(a!=null&&a.clvp!=null){var c=a.clvp,g=FixUrlFromClvp(c,d);if(FV4UI()){c.ShowPopup(g);return}}STSNavigate(d)}}function CLVPShowErrorDialog(d){var i,a=[],e=null,c=false;for(i in this.rgehs){var b=this.rgehs[i];if(b.get_hasException()&&!(this.ctx.listTemplate==171&&b.get_serverErrorCode()==-2147024809)){var g="s4-dlg-err-itm";if(!c){g="s4-dlg-err-firstitm";c=true;a.push(SP.Res.dlgTitleError)}var k=b.get_errorMessage();a.push('<div class="'+g+'">');if(typeof b.itmContext!="undefined")try{a.push('<div class="s4-dlg-err-itmName">');a.push(b.itmContext.get_item("FileLeafRef"));a.push("</div>")}catch(m){a.push("</div>")}a.push('<div class="s4-dlg-err-itmMsg">');a.push(k);a.push("</div>");a.push("</div>")}}if(c){a.push("<div class='ms-core-form-bottomButtonBox' id='dlgDivButton'><button id='ms-OKBtnDismissDlg' class='ms-ButtonHeightWidth' onclick='DismissErrDlg(this)'>");a.push(SP.Res.okButtonCaption);a.push("</button></div>")}var h=a.join("");if(h.length>0){var f=document.createElement("DIV");f.className="s4-dlg-err";f.innerHTML=h;var j={html:f,title:Strings.STS.L_ErrorDialog_Title,dialogReturnValueCallback:d},l=new SP.UI.ModalDialog.showModalDialog(j);e=document.getElementById("ms-OKBtnDismissDlg");Boolean(e)&&e.focus()}else typeof d=="function"&&d();this.rgehs=[]}function CLVPRefreshInplViewUrl(){this.inplUrl=null;this.inplUrl=this.InplViewUrl();return false}function CLVPInplViewUrl(){if(this.inplUrl!=null)return typeof this.ctx.IsClientRendering!="undefined"&&this.ctx.IsClientRendering&&this.isEcbInfo?this.inplUrl+"&IsRibbon=TRUE":this.inplUrl;var a=[],b=escapeUrlForCallback(this.ctx.HttpRoot);a.push(b);b[b.length-1]!="/"&&a.push("/");a.push("_layouts/15/inplview.aspx?List=");a.push(this.ctx.listName);if(this.ctx.view!=null){a.push("&View=");a.push(this.ctx.view)}a.push("&ViewCount=");a.push(this.ctx.ctxId);typeof this.ctx.isXslView!="undefined"&&this.ctx.isXslView&&a.push("&IsXslView=TRUE");typeof this.ctx.IsClientRendering!="undefined"&&this.ctx.IsClientRendering&&a.push("&IsCSR=TRUE");typeof this.ctx.overrideSelectCommand!="undefined"&&a.push("&HasOverrideSelectCommand=TRUE");var c=null;if(typeof this.ctx.overrideFilterQstring!="undefined")c=this.ctx.overrideFilterQstring.match(RegExp("OverrideScope=[^&]*"));typeof this.ctx.overrideScope!="undefined"&&c==null&&a.push("&OverrideScope="+this.ctx.overrideScope);if(typeof this.ctx.overrideFilterQstring!="undefined"){a.push("&");a.push(this.ctx.overrideFilterQstring)}if(typeof this.ctx.IsClientRendering!="undefined"&&!this.ctx.IsClientRendering){a.push("&ListViewPageUrl=");var d=new URI(ajaxNavigate.get_href(),{disableEncodingDecodingForLegacyCode:true});a.push(escapeProperlyCore(d.getStringWithoutQueryAndFragment(),false))}if(typeof this.ctx.searchTerm!="undefined"&&this.ctx.searchTerm!=null){a.push("&InplaceSearchQuery=");a.push(escapeProperlyCore(this.ctx.searchTerm,true))}typeof this.ctx.fullListSearch!="undefined"&&this.ctx.fullListSearch!=null&&this.ctx.fullListSearch==true&&a.push("&InplaceFullListSearch=true");this.inplUrl=a.join("");delete a;return typeof this.ctx.IsClientRendering!="undefined"&&this.ctx.IsClientRendering&&this.isEcbInfo?this.inplUrl+"&IsRibbon=TRUE":this.inplUrl}function CLVPInplViewUrlTrim(a){var b="";if(Boolean(a))if(typeof this.ctx.overrideFilterQstring!="undefined")b=a.substr(this.InplViewUrl().length-this.ctx.overrideFilterQstring.length);else b=a.substr(this.InplViewUrl().length+1);return b}function CLVPInplViewUrlHash(b){var a=this.InplViewUrlTrim(b);a=EncodeQueryStringAsHash(a);return a}function CLVPShowPopup(a){MenuHtc_hide();if(typeof this.fnOnCommitPopup!="undefined"&&this.fnOnCommitPopup!=null)OpenPopUpPage(a,this.fnOnCommitPopup);else OpenPopUpPage(a,RefreshPage);return false}function CLVPIsInGroupCache(a){return this.strGroupCache==null?false:this.strGroupCache.indexOf(a+"$")!=-1}function CLVPCacheGroupName(a){if(this.strGroupCache==null)this.strGroupCache=a+"$";else this.strGroupCache=this.strGroupCache+a+"$"}function CLVPDeleteGroupNameCache(){if(this.strGroupCache==null)return;var b=0,a;a=this.strGroupCache.indexOf("$",b);while(a!=-1){var d=this.strGroupCache.substring(b,a),e="ecbtab_ctx"+this.ctx.ctxId+"_"+d,c=document.getElementById(e);Boolean(c)&&this.tab.removeChild(c);b=a+1;a=this.strGroupCache.indexOf("$",b)}this.strGroupCache=null}function CLVPEnqueueEcbInfoRequest(b){for(var a=0;a<this.queueEcbInfo.length;a++)if(this.queueEcbInfo[a]==b)return;this.queueEcbInfo.push(b)}function CLVPNoOutstandingECBRequests(){return this.isEcbInfo?false:this.queueEcbInfo.length>0?false:true}function SetFocusBack(e){if(e==0||focusAcc!=null&&focusAcc.focusInCLVPTab!=null&&focusAcc.focusInCLVPTab!=true){var a=null;if(focusAcc!=null&&focusAcc.elem!=null)a=focusAcc.elem;if(a!=null&&a.tagName!="A"){var d=a.getElementsByTagName("A"),b=d.length;if(b>0)a=d[b-1]}if(a!=null&&typeof a.setActive!="undefined")try{if(a.setActive!=null)a.setActive();else a.focus!=null&&a.focus()}catch(f){}else if(typeof SP.Ribbon!="undefined"&&Boolean(SP.Ribbon)&&Boolean(SP.Ribbon.PageManager)&&focusAcc!=null&&focusAcc.fromRibbon){var c=SP.Ribbon.PageManager.get_instance();c.get_ribbon()!=null&&c.restoreFocusToRibbon()}focusAcc=null}}function ExpColGroupScripts(c){var d=[],e=/<script type="text\/javascript">ExpCollGroup\('[^']*',\s*'[^']*'\);<\/script>/g,b=e.exec(c);while(b!=null){var a=b[0],g=a.indexOf("ExpCollGroup"),f=a.indexOf(";");d.push(a.substring(g,f+1));b=e.exec(c)}return d}function InitCLVPs(){if(typeof g_ViewIdToViewCounterMap!="undefined"){var b;for(b in g_ViewIdToViewCounterMap){var a=window["ctx"+g_ViewIdToViewCounterMap[b]];if(Boolean(a)){var c=new CLVP(a);c.Init()}}}}function CLVPFromCtx(a){return typeof a.clvp!="undefined"?a.clvp:null}function CLVPFromEventReal(b){if(b==null)return null;if(typeof b.currentCtx!="undefined"&&Boolean(b.currentCtx))return CLVPFromCtx(b.currentCtx);var n=GetEventSrcElement(b),a=null,d=null,j=null,h=GetEventPopup(b);if(h!=null){if(typeof b.currentCtx!="undefined"&&b.currentCtx!=null){var l=b.currentCtx,m=window["ctx"+l.ctxId];return CLVPFromCtx(m)}if(typeof currentCtx!="undefined"&&currentCtx!=null)return CLVPFromCtx(currentCtx);if(typeof ctxFilter!="undefined"&&ctxFilter!=null)return CLVPFromCtx(ctxFilter);var e=typeof h.master!="undefined"?h.master:null;if(e==null)return null;if(e.id!=null&&e.id.indexOf("onetViewSelector_menu")>0){var o=e.id.substr(0,e.id.indexOf("onetViewSelector_menu")+16);a=GetAncestor(document.getElementById(o),"TABLE")}else a=GetAncestor(e,"TABLE")}else a=GetAncestor(n,"TABLE");while(a!=null){if(a.className=="ms-menutoolbar")break;if(a.className=="ms-listviewtable"){d=a;a=null;break}else if(a.className=="ms-bottompaging"){if(a.previousSibling==null)a=a.parentNode.previousSibling;else a=a.previousSibling;if(a==null)break;for(var g=a.getElementsByTagName("TABLE"),f=0;f<g.length;f++)if(g[f].className=="ms-listviewtable"){a=g[f];break}continue}a=a.parentNode;if(a!=null)a=GetAncestor(a,"TABLE")}if(a==null&&d==null)return null;if(d==null){var c=a.nextSibling;while(c!=null&&(c.nodeType!=1||c.tagName!="TABLE"))c=c.nextSibling;if(c==null)return null;var k=c.getElementsByTagName("TABLE");if(k.length==0)return null;d=k[0]}var i=CLVPFromCtx(d);if(i==null&&c!=null){j=c.getElementsByTagName("DIV");if(j.length==0)return null;d=j[0];i=CLVPFromCtx(d)}return i}function SetUrlKeyValue(b,e,f,a){if(a==null)a=window.location.href+"";var c=e,d=new URI(a,{disableEncodingDecodingForLegacyCode:true});a=d.getQuery();if(f)c=escapeProperly(c);if(a.indexOf(b+"=")<0){if(a.length>1)a+="&";else if(a.length==0)a+="?";a+=b+"="+c}else{var g=new RegExp(b+"=[^&]*");a=a.replace(g,b+"="+c)}d.setQuery(a);return d.getString()}function FixUrlFromClvp(a,b){return FixUrlFromClvp2(a,b,true)}function FixUrlFromClvp2(c,a,d){var b=c.rootFolder;if((b==null||b.length==0)&&c.rgpaging==null)return a;if(b!=null&&b.length>0)if(a.toUpperCase().indexOf("LISTEDIT.ASPX")==-1)a=SetUrlKeyValue("RootFolder",b,true,a);if(d){var e=GetSource2(null,c);a=SetUrlKeyValue("Source",e,true,a)}return a}function STSNavigateToViewReal(b,a){STSNavigate(a);return true}function STSNavigate2Real(b,a){STSNavigate(a);return true}function GetSource2(c,b,e){var a=GetUrlKeyValue("Source");if(a=="")if(c!=null&&c!="")a=c;else a=ajaxNavigate.get_href();if(b==null&&typeof currentCtx!="undefined"&&currentCtx!=null&&currentCtx.clvp!=null)b=currentCtx.clvp;if(b!=null&&(b.rootFolder!=null||b.rgpaging!=null))if(a!=""){if(b.rootFolder!=null&&b.rootFolder!="")a=SetUrlKeyValue("RootFolder",b.rootFolder,true,a);if(b.rgpaging!=null&&(!(b.ctx!=null&&b.ctx.IsClientRendering)||e)){var d;for(d in b.rgpaging)a=SetUrlKeyValue(d,b.rgpaging[d],false,a);if(b.rgpaging.PagedPrev==null){a=RemoveUrlKeyValue("PagedPrev",a);a=RemoveUrlKeyValue("PageLastRow",a)}if(b.rgpaging.PageFirstRow==null)a=RemoveUrlKeyValue("PageFirstRow",a)}}return STSPageUrlValidation(a)}function FindClvp(b){var a=b;while(a!=null){if(a.tagName=="TABLE")if(a.clvp!=null)break;a=a.parentNode}return a!=null?a.clvp:null}function getFilterQueryParam(d){if(d==null||d=="")return"";var c="",b=0,a;do{b++;a=d.match(RegExp("FilterField"+String(b)+"=[^&]*&FilterValue"+String(b)+"=[^&]*"));if(a!=null)c=c+"&"+a[0]}while(a!=null);b=0;do{b++;a=d.match(RegExp("FilterFields"+String(b)+"=[^&]*&FilterValues"+String(b)+"=[^&]*"));if(a!=null)c=c+"&"+a[0]}while(a!=null);b=0;do{b++;a=d.match(RegExp("FilterOp"+String(b)+"=[^&]*&FilterLookupId"+String(b)+"=[^&]*&FilterData"+String(b)+"=[^&]*"));if(a!=null)c=c+"&"+a[0]}while(a!=null);return c}function OnClickFilterV4(e){var d=FindSTSMenuTable(e,"CTXNum"),c=FindClvp(e);if(d!=null&&d.getAttribute("SortFields")!=null){if(c!=null)c.ctx.operationType=SPListOperationType.Sort;var b=d.getAttribute("SortFields");if(b.indexOf("?")>0)b=b.substr(b.indexOf("?")+1);var a=GetUrlWithNoSortParameters(b);a=RemovePagingArgs(a);if(a.indexOf("?")<0)a+="?";else a+="&";a=a+b;if(c!=null)a+=getFilterQueryParam(c.ctx.queryString);if(c!=null&&c.ctx.IsClientRendering){if(c.rootFolder!=null)a=SetUrlKeyValue("RootFolder",c.rootFolder,true,a);c.ctx.queryString=a;c.RefreshPaging(a);if(b.substring(b.length-3)=="Asc")d.setAttribute("SortFields",b.substring(0,b.length-3)+"Desc");else d.setAttribute("SortFields",b.substring(0,b.length-4)+"Asc")}else SubmitFormPost(a)}return false}function HandleFilterReal(e,c,d){var a=CLVPFromEvent(e);if(a!=null&&a.ctx!=null)a.ctx.operationType=d;if(a==null||a.ctx==null||!a.ctx.IsClientRendering){SubmitFormPost(c);return false}var b=a.ctx;if(b!=null&&b.ListSchema!=null&&b.ListData!=null&&(b.ListSchema.Filter=="1"||Boolean(b.ListData.FilterLink))&&c.indexOf("&FilterClear=1")>0){SubmitFormPost(c);return false}a.RefreshPaging(c);a.ctx.queryString=c;return true}function RefreshInplViewUrlByContext(a){var b=CLVPFromCtx(a);return RefreshInplViewUrlInternal(b)}function RefreshInplViewUrl(b){var a=CLVPFromEvent(b);return RefreshInplViewUrlInternal(a)}function RefreshInplViewUrlInternal(a){return a==null?false:a.RefreshInplViewUrl()}function CancelRefreshViewByContext(a){var b=CLVPFromCtx(a);return CancelRefreshViewInternal(b)}function CancelRefreshView(b){var a=CLVPFromEvent(b);return CancelRefreshViewInternal(a)}function CancelRefreshViewInternal(a){return a==null?false:a.CancelAnyOutstandingRequest()}function HandleRefreshViewByContext(b){var a=CLVPFromCtx(b);if(a==null)return false;HandleRefreshViewInternal(a);return false}function HandleRefreshView(b){var a=CLVPFromEvent(b);if(a==null)return false;HandleRefreshViewInternal(a);return false}function HandleRefreshViewInternal(a){var b=a.ctx.queryString,c=a.ctx;b=FixUrlFromClvp2(a,b,false);if(c==null||!c.IsClientRendering){SubmitFormPost(b);return}a.RefreshPaging(b)}function InitAllClvps(){InitCLVPs()}function FixDroppedOrPastedClvps(){if(typeof g_ViewIdToViewCounterMap!="undefined"){var c;for(c in g_ViewIdToViewCounterMap){var b=window["ctx"+g_ViewIdToViewCounterMap[c]];if(Boolean(b)){var a=b.clvp;if(Boolean(a)&&(!Boolean(a.tab)||!Boolean(a.tab.parentNode)||1!=a.tab.parentNode.nodeType)){a=new CLVP(b);a.Init()}}}}}function FocusInfo_InitializePrototype(){FocusInfo.prototype={elem:null,id:null,tagName:null,focusInCLVPTab:null,fromRibbon:undefined,setActive:undefined}}function FocusInfo(){}var focusAcc;function GetFocusInfo(b,j){var c=new FocusInfo;c.fromRibbon=typeof b.fromRibbon!="undefined"?b.fromRibbon:undefined;var a=null;if(Boolean(b.target))a=b.target;else if(Boolean(b.srcElement))a=b.srcElement;if(typeof b.fakeEvent!="undefined"&&b.fakeEvent){if(typeof a.master!="undefined"&&a.master!=null&&typeof a.master._oParent!="undefined")a=a.master._oParent;if(a!=null&&a.tagName!="A")a=a.getElementsByTagName("A")[0]}else if(Boolean(b.fromRibbon)!=true)while(a.tagName!="A"&&a.tagName!="BODY")a=a.parentNode;var e=null;if(a!=null){while(a.id.length==0&&a.tagName!="BODY")a=a.parentNode;e=a.id}var d=null;if(a!=null)d=a.tagName;var h=false,f=null;if(j!=null)f=j.tab;if(f!=null&&d!=null&&e!=null)for(var i=f.getElementsByTagName(d),g=0;g<i.length;g++)if(i[g].id==e){h=true;break}c.elem=a;c.id=e;c.tagName=d;c.focusInCLVPTab=h;focusAcc=c}function ExpGroup(h,c){var b=document.getElementById("tbod"+c+"_");if(b!=null)var d=GetAncestor(b,"TABLE");if(b==null||b.tagName!="TBODY"||d==null||typeof d.clvp=="undefined"||d.clvp==null||b.getAttribute("isLoaded")==null)return;var g=c.substring(0,c.indexOf("-")),e=document.getElementById("GroupByCol"+g),a="?";if(e!=null){a=e.getAttribute("queryString");if(a.substring(a.length-1)=="&")a=a.substr(0,a.length-1)}a=RemoveOnlyPagingArgs(a);a+="&GroupString=";a+=ExpGroupFetchGroupString(c);a+="&IsGroupRender=TRUE";var f=d.clvp;f.tBody=b;f.RefreshPaging(a,null)}function DeleteSelectedItemsCore(a,e,h,l){var f=e.length,b=a.clvp;if(f>0){if(ContainsRecurrenceItem(e))return;var d=Strings.STS.L_STSRecycleConfirm_Text;if(!a.RecycleBinEnabled||a.ExternalDataList)d=Strings.STS.L_STSDelConfirm_Text;if(a.overrideDeleteConfirmation!=null)d=a.overrideDeleteConfirmation;if(Boolean(a.HasRelatedCascadeLists)&&a.CascadeDeleteWarningMessage!=null)d=a.CascadeDeleteWarningMessage+d;if(Boolean(a.HasRelatedCascadeLists)&&a.listTemplate==171){var g=false,c=0;if(a.inGridMode){var m=window[g_SPGridInitInfo[a.view].controllerId];for(c=0;c<f;c++)if(m.IsParent(e[c])){g=true;break}}else{var j=GetClientHierarchyManagerForWebpart!=null?GetClientHierarchyManagerForWebpart(a.wpq):null;if(j!=null)for(c=0;c<f;c++)if(j.IsParent(e[c])){g=true;break}}d=g?Strings.STS.L_STSDelConfirmParentTask:Strings.STS.L_STSDelConfirm_Text}if(!confirm(d))return}for(var i=0;i<f;i++){var o=e[i];b.DeleteItemCore(String(o))}b.pendingItems=[];if(f>0){var n=Strings.STS.L_Notification_Delete,k=addNotification(n,true);b.cctx.executeQueryAsync(function(){if(typeof b.rgehs!="undefined"){if(b.rgehs.length==1&&b.rgehs[0].get_serverErrorCode()==SP.ClientErrorCodes.redirect){GoToPage(b.rgehs[0].get_serverErrorValue());return}removeNotification(k);b.ShowErrorDialog(h)}else h!=null&&h()},function(){removeNotification(k);typeof b.rgehs!="undefined"&&b.ShowErrorDialog(l)})}}function DeleteSelectedItems(a){a=FixupCtx(a);var c=GetSelectedItemsDict(a),b=[];for(var e in c){var d=c[e];b.push(d.id)}b.length>0&&DeleteSelectedItemsCore(a,b,RefreshOnDialogClose)}function ContainsRecurrenceItem(c){for(var d in c){var a=c[d];if(Boolean(a)&&typeof a.id!="undefined"&&Boolean(a.id)){var b=a.id;if(b.indexOf(".0.")!=-1||b.indexOf(".1.")!=-1||b.indexOf(".2.")!=-1)return true}}return false}function CheckOutSingleItem(b,c){b=FixupCtx(b);var f=GetAttributeFromItemTable(c,"Url","ServerUrl"),d=GetAttributeFromItemTable(c,"Icon","DocIcon").split("|"),a=null;if(d.length>=3)a=d[2];if(a=="SharePoint.OpenDocuments")a="SharePoint.OpenDocuments.3";var g=addNotification(Strings.STS.L_Notification_CheckOut,true,null,null,true),e=CheckoutDocument(b.HttpRoot,f,a);!e&&removeNotification(g,true)}function FixupCtx(a){if(Boolean(a)&&typeof a.clvp=="undefined"&&typeof a.ctxId!="undefined"){var b=window["ctx"+a.ctxId];if(b)return b}return a}function CheckInSingleItemFromECB(c,a,d){a=FixupCtx(a);var b=a.clvp;GetFocusInfo(c,b);CheckInSingleItem(a,d)}function CheckInSingleItem(b,d){var a=GetAttributeFromItemTable(d,"Url","ServerUrl");if(a!=null)a=escapeProperly(unescapeProperly(a));var c=b.HttpRoot+"/_layouts/15/checkin.aspx?List="+b.listName+"&FileName="+a;OpenPopUpPage(c,CheckInNotifyAndRefreshPage)}function CheckInNotifyAndRefreshPage(a){if(a==SP.UI.DialogResult.OK){var b=Strings.STS.L_Notification_CheckIn;addNotification(b,true)}RefreshPage(a)}function AttachFile(a){var g=a.clvp,b=GetSelectedItemsDict(a),f=CountDictionary(b),c,e;if(f==1)for(e in b){c=b[e];if(c.fsObjType=="0"){var d=a.HttpRoot+"/_layouts/15/AttachFile.aspx?ListId="+a.listName+"&ItemId="+c.id+"&Source="+GetSource();if(FV4UI())OpenPopUpPage(d,RefreshPage);else GoToPage(d)}}}function ManageCopies(c){var e=c.clvp,a=GetSelectedItemsDict(c),f=CountDictionary(a),b,d;if(f==1)for(d in a){b=a[d];e.ManageCopies(b.id,b.fsObjType)}}function CheckoutSelectedItems(d){var a=d.clvp,c=GetSelectedItemsDict(d),h=CountDictionary(c),b,e;if(h==1)for(e in c){b=c[e];var f=a.GetEcbInfo(b.id);if(f==null)FetchEcbInfo(d,b.id,"DIV",CheckOutSingleItem);else CheckOutSingleItem(d,f);return}if(!confirm(Strings.STS.L_CheckoutConfirm))return;for(e in c){b=c[e];a.CheckoutItem(b.id,b.fsObjType)}if(h>0){var i=Strings.STS.L_Notification_CheckOut,g=addNotification(i,true);a.cctx.executeQueryAsync(function(){if(typeof a.rgehs!="undefined"){removeNotification(g);a.ShowErrorDialog(RefreshOnDialogClose)}else RefreshPage(SP.UI.DialogResult.OK)},function(){removeNotification(g);typeof a.rgehs!="undefined"&&a.ShowErrorDialog()})}}function DiscardCheckoutSelectedItems(b){b=FixupCtx(b);var a=b.clvp,c=GetSelectedItemsDict(b),h=CountDictionary(c),d,f;if(!confirm(Strings.STS.L_DiscardCheckoutConfirm))return;for(f in c){d=c[f];a.DiscardCheckoutItem(d.id,d.fsObjType)}if(h>0){var g=Strings.STS.L_Notification_DiscardCheckOut,e=addNotification(g,true);a.cctx.executeQueryAsync(function(){if(typeof a.rgehs!="undefined"){removeNotification(e);a.ShowErrorDialog(RefreshOnDialogClose)}else RefreshPage(SP.UI.DialogResult.OK)},function(){removeNotification(e);typeof a.rgehs!="undefined"&&a.ShowErrorDialog()})}}function CheckinSelectedItems(d){var a=d.clvp,b=[],c=GetSelectedItemsDict(d),k=CountDictionary(c),e,h;if(k==1)for(h in c){e=c[h];var g=a.GetEcbInfo(e.id);if(g==null)FetchEcbInfo(d,e.id,"DIV",CheckInSingleItem);else CheckInSingleItem(d,g);return}var f=a.ctx.HttpRoot;b.push(f);f[f.length-1]!="/"&&b.push("/");b.push("_layouts/15/checkin.aspx?List=");b.push(a.ctx.listName);b.push("&IsBulk=1");var i=function(g){var f,e=0;for(f in c){var b=c[f];a.CheckinItem(b.id,b.fsObjType,g);e++}if(e>0){var h=Strings.STS.L_Notification_CheckIn,d=addNotification(h,true);a.cctx.executeQueryAsync(function(){if(typeof a.rgehs!="undefined"){removeNotification(d);a.ShowErrorDialog(RefreshOnDialogClose)}else RefreshPage(SP.UI.DialogResult.OK)},function(){removeNotification(d);typeof a.rgehs!="undefined"&&a.ShowErrorDialog()})}},j=function(b,c){if(b==SP.UI.DialogResult.OK)a.EnsureEcbInfo(i,c,null);else RefreshPage(b)};OpenPopUpPage(b.join(""),j)}function CLVPModerateItem(e,c){this.EnsureChangeContext();if(typeof this.rgehs=="undefined")this.rgehs=[];var b,d,a=null;b=new SP.ExceptionHandlingScope(this.cctx);this.rgehs.push(b);d=b.startScope();a=this.cctx.get_web().get_lists().getById(this.ctx.listName).getItemById(Number(e));b.itmContext=a;a.set_item("_ModerationStatus",c.ModerationStatus);a.set_item("_ModerationComments",c.Comment);a.update();this.cctx.load(a);d.dispose();this.changePending=true}function ModerateSelectedItems(i){var a=i.clvp,c=[],b=GetSelectedItemsDict(i),m=CountDictionary(b),d,e,g=a.ctx.HttpRoot;c.push(g);g[g.length-1]!="/"&&c.push("/");c.push("_layouts/15/approve.aspx?List=");c.push(a.ctx.listName);var f=false;if(m==1)for(e in b){d=b[e];c.push("&ID="+d.id);break}else{c.push("&IsBulk=1");f=true}var j=function(c){var f,e=0;for(f in b){var g=b[f];ULS.AssertJS(ULSCat.msoulscat_WSS_Inplview,c!=null&&c!="","Null or empty parameter to deserialize");try{a.ModerateItem(g.id,SP_JSONParse(c));e++}catch(i){ULS.SendExceptionJS(ULSCat.msoulscat_WSS_Inplview,i)}}if(e>0){var h=Strings.STS.L_Notification_Moderate,d=addNotification(h,true);a.cctx.executeQueryAsync(function(){if(typeof a.rgehs!="undefined"){removeNotification(d);a.ShowErrorDialog(RefreshOnDialogClose)}else RefreshPage(SP.UI.DialogResult.OK)},function(){removeNotification(d);typeof a.rgehs!="undefined"&&a.ShowErrorDialog()})}},l=function(b,c){if(b==SP.UI.DialogResult.OK&&f)a.EnsureEcbInfo(j,c,null);else RefreshPage(b)},h={};for(e in b){d=b[e];h[d.id]=d.id}var k={url:c.join(""),dialogReturnValueCallback:l,args:h,delayAppearance:f,autoSize:true};OpenPopUpPageWithDialogOptions(k)}function DismissErrDlg(){var a=typeof window.top.g_childDialog!="undefined"?window.top.g_childDialog:undefined;Boolean(a)&&a.close(0)}function CanNavigateUp(a){if(a==null||a.clvp==null)return false;var b=unescapeProperly(GetRootFolder2(a));return b==null||b==unescapeProperly(a.listUrlDir)?false:true}function NavigateUp(c){if(!CanNavigateUp(c))return;var b=unescapeProperly(GetRootFolder2(c));if(b==null)return;var e=b.lastIndexOf("/"),d="";if(e>0)d=b.substr(0,e);else return;var a=ajaxNavigate.get_href(),f=c.view;a=RemoveParametersFromUrl(a);a=SetUrlKeyValue("RootFolder",d,true,a);a=SetUrlKeyValue("View",f,false,a);_SubmitFormPost(a)}function EnumCLVPs(callback){var fRet=false;if(typeof g_ViewIdToViewCounterMap!="undefined"){var vid;for(vid in g_ViewIdToViewCounterMap){var ctxT;eval("ctxT = ctx"+g_ViewIdToViewCounterMap[vid]+";");var clvp=ctxT.clvp;if(clvp!=null){callback(clvp);fRet=true}}}return fRet}function RestoreClvpNavigation(a){a.RestoreNavigation()}function RestoreAllClvpsNavigation(){EnumCLVPs(RestoreClvpNavigation)}var inplview;function CompareUrls(a,b){return typeof a=="undefined"||a==null||typeof b=="undefined"||b==null?false:browseris.firefox?CompleteDecode(a)==CompleteDecode(b):a==b}function MergeListData(a,b){for(var c in b.Row){var e=false;for(var d in a.Row)if(b.Row[c].ID==a.Row[d].ID){e=true;m$.extend(a.Row[d],b.Row[c]);continue}!e&&a.Row.push(b.Row[c])}return a}function CanSupportRoamingApps(){return browseris.win&&!browseris.armProcessor&&(browseris.ie||browseris.firefox3up||browseris.chrome)}$_global_inplview();