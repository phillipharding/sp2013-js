function $_global_groupeditempicker(){MasterGroup.prototype={data:undefined,addControl:undefined,alwaysAllowDelete:undefined,candidateControl:undefined,descriptionControl:undefined,groupControl:undefined,initialSelection:undefined,removeControl:undefined,resultControl:undefined,selectionField:undefined};typeof Sys!="undefined"&&Sys!=null&&typeof Sys.Application!="undefined"&&Sys.Application!=null&&typeof Sys.Application.notifyScriptLoaded!="undefined"&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs=="function"&&NotifyScriptLoadedAndExecuteWaitingJobs("groupeditempicker.js")}function ULSEeZ(){var a={};a.ULSTeamName="Microsoft SharePoint Foundation";a.ULSFileName="groupeditempicker.commentedjs";return a}function MasterGroup(){}function GipNewOption(a,c){a:;var b=new Option(a,c);b.title=a;return b}function GipInitializeGroup(a,d,f,j,c,k,i,l,g,e,n,h,m){a.data=GipGetGroupData(document.getElementById(l).value);a.initialSelection=GipGetSelectionData(document.getElementById(g).value);if(m)a.currentSelection=a.initialSelection;else a.currentSelection=GipGetSelectionData(document.getElementById(e).value);if(d!=null&&d!="")a.groupControl=document.getElementById(d);else a.groupControl=null;a.candidateControl=document.getElementById(f);a.resultControl=document.getElementById(j);if(c!=null&&c!="")a.descriptionControl=document.getElementById(c);else a.descriptionControl=null;a.addControl=document.getElementById(k);a.removeControl=document.getElementById(i);a.selectionField=document.getElementById(e);for(var b=0;b<a.currentSelection.length;b++)a.resultControl.options[b]=GipNewOption(a.currentSelection[b][1],a.currentSelection[b][0]);if(a.groupControl!=null){for(b=0;b<a.data.length;b++)a.groupControl.options[b]=GipNewOption(a.data[b][0],b);if(a.groupControl.options.length>0)a.groupControl.options[0].selected=true}GipRefreshGroupCore(a);a.removeControl.disabled=true;if(h){a.alwaysAllowDelete=true;GipSetHiddenControlValue(a)}else a.alwaysAllowDelete=false}function GipRefreshGroup(master){var handler;if(master.groupControl!=null){handler=master.groupControl.getAttribute("onbeforeselect");if(handler!=null&&handler!="")if(!eval(handler+"(master)"))return}GipRefreshGroupCore(master);if(master.groupControl!=null){handler=master.groupControl.getAttribute("onafterselect");if(handler!=null&&handler!="")eval(handler+"(master)")}}function GipRefreshGroupCore(a){if(a.data.length==0)return;var b=0;if(a.groupControl!=null)b=a.groupControl.selectedIndex;for(var d=0,c=1;c<a.data[b].length;c++){for(var f=false,e=0;e<a.resultControl.length;e++)if(a.data[b][c][0]==a.resultControl[e].value)f=true;if(!f){a.candidateControl.options[d]=GipNewOption(a.data[b][c][1],a.data[b][c][0]);d++}}a.candidateControl.length=d;if(a.candidateControl.options.length>0){a.candidateControl.options[0].selected=true;a.addControl.disabled=false;GipDisplayDescription(a)}else{a.addControl.disabled=true;GipSetDescriptionText(a," ")}}function GipSetHiddenControlValue(b){for(var a="",c=0;c<b.resultControl.options.length;c++){if(a!="")a=a+"|t";a=a+b.resultControl.options[c].value.replace(/\x7C/g,"||");a=a+"|t";a=a+b.resultControl.options[c].text.replace(/\x7C/g,"||")}b.selectionField.value=a}function GipAddSelectedItems(master){var handler=master.addControl.getAttribute("onbeforeadd");if(handler!=null&&handler!="")if(!eval(handler+"(master)"))return;var needToAdjustResultBox=false;if(master.resultControl.offsetWidth<master.candidateControl.offsetWidth)needToAdjustResultBox=true;for(var dirty=false,pos=-1,i=0;i<master.candidateControl.options.length;i++)if(master.candidateControl.options[i].selected){if(!dirty)pos=master.resultControl.length;master.resultControl.options[master.resultControl.length]=GipNewOption(master.candidateControl.options[i].text,master.candidateControl.options[i].value);master.candidateControl.options[i]=null;dirty=true;i--}if(dirty){GipSetHiddenControlValue(master);if(pos>=0){master.resultControl.options[pos].selected=true;GipSelectResultItems(master)}}handler=master.addControl.getAttribute("onafteradd");if(handler!=null&&handler!="")eval(handler+"(master)")}function GipRemoveSelectedItems(master){var handler=master.removeControl.getAttribute("onbeforeremove");if(handler!=null&&handler!="")if(!eval(handler+"(master)"))return;var needToAdjustCandidateBox=false;if(master.resultControl.offsetWidth>master.candidateControl.offsetWidth)needToAdjustCandidateBox=true;for(var dirty=false,id=null,i=0;i<master.resultControl.options.length;i++)if(master.resultControl.options[i].selected){for(var found=false,n=0;!master.alwaysAllowDelete&&n<master.initialSelection.length;n++)if(master.resultControl.options[i].value==master.initialSelection[n][0])found=true;if(!found){dirty=true;id=master.resultControl.options[i].value;master.resultControl.options[i]=null;i--}}if(dirty){GipSetHiddenControlValue(master);GipRefreshGroupCore(master);master.removeControl.disabled=true;for(i=0;i<master.candidateControl.options.length;i++)if(master.candidateControl.options[i].value==id){master.candidateControl.selectedIndex=i;GipSelectCandidateItems(master);break}}handler=master.removeControl.getAttribute("onafterremove");if(handler!=null&&handler!="")eval(handler+"(master)")}function GipSelectCandidateItems(master){var handler=master.candidateControl.getAttribute("onbeforeselect");if(handler!=null&&handler!="")if(!eval(handler+"(master)"))return;master.resultControl.selectedIndex=-1;master.removeControl.disabled=true;master.addControl.disabled=false;GipDisplayDescription(master);handler=master.candidateControl.getAttribute("onafterselect");if(handler!=null&&handler!="")eval(handler+"(master)")}function GipSelectResultItems(master){var handler=master.resultControl.getAttribute("onbeforeselect");if(handler!=null&&handler!="")if(!eval(handler+"(master)"))return;for(var count=0,found=false,i=0;i<master.resultControl.length;i++)if(master.resultControl.options[i].selected){count++;for(var n=0;!master.alwaysAllowDelete&&n<master.initialSelection.length;n++)if(master.resultControl.options[i].value==master.initialSelection[n][0]){found=true;break}}if(found||count<=0)master.removeControl.disabled=true;else master.removeControl.disabled=false;master.candidateControl.selectedIndex=-1;master.addControl.disabled=true;GipDisplayDescription(master);handler=master.resultControl.getAttribute("onafterselect");if(handler!=null&&handler!="")eval(handler+"(master)")}function GipSplit(b){if(b.length==0)return[];for(var c=[],d=-2,h=/\|\|/g,a=0;a<b.length-1;a++){var f=b.charAt(a),g=b.charAt(a+1);if(f=="|"&&g=="t"&&e(b,a)){c[c.length]=b.substring(d+2,a).replace(h,"|");d=a}}c[c.length]=b.substring(d+2);return c;function e(b,a){a:;if(b==null||b==""||a<0)return false;var c=0;while(a>0&&b[a--]=="|")c++;return c%2==1}}function GipGetGroupData(f){a:;for(var b=GipSplit(f),c=[],a=0;a<b.length;a+=4){var e=a-4;if(a==0||b[a+3]!=b[e+3])c[c.length]=new Array(b[a+3]);var d=c[c.length-1];d[d.length]=[b[a+0],b[a+1],b[a+2]]}return c}function GipGetSelectionData(d){a:;for(var c=GipSplit(d),b=[],a=0;a<c.length;a+=2)b[b.length]=[c[a+0],c[a+1]];return b}function GipIsIE(){a:;return navigator.appVersion.indexOf("MSIE")!=-1?true:false}function GipSetDescriptionText(a,b){if(a.descriptionControl!=null)a.descriptionControl.innerHTML=b}function GipDisplayDescription(a){var d,b;if(a.candidateControl.selectedIndex>=0){var g=0;if(a.groupControl!=null)g=a.groupControl.selectedIndex;var e=a.data[g];d=a.candidateControl.options[a.candidateControl.selectedIndex].value;for(b=1;b<e.length;b++)if(e[b][0]==d){GipSetDescriptionText(a,e[b][2]);break}}else if(a.resultControl.selectedIndex>=0){d=a.resultControl.options[a.resultControl.selectedIndex].value;for(b=0;b<a.data.length;b++){for(var f=false,c=1;c<a.data[b].length;c++)if(a.data[b][c][0]==d){GipSetDescriptionText(a,a.data[b][c][2]);f=true;break}if(f)break}}}function GixInitializeGroup(a,h,g,e,i,f){a.data=GipGetGroupData(document.getElementById(i).value);a.currentSelection=GipGetSelectionData(document.getElementById(f).value);a.groupControl=document.getElementById(h);a.candidateControl=document.getElementById(g);if(e!=null&&e!="")a.descriptionControl=document.getElementById(e);a.selectionField=document.getElementById(f);for(var b=0;b<a.data.length;b++)a.groupControl.options[b]=GipNewOption(a.data[b][0],b);var c;c=false;for(b=0;!c&&b<a.data.length;b++)for(var d=1;!c&&d<a.data[b].length;d++)if(a.data[b][d][0]==a.selectionField.value){c=true;a.groupControl.options[b].selected=true;GixRefreshGroup(a);a.candidateControl.options[d-1].selected=true;GixSelectItem(a);break}if(!c){if(a.groupControl.options.length>0)a.groupControl.options[0].selected=true;GixRefreshGroup(a)}}function GixRefreshGroup(a){if(a.groupControl.options.length==0)return;var c=a.groupControl.selectedIndex;a.candidateControl.length=0;for(var b=1;b<a.data[c].length;b++)a.candidateControl.options[a.candidateControl.options.length]=GipNewOption(a.data[c][b][1],a.data[c][b][0]);if(a.candidateControl.options.length>0){a.candidateControl.options[0].selected=true;GixSelectItem(a)}else{a.selectionField.value="";a.descriptionControl!=null&&GipSetDescriptionText(a,"")}}function GixRefreshGroupOnLoadCore(a){var b=a.candidateControl.selectedIndex;GixRefreshGroup(a);if(b>=0&&b<a.candidateControl.options.length){a.candidateControl.options[b].selected=true;GixSelectItem(a)}}function GixSelectItem(a){var c=a.data[a.groupControl.selectedIndex],d=a.candidateControl.options[a.candidateControl.selectedIndex].value;if(a.descriptionControl!=null)for(var b=1;b<c.length;b++)if(c[b][0]==d){GipSetDescriptionText(a,c[b][2]);break}a.selectionField.value=d}function EditDocumentTemplate(b,f,e,g,d,a){a:;if(phManager.ShouldTryProtocolHandler(a)){navigator.msLaunchUri(phManager.CreateProtocolHandlerUrl(a,b,ProtocolCommand.Edit,null),function(){a:;PHSucceed(a,true)},function(){a:;PHSucceed(a,false);c()});return}c();function c(){a:;if(Boolean(a)&&phManager!=null&&phManager.IsProtocolHandlerEnabled(a)){window.location.href=phManager.CreateProtocolHandlerUrl(a,b,ProtocolCommand.Edit,null);return}var c=null;try{c=new ActiveXObject(f);if(c!=null){var g=false;if(e){if(typeof c.CustomizeTemplate2!="undefined")g=c.CustomizeTemplate2(window,b)}else if(typeof c.EditDocument2!="undefined")g=c.EditDocument2(window,b)}}catch(h){alert(d)}}}function ConditionChange(){a:;if(typeof g_conditionalEnable=="undefined")return;var a=g_conditionalEnable;if(typeof a.length=="undefined")return;for(var b=0;b<a.length;b++){var e=document.getElementById(a[b][0]),d=e.checked;if(d!=null)for(var c=1;c<a[b].length;c++)document.getElementById(a[b][c]).disabled=!d}}function ProcessConditions(){a:;if(typeof g_conditionalEnable=="undefined")return;var a=g_conditionalEnable;if(typeof a.length=="undefined")return;if(a.length<=0)return;for(var b=0;b<a.length;b++){var c=document.getElementById(a[b][0]);if(browseris.ie)c.onclick=new Function("ConditionChange(event); return true;");else c.onclick=function(a){a:;ConditionChange(a);return true}}ConditionChange(null)}function IrInitialize(a){if(a.length<=0)return;for(var b=0;b<a.length;b++){a[b][2]=b;for(var d=document.getElementById(a[b][0]),c=0;c<a.length;c++)d.options[c]=GipNewOption(c+1,c+1)}IrRefresh(a)}function IrRefresh(b){b.sort(function(a,b){a:;return a[1]>b[1]?1:a[1]<b[1]?-1:a[2]-b[2]});for(var a=0;a<b.length;a++){b[a][1]=a+1;var c=document.getElementById(b[a][0]);c.options[a].selected=true}}function IrReorder(c,a){for(var b=0;b<a.length;b++)if(a[b][0]==c.id){if(Number(c.value)<a[b][1])a[b][1]=Number(c.value)-.1;else if(Number(c.value)>a[b][1])a[b][1]=Number(c.value)-0+.1;break}IrRefresh(a)}$_global_groupeditempicker();