function ULSNKb(){var o=new Object;o.ULSTeamName="Microsoft SharePoint Foundation";o.ULSFileName="SP.UI.AllApps.js";return o;}
Type.registerNamespace("SP.UI.AllApps");SP.UI.AllApps.SPAppUIState=function(){};SP.UI.AllApps.SPAppUIState.prototype={uninstalled:0,installedOk:1,installedFailedUpdateTryAgain:2,installedNormalUpdateAvailable:3,installedProblemWithUpgradeTryAgain:4,updateManuallyCancelledShowSameAsNormalUpdateAvailable:5,userCancelledUpdateRollingBack:6,initializedMiddownload:7,initializedDidntInstallRemoveOrInstallShouldWork:8,initializedInstallFailedCanRetry:9,installingSomeTroubleCanRetryMightNeedAdmin:10,upgradeStuckCanRetry:11,upgradeStuckOMEXWantsUnstuckNowCallAdmin:12,initializedDownloadInvalidatedUninstallTryAgain:13,somethingWentWrongThenWeBrokeUninstallAndAreStuck:14,systemDecidedToRemoveAppEverythingWorking:15,uninstallingInError:16,userTriedToRemoveButWeAreStuckOnUninstall:17,uninstallingInErrorOMEXSomethingWrongDoSameAsUpdateForOMEX:18,installedProblemWithUpgradeTryAgainImmediately:19,updateHadAnIssueWeAreRollingBack:20,installedFlagged:21,installedWithdrawnUpdateAvailable:22,installedWithdrawn:23,installedFlaggedUpdateAvailable:24,installedUpdateImmediatelyUpdateAvailable:25,installedRevoked:26,installedRevokedUpdateAvailable:27,somethingWentWrongKillbitting:28,weAreMidKillingAnApp:29,disabled:30,installedRemoved:31,installedRemovedUpdateAvailable:32,installingInProgress:33,registeringInstall:34,uninstallingNormal:35,userDecidedToRemoveAppEverythingWorking:36,notPossible:37,upgradingEverythingGood:38,registeringUpdate:39,updateDownloadInProgress:40,updateDownloadFailed:41,secretRolling:42,secretRollingInError:43};SP.UI.AllApps.SPAppUIState.registerEnum("SP.UI.AllApps.SPAppUIState",false);SP.UI.AllApps.CommandRecord=function(){};SP.UI.AllApps.CommandRecord.prototype={command:null,formdigest:null,sequence:0};SP.UI.AllApps.CallRecord=function(){};SP.UI.AllApps.CallRecord.prototype={commandRecord:null,onCommandCompleted:null,sequence:0};SP.UI.AllApps.CommandProxy=function(a){ULSNKb:;this.$$d_$4_0=Function.createDelegate(this,this.$4_0);this.$1_0=-1;this.$2_0=a;this.$0_0={}};SP.UI.AllApps.CommandProxy.prototype={$2_0:null,$3_0:0,$0_0:null,getNextSequenceNumber:function(){ULSNKb:;return++this.$1_0},executeCommand:function(a,d){ULSNKb:;if(this.$3_0>0)return-1;a.sequence=this.getNextSequenceNumber();var c=new SP.UI.AllApps.CallRecord;c.commandRecord=a;c.sequence=a.sequence;c.onCommandCompleted=d;this.$0_0[a.sequence.toString()]=c;var b=new Sys.Net.WebRequest;b.set_httpVerb("POST");b.set_url(this.$2_0);b.set_userContext(c);b.set_body(Sys.Serialization.JavaScriptSerializer.serialize(a));b.add_completed(this.$$d_$4_0);b.invoke();return a.sequence},$4_0:function(c){ULSNKb:;var a=c.get_webRequest().get_userContext(),b=null;try{b=c.get_object()}catch(d){}a.onCommandCompleted(a.commandRecord,b);this.$0_0[a.commandRecord.sequence.toString()]=null}};SP.UI.AllApps.CommandRecord.registerClass("SP.UI.AllApps.CommandRecord");SP.UI.AllApps.CallRecord.registerClass("SP.UI.AllApps.CallRecord");SP.UI.AllApps.CommandProxy.registerClass("SP.UI.AllApps.CommandProxy");function sp_ui_allapps_initialize(){}sp_ui_allapps_initialize();function GetAppLaunchFunction(b){ULSNKb:;var a=b;return function(){ULSNKb:;LaunchAppByClick(a);CancelDefaultBehavior();return false}}function getShowCalloutIconFunction(b){ULSNKb:;var a=b;return function(){ULSNKb:;showCalloutIcon(a)}}function getHideCalloutIconFunction(b){ULSNKb:;var a=b;return function(){ULSNKb:;hideCalloutIcon(a)}}function LaunchAppByClick(b){ULSNKb:;var a=appData[b];if(a.isTenantApp)LaunchAppFromPage(null,a.oauthId,a.launchUrl,null,true);else LaunchAppFromPage(b,a.oauthId,a.launchUrl,null,false)}function LaunchAppFromPage(a,d,e,b,c){ULSNKb:;LaunchApp(a,d,e,b,c);CancelDefaultBehavior();return false}function CancelDefaultBehavior(){ULSNKb:;typeof window.event!="undefined"&&window.event!=null&&cancelDefault(window.event)}function closeAndClearCallout(b){ULSNKb:;var a=appData[b];typeof a.callout!="undefined"&&a.callout!=null&&a.callout.close()}function handleManageAppPermissions(a){ULSNKb:;STSNavigate(getManagePermissionsUrl(a))}function handleDeployTSApp(a){ULSNKb:;var b=strWebLayoutsFolder+"DeployTSApp.aspx?AppId="+escapeProperly(a.id)+"&AppTitle="+escapeProperly(a.title)+"&Source="+escapeProperly(strWebLayoutsFolder)+"viewlsts.aspx";STSNavigate(b)}function handleListSettings(b){ULSNKb:;var a=strWebLayoutsFolder+"listedit.aspx?List="+escapeProperly(b);STSNavigate(a)}function handleAppSettings(a){ULSNKb:;var b=appData[a];LaunchAppFromPage(a,b.oauthId,b.appSettingsUrl,null)}function handleHelp(a){ULSNKb:;window.location=a}function handleViewInStorefront(b){ULSNKb:;var a=appData[b].appSource,d=appData[b].assetId,g=appData[b].productId,c=appData[b].contentMarket,f=d==null||d==""?g:d;if(f==null)return;if(a==0)a=2;else if(a==1)a=0;else if(a==2)a=1;var e=strWebLayoutsFolder+"storefront.aspx?Source="+escapeProperly(strWebLayoutsFolder)+"viewlsts.aspx#vw=AppDetailsView,app="+escapeProperly(f)+",clg="+a;if(c!=null&&c.length>0)e+=",cm="+escapeProperly(c);STSNavigate(e)}function handleManageSeats(a){ULSNKb:;STSNavigate("specificapplicensemanagement.aspx?ProductId="+escapeProperly(a))}function handleMonitorApp(b){ULSNKb:;var a=strWebLayoutsFolder+"AppMonitoringDetails.aspx?AppInstanceId="+escapeProperly(b);STSNavigate(a)}var req={};function handleRetryUninstallApp(a){ULSNKb:;closeAndClearCallout(a);handleUninstallAppCore(a,true,false)}function handleUninstallApp(a){ULSNKb:;closeAndClearCallout(a);var b=appData[a];handleUninstallAppCore(a,b.retryForRemove,true)}function handleUninstallAppCore(a,d,c){ULSNKb:;closeAndClearCallout(a);var b=appData[a],e=b.title;if(c)if(!confirm(appUninstallConfirm.replace("{0}",e))){b.callout.close();return}setAppRowMessage(a,strUninstalling);callMethodOnAppInstance(a,d?"retryAllJobs":"uninstall")}function callMethodOnAppInstance(a,b){ULSNKb:;var e=appData[a];req.ctx=SP.ClientContext.get_current();req.apps=SP.AppCatalog.getAppInstances(req.ctx,req.ctx.get_web());req.ctx.load(req.apps);var d=function(){ULSNKb:;var d={},g=req.apps.getEnumerator();while(g.moveNext()){var f=g.get_current();d[f.get_id()]=f}if(b==="retryAllJobs")d[a].retryAllJobs();else if(b==="uninstall")d[a].uninstall();else if(b==="install")d[a].install();else b==="cancelAllJobs"&&d[a].cancelAllJobs();req.ctx.load(d[a]);var h=function(){ULSNKb:;e.pending=true;ensureAppUpdating(a)};req.ctx.executeQueryAsync(Function.createDelegate(this,h),Function.createDelegate(this,c))},c=function(){ULSNKb:;setAppRowMessage(a,strGeneralError)};req.ctx.executeQueryAsync(Function.createDelegate(this,d),Function.createDelegate(this,c));return false}function removeAppRow(b){ULSNKb:;var a=document.getElementById("apptile-"+b);a&&a.parentNode&&a.parentNode.removeChild(a)}function setAppRowMessage(c,b){ULSNKb:;var a=document.getElementById("appstatus-"+c);if(a){a.className=a.className.replace("ms-error","");a.innerHTML=b}}function handleUninstallList(b){ULSNKb:;closeAndClearCallout(b);req.ctx=SP.ClientContext.get_current();var f=req.ctx.get_web().get_lists(),a=appData[b];if(a.uninstallInProgress)return;var g=a.title,h=f.getById(b),c=function(){ULSNKb:;removeAppRow(b);a.uninstallInProgress=false},d=function(f,d){ULSNKb:;var c=listUninstallFailed,e="<a onclick=\"javascript:handleListSettings('"+STSHtmlEncode(b)+"');\">";c=c.replace("{0}",e);c=c.replace("{1}","</a>");setAppRowMessage(b,c);g_debugFile&&alert("Request failed. "+d.get_message()+"\n"+d.get_stackTrace());a.uninstallInProgress=false},e=g_recycleBinEnabled?appUninstallConfirmRecycle:appUninstallConfirm;if(confirm(e.replace("{0}",g)))h.recycle();else{a.callout.close();return}a.uninstallInProgress=true;req.ctx.executeQueryAsync(Function.createDelegate(this,c),Function.createDelegate(this,d));a.callout.close();return false}function handleUninstallFeature(b){ULSNKb:;closeAndClearCallout(b);var a=appData[b];if(a.uninstallInProgress)return;req.ctx=SP.ClientContext.get_current();var f=req.ctx.get_web().get_features(),c=a.title,d=function(){ULSNKb:;removeAppRow(b);a.uninstallInProgress=false},e=function(e,d){ULSNKb:;setAppRowMessage(b,appUninstallFailed.replace("{0}",c));g_debugFile&&alert("Request failed. "+d.get_message()+"\n"+d.get_stackTrace());a.uninstallInProgress=false};if(confirm(appUninstallConfirm.replace("{0}",c)))f.remove(b);else{a.callout.close();return}a.uninstallInProgress=true;req.ctx.executeQueryAsync(Function.createDelegate(this,d),Function.createDelegate(this,e));a.callout.close();return false}function isVisible(){ULSNKb:;return true}function onOpening(c){ULSNKb:;var a=appData[c.getID()];if(typeof a.callout.info!="undefined"||a.callout.waiting)return;a.callout.waiting=true;var b={};b.command="getcalloutinfo";b.appid=a.id;b.apptype=a.type;b.productid=a.productId;b.appsource=a.appSource;b.assetid=a.assetId;b.contentMarket="";if(typeof a.contentMarket!="undefined"&&a.contentMarket!=null)b.contentMarket=a.contentMarket;b.isTenantApp=a.isTenantApp;a.gettingData=true;getCommandProxy().executeCommand(b,onCalloutInfoReturned)}function onCalloutInfoReturned(k,b){ULSNKb:;var a=appData[k.appid];a.callout.info=b;var e=document.createElement("div");e.id="calloutcontentInner-"+a.id;e.className="ms-vl-calloutContent";var j="";if(b!=null&&b.eulaurl!=null)j='<a id="terms-'+STSHtmlEncode(a.id)+'" href="'+STSHtmlEncode(b.eulaurl)+'" title="'+STSHtmlEncode(strAppTerms)+'">'+STSHtmlEncode(strAppTerms)+"</a>";var g="";if(a.type==g_appTypeList)g+="<div></div>";else g+='<div class="ms-metadata ms-vl-calloutversion" id="calloutVersion-'+a.id+'"></div>';g+='<div class="ms-vl-calloutterms" id="calloutTerms-'+a.id+'">'+j+"</div>";g+='<div class="ms-vl-appdescription" id="calloutDescription-'+a.id+'"></div>';e.innerHTML=g;var f="";if(b!=null&&b.publisher!=null&&b.publisher.length>0){f=strVersionAndPublisher.replace("{0}",a.version);f=f.replace("{1}",b.publisher)}else f=strVersion.replace("{0}",a.version);a.type!=g_appTypeList&&setInnerText(e.childNodes[0],f);b!=null&&b.description!=null&&setInnerText(e.childNodes[2],b.description);a.calloutContent=e;setCalloutContent(a.id,e);if(b==null){a.callout.waiting=false;return}var c=Array();if(a.type==g_appTypeApp){b.removeenabled&&!b.isanonymous&&b.putremovefirst&&addRemoveAction(c,a);b.supporturl!=null&&c.push({text:strHelp,onClickCallback:function(){ULSNKb:;handleHelp(b.supporturl)}});if(!b.isanonymous){if(!a.isTenantApp)b!=null&&b.manageseatsenabled&&a.appSource==g_appSourceMarketPlace&&c.push({text:strManageLicenses,onClickCallback:function(){ULSNKb:;handleManageSeats(a.productId)}});b.appsettingsenabled&&a.appSettingsUrl!=null&&c.push({text:strSettings,onClickCallback:function(){ULSNKb:;handleAppSettings(a.id)}});b.viewinmarketplaceenabled&&(a.appSource==g_appSourceMarketPlace||a.appSource==g_appSourceCorpCatalog)&&c.push({text:strViewInStorefront,onClickCallback:function(){ULSNKb:;handleViewInStorefront(a.id)}});if(!a.isTenantApp){g_isCorpSite&&b.managedeploymentenabled&&c.push({text:strDeploy,onClickCallback:function(){ULSNKb:;handleDeployTSApp(a)}});b.monitoringenabled&&c.push({text:strMonitorApp,onClickCallback:function(){ULSNKb:;handleMonitorApp(a.id)}});b.managepermissionsenabled&&c.push({text:strManagePermissions,onClickCallback:function(){ULSNKb:;handleManageAppPermissions(a)}});b.removeenabled&&!b.putremovefirst&&addRemoveAction(c,a)}}}else if(a.type==g_appTypeList){if(!b.isanonymous){!(a.assetId==null&&a.productId==null)&&c.push({text:strSettings,onClickCallback:function(){ULSNKb:;handleListSettings(a.id)}});b.viewinmarketplaceenabled&&c.push({text:strViewInStorefront,onClickCallback:function(){ULSNKb:;handleViewInStorefront(a.id)}});b.removeenabled&&c.push({text:strUninstall,onClickCallback:function(){ULSNKb:;handleUninstallList(a.id)}})}}else if(a.type==g_appTypeFeature)b.removeenabled&&!b.isanonymous&&c.push({text:strUninstall,onClickCallback:function(){ULSNKb:;handleUninstallFeature(a.id)}});for(var h=4,d=0;d<h-1&&d<c.length;d++)a.callout.addAction(new CalloutAction(c[d]));if(c.length==h)a.callout.addAction(new CalloutAction(c[h-1]));else if(c.length>h){for(var i=[],l=new CalloutActionMenu(a.callout.ID+"-actions"),d=h-1;d<c.length;d++)i.push(new CalloutActionMenuEntry(c[d].text,c[d].onClickCallback));a.callout.addAction(new CalloutAction({menuEntries:i}))}a.callout.refreshActions();a.callout.waiting=false}function addRemoveAction(b,a){ULSNKb:;if(a.retryForRemove)b.push({text:strUninstall,onClickCallback:function(){ULSNKb:;handleRetryUninstallApp(a.id)}});else b.push({text:strUninstall,onClickCallback:function(){ULSNKb:;handleUninstallApp(a.id)}})}function setInnerText(a,b){ULSNKb:;var c=a.ownerDocument;if(c.createTextNode){var d=c.createTextNode(b);a.innerHTML="";a.appendChild(d)}else a.innerText=b}function onOpened(c){ULSNKb:;var a=appData[c.getID()];typeof a.calloutContent!="undefined"&&a.calloutContent&&setCalloutContent(a.id,a.calloutContent);var b=document.getElementById(c.getID()+"_callout-bottombeak");if(typeof b!="undefined"&&b!=null)if(b.className.indexOf("ms-vl-callout-beak")==-1)b.className+=" ms-vl-callout-beak";var d=document.getElementById("apptile-"+a.id);d.className=d.className.replace("ms-vl-apptilehover","ms-vl-apptileselected")}function onClosed(c){ULSNKb:;if(typeof appData=="undefined"||appData==null)return;var a=appData[c.getID()];if(typeof a=="undefined"||a==null)return;var b=document.getElementById("apptile-"+a.id);b.className=b.className.replace("ms-vl-apptileselected","ms-vl-apptilehover")}function setCalloutContent(c,b){ULSNKb:;var a=document.getElementById("calloutcontent-"+c);a.hasChildNodes&&a.removeChild(a.firstChild);a.appendChild(b)}function initializeApps(){ULSNKb:;insertTenantApps();createCallouts();g_updatableApps.length>0&&ensureRealTimeUpdatesStarted()}function appSort(a,b){ULSNKb:;return a.title.localeCompare(b.title)}var appHtmlTemplate='<div class="ms-vl-appimage"><a class="ms-storefront-selectanchor ms-storefront-appiconspan" tabindex="-1" id="viewlist{APP_ID}-image"><img class="ms-storefront-appiconimg" src="{APP_IMAGE}"></img></a></div><div class="{APP_APPINFOSTYLE} ms-vl-pointer" onClick="javascript:launchCallout(arguments[0],\'{APP_ID}\', this)"><div><div class="ms-vl-apptitleouter"><a class="{APP_LAUNCHLINKSTYLE} ms-vl-apptitle" id="viewlist{APP_ID}" title="{APP_TITLE}">{APP_TITLE}</a></div><a class="ms-vl-calloutarrow ms-calloutLink ms-ellipsis-a ms-pivotControl-overflowDot" id="{APP_ID}"><img id="{APP_ID}-breadcrumb" class="ms-ellipsis-icon" alt="<SharePoint:EncodedLiteral runat=\'server\' text=\'<%$Resources:wss,calloutOpen%>\' EncodeMethod=\'EcmaScriptStringLiteralEncode\'/>" style="visibility:hidden;"></img></a></div><div class="ms-metadata ms-vl-appstatus" id="itemcount-{APP_ID}"></div><div class="ms-metadata ms-vl-appstatus {APP_ERRORSTYLE}" id="appstatus-{APP_ID}" class="{APP_DISABLED}">{APP_STATUS_TEXT}</div></div>';function insertTenantApps(){ULSNKb:;var h=GetTenantAppData();if(h==null)return;var f=h.apps;if(f.length==0)return;for(var g=0;g<f.length;g++){var o=f[g];appSortList.push(o)}var d=null;if(f.length>0){if(!d)d={};for(var n in appData){var m=appData[n].productId;d[m]=true}}appSortList.sort(appSort);for(var i=document.getElementById("applist"),c=appSortList.length-1;c>=0;c--){var b=appSortList[c];if(b.isTenantApp){if(d[b.productId]){var e=b.title;if(typeof e=="undefined"||e==null)e="";b.title=strShared.replace("{0}",e)}b.statusMessage="";var j=constructAppElement(b),p=null;if(c<appSortList.length-1){var k=appSortList[c+1],l=document.getElementById("apptile-"+k.id);i.insertBefore(j,l)}else i.appendChild(j);var a={};a.id=b.id;a.title=b.title;a.type=2;a.description=null;a.launchUrl=b.launchUrl;a.appSettingsUrl=null;a.productId=b.productId;a.imageUrl=null;a.thumbnailUrl=b.thumbnailUrl;a.oauthId=b.oauthId;a.version=b.version;a.appSource=b.appSource;a.contentMarket=b.contentMarket;a.assetId=b.assetId;a.isTenantApp=true;a.recent=false;a.hasErrorStyle=false;a.retryForRemove=false;g_draggableContentIds.push("viewlist"+b.id);appData[b.id]=a}}}function constructAppElement(b){ULSNKb:;var a=appHtmlTemplate.replace(/{APP_ID}/g,STSHtmlEncode(b.id));a=a.replace(/{APP_TITLE}/g,STSHtmlEncode(b.title));var h=b.thumbnailUrl;if(h=="null"||h==null)a=a.replace(/{APP_IMAGE}/g,STSHtmlEncode(strAppImage96x96x32Image));else{var k=h;a=a.replace(/{APP_IMAGE}/g,k)}var c=document.createElement("div");c.id="apptile-"+b.id;var f="";if(b.isTenantApp){f="ms-vl-apptile-tenant";a=a.replace(/{APP_APPINFOSTYLE}/g,"ms-vl-appinfo-tenant")}else{f="ms-vl-apptile";a=a.replace(/{APP_APPINFOSTYLE}/g,"ms-vl-appinfo")}c.className=f+" ms-vl-apptilehover";var i=null,g=null;if(b.disabled){c.className+=" ms-vl-disabledapp";a=a.replace(/{APP_DISABLED}/g,"ms-vl-disabledapp");a=a.replace(/{APP_LAUNCHLINKSTYLE}/g,"ms-vl-disabledapp")}else{a=a.replace(/{APP_DISABLED}/g,"");a=a.replace(/{APP_LAUNCHLINKSTYLE}/g,"ms-draggable ms-listLink");g=GetAppLaunchFunction(b.id);i=strWebLayoutsFolder+"appredirect.aspx?client_id="+escapeProperly(b.oauthId)+"&redirect_uri="+escapeProperly(b.launchUrl)}if(b.hasErrorStyle)a=a.replace(/{APP_ERRORSTYLE}/g,"ms-error");else a=a.replace(/{APP_ERRORSTYLE}/g,"");a=a.replace(/{APP_STATUS_TEXT}/g,b.statusMessage);c.innerHTML=a;var d=getAppTitleContainerElement(c);if(!b.disabled){c.firstChild.firstChild.href=i;d.firstChild.firstChild.href=i;if(!g_isAppWeb){c.firstChild.firstChild.onclick=g;d.firstChild.firstChild.onclick=g}}var j=b.id;c.onmouseover=getShowCalloutIconFunction(j);c.onmouseout=getHideCalloutIconFunction(j);d.childNodes[1].onfocus=c.onmouseover;d.childNodes[1].onblur=c.onmouseout;d.childNodes[1].firstChild.src=strEllipsisImage;if(b.recent){var e=document.createElement("span");e.id="recent-"+b.id;e.className="ms-vl-recent ms-textSmall";setInnerText(e,strNew);d.parentNode.insertBefore(e,getAppInfoElement(c))}return c}function getAppTitleContainerElement(a){ULSNKb:;return a.childNodes[1].firstChild}function getAppInfoElement(a){ULSNKb:;return a.childNodes[1].childNodes[2]}function launchCallout(a,d){ULSNKb:;var c=appData[d];if(typeof a=="undefined")a=window.event;var b=null;if(typeof a.target!="undefined"&&a.target!=null)b=a.target;if(b==null&&typeof a.srcElement!="undefined"&&a.srcElement!=null)b=a.srcElement;if(b!=null&&(b.nodeName.toLowerCase()=="a"||b.id=="viewlist"+d||c.callout.isOpen()||b.className.indexOf("js-callout-closeButtonImage")!=-1))return true;function e(){ULSNKb:;c.callout.open();c.togglingInProgress=false}if(!c.togglingInProgress){window.setTimeout(e,1);c.togglingInProgress=true}}function createCallouts(){ULSNKb:;EnsureScriptFunc("callout.js","Callout",function(){ULSNKb:;for(var a in appData)createCallout(a)})}function createCallout(d){ULSNKb:;var a=appData[d];a.togglingInProgress=false;a.uninstallInProgress=false;var b=document.getElementById(a.id),c='<div class="ms-vl-calloutversion" id="calloutcontent-'+a.id+'">'+strLoadingInfo+"</div>";if(numCalloutWidth==null||isNaN(numCalloutWidth))numCalloutWidth=370;a.callout=CalloutManager.createNew({title:STSHtmlEncode(a.title),ID:a.id,launchPoint:b,content:c,contentWidth:numCalloutWidth,onOpenedCallback:onOpened,onClosedCallback:onClosed,onOpeningCallback:onOpening});a.callout.waiting=false;a.callout.addAction(new CalloutAction({text:"",onClickCallback:function(){},isVisibleCallback:function(){ULSNKb:;return false}}))}function handleRetryDownload(a){ULSNKb:;handleViewInStorefront(a)}function handleRetryInstallApp(a){ULSNKb:;closeAndClearCallout(a);setAppRowMessage(a,strInstalling);callMethodOnAppInstance(a,"install")}function handleRetryInstallAppFromError(a){ULSNKb:;closeAndClearCallout(a);setAppRowMessage(a,strInstalling);callMethodOnAppInstance(a,"retryAllJobs")}function handleRetryUpdateAppFromError(a){ULSNKb:;closeAndClearCallout(a);setAppRowMessage(a,strUpdatingNonAdmin);callMethodOnAppInstance(a,"retryAllJobs")}function handleRetryKillbitFromError(a){ULSNKb:;closeAndClearCallout(a);setAppRowMessage(a,strKillbitting);callMethodOnAppInstance(a,"retryAllJobs")}function handleSeeAppProblemDetails(b){ULSNKb:;var a=appData[b],c=a.problemUrl;if(typeof a.problemUrl!="undefined"&&a.problemUrl!=null&&a.problemUrl.length>0)window.location=c}function handleUpdateApp(a){ULSNKb:;handleViewInStorefront(a)}function handleCancelUpdate(a){ULSNKb:;closeAndClearCallout(a);cancelAllAppJobs(a,strCancelAppUpdateConfirm,strCancellingAppUpdate)}function handleCancelInstall(a){ULSNKb:;closeAndClearCallout(a);cancelAllAppJobs(a,strCancelAppInstallConfirm,strCancellingAppInstall)}function cancelAllAppJobs(a,c,b){ULSNKb:;var e=appData[a],d=e.title;if(!confirm(c.replace("{0}",d)))return;setAppRowMessage(a,b);callMethodOnAppInstance(a,"cancelAllJobs")}function navigateToAddAnApp(){ULSNKb:;STSNavigate(addAnAppUrl)}function showCalloutIcon(b){ULSNKb:;var a=document.getElementById(b+"-breadcrumb");if(a!=null)a.style.visibility="visible"}function hideCalloutIcon(b){ULSNKb:;var a=document.getElementById(b+"-breadcrumb");if(a!=null)a.style.visibility="hidden"}var g_updateIntervalIndex=0,g_updateIntervals=[5,5,10,10,10,20,20,40,80,160,320,640,1800,3600,7200,14e3],g_realtimeUpdatesOn=false,g_updatingInProgress=false;function ensureRealTimeUpdatesStarted(){ULSNKb:;if(!g_realtimeUpdatesOn){g_realtimeUpdatesOn=true;g_updateIntervalIndex=0;window.setTimeout(processUpdates,1)}else g_updateIntervalIndex=0}function stopRealTimeUpdates(){ULSNKb:;g_realtimeUpdatesOn=false}function processUpdates(){ULSNKb:;if(!g_realtimeUpdatesOn){g_updateIntervalIndex=0;return}queryForUpdates()}function onQueryForUpdatesReturned(j,f){ULSNKb:;if(f!=null){for(var g=false,b=0;b<f.appinfo.length;b++){var a=f.appinfo[b],e=appData[a.id];if(a.uistate!=e.uistate||typeof e.pending!="undefined"&&e.pending){var d=document.getElementById("applist"),c=document.getElementById("apptile-"+a.id);if(a.uistate==null){d.removeChild(c);delete appData[a.id]}else{appData[a.id]=a;var i=constructAppElement(a);d.insertBefore(i,c);d.removeChild(c);createCallout(a.id)}g=true;g_updateIntervalIndex=0}}if(g){for(var h=[],b=0;b<g_updatableApps.length;b++)typeof appData[g_updatableApps[b]]!="undefined"&&isAppUpdatable(appData[g_updatableApps[b]])&&h.push(g_updatableApps[b]);g_updatableApps=h}}registerForNextUpdate()}function registerForNextUpdate(){ULSNKb:;if(g_updatableApps.length>0&&g_updateIntervalIndex+1<=g_updateIntervals.length){++g_updateIntervalIndex;window.setTimeout(processUpdates,g_updateIntervals[g_updateIntervalIndex]*1e3)}else g_realtimeUpdatesOn=false}function queryForUpdates(){ULSNKb:;var a={};a.command="getappinfo";a.appids=g_updatableApps.join("|");getCommandProxy().executeCommand(a,onQueryForUpdatesReturned)}function isAppUpdatable(a){ULSNKb:;return a.updatable}function ensureAppUpdating(b){ULSNKb:;for(var a=0;a<g_updatableApps.length;a++)if(g_updatableApps[a]===b)return;g_updatableApps.push(b);ensureRealTimeUpdatesStarted()}function initDraggables(){ULSNKb:;g_draggableContentIds!=null&&EnsureScriptFunc("DragDrop.js","SPDragDropManager",initDraggableSiteContent)}var g_dndSiteContentQL="sp-dragdrop-allsitecontent-qlmenu",g_dndSiteContentDataKey="SPSiteContentDragData";function initDraggableSiteContent(){ULSNKb:;if(SPDragDropManager==null||typeof SPDragDropManager=="undefined")return;var h=g_draggableContentIds.length,a={};a[g_dndSiteContentQL]="";for(var c=0;c<h;c++){var f=g_draggableContentIds[c],b=document.getElementById(f);if(b!=null&&typeof b!="undefined"){var d=SPDragDropManager.InitDraggable(b,a);SetSiteContentDragOptions(d)}var g=f+"-image",e=document.getElementById(g);if(!fIsNullOrUndefined(e)){var d=SPDragDropManager.InitDraggable(e,a);SetSiteContentDragOptions(d)}}}function SetSiteContentDragOptions(a){ULSNKb:;if(!a)return;a.SetOption("dragImage",createSiteContentDragImage);var b=new SPPosition(20,20);a.SetOption("cursorAt",b);a.AddEventListener("spDragStart",siteContentDragStartHandler)}function createSiteContentDragImage(b){ULSNKb:;var a=b.cloneNode(true);a.id="";document.body.appendChild(a);return a}function siteContentDragStartHandler(b){ULSNKb:;var c=[],a=GetTarget(b.rawEvent);while(Boolean(a)&&!Boolean(a.href))a=a.parentNode;if(!Boolean(a)||!Boolean(a.id))return;if(a.id.length>6&&a.id.substring(a.id.length-6)=="-image"){var f=a.id.substring(0,a.id.length-6),d=document.getElementById(f);if(!fIsNullOrUndefined(d))a=d}var g=typeof a.textContent=="undefined"?a.innerText:a.textContent,e=null;if(a.tagName.toUpperCase()=="A")e=a.href;var h=new SPSiteContentDragData(g,e);c.push(h);if(c.length>0){b.SetData(g_dndSiteContentDataKey,c);if(b.rawEvent&&b.rawEvent.dataTransfer)b.rawEvent.dataTransfer.effectAllowed="all"}}function SPSiteContentDragData(a,b){ULSNKb:;this.title=a;this.url=b}function _InitAllAppsGlobals(){ULSNKb:;req={};appHtmlTemplate='<div class="ms-vl-appimage"><a class="ms-storefront-selectanchor ms-storefront-appiconspan" tabindex="-1" id="viewlist{APP_ID}-image"><img class="ms-storefront-appiconimg" src="{APP_IMAGE}"></img></a></div><div class="{APP_APPINFOSTYLE} ms-vl-pointer" onClick="javascript:launchCallout(arguments[0],\'{APP_ID}\', this)"><div><div class="ms-vl-apptitleouter"><a class="{APP_LAUNCHLINKSTYLE} ms-vl-apptitle" id="viewlist{APP_ID}" title="{APP_TITLE}">{APP_TITLE}</a></div><a class="ms-vl-calloutarrow ms-calloutLink ms-ellipsis-a ms-pivotControl-overflowDot" id="{APP_ID}"><img id="{APP_ID}-breadcrumb" class="ms-ellipsis-icon" alt="<SharePoint:EncodedLiteral runat=\'server\' text=\'<%$Resources:wss,calloutOpen%>\' EncodeMethod=\'EcmaScriptStringLiteralEncode\'/>" style="visibility:hidden;"></img></a></div><div class="ms-metadata ms-vl-appstatus" id="itemcount-{APP_ID}"></div><div class="ms-metadata ms-vl-appstatus {APP_ERRORSTYLE}" id="appstatus-{APP_ID}" class="{APP_DISABLED}">{APP_STATUS_TEXT}</div></div>';g_updateIntervalIndex=0;g_updateIntervals=[5,5,10,10,20,40,80,160,320,640,1800,3600,7200,14e3];g_realtimeUpdatesOn=false;g_updatingInProgress=false;g_dndSiteContentQL="sp-dragdrop-allsitecontent-qlmenu";g_dndSiteContentDataKey="SPSiteContentDragData";_spAllAppsScriptLoaded=true}_InitAllAppsGlobals();RegisterModuleInit("sp.ui.allapps.js",function(){ULSNKb:;sp_ui_allapps_initialize();_InitAllAppsGlobals()});typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();NotifyScriptLoadedAndExecuteWaitingJobs("sp.ui.allapps.js");_spAllAppsScriptLoaded=true;