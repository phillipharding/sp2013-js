function ULSYpL(){var o=new Object;o.ULSTeamName="Microsoft SharePoint Foundation";o.ULSFileName="SP.UI.RelatedItems.js";return o;}
Type.registerNamespace("SP.UI.RelatedItems");SP.UI.RelatedItems.AddUrlDialog=function(a,b){ULSYpL:;this.$$d_$X_0=Function.createDelegate(this,this.$X_0);this.$$d_$U_0=Function.createDelegate(this,this.$U_0);this.$$d_$Y_0=Function.createDelegate(this,this.$Y_0);this.$$d_$V_0=Function.createDelegate(this,this.$V_0);this.$H_0=b;this.$6_0=a;this.$Z_0()};SP.UI.RelatedItems.AddUrlDialog.prototype={$H_0:null,$6_0:null,$B_0:null,$F_0:null,$C_0:null,$D_0:null,$5_0:null,$Z_0:function(){ULSYpL:;var c=this.$6_0.id+"_urltextbox",d=this.$6_0.id+"_addbutton",e=this.$6_0.id+"_cancelbutton",a=document.createElement("div");a.className="ms-relateditems-addurl";a.innerHTML=SP.Res.relatedItems_AddUrlDialog_TextBoxLabel;a.appendChild(document.createElement("br"));this.$5_0=document.createElement("input");this.$5_0.id=c;this.$5_0.type="text";this.$5_0.size=40;a.appendChild(this.$5_0);this.$6_0.appendChild(a);var b=document.createElement("div");b.className="ms-relateditems-addurlbuttons";this.$C_0=document.createElement("input");this.$C_0.id=d;this.$C_0.type="button";this.$C_0.value=SP.Res.relatedItems_AddUrlDialog_AddButtonTitle;b.appendChild(this.$C_0);this.$D_0=document.createElement("input");this.$D_0.id=e;this.$D_0.type="button";this.$D_0.value=SP.Res.relatedItems_AddUrlDialog_CancelButtonTitle;b.appendChild(this.$D_0);this.$6_0.appendChild(b);this.$B_0=new SP.UI.DialogOptions;this.$B_0.title=SP.Res.relatedItems_AddUrlDialog_Title;this.$B_0.height=80;this.$B_0.html=this.$6_0;this.$B_0.dialogReturnValueCallback=this.$$d_$V_0},$U_0:function(){ULSYpL:;this.$F_0.close(1)},$X_0:function(){ULSYpL:;this.$F_0.close(0)},show:function(){ULSYpL:;this.$F_0=SP.UI.ModalDialog.showModalDialog(this.$B_0);this.$5_0.focus();$addHandler(this.$5_0,"keydown",this.$$d_$Y_0);$addHandler(this.$C_0,"click",this.$$d_$U_0);$addHandler(this.$D_0,"click",this.$$d_$X_0)},$Y_0:function(a){ULSYpL:;if(a.keyCode===13)this.$F_0.close(1);else a.keyCode===27&&this.$F_0.close(0)},$V_0:function(a){ULSYpL:;if(a===1){var b=this.$5_0.value;this.$H_0(b)}else!a&&this.$H_0(null)}};SP.UI.RelatedItems.PermissionsInitializer=function(){};SP.UI.RelatedItems.PermissionsInitializer.prototype={High:0,Low:0};function Context(){ULSYpL:;this.Templates={}}Context.prototype={CurrentItem:null,listName:null,listTemplate:null,ListSchema:null,OnPreRender:null,OnPostRender:null,CurrentFieldSchema:null};function FormContext(){}FormContext.prototype={controlMode:0,fieldName:null,fieldSchema:null,fieldValue:null,itemAttributes:null,listAttributes:null,webAttributes:null};function UserInfo(){}UserInfo.prototype={email:null,id:null,picture:null,sip:null,title:null,value:null};SP.UI.RelatedItems.GlobalTemplateOverrides=function(){};SP.UI.RelatedItems.GlobalTemplateOverrides.$$cctor=function(){ULSYpL:;SPClientTemplates.TemplateManager.RegisterTemplateOverrides(SP.UI.RelatedItems.RelatedItemsFieldTemplate.createRenderingContextOverrides())};SP.UI.RelatedItems.RelatedItemsFieldTemplate=function(){};SP.UI.RelatedItems.RelatedItemsFieldTemplate.createRenderingContextOverrides=function(){ULSYpL:;var a=new Context;a.Templates.Fields={RelatedItems:{DisplayForm:SP.UI.RelatedItems.RelatedItemsFieldTemplate.renderRelatedItemsField,View:SP.UI.RelatedItems.RelatedItemsFieldTemplate.renderRelatedItemsFieldColumn}};a.OnPreRender=SP.UI.RelatedItems.RelatedItemsFieldTemplate.renderRelatedItemsPreRender;return a};SP.UI.RelatedItems.RelatedItemsFieldTemplate.renderRelatedItemsPreRender=function(a){ULSYpL:;if(a&&a.ListSchema&&a.ListSchema.Field)for(var c=a.ListSchema.Field,e=c.length,b=0;b<e;++b){var d=c[b];if(d.FieldType==="RelatedItems")d.AllowGridEditing=false}};SP.UI.RelatedItems.RelatedItemsFieldTemplate.renderRelatedItemsFieldColumn=function(a){ULSYpL:;return a.CurrentItem.RelatedItems};SP.UI.RelatedItems.RelatedItemsFieldTemplate.renderRelatedItemsField=function(h){ULSYpL:;var d,e,f,b,a=SPClientTemplates.Utility.GetFormContextForCurrentField(h),i=!SP.ScriptUtility.isNullOrUndefined(a);if(i)if(SP.ScriptUtility.isNullOrUndefined(a.itemAttributes)||SP.ScriptUtility.isNullOrUndefined(a.itemAttributes.Id)||SP.ScriptUtility.isNullOrUndefined(a.itemAttributes.FsObjType)||SP.ScriptUtility.isNullOrUndefined(a.listAttributes)||SP.ScriptUtility.isNullOrUndefined(a.listAttributes.Id))return SP.Res.relatedItemsFieldRenderer_AttributesMissing;else{d=a.itemAttributes.Id;e=a.itemAttributes.FsObjType;f=a.listAttributes.Id;b=a.fieldValue;var c=new SP.UI.RelatedItems.PermissionsInitializer;c.High=a.itemAttributes.EffectiveBasePermissionsHigh;c.Low=a.itemAttributes.EffectiveBasePermissionsLow;var g=new SP.BasePermissions;g.fromJson(c);var j=g.has(3),k=!b||!b.length;if(e==="1")return SP.Res.relatedItemsFieldRenderer_TypeFile;else{var l=new SP.UI.RelatedItems.RelatedItemsFormRenderer(d,f,j);return l.ShowOnePage(k)}}else return SP.Res.relatedItemsFieldRenderer_ZeroRelatedItems};SP.UI.RelatedItems.RelatedItemsServerSideFieldTemplate=function(){};SP.UI.RelatedItems.RelatedItemsServerSideFieldTemplate.RenderRelatedItemsField=function(c,d,e,b,a){ULSYpL:;var f=$get(c),g=new SP.UI.RelatedItems.RelatedItemsFormRenderer(d,e,b);f.innerHTML=g.ShowOnePage(a)};SP.UI.RelatedItems.RelatedItemsFormRenderer=function(b,c,a){ULSYpL:;this.$$d_$W_0=Function.createDelegate(this,this.$W_0);this.$$d_$S_0=Function.createDelegate(this,this.$S_0);this.$$d_$R_0=Function.createDelegate(this,this.$R_0);this.$$d_RenderFooterTemplate=Function.createDelegate(this,this.RenderFooterTemplate);this.$$d_RenderItemTemplate=Function.createDelegate(this,this.RenderItemTemplate);this.$$d_RenderBodyTemplate=Function.createDelegate(this,this.RenderBodyTemplate);this.$$d_RenderViewTemplate=Function.createDelegate(this,this.RenderViewTemplate);this.$8_0=b;this.$E_0=c;this.$9_0=false;this.$I_0=a;if(a)SP.UI.RelatedItems.ScriptApplicationManager.RelatedItemsControl=this;SP.UI.RelatedItems.ScriptApplicationManager.RelatedItemsControlReadOnly=this};SP.UI.RelatedItems.RelatedItemsFormRenderer.$a=function(a){ULSYpL:;return!!a.addEventListener};SP.UI.RelatedItems.RelatedItemsFormRenderer.ShowRemoveButton=function(a){ULSYpL:;var b=$get(a);b.style.display="inline";var c=$get(a.replace("_ri_item_remove","_ri_item_title_div"));c.style.marginRight=Sys.UI.DomElement.getBounds(b).width+8+"px"};SP.UI.RelatedItems.RelatedItemsFormRenderer.HideRemoveButton=function(a){ULSYpL:;var b=$get(a);if(b){b.style.display="none";var c=$get(a.replace("_ri_item_remove","_ri_item_title_div"));c.style.marginRight="0px"}};SP.UI.RelatedItems.RelatedItemsFormRenderer.prototype={$G_0:false,$J_0:null,$K_0:false,$3_0:null,$8_0:0,$E_0:null,$4_0:0,$2_0:null,$9_0:false,$I_0:false,$A_0:null,$7_0:null,ShowOnePage:function(a){ULSYpL:;var c=!!this.$3_0&&this.$3_0.id===this.$A_0,b=this;return this.$N_0(function(){ULSYpL:;c&&$get(b.$A_0).focus()},a)},$N_0:function(b,g){ULSYpL:;this.$9_0=true;this.$G_0=false;var e=SP.ClientContext.get_current();if(!g){var f=SP.RelatedItemManager.getPageOneRelatedItems(e,this.$E_0,this.$8_0);this.$4_0=0;var a=this,c=this;e.executeQueryAsync(function(){ULSYpL:;a.$4_0=f.length;a.$2_0=[];for(var c=0;c<a.$4_0&&c<3;c++)Array.add(a.$2_0,f[c]);a.Render();b&&b()},function(){ULSYpL:;c.$G_0=true;c.$J_0=e.get_traceCorrelationId();c.Render()})}else{var d=this;window.setTimeout(function(){ULSYpL:;d.$4_0=0;d.$2_0=[];d.Render();b&&b()},0)}return String.format("<div id='{0}' class='ms-relateditems-core'></div>",this.$1_0())},ShowAll:function(){ULSYpL:;var b=!!this.$3_0&&this.$3_0.id===this.$A_0,a=this;return this.$M_0(function(){ULSYpL:;b&&$get(a.$A_0).focus()})},$M_0:function(d){ULSYpL:;this.$9_0=false;this.$G_0=false;var c=SP.ClientContext.get_current();this.$2_0=SP.RelatedItemManager.getRelatedItems(c,this.$E_0,this.$8_0);this.$4_0=0;var a=this,b=this;c.executeQueryAsync(function(){ULSYpL:;a.$4_0=a.$2_0.length;a.Render();d&&d()},function(){ULSYpL:;b.$G_0=true;b.$J_0=c.get_traceCorrelationId();b.Render()});return String.format("<div id='{0}' class='ms-relateditems-core'></div>",this.$1_0())},Render:function(){ULSYpL:;var c=$get(this.$1_0()),a={};a.View=this.$$d_RenderViewTemplate;a.Body=this.$$d_RenderBodyTemplate;a.Item=this.$$d_RenderItemTemplate;a.Footer=this.$$d_RenderFooterTemplate;var b={};b.ListData=this.$2_0;b.Templates=a;SPClientRenderer.Render(c,b);this.$b_0(c)},$b_0:function(a){ULSYpL:;if(SP.UI.RelatedItems.RelatedItemsFormRenderer.$a(a)){a.addEventListener("focus",this.$$d_$R_0,true);a.addEventListener("blur",this.$$d_$S_0,true)}else{$addHandler(a,"focusin",this.$$d_$R_0);$addHandler(a,"focusout",this.$$d_$S_0)}},$R_0:function(a){ULSYpL:;this.$K_0=true;this.$3_0=a.target;this.$3_0.id.endsWith("_ri_item_title")&&SP.UI.RelatedItems.RelatedItemsFormRenderer.ShowRemoveButton(this.$3_0.id.replace("_ri_item_title","_ri_item_remove"))},$S_0:function(a){ULSYpL:;this.$K_0=false;if(a.target.id.endsWith("_ri_item_title")||a.target.id.endsWith("_ri_item_remove")){var b=new SP.UI.RelatedItems.RelatedItemsFocusHandler(this,a.target);b.handleLostFocus()}},RenderBodyTemplate:function(a){ULSYpL:;var d=a.ListData.length;if(!d)return"";for(var c="<div>",b=0;b<d;b++){a.CurrentIdx=b;a.CurrentItem=a.ListData[b];c+=this.RenderItemTemplate(a)}c+="</div>";return c},RenderViewTemplate:function(a){ULSYpL:;if(this.$G_0)return String.format(SP.Res.relatedItems_RelatedItemsControl_GetError,this.$J_0);var b=a.RenderHeader(a);b+=a.RenderBody(a);b+=a.RenderFooter(a);return b},RenderItemTemplate:function(b){ULSYpL:;var h=this.$1_0()+"_"+b.CurrentIdx+"_ri_item",i=this.$1_0()+"_"+b.CurrentIdx+"_ri_item_title",j=this.$1_0()+"_"+b.CurrentIdx+"_ri_item_title_div",d=this.$1_0()+"_"+b.CurrentIdx+"_ri_item_remove",a=b.CurrentItem,f=a.get_url();if(!SP.ScriptUtility.isNullOrUndefined(a.get_title())&&!SP.ScriptUtility.isNullOrEmptyString(a.get_title()))f=a.get_title();var e;if(SP.ScriptUtility.isNullOrUndefined(a.get_iconUrl()))e=SP.UI.RelatedItems.Utility.defaultIcon;else e=SP.Utilities.Utility.getImageUrl(a.get_iconUrl());var g=a.get_url().lastIndexOf("."),k="";if(g>0)k=a.get_url().substring(g+1,a.get_url().length);var c=String.format("<div id='{0}' class='ms-relateditems-item' onmouseover=\"javascript:SP.UI.RelatedItems.RelatedItemsFormRenderer.ShowRemoveButton('{1}')\" onmouseout=\"javascript:SP.UI.RelatedItems.RelatedItemsFormRenderer.HideRemoveButton('{1}')\">",h,d);c+=String.format("<img src='{1}' alt='{2}' class='ms-floatLeft ms-relateditems-icon' />",a.get_url(),e,SP.Res.relatedItems_RelatedItemsControl_ImgAlt);c+=String.format("<div class='ms-relateditems-title ms-noWrap' id='{3}'><a href='{0}' id='{1}' target='_top'>{2}</a></div>",a.get_url(),i,SP.Utilities.HttpUtility.htmlEncode(f),j);if(this.$I_0)c+=String.format("<div class='ms-relateditems-deletelink'><a class=\"ms-calloutLink\" style='display: none;' href='javascript:;' onClick='javascript:{0}.DeleteItem({1});' id='{2}'>{3}</a></div>","SP.UI.RelatedItems.ScriptApplicationManager.RelatedItemsControl",b.CurrentIdx,d,SP.Res.relatedItems_RelatedItemsControl_RemoveItem);else c+=String.format("<div class='ms-relateditems-deletelink ms-calloutLinkDisabled'><a id='{0}'></a></div>",d);c+="</div>";return c},RenderFooterTemplate:function(){ULSYpL:;this.$A_0=this.$1_0()+"_ri_show_all";this.$7_0=this.$1_0()+"_ri_add_related_items";var b=this.$4_0<9&&this.$I_0,a="<div>";if(this.$4_0>3)if(this.$9_0)a+=String.format("<a class=\"ms-calloutLink\" href='javascript:;' onClick='javascript:{0}.ShowAll();' id='{1}'><span class='ms-relateditems-showmore-span'><img class='ms-relateditems-showmore-icon' src='{3}' /></span>{2}</a>","SP.UI.RelatedItems.ScriptApplicationManager.RelatedItemsControlReadOnly",this.$A_0,SP.Res.relatedItems_RelatedItemsControl_ShowMore,"/_layouts/15/images/spcommon.png?rev=23");else a+=String.format("<a class=\"ms-calloutLink\" href='javascript:;' onClick='javascript:{0}.ShowOnePage();' id='{1}'><span class='ms-relateditems-showless-span'><img class='ms-relateditems-showless-icon' src='{3}' /></span>{2}</a>","SP.UI.RelatedItems.ScriptApplicationManager.RelatedItemsControlReadOnly",this.$A_0,SP.Res.relatedItems_RelatedItemsControl_ShowFewer,"/_layouts/15/images/spcommon.png?rev=23");a+="<span style='float: right;'>";if(b)a+=String.format('<a class="ms-calloutLink" href="javascript:{0}.AddRelatedItemUrl()" id=\'{2}\'>{1}</a>',"SP.UI.RelatedItems.ScriptApplicationManager.RelatedItemsControl",SP.Res.relatedItems_RelatedItemsControl_AddRelatedItem,this.$7_0);else a+=String.format("<a class=\"ms-calloutLinkDisabled\" id='{0}'></a>",this.$7_0);a+="</span>";a+="</div>";return a},AddRelatedItem:function(e,d){ULSYpL:;var b=SP.ClientContext.get_current();SP.RelatedItemManager.addSingleLink(b,this.$E_0,this.$8_0,null,e,d,null,true);var c=SP.UI.Notify.addNotification(SP.Res.relatedItems_RelatedItemsControl_Adding,true),a=this,f=this;b.executeQueryAsync(function(){ULSYpL:;SP.UI.Notify.removeNotification(c);makeItemVisible($get(a.$1_0()));if(a.$9_0)a.ShowOnePage(false);else a.ShowAll()},function(b,a){ULSYpL:;SP.UI.Notify.removeNotification(c);SP.UI.Notify.addNotification(!a.get_errorValue()?a.get_message():a.get_errorValue(),false)})},AddRelatedItemUrl:function(){ULSYpL:;var b=document.createElement("div");if(SP.UI.RelatedItems.ScriptApplicationManager.RelatedItemsPicker){var a=SP.ClientContext.get_current(),c=a.get_web();a.load(c,["Url"]);var d=this,e=this;a.executeQueryAsync(function(){ULSYpL:;SP.UI.RelatedItems.ScriptApplicationManager.RelatedItemsPicker(c.get_url(),d.$$d_$W_0)},function(){ULSYpL:;var a=new SP.UI.RelatedItems.AddUrlDialog(b,e.$$d_$W_0);a.show()})}else{var f=new SP.UI.RelatedItems.AddUrlDialog(b,this.$$d_$W_0);f.show()}},$W_0:function(d){ULSYpL:;if(!d)$get(this.$7_0).focus();else{var b=SP.ClientContext.get_current(),f=b.get_web();SP.RelatedItemManager.addSingleLinkToUrl(b,this.$E_0,this.$8_0,d,true);var c=SP.UI.Notify.addNotification(SP.Res.relatedItems_RelatedItemsControl_Adding,true),a=this,e=this;b.executeQueryAsync(function(){ULSYpL:;SP.UI.Notify.removeNotification(c);if(a.$9_0)a.$N_0(function(){ULSYpL:;$get(a.$7_0).focus()},false);else a.$M_0(function(){ULSYpL:;$get(a.$7_0).focus()})},function(b,a){ULSYpL:;SP.UI.Notify.removeNotification(c);SP.UI.Notify.addNotification(!a.get_errorValue()?a.get_message():a.get_errorValue(),false);$get(e.$7_0).focus()})}},DeleteItem:function(a){ULSYpL:;var c=SP.ClientContext.get_current(),b=this.$2_0[a];SP.RelatedItemManager.deleteSingleLink(c,this.$E_0,this.$8_0,null,b.get_listId(),b.get_itemId(),b.get_webId(),true);var d=SP.UI.Notify.addNotification(SP.Res.relatedItems_RelatedItemsControl_Deleting,true),e=this,f=this;c.executeQueryAsync(function(){ULSYpL:;e.$O_0(d,a)},function(c,b){ULSYpL:;f.$O_0(d,a);SP.UI.Notify.addNotification(!b.get_errorValue()?b.get_message():b.get_errorValue(),false)})},$O_0:function(d,a){ULSYpL:;SP.UI.Notify.removeNotification(d);if(this.$9_0){var b=this;this.$N_0(function(){ULSYpL:;b.$P_0(a)},false)}else{var c=this;this.$M_0(function(){ULSYpL:;c.$P_0(a)})}},$P_0:function(a){ULSYpL:;var b=a;if(a>=this.$2_0.length)a=this.$2_0.length-1;a>=0&&$get(this.$1_0()+"_"+a+"_ri_item_title").focus()},$1_0:function(){ULSYpL:;return"relatedItems-"+this.$8_0}};SP.UI.RelatedItems.RelatedItemsFocusHandler=function(a,b){ULSYpL:;this.$$d_$T_0=Function.createDelegate(this,this.$T_0);this.$L_0=a;this.$Q_0=b};SP.UI.RelatedItems.RelatedItemsFocusHandler.prototype={$L_0:null,$Q_0:null,$T_0:function(){ULSYpL:;var a=this.$Q_0.id.replace("_ri_item_title","");a=a.replace("_ri_item_remove","");(!this.$L_0.$K_0||!this.$L_0.$3_0.id.startsWith(a))&&SP.UI.RelatedItems.RelatedItemsFormRenderer.HideRemoveButton(a+"_ri_item_remove")},handleLostFocus:function(){ULSYpL:;window.setTimeout(this.$$d_$T_0,20)}};SP.UI.RelatedItems.Utility=function(){};SP.UI.RelatedItems.ScriptApplicationManager=function(){};SP.UI.RelatedItems.AddUrlDialog.registerClass("SP.UI.RelatedItems.AddUrlDialog");SP.UI.RelatedItems.PermissionsInitializer.registerClass("SP.UI.RelatedItems.PermissionsInitializer");Context.registerClass("Context");FormContext.registerClass("FormContext");UserInfo.registerClass("UserInfo");SP.UI.RelatedItems.GlobalTemplateOverrides.registerClass("SP.UI.RelatedItems.GlobalTemplateOverrides");SP.UI.RelatedItems.RelatedItemsFieldTemplate.registerClass("SP.UI.RelatedItems.RelatedItemsFieldTemplate");SP.UI.RelatedItems.RelatedItemsServerSideFieldTemplate.registerClass("SP.UI.RelatedItems.RelatedItemsServerSideFieldTemplate");SP.UI.RelatedItems.RelatedItemsFormRenderer.registerClass("SP.UI.RelatedItems.RelatedItemsFormRenderer");SP.UI.RelatedItems.RelatedItemsFocusHandler.registerClass("SP.UI.RelatedItems.RelatedItemsFocusHandler");SP.UI.RelatedItems.Utility.registerClass("SP.UI.RelatedItems.Utility");SP.UI.RelatedItems.ScriptApplicationManager.registerClass("SP.UI.RelatedItems.ScriptApplicationManager");function sp_ui_relateditems_initialize(){ULSYpL:;SP.UI.RelatedItems.GlobalTemplateOverrides.$$cctor();SP.UI.RelatedItems.Utility.defaultIcon=SP.Utilities.Utility.getImageUrl("icgen.gif");SP.UI.RelatedItems.ScriptApplicationManager.RelatedItemsControl=null;SP.UI.RelatedItems.ScriptApplicationManager.RelatedItemsControlReadOnly=null;SP.UI.RelatedItems.ScriptApplicationManager.RelatedItemsPicker=null}sp_ui_relateditems_initialize();RegisterModuleInit("sp.ui.relateditems.js",sp_ui_relateditems_initialize);typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();NotifyScriptLoadedAndExecuteWaitingJobs("sp.ui.relateditems.js");