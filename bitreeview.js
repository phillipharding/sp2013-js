function $_global_bitreeview(){EWR_TREE_NODE_ELEMENT="ewrtreenode";EWR_ATTRIBUTE="ewr";EWR_PARTIAL_CHECK_CLASS="ewr_node_partialcheck";HIDE_BLANKS_VALUE="[HideBlanks]";NODE_TYPE_BLANKS="Blanks";EWR_CHECK_STATE_CHECKED="t";EWR_CHECK_STATE_PARTIAL="p";EWR_CHECK_STATE_UNCHECKED="f";EWR_NODE_TYPE_ALL="All";EWR_NODE_TYPE_ROOT="Root";EwrTreeNode_initPrototypes();EwrTreeNode_initPrototypes();EwrTreeView_initPrototypes();ewrTreeNodeCleanupArray=[]}function getAttribute(a,b){return typeof a.hasAttribute=="function"?a.hasAttribute(b)?a.getAttribute(b):null:a.getAttribute(b)}function getSrcElement(a){return a.srcElement!=null?a.srcElement:a.target!=null?a.target:null}var EWR_TREE_NODE_ELEMENT,EWR_ATTRIBUTE,EWR_PARTIAL_CHECK_CLASS,HIDE_BLANKS_VALUE,NODE_TYPE_BLANKS,EWR_CHECK_STATE_CHECKED,EWR_CHECK_STATE_PARTIAL,EWR_CHECK_STATE_UNCHECKED,EWR_NODE_TYPE_ALL,EWR_NODE_TYPE_ROOT;function EwrTreeNode_initPrototypes(){EwrTreeNode.prototype.oNodeTable=null;EwrTreeNode.prototype.oEwrNodeElement=null;EwrTreeNode.prototype.oCheckBox=null;EwrTreeNode.prototype.oTextElement=null;EwrTreeNode.prototype.oParent=null;EwrTreeNode.prototype.type=null;EwrTreeNode.prototype.index=null;EwrTreeNode.prototype.level=null;EwrTreeNode.prototype.checkState=null;EwrTreeNode.prototype.nodeChildNodes=null;EwrTreeNode.prototype.value=null;EwrTreeNode.prototype.calculatedMember=null;EwrTreeNode.prototype.click=EwrTreeNode_click;EwrTreeNode.prototype.check=EwrTreeNode_check;EwrTreeNode.prototype.checkStateChanged=EwrTreeNode_checkStateChanged;EwrTreeNode.prototype.childCheckStateChanged=EwrTreeNode_childCheckStateChanged;EwrTreeNode.prototype.childNodes=EwrTreeNode_childNodes;EwrTreeNode.prototype.checkChildren=EwrTreeNode_checkChildren;EwrTreeNode.prototype.setItalicText=EwrTreeNode_setItalicText;EwrTreeNode.prototype.parent=EwrTreeNode_parent;EwrTreeNode.prototype.getCheckState=EwrTreeNode_getCheckState;EwrTreeNode.prototype.optimizeCheckState=EwrTreeNode_optimizeCheckState;EwrTreeNode.prototype.cleanup=EwrTreeNode_cleanup}function EwrTreeNode(b,a){if(a==null)a=ewr_findElementByType(b,EWR_TREE_NODE_ELEMENT,false,undefined);this.oNodeTable=b;this.oEwrNodeElement=a;this.oCheckBox=ewr_findElementByTypeAndTag(a.parentNode,"input","type","checkbox",false,undefined);this.oTextElement=ewr_findElementByTypeAndTag(a.parentNode,"span",EWR_ATTRIBUTE,undefined,undefined,undefined);this.type=getAttribute(a,"type");this.index=Number(getAttribute(a,"index"));this.level=Number(getAttribute(a,"level"));this.checkState=getAttribute(a,"checked");this.value=getAttribute(a,"value");var c=getAttribute(a,"cm");this.calculatedMember=c!=null&&c=="true"?true:false;if(typeof b.innerText!="undefined")this.text=b.innerText;else if(typeof b.textContent!="undefined")this.text=b.textContent.trim();ewrTreeNodeCleanupArray[ewrTreeNodeCleanupArray.length]=this}var oTree;function createEwrTreeView(b){var a=document.getElementById(b);if(a==null)return null;if(typeof a.treeView!="undefined"&&a.treeView!=null)return a.treeView;a.treeView=new EwrTreeView(a);oTree=a.treeView;return a.treeView}function EwrTreeView_initPrototypes(){EwrTreeView.prototype={oRootNodes:null,oAllNode:null,hideBlanks:false,oTreeViewDiv:null,checkAll:EwrTreeView_checkAll,optimizeCheckState:EwrTreeView_optimizeCheckState,allNode:EwrTreeView_allNode,rootNodes:EwrTreeView_rootNodes,getCheckedNodesValues:EwrTreeView_getCheckedNodesValues,getCheckedNodes:EwrTreeView_getCheckedNodes,updateAllNodeCheckState:EwrTreeView_updateAllNodeCheckState,cleanup:EwrTreeView_cleanup}}var ewrTreeNodeCleanupArray;function EwrTreeView_checkAll(c){for(var d=this.rootNodes(),b=0;b<d.length;b++){var a=d[b];if(a.type==EWR_NODE_TYPE_ALL)a.checkChildren(c,true);else a.check(c,true)}}function EwrTreeView_optimizeCheckState(){for(var c=this.rootNodes(),b=true,f=false,e=false,d=0;d<c.length;d++){var a=c[d];if(a.type==EWR_NODE_TYPE_ALL){if(a.getCheckState()==EWR_CHECK_STATE_CHECKED){this.checkAll(EWR_CHECK_STATE_UNCHECKED);break}continue}a.optimizeCheckState();if(a.type==NODE_TYPE_BLANKS){f=true;e=a.getCheckState()==EWR_CHECK_STATE_CHECKED}else if(b&&a.getCheckState()!=EWR_CHECK_STATE_CHECKED)b=false}if(f&&b&&c.length>2&&!e){this.checkAll(EWR_CHECK_STATE_UNCHECKED);this.oAllNode!=null&&this.oAllNode.check(EWR_CHECK_STATE_CHECKED,false);this.hideBlanks=true}}function EwrTreeView_updateAllNodeCheckState(d){var b=this.allNode();if(b==null)return;if(d!=EWR_CHECK_STATE_CHECKED){b.check(EWR_CHECK_STATE_UNCHECKED,false);return}var a=this.rootNodes();if(a.length==1)return;for(var c=1;c<a.length;c++)if(a[c].getCheckState()!=EWR_CHECK_STATE_CHECKED&&a[c].oCheckBox!=null){b.check(EWR_CHECK_STATE_UNCHECKED,false);return}b.check(EWR_CHECK_STATE_CHECKED,false)}function EwrTreeView_getCheckedNodesValues(){var c=this.getCheckedNodes();if(c==null)return null;for(var a=[],b=0;b<c.length;b++)a[b]=c[b].value;if(this.hideBlanks)a[a.length]=HIDE_BLANKS_VALUE;return a.length>0?a:null}function EwrTreeView_getCheckedNodes(){for(var b=[],d=this.oTreeViewDiv.getElementsByTagName("table"),c=0;c<d.length;c++){var a=getNodeFromTable(d[c]);if(a!=null&&a.getCheckState()=="t"&&a.oCheckBox!=null){b[b.length]=a;if(a.type=="All")break}}return b.length>0?b:null}function EwrTreeView_allNode(){if(this.oAllNode!=null)return this.oAllNode;for(var c=this.oTreeViewDiv.getElementsByTagName("table"),b=0;b<c.length;b++){var a=getNodeFromTable(c[b]);if(a!=null&&a.level==0)if(a.type==EWR_NODE_TYPE_ALL){this.oAllNode=a;return this.oAllNode}}return null}function EwrTreeView_rootNodes(){if(this.oRootNodes!=null)return this.oRootNodes;for(var b=[],d=this.oTreeViewDiv.getElementsByTagName("table"),c=0;c<d.length;c++){var a=getNodeFromTable(d[c]);if(a!=null&&a.level==0){if(this.oAllNode==null&&a.type==EWR_NODE_TYPE_ALL)this.oAllNode=a;b[b.length]=a}}if(b.length>0)this.oRootNodes=b;return this.oRootNodes}function EwrTreeView_cleanup(){for(var a=0;a<ewrTreeNodeCleanupArray.length;a++)ewrTreeNodeCleanupArray[a].cleanup();ewrTreeNodeCleanupArray=[];this.checkAll=null;this.optimizeCheckState=null;this.allNode=null;this.rootNodes=null;this.getCheckedNodesValues=null;this.getCheckedNodes=null;this.updateAllNodeCheckState=null;this.cleanup=null}function EwrTreeView_onClick(c){if(typeof c=="undefined")c=window.event;var b=getSrcElement(c);if(b.nodeType!=1||b.nodeName.toLowerCase()!="input"||b.type!="checkbox")return true;var a=ewr_findElementByType(b,"table",true,"table");if(a!=null){if(typeof a.ewrTreeNode=="undefined")a.ewrTreeNode=new EwrTreeNode(a,undefined);a.ewrTreeNode.checkStateChanged();a.ewrTreeNode.type!=EWR_NODE_TYPE_ALL&&oTree.updateAllNodeCheckState(a.ewrTreeNode.getCheckState())}return true}function EwrTreeView(a){this.oTreeViewDiv=a;this.oTreeViewDiv.onclick=EwrTreeView_onClick}function getNodeFromTable(a){if(typeof a.ewrTreeNode!="undefined"&&a.ewrTreeNode!=null)return a.ewrTreeNode;var b=null;try{var d=a.rows[0].cells,c=d[d.length-1].getElementsByTagName(EWR_TREE_NODE_ELEMENT);if(c.length==1)b=c[0]}catch(e){}if(b==null)b=ewr_findElementByType(a,EWR_TREE_NODE_ELEMENT,false,undefined);if(b!=null){if(a.tagName.toLowerCase()!="table")a=ewr_findElementByType(b,"table",true,null);if(a.ewrTreeNode==null)a.ewrTreeNode=new EwrTreeNode(a,b);return a.ewrTreeNode}return null}function EwrTreeNode_click(){var a=ewr_findElementByType(this.oNodeTable,"a",false,null);a!=null&&a.click()}function EwrTreeNode_checkStateChanged(){this.checkState=this.oCheckBox.checked?EWR_CHECK_STATE_CHECKED:EWR_CHECK_STATE_UNCHECKED;if(this.type!=EWR_NODE_TYPE_ALL){this.setItalicText(false);this.checkChildren(this.checkState,true);var b=this.parent();b!=null&&b.childCheckStateChanged(this.checkState)}else{var a=this.oNodeTable.parentNode;while(a!=null&&typeof a.treeView=="undefined"&&a.treeView!=null)a=a.parentNode;if(a!=null&&typeof a.treeView!="undefined"&&a.treeView!=null){var c=a.treeView;c.checkAll(this.checkState)}}}function EwrTreeNode_getCheckState(){return this.checkState}function EwrTreeNode_childCheckStateChanged(b){var a=b,d=this.childNodes();if(d!=null){if(b==EWR_CHECK_STATE_PARTIAL)a=EWR_CHECK_STATE_PARTIAL;else if(b==EWR_CHECK_STATE_CHECKED)a=EWR_CHECK_STATE_PARTIAL;else if(b==EWR_CHECK_STATE_UNCHECKED){for(var c=false,e=0;e<d.length&&!c;e++)c=d[e].checkState!=EWR_CHECK_STATE_UNCHECKED;a=c?EWR_CHECK_STATE_PARTIAL:EWR_CHECK_STATE_UNCHECKED}this.check(a,false)}var f=this.parent();f!=null&&f.childCheckStateChanged(a)}function EwrTreeNode_check(a,b){if(a!=EWR_CHECK_STATE_PARTIAL&&a==this.checkState)return;if(this.oCheckBox!=null){this.checkState=a;this.oCheckBox.checked=a!=EWR_CHECK_STATE_UNCHECKED;this.setItalicText(a==EWR_CHECK_STATE_PARTIAL)}b==true&&this.checkChildren(a,true)}function EwrTreeNode_checkChildren(d,c){var a=this.childNodes();if(a==null)return;for(var b=0;b<a.length;b++)a[b].check(d,c)}function EwrTreeNode_setItalicText(a){if(this.oTextElement==null)return;this.oTextElement.className=a?EWR_PARTIAL_CHECK_CLASS:"";if(this.calculatedMember)this.oTextElement.className+="ewr-autofilter-cm"}function EwrTreeNode_childNodes(){if(this.nodeChildNodes!=null)return this.nodeChildNodes;var d=[],c=0,a=this.oNodeTable.nextSibling;while(a!=null){if(a.nodeType!=1){a=a.nextSibling;continue}var b=getNodeFromTable(a);if(b!=null){if(b.level<=this.level)break;else if(b.index==c){d[c]=b;a=b.oNodeTable.nextSibling;c=c+1}}else a=null;if(a!=null){var e=a.nodeName.toLowerCase();if(e=="span"||e=="div")a=a.nextSibling}}if(d.length==0)return null;this.nodeChildNodes=d;return d}function EwrTreeNode_parent(){if(this.oParent!=null)return this.oParent;if(this.level==0)return null;var b=null,a=this.oNodeTable.previousSibling;while(a!=null){if(a.nodeType!=1){a=a.previousSibling;continue}if(a.tagName.toLowerCase()!="table"){a=a.previousSibling;continue}b=getNodeFromTable(a);if(b.level==this.level){a=a.previousSibling;b=null;continue}if(b.level==this.level-1)break}if(b==null){var c=this.oNodeTable.parentNode;a=c.previousSibling;if(a==null)return null;b=getNodeFromTable(a)}if(b!=null&&b.type!=EWR_NODE_TYPE_ROOT&&b.level==this.level-1){this.oParent=b;return this.oParent}return null}function EwrTreeNode_optimizeCheckState(){var a=0;if(this.checkState==EWR_CHECK_STATE_PARTIAL)this.oCheckBox.checked=false;var b=this.childNodes();if(b!=null)if(this.checkState==EWR_CHECK_STATE_CHECKED)for(a=0;a<b.length;a++)b[a].check(EWR_CHECK_STATE_UNCHECKED,true);else for(a=0;a<b.length;a++)b[a].optimizeCheckState()}function EwrTreeNode_cleanup(){this.oNodeTable=null;this.click=null;this.check=null;this.checkStateChanged=null;this.childCheckStateChanged=null;this.childNodes=null;this.checkChildren=null;this.setItalicText=null;this.parent=null;this.getCheckState=null;this.optimizeCheckState=null;this.cleanup=null}function ewr_findElementByType(a,d,c,b){return ewr_findElementByTypeAndTag(a,d,null,null,c,b)}function ewr_findElementByTypeAndTag(l,b,e,d,h,g){b=b.toLowerCase();var a=l;while(a!=null&&a.tagName!=null){var i=a.tagName.toLowerCase();if(i==b)if(e==null)return a;else{var j=getAttribute(a,e);if(j!=null)if(d==null)return a;else if(j==d)return a}if(i==g)return null;if(h==true)a=a.parentNode;else{for(var f=a.childNodes,m=f.length,c=0;c<m;c++){if(f[c].nodeType!=1)continue;var k=ewr_findElementByTypeAndTag(f[c],b,e,d,h,g);if(k!=null)return k}a=null}}return null}function resizeToContent(a){var b=a.document.body;if(typeof a.dialogHeight!="undefined")var c=b.scrollHeight-b.clientHeight+parseInt(a.dialogHeight);a.dialogHeight=String(c)+"px";if(typeof a.dialogWidth!="undefined")var d=b.scrollWidth-b.clientWidth+parseInt(a.dialogWidth);a.dialogWidth=String(d)+"px"}function processKeyUp(a){a.keyCode==27&&window.close();a.cancelBubble=false;return true}function Ok_ButtonClick(g){if(typeof oTreeView!="undefined"){typeof oTreeView.optimizeCheckState!="undefined"&&oTreeView.optimizeCheckState();if(typeof oTreeView.getCheckedNodesValues!="undefined")var a=oTreeView.getCheckedNodesValues();var f=false,e="",c="",d=false;if(typeof g!="undefined"){f=true;e=g;d=true}else if(a==null||a.length==0)return null;else for(var b=0;b<a.length;b++){c+=a[b];if(b<a.length-1)c+="&"}var h=filterReturnValueJSON(c,f,e,d);setModalDialogReturnValue(window,h);window.close()}return false}function errorOk_ButtonClick(b){var a=filterReturnValueJSON("",true,b,true);setModalDialogReturnValue(window,a);window.close();return false}function filterReturnValueJSON(d,c,f,a){var b="";if(c){b=f;a=a}var e=typeof window.dialogArguments!="undefined"?window.dialogArguments:undefined;return'{"error":'+String(c)+',"errorMessage":"'+b+'","reloadWorkbook":'+String(a)+',"checkedItems":"'+d+'","ewaControlId":"'+e+'"}'}$_global_bitreeview();